namespace = emex_civic

#CS into Alloys Edict: Activation
country_event = {
	id = emex_civic.1
	title = "emex_civic.1.name"
	desc = "emex_civic.1.desc"
	picture = GFX_evt_small_space_battle
	show_sound = event_activating_unknown_technology
	
	is_triggered_only = yes
	
	trigger = {
		OR = {
			has_valid_civic = civic_war_economy
			has_valid_civic = civic_war_factories
		}
	}
	
	immediate = {
	}
	
	option = {
		name = "emex_civic.1.a" #10%
		custom_tooltip = wareco_10
		# Works out and subtracts CG amount
		export_resource_stockpile_to_variable = {
			resource = consumer_goods
			variable = wareco_cg_num
		}
		divide_variable = {
			which = wareco_cg_num
			value = 10
		}
		add_resource = {
			consumer_goods = -1
			mult = wareco_cg_num
		}
		# Works out and adds alloy amount
		divide_variable = {
			which = wareco_cg_num
			value = 2
		}
		add_resource = {
			alloys = 1
			mult = wareco_cg_num
		}
	}
	option = {
		name = "emex_civic.1.b" #25%
		custom_tooltip = wareco_25
		# Works out and subtracts CG amount
		export_resource_stockpile_to_variable = {
			resource = consumer_goods
			variable = wareco_cg_num
		}
		divide_variable = {
			which = wareco_cg_num
			value = 4
		}
		add_resource = {
			consumer_goods = -1
			mult = wareco_cg_num
		}
		# Works out and adds alloy amount
		divide_variable = {
			which = wareco_cg_num
			value = 2
		}
		add_resource = {
			alloys = 1
			mult = wareco_cg_num
		}
	}
	option = {
		name = "emex_civic.1.c" #50%
		custom_tooltip = wareco_50
		# Works out and subtracts CG amount
		export_resource_stockpile_to_variable = {
			resource = consumer_goods
			variable = wareco_cg_num
		}
		divide_variable = {
			which = wareco_cg_num
			value = 2
		}
		add_resource = {
			consumer_goods = -1
			mult = wareco_cg_num
		}
		# Works out and adds alloy amount
		divide_variable = {
			which = wareco_cg_num
			value = 2
		}
		add_resource = {
			alloys = 1
			mult = wareco_cg_num
		}
	}
	option = {
		name = "emex_civic.1.d" #75%
		custom_tooltip = wareco_75
		# Works out and subtracts CG amount
		export_resource_stockpile_to_variable = {
			resource = consumer_goods
			variable = wareco_cg_num
		}
		divide_variable = {
			which = wareco_cg_num
			value = 4
		}
		multiply_variable = {
			which = wareco_cg_num
			value = 3
		}
		add_resource = {
			consumer_goods = -1
			mult = wareco_cg_num
		}
		# Works out and adds alloy amount
		divide_variable = {
			which = wareco_cg_num
			value = 2
		}
		add_resource = {
			alloys = 1
			mult = wareco_cg_num
		}
	}
	option = {
		name = "emex_civic.1.e" #100%
		custom_tooltip = wareco_100
		# Works out and subtracts CG amount
		export_resource_stockpile_to_variable = {
			resource = consumer_goods
			variable = wareco_cg_num
		}
		add_resource = {
			consumer_goods = -1
			mult = wareco_cg_num
		}
		# Works out and adds alloy amount
		divide_variable = {
			which = wareco_cg_num
			value = 2
		}
		add_resource = {
			alloys = 1
			mult = wareco_cg_num
		}
	}
}

#Winning a Peacekeeping War (FEDERATION)
country_event = {
	id = emex_civic.2
	title = "emex_civic.2.name"
	desc = "emex_civic.2.desc"
	picture = GFX_evt_signing
	
	is_triggered_only = yes
	
	immediate = {
		random_country = {
			limit = {
				has_country_flag = peacekeeper_victim
			}
			save_event_target_as = peacekeeper_victim_empire
		}
	}
	
	option = {
		name = "emex_civic.2.a" # Enforce Peaceful Ideals
		event_target:peacekeeper_victim_empire = {
			shift_ethic = ethic_pacifist
			shift_ethic = ethic_xenophile
			hidden_effect = {
				remove_country_flag = peacekeeper_victim
			}
		}
	}
	option = {
		name = "emex_civic.2.b" # Introduce Occupation Forces
		event_target:peacekeeper_victim_empire = {
			set_subject_of = {
				who = root
				preset = preset_provisional_state_emex
			}
			country_event = { id = emex_civic.65 days = 3600 }
			hidden_effect = {
				remove_country_flag = peacekeeper_victim
			}
		}
		add_resource = { influence = -25 }
	}
	option = {
		name = "emex_civic.2.c" # Negotiate Peacekeeping Agreement
		trigger = {
			has_federation = yes
			federation = {
				has_federation_type = peacekeeper_federation
			}
			event_target:peacekeeper_victim_empire = { NOT = { has_authority = auth_hive_mind } }
		}
		event_target:peacekeeper_victim_empire = {
			if = {
				limit = { is_gestalt = no is_megacorp = no }
				shift_ethic = ethic_militarist
				change_government = {
					civics = {
						civic = civic_emex_peacekeepers
						civic = civic_military_academies
					}
				
				}
			}
			else_if = {
				limit = { is_megacorp = yes }
				shift_ethic = ethic_militarist
				change_government = {
					civics = {
						civic = civic_corporate_mediators
						civic = civic_star_pioneers
					}
				
				}
			}
			else_if = {
				limit = { has_authority = auth_machine_intelligence }
				change_government = {
					civics = {
						civic = civic_machine_mediators
						civic = civic_machine_organic_friendly
					}
				
				}
			}
				
			join_alliance = { who = root override_requirements = yes }
			hidden_effect = {
				remove_country_flag = peacekeeper_victim
			}
		}
		add_resource = { influence = -50 }
	}
}

#Strengthen Diversity decision ended
planet_event = {
	id = emex_civic.3
	title = "emex_civic.3.name"
	desc = "emex_civic.3.desc"
	picture = GFX_evt_atmospheric_entry
	location = root
	
	is_triggered_only = yes
	
	immediate = {
	}
	
	option = {
		name = "emex_civic.3.a"
	}
}

#Strengthen Diversity decision reset
planet_event = {
	id = emex_civic.4
	title = "emex_civic.4.name"
	desc = "emex_civic.4.desc"
	picture = GFX_evt_atmospheric_entry
	location = root
	
	is_triggered_only = yes
	
	immediate = {
	}
	
	option = {
		name = "emex_civic.4.a"
		root = {
			remove_planet_flag = diversity_strengthened
		}
		custom_tooltip = can_strengthen_diversity
	}
}

# CIVIC FACTIONS #
# Mediators Faction Formed
country_event = {
	id = emex_civic.5
	title = "emex_civic.5.name"
	desc = "emex_civic.5.desc"
	picture = GFX_evt_civil_action
	
	is_triggered_only = yes
	
	immediate = {
	}
	
	option = {
		name = "emex_civic.5.a"
		custom_tooltip = mediators_formed
	}
}

### SCRAPPED ###
# # Mechanicus Faction Formed
# country_event = {
# 	id = emex_civic.6
# 	title = "emex_civic.6.name"
# 	desc = "emex_civic.6.desc"
# 	picture = GFX_evt_civil_action
	
# 	is_triggered_only = yes
	
# 	immediate = {
# 	}
	
# 	option = {
# 		name = "emex_civic.6.a"
# 		custom_tooltip = mechanicus_formed
# 	}
# }

# # Nihilist Faction Formed
# country_event = {
# 	id = emex_civic.7
# 	title = "emex_civic.7.name"
# 	desc = "emex_civic.7.desc"
# 	picture = GFX_evt_civil_action
	
# 	is_triggered_only = yes
	
# 	immediate = {
# 	}
	
# 	option = {
# 		name = "emex_civic.7.a"
# 		custom_tooltip = nihilists_formed
# 	}
# }

# Colony finished (AnTy)
planet_event = {
	id = emex_civic.8
	hide_window = yes
	
	is_triggered_only = yes
	
	trigger = {
		owner = { has_valid_civic = civic_anarcho_tyranny }
		NOT = { has_deposit = d_anty_colony_deposit }
	}
	
	immediate = {
		planet_event = { id = emex_civic.9 days = 1800 }
	}
}

# Colony finished (AnTy) - Deposit Provided
planet_event = { #maybe not hide the event
	id = emex_civic.9
	hide_window = yes
	
	is_triggered_only = yes
	
	trigger = {
		owner = { has_valid_civic = civic_anarcho_tyranny }
		NOT = { has_deposit = d_anty_colony_deposit }
	}
	
	immediate = {
		add_deposit = d_anty_colony_deposit
	}
}

# Heads Convened (Machinarchy)
planet_event = {
	id = emex_civic.10
	title = "emex_civic.10.name"
	desc = "emex_civic.10.desc"
	picture = GFX_evt_board_meeting

	is_triggered_only = yes

	trigger = {
		owner = {
			has_valid_civic = civic_machinarchy
			has_policy_flag = artificial_aristocracy
		}
	}

	immediate = {
	}
	
	option = {
		name = "emex_civic.10.a" #food
		hidden_effect = { machinarchy_aa_reset = yes }
		set_planet_flag = machinarchy_aa_food
		custom_tooltip = machinarchy_aa_food_tt
	}
	option = {
		name = "emex_civic.10.b" #energy
		hidden_effect = { machinarchy_aa_reset = yes }
		set_planet_flag = machinarchy_aa_energy
		custom_tooltip = machinarchy_aa_energy_tt
	}
	option = {
		name = "emex_civic.10.c" #minerals
		hidden_effect = { machinarchy_aa_reset = yes }
		set_planet_flag = machinarchy_aa_minerals
		custom_tooltip = machinarchy_aa_minerals_tt
	}
	option = {
		name = "emex_civic.10.d" #alloys
		hidden_effect = { machinarchy_aa_reset = yes }
		set_planet_flag = machinarchy_aa_alloys
		custom_tooltip = machinarchy_aa_alloys_tt
	}
	option = {
		name = "emex_civic.10.e" #CGs
		hidden_effect = { machinarchy_aa_reset = yes }
		set_planet_flag = machinarchy_aa_cgs
		custom_tooltip = machinarchy_aa_cgs_tt
	}
}

# Machinarchy - AA adopted (set default)
country_event = {
	id = emex_civic.11
	title = "emex_civic.11.name"
	desc = "emex_civic.11.desc"
	picture = GFX_evt_board_meeting
	
	is_triggered_only = yes
	
	trigger = {
		has_valid_civic = civic_machinarchy
		last_changed_policy = machine_strata
		has_policy_flag = artificial_aristocracy
	}
	
	immediate = {
	}
	
	option = {
		name = "emex_civic.11.a" #food
		every_owned_planet = {
			hidden_effect = { machinarchy_aa_reset = yes }
			set_planet_flag = machinarchy_aa_food
		}
		custom_tooltip = machinarchy_aa_food_tt
	}
	option = {
		name = "emex_civic.11.b" #energy
		every_owned_planet = {
			hidden_effect = { machinarchy_aa_reset = yes }
			set_planet_flag = machinarchy_aa_energy
		}
		custom_tooltip = machinarchy_aa_energy_tt
	}
	option = {
		name = "emex_civic.11.c" #minerals
		every_owned_planet = {
			hidden_effect = { machinarchy_aa_reset = yes }
			set_planet_flag = machinarchy_aa_minerals
		}
		custom_tooltip = machinarchy_aa_minerals_tt
	}
	option = {
		name = "emex_civic.11.d" #alloys
		every_owned_planet = {
			hidden_effect = { machinarchy_aa_reset = yes }
			set_planet_flag = machinarchy_aa_alloys
		}
		custom_tooltip = machinarchy_aa_alloys_tt
	}
	option = {
		name = "emex_civic.11.e" #CGs
		every_owned_planet = {
			hidden_effect = { machinarchy_aa_reset = yes }
			set_planet_flag = machinarchy_aa_cgs
		}
		custom_tooltip = machinarchy_aa_cgs_tt
	}
	option = {
		name = "emex_civic.11.f" # Set individually
		custom_tooltip = machinarchy_aa_custom_tt
	}
}

# Machinarchy - AA (edict to change)
country_event = {
	id = emex_civic.12
	title = "emex_civic.11.name"
	desc = "emex_civic.11.desc"
	picture = GFX_evt_board_meeting
	
	is_triggered_only = yes
	
	trigger = {
		has_valid_civic = civic_machinarchy
	}
	
	immediate = {
	}
	
	option = {
		name = "emex_civic.11.a" #food
		every_owned_planet = {
			hidden_effect = { machinarchy_aa_reset = yes }
			set_planet_flag = machinarchy_aa_food
		}
		custom_tooltip = machinarchy_aa_food_tt
	}
	option = {
		name = "emex_civic.11.b" #energy
		every_owned_planet = {
			hidden_effect = { machinarchy_aa_reset = yes }
			set_planet_flag = machinarchy_aa_energy
		}
		custom_tooltip = machinarchy_aa_energy_tt
	}
	option = {
		name = "emex_civic.11.c" #minerals
		every_owned_planet = {
			hidden_effect = { machinarchy_aa_reset = yes }
			set_planet_flag = machinarchy_aa_minerals
		}
		custom_tooltip = machinarchy_aa_minerals_tt
	}
	option = {
		name = "emex_civic.11.d" #alloys
		every_owned_planet = {
			hidden_effect = { machinarchy_aa_reset = yes }
			set_planet_flag = machinarchy_aa_alloys
		}
		custom_tooltip = machinarchy_aa_alloys_tt
	}
	option = {
		name = "emex_civic.11.e" #CGs
		every_owned_planet = {
			hidden_effect = { machinarchy_aa_reset = yes }
			set_planet_flag = machinarchy_aa_cgs
		}
		custom_tooltip = machinarchy_aa_cgs_tt
	}
	option = {
		name = "emex_civic.12.f" # Set individually
		custom_tooltip = machinarchy_aa_custom_tt
	}
}

#12.5 - situation begins
#13 - midway thru
#14 - cannot cancel
#15 - little succcess
#16 - partial success
#17 - success

#18 - (EE) info about data may be leaked
#19 - empire demands we stop/very harshly
#20 - (EE) event about us standing down/continuing (CB?)
#21 - empire gives resources to stop
#22 - (EE) response from us
#23 - empire requests nicely to stop
#24 - (EE) response from us

#AnTy - Reform?
country_event = {
	id = emex_civic.30
	title = "emex_civic.30.name"
	desc = "emex_civic.30.desc"
	picture = GFX_evt_tradedeal
	
	is_triggered_only = yes

	trigger = {
		has_valid_civic = civic_anarcho_tyranny
	}
	
	immediate = {
	}
	
	option = {
		name = "emex_civic.30.a" # Nah
		add_resource = {
			influence = 250
			unity = 5000
		}
	}

	option = {
		name = "emex_civic.30.b" # Dictatorship
		force_remove_civic = civic_anarcho_tyranny
		force_add_civic = civic_warrior_culture
		change_government = {
			authority = auth_dictatorial
			cooldown = no
		}
		hidden_effect = {
			anty_remove_effect = yes
		}
	}

	option = {
		name = "emex_civic.30.c" # Imperial
		force_remove_civic = civic_anarcho_tyranny
		force_add_civic = civic_warrior_culture
		change_government = {
			authority = auth_imperial
			cooldown = no
		}
		hidden_effect = {
			anty_remove_effect = yes
		}
	}

	option = {
		name = "emex_civic.30.d" # MegaCorp
		trigger = {
			host_has_dlc = "Megacorp"
		}
		allow = {
			NOT = {
				has_ethic = ethic_fanatic_authoritarian
			}
		}
		change_government = {
			authority = auth_corporate
			civics = { civic = civic_indentured_assets civic = civic_constant_growth }
			cooldown = no
		}
		hidden_effect = {
			anty_remove_effect = yes
		}
	}
}

#Sovereign Nations; decision finished
planet_event = {
	id = emex_civic.31
	title = "emex_civic.31.name"
	desc = "emex_civic.31.desc"
	picture = GFX_evt_tradedeal
	location = root
	
	is_triggered_only = yes
	
	immediate = {
	}
	
	option = {
		name = "emex_civic.31.a"
		if = {
			limit = { owner = { has_valid_civic = civic_sovereign_nations } }
			add_modifier = {
				modifier = sn_dealing_with_nation
				days = 720
				clear_on_owner_change = yes
			}
		}
		else_if = {
			limit = { owner = { has_valid_civic = civic_hive_splintered } }
			add_modifier = {
				modifier = sn_dealing_with_nation_h
				days = 720
				clear_on_owner_change = yes
			}
		}
	}
}

#Sovereign Nations; nation dealt with
planet_event = {
	id = emex_civic.32
	title = "emex_civic.32.name"
	desc = "emex_civic.32.desc"
	picture = GFX_evt_partition
	location = root
	
	is_triggered_only = yes
	
	immediate = {
	}
	
	option = { # Invade state
		name = "emex_civic.32.a"
		owner = {
			add_resource = {
				minerals = -500
				alloys = -200
			}
		}
		custom_tooltip = sn_war_option
		hidden_effect = {
			random_list = {
				25 = {
					#it works; replaced by occupied zone
					modifier = {
						factor = 2
						has_planet_flag = neutral_state_dealt
					}
					modifier = {
						factor = 1.5
						has_planet_flag = antagonistic_state_dealt
					}

					# Government Factors #
					# Civics
					modifier = {
						factor = 1.2
						owner = { has_valid_civic = civic_barbaric_despoilers }
					}
					modifier = {
						factor = 1.1
						owner = { has_valid_civic = civic_citizen_service }
					}
					modifier = {
						factor = 1.25
						owner = { has_valid_civic = civic_fanatic_purifiers }
					}
					modifier = {
						factor = 1.15
						owner = { has_valid_civic = civic_nationalistic_zeal }
					}
					modifier = {
						factor = 1.1
						owner = { has_valid_civic = civic_warrior_culture }
					}
					# Ethics
					modifier = {
						factor = 1.1
						owner = { has_ethic = ethic_militarist }
					}
					modifier = {
						factor = 1.25
						owner = { has_ethic = ethic_fanatic_militarist }
					}
					modifier = {
						factor = 1.05
						owner = { has_ethic = ethic_xenophobe }
					}
					modifier = {
						factor = 1.15
						owner = { has_ethic = ethic_fanatic_xenophobe }
					}
					# Traditions
					modifier = {
						factor = 1.25
						owner = { has_tradition = tr_supremacy_finish }
					}
					modifier = {
						factor = 1.15
						owner = { has_tradition = tr_domination_finish }
					}
					modifier = {
						factor = 1.05
						owner = { has_tradition = tr_unyielding_finish }
					}
					add_deposit = d_sn_occupied_zone
					planet_event = {
						id = emex_civic.33
						days = 180
						random = 180
					}
				}
				25 = {
					#it fails; relations remain the same
					modifier = {
						factor = 1.5
						has_planet_flag = antagonistic_state_dealt
					}
					modifier = {
						factor = 1.5
						has_planet_flag = threatening_state_dealt
					}
					if = {
						limit = {
							has_planet_flag = neutral_state_dealt
						}
						add_blocker = {
							type = d_sn_neutral_nation
							blocked_deposit = none
						}
					}
					else_if = {
						limit = {
							has_planet_flag = antagonistic_state_dealt
						}
						add_blocker = {
							type = d_sn_antagonistic_nation
							blocked_deposit = none
						}
					}
					else_if = {
						limit = {
							has_planet_flag = threatening_state_dealt
						}
						add_blocker = {
							type = d_sn_threatening_state
							blocked_deposit = none
						}
					}
				}
				25 = {
					#it fails; relations worsen
					modifier = {
						factor = 2
						has_planet_flag = neutral_state_dealt
					}
					modifier = {
						factor = 0
						has_planet_flag = threatening_state_dealt
					}
					if = {
						limit = {
							has_planet_flag = neutral_state_dealt
						}
						add_blocker = {
							type = d_sn_antagonistic_nation
							blocked_deposit = none
						}
					}
					else_if = {
						limit = {
							has_planet_flag = antagonistic_state_dealt
						}
						add_blocker = {
							type = d_sn_threatening_state
							blocked_deposit = none
						}
					}
					else_if = {
						limit = {
							has_planet_flag = threatening_state_dealt
						}
						add_blocker = {
							type = d_sn_threatening_state
							blocked_deposit = none
						}
					}
				}
				25 = {
					#partial success; theyre weakened
					modifier = {
						factor = 0
						has_planet_flag = neutral_state_dealt
					}
					if = {
						limit = {
							has_planet_flag = antagonistic_state_dealt
						}
						add_blocker = {
							type = d_sn_neutral_nation
							blocked_deposit = none
						}
					}
					else_if = {
						limit = {
							has_planet_flag = threatening_state_dealt
						}
						add_blocker = {
							type = d_sn_antagonistic_nation
							blocked_deposit = none
						}
					}
				}
			}
		}
	}
	option = { # Give resources to state
		name = "emex_civic.32.b"
		owner = {
			add_resource = {
				energy = -1000
				consumer_goods = -500
			}
		}
		custom_tooltip = sn_money_option
		hidden_effect = {
			random_list = {
				25 = {
					#they accept; relations improve
					modifier = {
						factor = 2
						has_planet_flag = neutral_state_dealt
					}
					modifier = {
						factor = 0.5
						has_planet_flag = threatening_state_dealt
					}

					# Government Factors #
					# Civics
					modifier = {
						factor = 1.25
						owner = { has_valid_civic = civic_corporate_dominion }
					}
					modifier = {
						factor = 1.2
						owner = { has_valid_civic = civic_crafters }
					}
					modifier = {
						factor = 1.15
						owner = { has_valid_civic = civic_merchant_guilds }
					}
					modifier = {
						factor = 1.15
						owner = { has_valid_civic = civic_relentless_industrialists }
					}
					modifier = {
						factor = 1.1
						owner = { has_valid_civic = civic_mining_guilds }
					}
					# Ethics
					modifier = {
						factor = 1.1
						owner = { has_ethic = ethic_materialist }
					}
					modifier = {
						factor = 1.25
						owner = { has_ethic = ethic_fanatic_materialist }
					}
					modifier = {
						factor = 1.05
						owner = { has_ethic = ethic_xenophile }
					}
					modifier = {
						factor = 1.15
						owner = { has_ethic = ethic_fanatic_xenophile }
					}
					# Traditions
					modifier = {
						factor = 1.25
						owner = { has_tradition = tr_mercantile_finish }
					}
					modifier = {
						factor = 1.15
						owner = { has_tradition = tr_prosperity_finish }
					}
					modifier = {
						factor = 1.05
						owner = { has_tradition = tr_adaptability_finish }
					}
					if = {
						limit = {
							has_planet_flag = neutral_state_dealt
						}
						add_deposit = d_sn_cooperative_nation
					}
					else_if = {
						limit = {
							has_planet_flag = antagonistic_state_dealt
						}
						add_blocker = {
							type = d_sn_neutral_nation
							blocked_deposit = none
						}
					}
					else_if = {
						limit = {
							has_planet_flag = threatening_state_dealt
						}
						add_blocker = {
							type = d_sn_antagonistic_nation
							blocked_deposit = none
						}
					}
				}
				25 = {
					#they reject; relations remain the same
					modifier = {
						factor = 0.5
						has_planet_flag = neutral_state_dealt
					}
					modifier = {
						factor = 0.5
						has_planet_flag = antagonistic_state_dealt
					}
					if = {
						limit = {
							has_planet_flag = neutral_state_dealt
						}
						add_blocker = {
							type = d_sn_neutral_nation
							blocked_deposit = none
						}
					}
					else_if = {
						limit = {
							has_planet_flag = antagonistic_state_dealt
						}
						add_blocker = {
							type = d_sn_antagonistic_nation
							blocked_deposit = none
						}
					}
					else_if = {
						limit = {
							has_planet_flag = threatening_state_dealt
						}
						add_blocker = {
							type = d_sn_threatening_state
							blocked_deposit = none
						}
					}
				}
				# 25 = {
				# 	#they reject; relations worsen
				# 	modifier = {
				# 		factor = 0
				# 		has_planet_flag = neutral_state_dealt
				# 	}
				# 	modifier = {
				# 		factor = 0.25
				# 		has_planet_flag = antagonistic_state_dealt
				# 	}
				# 	modifier = {
				# 		factor = 0.5
				# 		has_planet_flag = threatening_state_dealt
				# 	}
				# }
				25 = {
					#they accept but relations dont improve
					owner = {
						add_resource = {
							energy = -2000
							minerals = -1000
						}
					}
					modifier = {
						factor = 0.5
						has_planet_flag = antagonistic_state_dealt
					}
					if = {
						limit = {
							has_planet_flag = neutral_state_dealt
						}
						add_blocker = {
							type = d_sn_neutral_nation
							blocked_deposit = none
						}
					}
					else_if = {
						limit = {
							has_planet_flag = antagonistic_state_dealt
						}
						add_blocker = {
							type = d_sn_antagonistic_nation
							blocked_deposit = none
						}
					}
					else_if = {
						limit = {
							has_planet_flag = threatening_state_dealt
						}
						add_blocker = {
							type = d_sn_threatening_state
							blocked_deposit = none
						}
					}
				}
			}
		}
	}
	option = { # Improve relations with state
		name = "emex_civic.32.c"
		owner = {
			add_resource = {
				unity = -150
				influence = -50
			}
		}
		custom_tooltip = sn_diplomacy_option
		hidden_effect = {
			random_list = {
				25 = {
					#it works; relations improve
					modifier = {
						factor = 2
						has_planet_flag = neutral_state_dealt
					}
					modifier = {
						factor = 0.5
						has_planet_flag = threatening_state_dealt
					}

					# Government Factors #
					# Civics
					modifier = {
						factor = 1.25
						owner = { has_valid_civic = civic_diplomatic_corps }
					}
					modifier = {
						factor = 1.15
						owner = { has_valid_civic = civic_shadow_council }
					}
					modifier = {
						factor = 1.15
						owner = { has_valid_civic = civic_philosopher_king }
					}
					modifier = {
						factor = 1.1
						owner = { has_valid_civic = civic_idealistic_foundation }
					}
					modifier = {
						factor = 1.1
						owner = { has_valid_civic = civic_cutthroat_politics }
					}
					# Ethics
					modifier = {
						factor = 1.1
						owner = { has_ethic = ethic_xenophile }
					}
					modifier = {
						factor = 1.25
						owner = { has_ethic = ethic_fanatic_xenophile }
					}
					modifier = {
						factor = 1.05
						owner = { has_ethic = ethic_egalitarian }
					}
					modifier = {
						factor = 1.15
						owner = { has_ethic = ethic_fanatic_egalitarian }
					}
					# Traditions
					modifier = {
						factor = 1.25
						owner = { has_tradition = tr_diplomacy_finish }
					}
					modifier = {
						factor = 1.15
						owner = { has_tradition = tr_harmony_finish }
					}
					modifier = {
						factor = 1.1
						owner = { has_tradition = tr_politics_finish }
					}
					if = {
						limit = {
							has_planet_flag = neutral_state_dealt
						}
						add_deposit = d_sn_cooperative_nation
					}
					else_if = {
						limit = {
							has_planet_flag = antagonistic_state_dealt
						}
						add_blocker = {
							type = d_sn_neutral_nation
							blocked_deposit = none
						}
					}
					else_if = {
						limit = {
							has_planet_flag = threatening_state_dealt
						}
						add_blocker = {
							type = d_sn_antagonistic_nation
							blocked_deposit = none
						}
					}
				}
				25 = {
					#it fails; relations remain the same
					modifier = {
						factor = 1.5
						has_planet_flag = threatening_state_dealt
					}
					if = {
						limit = {
							has_planet_flag = neutral_state_dealt
						}
						add_blocker = {
							type = d_sn_neutral_nation
							blocked_deposit = none
						}
					}
					else_if = {
						limit = {
							has_planet_flag = antagonistic_state_dealt
						}
						add_blocker = {
							type = d_sn_antagonistic_nation
							blocked_deposit = none
						}
					}
					else_if = {
						limit = {
							has_planet_flag = threatening_state_dealt
						}
						add_blocker = {
							type = d_sn_threatening_state
							blocked_deposit = none
						}
					}
				}
				25 = {
					#it fails; relations worsen
					modifier = {
						factor = 0
						has_planet_flag = neutral_state_dealt
					}
					modifier = {
						factor = 0.75
						has_planet_flag = antagonistic_state_dealt
					}
					modifier = {
						factor = 0.5
						has_planet_flag = threatening_state_dealt
					}
					if = {
						limit = {
							has_planet_flag = neutral_state_dealt
						}
						add_blocker = {
							type = d_sn_antagonistic_nation
							blocked_deposit = none
						}
					}
					else_if = {
						limit = {
							has_planet_flag = antagonistic_state_dealt
						}
						add_blocker = {
							type = d_sn_threatening_state
							blocked_deposit = none
						}
					}
					else_if = {
						limit = {
							has_planet_flag = threatening_state_dealt
						}
						add_blocker = {
							type = d_sn_threatening_state
							blocked_deposit = none
						}
					}
				}
				# 25 = {
				# 	#big success
				# 	modifier = {
				# 		factor = 0.5
				# 		has_planet_flag = antagonistic_state_dealt
				# 	}
				# 	modifier = {
				# 		factor = 0
				# 		has_planet_flag = threatening_state_dealt
				# 	}
				# }
			}
		}
	}
}

#Sovereign Nations; occupied zone replaced by cooperative nation
planet_event = {
	id = emex_civic.33
	title = "emex_civic.33.name"
	desc = "emex_civic.33.desc"
	picture = GFX_evt_tradedeal
	location = root
	
	is_triggered_only = yes
	
	immediate = {
	}
	
	option = {
		name = "emex_civic.33.a"
		remove_deposit = d_sn_occupied_zone
		add_deposit = d_sn_cooperative_nation
	}
}

#Defender of the Faith - spread the faith operation
espionage_operation_event = {
	id = emex_civic.34
	title = operation_spread_faith
	desc = {
		text = emex_civic.34.goodoutcome
		trigger = {
			OR = {
				has_espionage_operation_flag = outcome_stf_great
				has_espionage_operation_flag = outcome_stf_good
				has_espionage_operation_flag = outcome_stf_ok
			}
		}
	}
	desc = {
		text = emex_civic.34.badoutcome
		trigger = {
			has_espionage_operation_flag = outcome_stf_backfired
		}
	}

	picture = GFX_evt_alien_propaganda
	show_sound = event_espionage_concluded
	espionage_operation = yes
	is_triggered_only = yes

	trigger = {
		exists = from
	}

	immediate = {
		random_list = {
			15 = {
				set_espionage_operation_flag = outcome_stf_great
			}
			30 = {
				set_espionage_operation_flag = outcome_stf_good
			}
			20 = {
				set_espionage_operation_flag = outcome_stf_ok
			}
			5 = {
			 	set_espionage_operation_flag = outcome_stf_backfired
			}
		}
	}

	option = {
		name = emex_civic.34.a
		if = {
			limit = {
				has_espionage_operation_flag = outcome_stf_great
			}
			owner = {
				add_monthly_resource_mult  = {
					resource = unity
					value = 5
				}
			}
			from = {
				add_modifier = {
					modifier = stf_effect1
					days = 1800
				}
			}
		}
		else_if = {
			limit = {
				has_espionage_operation_flag = outcome_stf_good
			}
			owner = {
				add_monthly_resource_mult  = {
					resource = unity
					value = 3
				}
			}
			from = {
				add_modifier = {
					modifier = stf_effect1
					days = 1080
				}
			}
		}
		else_if = {
			limit = {
				has_espionage_operation_flag = outcome_stf_ok
			}
			owner = {
				add_monthly_resource_mult  = {
					resource = unity
					value = 2
				}
			}
			from = {
				add_modifier = {
					modifier = stf_effect2
					days = 1080
				}
			}
		}
		else_if = {
			limit = {
				has_espionage_operation_flag = outcome_stf_backfired
			}
			owner = {
				add_resource = {
					energy = -1000
				}
				add_modifier = {
					modifier = stf_effect_backfired
					days = 1080
				}
			}
		}
		else = {
			owner = {
				add_resource = {
					unity = 5
				}
			}
		}
	}
}

# Seekers of Knowledge - Unity Boon
country_event = {
	id = emex_civic.35
	hide_window = yes
	
	is_triggered_only = yes
	
	trigger = {
		OR = {
			has_valid_civic = civic_seekers_of_knowledge
			has_valid_civic = civic_hive_tech_driven
			has_valid_civic = civic_machine_data_accretion
		}
	}
	#on_action - on_tech_increased
	
	immediate = {
		# If num of techs of this tier researched is more than the
		# variable's amount, unity is given and variable reset
		if = { #T3
			limit = {
				num_researched_techs_of_tier = {
					tier = 3
					value > sok_t3@root
				}
			}
			add_monthly_resource_mult  = {
				resource = unity
				value = 1
			}
			change_variable = {
				which = sok_t3@root
				value = 1
			}
			# while = {
			# 	limit = {
			# 		check_variable = {
			# 			which = sok@root_t3
			# 			value < t3techs
			# 		}
			# 	}
			# }
		}
		else_if = { #T4
			limit = {
				num_researched_techs_of_tier = {
					tier = 4
					value > sok_t4@root
				}
			}
			add_monthly_resource_mult  = {
				resource = unity
				value = 2
			}
			change_variable = {
				which = sok_t4@root
				value = 1
			}
		}
		else_if = { #T5
			limit = {
				num_researched_techs_of_tier = {
					tier = 5
					value > sok_t5@root
				}
			}
			add_monthly_resource_mult  = {
				resource = unity
				value = 3
			}
			change_variable = {
				which = sok_t5@root
				value = 1
			}
		}

		if = { #RARE
			limit = {
				num_rare_techs > sok_rare@root
			}
			add_monthly_resource_mult  = {
				resource = unity
				value = 2
			}
			change_variable = {
				which = sok_rare@root
				value = 1
			}
		}

		if = { #DANGEROUS
			limit = {
				OR = {
					last_increased_tech = tech_synthetic_workers
					last_increased_tech = tech_combat_computers_3
					last_increased_tech = tech_jump_drive_1
					last_increased_tech = tech_psi_jump_drive_1
				}
			}
			add_monthly_resource_mult  = {
				resource = unity
				value = 2
			}
			change_variable = {
				which = sok_dangerous@root
				value = 1
			}
		}

		# The rare and danger bonuses stack with the tier bonuses
	}
}

# Masters of Architecture - Building the Monument
country_event = {
	id = emex_civic.36
	title = "emex_civic.36.name"
	desc = "emex_civic.36.desc"
	picture = GFX_evt_ancient_alien_temple
	
	is_triggered_only = yes
	
	trigger = {
		has_valid_civic = civic_masters_of_architecture
		NOT = {
			has_country_flag = moa_set_up_complete
		}
	}
	#on_action - on_post_government_changed
	
	immediate = {
	}

	option = {
		name = emex_civic.36.a
		capital_scope = {
			enable_special_project = {
				name = "MOA_ADOPTION"
				location = this
				owner = root.owner
			}
		}
	}
}

# Masters of Architecture - Completed
country_event = {
	id = emex_civic.37
	title = "emex_civic.36.name"
	desc = "emex_civic.37.desc"
	picture = GFX_evt_grand_speech
	
	is_triggered_only = yes
	
	trigger = {
		has_valid_civic = civic_masters_of_architecture
		NOT = {
			has_country_flag = moa_set_up_complete
		}
	}
	
	immediate = {
		set_country_flag = moa_set_up_complete
	}

	option = {
		name = emex_civic.37.a
		add_resource = {
			influence = 100
			energy = 2000
		}
		capital_scope = {
			add_deposit = "d_great_monument"
		}
	}
}

# CoP - Ruler death (hidden)
country_event = {
	id = emex_civic.38
	hide_window = yes
	
	is_triggered_only = yes
	
	trigger = {
		from = {
			is_same_value = root.ruler
		}
		has_valid_civic = civic_personality_cult
	}
	
	immediate = {
		random_list = {
			25 = {
				set_timed_country_flag = {
					flag = cop_beloved_ruler
					days = 60
				}
			}
			25 = {
				set_timed_country_flag = {
					flag = cop_respected_ruler
					days = 60
				}
			}
			25 = {
				set_timed_country_flag = {
					flag = cop_ok_ruler
					days = 60
				}
			}
			25 = {
				set_timed_country_flag = {
					flag = cop_bad_ruler
					days = 60
				}
			}
		}
		country_event = {
			id = emex_civic.39 days = 1
		}
	}
}

# CoP - Ruler death
country_event = {
	id = emex_civic.39
	title = "emex_civic.39.name"
	desc = {
		text = emex_civic.39.desc_a
		trigger = {
			has_country_flag = cop_beloved_ruler
		}
	}
	desc = {
		text = emex_civic.39.desc_b
		trigger = {
			has_country_flag = cop_respected_ruler
		}
	}
	desc = {
		text = emex_civic.39.desc_c
		trigger = {
			has_country_flag = cop_ok_ruler
		}
	}
	desc = {
		text = emex_civic.39.desc_d
		trigger = {
			has_country_flag = cop_bad_ruler
		}
	}
	picture = GFX_evt_space_funeral
	
	is_triggered_only = yes
	
	trigger = {
		has_valid_civic = civic_personality_cult
	}
	
	immediate = {
	}

	option = {
		name = emex_civic.39.a # Hold a grand funeral
		add_resource = {
			energy = -3000
		}
		if = {
			limit = {
				has_country_flag = cop_beloved_ruler
			}
			capital_scope = {
				add_modifier = {
					modifier = cop_good_funeral
					days = 1800
				}
			}
			add_modifier = {
				modifier = cop_pleased
				days = 3600
			}
		}
		else_if = {
			limit = {
				has_country_flag = cop_respected_ruler
			}
			capital_scope = {
				add_modifier = {
					modifier = cop_good_funeral
					days = 1800
				}
			}
		}
		else_if = {
			limit = {
				has_country_flag = cop_ok_ruler
			}
			capital_scope = {
				add_modifier = {
					modifier = cop_meh_funeral
					days = 1800
				}
			}
			add_modifier = {
				modifier = cop_kinda_displeased
				days = 3600
			}
		}
		else_if = {
			limit = {
				has_country_flag = cop_bad_ruler
			}
			capital_scope = {
				add_modifier = {
					modifier = cop_bad_funeral
					days = 1800
				}
			}
			add_modifier = {
				modifier = cop_displeased
				days = 3600
			}
		}
	}

	option = {
		name = emex_civic.39.b # Hold a standard ceremony
		if = {
			limit = {
				has_country_flag = cop_beloved_ruler
			}
			add_monthly_resource_mult = {
				resource = unity
				value = 3
			}
			add_modifier = {
				modifier = cop_kinda_displeased
				days = 3600
			}
		}
		else_if = {
			limit = {
				has_country_flag = cop_respected_ruler
			}
			add_monthly_resource_mult = {
				resource = unity
				value = 3
			}
		}
		else_if = {
			limit = {
				has_country_flag = cop_ok_ruler
			}
			add_monthly_resource_mult = {
				resource = unity
				value = 4
			}
		}
		else_if = {
			limit = {
				has_country_flag = cop_bad_ruler
			}
			add_monthly_resource_mult = {
				resource = unity
				value = 1
			}
			add_modifier = {
				modifier = cop_kinda_displeased
				days = 3600
			}
		}
	}

	option = {
		name = emex_civic.39.c # Denounce them
		if = {
			limit = {
				has_country_flag = cop_beloved_ruler
			}
			add_monthly_resource_mult = {
				resource = energy
				value = 5
			}
			add_resource = {
				influence = 300
			}
			add_modifier = {
				modifier = cop_very_displeased
				days = 3600
			}
		}
		else_if = {
			limit = {
				has_country_flag = cop_respected_ruler
			}
			add_monthly_resource_mult = {
				resource = energy
				value = 2
			}
			add_resource = {
				influence = 250
			}
			add_modifier = {
				modifier = cop_displeased
				days = 3600
			}
		}
		else_if = {
			limit = {
				has_country_flag = cop_ok_ruler
			}
			add_monthly_resource_mult = {
				resource = energy
				value = 2
			}
			add_resource = {
				influence = 150
			}
			add_modifier = {
				modifier = cop_kinda_displeased
				days = 3600
			}
		}
		else_if = {
			limit = {
				has_country_flag = cop_bad_ruler
			}
			add_monthly_resource_mult = {
				resource = energy
				value = 2
			}
			add_monthly_resource_mult = {
				resource = unity
				value = 2
			}
			add_modifier = {
				modifier = cop_pleased
				days = 3600
			}
		}
	}
}

# Arcane Deciphering Events (Antique Purveyors civic)
country_event = {
	id = emex_civic.40
	hide_window = yes

	is_triggered_only = yes

	immediate = {
		random_list = {
			35 = { country_event = { id = ancrel.10001 } }
			25 = { country_event = { id = ancrel.10002 } }
			12 = { country_event = { id = ancrel.10003 } }
			5 = { country_event = { id = ancrel.10004 } }
			5 = { country_event = { id = ancrel.10005 } }
			5 = { country_event = { id = ancrel.10006 } }
			5 = {
				modifier = {
					factor = 0
					country_uses_consumer_goods = no
				}
				country_event = { id = ancrel.10007 }
			}
			5 = {
				modifier = {
					factor = 0
					country_uses_food = no
				}
				country_event = { id = ancrel.10008 }
			}
			5 = { country_event = { id = ancrel.10009 } }
		}
	}
}

# Monetised Knowledge - Cash Boon
country_event = {
	id = emex_civic.41
	hide_window = yes
	
	is_triggered_only = yes
	
	trigger = {
		has_valid_civic = civic_monetised_knowledge
	}
	#on_action - on_tech_increased
	
	immediate = {
		# If num of techs of this tier researched is more than the
		# variable's amount, cash is given and variable reset
		if = { #T3
			limit = {
				num_researched_techs_of_tier = {
					tier = 3
					value > sok_t3@root
				}
			}
			add_monthly_resource_mult  = {
				resource = energy
				value = 3
			}
			change_variable = {
				which = sok_t3@root
				value = 1
			}
			# while = {
			# 	limit = {
			# 		check_variable = {
			# 			which = sok@root_t3
			# 			value < t3techs
			# 		}
			# 	}
			# }
		}
		else_if = { #T4
			limit = {
				num_researched_techs_of_tier = {
					tier = 4
					value > sok_t4@root
				}
			}
			add_monthly_resource_mult  = {
				resource = energy
				value = 5
			}
			change_variable = {
				which = sok_t4@root
				value = 1
			}
		}
		else_if = { #T5
			limit = {
				num_researched_techs_of_tier = {
					tier = 5
					value > sok_t5@root
				}
			}
			add_monthly_resource_mult  = {
				resource = energy
				value = 7
			}
			change_variable = {
				which = sok_t5@root
				value = 1
			}
		}

		if = { #RARE
			limit = {
				num_rare_techs > sok_rare@root
			}
			add_monthly_resource_mult  = {
				resource = energy
				value = 2
			}
			change_variable = {
				which = sok_rare@root
				value = 1
			}
		}

		if = { #DANGEROUS
			limit = {
				OR = {
					last_increased_tech = tech_synthetic_workers
					last_increased_tech = tech_combat_computers_3
					last_increased_tech = tech_jump_drive_1
					last_increased_tech = tech_psi_jump_drive_1
				}
			}
			add_monthly_resource_mult  = {
				resource = energy
				value = 4
			}
			change_variable = {
				which = sok_dangerous@root
				value = 1
			}
		}

		# The rare and danger bonuses stack with the tier bonuses
	}
}

#Sovereign Nations; nation dealt with
planet_event = {
	id = emex_civic.42
	title = "emex_civic.32.name"
	desc = "emex_civic.32.desc"
	picture = GFX_evt_partition
	location = root
	
	is_triggered_only = yes
	
	immediate = {
	}
	
	option = { # Invade state
		name = "emex_civic.32.a"
		owner = {
			add_resource = {
				minerals = -500
				alloys = -200
			}
		}
		custom_tooltip = sn_war_option
		hidden_effect = {
			random_list = {
				25 = {
					#it works; replaced by occupied zone
					modifier = {
						factor = 2
						has_planet_flag = neutral_state_dealt
					}
					modifier = {
						factor = 1.5
						has_planet_flag = antagonistic_state_dealt
					}

					# Government Factors #
					# Civics
					modifier = {
						factor = 1.2
						owner = { has_valid_civic = civic_hive_hive_affinity }
					}
					modifier = {
						factor = 1.2
						owner = { has_valid_civic = civic_devouring_swarm }
					}
					modifier = {
						factor = 1.25
						owner = { has_valid_civic = civic_hive_strength_of_legions }
					}
					modifier = {
						factor = 1.15
						owner = { has_valid_civic = civic_hive_voidswarm }
					}
					modifier = {
						factor = 1.1
						owner = { has_valid_civic = civic_hive_eye_in_the_sky }
					}
					# Traditions
					modifier = {
						factor = 1.25
						owner = { has_tradition = tr_supremacy_finish }
					}
					modifier = {
						factor = 1.15
						owner = { has_tradition = tr_domination_finish }
					}
					modifier = {
						factor = 1.05
						owner = { has_tradition = tr_unyielding_finish }
					}
					add_deposit = d_sn_occupied_zone_h
					planet_event = {
						id = emex_civic.43
						days = 180
						random = 180
					}
				}
				25 = {
					#it fails; relations remain the same
					modifier = {
						factor = 1.5
						has_planet_flag = antagonistic_state_dealt
					}
					modifier = {
						factor = 1.5
						has_planet_flag = threatening_state_dealt
					}
					if = {
						limit = {
							has_planet_flag = neutral_state_dealt
						}
						add_blocker = {
							type = d_sn_neutral_nation_h
							blocked_deposit = none
						}
					}
					else_if = {
						limit = {
							has_planet_flag = antagonistic_state_dealt
						}
						add_blocker = {
							type = d_sn_antagonistic_nation_h
							blocked_deposit = none
						}
					}
					else_if = {
						limit = {
							has_planet_flag = threatening_state_dealt
						}
						add_blocker = {
							type = d_sn_threatening_state_h
							blocked_deposit = none
						}
					}
				}
				25 = {
					#it fails; relations worsen
					modifier = {
						factor = 2
						has_planet_flag = neutral_state_dealt
					}
					modifier = {
						factor = 0
						has_planet_flag = threatening_state_dealt
					}
					if = {
						limit = {
							has_planet_flag = neutral_state_dealt
						}
						add_blocker = {
							type = d_sn_antagonistic_nation_h
							blocked_deposit = none
						}
					}
					else_if = {
						limit = {
							has_planet_flag = antagonistic_state_dealt
						}
						add_blocker = {
							type = d_sn_threatening_state_h
							blocked_deposit = none
						}
					}
					else_if = {
						limit = {
							has_planet_flag = threatening_state_dealt
						}
						add_blocker = {
							type = d_sn_threatening_state_h
							blocked_deposit = none
						}
					}
				}
				25 = {
					#partial success; theyre weakened
					modifier = {
						factor = 0
						has_planet_flag = neutral_state_dealt
					}
					if = {
						limit = {
							has_planet_flag = antagonistic_state_dealt
						}
						add_blocker = {
							type = d_sn_neutral_nation_h
							blocked_deposit = none
						}
					}
					else_if = {
						limit = {
							has_planet_flag = threatening_state_dealt
						}
						add_blocker = {
							type = d_sn_antagonistic_nation_h
							blocked_deposit = none
						}
					}
				}
			}
		}
	}
	option = { # Give resources to state
		name = "emex_civic.32.b"
		owner = {
			add_resource = {
				energy = -1000
				minerals = -1000
			}
		}
		custom_tooltip = sn_money_option
		hidden_effect = {
			random_list = {
				25 = {
					#they accept; relations improve
					modifier = {
						factor = 2
						has_planet_flag = neutral_state_dealt
					}
					modifier = {
						factor = 0.5
						has_planet_flag = threatening_state_dealt
					}

					# Government Factors #
					# Civics
					modifier = {
						factor = 1.25
						owner = { has_valid_civic = civic_hive_tech_driven }
					}
					modifier = {
						factor = 1.2
						owner = { has_valid_civic = civic_hive_natural_neural_network }
					}
					modifier = {
						factor = 1.15
						owner = { has_valid_civic = civic_hive_food_focus }
					}
					modifier = {
						factor = 1.1
						owner = { has_valid_civic = civic_hive_catalytic_processing }
					}
					modifier = {
						factor = 1.1
						owner = { has_valid_civic = civic_hive_pooled_knowledge }
					}
					# Traditions
					modifier = {
						factor = 1.25
						owner = { has_tradition = tr_mercantile_finish }
					}
					modifier = {
						factor = 1.15
						owner = { has_tradition = tr_prosperity_finish }
					}
					modifier = {
						factor = 1.05
						owner = { has_tradition = tr_adaptability_finish }
					}
					if = {
						limit = {
							has_planet_flag = neutral_state_dealt
						}
						add_deposit = d_sn_cooperative_nation_h
					}
					else_if = {
						limit = {
							has_planet_flag = antagonistic_state_dealt
						}
						add_blocker = {
							type = d_sn_neutral_nation_h
							blocked_deposit = none
						}
					}
					else_if = {
						limit = {
							has_planet_flag = threatening_state_dealt
						}
						add_blocker = {
							type = d_sn_antagonistic_nation_h
							blocked_deposit = none
						}
					}
				}
				25 = {
					#they reject; relations remain the same
					modifier = {
						factor = 0.5
						has_planet_flag = neutral_state_dealt
					}
					modifier = {
						factor = 0.5
						has_planet_flag = antagonistic_state_dealt
					}
					if = {
						limit = {
							has_planet_flag = neutral_state_dealt
						}
						add_blocker = {
							type = d_sn_neutral_nation_h
							blocked_deposit = none
						}
					}
					else_if = {
						limit = {
							has_planet_flag = antagonistic_state_dealt
						}
						add_blocker = {
							type = d_sn_antagonistic_nation_h
							blocked_deposit = none
						}
					}
					else_if = {
						limit = {
							has_planet_flag = threatening_state_dealt
						}
						add_blocker = {
							type = d_sn_threatening_state_h
							blocked_deposit = none
						}
					}
				}
				# 25 = {
				# 	#they reject; relations worsen
				# 	modifier = {
				# 		factor = 0
				# 		has_planet_flag = neutral_state_dealt
				# 	}
				# 	modifier = {
				# 		factor = 0.25
				# 		has_planet_flag = antagonistic_state_dealt
				# 	}
				# 	modifier = {
				# 		factor = 0.5
				# 		has_planet_flag = threatening_state_dealt
				# 	}
				# }
				25 = {
					#they accept but relations dont improve
					owner = {
						add_resource = {
							energy = -2000
							minerals = -1000
						}
					}
					modifier = {
						factor = 0.5
						has_planet_flag = antagonistic_state_dealt
					}
					if = {
						limit = {
							has_planet_flag = neutral_state_dealt
						}
						add_blocker = {
							type = d_sn_neutral_nation_h
							blocked_deposit = none
						}
					}
					else_if = {
						limit = {
							has_planet_flag = antagonistic_state_dealt
						}
						add_blocker = {
							type = d_sn_antagonistic_nation_h
							blocked_deposit = none
						}
					}
					else_if = {
						limit = {
							has_planet_flag = threatening_state_dealt
						}
						add_blocker = {
							type = d_sn_threatening_state_h
							blocked_deposit = none
						}
					}
				}
			}
		}
	}
	option = { # Improve relations with state
		name = "emex_civic.32.c"
		owner = {
			add_resource = {
				unity = -150
				influence = -50
			}
		}
		custom_tooltip = sn_diplomacy_option
		hidden_effect = {
			random_list = {
				25 = {
					#it works; relations improve
					modifier = {
						factor = 2
						has_planet_flag = neutral_state_dealt
					}
					modifier = {
						factor = 0.5
						has_planet_flag = threatening_state_dealt
					}

					# Government Factors #
					# Civics
					modifier = {
						factor = 1.25
						owner = { has_valid_civic = civic_hive_concerted_befrienders }
					}
					modifier = {
						factor = 1.15
						owner = { has_valid_civic = civic_hive_empath }
					}
					modifier = {
						factor = 1.15
						owner = { has_valid_civic = civic_hive_idyllic_bloom }
					}
					modifier = {
						factor = 1.1
						owner = { has_valid_civic = civic_hive_semi_autonomous_drones }
					}
					modifier = {
						factor = 1.1
						owner = { has_valid_civic = civic_hive_council }
					}
					# Traditions
					modifier = {
						factor = 1.25
						owner = { has_tradition = tr_diplomacy_finish }
					}
					modifier = {
						factor = 1.15
						owner = { has_tradition = tr_harmony_finish }
					}
					modifier = {
						factor = 1.1
						owner = { has_tradition = tr_politics_finish }
					}
					if = {
						limit = {
							has_planet_flag = neutral_state_dealt
						}
						add_deposit = d_sn_cooperative_nation_h
					}
					else_if = {
						limit = {
							has_planet_flag = antagonistic_state_dealt
						}
						add_blocker = {
							type = d_sn_neutral_nation_h
							blocked_deposit = none
						}
					}
					else_if = {
						limit = {
							has_planet_flag = threatening_state_dealt
						}
						add_blocker = {
							type = d_sn_antagonistic_nation_h
							blocked_deposit = none
						}
					}
				}
				25 = {
					#it fails; relations remain the same
					modifier = {
						factor = 1.5
						has_planet_flag = threatening_state_dealt
					}
					if = {
						limit = {
							has_planet_flag = neutral_state_dealt
						}
						add_blocker = {
							type = d_sn_neutral_nation_h
							blocked_deposit = none
						}
					}
					else_if = {
						limit = {
							has_planet_flag = antagonistic_state_dealt
						}
						add_blocker = {
							type = d_sn_antagonistic_nation_h
							blocked_deposit = none
						}
					}
					else_if = {
						limit = {
							has_planet_flag = threatening_state_dealt
						}
						add_blocker = {
							type = d_sn_threatening_state_h
							blocked_deposit = none
						}
					}
				}
				25 = {
					#it fails; relations worsen
					modifier = {
						factor = 0
						has_planet_flag = neutral_state_dealt
					}
					modifier = {
						factor = 0.75
						has_planet_flag = antagonistic_state_dealt
					}
					modifier = {
						factor = 0.5
						has_planet_flag = threatening_state_dealt
					}
					if = {
						limit = {
							has_planet_flag = neutral_state_dealt
						}
						add_blocker = {
							type = d_sn_antagonistic_nation_h
							blocked_deposit = none
						}
					}
					else_if = {
						limit = {
							has_planet_flag = antagonistic_state_dealt
						}
						add_blocker = {
							type = d_sn_threatening_state_h
							blocked_deposit = none
						}
					}
					else_if = {
						limit = {
							has_planet_flag = threatening_state_dealt
						}
						add_blocker = {
							type = d_sn_threatening_state_h
							blocked_deposit = none
						}
					}
				}
				# 25 = {
				# 	#big success
				# 	modifier = {
				# 		factor = 0.5
				# 		has_planet_flag = antagonistic_state_dealt
				# 	}
				# 	modifier = {
				# 		factor = 0
				# 		has_planet_flag = threatening_state_dealt
				# 	}
				# }
			}
		}
	}
}

#Sovereign Nations; occupied zone replaced by cooperative nation
planet_event = {
	id = emex_civic.43
	title = "emex_civic.33.name"
	desc = "emex_civic.33.desc"
	picture = GFX_evt_tradedeal
	location = root
	
	is_triggered_only = yes
	
	immediate = {
	}
	
	option = {
		name = "emex_civic.33.a"
		remove_deposit = d_sn_occupied_zone_h
		add_deposit = d_sn_cooperative_nation_h
	}
}

# Symbiosis/Caretakers: On terraforming
planet_event = {
	id = emex_civic.44
	hide_window = yes
	
	is_triggered_only = yes
	
	trigger = {
		from = {
			OR = {
				has_valid_civic = civic_hive_environmental_integration
				has_valid_civic = civic_machine_environmental_caretakers
			}
		}
		this = {
			has_owner = yes
		}
	}
	
	immediate = {
		if = {
			limit = { owner = { has_valid_civic = civic_hive_environmental_integration } }
			apply_symbiosis_pm = yes
		}
		else_if = {
			limit = { owner = { has_valid_civic = civic_machine_environmental_caretakers } }
			apply_caretaker_pm = yes
		}
		else = {
			remove_symbiosis_pm = yes
			remove_caretaker_pm = yes
		}
	}
}

# Symbiosis/Caretakers: On planet transfer
planet_event = {
	id = emex_civic.45
	hide_window = yes
	
	is_triggered_only = yes
	
	trigger = {
		OR = {
			from = {
				OR = {
					has_valid_civic = civic_machine_environmental_caretakers
					has_valid_civic = civic_hive_environmental_integration
				}
			}
			if = {
				limit = { exists = fromfrom }
				fromfrom = {
					OR = {
						has_valid_civic = civic_machine_environmental_caretakers
						has_valid_civic = civic_hive_environmental_integration
					}
				}
			}
		}
	}
	
	immediate = {
		if = {
			limit = { from = { has_valid_civic = civic_hive_environmental_integration } }
			apply_symbiosis_pm = yes
		}
		else = {
			remove_symbiosis_pm = yes
		}
		if = {
			limit = { from = { has_valid_civic = civic_machine_environmental_caretakers } }
			apply_caretaker_pm = yes
		}
		else = {
			remove_caretaker_pm = yes
		}
	}
}

# Symbiosis/Caretakers: On districts change
planet_event = {
	id = emex_civic.46
	hide_window = yes
	
	is_triggered_only = yes
	
	trigger = {
		owner = {
			OR = {
				has_valid_civic = civic_hive_environmental_integration
				has_valid_civic = civic_machine_environmental_caretakers
			}
		}
	}
	
	immediate = {
		if = {
			limit = { owner = { has_valid_civic = civic_hive_environmental_integration } }
			apply_symbiosis_pm = yes
		}
		else_if = {
			limit = { owner = { has_valid_civic = civic_machine_environmental_caretakers } }
			apply_caretaker_pm = yes
		}
	}
}

# Self-Replicating Machines - Nanite Deficit
country_event = {
	id = emex_civic.47
	hide_window = yes
	
	is_triggered_only = yes
	
	trigger = {
		has_valid_civic = civic_machine_selfreplicating_machines
	}
	
	immediate = {
		if = {
			limit = {
				has_monthly_income = { resource = nanites  value >= 0 }
			}
			remove_modifier = srm_nanite_deficit
		}
		else_if = {
			limit = {
				has_monthly_income = { resource = nanites  value < 0 }
			}
			add_modifier = {
				modifier = srm_nanite_deficit
			}
		}
	}
}

# Blight Operation: I
espionage_operation_event = {
	id = emex_civic.48
	title = emex_civic.48.name
	desc = {
		text = emex_civic.48.desc.a
		trigger = {
			owner = {
				NOT = { has_country_flag = cannot_blight_steel_foundation@root.target }
			}
		}
	}
	desc = {
		text = emex_civic.48.desc.b
		trigger = {
			owner = {
				has_country_flag = cannot_blight_steel_foundation@root.target
			}
		}
	}
	picture = GFX_evt_civil_action
	show_sound = event_default
	
	is_triggered_only = yes
	espionage_operation = yes

	immediate = {
		if = {
			limit = {
				target = { has_ascension_perk = ap_steel_foundation }
			}
			set_espionage_operation_progress_locked = yes
			owner = {
				set_country_flag = cannot_blight_steel_foundation@root.target
				country_event = { id = emex_civic.60 }
			}
		}
		else = {
			set_espionage_operation_flag = emex_blight_operation
		}
	}

	option = {
		name = CURIOUS
		trigger = {
			owner = { has_country_flag = cannot_blight_steel_foundation@root.target }
		}
	}
	option = {
		name = ACKNOWLEDGED
		trigger = {
			owner = {
				NOT = { has_country_flag = cannot_blight_steel_foundation@root.target }
			}
		}
	}
}

# Blight Operation: II
espionage_operation_event = {
	id = emex_civic.49
	title = emex_civic.49.name
	desc = "emex_civic.49.desc"
	picture = GFX_evt_hand_shake
	show_sound = event_default
	
	is_triggered_only = yes
	espionage_operation = yes

	immediate = { }

	option = { name = OK }
}

# Blight Operation: III
espionage_operation_event = {
	id = emex_civic.50
	title = emex_civic.50.name
	desc = "emex_civic.50.desc"
	picture = GFX_evt_mercenary_enclave
	show_sound = event_default
	
	is_triggered_only = yes
	espionage_operation = yes

	immediate = {
		set_espionage_operation_progress_locked = yes
	}
	
	after = {
		set_espionage_operation_progress_locked = no
	}

	option = {
		name = LAUNCH_OPERATION
		custom_tooltip = emex_blight_effect_time
		hidden_effect = {
			owner = {
				save_global_event_target_as = emex_blight_actor@root.target
				set_country_flag = emex_blight_actor@root.target
				#country_event = { id = emex_civic.57 days = 720 } # Outcome Potential
			}
			target = {
				country_event = { id = emex_civic.55 } # Target's Event
				country_event = { id = emex_civic.56 days = 720 } # Outcome Potential
			}
		}
	}
}

# Target - Begin Counter Espionage Situation
country_event = {
	id = emex_civic.55
	title = "emex_civic.55.name"
	desc = "emex_civic.55.desc"
	picture = GFX_evt_civil_action
	
	is_triggered_only = yes
	
	immediate = {
		start_situation = {
			type = emex_counter_blight
			target = root
		}
	}
	
	option = {
		name = "emex_civic.55.a"
		custom_tooltip = emex_blight_counteraction
	}
}

# We Survive Blight
country_event = {
	id = emex_civic.56
	title = "emex_civic.56.name"
	desc = "emex_civic.56.desc"
	picture = GFX_evt_civil_action
	
	is_triggered_only = yes
	
	trigger = {
		any_situation = {
			is_situation_type = emex_counter_blight
		}
	}
	
	immediate = {
		random_situation = {
			limit = {
				is_situation_type = emex_counter_blight
			}
			destroy_situation = this
		}
		set_timed_country_flag = {
			flag = immune_to_blight_temporarily
			days = 3600
		}
		event_target:emex_blight_actor@root = { #check finding
			country_event = { id = emex_civic.57 }
		}
	}
	
	option = {
		name = "emex_civic.56.a"
		custom_tooltip = emex_blight_cooldown
	}
}

# Target Survives Blight
country_event = {
	id = emex_civic.57
	title = "emex_civic.57.name"
	desc = "emex_civic.57.desc"
	picture = GFX_evt_civil_action
	
	is_triggered_only = yes
	
	trigger = {
	}
	
	immediate = {
		set_timed_country_flag = {
			flag = cannot_blight_temporarily
			days = 3600
		}
	}
	
	option = {
		name = "emex_civic.57.a"
		custom_tooltip = emex_blight_cooldown_actor
	}
}

# Blight Operation Invalid (Foundation of Steel)
country_event = {
	id = emex_civic.60
	title = emex_civic.60.name
	desc = emex_civic.60.desc
	picture = GFX_evt_ongoing_disaster
	show_sound = event_default
	is_triggered_only = yes

	option = {
		name = INTRIGUING
	}

	after = {
		hidden_effect = {
			from = {
				fire_on_action = { on_action = on_operation_cancelled }
			}
		}
		destroy_espionage_operation = from
	}
}

# Blight Operation Completed
country_event = {
	id = emex_civic.61
	title = emex_civic.61.name
	desc = emex_civic.61.desc
	picture = GFX_evt_open_revolt
	show_sound = event_default
	is_triggered_only = yes

	option = {
		name = "emex_civic.61.a"
		custom_tooltip = emex_blight_civic_applied
	}

	immediate = {
		event_target:emex_blight_actor@root = { #check finding
			country_event = { id = emex_civic.62 }
		}
		set_timed_country_flag = {
			flag = immune_to_blight_temporarily
			days = 10800
		}
		random_list = {
			20 = {
				force_add_civic = civic_blight_anarchism
			}
			20 = {
				force_add_civic = civic_blight_paranoia
			}
			20 = {
				force_add_civic = civic_blight_vigilantes
			}
			20 = {
				force_add_civic = civic_blight_tension 
			}
			20 = {
				force_add_civic = civic_blight_elitism
			}
		}
	}
}

# Blight Operation Successful
country_event = {
	id = emex_civic.62
	title = emex_civic.62.name
	desc = emex_civic.62.desc
	picture = GFX_evt_open_revolt
	show_sound = event_default
	is_triggered_only = yes

	option = {
		name = "emex_civic.62.a"
	}

	immediate = {
	}
}

# Peacekeeping: Provisional State - 10 years passed
country_event = {
	id = emex_civic.65
	title = emex_civic.65.name
	desc = emex_civic.65.desc
	picture = GFX_evt_acquire_asset
	show_sound = event_default
	
	is_triggered_only = yes

	option = {
		name = "emex_civic.65.a" # We shall remain loyal
		every_agreement = {
			set_agreement_preset = {
				preset = preset_vassal
				apply_terms = no
			}
		}
	}
	option = {
		name = "emex_civic.65.b" # We wish for independence
		overlord = { country_event = { id = emex_civic.66 } }
		set_country_flag = emex_peacekeeper_independence
		save_event_target_as = emex_peacekeeper_independence
	}
}

# Peacekeeping: Provisional State - Overlord Choice
country_event = {
	id = emex_civic.66
	title = emex_civic.66.name
	desc = emex_civic.66.desc
	picture = GFX_evt_gunrunning
	show_sound = event_default
	
	is_triggered_only = yes

	option = {
		name = "emex_civic.66.a" # They shall earn their freedom
		random_subject = {
			limit = { has_country_flag = emex_peacekeeper_independence }
			set_subject_of = { who = none }
		}
		remove_country_flag = emex_peacekeeper_independence
	}
	option = {
		name = "emex_civic.66.b" # We must continue to watch over them
		random_subject = {
			limit = { has_country_flag = emex_peacekeeper_independence }
			country_event = { id = emex_civic.67 }
		}
		remove_country_flag = emex_peacekeeper_independence
	}
}

# Peacekeeping: Provisional State - Overlord Refused
country_event = {
	id = emex_civic.67
	title = emex_civic.67.name
	desc = emex_civic.67.desc
	picture = GFX_evt_gunrunning
	show_sound = event_default
	
	is_triggered_only = yes

	option = {
		name = "emex_civic.67.a" # They shall earn their freedom
	}
}