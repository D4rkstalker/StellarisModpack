
#########################################
#
# on_action_events
#
#########################################

namespace = acot_exterminatus_event


# Planet is turned into tomb world by Exterminatus bombing stance
planet_event = {
	id = acot_exterminatus_event.1
	hide_window = yes

	is_triggered_only = yes
	
	trigger = {
		has_orbital_bombardment_stance = exterminatus
		from = {
			OR = {
				is_country_type = default
				is_country_type = fallen_empire
				is_country_type = awakened_fallen_empire
				is_country_type = ascended_empire
				is_country_type = lost_empire
			}
		}
		OR = {
			habitable_planet = yes		
			is_planet_class = pc_ringworld_habitable
			is_planet_class = pc_habitat	
		}
	}
	
	immediate = {
		add_threat = { who = from amount = 2 }
		every_owned_pop = {
			kill_pop = yes
		}
		owner = { 
			add_static_war_exhaustion = {
				attacker = from
				location = root
				value_for_planet_destruction = 0.5
			}
			country_event = { id = acot_exterminatus_event.2 } 
		}
		from = { country_event = { id = acot_exterminatus_event.3 } }
		remove_all_buildings = yes
		reroll_deposits = yes
		remove_modifier = "natural_beauty"
		remove_modifier = "atmospheric_aphrodisiac"
		remove_modifier = "atmospheric_hallucinogen"
		remove_modifier = "lush_planet"		
		remove_modifier = "dangerous_wildlife"
		if = {
			limit = {
				habitable_planet = yes	
				NOR = {
					is_planet_class = pc_ringworld_habitable
					is_planet_class = pc_habitat
				}
			}
			change_pc = pc_molten
			add_modifier = {
				modifier = "terraforming_candidate"
				days = -1
			}
		}
		else = {
			if = {
				limit = { is_planet_class = pc_ringworld_habitable }
				change_pc = pc_ringworld_habitable_damaged
				spawn_ringworld_cracker_effect = yes
			}
			if = {
				limit = { is_planet_class = pc_habitat }
				remove_planet = yes
				spawn_habitat_cracker_effect = yes
			}
		}
	}
}

# Planet is turned into tomb world by Armageddon bombing stance (former owner)
country_event = {
	id = acot_exterminatus_event.2
	title = "exterminatus_event.2.name"
	picture = GFX_evt_nuclear_explosion
	desc = exterminatus_event.2.desc
	show_sound = event_super_explosion
	location = from
	
	is_triggered_only = yes
	
	option = {
		name = exterminatus_event.2.a
		custom_tooltip = bombed_to_molten_world
	}
}

# Planet is turned into tomb world by Armageddon bombing stance (bombarder)
country_event = {
	id = acot_exterminatus_event.3
	title = "exterminatus_event.2.name"
	picture = GFX_evt_nuclear_explosion
	desc = exterminatus_event.3.desc
	show_sound = event_super_explosion
	location = from
	
	is_triggered_only = yes
	
	option = {
		name = exterminatus_event.3.a
		custom_tooltip = bombed_to_molten_world
	}
}


# Planet is turned into meme after Final Destination
planet_event = {
	id = acot_exterminatus_event.4
	hide_window = yes

	is_triggered_only = yes
	
	trigger = {
		has_orbital_bombardment_stance = final_destionation
		OR = {
			habitable_planet = yes
			habitable_structure = yes			
		}
		THIS = {
			owner = {
				is_progenitor_empires = no
			}
		}
	}
	
	immediate = {
		save_event_target_as = showered_planet
		add_threat = { who = from amount = 2 }
		every_owned_pop = {
			kill_pop = yes
		}
		owner = { 
			add_static_war_exhaustion = {
				attacker = from
				location = root
				value_for_planet_destruction = 0.5
			}
			country_event = { id = acot_exterminatus_event.6 } 
		}
		remove_all_buildings = yes
		reroll_deposits = yes
		if = {
			limit = {
				NOR = {
					is_planet_class = pc_ringworld_habitable
					is_planet_class = pc_habitat
				}
			}
			from = { country_event = { id = acot_exterminatus_event.5 } }
		}
		else = {
			if = {
				limit = { is_planet_class = pc_ringworld_habitable }
				spawn_ringworld_divine_effect = yes
			}
			if = {
				limit = { is_planet_class = pc_habitat }
				remove_planet = yes
				spawn_habitat_divine_effect = yes
			}
		}
	}
}

# Choose what to do with this planet
country_event = {
	id = acot_exterminatus_event.5
	title = "exterminatus_event.5.name"
	picture = GFX_evt_nuclear_explosion
	desc = exterminatus_event.5.desc
	show_sound = event_super_explosion
	location = event_target:showered_planet
	
	is_triggered_only = yes
	
	option = {
		name = exterminatus_event.5.a
		hidden_effect = {
			event_target:showered_planet = {
				change_pc = pc_goodman_gaia_world
				if = {
					limit = { NOT = { has_modifier = natural_beauty } }	
					add_modifier = {
						modifier = "natural_beauty"
					}
				}
			}	
		}
	}

	option = {
		name = exterminatus_event.5.b
		hidden_effect = {
			event_target:showered_planet = {
				change_pc = pc_gaia
				if = {
					limit = { NOT = { has_modifier = natural_beauty } }	
					add_modifier = {
						modifier = "natural_beauty"
					}
				}
			}			
		}
	}

	option = {
		name = exterminatus_event.5.c
		custom_tooltip = bombed_to_molten_world
		hidden_effect = {
			event_target:showered_planet = {
				change_pc = pc_molten
				remove_modifier = "natural_beauty"
				remove_modifier = "atmospheric_aphrodisiac"
				remove_modifier = "atmospheric_hallucinogen"
				remove_modifier = "lush_planet"		
				remove_modifier = "dangerous_wildlife"
				add_modifier = {
					modifier = "terraforming_candidate"
					days = -1
				}
			}			
		}
	}

	option = {
		name = exterminatus_event.5.d
		custom_tooltip = bombed_to_star
		hidden_effect = {
			event_target:showered_planet = {
				change_pc = pc_g_star
				remove_all_buildings = yes
				reroll_deposits = yes
				remove_modifier = "natural_beauty"
				remove_modifier = "atmospheric_aphrodisiac"
				remove_modifier = "atmospheric_hallucinogen"
				remove_modifier = "lush_planet"		
				remove_modifier = "dangerous_wildlife"
			}		
		}
	}
}

# Planet is turned into tomb world by Armageddon bombing stance (former owner)
country_event = {
	id = acot_exterminatus_event.6
	title = "exterminatus_event.5.name"
	picture = GFX_evt_nuclear_explosion
	desc = exterminatus_event.6.desc
	show_sound = event_super_explosion
	location = from
	
	is_triggered_only = yes
	
	option = {
		name = exterminatus_event.6.a
	}
}