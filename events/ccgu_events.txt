namespace = ccopinions

#yearly
event = {
	id = ccopinions.2
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		if = {
			limit = {		
				any_country = {
					galaxy_percentage > 15
					OR = { is_country_type = default
						is_country_type = awakened_fallen_empire
					}
					has_technology = tech_galactic_unification
					has_policy_flag = cc_pursuing_gu
				}
			}
			every_country = {
				limit = {
					is_subject = no
					is_country_type = default
					NOT = { has_policy_flag = cc_pursuing_gu }
				}

				every_country = {
					limit = {
						has_communications = PREV
						NOT = { is_country = PREV }
						NOT = { has_policy_flag = cc_pursuing_gu }
						is_country_type = default
						is_subject = no
					}

					add_opinion_modifier = { who = prev modifier = opinion_empire_threat }
				}
			}
		}
	}
}

#Game Start
event = {
	id = ccopinions.21
	title = OK
	desc = OK
	is_triggered_only = yes
	
	hide_window = yes
	
	trigger = {	any_country = { num_fallen_empires > 3 } }
	
	immediate = {
		set_global_flag = ccgu_can_awaken
	}
}

#Yearly pulse
# Sleepers Awake
event = {
	id = ccopinions.3
	title = OK
	desc = OK
	is_triggered_only = yes
	
	hide_window = yes
	
	trigger = {
		years_passed > 115
		
		has_global_flag = ccgu_can_awaken
		NOT = { has_global_flag = galactic_unification_awaken }

		any_country = {
			is_country_type = default
			has_technology = "tech_galactic_unification"
			has_policy_flag = cc_pursuing_gu
			galaxy_percentage > 15
		}
	}
		
	immediate = {
		random_country = {
			if = {
				limit = {
					is_country_type = default
					has_technology = "tech_galactic_unification"
					has_policy_flag = cc_pursuing_gu
					galaxy_percentage > 15
				}
			}
			save_event_target_as = upstarts
		}
		
		if = {
			limit = {
				any_country = {
					is_country_type = fallen_empire
					OR = {
						has_ethic = ethic_fanatic_militarist
						has_ethic = ethic_militarist
					}
				}
			}
			every_country = {
				limit = {
					is_country_type = fallen_empire
					OR = {
						has_ethic = ethic_fanatic_militarist
						has_ethic = ethic_militarist
					}
				}
				save_event_target_as = militarist_avengers
			}
			
			else = { set_global_flag = no_militarist_fe }
		}
		
		
		if = {
			limit = {
				exists = event_target:militarist_avengers
			}
			random_country = {
				if = {
					limit = {
						is_country_type = fallen_empire
						OR = {
							has_ethic = ethic_fanatic_militarist
							has_ethic = ethic_militarist
						}
						NOT = { has_country_flag = sleepers_awake_ancient_rival }
						is_at_war = no
					}
					if = {
						limit {
							event_target:upstarts = { galaxy_percentage < 20 }
						}
						random = {
							chance = 20
							
							country_event = { id = fallen_empires_awakening.3 }
							
							add_opinion_modifier = {
								who = event_target:upstarts
								modifier = opinion_galactic_challenge
							}
							country_event = { id = ccopinions.10 days = 3 }
									
							# Notify players
							every_country = {
								limit = {
									is_ai = no			
								}
								country_event = { id = ccopinions.7 }
							}
						}
					}
					if = {
						limit {
							event_target:upstarts = {
							galaxy_percentage > 20
							galaxy_percentage < 30 }
						}
						random = {
							chance = 50
							
							country_event = { id = fallen_empires_awakening.3 }
							
							add_opinion_modifier = {
								who = event_target:upstarts
								modifier = opinion_galactic_challenge
							}
							country_event = { id = ccopinions.10 }
									
							# Notify players
							every_country = {
								limit = {
									is_ai = no			
								}
								country_event = { id = ccopinions.7 }
							}
						}
					}
					if = {
						limit {
							event_target:upstarts = { galaxy_percentage > 30 }
						}
						
						country_event = { id = fallen_empires_awakening.3 }
						
						add_opinion_modifier = {
							who = event_target:upstarts
							modifier = opinion_galactic_challenge
						}
						country_event = { id = ccopinions.10 }
								
						# Notify players
						every_country = {
							limit = {
								is_ai = no			
							}
							country_event = { id = ccopinions.7 }
						}
					}
				}
			}
			else = {
				if = {
					limit = {
						has_global_flag = no_militarist_fe
					}
					random_country = {
						if = {
							limit = {
								is_country_type = fallen_empire
								is_at_war = no
								NOT = { has_country_flag = sleepers_awake_ancient_rival }
								OR = {
									AND = {
										OR = {
											has_ethic = ethic_fanatic_xenophobe
											has_ethic = ethic_xenophobe
										}
										event_target:upstarts = { 
											OR = {
												has_ethic = ethic_fanatic_xenophile
												has_ethic = ethic_xenophile
											}
										}
									}
									AND = {
										OR = {
											has_ethic = ethic_fanatic_xenophile
											has_ethic = ethic_xenophile
										}
										event_target:upstarts = { 
											OR = {
												has_ethic = ethic_fanatic_xenophobe
												has_ethic = ethic_xenophobe
											}
										}
									}
									AND = {
										OR = {
											has_ethic = ethic_fanatic_spiritualist
											has_ethic = ethic_spiritualist
										}
										event_target:upstarts = { 
											OR = {
												has_ethic = ethic_fanatic_materialist
												has_ethic = ethic_materialist
											}
										}
									}
									AND = {
										OR = {
											has_ethic = ethic_fanatic_materialist
											has_ethic = ethic_materialist
										}
										event_target:upstarts = { 
											OR = {
												has_ethic = ethic_fanatic_spiritualist
												has_ethic = ethic_spiritualist
											}
										}
									}
								}
							}
							if = {
								limit {
									event_target:upstarts = { galaxy_percentage < 20 }
								}
								random = {
									chance = 5
									
									save_event_target_as = GUAwakers
									country_event = { id = fallen_empires_awakening.3 }
							
									add_opinion_modifier = {
										who = event_target:upstarts
										modifier = opinion_galactic_challenge
									}
									country_event = { id = ccopinions.10 }
									
									# Notify players
									every_country = {
										limit = {
											is_ai = no			
										}
										country_event = { id = ccopinions.4 }
									}
								}
							}
							if = {
								limit {
									event_target:upstarts = {
									galaxy_percentage > 20
									galaxy_percentage < 30 }
								}
								
								random = {
									chance = 10
									
									save_event_target_as = GUAwakers
									country_event = { id = fallen_empires_awakening.3 }
							
									add_opinion_modifier = {
										who = event_target:upstarts
										modifier = opinion_galactic_challenge
									}
									country_event = { id = ccopinions.10 }
									
									# Notify players
									every_country = {
										limit = {
											is_ai = no			
										}
										country_event = { id = ccopinions.4 }
									}
								}
							}
							if = {
								limit {
									event_target:upstarts = { galaxy_percentage > 30 }
								}
								random = {
									chance = 25
									
									save_event_target_as = GUAwakers
									country_event = { id = fallen_empires_awakening.3 }
							
									add_opinion_modifier = {
										who = event_target:upstarts
										modifier = opinion_galactic_challenge
									}
									country_event = { id = ccopinions.10 }
									
									# Notify players
									every_country = {
										limit = {
											is_ai = no			
										}
										country_event = { id = ccopinions.4 }
									}
								}
							}
						}
					}
				}
			}
		}
	}
}

country_event = {
	id = ccopinions.4
	hide_window = yes
	
	is_triggered_only = yes

	immediate = {
		set_global_flag = galactic_unification_awaken
		
		if = {
			limit = {
				event_target:upstarts = { is_ai = no }
			}
			country_event = { id = ccopinions.5 }

			else = {
				every_country = {
					limit = {
						is_ai = no			
					}
					country_event = { id = ccopinions.6 }				
				}
			}
		}
	}
}

country_event = {
	id = ccopinions.5
	title = ccopinions.5.name
	desc = ccopinions.5.desc
	picture = GFX_evt_fallen_empire
	show_sound = event_alien_signal
	location = from
	
	is_triggered_only = yes

	option = {
		name = ccopinions.5.a	
	}
}

country_event = {
	id = ccopinions.6
	title = ccopinions.6.name
	desc = ccopinions.6.desc
	picture = GFX_evt_fallen_empire
	show_sound = event_alien_signal
	location = from
	
	is_triggered_only = yes

	option = {
		name = ccopinions.6.a	
	}
}


country_event = {
	id = ccopinions.7
	hide_window = yes
	
	is_triggered_only = yes

	immediate = {
		set_global_flag = galactic_unification_awaken
		
		if = {
			limit = {
				event_target:upstarts = { is_ai = no }
			}
			country_event = { id = ccopinions.8 }

			else = {
				every_country = {
					limit = {
						is_ai = no			
					}
					country_event = { id = ccopinions.9 }				
				}
			}
		}
	}
}

country_event = {
	id = ccopinions.8
	title = ccopinions.8.name
	desc = ccopinions.8.desc
	picture = GFX_evt_fallen_empire
	show_sound = event_alien_signal
	location = from
	
	is_triggered_only = yes

	option = {
		name = ccopinions.8.a	
	}
}

country_event = {
	id = ccopinions.9
	title = ccopinions.9.name
	desc = ccopinions.9.desc
	picture = GFX_evt_fallen_empire
	show_sound = event_alien_signal
	location = from
	
	is_triggered_only = yes

	option = {
		name = ccopinions.9.a	
	}
}

country_event = {
	id = ccopinions.10
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		declare_war = {
			who = event_target:upstarts
		}
	}
}



country_event = {
	id = ccopinions.12
	hide_window = yes
	is_triggered_only = yes
	
	trigger = { last_increased_tech = "tech_galactic_unification" }
	
	immediate = {
		set_policy = {
			policy = ccgu_galactic_unification
			option = pursue_gu
			cooldown = yes
		}
		set_timed_country_flag = {
			flag = cc_recent_gu_embrace
			days = 360
		}

		save_event_target_as = cc_gu_actor
		
		if = {
			limit = { is_country_type = default }
			
			every_country = {
				limit = {
					is_ai = no
					NOT = { is_same_value = root }	
				}
				
				if = {
					limit = { has_technology = tech_galactic_unification }
					country_event = { id = ccopinions.121 }
					
					else = {
						if = {
							limit = {
								OR = {
									relative_power = {
										who = root
										category = fleet
										value = overwhelming
									}
									relative_power = {
										who = root
										category = fleet
										value = superior
									}
								}
							}
							country_event = { id = ccopinions.122 }
						}
						
						if = {
							limit = {
								OR = {
									relative_power = {
										who = root
										category = fleet
										value = inferior
									}
									relative_power = {
										who = root
										category = fleet
										value = pathetic
									}
								}
							}
							country_event = { id = ccopinions.123 }
						}
						
						if = {
							limit = {
								OR = {
									relative_power = {
										who = root
										category = fleet
										value = equal
									}
								}
							}
							country_event = { id = ccopinions.124 }
						}
					}
				}
			}
			every_country = {
				limit = {
					NOT = { is_same_value = root }
					NOT = { has_communications = root }
				}
				establish_communications_no_message = root
			}
		}
	}
}

#write these properly
country_event = {
	id = ccopinions.121
	title = ccopinions.121.name
	desc = ccopinions.121.desc
	picture = evt_fleet_evil
	
	is_triggered_only = yes
	
	option = {
		name = ccopinions.121.option
	}
}

country_event = {
	id = ccopinions.122
	title = ccopinions.122.name
	desc = ccopinions.122.desc
	picture = evt_fleet_evil
	
	is_triggered_only = yes
	
	option = {
		name = ccopinions.122.option
	}
}

country_event = {
	id = ccopinions.123
	title = ccopinions.123.name
	desc = ccopinions.123.desc
	picture = evt_fleet_evil
	
	is_triggered_only = yes
	
	option = {
		name = ccopinions.123.option
	}	
}

country_event = {
	id = ccopinions.124
	title = ccopinions.124.name
	desc = ccopinions.124.desc
	picture = evt_fleet_evil
	
	is_triggered_only = yes
	
	option = {
		name = ccopinions.124.option
	}	
}


country_event = {
	id = ccopinions.18
	is_triggered_only = yes
	hide_window = yes
	
	trigger = {
		last_changed_policy = ccgu_galactic_unification
		NOT = { has_country_flag = cc_recent_gu_embrace }
	}
	
	immediate = {
		save_event_target_as = cc_gu_actor
		
		if = {
			limit = {
				has_policy_flag = cc_pursuing_gu
				is_country_type = default
			}
			
					
			every_country = {
				limit = {
					is_ai = no
					NOT = { is_same_value = root }	
				}
				
				if = {
					limit = { has_technology = tech_galactic_unification }
					country_event = { id = ccopinions.121 }
					
					else = {
						if = {
							limit = {
								OR = {
									relative_power = {
										who = root
										category = fleet
										value = overwhelming
									}
									relative_power = {
										who = root
										category = fleet
										value = superior
									}
								}
							}
							country_event = { id = ccopinions.122 }
						}
						
						if = {
							limit = {
								OR = {
									relative_power = {
										who = root
										category = fleet
										value = inferior
									}
									relative_power = {
										who = root
										category = fleet
										value = pathetic
									}
								}
							}
							country_event = { id = ccopinions.123 }
						}
						
						if = {
							limit = {
								OR = {
									relative_power = {
										who = root
										category = fleet
										value = equal
									}
								}
							}
							country_event = { id = ccopinions.124 }
						}
					}
				}
			}
		}
		
		if = {
			limit = {
				has_policy_flag = cc_renounced_gu
				is_country_type = default
			}
			
			
			if = {
				limit = {
					any_country = {
						has_opinion_modifier = {
							who = root
							modifier = opinion_galactic_challenge
						}
					}
				}
				every_country = {
					limit = {
						has_opinion_modifier = {
							who = root
							modifier = opinion_galactic_challenge
						}
					}
					remove_opinion_modifier = {
						who = root
						modifier = opinion_galactic_challenge
					}
				}
			}
				
			
			if = {
				limit = { has_modifier = humiliated }
				remove_modifier = humiliated
			}
			add_modifier = {
				modifier = ccgu_humiliated
				days = -1
			}
			country_event = { id = ccopinions.189 }
					
			every_country = {
				limit = {
					is_ai = no
					NOT = { is_same_value = root }			
				}
				
				if = {
					limit = { has_technology = tech_galactic_unification }
					country_event = { id = ccopinions.185 }
					
					else = {
						if = {
							limit = {
								OR = {
									relative_power = {
										who = root
										category = fleet
										value = overwhelming
									}
									relative_power = {
										who = root
										category = fleet
										value = superior
									}
								}
							}
							country_event = { id = ccopinions.186 }
						}
						
						if = {
							limit = {
								OR = {
									relative_power = {
										who = root
										category = fleet
										value = inferior
									}
									relative_power = {
										who = root
										category = fleet
										value = pathetic
									}
								}
							}
							country_event = { id = ccopinions.187 }
						}
						
						if = {
							limit = {
								OR = {
									relative_power = {
										who = root
										category = fleet
										value = equal
									}
								}
							}
							country_event = { id = ccopinions.188 }
						}
					}
				}
			}
		}
	}
}


country_event = {
	id = ccopinions.181
	title = ccopinions.181.name
	desc = ccopinions.181.desc
	picture = evt_fleet_evil
	
	is_triggered_only = yes
	
	option = { name = ccopinions.181.option }
}

country_event = {
	id = ccopinions.182
	title = ccopinions.182.name
	desc = ccopinions.182.desc
	picture = evt_fleet_evil
	
	is_triggered_only = yes
	
	option = { name = ccopinions.182.option }
}

country_event = {
	id = ccopinions.183
	title = ccopinions.183.name
	desc = ccopinions.183.desc
	picture = evt_fleet_evil
	
	is_triggered_only = yes
	
	option = { name = ccopinions.183.option }
}

country_event = {
	id = ccopinions.184
	title = ccopinions.184.name
	desc = ccopinions.184.desc
	picture = evt_fleet_evil
	
	is_triggered_only = yes
	
	option = { name = ccopinions.184.option }
}

country_event = {
	id = ccopinions.185
	title = ccopinions.185.name
	desc = ccopinions.185.desc
	picture = evt_fleet_good
	
	is_triggered_only = yes
	
	option = { name = ccopinions.185.option }
}

country_event = {
	id = ccopinions.186
	title = ccopinions.186.name
	desc = ccopinions.186.desc
	picture = evt_fleet_good
	
	is_triggered_only = yes
	
	option = { name = ccopinions.186.option }
}

country_event = {
	id = ccopinions.187
	title = ccopinions.187.name
	desc = ccopinions.187.desc
	picture = evt_fleet_good
	
	is_triggered_only = yes
	
	option = { name = ccopinions.187.option }
}

country_event = {
	id = ccopinions.188
	title = ccopinions.188.name
	desc = ccopinions.188.desc
	picture = evt_fleet_good
	
	is_triggered_only = yes
	
	option = { name = ccopinions.188.option }
}

country_event = {
	id = ccopinions.189
	title = ccopinions.189.name
	desc = ccopinions.189.desc
	picture = evt_exploding_planet
	
	is_triggered_only = yes
	
	option = { name = UNFORTUNATE }
}
