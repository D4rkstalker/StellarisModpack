namespace = bw_cybertronian


country_event = {
	id = bw_cybertronian.1
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		has_origin = origin_bw_cybertron
	}

	immediate = {
		capital_scope = {
			clear_deposits = yes
			clear_blockers = yes
			add_deposit = d_cybertropolis
			add_deposit = d_cybertron_citadel
			add_deposit = d_cybertron_archives
			add_deposit = d_crystal_city
			add_deposit = d_cybertronian_city
			add_deposit = d_cybertronian_city
			add_deposit = d_cybertronian_city
			add_deposit = d_teletraan_one
			add_deposit = d_restored_cybertron_core
			add_deposit = d_energon_bridge
			add_deposit = d_active_well_of_all_sparks
			add_deposit = d_space_bridge
			add_deposit = d_energon_crystals
		}
	}
}

country_event = {
	id = bw_cybertronian.2
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		capital_scope = {
			if = {
				limit = { has_planet_flag = vehicon_cybertron }
				clear_deposits = yes
				clear_blockers = yes
				add_deposit = d_cybertropolis
				add_deposit = d_cybertron_citadel
				add_deposit = d_cybertron_archives
				add_deposit = d_vehicon_factory
				add_deposit = d_crystal_city
				add_deposit = d_cybertronian_city
				add_deposit = d_cybertronian_city
				add_deposit = d_cybertronian_city
				add_deposit = d_teletraan_one
				add_deposit = d_restored_cybertron_core
				add_deposit = d_energon_bridge
				add_deposit = d_space_bridge
				add_deposit = d_energon_crystals
			}
		}
	}
}

country_event = {
	id = bw_cybertronian.3
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		has_origin = origin_bw_cybertron
		NOT = {
			has_authority = auth_machine_intelligence
		}
	}

	immediate = {
		capital_scope = {
			create_species = {
				name = "Predacon"
				plural = "Predacons"
				adjective = "Predacon"
				name_list = "predacon"
				class = "cybertronian"
				portrait = "predacon"
				traits = {
					trait = trait_mechanical
					trait = trait_bw_cybertronian
					trait = trait_robot_predacon
					trait = trait_energon_dependence
				}
			}
		}
		capital_scope = {
			while = {
				random_pop = {
					limit = {
						is_same_species = owner_species
					}
					kill_pop = yes
				}
				count = 8
			}
		}
		capital_scope = {
			while = {
				count = 8
				create_pop = {
					species = "Predacon"
				}
			}
		}
		every_owned_pop = {
			limit = { has_trait = "trait_robot_predacon" }
			set_citizenship_type = {
				type = citizenship_limited
				cooldown = no
			}
			set_military_service_type = {
				type = military_service_limited
				cooldown = no
			}
			set_population_controls = {
				type = population_control_no
				country = root.owner
			}
			set_migration_controls = {
				type = migration_control_no
				country = root.owner
			}
			set_colonization_controls = {
				type = colonization_control_no
				country = root.owner
			}
		}
	}
}

country_event = {
	id = bw_cybertronian.4
	hide_window = yes
	
	is_triggered_only = yes
	
	trigger = {
		has_trait = trait_bw_cybertronian
	}
	
	immediate = {
		give_technology = { message = no tech = tech_cybertronian_onboard_computer }
		give_technology = { message = no tech = tech_cybertronian_stasis_pods }
	}
}

country_event = {
	id = bw_cybertronian.5
	hide_window = yes
	
	is_triggered_only = yes
	
	trigger = {
		has_valid_civic = civic_machine_vehicons
	}
	
	immediate = {
		if = {
			limit = {
				has_civic = civic_machine_vehicons 
			}
			give_technology = { message = no tech = tech_cybertronian_onboard_computer }
			give_technology = { message = no tech = tech_vehicons }
			give_technology = { tech = tech_energon_mining message = no }
			give_technology = { tech = tech_energon_mining_1 message = no }
			give_technology = { tech = tech_mine_living_metal message = no }
		}	
	}
}

country_event = {
	id = bw_cybertronian.6
	hide_window = yes
	is_triggered_only = yes
	
	trigger = {
		has_trait = trait_robot_vehicon
	}
	
	immediate = {
		hidden_effect = {
			every_country = {
				limit = {
					OR = {
						is_country_type = default
						is_country_type = fallen_empire
						is_country_type = awakened_fallen_empire
					}
				}
				every_owned_leader = {
					limit = {
						is_same_species = root
						NOR = {
							has_trait =	leader_trait_vehicon
						}
					}
					if = {
						limit = { leader_class = admiral }
						add_trait = leader_trait_vehicon
						
					}
					if = {
						limit = { leader_class = general }
						add_trait = leader_trait_vehicon
						
					}
					if = {
						limit = { leader_class = governor }
						add_trait = leader_trait_vehicon
						
					}
					if = {
						limit = { leader_class = scientist }
						add_trait = leader_trait_vehicon
						
					}
					if = {
						limit = { leader_class = ruler }
						add_trait = leader_trait_vehicon
						
					}
				}
				every_pool_leader = {
					limit = {
						is_same_species = root
						#species = { 
						#	has_trait = trait_cybernetic
						#	is_same_value = event_target:cybernetic_species
						#}
						NOR = {
							has_trait =	leader_trait_vehicon
						
						}
					}
					if = {
						limit = { leader_class = admiral }
						add_trait = leader_trait_vehicon
						
					}
					if = {
						limit = { leader_class = general }
						add_trait = leader_trait_vehicon
						
						
					}
					if = {
						limit = { leader_class = governor }
						add_trait = leader_trait_vehicon
						
						
					}
					if = {
						limit = { leader_class = scientist }
						add_trait = leader_trait_vehicon
						
						
					}
					if = {
						limit = { leader_class = ruler }
						add_trait = leader_trait_vehicon
						
					}
				}
			}
		}
	}
}

# New Leaders Get Vehicon Trait
country_event = {
	id = bw_cybertronian.7
	is_triggered_only = yes
	hide_window = yes
	
	trigger = {
		from = {
			species = { has_trait = trait_robot_vehicon }
		}
	}
	
	immediate = {
		from = {
			add_trait_no_notify = leader_trait_vehicon
		}
	}
}