namespace = ag_zeta_psionics

@ag_zeta_crisis_event_delay = 30
@ag_zeta_crisis_event_random = 90

# Hidden, trigger of all psionic events.
country_event = {
	id = ag_zeta_psionics.1
	hide_window = yes
	is_triggered_only = yes
	trigger = {
		has_global_flag = ag_ancient_zeta_guardian_destroyed
		NOT = { has_global_flag = ag_zeta_crisis_ended }
	}
	immediate = {
		ag_create_random_psionic_effect = yes
		if = {
			limit = { has_global_flag = ag_zeta_crisis_stage_3 }
			country_event = { id = ag_zeta_psionics.1 days = 360 random = 360 }
		}
		else_if = {
			limit = { NOT = { has_global_flag = ag_zeta_crisis_stage_3 } has_global_flag = ag_zeta_crisis_stage_2 }
			country_event = { id = ag_zeta_psionics.1 days = 90 random = 90 }
		}
		else_if = {
			limit = { NOR = { has_global_flag = ag_zeta_crisis_stage_3 has_global_flag = ag_zeta_crisis_stage_2 } has_global_flag = ag_zeta_crisis_stage_1 }
			country_event = { id = ag_zeta_psionics.1 days = 125 random = 125 }
		}
		else_if = {
			limit = { NOR = { has_global_flag = ag_zeta_crisis_stage_3 has_global_flag = ag_zeta_crisis_stage_2 has_global_flag = ag_zeta_crisis_stage_1 } }
			country_event = { id = ag_zeta_psionics.1 days = 150 random = 150 }
		}
	}
}

# Colony anomalies, nothing but description at the early stage, with negative effect later.
planet_event = {
	id = ag_zeta_psionics.10
	title = "ag_zeta_psionics.10.name"
	desc = { trigger = { has_planet_flag = ag_zeta_psionics_10_desc_version_1 } text = "ag_zeta_psionics.10.a.desc" }
	desc = { trigger = { has_planet_flag = ag_zeta_psionics_10_desc_version_2 } text = "ag_zeta_psionics.10.b.desc" }
	desc = { trigger = { has_planet_flag = ag_zeta_psionics_10_desc_version_3 } text = "ag_zeta_psionics.10.c.desc" }
	desc = { trigger = { has_planet_flag = ag_zeta_psionics_10_desc_version_4 } text = "ag_zeta_psionics.10.d.desc" }
	desc = { trigger = { has_planet_flag = ag_zeta_psionics_10_desc_version_5 } text = "ag_zeta_psionics.10.e.desc" }
	diplomatic = yes
	custom_gui = "ag_ancient_event_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_unspeakable_horror_room }
	show_sound = event_yellow_alert
	location = root
	is_triggered_only = yes
	immediate = {
		random_list = {
			10 = {
				modifier = {
					factor = 0
					OR = {
						is_planet_class = pc_city
						is_planet_class = pc_hive
						is_planet_class = pc_machine
						is_planet_class = pc_ag_city
						is_planet_class = pc_ag_ringworld_city
					}
				}
				set_planet_flag = ag_zeta_psionics_10_desc_version_1
			}
			10 = {
				modifier = {
					factor = 0
					OR = {
						is_planet_class = pc_city
						is_planet_class = pc_hive
						is_planet_class = pc_machine
						is_planet_class = pc_ag_city
						is_planet_class = pc_ag_ringworld_city
					}
				}
				set_planet_flag = ag_zeta_psionics_10_desc_version_2
			}
			10 = { set_planet_flag = ag_zeta_psionics_10_desc_version_3 }
			10 = { set_planet_flag = ag_zeta_psionics_10_desc_version_4 }
			10 = { set_planet_flag = ag_zeta_psionics_10_desc_version_5 }
		}
		reroll_random = yes
		if = { limit = { has_global_flag = ag_zeta_crisis_stage_1 } planet_event = { id = ag_zeta_psionics.50 days = 60 random = 60 } }
	}
	after = { hidden_effect = { if = {
		limit = { NOT = { has_global_flag = ag_zeta_crisis_stage_1 } }
		remove_planet_flag = ag_zeta_psionics_10_desc_version_1
		remove_planet_flag = ag_zeta_psionics_10_desc_version_2
		remove_planet_flag = ag_zeta_psionics_10_desc_version_3
		remove_planet_flag = ag_zeta_psionics_10_desc_version_4
		remove_planet_flag = ag_zeta_psionics_10_desc_version_5
	} } }
	option = { name = "ag_zeta_psionics.10.a" }
	option = { name = "ag_zeta_psionics.10.b" }
	option = { name = "ag_zeta_psionics.10.c" }
}

# Psionic experience equipment damaged, nothing but description.
planet_event = {
	id = ag_zeta_psionics.11
	title = "ag_zeta_psionics.11.name"
	desc = "ag_zeta_psionics.11.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_glitchy_matrix_room }
	show_sound = event_yellow_alert
	location = root
	is_triggered_only = yes
	option = { name = "ag_zeta_psionics.11.a" }
	option = { name = "ag_zeta_psionics.11.b" hidden_effect = { planet_event = { id = ag_zeta_psionics.12 days = 15 random = 15 } } }
}
planet_event = {
	id = ag_zeta_psionics.12
	title = "ag_zeta_psionics.12.name"
	desc = "ag_zeta_psionics.12.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_m_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_physics_research_room }
	show_sound = event_yellow_alert
	location = root
	is_triggered_only = yes
	option = { name = "ag_zeta_psionics.12.a" }
	option = { name = "ag_zeta_psionics.12.b" }
}

# Unnatural zro on planet, harmful to mining station.
fleet_event = {
	id = ag_zeta_psionics.13
	title = "ag_zeta_psionics.13.name"
	desc = "ag_zeta_psionics.13.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_m_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_mining_station_room }
	show_sound = event_sensor_ping
	location = root
	is_triggered_only = yes
	immediate = {
		solar_system = { random_system_planet = {
			limit = { has_mining_station = yes mining_station = { is_same_value = root } }
			save_event_target_as = ag_target_planet
			random_list = {
				10 = { add_deposit = d_zro_deposit_1 set_planet_flag = ag_zeta_psionics_13_zro_1 }
				10 = { add_deposit = d_zro_deposit_2 set_planet_flag = ag_zeta_psionics_13_zro_2 }
				10 = { add_deposit = d_zro_deposit_3 set_planet_flag = ag_zeta_psionics_13_zro_3 }
				10 = { add_deposit = d_zro_deposit_4 set_planet_flag = ag_zeta_psionics_13_zro_4 }
			}
			reroll_random = yes
		} }
	}
	option = {
		name = "ag_zeta_psionics.13.a"
		hidden_effect = {
			random_list = {
				75 = { fleet_event = { id = ag_zeta_psionics.14 days = 60 random = 60 } }
				25 = { modifier = { factor = 9 has_global_flag = ag_zeta_crisis_stage_2 } fleet_event = { id = ag_zeta_psionics.14 days = 60 random = 60 } }
			}
			reroll_random = yes
		}
	}
	option = {
		name = "ag_zeta_psionics.13.b"
		event_target:ag_target_planet = { switch = {
			trigger = has_planet_flag
			ag_zeta_psionics_13_zro_1 = { remove_planet_flag = ag_zeta_psionics_13_zro_1 remove_deposit = d_zro_deposit_1 }
			ag_zeta_psionics_13_zro_2 = { remove_planet_flag = ag_zeta_psionics_13_zro_2 remove_deposit = d_zro_deposit_2 }
			ag_zeta_psionics_13_zro_3 = { remove_planet_flag = ag_zeta_psionics_13_zro_3 remove_deposit = d_zro_deposit_3 }
			ag_zeta_psionics_13_zro_4 = { remove_planet_flag = ag_zeta_psionics_13_zro_4 remove_deposit = d_zro_deposit_4 }
		} }
	}
}
fleet_event = {
	id = ag_zeta_psionics.14
	title = "ag_zeta_psionics.14.name"
	desc = "ag_zeta_psionics.14.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_debris_room }
	show_sound = event_ship_explosion
	location = root
	is_triggered_only = yes
	option = {
		name = "ag_zeta_psionics.14.a"
		event_target:ag_target_planet = { switch = {
			trigger = has_planet_flag
			ag_zeta_psionics_13_zro_1 = { remove_planet_flag = ag_zeta_psionics_13_zro_1 remove_deposit = d_zro_deposit_1 }
			ag_zeta_psionics_13_zro_2 = { remove_planet_flag = ag_zeta_psionics_13_zro_2 remove_deposit = d_zro_deposit_2 }
			ag_zeta_psionics_13_zro_3 = { remove_planet_flag = ag_zeta_psionics_13_zro_3 remove_deposit = d_zro_deposit_3 }
			ag_zeta_psionics_13_zro_4 = { remove_planet_flag = ag_zeta_psionics_13_zro_4 remove_deposit = d_zro_deposit_4 }
		} }
		destroy_fleet = { target = this kill_leader = yes destroy_template = yes }
	}
}
fleet_event = {
	id = ag_zeta_psionics.15
	title = "ag_zeta_psionics.15.name"
	desc = "ag_zeta_psionics.15.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_debris_room }
	show_sound = event_ship_explosion
	location = root
	is_triggered_only = yes
	immediate = {
		event_target:ag_target_planet = { switch = {
			trigger = has_planet_flag
			ag_zeta_psionics_13_zro_1 = { remove_planet_flag = ag_zeta_psionics_13_zro_1 remove_deposit = d_zro_deposit_1 }
			ag_zeta_psionics_13_zro_2 = { remove_planet_flag = ag_zeta_psionics_13_zro_2 remove_deposit = d_zro_deposit_2 }
			ag_zeta_psionics_13_zro_3 = { remove_planet_flag = ag_zeta_psionics_13_zro_3 remove_deposit = d_zro_deposit_3 }
			ag_zeta_psionics_13_zro_4 = { remove_planet_flag = ag_zeta_psionics_13_zro_4 remove_deposit = d_zro_deposit_4 }
		} }
		ag_spawn_station_destroyed_avatar = yes
	}
	option = { name = "ag_zeta_psionics.15.a" destroy_fleet = { target = this kill_leader = yes destroy_template = yes } }
}

# Unnatural psionic research from science station, harmful to science station.
fleet_event = {
	id = ag_zeta_psionics.16
	title = "ag_zeta_psionics.16.name"
	desc = "ag_zeta_psionics.16.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_m_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_satellite_in_orbit_room }
	show_sound = event_sensor_ping
	location = root
	is_triggered_only = yes
	option = {
		name = "ag_zeta_psionics.16.a"
		add_modifier = { modifier = "ag_science_station_psionic_research" days = -1 }
		hidden_effect = { fleet_event = { id = ag_zeta_psionics.17 days = 15 random = 15 } }
	}
	option = {
		name = "ag_zeta_psionics.16.b"
		add_modifier = { modifier = "ag_science_station_psionic_research" days = -1 }
		hidden_effect = {
			random_list = {
				75 = { fleet_event = { id = ag_zeta_psionics.18 days = 60 random = 60 } }
				25 = { modifier = { factor = 9 has_global_flag = ag_zeta_crisis_stage_2 } fleet_event = { id = ag_zeta_psionics.19 days = 60 random = 60 } }
			}
			reroll_random = yes
		}
	}
	option = {
		name = "ag_zeta_psionics.16.c"
		trigger = { owner = { has_country_flag = ag_zeta_psionics_16_fired } }
		destroy_fleet = { target = this kill_leader = yes destroy_template = yes }
	}
}
fleet_event = {
	id = ag_zeta_psionics.17
	title = "ag_zeta_psionics.17.name"
	desc = "ag_zeta_psionics.17.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_debris_room }
	show_sound = event_ship_explosion
	location = root
	is_triggered_only = yes
	after = { hidden_effect = { owner = { set_country_flag = ag_zeta_psionics_16_fired } } }
	option = {
		name = "ag_zeta_psionics.17.a"
		destroy_fleet = { target = this kill_leader = yes destroy_template = yes }
	}
}
fleet_event = {
	id = ag_zeta_psionics.18
	title = "ag_zeta_psionics.18.name"
	desc = "ag_zeta_psionics.18.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_space_debris_room }
	show_sound = event_sensor_ping
	location = root
	is_triggered_only = yes
	after = { hidden_effect = { owner = { set_country_flag = ag_zeta_psionics_16_fired } } }
	option = {
		name = "ag_zeta_psionics.18.a"
		custom_tooltip = "ag_zeta_psionics.18.a.tooltip"
		hidden_effect = { delete_fleet = { target = this kill_leader = yes destroy_template = yes } }
	}
}
fleet_event = {
	id = ag_zeta_psionics.19
	title = "ag_zeta_psionics.19.name"
	desc = "ag_zeta_psionics.19.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_space_debris_room }
	show_sound = event_yellow_alert
	location = root
	is_triggered_only = yes
	immediate = { ag_spawn_station_destroyed_avatar = yes }
	after = { hidden_effect = { owner = { set_country_flag = ag_zeta_psionics_16_fired } delete_fleet = { target = this kill_leader = yes destroy_template = yes } } }
	option = { name = "ag_zeta_psionics.19.a" }
	option = { name = "ag_zeta_psionics.19.b" }
}

# Sensor found new deposit.
country_event = {
	id = ag_zeta_psionics.20
	title = "ag_zeta_psionics.20.name"
	desc = "ag_zeta_psionics.20.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_s_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_satellite_in_orbit_room }
	show_sound = event_sensor_ping
	location = event_target:ag_target_planet
	is_triggered_only = yes
	immediate = {
		random_planet_within_border = {
			limit = {
				habitable_planet = no
				is_artificial = no
				NOR = {
					is_planet_class = pc_ringworld_habitable_damaged
					is_planet_class = pc_ringworld_tech_damaged
					is_planet_class = pc_ringworld_tech
					is_planet_class = pc_ringworld_seam
					is_planet_class = pc_ringworld_seam_damaged
				}
				OR = {
					energy_candidate = yes
					mineral_candidate = yes
					research_candidate = yes
					alloy_candidate = yes
					exotic_gas_candidate = yes
					rare_crystal_candidate = yes
					volatile_motes_candidate = yes
					root = { is_gestalt = no }
				}
			}
			save_event_target_as = ag_target_planet
		}
	}
	after = {
		random_list = {
			10 = { modifier = { factor = 0 event_target:ag_target_planet = { energy_candidate = no } } event_target:ag_target_planet = { add_deposit = d_energy_5 } }
			10 = { modifier = { factor = 0 event_target:ag_target_planet = { energy_candidate = no } } event_target:ag_target_planet = { add_deposit = d_energy_7 } }
			10 = { modifier = { factor = 0 event_target:ag_target_planet = { energy_candidate = no } } event_target:ag_target_planet = { add_deposit = d_energy_9 } }
			10 = { modifier = { factor = 0 event_target:ag_target_planet = { mineral_candidate = no } } event_target:ag_target_planet = { add_deposit = d_minerals_5 } }
			10 = { modifier = { factor = 0 event_target:ag_target_planet = { mineral_candidate = no } } event_target:ag_target_planet = { add_deposit = d_minerals_7 } }
			10 = { modifier = { factor = 0 event_target:ag_target_planet = { mineral_candidate = no } } event_target:ag_target_planet = { add_deposit = d_minerals_9 } }
			10 = { modifier = { factor = 0 event_target:ag_target_planet = { research_candidate = no } } event_target:ag_target_planet = { add_deposit = d_physics_5 } }
			10 = { modifier = { factor = 0 event_target:ag_target_planet = { research_candidate = no } } event_target:ag_target_planet = { add_deposit = d_physics_7 } }
			10 = { modifier = { factor = 0 event_target:ag_target_planet = { research_candidate = no } } event_target:ag_target_planet = { add_deposit = d_physics_9 } }
			10 = { modifier = { factor = 0 event_target:ag_target_planet = { research_candidate = no } } event_target:ag_target_planet = { add_deposit = d_society_5 } }
			10 = { modifier = { factor = 0 event_target:ag_target_planet = { research_candidate = no } } event_target:ag_target_planet = { add_deposit = d_society_7 } }
			10 = { modifier = { factor = 0 event_target:ag_target_planet = { research_candidate = no } } event_target:ag_target_planet = { add_deposit = d_society_9 } }
			10 = { modifier = { factor = 0 event_target:ag_target_planet = { research_candidate = no } } event_target:ag_target_planet = { add_deposit = d_engineering_5 } }
			10 = { modifier = { factor = 0 event_target:ag_target_planet = { research_candidate = no } } event_target:ag_target_planet = { add_deposit = d_engineering_7 } }
			10 = { modifier = { factor = 0 event_target:ag_target_planet = { research_candidate = no } } event_target:ag_target_planet = { add_deposit = d_engineering_9 } }
			10 = { modifier = { factor = 0 event_target:ag_target_planet = { alloy_candidate = no } } event_target:ag_target_planet = { add_deposit = d_alloys_3 } }
			10 = { modifier = { factor = 0 event_target:ag_target_planet = { alloy_candidate = no } } event_target:ag_target_planet = { add_deposit = d_alloys_4 } }
			10 = { modifier = { factor = 0 event_target:ag_target_planet = { alloy_candidate = no } } event_target:ag_target_planet = { add_deposit = d_alloys_5 } }
			10 = { modifier = { factor = 0 event_target:ag_target_planet = { exotic_gas_candidate = no } } event_target:ag_target_planet = { add_deposit = d_exotic_gases_1 } }
			10 = { modifier = { factor = 0 event_target:ag_target_planet = { exotic_gas_candidate = no } } event_target:ag_target_planet = { add_deposit = d_exotic_gases_2 } }
			10 = { modifier = { factor = 0 event_target:ag_target_planet = { exotic_gas_candidate = no } } event_target:ag_target_planet = { add_deposit = d_exotic_gases_3 } }
			10 = { modifier = { factor = 0 event_target:ag_target_planet = { rare_crystal_candidate = no } } event_target:ag_target_planet = { add_deposit = d_rare_crystals_1 } }
			10 = { modifier = { factor = 0 event_target:ag_target_planet = { rare_crystal_candidate = no } } event_target:ag_target_planet = { add_deposit = d_rare_crystals_2 } }
			10 = { modifier = { factor = 0 event_target:ag_target_planet = { rare_crystal_candidate = no } } event_target:ag_target_planet = { add_deposit = d_rare_crystals_3} }
			10 = { modifier = { factor = 0 event_target:ag_target_planet = { volatile_motes_candidate = no } } event_target:ag_target_planet = { add_deposit = d_volatile_motes_1 } }
			10 = { modifier = { factor = 0 event_target:ag_target_planet = { volatile_motes_candidate = no } } event_target:ag_target_planet = { add_deposit = d_volatile_motes_2 } }
			10 = { modifier = { factor = 0 event_target:ag_target_planet = { volatile_motes_candidate = no } } event_target:ag_target_planet = { add_deposit = d_volatile_motes_3 } }
		}
		reroll_random = yes
	}
	option = { name = "ag_zeta_psionics.20.a" }
	option = { name = "ag_zeta_psionics.20.b" hidden_effect = { country_event = { id = ag_zeta_psionics.22 days = 15 random = 15 } } }
}
country_event = {
	id = ag_zeta_psionics.21
	title = "ag_zeta_psionics.21.name"
	desc = "ag_zeta_psionics.21.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_s_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_satellite_in_orbit_room }
	show_sound = event_sensor_ping
	location = event_target:ag_target_planet
	is_triggered_only = yes
	immediate = {
		random_planet_within_border = {
			limit = {
				habitable_planet = no
				is_artificial = no
				NOR = {
					is_planet_class = pc_ringworld_habitable_damaged
					is_planet_class = pc_ringworld_tech_damaged
					is_planet_class = pc_ringworld_tech
					is_planet_class = pc_ringworld_seam
					is_planet_class = pc_ringworld_seam_damaged
				}
				OR = {
					energy_candidate = yes
					mineral_candidate = yes
					research_candidate = yes
					alloy_candidate = yes
					exotic_gas_candidate = yes
					rare_crystal_candidate = yes
					volatile_motes_candidate = yes
					root = { is_gestalt = no }
				}
			}
			save_event_target_as = ag_target_planet
		}
	}
	after = {
		random_list = {
			10 = { modifier = { factor = 0 event_target:ag_target_planet = { energy_candidate = no } } event_target:ag_target_planet = { add_deposit = d_energy_5 } }
			10 = { modifier = { factor = 0 event_target:ag_target_planet = { energy_candidate = no } } event_target:ag_target_planet = { add_deposit = d_energy_7 } }
			10 = { modifier = { factor = 0 event_target:ag_target_planet = { energy_candidate = no } } event_target:ag_target_planet = { add_deposit = d_energy_9 } }
			10 = { modifier = { factor = 0 event_target:ag_target_planet = { mineral_candidate = no } } event_target:ag_target_planet = { add_deposit = d_minerals_5 } }
			10 = { modifier = { factor = 0 event_target:ag_target_planet = { mineral_candidate = no } } event_target:ag_target_planet = { add_deposit = d_minerals_7 } }
			10 = { modifier = { factor = 0 event_target:ag_target_planet = { mineral_candidate = no } } event_target:ag_target_planet = { add_deposit = d_minerals_9 } }
			10 = { modifier = { factor = 0 event_target:ag_target_planet = { research_candidate = no } } event_target:ag_target_planet = { add_deposit = d_physics_5 } }
			10 = { modifier = { factor = 0 event_target:ag_target_planet = { research_candidate = no } } event_target:ag_target_planet = { add_deposit = d_physics_7 } }
			10 = { modifier = { factor = 0 event_target:ag_target_planet = { research_candidate = no } } event_target:ag_target_planet = { add_deposit = d_physics_9 } }
			10 = { modifier = { factor = 0 event_target:ag_target_planet = { research_candidate = no } } event_target:ag_target_planet = { add_deposit = d_society_5 } }
			10 = { modifier = { factor = 0 event_target:ag_target_planet = { research_candidate = no } } event_target:ag_target_planet = { add_deposit = d_society_7 } }
			10 = { modifier = { factor = 0 event_target:ag_target_planet = { research_candidate = no } } event_target:ag_target_planet = { add_deposit = d_society_9 } }
			10 = { modifier = { factor = 0 event_target:ag_target_planet = { research_candidate = no } } event_target:ag_target_planet = { add_deposit = d_engineering_5 } }
			10 = { modifier = { factor = 0 event_target:ag_target_planet = { research_candidate = no } } event_target:ag_target_planet = { add_deposit = d_engineering_7 } }
			10 = { modifier = { factor = 0 event_target:ag_target_planet = { research_candidate = no } } event_target:ag_target_planet = { add_deposit = d_engineering_9 } }
			10 = { modifier = { factor = 0 event_target:ag_target_planet = { alloy_candidate = no } } event_target:ag_target_planet = { add_deposit = d_alloys_3 } }
			10 = { modifier = { factor = 0 event_target:ag_target_planet = { alloy_candidate = no } } event_target:ag_target_planet = { add_deposit = d_alloys_4 } }
			10 = { modifier = { factor = 0 event_target:ag_target_planet = { alloy_candidate = no } } event_target:ag_target_planet = { add_deposit = d_alloys_5 } }
			10 = { modifier = { factor = 0 event_target:ag_target_planet = { exotic_gas_candidate = no } } event_target:ag_target_planet = { add_deposit = d_exotic_gases_1 } }
			10 = { modifier = { factor = 0 event_target:ag_target_planet = { exotic_gas_candidate = no } } event_target:ag_target_planet = { add_deposit = d_exotic_gases_2 } }
			10 = { modifier = { factor = 0 event_target:ag_target_planet = { exotic_gas_candidate = no } } event_target:ag_target_planet = { add_deposit = d_exotic_gases_3 } }
			10 = { modifier = { factor = 0 event_target:ag_target_planet = { rare_crystal_candidate = no } } event_target:ag_target_planet = { add_deposit = d_rare_crystals_1 } }
			10 = { modifier = { factor = 0 event_target:ag_target_planet = { rare_crystal_candidate = no } } event_target:ag_target_planet = { add_deposit = d_rare_crystals_2 } }
			10 = { modifier = { factor = 0 event_target:ag_target_planet = { rare_crystal_candidate = no } } event_target:ag_target_planet = { add_deposit = d_rare_crystals_3} }
			10 = { modifier = { factor = 0 event_target:ag_target_planet = { volatile_motes_candidate = no } } event_target:ag_target_planet = { add_deposit = d_volatile_motes_1 } }
			10 = { modifier = { factor = 0 event_target:ag_target_planet = { volatile_motes_candidate = no } } event_target:ag_target_planet = { add_deposit = d_volatile_motes_2 } }
			10 = { modifier = { factor = 0 event_target:ag_target_planet = { volatile_motes_candidate = no } } event_target:ag_target_planet = { add_deposit = d_volatile_motes_3 } }
		}
		reroll_random = yes
	}
	option = { name = "ag_zeta_psionics.21.a" }
	option = { name = "ag_zeta_psionics.21.b" hidden_effect = { country_event = { id = ag_zeta_psionics.22 days = 15 random = 15 } } }
}
country_event = {
	id = ag_zeta_psionics.22
	title = "ag_zeta_psionics.22.name"
	desc = "ag_zeta_psionics.22.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_s_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_sapient_AI_room }
	show_sound = event_default
	location = capital_scope
	is_triggered_only = yes
	option = { name = "ag_zeta_psionics.22.a" }
}

# Space station damaged, nothing bug description, damage station makes no sense.
country_event = {
	id = ag_zeta_psionics.23
	title = "ag_zeta_psionics.23.name"
	desc = "ag_zeta_psionics.23.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_m_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_ship_in_orbit_room }
	show_sound = event_yellow_alert
	location = capital_scope
	is_triggered_only = yes
	option = { name = "ag_zeta_psionics.23.a" }
}

# Get psionic pops.
planet_event = {
	id = ag_zeta_psionics.24
	title = "ag_zeta_psionics.24.name"
	desc = {
		trigger = { owner = { NOR = { has_country_flag = ag_zeta_psionics_24_fired has_technology = "tech_psionic_theory" } } }
		text = "ag_zeta_psionics.24.a.desc"
	}
	desc = {
		trigger = { owner = { NOT = { has_country_flag = ag_zeta_psionics_24_fired } has_technology = "tech_psionic_theory" } }
		text = "ag_zeta_psionics.24.b.desc"
	}
	desc = {
		trigger = { owner = { has_country_flag = ag_zeta_psionics_24_fired } }
		text = "ag_zeta_psionics.24.c.desc"
	}
	diplomatic = yes
	custom_gui = "ag_ancient_event_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_psionics_room }
	show_sound = event_psionic
	location = root
	is_triggered_only = yes
	immediate = {
		owner = { set_country_flag = ag_zeta_psionics_24_fired }
		while = {
			count = 3
			random_owned_pop = {
				limit = { NOT = { has_trait = trait_psionic } }
				if = {
					limit = { has_trait = trait_latent_psionic }
					random_list = {
						50 = { kill_pop = yes }
						50 = {
							modify_species = { species = this remove_trait = trait_latent_psionic }
							modify_species = { species = this add_trait = trait_psionic }
						}
					}
				}
				else = { modify_species = { species = this add_trait = trait_psionic } }
				set_pop_flag = ag_new_psionic_pop
			}
		}
	}
	option = { name = "ag_zeta_psionics.24.a" add_modifier = { modifier = "ag_new_psionic_pop_debuff" days = 1800 } }
	option = { name = "ag_zeta_psionics.24.b" add_modifier = { modifier = "ag_new_psionic_pop_debuff" days = 1800 } }
	option = {
		name = "ag_zeta_psionics.24.c"
		trigger = { owner = {
			OR = {
				has_ethic = ethic_fanatic_xenophobe
				has_ethic = ethic_xenophobe
			}
			OR = {
				has_ethic = ethic_fanatic_authoritarian
				has_ethic = ethic_authoritarian
			}
		} }
		add_modifier = { modifier = "ag_new_psionic_pop_debuff_alt" days = 1800 }
		every_owned_pop = { limit = { has_pop_flag = ag_new_psionic_pop } kill_pop = yes }
	}
}
# Psionic ascension version, kill pops
planet_event = {
	id = ag_zeta_psionics.25
	title = "ag_zeta_psionics.25.name"
	desc = {
		trigger = { owner = { has_country_flag = whisperers_covenant_confirmed } }
		text = "ag_zeta_psionics.25.a.desc"
	}
	desc = {
		trigger = { owner = { NOT = { has_country_flag = whisperers_covenant_confirmed } } }
		text = "ag_zeta_psionics.25.b.desc"
	}
	diplomatic = yes
	custom_gui = "ag_ancient_event_m_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_ship_in_orbit_room }
	show_sound = event_yellow_alert
	location = root
	is_triggered_only = yes
	immediate = { while = { count = 3 random_owned_pop = { limit = { has_trait = trait_psionic } kill_pop = yes } } }
	option = { name = "ag_zeta_psionics.25.a" add_modifier = { modifier = "ag_new_psionic_pop_debuff" days = 1800 } }
	option = { name = "ag_zeta_psionics.25.b" add_modifier = { modifier = "ag_new_psionic_pop_debuff" days = 1800 } }
}
# Hive version, kill pops
planet_event = {
	id = ag_zeta_psionics.26
	title = "ag_zeta_psionics.26.name"
	desc = "ag_zeta_psionics.26.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_m_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_ship_in_orbit_room }
	show_sound = event_yellow_alert
	location = root
	is_triggered_only = yes
	immediate = { while = {
		count = 4
		random_owned_pop = {
			limit = { has_trait = trait_hive_mind }
			modify_species = { species = this remove_trait = trait_hive_mind }
		}
	} }
	option = { name = "ag_zeta_psionics.26.a" }
	option = { name = "ag_zeta_psionics.26.b" }
}
# Machine version, kill pops
planet_event = {
	id = ag_zeta_psionics.27
	title = "ag_zeta_psionics.27.name"
	desc = "ag_zeta_psionics.27.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_m_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_ship_in_orbit_room }
	show_sound = event_yellow_alert
	location = root
	is_triggered_only = yes
	immediate = { while = {
		count = 4
		random_owned_pop = {
			limit = { OR = {
				has_trait = trait_machine_unit
				has_trait = trait_mechanical
			} }
			kill_pop = yes
		}
	} }
	option = { name = "ag_zeta_psionics.27.a" }
	option = { name = "ag_zeta_psionics.27.b" }
}

# Damage planet.
planet_event = {
	id = ag_zeta_psionics.28
	title = "ag_zeta_psionics.28.name"
	desc = "ag_zeta_psionics.28.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_colony_settlement_room }
	show_sound = event_planetary_riot
	location = root
	is_triggered_only = yes
	option = {
		name = "ag_zeta_psionics.28.a"
		remove_last_built_district = yes
		ruin_building = random_no_capital
		add_planet_devastation = 15
		while = {
			count = 3
			if = {
				limit = { owner = { is_gestalt = no is_synthetic_empire = no } }
				random_list = { 50 = { add_deposit = d_failing_infrastructure } 50 = { add_deposit = d_decrepit_dwellings } }
				reroll_random = yes
			}
			else = {
				if = {
					limit = { owner = { is_hive_empire = yes } }
					random_list = { 50 = { add_deposit = d_failing_infrastructure } 50 = { add_deposit = d_collapsed_burrows } }
					reroll_random = yes
				}
				else = {
					if = {
						limit = { owner = { OR = { is_machine_empire = yes is_synthetic_empire = yes } } }
						random_list = { 50 = { add_deposit = d_failing_infrastructure } 50 = { add_deposit = d_machine_empire_ruins } }
						reroll_random = yes
					}
				}
			}
		}
	}
}

# Mutate pops.
planet_event = {
	id = ag_zeta_psionics.29
	title = "ag_zeta_psionics.29.name"
	desc = {
		trigger = { owner = { is_gestalt = no is_synthetic_empire = no } }
		text = "ag_zeta_psionics.29.a.desc"
	}
	desc = {
		trigger = { owner = { is_hive_empire = yes } }
		text = "ag_zeta_psionics.29.b.desc"
	}
	desc = {
		trigger = { owner = { OR = { is_machine_empire = yes is_synthetic_empire = yes } } }
		text = "ag_zeta_psionics.29.c.desc"
	}
	diplomatic = yes
	custom_gui = "ag_ancient_event_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_unspeakable_horror_room }
	show_sound = event_mystic_reveal
	location = root
	is_triggered_only = yes
	immediate = {
		while = {
			count = 3
			random_owned_pop = {
				set_pop_flag = ag_mutated_pop
				if = {
					limit = { owner = { is_gestalt = no is_synthetic_empire = no } }
					ag_psionic_mutate_pop_regular_empire = yes
				}
				else_if = {
					limit = { owner = { is_hive_empire = yes } }
					ag_psionic_mutate_pop_hive_empire = yes
				}
				else_if = {
					limit = { owner = { OR = { is_machine_empire = yes is_synthetic_empire = yes } } }
					ag_psionic_mutate_pop_machine_empire = yes
				}
			}
		}
	}
	option = { name = "ag_zeta_psionics.29.a" }
	option = { name = "ag_zeta_psionics.29.b" }
	option = {
		name = "ag_zeta_psionics.29.c"
		trigger = { owner = { OR = {
			is_gestalt = yes
			AND = {
				OR = {
					has_ethic = ethic_fanatic_xenophobe
					has_ethic = ethic_xenophobe
				}
				OR = {
					has_ethic = ethic_fanatic_authoritarian
					has_ethic = ethic_authoritarian
				}
			}
		} } }
		if = { limit = { owner = { is_gestalt = no } } add_modifier = { modifier = "ag_kill_mutated_debuff" days = 1800 } }
		every_owned_pop = { limit = { has_pop_flag = ag_mutated_pop } kill_pop = yes }
	}
}

# Science ship disappeared.
fleet_event = {
	id = ag_zeta_psionics.30
	title = "ag_zeta_psionics.30.name"
	desc = "ag_zeta_psionics.30.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_m_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_ship_in_orbit_room }
	show_sound = event_sensor_ping
	location = root
	is_triggered_only = yes
	immediate = { set_event_locked = yes owner = { country_event = { id = ag_zeta_psionics.31 days = 60 random = 60 } } }
	option = {
		name = "ag_zeta_psionics.30.a"
		custom_tooltip = "ag_zeta_psionics.30.a.tooltip"
		hidden_effect = {
			if = { limit = { exists = leader } leader = { exile_leader_as = ag_zeta_psionics_30_victim_leader } owner = { set_country_flag = ag_zeta_psionics_30_exiled_leader } }
			create_ambient_object = { type = "ag_zeta_psionic_science_ship_object" location = root }
			last_created_ambient_object = { save_event_target_as = ag_target_object }
			delete_fleet = { target = root kill_leader = no destroy_template = yes }
		}
	}
}
country_event = {
	id = ag_zeta_psionics.31
	title = "ag_zeta_psionics.31.name"
	desc = "ag_zeta_psionics.31.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_ship_in_orbit_room }
	show_sound = event_yellow_alert
	location = event_target:ag_target_object
	is_triggered_only = yes
	immediate = { country_event = { id = ag_zeta_psionics.32 days = 60 random = 60 } }
	after = { hidden_effect = {
		create_ambient_object = { type = "ag_zeta_psionic_science_ship_object_alt" location = event_target:ag_target_object }
		last_created_ambient_object = { save_event_target_as = ag_target_object_alt }
		event_target:ag_target_object = { destroy_ambient_object = this }
	} }
	option = { name = "ag_zeta_psionics.31.a" }
}
country_event = {
	id = ag_zeta_psionics.32
	title = "ag_zeta_psionics.32.name"
	desc = "ag_zeta_psionics.32.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_ship_in_orbit_room }
	show_sound = event_yellow_alert
	location = event_target:ag_target_object_alt
	is_triggered_only = yes
	immediate = {
		create_fleet = {
			name = "NAME_ag_zeta_crisis_small_ship_science_fleet"
			settings = { is_boss = yes spawn_debris = no }
			effect = {
				set_owner = root
				save_event_target_as = ag_zeta_psionics_science_ship
				if = {
					limit = { root = { has_country_flag = ag_zeta_psionics_30_exiled_leader } }
					root = { remove_country_flag = ag_zeta_psionics_30_exiled_leader }
					set_leader = ag_zeta_psionics_30_victim_leader
				}
				create_ship = {
					name = "NAME_ag_zeta_crisis_small_ship_science_ship"
					design = "NAME_ag_zeta_crisis_small_ship_science"
					prefix = no
					effect = { ag_difficulty_bonus = yes }
				}
				set_location = { target = event_target:ag_target_object_alt distance = 0 angle = random }
			}
		}
		event_target:ag_target_object_alt = { destroy_ambient_object = this }
	}
	option = {
		name = "ag_zeta_psionics.32.a"
		custom_tooltip = "ag_zeta_psionics.32.a.tooltip"
		hidden_effect = { event_target:ag_zeta_psionics_science_ship = { fleet_event = { id = ag_zeta_psionics.33 days = 180 random = 180 } } }
	}
	option = {
		name = "ag_zeta_psionics.32.b"
		custom_tooltip = "ag_zeta_psionics.32.b.tooltip"
		hidden_effect = { event_target:ag_zeta_psionics_science_ship = { set_owner = event_target:ag_zeta_crisis_country } }
	}
}
fleet_event = {
	id = ag_zeta_psionics.33
	hide_window = yes
	is_triggered_only = yes
	trigger = { exists = this }
	immediate = {
		owner = { country_event = { id = ag_zeta_psionics.34 } }
		if = {
			limit = { exists = leader }
			leader = { set_owner = event_target:ag_zeta_crisis_country }
		}
		set_owner = event_target:ag_zeta_crisis_country
	}
}
country_event = {
	id = ag_zeta_psionics.34
	title = "ag_zeta_psionics.34.name"
	desc = "ag_zeta_psionics.34.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_m_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_fleet_evil_room }
	show_sound = event_red_alert
	location = from
	is_triggered_only = yes
	option = { name = "ag_zeta_psionics.34.a" }
}
# on_ship_destroyed_victim, destroyed psionic science ship.
country_event = {
	id = ag_zeta_psionics.35
	title = "ag_zeta_psionics.35.name"
	desc = "ag_zeta_psionics.35.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_m_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_small_space_battle_room }
	show_sound = event_space_battle
	location = fromfromfrom
	is_triggered_only = yes
	trigger = {
		NOT = { has_country_flag = ag_zeta_psionics_35_fired }
		fromfromfrom = { is_ship_size = ag_zeta_crisis_small_ship_science }
	}
	immediate = { set_country_flag = ag_zeta_psionics_35_fired }
	option = { name = "ag_zeta_psionics.35.a" }
}

# Fleet lost ships.
fleet_event = {
	id = ag_zeta_psionics.36
	title = "ag_zeta_psionics.36.name"
	desc = "ag_zeta_psionics.36.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_debris_room }
	show_sound = event_ship_explosion
	location = root
	is_triggered_only = yes
	option = {
		name = "ag_zeta_psionics.36.a"
		custom_tooltip = "ag_zeta_psionics.36.a.tooltip"
		hidden_effect = { while = {
			count = 2
			random_owned_ship = { destroy_ship = this }
			fire_on_action = { on_action = on_ship_disabled scopes = { from = prev } }
			owner = {
				fire_on_action = { on_action = on_ship_destroyed_victim scopes = { from = root.owner fromfrom = prev fromfromfrom = prev } }
				fire_on_action = { on_action = on_ship_destroyed_perp scopes = { from = root.owner fromfrom = prev fromfromfrom = prev } }
			}
		} }
	}
}

# Warning: Incoming invasion on planet.
planet_event = {
	id = ag_zeta_psionics.50
	title = "ag_zeta_psionics.50.name"
	desc = { trigger = { has_planet_flag = ag_zeta_psionics_10_desc_version_1 } text = "ag_zeta_psionics.50.a.desc" }
	desc = { trigger = { has_planet_flag = ag_zeta_psionics_10_desc_version_2 } text = "ag_zeta_psionics.50.b.desc" }
	desc = { trigger = { has_planet_flag = ag_zeta_psionics_10_desc_version_3 } text = "ag_zeta_psionics.50.c.desc" }
	desc = { trigger = { has_planet_flag = ag_zeta_psionics_10_desc_version_4 } text = "ag_zeta_psionics.50.d.desc" }
	desc = { trigger = { has_planet_flag = ag_zeta_psionics_10_desc_version_5 } text = "ag_zeta_psionics.50.e.desc" }
	diplomatic = yes
	custom_gui = "ag_ancient_event_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_unspeakable_horror_room }
	show_sound = event_yellow_alert
	location = root
	is_triggered_only = yes
	immediate = {
		add_modifier = { modifier = "ag_zeta_crisis_marked" days = -1 }
		planet_event = { id = ag_zeta_psionics.51 days = 180 random = 360 }
	}
	after = { hidden_effect = {
		remove_planet_flag = ag_zeta_psionics_10_desc_version_1
		remove_planet_flag = ag_zeta_psionics_10_desc_version_2
		remove_planet_flag = ag_zeta_psionics_10_desc_version_3
		remove_planet_flag = ag_zeta_psionics_10_desc_version_4
		remove_planet_flag = ag_zeta_psionics_10_desc_version_5
	} }
	option = { name = "ag_zeta_psionics.50.a" tooltip = { add_modifier = { modifier = "ag_zeta_crisis_marked" days = -1 } } }
	option = { name = "ag_zeta_psionics.50.b" tooltip = { add_modifier = { modifier = "ag_zeta_crisis_marked" days = -1 } } }
	option = { name = "ag_zeta_psionics.50.c" tooltip = { add_modifier = { modifier = "ag_zeta_crisis_marked" days = -1 } } }
}
# Noti: Planet under attack.
planet_event = {
	id = ag_zeta_psionics.51
	title = "ag_zeta_psionics.51.name"
	desc = {
		trigger = { owner = { NOT = { has_country_flag = ag_zeta_psionics_51_fired } } }
		text = "ag_zeta_psionics.51.a.desc"
	}
	desc = {
		trigger = { owner = { has_country_flag = ag_zeta_psionics_51_fired } }
		text = "ag_zeta_psionics.51.b.desc"
	}
	diplomatic = yes
	custom_gui = "ag_ancient_event_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_burning_settlement_room }
	show_sound = event_red_alert
	location = root
	is_triggered_only = yes
	trigger = { has_modifier = "ag_zeta_crisis_marked" }
	immediate = {
		remove_modifier = "ag_zeta_crisis_marked"
		if = {
			limit = { is_colony = yes }
			owner = { set_country_flag = ag_zeta_psionics_51_fired }
			if = {
				limit = {
					OR = { has_galactic_custodian = yes has_galactic_emperor = yes }
					owner = {
						is_ai = yes
						is_galactic_community_member = yes
						is_galactic_custodian = no
						is_galactic_emperor = no
					}
				}
				owner = { save_event_target_as = ag_target_community_member }
				if = {
					limit = { has_galactic_custodian = yes }
					random_playable_country = {
						limit = { is_galactic_custodian = yes }
						country_event = { id = ag_zeta_psionics.101 }
					}
				}
				else = { if = {
					limit = { has_galactic_emperor = yes }
					random_playable_country = {
						limit = { is_galactic_emperor = yes }
						country_event = { id = ag_zeta_psionics.102 }
					}
				} }
			}
			if = {
				limit = { NOT = { has_global_flag = ag_zeta_crisis_stage_2 } }
				random_list = {
					25 = { while = {
						count = 6
						create_army = {
							name = "NAME_ag_zeta_crisis_avatar"
							owner = event_target:ag_zeta_crisis_country
							species = event_target:ag_zeta_crisis_country.owner_main_species
							type = "ag_zeta_crisis_assault_army"
						}
					} }
					25 = { while = {
						count = 8
						create_army = {
							name = "NAME_ag_zeta_crisis_avatar"
							owner = event_target:ag_zeta_crisis_country
							species = event_target:ag_zeta_crisis_country.owner_main_species
							type = "ag_zeta_crisis_assault_army"
						}
					} }
					25 = { while = {
						count = 10
						create_army = {
							name = "NAME_ag_zeta_crisis_avatar"
							owner = event_target:ag_zeta_crisis_country
							species = event_target:ag_zeta_crisis_country.owner_main_species
							type = "ag_zeta_crisis_assault_army"
						}
					} }
					25 = { while = {
						count = 12
						create_army = {
							name = "NAME_ag_zeta_crisis_avatar"
							owner = event_target:ag_zeta_crisis_country
							species = event_target:ag_zeta_crisis_country.owner_main_species
							type = "ag_zeta_crisis_assault_army"
						}
					} }
				}
				reroll_random = yes
			}
			else = {
				random_list = {
					25 = { }
					25 = { while = {
						count = 2
						create_army = {
							name = "NAME_ag_zeta_crisis_avatar"
							owner = event_target:ag_zeta_crisis_country
							species = event_target:ag_zeta_crisis_country.owner_main_species
							type = "ag_zeta_crisis_assault_army"
						}
					} }
					25 = { while = {
						count = 4
						create_army = {
							name = "NAME_ag_zeta_crisis_avatar"
							owner = event_target:ag_zeta_crisis_country
							species = event_target:ag_zeta_crisis_country.owner_main_species
							type = "ag_zeta_crisis_assault_army"
						}
					} }
					25 = { while = {
						count = 6
						create_army = {
							name = "NAME_ag_zeta_crisis_avatar"
							owner = event_target:ag_zeta_crisis_country
							species = event_target:ag_zeta_crisis_country.owner_main_species
							type = "ag_zeta_crisis_assault_army"
						}
					} }
				}
				reroll_random = yes
				while = {
					count = root.value:ag_num_zeta_crisis_invasion_armies
					create_army = {
						name = "NAME_ag_zeta_crisis_avatar"
						owner = event_target:ag_zeta_crisis_country
						species = event_target:ag_zeta_crisis_country.owner_main_species
						type = "ag_zeta_crisis_assault_army"
					}
				}
			}
		}
		else = {
			if = {
				limit = { solar_system = { exists = space_owner } }
				space_owner = {
					set_country_flag = ag_zeta_psionics_52_fired
					country_event = { id = ag_zeta_psionics.52 days = 1 }
				}
			}
			ag_zeta_crisis_controlled_planet_effect = yes
		}
	}
	option = { name = "ag_zeta_psionics.51.a" }
	option = { name = "ag_zeta_psionics.51.b" }
}
# Colony destroyed for unknown reason (player gave up it?).
country_event = {
	id = ag_zeta_psionics.52
	title = "ag_zeta_psionics.52.name"
	desc = "ag_zeta_psionics.52.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_m_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_shrouded_planet_room }
	show_sound = event_yellow_alert
	location = from
	is_triggered_only = yes
	option = { name = "ag_zeta_psionics.52.a" }
}
# on_planet_attackers_win, Hidden, Shroud Invaders conquered planets
country_event = {
	id = ag_zeta_psionics.53
	hide_window = yes
	is_triggered_only = yes
	trigger = { is_country_type = ag_zeta_crisis_country }
	immediate = {
		add_threat = { who = root amount = 2 }
		from = { country_event = { id = ag_zeta_psionics.54 } }
		fromfrom = {
			set_controller = root
			every_owned_pop = { unemploy_pop = yes }
			if = { limit = { has_army = yes } remove_all_armies = yes }
			while = {
				count = 5
				create_army = {
					name = "NAME_ag_zeta_crisis_avatar"
					owner = event_target:ag_zeta_crisis_country
					species = event_target:ag_zeta_crisis_country.owner_main_species
					type = "ag_zeta_crisis_defensive_army"
				}
			}
		}
	}
}
# Notification for victims, Shroud Invaders conquered planets
country_event = {
	id = ag_zeta_psionics.54
	title = "ag_zeta_psionics.54.name"
	desc = "ag_zeta_psionics.54.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_ground_combat_room }
	show_sound = event_ground_battle
	location = fromfromfrom
	is_triggered_only = yes
	option = { name = "ag_zeta_psionics.54.a" }
}
# on_planet_defenders_win, Planet defend successful
country_event = {
	id = ag_zeta_psionics.55
	title = "ag_zeta_psionics.55.name"
	desc = "ag_zeta_psionics.55.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_ground_combat_room }
	show_sound = event_ground_battle
	location = fromfrom
	is_triggered_only = yes
	trigger = { from = { is_country_type = ag_zeta_crisis_country } }
	option = { name = "ag_zeta_psionics.55.a" }
}
# on_planet_attackers_win, Shroud Invaders' Planets reclaimed
country_event = {
	id = ag_zeta_psionics.56
	title = "ag_zeta_psionics.56.name"
	desc = "ag_zeta_psionics.56.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_ground_combat_room }
	show_sound = event_ground_battle
	location = fromfrom
	is_triggered_only = yes
	trigger = { from = { is_country_type = ag_zeta_crisis_country } }
	immediate = { fromfrom = { set_controller = owner every_owned_pop = { unemploy_pop = yes } } }
	option = { name = "ag_zeta_psionics.56.a" }
}
# on_pop_purged, Accelerate Shroud Invaders' purge progress
planet_event = {
	id = ag_zeta_psionics.57
	hide_window = yes
	is_triggered_only = yes
	trigger = { num_pops > 1 controller = { is_country_type = ag_zeta_crisis_country } }
	immediate = { while = { count = value:ag_num_zeta_crisis_purge_pops random_owned_pop = { kill_pop = yes } } }
}
# on_pop_purged, Hidden, turn planet into a Shrouded Planet
planet_event = {
	id = ag_zeta_psionics.58
	hide_window = yes
	is_triggered_only = yes
	trigger = { num_pops <= 1 controller = { is_country_type = ag_zeta_crisis_country } }
	immediate = {
		if = {
			limit = { exists = owner }
			owner = {
				country_event = { id = ag_zeta_psionics.59 }
				change_variable = { which = ag_num_planets_destroyed_by_zeta_crisis value = 1 }
			}
		}
		ag_zeta_crisis_controlled_planet_effect = yes
	}
}
country_event = {
	id = ag_zeta_psionics.59
	title = "ag_zeta_psionics.59.name"
	desc = "ag_zeta_psionics.59.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_m_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_shrouded_planet_room }
	show_sound = event_yellow_alert
	location = from
	is_triggered_only = yes
	option = { name = "ag_zeta_psionics.59.a" }
}

# Planet debuff.
planet_event = {
	id = ag_zeta_psionics.60
	title = "ag_zeta_psionics.60.name"
	desc = "ag_zeta_psionics.60.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_unspeakable_horror_room }
	show_sound = event_mystic_reveal
	location = root
	is_triggered_only = yes
	immediate = { add_modifier = {
		modifier = "ag_zeta_crisis_stability_debuff"
		days = @ag_zeta_crisis_planet_debuff_days
		multiplier = value:ag_zeta_crisis_planet_debuff_multiplier|ag_base|30|ag_modifier|planet_stability_add|
	} }
	option = {
		name = "ag_zeta_psionics.60.a"
		tooltip = { add_modifier = {
			modifier = "ag_zeta_crisis_stability_debuff"
			days = @ag_zeta_crisis_planet_debuff_days
			multiplier = value:ag_zeta_crisis_planet_debuff_multiplier|ag_base|30|ag_modifier|planet_stability_add|
		} }
	}
}
planet_event = {
	id = ag_zeta_psionics.61
	title = "ag_zeta_psionics.61.name"
	desc = "ag_zeta_psionics.61.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_unspeakable_horror_room }
	show_sound = event_mystic_reveal
	location = root
	is_triggered_only = yes
	immediate = { add_modifier = {
		modifier = "ag_zeta_crisis_criminal_debuff"
		days = @ag_zeta_crisis_planet_debuff_days
		multiplier = value:ag_zeta_crisis_planet_debuff_multiplier|ag_base|50|ag_modifier|planet_crime_add|
	} }
	option = {
		name = "ag_zeta_psionics.61.a"
		tooltip = { add_modifier = {
			modifier = "ag_zeta_crisis_criminal_debuff"
			days = @ag_zeta_crisis_planet_debuff_days
			multiplier = value:ag_zeta_crisis_planet_debuff_multiplier|ag_base|50|ag_modifier|planet_crime_add|
		} }
	}
}
planet_event = {
	id = ag_zeta_psionics.62
	title = "ag_zeta_psionics.62.name"
	desc = "ag_zeta_psionics.62.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_unspeakable_horror_room }
	show_sound = event_mystic_reveal
	location = root
	is_triggered_only = yes
	immediate = { add_modifier = {
		modifier = "ag_zeta_crisis_upkeep_debuff"
		days = @ag_zeta_crisis_planet_debuff_days
		multiplier = value:ag_zeta_crisis_planet_debuff_multiplier|ag_base|1|ag_modifier|planet_jobs_upkeep_mult|
	} }
	option = {
		name = "ag_zeta_psionics.62.a"
		tooltip = { add_modifier = {
			modifier = "ag_zeta_crisis_upkeep_debuff"
			days = @ag_zeta_crisis_planet_debuff_days
			multiplier = value:ag_zeta_crisis_planet_debuff_multiplier|ag_base|1|ag_modifier|planet_jobs_upkeep_mult|
		} }
	}
}
planet_event = {
	id = ag_zeta_psionics.63
	title = "ag_zeta_psionics.63.name"
	desc = "ag_zeta_psionics.63.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_unspeakable_horror_room }
	show_sound = event_mystic_reveal
	location = root
	is_triggered_only = yes
	immediate = { add_modifier = {
		modifier = "ag_zeta_crisis_produce_debuff"
		days = @ag_zeta_crisis_planet_debuff_days
		multiplier = value:ag_zeta_crisis_planet_debuff_multiplier|ag_base|0.25|ag_modifier|planet_jobs_produces_mult|
	} }
	option = {
		name = "ag_zeta_psionics.63.a"
		tooltip = { add_modifier = {
			modifier = "ag_zeta_crisis_produce_debuff"
			days = @ag_zeta_crisis_planet_debuff_days
			multiplier = value:ag_zeta_crisis_planet_debuff_multiplier|ag_base|0.25|ag_modifier|planet_jobs_produces_mult|
		} }
	}
}

# Country debuff.
country_event = {
	id = ag_zeta_psionics.64
	title = "ag_zeta_psionics.64.name"
	desc = "ag_zeta_psionics.64.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_unspeakable_horror_room }
	show_sound = event_mystic_reveal
	location = root
	is_triggered_only = yes
	immediate = { add_modifier = {
		modifier = "ag_zeta_crisis_ship_upkeep_debuff"
		days = @ag_zeta_crisis_planet_debuff_days
		multiplier = value:ag_zeta_crisis_planet_debuff_multiplier|ag_base|1|ag_modifier|ships_upkeep_mult|
	} }
	option = {
		name = "ag_zeta_psionics.64.a"
		tooltip = { add_modifier = {
			modifier = "ag_zeta_crisis_ship_upkeep_debuff"
			days = @ag_zeta_crisis_planet_debuff_days
			multiplier = value:ag_zeta_crisis_planet_debuff_multiplier|ag_base|1|ag_modifier|ships_upkeep_mult|
		} }
	}
}
country_event = {
	id = ag_zeta_psionics.65
	title = "ag_zeta_psionics.65.name"
	desc = "ag_zeta_psionics.65.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_unspeakable_horror_room }
	show_sound = event_mystic_reveal
	location = root
	is_triggered_only = yes
	immediate = { add_modifier = {
		modifier = "ag_zeta_crisis_ship_build_cost_debuff"
		days = @ag_zeta_crisis_planet_debuff_days
		multiplier = value:ag_zeta_crisis_planet_debuff_multiplier|ag_base|1|ag_modifier|starbase_shipyard_build_cost_mult|
	} }
	option = {
		name = "ag_zeta_psionics.65.a"
		tooltip = { add_modifier = {
			modifier = "ag_zeta_crisis_ship_build_cost_debuff"
			days = @ag_zeta_crisis_planet_debuff_days
			multiplier = value:ag_zeta_crisis_planet_debuff_multiplier|ag_base|1|ag_modifier|starbase_shipyard_build_cost_mult|
		} }
	}
}
country_event = {
	id = ag_zeta_psionics.66
	title = "ag_zeta_psionics.66.name"
	desc = "ag_zeta_psionics.66.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_unspeakable_horror_room }
	show_sound = event_mystic_reveal
	location = root
	is_triggered_only = yes
	immediate = { add_modifier = {
		modifier = "ag_zeta_crisis_ship_build_speed_debuff"
		days = @ag_zeta_crisis_planet_debuff_days
		multiplier = value:ag_zeta_crisis_planet_debuff_multiplier|ag_base|0.5|ag_modifier|starbase_shipyard_build_speed_mult|
	} }
	option = {
		name = "ag_zeta_psionics.66.a"
		tooltip = { add_modifier = {
			modifier = "ag_zeta_crisis_ship_build_speed_debuff"
			days = @ag_zeta_crisis_planet_debuff_days
			multiplier = value:ag_zeta_crisis_planet_debuff_multiplier|ag_base|0.5|ag_modifier|starbase_shipyard_build_speed_mult|
		} }
	}
}
country_event = {
	id = ag_zeta_psionics.67
	title = "ag_zeta_psionics.67.name"
	desc = "ag_zeta_psionics.67.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_unspeakable_horror_room }
	show_sound = event_mystic_reveal
	location = root
	is_triggered_only = yes
	immediate = { add_modifier = {
		modifier = "ag_zeta_crisis_happiness_debuff"
		days = @ag_zeta_crisis_planet_debuff_days
		multiplier = value:ag_zeta_crisis_planet_debuff_multiplier|ag_base|0.2|ag_modifier|pop_happiness|
	} }
	option = {
		name = "ag_zeta_psionics.67.a"
		tooltip = { add_modifier = {
			modifier = "ag_zeta_crisis_happiness_debuff"
			days = @ag_zeta_crisis_planet_debuff_days
			multiplier = value:ag_zeta_crisis_planet_debuff_multiplier|ag_base|0.2|ag_modifier|pop_happiness|
		} }
	}
}
country_event = {
	id = ag_zeta_psionics.68
	title = "ag_zeta_psionics.68.name"
	desc = "ag_zeta_psionics.68.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_unspeakable_horror_room }
	show_sound = event_mystic_reveal
	location = root
	is_triggered_only = yes
	immediate = { add_modifier = {
		modifier = "ag_zeta_crisis_ethic_debuff"
		days = @ag_zeta_crisis_planet_debuff_days
		multiplier = value:ag_zeta_crisis_planet_debuff_multiplier|ag_base|0.5|ag_modifier|pop_government_ethic_attraction|
	} }
	option = {
		name = "ag_zeta_psionics.68.a"
		tooltip = { add_modifier = {
			modifier = "ag_zeta_crisis_ethic_debuff"
			days = @ag_zeta_crisis_planet_debuff_days
			multiplier = value:ag_zeta_crisis_planet_debuff_multiplier|ag_base|0.5|ag_modifier|pop_government_ethic_attraction|
		} }
	}
}
country_event = {
	id = ag_zeta_psionics.69
	title = "ag_zeta_psionics.69.name"
	desc = "ag_zeta_psionics.69.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_unspeakable_horror_room }
	show_sound = event_mystic_reveal
	location = root
	is_triggered_only = yes
	immediate = { add_modifier = {
		modifier = "ag_zeta_crisis_armor_debuff"
		days = @ag_zeta_crisis_planet_debuff_days
		multiplier = value:ag_zeta_crisis_planet_debuff_multiplier|ag_base|0.2|ag_modifier|ship_armor_mult|
	} }
	option = {
		name = "ag_zeta_psionics.69.a"
		tooltip = { add_modifier = {
			modifier = "ag_zeta_crisis_armor_debuff"
			days = @ag_zeta_crisis_planet_debuff_days
			multiplier = value:ag_zeta_crisis_planet_debuff_multiplier|ag_base|0.2|ag_modifier|ship_armor_mult|
		} }
	}
}
country_event = {
	id = ag_zeta_psionics.70
	title = "ag_zeta_psionics.70.name"
	desc = "ag_zeta_psionics.70.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_unspeakable_horror_room }
	show_sound = event_mystic_reveal
	location = root
	is_triggered_only = yes
	immediate = { add_modifier = {
		modifier = "ag_zeta_crisis_growth_debuff"
		days = @ag_zeta_crisis_planet_debuff_days
		multiplier = value:ag_zeta_crisis_planet_debuff_multiplier|ag_base|0.3|ag_modifier|pop_growth_speed|
	} }
	option = {
		name = "ag_zeta_psionics.70.a"
		tooltip = { add_modifier = {
			modifier = "ag_zeta_crisis_growth_debuff"
			days = @ag_zeta_crisis_planet_debuff_days
			multiplier = value:ag_zeta_crisis_planet_debuff_multiplier|ag_base|0.3|ag_modifier|pop_growth_speed|
		} }
	}
}
country_event = {
	id = ag_zeta_psionics.71
	title = "ag_zeta_psionics.71.name"
	desc = "ag_zeta_psionics.71.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_unspeakable_horror_room }
	show_sound = event_mystic_reveal
	location = root
	is_triggered_only = yes
	immediate = { add_modifier = {
		modifier = "ag_zeta_crisis_research_debuff"
		days = @ag_zeta_crisis_planet_debuff_days
		multiplier = value:ag_zeta_crisis_planet_debuff_multiplier|ag_base|0.2|ag_modifier|all_technology_research_speed|
	} }
	option = {
		name = "ag_zeta_psionics.71.a"
		tooltip = { add_modifier = {
			modifier = "ag_zeta_crisis_research_debuff"
			days = @ag_zeta_crisis_planet_debuff_days
			multiplier = value:ag_zeta_crisis_planet_debuff_multiplier|ag_base|0.2|ag_modifier|all_technology_research_speed|
		} }
	}
}
country_event = {
	id = ag_zeta_psionics.72
	title = "ag_zeta_psionics.72.name"
	desc = "ag_zeta_psionics.72.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_unspeakable_horror_room }
	show_sound = event_mystic_reveal
	location = root
	is_triggered_only = yes
	immediate = { add_modifier = {
		modifier = "ag_zeta_crisis_influence_debuff"
		days = @ag_zeta_crisis_planet_debuff_days
		multiplier = value:ag_zeta_crisis_planet_debuff_multiplier|ag_base|0.2|ag_modifier|country_influence_produces_mult|
	} }
	option = {
		name = "ag_zeta_psionics.72.a"
		tooltip = { add_modifier = {
			modifier = "ag_zeta_crisis_influence_debuff"
			days = @ag_zeta_crisis_planet_debuff_days
			multiplier = value:ag_zeta_crisis_planet_debuff_multiplier|ag_base|0.2|ag_modifier|country_influence_produces_mult|
		} }
	}
}
country_event = {
	id = ag_zeta_psionics.73
	title = "ag_zeta_psionics.73.name"
	desc = "ag_zeta_psionics.73.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_unspeakable_horror_room }
	show_sound = event_mystic_reveal
	location = root
	is_triggered_only = yes
	immediate = { add_modifier = {
		modifier = "ag_zeta_crisis_unity_debuff"
		days = @ag_zeta_crisis_planet_debuff_days
		multiplier = value:ag_zeta_crisis_planet_debuff_multiplier|ag_base|0.2|ag_modifier|country_unity_produces_mult|
	} }
	option = {
		name = "ag_zeta_psionics.73.a"
		tooltip = { add_modifier = {
			modifier = "ag_zeta_crisis_unity_debuff"
			days = @ag_zeta_crisis_planet_debuff_days
			multiplier = value:ag_zeta_crisis_planet_debuff_multiplier|ag_base|0.2|ag_modifier|country_unity_produces_mult|
		} }
	}
}
country_event = {
	id = ag_zeta_psionics.74
	title = "ag_zeta_psionics.74.name"
	desc = "ag_zeta_psionics.74.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_unspeakable_horror_room }
	show_sound = event_mystic_reveal
	location = root
	is_triggered_only = yes
	immediate = { add_modifier = {
		modifier = "ag_zeta_crisis_speed_debuff"
		days = @ag_zeta_crisis_planet_debuff_days
		multiplier = value:ag_zeta_crisis_planet_debuff_multiplier|ag_base|0.2|ag_modifier|ship_speed_mult|
	} }
	option = {
		name = "ag_zeta_psionics.74.a"
		tooltip = { add_modifier = {
			modifier = "ag_zeta_crisis_speed_debuff"
			days = @ag_zeta_crisis_planet_debuff_days
			multiplier = value:ag_zeta_crisis_planet_debuff_multiplier|ag_base|0.2|ag_modifier|ship_speed_mult|
		} }
	}
}
country_event = {
	id = ag_zeta_psionics.75
	title = "ag_zeta_psionics.75.name"
	desc = "ag_zeta_psionics.75.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_unspeakable_horror_room }
	show_sound = event_mystic_reveal
	location = root
	is_triggered_only = yes
	immediate = { add_modifier = {
		modifier = "ag_zeta_crisis_morale_debuff"
		days = @ag_zeta_crisis_planet_debuff_days
		multiplier = value:ag_zeta_crisis_planet_debuff_multiplier|ag_base|0.2|ag_modifier|army_morale|
	} }
	option = {
		name = "ag_zeta_psionics.75.a"
		tooltip = { add_modifier = {
			modifier = "ag_zeta_crisis_morale_debuff"
			days = @ag_zeta_crisis_planet_debuff_days
			multiplier = value:ag_zeta_crisis_planet_debuff_multiplier|ag_base|0.2|ag_modifier|army_morale|
		} }
	}
}
country_event = {
	id = ag_zeta_psionics.76
	title = "ag_zeta_psionics.76.name"
	desc = "ag_zeta_psionics.76.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_unspeakable_horror_room }
	show_sound = event_mystic_reveal
	location = root
	is_triggered_only = yes
	immediate = {
		add_modifier = {
			modifier = "ag_zeta_crisis_sensors_debuff"
			days = @ag_zeta_crisis_planet_debuff_days
			multiplier = value:ag_zeta_crisis_planet_debuff_multiplier|ag_base|0.2|ag_modifier|ship_sensor_range_add|
		}
		every_owned_megastructure = {
			limit = { OR = { is_megastructure_type = spy_orb_4 is_megastructure_type = spy_orb_restored } }
			if = {
				limit = { is_megastructure_type = spy_orb_4 }
				if = {
					limit = { exists = planet }
					solar_system = { spawn_megastructure = {
						type = spy_orb_4_dummy
						planet = prev.planet
						graphical_culture = root
						owner = root
					} }
				}
				else = {
					solar_system = { spawn_megastructure = {
						type = spy_orb_4_dummy
						coords_from = prev
						graphical_culture = root
						owner = root
					} }
				}
			}
			else = {
				if = {
					limit = { exists = planet }
					solar_system = { spawn_megastructure = {
						type = spy_orb_restored_dummy
						planet = prev.planet
						graphical_culture = root
						owner = root
					} }
				}
				else = {
					solar_system = { spawn_megastructure = {
						type = spy_orb_restored_dummy
						coords_from = prev
						graphical_culture = root
						owner = root
					} }
				}
			}
		}
		country_event = { id = ag_zeta_psionics.77 days = @ag_zeta_crisis_planet_debuff_days }
	}
	option = {
		name = "ag_zeta_psionics.76.a"
		tooltip = { add_modifier = {
			modifier = "ag_zeta_crisis_sensors_debuff"
			days = @ag_zeta_crisis_planet_debuff_days
			multiplier = value:ag_zeta_crisis_planet_debuff_multiplier|ag_base|0.2|ag_modifier|ship_sensor_range_add|
		} }
		custom_tooltip = "ag_zeta_psionics.76.a.tooltip"
	}
}
country_event = {
	id = ag_zeta_psionics.77
	hide_window = yes
	is_triggered_only = yes
	immediate = {
		every_owned_megastructure = {
			limit = { OR = { is_megastructure_type = spy_orb_4_dummy is_megastructure_type = spy_orb_restored_dummy } }
			if = {
				limit = { is_megastructure_type = spy_orb_4_dummy }
				if = {
					limit = { exists = planet }
					solar_system = { spawn_megastructure = {
						type = spy_orb_4
						planet = prev.planet
						graphical_culture = root
						owner = root
					} }
				}
				else = {
					solar_system = { spawn_megastructure = {
						type = spy_orb_4
						coords_from = prev
						graphical_culture = root
						owner = root
					} }
				}
			}
			else = {
				if = {
					limit = { exists = planet }
					solar_system = { spawn_megastructure = {
						type = spy_orb_restored
						planet = prev.planet
						graphical_culture = root
						owner = root
					} }
				}
				else = {
					solar_system = { spawn_megastructure = {
						type = spy_orb_restored
						coords_from = prev
						graphical_culture = root
						owner = root
					} }
				}
			}
		}
	}
}

# Small psionic portal
country_event = {
	id = ag_zeta_psionics.78
	title = "ag_zeta_psionics.78.name"
	desc = {
		trigger = { NOT = { has_country_flag = ag_zeta_psionics_80_fired } }
		text = "ag_zeta_psionics.78.a.desc"
	}
	desc = {
		trigger = { has_country_flag = ag_zeta_psionics_80_fired }
		text = "ag_zeta_psionics.78.b.desc"
	}
	diplomatic = yes
	custom_gui = "ag_ancient_event_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_unspeakable_horror_room }
	show_sound = event_yellow_alert
	location = event_target:ag_target_system
	is_triggered_only = yes
	trigger = { event_target:global_event_country = { check_variable = { which = ag_scaled_difficulty value >= 0 } } }
	immediate = {
		random_system_within_border = {
			limit = { NOR = {
				any_system_planet = { is_capital = yes }
				any_ship_in_system = { is_ship_size = ag_zeta_crisis_small_portal }
				any_system_ambient_object = { has_ambient_object_flag = ag_zeta_crisis_small_portal_object }
			} }
			save_event_target_as = ag_target_system
		}
		if = {
			limit = { NOT = { exists = event_target:ag_target_system } }
			random_system_within_border = {
				limit = { NOR = { any_ship_in_system = { is_ship_size = ag_zeta_crisis_small_portal } any_system_ambient_object = { has_ambient_object_flag = ag_zeta_crisis_small_portal_object } } }
				save_event_target_as = ag_target_system
			}
			if = {
				limit = { NOT = { exists = event_target:ag_target_system } }
				random_system_within_border = {
					limit = { NOT = { any_system_ambient_object = { has_ambient_object_flag = ag_zeta_crisis_small_portal_object } } }
					save_event_target_as = ag_target_system
				}
				if = {
					limit = { NOT = { exists = event_target:ag_target_system } }
					random_system_within_border = { save_event_target_as = ag_target_system }
				}
			}
		}
		event_target:ag_target_system = {
			create_ambient_object = { type = "ag_zeta_crisis_small_portal_object"  }
			last_created_ambient_object = { set_ambient_object_flag = ag_zeta_crisis_small_portal_object save_event_target_as = ag_target_object }
		}
	}
	option = {
		name = "ag_zeta_psionics.78.a"
		hidden_effect = { event_target:ag_target_system = { system_event = { id = ag_zeta_psionics.80 days = 360 } } }
	}
	option = {
		name = "ag_zeta_psionics.78.b"
		event_target:ag_target_object = { enable_special_project = { name = "ag_zeta_crisis_small_portal_project" location = this owner = root } }
	}
}
fleet_event = {
	id = ag_zeta_psionics.79
	title = "ag_zeta_psionics.79.name"
	desc = "ag_zeta_psionics.79.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_s_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_unspeakable_horror_room }
	show_sound = event_mystic_reveal
	location = root
	is_triggered_only = yes
	immediate = {
		solar_system = { random_system_ambient_object = {
			limit = { has_ambient_object_flag = ag_zeta_crisis_small_portal_object }
			destroy_ambient_object = this
		} }
	}
	option = { name = "ag_zeta_psionics.79.a" }
}
system_event = {
	id = ag_zeta_psionics.80
	hide_window = yes
	is_triggered_only = yes
	immediate = {
		random_system_ambient_object = {
			limit = { has_ambient_object_flag = ag_zeta_crisis_small_portal_object }
			save_event_target_as = ag_zeta_crisis_small_portal_spawn_loc
		}
		if = {
			limit = { exists = event_target:ag_zeta_crisis_small_portal_spawn_loc }
			create_fleet = {
				name = "NAME_ag_zeta_crisis_small_portal_fleet"
				settings = {
					is_boss = yes
					spawn_debris = no
				}
				effect = {
					set_fleet_flag = ag_zeta_crisis_small_portal
					set_owner = event_target:ag_zeta_crisis_country
					create_ship = {
						name = "NAME_ag_zeta_crisis_small_portal_ship"
						design = "NAME_ag_zeta_crisis_small_portal"
						prefix = no
						effect = {
							ag_difficulty_bonus = yes
							ag_set_disable_at_health = { ag_value = 0.05 ag_disable_type = event }
						}
					}
					set_location = { target = prev distance = 0 angle = 0 }
					fleet_event = { id = ag_zeta_psionics.82 days = 1080 random = 720 }
				}
			}
			ag_spawn_zeta_crisis_assault_fleet = yes
			if = {
				limit = { exists = space_owner }
				if = {
					limit = {
						OR = { has_galactic_custodian = yes has_galactic_emperor = yes }
						space_owner = {
							is_ai = yes
							is_galactic_community_member = yes
							is_galactic_custodian = no
							is_galactic_emperor = no
						}
					}
					space_owner = { save_event_target_as = ag_target_community_member }
					if = {
						limit = { has_galactic_custodian = yes }
						random_playable_country = {
							limit = { is_galactic_custodian = yes }
							country_event = { id = ag_zeta_psionics.103 }
						}
					}
					else_if = {
						limit = { has_galactic_emperor = yes }
						random_playable_country = {
							limit = { is_galactic_emperor = yes }
							country_event = { id = ag_zeta_psionics.104 }
						}
					}
				}
				space_owner = { set_country_flag = ag_zeta_psionics_80_fired country_event = { id = ag_zeta_psionics.81 } }
			}
		}
		event_target:ag_zeta_crisis_small_portal_spawn_loc = { ag_spawn_explosion_effect = { ag_scale = l ag_color = violet } destroy_ambient_object = this }
	}
}
country_event = {
	id = ag_zeta_psionics.81
	title = "ag_zeta_psionics.81.name"
	desc = "ag_zeta_psionics.81.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_s_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_fleet_evil_room }
	show_sound = event_red_alert
	location = from
	is_triggered_only = yes
	option = { name = "ag_zeta_psionics.81.a" }
}
fleet_event = {
	id = ag_zeta_psionics.82
	hide_window = yes
	is_triggered_only = yes
	trigger = { exists = this }
	immediate = { ag_spawn_zeta_crisis_assault_fleet = yes }
}
# on_ship_disabled, Shroud Invaders' Small Psionic Portal destroyed (actually is disabled)
ship_event = {
	id = ag_zeta_psionics.83
	hide_window = yes
	is_triggered_only = yes
	trigger = {
		is_ship_size = ag_zeta_crisis_small_portal
		exists = owner
		owner = { is_country_type = ag_zeta_crisis_country }
	}
	immediate = {
		from.fleet = { fleet_event = { id = ag_zeta_psionics.84 } }
		fleet = { destroy_fleet = { target = this kill_leader = yes destroy_template = yes } }
	}
}
fleet_event = {
	id = ag_zeta_psionics.84
	title = "ag_zeta_psionics.84.name"
	desc = "ag_zeta_psionics.84.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_s_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_small_space_battle_room }
	show_sound = event_ship_explosion
	location = solar_system.star
	is_triggered_only = yes
	option = { name = "ag_zeta_psionics.84.a" }
}

# Community Member Pleads for Help, to custodian, Shroud Invaders' armies appeared on planet.
country_event = {
	id = ag_zeta_psionics.101
	title = "ag_zeta_psionics.101.name"
	desc = "ag_zeta_psionics.101.desc"
	diplomatic = yes
	force_open = yes
	custom_gui = "ag_ancient_event_diplomacy_window"
	custom_gui_option = "ag_ancient_event_diplomacy_option"
	picture_event_data = {
		portrait = event_target:ag_target_community_member
		planet_background = event_target:ag_target_community_member
		graphical_culture = event_target:ag_target_community_member
		city_level = event_target:ag_target_community_member
		room = event_target:ag_target_community_member
	}
	location = from
	is_triggered_only = yes
	option = { name = "ag_zeta_psionics.101.a" }
}
# Community Member Pleads for Help, to emperor, Shroud Invaders' armies appeared on planet.
country_event = {
	id = ag_zeta_psionics.102
	title = "ag_zeta_psionics.102.name"
	desc = "ag_zeta_psionics.102.desc"
	diplomatic = yes
	force_open = yes
	custom_gui = "ag_ancient_event_diplomacy_window"
	custom_gui_option = "ag_ancient_event_diplomacy_option"
	picture_event_data = {
		portrait = event_target:ag_target_community_member
		planet_background = event_target:ag_target_community_member
		graphical_culture = event_target:ag_target_community_member
		city_level = event_target:ag_target_community_member
		room = event_target:ag_target_community_member
	}
	location = from
	is_triggered_only = yes
	option = { name = "ag_zeta_psionics.102.a" }
}

# Community Member Pleads for Help, to custodian, Shroud Invaders' portal appeared.
country_event = {
	id = ag_zeta_psionics.103
	title = "ag_zeta_psionics.103.name"
	desc = "ag_zeta_psionics.103.desc"
	diplomatic = yes
	force_open = yes
	custom_gui = "ag_ancient_event_diplomacy_window"
	custom_gui_option = "ag_ancient_event_diplomacy_option"
	picture_event_data = {
		portrait = event_target:ag_target_community_member
		planet_background = event_target:ag_target_community_member
		graphical_culture = event_target:ag_target_community_member
		city_level = event_target:ag_target_community_member
		room = event_target:ag_target_community_member
	}
	location = from
	is_triggered_only = yes
	option = { name = "ag_zeta_psionics.103.a" }
}
# Community Member Pleads for Help, to emperor, Shroud Invaders' portal appeared.
country_event = {
	id = ag_zeta_psionics.104
	title = "ag_zeta_psionics.104.name"
	desc = "ag_zeta_psionics.104.desc"
	diplomatic = yes
	force_open = yes
	custom_gui = "ag_ancient_event_diplomacy_window"
	custom_gui_option = "ag_ancient_event_diplomacy_option"
	picture_event_data = {
		portrait = event_target:ag_target_community_member
		planet_background = event_target:ag_target_community_member
		graphical_culture = event_target:ag_target_community_member
		city_level = event_target:ag_target_community_member
		room = event_target:ag_target_community_member
	}
	location = from
	is_triggered_only = yes
	option = { name = "ag_zeta_psionics.104.a" }
}

# Community Member Pleads for Help, to custodian, Shroud Invaders' portal appeared.
country_event = {
	id = ag_zeta_psionics.105
	title = "ag_zeta_psionics.105.name"
	desc = "ag_zeta_psionics.105.desc"
	diplomatic = yes
	force_open = yes
	custom_gui = "ag_ancient_event_diplomacy_window"
	custom_gui_option = "ag_ancient_event_diplomacy_option"
	picture_event_data = {
		portrait = event_target:ag_target_community_member
		planet_background = event_target:ag_target_community_member
		graphical_culture = event_target:ag_target_community_member
		city_level = event_target:ag_target_community_member
		room = event_target:ag_target_community_member
	}
	location = event_target:ag_psionic_portal_spawn_system
	is_triggered_only = yes
	option = { name = "ag_zeta_psionics.105.a" }
}
# Community Member Pleads for Help, to emperor, Shroud Invaders' portal appeared.
country_event = {
	id = ag_zeta_psionics.106
	title = "ag_zeta_psionics.106.name"
	desc = "ag_zeta_psionics.106.desc"
	diplomatic = yes
	force_open = yes
	custom_gui = "ag_ancient_event_diplomacy_window"
	custom_gui_option = "ag_ancient_event_diplomacy_option"
	picture_event_data = {
		portrait = event_target:ag_target_community_member
		planet_background = event_target:ag_target_community_member
		graphical_culture = event_target:ag_target_community_member
		city_level = event_target:ag_target_community_member
		room = event_target:ag_target_community_member
	}
	location = event_target:ag_psionic_portal_spawn_system
	is_triggered_only = yes
	option = { name = "ag_zeta_psionics.106.a" }
}

# Custodian Announces Crisis
country_event = {
	id = ag_zeta_psionics.111
	title = "ag_zeta_psionics.111.name"
	desc = "ag_zeta_psionics.111.desc"
	diplomatic = yes
	force_open = yes
	custom_gui = "ag_ancient_event_diplomacy_window"
	custom_gui_option = "ag_ancient_event_diplomacy_option"
	picture_event_data = {
		portrait = galactic_custodian
		planet_background = galactic_custodian
		graphical_culture = galactic_custodian
		city_level = galactic_custodian
		room = galactic_custodian
	}
	is_triggered_only = yes
	option = { name = "ag_zeta_psionics.111.a" }
}
# Emperor Announces Crisis
country_event = {
	id = ag_zeta_psionics.112
	title = "ag_zeta_psionics.112.name"
	desc = "ag_zeta_psionics.112.desc"
	diplomatic = yes
	force_open = yes
	custom_gui = "ag_ancient_event_diplomacy_window"
	custom_gui_option = "ag_ancient_event_diplomacy_option"
	picture_event_data = {
		portrait = galactic_emperor
		planet_background = galactic_emperor
		graphical_culture = galactic_emperor
		city_level = galactic_emperor
		room = galactic_emperor
	}
	is_triggered_only = yes
	option = { name = "ag_zeta_psionics.112.a" }
}

# Eta Area Monument effects.
country_event = {
	id = ag_zeta_psionics.201
	title = "ag_zeta_psionics.201.name"
	desc = "ag_zeta_psionics.201.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_m_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_alien_ruins_room }
	show_sound = event_yellow_alert
	is_triggered_only = yes
	option = { name = "ag_zeta_psionics.201.a" }
}
country_event = {
	id = ag_zeta_psionics.202
	title = "ag_zeta_psionics.202.name"
	desc = "ag_zeta_psionics.202.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_m_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_arguing_senate_room }
	show_sound = event_yellow_alert
	is_triggered_only = yes
	option = { name = "ag_zeta_psionics.202.a" }
	option = {
		name = "ag_zeta_psionics.202.b"
		event_target:ag_ancient_eta_shielded_world = { remove_building = ag_ancient_eta_monument }
	}
}
country_event = {
	id = ag_zeta_psionics.203
	title = "ag_zeta_psionics.203.name"
	desc = "ag_zeta_psionics.203.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_m_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_burning_settlement_room }
	show_sound = event_open_revolt
	is_triggered_only = yes
	option = { name = "ag_zeta_psionics.203.a" }
	option = {
		name = "ag_zeta_psionics.203.b"
		event_target:ag_ancient_eta_shielded_world = { remove_building = ag_ancient_eta_monument }
	}
}
country_event = {
	id = ag_zeta_psionics.204
	title = "ag_zeta_psionics.204.name"
	desc = "ag_zeta_psionics.204.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_m_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_alien_ruins_room }
	show_sound = event_default
	is_triggered_only = yes
	option = { name = "ag_zeta_psionics.204.a" }
	option = { name = "ag_zeta_psionics.204.b" }
}

# Crisis Beacon - transfer psionic mark.
espionage_operation_event = {
	id = ag_zeta_psionics.210
	title = "ag_zeta_psionics.210.name"
	desc = {
		trigger = { any_owned_planet = {
			exists = controller
			controller = { is_same_value = prevprev }
			has_modifier = "ag_zeta_crisis_marked"
		} }
		text = "ag_zeta_psionics.210.desc"
	}
	desc = {
		trigger = { NOT = { any_owned_planet = {
			exists = controller
			controller = { is_same_value = prevprev }
			has_modifier = "ag_zeta_crisis_marked"
		} } }
		text = "ag_zeta_psionics.210.cancel"
	}
	picture = GFX_evt_spy_network
	show_sound = event_default
	espionage_operation = yes
	is_triggered_only = yes
	immediate = { set_espionage_operation_progress_locked = yes }
	option = {
		name = "ag_zeta_psionics.210.a"
		trigger = { any_owned_planet = {
			exists = controller
			controller = { is_same_value = prevprev }
			has_modifier = "ag_zeta_crisis_marked"
		} }
		hidden_effect = { set_espionage_operation_progress_locked = no }
	}
	option = {
		name = "ag_zeta_psionics.210.b"
		trigger = { NOT = { any_owned_planet = {
			exists = controller
			controller = { is_same_value = prevprev }
			has_modifier = "ag_zeta_crisis_marked"
		} } }
		root = { destroy_espionage_operation = this }
	}
}
espionage_operation_event = {
	id = ag_zeta_psionics.211
	title = "ag_zeta_psionics.211.name"
	desc = {
		trigger = { any_owned_planet = {
			exists = controller
			controller = { is_same_value = prevprev }
			has_modifier = "ag_zeta_crisis_marked"
		} }
		text = "ag_zeta_psionics.211.desc"
	}
	desc = {
		trigger = { NOT = { any_owned_planet = {
			exists = controller
			controller = { is_same_value = prevprev }
			has_modifier = "ag_zeta_crisis_marked"
		} } }
		text = "ag_zeta_psionics.210.cancel"
	}
	picture = GFX_evt_spy_network
	show_sound = event_default
	espionage_operation = yes
	is_triggered_only = yes
	option = {
		name = "ag_zeta_psionics.211.a"
		trigger = { any_owned_planet = {
			exists = controller
			controller = { is_same_value = prevprev }
			has_modifier = "ag_zeta_crisis_marked"
		} }
		hidden_effect = { set_espionage_operation_progress_locked = no }
	}
	option = {
		name = "ag_zeta_psionics.211.b"
		trigger = { NOT = { any_owned_planet = {
			exists = controller
			controller = { is_same_value = prevprev }
			has_modifier = "ag_zeta_crisis_marked"
		} } }
		root = { destroy_espionage_operation = this }
	}
}
espionage_operation_event = {
	id = ag_zeta_psionics.212
	title = "ag_zeta_psionics.212.name"
	desc = {
		trigger = { any_owned_planet = {
			exists = controller
			controller = { is_same_value = prevprev }
			has_modifier = "ag_zeta_crisis_marked"
		} }
		text = "ag_zeta_psionics.212.desc"
	}
	desc = {
		trigger = { NOT = { any_owned_planet = {
			exists = controller
			controller = { is_same_value = prevprev }
			has_modifier = "ag_zeta_crisis_marked"
		} } }
		text = "ag_zeta_psionics.210.cancel"
	}
	picture = GFX_evt_colony_settlement
	show_sound = event_default
	espionage_operation = yes
	is_triggered_only = yes
	immediate = {
		target = {
			save_event_target_as = ag_crisis_beacon_target_country
			random_owned_planet = { save_event_target_as = ag_crisis_beacon_target_planet }
		}
		set_espionage_operation_progress_locked = yes
	}
	after = { hidden_effect = { set_espionage_operation_progress_locked = no } }
	option = {
		name = "ag_zeta_psionics.212.a"
		trigger = { any_owned_planet = {
			exists = controller
			controller = { is_same_value = prevprev }
			has_modifier = "ag_zeta_crisis_marked"
		} }
		hidden_effect = { owner = { country_event = { id = ag_zeta_psionics.213 days = 3 } } set_espionage_operation_progress_locked = no }
	}
	option = {
		name = "ag_zeta_psionics.212.b"
		trigger = { NOT = { any_owned_planet = {
			exists = controller
			controller = { is_same_value = prevprev }
			has_modifier = "ag_zeta_crisis_marked"
		} } }
		root = { destroy_espionage_operation = this }
	}
}
country_event = {
	id = ag_zeta_psionics.213
	title = "ag_zeta_psionics.213.name"
	desc = "ag_zeta_psionics.213.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_unspeakable_horror_room }
	show_sound = event_espionage_concluded
	is_triggered_only = yes
	trigger = { any_owned_planet = {
		exists = controller
		controller = { is_same_value = prevprev }
		has_modifier = "ag_zeta_crisis_marked"
	} }
	immediate = {
		random_owned_planet = {
			limit = {
				exists = controller
				controller = { is_same_value = prevprev }
				has_modifier = "ag_zeta_crisis_marked"
			}
			save_event_target_as = ag_crisis_beacon_source_planet
			reroll_random = yes
			random_list = {
				25 = { add_planet_devastation = 50 }
				25 = { add_planet_devastation = 60 }
				25 = { add_planet_devastation = 70 }
				25 = { add_planet_devastation = 75 }
			}
		}
		event_target:ag_crisis_beacon_target_planet = {
			add_modifier = { modifier = "ag_zeta_crisis_marked" days = -1 }
			planet_event = { id = ag_zeta_psionics.214 days = 1 }
		}
	}
	after = {
		event_target:ag_crisis_beacon_source_planet = { remove_modifier = "ag_zeta_crisis_marked" }
		hidden_effect = {
			if = {
				limit = { owner = { NOT = { has_country_flag = operation_complete_crisis_beacon } } }
				owner = {
					change_variable = { which = tinker_tailor_soldier_blorg_achievement_count value = 1 }
					set_country_flag = operation_complete_crisis_beacon
				}
			}
		}
		destroy_espionage_operation = from
	}
	option = {
		name = "ag_zeta_psionics.213.a"
		from.spynetwork = { add_spy_network_level_on_success_effect = { VALUE = -80 } }
		from.owner = { if = { limit = { has_ascension_perk = ap_become_the_crisis } complete_crisis_objective = crisobj_perform_upsetting_operations } }
	}
}
planet_event = {
	id = ag_zeta_psionics.214
	title = "ag_zeta_psionics.214.name"
	desc = "ag_zeta_psionics.214.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_unspeakable_horror_room }
	show_sound = event_yellow_alert
	is_triggered_only = yes
	immediate = { planet_event = { id = ag_zeta_psionics.51 days = 90 random = 90 } }
	option = { name = "ag_zeta_psionics.214.a" tooltip = { add_modifier = { modifier = "ag_zeta_crisis_marked" days = -1 } } }
}

# Entering Shroud, overwrited.
country_event = {
	id = ag_zeta_psionics.1000
	title = "ag_zeta_psionics.1000.name"
	# desc = {
		# trigger = { OR = { has_modifier = "shroud_cooldown" has_modifier = "shroud_precog_cooldown" } }
		# text = "utopia.3010.desc"
	# }
	desc = {
		# trigger = { NOR = { has_modifier = "shroud_cooldown" has_modifier = "shroud_precog_cooldown" } }
		trigger = { always = yes }
		text = "ag_zeta_psionics.1000.01.desc"
		text = "ag_zeta_psionics.1000.02.desc"
		text = "ag_zeta_psionics.1000.03.desc"
		text = "ag_zeta_psionics.1000.04.desc"
		text = "ag_zeta_psionics.1000.05.desc"
		text = "ag_zeta_psionics.1000.06.desc"
		text = "ag_zeta_psionics.1000.07.desc"
		text = "ag_zeta_psionics.1000.08.desc"
		text = "ag_zeta_psionics.1000.09.desc"
		text = "ag_zeta_psionics.1000.10.desc"
		text = "ag_zeta_psionics.1000.11.desc"
		text = "ag_zeta_psionics.1000.12.desc"
		text = "ag_zeta_psionics.1000.13.desc"
		text = "ag_zeta_psionics.1000.14.desc"
		text = "ag_zeta_psionics.1000.15.desc"
		text = "ag_zeta_psionics.1000.16.desc"
		text = "ag_zeta_psionics.1000.17.desc"
		text = "ag_zeta_psionics.1000.18.desc"
		text = "ag_zeta_psionics.1000.19.desc"
		text = "ag_zeta_psionics.1000.20.desc"
	}
	desc = {
		trigger = {
			# NOR = { has_modifier = "shroud_cooldown" has_modifier = "shroud_precog_cooldown" }
			NOT = { has_global_flag = ag_zeta_crisis_stage_3 }
		}
		text = "ag_zeta_psionics.1000.21.desc"
		text = "ag_zeta_psionics.1000.22.desc"
		text = "ag_zeta_psionics.1000.23.desc"
		text = "ag_zeta_psionics.1000.24.desc"
		text = "ag_zeta_psionics.1000.25.desc"
		text = "ag_zeta_psionics.1000.26.desc"
	}
	desc = {
		trigger = {
			# NOR = { has_modifier = "shroud_cooldown" has_modifier = "shroud_precog_cooldown" }
			has_global_flag = ag_zeta_crisis_ended
		}
		text = "ag_zeta_psionics.1000.27.desc"
		text = "ag_zeta_psionics.1000.28.desc"
		text = "ag_zeta_psionics.1000.29.desc"
		text = "ag_zeta_psionics.1000.30.desc"
		text = "ag_zeta_psionics.1000.31.desc"
		text = "ag_zeta_psionics.1000.32.desc"
	}
	diplomatic = yes
	diplomatic_title = BLANK_STRING
	force_open = yes
	picture_event_data = { portrait = shroud1 room = ag_excited_shroud_room }
	
	is_triggered_only = yes
	trigger = {
		from = { is_country_type = ag_dummy_shroud }
		NOT = { has_country_flag = shroud_diplomacy_engaged }
	}
	
	immediate = {
		set_country_flag = shroud_diplomacy_engaged
		if = { limit = { NOT = { is_variable_set = ag_enter_excited_shroud_cost_cooldown_multiplier } } set_variable = { which = ag_enter_excited_shroud_cost_cooldown_multiplier value = 1 } }
	}
	after = { hidden_effect = { remove_country_flag = shroud_diplomacy_engaged } }
	
	option = {
		name = "utopia.3000.a"
		# trigger = { hidden_trigger = { NOT = { has_modifier = "shroud_cooldown" } } }
		allow = {
			resource_stockpile_compare = { resource = energy value >= 1 mult = value:ag_enter_excited_shroud_cost }
			OR = {
				NOR = { has_modifier = "shroud_cooldown" has_modifier = "shroud_precog_cooldown" }
				resource_stockpile_compare = { resource = sr_zro value >= 1 mult = value:ag_enter_excited_shroud_cost|ag_multiplier|ag_enter_excited_shroud_cost_cooldown_multiplier| }
			}
		}
		add_resource = { energy = -1 mult = value:ag_enter_excited_shroud_cost }
		if = {
			limit = { OR = { has_modifier = "shroud_cooldown" has_modifier = "shroud_precog_cooldown" } }
			add_resource = { sr_zro = -1 mult = value:ag_enter_excited_shroud_cost|ag_multiplier|ag_enter_excited_shroud_cost_cooldown_multiplier| }
			hidden_effect = {
				if = { limit = { has_modifier = "shroud_cooldown" } remove_modifier = "shroud_cooldown" }
				if = { limit = { has_modifier = "shroud_precog_cooldown" } remove_modifier = "shroud_precog_cooldown" }
				change_variable = { which = ag_enter_excited_shroud_cost_cooldown_multiplier value = 0.25 }
			}
		}
		hidden_effect = {
			add_modifier = { modifier = "shroud_cooldown" days = 1800 time_multiplier = value:scripted_modifier_mult|MODIFIER|shroud_delve_cooldown| }
			if = {
				limit = { NAND = {
					OR = { has_technology = "tech_psi_jump_drive_1" has_tech_option = "tech_psi_jump_drive_1" }
					OR = { has_technology = "tech_psionic_shield" has_tech_option = "tech_psionic_shield" }
					OR = { has_technology = "tech_precognition_interface" has_tech_option = "tech_precognition_interface" }
				} }
				reroll_random = yes
				random_list = {
					10 = {
						modifier = { factor = 0 OR = { has_technology = "tech_psi_jump_drive_1" has_tech_option = "tech_psi_jump_drive_1" } }
						if = {
							limit = { NOR = { has_technology = "tech_psi_jump_drive_1" has_tech_option = "tech_psi_jump_drive_1" } }
							country_event = { id = ag_zeta_psionics.1040 }
						}
						else = { country_event = { id = ag_zeta_psionics.1001 } }	# Failsafe
					}
					10 = {
						modifier = { factor = 0 OR = { has_technology = "tech_psionic_shield" has_tech_option = "tech_psionic_shield" } }
						if = {
							limit = { NOR = { has_technology = "tech_psionic_shield" has_tech_option = "tech_psionic_shield" } }
							country_event = { id = ag_zeta_psionics.1043 }
						}
						else = { country_event = { id = ag_zeta_psionics.1001 } }	# Failsafe
					}
					10 = {
						modifier = { factor = 0 OR = { has_technology = "tech_precognition_interface" has_tech_option = "tech_precognition_interface" } }
						if = {
							limit = { NOR = { has_technology = "tech_precognition_interface" has_tech_option = "tech_precognition_interface" } }
							country_event = { id = ag_zeta_psionics.1046 }
						}
						else = { country_event = { id = ag_zeta_psionics.1001 } }	# Failsafe
					}
				}
			}
			else = {
				reroll_random = yes
				random_list = {
					50 = { country_event = { id = ag_zeta_psionics.1001 } }    # Common events.
					# The Chosen One
					10 = {
						if = {
							limit = { any_owned_leader = { NOT = { leader_class = envoy } ag_zeta_psionics_is_chosen_one = no } }
							country_event = { id = ag_zeta_psionics.1030 }
						}
						else = { country_event = { id = ag_zeta_psionics.1001 } }
					}
					# Shroud Covenant
					10 = {
						if = {
							limit = { NOT = { has_country_flag = has_shroud_patron } has_country_flag = offered_covenant }
							country_event = { id = ag_zeta_psionics.1051 }
						}
						else = { country_event = { id = ag_zeta_psionics.1001 } }
					}
					# Eerie Obelisk
					10 = {
						if = {
							limit = { NOR = { has_technology = "tech_ag_eerie_obelisk" has_tech_option = "tech_ag_eerie_obelisk" } }
							country_event = { id = ag_zeta_psionics.1060 }
						}
						else = { country_event = { id = ag_zeta_psionics.1001 } }
					}
					# Psionic Power Core
					10 = {
						if = {
							limit = { NOR = { has_technology = "tech_ag_shroud_power_core" has_tech_option = "tech_ag_shroud_power_core" } }
							country_event = { id = ag_zeta_psionics.1070 }
						}
						else = { country_event = { id = ag_zeta_psionics.1001 } }
					}
					# Psionic Weapon Booster
					10 = {
						if = {
							limit = { NOR = { has_technology = "tech_ag_shroud_weapon_buff" has_tech_option = "tech_ag_shroud_weapon_buff" } }
							country_event = { id = ag_zeta_psionics.1073 }
						}
						else = { country_event = { id = ag_zeta_psionics.1001 } }
					}
					# Psionic Ships
					10 = {
						if = {
							limit = {
								exists = event_target:ag_psionic_conduit_megastructure
								event_target:ag_psionic_conduit_megastructure = { exists = owner }
								is_same_value = event_target:ag_psionic_conduit_megastructure.owner
								event_target:ag_psionic_conduit_megastructure = { check_variable = { which = ag_alpha_psionic_conduit_stability value >= 75 } }
								NOR = { has_technology = "tech_ag_ancient_psionic_ship" has_tech_option = "tech_ag_ancient_psionic_ship" }
							}
							country_event = { id = ag_zeta_psionics.1080 }
						}
						else = { country_event = { id = ag_zeta_psionics.1001 } }
					}
					# Psionic Weapons
					10 = {
						if = {
							limit = {
								exists = event_target:ag_psionic_conduit_megastructure
								event_target:ag_psionic_conduit_megastructure = { exists = owner }
								is_same_value = event_target:ag_psionic_conduit_megastructure.owner
								event_target:ag_psionic_conduit_megastructure = { check_variable = { which = ag_alpha_psionic_conduit_stability value >= 50 } }
								has_technology = "tech_extradimensional_weapon_1"
								NOR = { has_technology = "tech_ag_ancient_extradimensional_weapon" has_tech_option = "tech_ag_ancient_extradimensional_weapon" }
							}
							country_event = { id = ag_zeta_psionics.1083 }
						}
						else = { country_event = { id = ag_zeta_psionics.1001 } }
					}
				}
			}
		}
	}
	option = { #Try to contact a specific patron
		name = "utopia.3000.b"
		trigger = { hidden_trigger = { NOR = { has_modifier = "shroud_cooldown" has_modifier = "shroud_precog_cooldown" has_country_flag = has_shroud_patron } } }
		allow = {
			resource_stockpile_compare = { resource = energy value >= 1 mult = value:ag_enter_excited_shroud_cost|ag_multiplier|2| }
			resource_stockpile_compare = { resource = sr_zro value >= 1 mult = value:ag_enter_excited_shroud_cost|ag_multiplier|0.5| }
		}
		add_resource = { energy = -1 mult = value:ag_enter_excited_shroud_cost|ag_multiplier|2| }
		add_resource = { sr_zro = -1 mult = value:ag_enter_excited_shroud_cost|ag_multiplier|0.5| }
		hidden_effect = {
			country_event = { id = ag_zeta_psionics.1050 }
			add_modifier = { modifier = "shroud_cooldown" days = 2160 time_multiplier = value:scripted_modifier_mult|MODIFIER|shroud_delve_cooldown| }
		}
	}
	option = {
		name = "exit.shroud"
		custom_tooltip = "exit.shroud.tooltip"
		default_hide_option = yes
	}
}

country_event = {
	id = ag_zeta_psionics.1001
	title = "ag_zeta_psionics.1000.name"
	desc = {
		trigger = { always = yes }
		text = "utopia.3200.1.desc"
		text = "utopia.3200.2.desc"
		text = "utopia.3200.3.desc"
		text = "utopia.3200.4.desc"
		text = "utopia.3200.5.desc"
		text = "utopia.3200.6.desc"
		text = "utopia.3200.7.desc"
		text = "utopia.3200.8.desc"
		text = "utopia.3200.9.desc"
	}
	diplomatic = yes
	diplomatic_title = BLANK_STRING
	force_open = yes
	picture_event_data = { portrait = shroud1 room = ag_excited_shroud_room }
	is_triggered_only = yes
	
	immediate = {
		set_country_flag = shroud_diplomacy_engaged
		randomize_shroud_flags = yes
	}
	after = { hidden_effect = {
		remove_country_flag = shroud_diplomacy_engaged
		remove_shroud_flags = yes
	} }
	
	### High
	option = {
		name = "boon.happiness.high"
		trigger = { has_country_flag = high.1 }
		custom_tooltip = "shroud.boon.chances.high"
		ag_shroud_happiness_shroud_high = yes
	}
	option = {
		name = "boon.upkeep.high"
		trigger = { has_country_flag = high.2 }
		custom_tooltip = "shroud.boon.chances.high"
		ag_shroud_upkeep_shroud_high = yes
	}
	option = {
		name = "boon.research.high"
		trigger = { has_country_flag = high.3 }
		custom_tooltip = "shroud.boon.chances.high"
		ag_shroud_research_shroud_high = yes
	}
	option = {
		name = "boon.shields.high"
		trigger = { has_country_flag = high.4 }
		custom_tooltip = "shroud.boon.chances.high"
		ag_shroud_shields_shroud_high = yes
	}
	option = {
		name = "boon.weapons.high"
		trigger = { has_country_flag = high.5 }
		custom_tooltip = "shroud.boon.chances.high"
		ag_shroud_weapons_shroud_high = yes
	}
	option = {
		name = "boon.firing.high"
		trigger = { has_country_flag = high.6 }
		custom_tooltip = "shroud.boon.chances.high"
		ag_shroud_firingrate_shroud_high = yes
	}
	option = {
		name = "boon.ethics.high"
		trigger = { has_country_flag = high.7 }
		custom_tooltip = "shroud.boon.chances.high"
		ag_shroud_ethics_shroud_high = yes
	}
	option = {
		name = "boon.influence.high"
		trigger = { has_country_flag = high.8 }
		custom_tooltip = "shroud.boon.chances.high"
		ag_shroud_influence_shroud_high = yes
	}
	option = {
		name = "boon.unity.high"
		trigger = { has_country_flag = high.9 }
		custom_tooltip = "shroud.boon.chances.high"
		ag_shroud_unity_shroud_high = yes
	}
	option = {
		name = "boon.evasion.high"
		trigger = { has_country_flag = high.10 }
		custom_tooltip = "shroud.boon.chances.high"
		ag_shroud_evasion_shroud_high = yes
	}
	option = {
		name = "boon.repair.high"
		trigger = { has_country_flag = high.11 }
		custom_tooltip = "shroud.boon.chances.high"
		ag_shroud_repair_shroud_high = yes
	}
	option = {
		name = "boon.lifespans.high"
		trigger = { has_country_flag = high.12 }
		custom_tooltip = "shroud.boon.chances.high"
		ag_shroud_lifespan_shroud_high = yes
	}
	option = {
		name = "boon.speed.high"
		trigger = { has_country_flag = high.13 }
		custom_tooltip = "shroud.boon.chances.high"
		ag_shroud_speed_shroud_high = yes
	}
	option = {
		name = "boon.morale.high"
		trigger = { has_country_flag = high.14 }
		custom_tooltip = "shroud.boon.chances.high"
		ag_shroud_morale_shroud_high = yes
	}
	option = {
		name = "boon.sensors.high"
		trigger = { has_country_flag = high.15 }
		custom_tooltip = "shroud.boon.chances.high"
		ag_shroud_sensor_shroud_high = yes
	}
	option = {
		name = "shroud.avatar.high"
		trigger = { has_country_flag = high.16 }
		custom_tooltip = "shroud.boon.chances.high"
		ag_shroud_avatar_shroud_high = yes
	}
	
	### Medium
	option = {
		name = "boon.happiness.medium"
		trigger = { has_country_flag = medium.1 }
		custom_tooltip = "shroud.boon.chances.medium"
		ag_shroud_happiness_shroud_medium = yes
	}
	option = {
		name = "boon.upkeep.medium"
		trigger = { has_country_flag = medium.2 }
		custom_tooltip = "shroud.boon.chances.medium"
		ag_shroud_upkeep_shroud_medium = yes
	}
	option = {
		name = "boon.research.medium"
		trigger = { has_country_flag = medium.3 }
		custom_tooltip = "shroud.boon.chances.medium"
		ag_shroud_research_shroud_medium = yes
	}
	option = {
		name = "boon.shields.medium"
		trigger = { has_country_flag = medium.4 }
		custom_tooltip = "shroud.boon.chances.medium"
		ag_shroud_shields_shroud_medium = yes
	}
	option = {
		name = "boon.weapons.medium"
		trigger = { has_country_flag = medium.5 }
		custom_tooltip = "shroud.boon.chances.medium"
		ag_shroud_weapons_shroud_medium = yes
	}
	option = {
		name = "boon.firing.medium"
		trigger = { has_country_flag = medium.6 }
		custom_tooltip = "shroud.boon.chances.medium"
		ag_shroud_firingrate_shroud_medium = yes
	}
	option = {
		name = "boon.ethics.medium"
		trigger = { has_country_flag = medium.7 }
		custom_tooltip = "shroud.boon.chances.medium"
		ag_shroud_ethics_shroud_medium = yes
	}
	option = {
		name = "boon.influence.medium"
		trigger = { has_country_flag = medium.8 }
		custom_tooltip = "shroud.boon.chances.medium"
		ag_shroud_influence_shroud_medium = yes
	}
	option = {
		name = "boon.unity.medium"
		trigger = { has_country_flag = medium.9 }
		custom_tooltip = "shroud.boon.chances.medium"
		ag_shroud_unity_shroud_medium = yes
	}
	option = {
		name = "boon.evasion.medium"
		trigger = { has_country_flag = medium.10 }
		custom_tooltip = "shroud.boon.chances.medium"
		ag_shroud_evasion_shroud_medium = yes
	}
	option = {
		name = "boon.repair.medium"
		trigger = { has_country_flag = medium.11 }
		custom_tooltip = "shroud.boon.chances.medium"
		ag_shroud_repair_shroud_medium = yes
	}
	option = {
		name = "boon.lifespans.medium"
		trigger = { has_country_flag = medium.12 }
		custom_tooltip = "shroud.boon.chances.medium"
		ag_shroud_lifespan_shroud_medium = yes
	}
	option = {
		name = "boon.speed.medium"
		trigger = { has_country_flag = medium.13 }
		custom_tooltip = "shroud.boon.chances.medium"
		ag_shroud_speed_shroud_medium = yes
	}
	option = {
		name = "boon.morale.medium"
		trigger = { has_country_flag = medium.14 }
		custom_tooltip = "shroud.boon.chances.medium"
		ag_shroud_morale_shroud_medium = yes
	}
	option = {
		name = "boon.sensors.medium"
		trigger = { has_country_flag = medium.15 }
		custom_tooltip = "shroud.boon.chances.medium"
		ag_shroud_sensor_shroud_medium = yes
	}
	option = {
		name = "shroud.avatar.medium"
		trigger = { has_country_flag = medium.16 }
		custom_tooltip = "shroud.boon.chances.medium"
		ag_shroud_avatar_shroud_medium = yes
	}
	
	### Low
	option = {
		name = "boon.happiness.low"
		trigger = { has_country_flag = low.1 }
		custom_tooltip = "shroud.boon.chances.low"
		ag_shroud_happiness_shroud_low = yes
	}
	option = {
		name = "boon.upkeep.low"
		trigger = { has_country_flag = low.2 }
		custom_tooltip = "shroud.boon.chances.low"
		ag_shroud_upkeep_shroud_low = yes
	}
	option = {
		name = "boon.research.low"
		trigger = { has_country_flag = low.3 }
		custom_tooltip = "shroud.boon.chances.low"
		ag_shroud_research_shroud_low = yes
	}
	option = {
		name = "boon.shields.low"
		trigger = { has_country_flag = low.4 }
		custom_tooltip = "shroud.boon.chances.low"
		ag_shroud_shields_shroud_low = yes
	}
	option = {
		name = "boon.weapons.low"
		trigger = { has_country_flag = low.5 }
		custom_tooltip = "shroud.boon.chances.low"
		ag_shroud_weapons_shroud_low = yes
	}
	option = {
		name = "boon.firing.low"
		trigger = { has_country_flag = low.6 }
		custom_tooltip = "shroud.boon.chances.low"
		ag_shroud_firingrate_shroud_low = yes
	}
	option = {
		name = "boon.ethics.low"
		trigger = { has_country_flag = low.7 }
		custom_tooltip = "shroud.boon.chances.low"
		ag_shroud_ethics_shroud_low = yes
	}
	option = {
		name = "boon.influence.low"
		trigger = { has_country_flag = low.8 }
		custom_tooltip = "shroud.boon.chances.low"
		ag_shroud_influence_shroud_low = yes
	}
	option = {
		name = "boon.unity.low"
		trigger = { has_country_flag = low.9 }
		custom_tooltip = "shroud.boon.chances.low"
		ag_shroud_unity_shroud_low = yes
	}
	option = {
		name = "boon.evasion.low"
		trigger = { has_country_flag = low.10 }
		custom_tooltip = "shroud.boon.chances.low"
		ag_shroud_evasion_shroud_low = yes
	}
	option = {
		name = "boon.repair.low"
		trigger = { has_country_flag = low.11 }
		custom_tooltip = "shroud.boon.chances.low"
		ag_shroud_repair_shroud_low = yes
	}
	option = {
		name = "boon.lifespans.low"
		trigger = { has_country_flag = low.12 }
		custom_tooltip = "shroud.boon.chances.low"
		ag_shroud_lifespan_shroud_low = yes
	}
	option = {
		name = "boon.speed.low"
		trigger = { has_country_flag = low.13 }
		custom_tooltip = "shroud.boon.chances.low"
		ag_shroud_speed_shroud_low = yes
	}
	option = {
		name = "boon.morale.low"
		trigger = { has_country_flag = low.14 }
		custom_tooltip = "shroud.boon.chances.low"
		ag_shroud_morale_shroud_low = yes
	}
	option = {
		name = "boon.sensors.low"
		trigger = { has_country_flag = low.15 }
		custom_tooltip = "shroud.boon.chances.low"
		ag_shroud_sensor_shroud_low = yes
	}
	option = {
		name = "shroud.avatar.low"
		trigger = { has_country_flag = low.16 }
		custom_tooltip = "shroud.boon.chances.low"
		ag_shroud_avatar_shroud_low = yes
	}
	
	option = {
		name = "exit.shroud"
		custom_tooltip = "exit.shroud.tooltip"
		default_hide_option = yes
	}
}

# No Effect (FAILURE)
country_event = {
	id = ag_zeta_psionics.1002
	title = "ag_zeta_psionics.1000.name"
	desc = {
		trigger = { always = yes }
		text = "utopia.3045.1.desc"
		text = "utopia.3045.2.desc"
		text = "utopia.3045.3.desc"
	}
	diplomatic = yes
	diplomatic_title = BLANK_STRING
	force_open = yes
	picture_event_data = { portrait = shroud1 room = ag_excited_shroud_room }
	is_triggered_only = yes
	immediate = { set_country_flag = shroud_diplomacy_engaged }
	after = { hidden_effect = {
		remove_country_flag = shroud_diplomacy_engaged
		set_timed_country_flag = { flag = negative_shroud_outcome days = 1800 }
	} }
	option = {
		name = "exit.shroud"
		custom_tooltip = "exit.shroud.tooltip"
		default_hide_option = yes
	}
}

# Happiness (SUCCESS)
country_event = {
	id = ag_zeta_psionics.1003
	title = "boon.bestowed"
	desc = "utopia.3030.desc"
	diplomatic = yes
	diplomatic_title = BLANK_STRING
	force_open = yes
	picture_event_data = { portrait = shroud1 room = ag_excited_shroud_room }
	is_triggered_only = yes
	immediate = { set_country_flag = shroud_diplomacy_engaged }
	after = { hidden_effect = {
		remove_country_flag = shroud_diplomacy_engaged
		set_timed_country_flag = { flag = positive_shroud_outcome days = 1800 }
	} }
	option = {
		name = "exit.shroud"
		ag_add_shroud_positive_modifier = { ag_modifier = "shroud_happiness" }
		default_hide_option = yes
	}
}
# Ship Upkeep (SUCCESS)
country_event = {
	id = ag_zeta_psionics.1004
	title = "boon.bestowed"
	desc = "utopia.3031.desc"
	diplomatic = yes
	diplomatic_title = BLANK_STRING
	force_open = yes
	picture_event_data = { portrait = shroud1 room = ag_excited_shroud_room }
	is_triggered_only = yes
	immediate = { set_country_flag = shroud_diplomacy_engaged }
	after = { hidden_effect = {
		remove_country_flag = shroud_diplomacy_engaged
		set_timed_country_flag = { flag = positive_shroud_outcome days = 1800 }
	} }
	option = {
		name = "exit.shroud"
		ag_add_shroud_positive_modifier = { ag_modifier = "shroud_ship_upkeep" }
		default_hide_option = yes
	}
}
# Research Speed (SUCCESS)
country_event = {
	id = ag_zeta_psionics.1005
	title = "boon.bestowed"
	desc = "utopia.3032.desc"
	diplomatic = yes
	diplomatic_title = BLANK_STRING
	force_open = yes
	picture_event_data = { portrait = shroud1 room = ag_excited_shroud_room }
	is_triggered_only = yes
	immediate = { set_country_flag = shroud_diplomacy_engaged }
	after = { hidden_effect = {
		remove_country_flag = shroud_diplomacy_engaged
		set_timed_country_flag = { flag = positive_shroud_outcome days = 1800 }
	} }
	option = {
		name = "exit.shroud"
		ag_add_shroud_positive_modifier = { ag_modifier = "shroud_research_speed" }
		default_hide_option = yes
	}
}
# Shield Boost (SUCCESS)
country_event = {
	id = ag_zeta_psionics.1006
	title = "boon.bestowed"
	desc = "utopia.3033.desc"
	diplomatic = yes
	diplomatic_title = BLANK_STRING
	force_open = yes
	picture_event_data = { portrait = shroud1 room = ag_excited_shroud_room }
	is_triggered_only = yes
	immediate = { set_country_flag = shroud_diplomacy_engaged }
	after = { hidden_effect = {
		remove_country_flag = shroud_diplomacy_engaged
		set_timed_country_flag = { flag = positive_shroud_outcome days = 1800 }
	} }
	option = {
		name = "exit.shroud"
		ag_add_shroud_positive_modifier = { ag_modifier = "shroud_shield_boost" }
		default_hide_option = yes
	}
}
# Weapon Boost (SUCCESS)
country_event = {
	id = ag_zeta_psionics.1007
	title = "boon.bestowed"
	desc = "utopia.3034.desc"
	diplomatic = yes
	diplomatic_title = BLANK_STRING
	force_open = yes
	picture_event_data = { portrait = shroud1 room = ag_excited_shroud_room }
	is_triggered_only = yes
	immediate = { set_country_flag = shroud_diplomacy_engaged }
	after = { hidden_effect = {
		remove_country_flag = shroud_diplomacy_engaged
		set_timed_country_flag = { flag = positive_shroud_outcome days = 1800 }
	} }
	option = {
		name = "exit.shroud"
		ag_add_shroud_positive_modifier = { ag_modifier = "shroud_weapon_boost" }
		default_hide_option = yes
	}
}
# Firing Rate (SUCCESS)
country_event = {
	id = ag_zeta_psionics.1008
	title = "boon.bestowed"
	desc = "utopia.3035.desc"
	diplomatic = yes
	diplomatic_title = BLANK_STRING
	force_open = yes
	picture_event_data = { portrait = shroud1 room = ag_excited_shroud_room }
	is_triggered_only = yes
	immediate = { set_country_flag = shroud_diplomacy_engaged }
	after = { hidden_effect = {
		remove_country_flag = shroud_diplomacy_engaged
		set_timed_country_flag = { flag = positive_shroud_outcome days = 1800 }
	} }
	option = {
		name = "exit.shroud"
		ag_add_shroud_positive_modifier = { ag_modifier = "shroud_firing_rate" }
		default_hide_option = yes
	}
}
# Ethic Boost (SUCCESS)
country_event = {
	id = ag_zeta_psionics.1009
	title = "boon.bestowed"
	desc = "utopia.3036.desc"
	diplomatic = yes
	diplomatic_title = BLANK_STRING
	force_open = yes
	picture_event_data = { portrait = shroud1 room = ag_excited_shroud_room }
	is_triggered_only = yes
	immediate = { set_country_flag = shroud_diplomacy_engaged }
	after = { hidden_effect = {
		remove_country_flag = shroud_diplomacy_engaged
		set_timed_country_flag = { flag = positive_shroud_outcome days = 1800 }
	} }
	option = {
		name = "exit.shroud"
		ag_add_shroud_positive_modifier = { ag_modifier = "shroud_ethic_boost" }
		default_hide_option = yes
	}
}
# Influence Boost (SUCCESS)
country_event = {
	id = ag_zeta_psionics.1010
	title = "boon.bestowed"
	desc = "utopia.3037.desc"
	diplomatic = yes
	diplomatic_title = BLANK_STRING
	force_open = yes
	picture_event_data = { portrait = shroud1 room = ag_excited_shroud_room }
	is_triggered_only = yes
	immediate = { set_country_flag = shroud_diplomacy_engaged }
	after = { hidden_effect = {
		remove_country_flag = shroud_diplomacy_engaged
		set_timed_country_flag = { flag = positive_shroud_outcome days = 1800 }
	} }
	option = {
		name = "exit.shroud"
		ag_add_shroud_positive_modifier = { ag_modifier = "shroud_influence_boost" }
		default_hide_option = yes
	}
}
# Unity Boost (SUCCESS)
country_event = {
	id = ag_zeta_psionics.1011
	title = "boon.bestowed"
	desc = "utopia.3038.desc"
	diplomatic = yes
	diplomatic_title = BLANK_STRING
	force_open = yes
	picture_event_data = { portrait = shroud1 room = ag_excited_shroud_room }
	is_triggered_only = yes
	immediate = { set_country_flag = shroud_diplomacy_engaged }
	after = { hidden_effect = {
		remove_country_flag = shroud_diplomacy_engaged
		set_timed_country_flag = { flag = positive_shroud_outcome days = 1800 }
	} }
	option = {
		name = "exit.shroud"
		ag_add_shroud_positive_modifier = { ag_modifier = "shroud_unity_boost" }
		default_hide_option = yes
	}
}
# Evasion (SUCCESS)
country_event = {
	id = ag_zeta_psionics.1012
	title = "boon.bestowed"
	desc = "utopia.3039.desc"
	diplomatic = yes
	diplomatic_title = BLANK_STRING
	force_open = yes
	picture_event_data = { portrait = shroud1 room = ag_excited_shroud_room }
	is_triggered_only = yes
	immediate = { set_country_flag = shroud_diplomacy_engaged }
	after = { hidden_effect = {
		remove_country_flag = shroud_diplomacy_engaged
		set_timed_country_flag = { flag = positive_shroud_outcome days = 1800 }
	} }
	option = {
		name = "exit.shroud"
		ag_add_shroud_positive_modifier = { ag_modifier = "shroud_evasion" }
		default_hide_option = yes
	}
}
# Ship Repair (SUCCESS)
country_event = {
	id = ag_zeta_psionics.1013
	title = "boon.bestowed"
	desc = "utopia.3040.desc"
	diplomatic = yes
	diplomatic_title = BLANK_STRING
	force_open = yes
	picture_event_data = { portrait = shroud1 room = ag_excited_shroud_room }
	is_triggered_only = yes
	immediate = { set_country_flag = shroud_diplomacy_engaged }
	after = { hidden_effect = {
		remove_country_flag = shroud_diplomacy_engaged
		set_timed_country_flag = { flag = positive_shroud_outcome days = 1800 }
	} }
	option = {
		name = "exit.shroud"
		ag_add_shroud_positive_modifier = { ag_modifier = "shroud_repair" }
		default_hide_option = yes
	}
}
# Lifespan (SUCCESS)
country_event = {
	id = ag_zeta_psionics.1014
	title = "boon.bestowed"
	desc = "utopia.3041.desc"
	diplomatic = yes
	diplomatic_title = BLANK_STRING
	force_open = yes
	picture_event_data = { portrait = shroud1 room = ag_excited_shroud_room }
	is_triggered_only = yes
	immediate = { set_country_flag = shroud_diplomacy_engaged }
	after = { hidden_effect = {
		remove_country_flag = shroud_diplomacy_engaged
		set_timed_country_flag = { flag = positive_shroud_outcome days = 1800 }
	} }
	option = {
		name = "exit.shroud"
		custom_tooltip = utopia.3041.tooltip
		hidden_effect = { every_owned_leader = {
			limit = { species = { has_trait = trait_psioni } NOR = { has_trait = leader_trait_shroud_age } }
			add_trait = leader_trait_shroud_age
		} }
		default_hide_option = yes
	}
}
# Ship Speed (SUCCESS)
country_event = {
	id = ag_zeta_psionics.1015
	title = "boon.bestowed"
	desc = "utopia.3042.desc"
	diplomatic = yes
	diplomatic_title = BLANK_STRING
	force_open = yes
	picture_event_data = { portrait = shroud1 room = ag_excited_shroud_room }
	is_triggered_only = yes
	immediate = { set_country_flag = shroud_diplomacy_engaged }
	after = { hidden_effect = {
		remove_country_flag = shroud_diplomacy_engaged
		set_timed_country_flag = { flag = positive_shroud_outcome days = 1800 }
	} }
	option = {
		name = "exit.shroud"
		ag_add_shroud_positive_modifier = { ag_modifier = "shroud_speed" }
		default_hide_option = yes
	}
}
# Army Morale (SUCCESS)
country_event = {
	id = ag_zeta_psionics.1016
	title = "boon.bestowed"
	desc = "utopia.3043.desc"
	diplomatic = yes
	diplomatic_title = BLANK_STRING
	force_open = yes
	picture_event_data = { portrait = shroud1 room = ag_excited_shroud_room }
	is_triggered_only = yes
	immediate = { set_country_flag = shroud_diplomacy_engaged }
	after = { hidden_effect = {
		remove_country_flag = shroud_diplomacy_engaged
		set_timed_country_flag = { flag = positive_shroud_outcome days = 1800 }
	} }
	option = {
		name = "exit.shroud"
		ag_add_shroud_positive_modifier = { ag_modifier = "shroud_morale" }
		default_hide_option = yes
	}
}
# Sensor Range (SUCCESS)
country_event = {
	id = ag_zeta_psionics.1017
	title = "boon.bestowed"
	desc = "utopia.3044.desc"
	diplomatic = yes
	diplomatic_title = BLANK_STRING
	force_open = yes
	picture_event_data = { portrait = shroud1 room = ag_excited_shroud_room }
	is_triggered_only = yes
	immediate = { set_country_flag = shroud_diplomacy_engaged }
	after = { hidden_effect = {
		remove_country_flag = shroud_diplomacy_engaged
		set_timed_country_flag = { flag = positive_shroud_outcome days = 1800 }
	} }
	option = {
		name = "exit.shroud"
		ag_add_shroud_positive_modifier = { ag_modifier = "shroud_sensors" }
		default_hide_option = yes
	}
}

# Negative Happiness (CRITICAL FAILURE)
country_event = {
	id = ag_zeta_psionics.1018
	title = "curse.bestowed"
	desc = "utopia.3050.desc"
	diplomatic = yes
	diplomatic_title = BLANK_STRING
	force_open = yes
	picture_event_data = { portrait = shroud1 room = ag_excited_shroud_room }
	is_triggered_only = yes
	immediate = { set_country_flag = shroud_diplomacy_engaged }
	after = { hidden_effect = {
		remove_country_flag = shroud_diplomacy_engaged
		set_timed_country_flag = { flag = negative_shroud_outcome days = 1800 }
	} }
	option = {
		name = "exit.shroud"
		ag_add_shroud_negative_modifier = { ag_modifier = "shroud_neg_happiness" }
		default_hide_option = yes
	}
}
# Negative Ethics Attraction (CRITICAL FAILURE)
country_event = {
	id = ag_zeta_psionics.1019
	title = "curse.bestowed"
	desc = "utopia.3051.desc"
	diplomatic = yes
	diplomatic_title = BLANK_STRING
	force_open = yes
	picture_event_data = { portrait = shroud1 room = ag_excited_shroud_room }
	is_triggered_only = yes
	immediate = { set_country_flag = shroud_diplomacy_engaged }
	after = { hidden_effect = {
		remove_country_flag = shroud_diplomacy_engaged
		set_timed_country_flag = { flag = negative_shroud_outcome days = 1800 }
	} }
	option = {
		name = "exit.shroud"
		ag_add_shroud_negative_modifier = { ag_modifier = "shroud_neg_ethic" }
		default_hide_option = yes
	}
}
# Negative Ship Armor (CRITICAL FAILURE)
country_event = {
	id = ag_zeta_psionics.1020
	title = "curse.bestowed"
	desc = "utopia.3052.desc"
	diplomatic = yes
	diplomatic_title = BLANK_STRING
	force_open = yes
	picture_event_data = { portrait = shroud1 room = ag_excited_shroud_room }
	is_triggered_only = yes
	immediate = { set_country_flag = shroud_diplomacy_engaged }
	after = { hidden_effect = {
		remove_country_flag = shroud_diplomacy_engaged
		set_timed_country_flag = { flag = negative_shroud_outcome days = 1800 }
	} }
	option = {
		name = "exit.shroud"
		ag_add_shroud_negative_modifier = { ag_modifier = "shroud_neg_armor" }
		default_hide_option = yes
	}
}
# Negative Population Growth (CRITICAL FAILURE)
country_event = {
	id = ag_zeta_psionics.1021
	title = "curse.bestowed"
	desc = "utopia.3053.desc"
	diplomatic = yes
	diplomatic_title = BLANK_STRING
	force_open = yes
	picture_event_data = { portrait = shroud1 room = ag_excited_shroud_room }
	is_triggered_only = yes
	immediate = { set_country_flag = shroud_diplomacy_engaged }
	after = { hidden_effect = {
		remove_country_flag = shroud_diplomacy_engaged
		set_timed_country_flag = { flag = negative_shroud_outcome days = 1800 }
	} }
	option = {
		name = "exit.shroud"
		ag_add_shroud_negative_modifier = { ag_modifier = "shroud_neg_growth" }
		default_hide_option = yes
	}
}
# Negative Research (CRITICAL FAILURE)
country_event = {
	id = ag_zeta_psionics.1022
	title = "curse.bestowed"
	desc = "utopia.3054.desc"
	diplomatic = yes
	diplomatic_title = BLANK_STRING
	force_open = yes
	picture_event_data = { portrait = shroud1 room = ag_excited_shroud_room }
	is_triggered_only = yes
	immediate = { set_country_flag = shroud_diplomacy_engaged }
	after = { hidden_effect = {
		remove_country_flag = shroud_diplomacy_engaged
		set_timed_country_flag = { flag = negative_shroud_outcome days = 1800 }
	} }
	option = {
		name = "exit.shroud"
		ag_add_shroud_negative_modifier = { ag_modifier = "shroud_neg_research" }
		default_hide_option = yes
	}
}
# Negative Influence (CRITICAL FAILURE)
country_event = {
	id = ag_zeta_psionics.1023
	title = "curse.bestowed"
	desc = "utopia.3055.desc"
	diplomatic = yes
	diplomatic_title = BLANK_STRING
	force_open = yes
	picture_event_data = { portrait = shroud1 room = ag_excited_shroud_room }
	is_triggered_only = yes
	immediate = { set_country_flag = shroud_diplomacy_engaged }
	after = { hidden_effect = {
		remove_country_flag = shroud_diplomacy_engaged
		set_timed_country_flag = { flag = negative_shroud_outcome days = 1800 }
	} }
	option = {
		name = "exit.shroud"
		ag_add_shroud_negative_modifier = { ag_modifier = "shroud_neg_influence" }
		default_hide_option = yes
	}
}
# Negative Unity (CRITICAL FAILURE)
country_event = {
	id = ag_zeta_psionics.1024
	title = "curse.bestowed"
	desc = "utopia.3056.desc"
	diplomatic = yes
	diplomatic_title = BLANK_STRING
	force_open = yes
	picture_event_data = { portrait = shroud1 room = ag_excited_shroud_room }
	is_triggered_only = yes
	immediate = { set_country_flag = shroud_diplomacy_engaged }
	after = { hidden_effect = {
		remove_country_flag = shroud_diplomacy_engaged
		set_timed_country_flag = { flag = negative_shroud_outcome days = 1800 }
	} }
	option = {
		name = "exit.shroud"
		ag_add_shroud_negative_modifier = { ag_modifier = "shroud_neg_unity" }
		default_hide_option = yes
	}
}
# Negative Ship Speed (CRITICAL FAILURE)
country_event = {
	id = ag_zeta_psionics.1025
	title = "curse.bestowed"
	desc = "utopia.3057.desc"
	diplomatic = yes
	diplomatic_title = BLANK_STRING
	force_open = yes
	picture_event_data = { portrait = shroud1 room = ag_excited_shroud_room }
	is_triggered_only = yes
	immediate = { set_country_flag = shroud_diplomacy_engaged }
	after = { hidden_effect = {
		remove_country_flag = shroud_diplomacy_engaged
		set_timed_country_flag = { flag = negative_shroud_outcome days = 1800 }
	} }
	option = {
		name = "exit.shroud"
		ag_add_shroud_negative_modifier = { ag_modifier = "shroud_neg_speed" }
		default_hide_option = yes
	}
}
# Negative Army Morale (CRITICAL FAILURE)
country_event = {
	id = ag_zeta_psionics.1026
	title = "curse.bestowed"
	desc = "utopia.3058.desc"
	diplomatic = yes
	diplomatic_title = BLANK_STRING
	force_open = yes
	picture_event_data = { portrait = shroud1 room = ag_excited_shroud_room }
	is_triggered_only = yes
	immediate = { set_country_flag = shroud_diplomacy_engaged }
	after = { hidden_effect = {
		remove_country_flag = shroud_diplomacy_engaged
		set_timed_country_flag = { flag = negative_shroud_outcome days = 1800 }
	} }
	option = {
		name = "exit.shroud"
		ag_add_shroud_negative_modifier = { ag_modifier = "shroud_neg_morale" }
		default_hide_option = yes
	}
}
# Negative Sensor Range (CRITICAL FAILURE)
country_event = {
	id = ag_zeta_psionics.1027
	title = "curse.bestowed"
	desc = "utopia.3059.desc"
	diplomatic = yes
	diplomatic_title = BLANK_STRING
	force_open = yes
	picture_event_data = { portrait = shroud1 room = ag_excited_shroud_room }
	is_triggered_only = yes
	immediate = { set_country_flag = shroud_diplomacy_engaged }
	after = { hidden_effect = {
		remove_country_flag = shroud_diplomacy_engaged
		set_timed_country_flag = { flag = negative_shroud_outcome days = 1800 }
	} }
	option = {
		name = "exit.shroud"
		ag_add_shroud_negative_modifier = { ag_modifier = "shroud_neg_sensors" }
		default_hide_option = yes
	}
}

country_event = {
	id = ag_zeta_psionics.1030
	title = "ag_zeta_psionics.1000.name"
	desc = {
		trigger = { NOT = { any_owned_leader = { ag_zeta_psionics_is_chosen_one = yes } } }
		text = "utopia.3190.desc"
	}
	desc = {
		trigger = { any_owned_leader = { ag_zeta_psionics_is_chosen_one = yes } }
		text = "ag_zeta_psionics.1030.desc"
	}
	diplomatic = yes
	diplomatic_title = BLANK_STRING
	force_open = yes
	picture_event_data = { portrait = shroud1 room = ag_excited_shroud_room }
	is_triggered_only = yes
	immediate = {
		set_country_flag = shroud_diplomacy_engaged
		if = {
			limit = { any_owned_leader = { leader_class = ruler ag_zeta_psionics_is_chosen_one = no } }
			random_owned_leader = {
				limit = { leader_class = ruler ag_zeta_psionics_is_chosen_one = no }
				save_event_target_as = leader_1
				random_list = { 33 = { set_leader_flag = high_psi } 33 = { set_leader_flag = medium_psi } 33 = { set_leader_flag = low_psi } }
			}
		}
		else_if = {
			limit = { ruler = { ag_zeta_psionics_is_chosen_one = no } }
			random_owned_leader = {
				limit = { is_same_value = root.ruler }
				save_event_target_as = leader_1
				random_list = { 33 = { set_leader_flag = high_psi } 33 = { set_leader_flag = medium_psi } 33 = { set_leader_flag = low_psi } }
			}
		}
		else_if = {
			limit = { always = yes }
			random_owned_leader = {
				limit = { NOT = { leader_class = envoy } ag_zeta_psionics_is_chosen_one = no }
				save_event_target_as = leader_1
				random_list = { 33 = { set_leader_flag = high_psi } 33 = { set_leader_flag = medium_psi } 33 = { set_leader_flag = low_psi } }
			}
		}
		random_owned_leader = {
			limit = { NOT = { leader_class = envoy } NAND = { exists = event_target:leader_1 is_same_value = event_target:leader_1 } ag_zeta_psionics_is_chosen_one = no }
			save_event_target_as = leader_2
			random_list = { 33 = { set_leader_flag = high_psi } 33 = { set_leader_flag = medium_psi } 33 = { set_leader_flag = low_psi } }
		}
		random_owned_leader = {
			limit = { NOT = { leader_class = envoy } NOR = { exists = event_target:leader_1 is_same_value = event_target:leader_1 exists = event_target:leader_2 is_same_value = event_target:leader_2 } ag_zeta_psionics_is_chosen_one = no }
			save_event_target_as = leader_3
			random_list = { 33 = { set_leader_flag = high_psi } 33 = { set_leader_flag = medium_psi } 33 = { set_leader_flag = low_psi } }
		}
	}
	after = { hidden_effect = {
		remove_country_flag = shroud_diplomacy_engaged
		event_target:leader_1 = { remove_leader_flag = high_psi remove_leader_flag = medium_psi remove_leader_flag = low_psi }
		event_target:leader_2 = { remove_leader_flag = high_psi remove_leader_flag = medium_psi remove_leader_flag = low_psi }
		event_target:leader_3 = { remove_leader_flag = high_psi remove_leader_flag = medium_psi remove_leader_flag = low_psi }
	} }
	
	# Leader 1
	option = {
		name = "utopia.3190.1.a"
		custom_tooltip = "shroud.unknown.chances.high"
		trigger = { exists = event_target:leader_1 event_target:leader_1 = { has_leader_flag = high_psi } }
		event_target:leader_1 = { save_event_target_as = chosen_leader }
		hidden_effect = {
			random_list = {
				70 = { country_event = { id = ag_zeta_psionics.1031 } }
				20 = { country_event = { id = ag_zeta_psionics.1032 } }
				10 = { country_event = { id = ag_zeta_psionics.1033 } }
			}
		}
	}
	option = {
		name = "utopia.3190.2.a"
		custom_tooltip = "shroud.unknown.chances.medium"
		trigger = { exists = event_target:leader_1 event_target:leader_1 = { has_leader_flag = medium_psi } }
		event_target:leader_1 = { save_event_target_as = chosen_leader }
		hidden_effect = {
			random_list = {
				50 = { country_event = { id = ag_zeta_psionics.1031 } }
				30 = { country_event = { id = ag_zeta_psionics.1032 } }
				20 = { country_event = { id = ag_zeta_psionics.1033 } }
			}
		}
	}
	option = {
		name = "utopia.3190.3.a"
		custom_tooltip = "shroud.unknown.chances.low"
		trigger = { exists = event_target:leader_1 event_target:leader_1 = { has_leader_flag = low_psi } }
		event_target:leader_1 = { save_event_target_as = chosen_leader }
		hidden_effect = {
			random_list = {
				30 = { country_event = { id = ag_zeta_psionics.1031 } }
				40 = { country_event = { id = ag_zeta_psionics.1032 } }
				30 = { country_event = { id = ag_zeta_psionics.1033 } }
			}
		}
	}
	
	# Leader 2
	option = {
		name = "utopia.3190.1.b"
		custom_tooltip = "shroud.unknown.chances.high"
		trigger = { exists = event_target:leader_2 event_target:leader_2 = { has_leader_flag = high_psi } }
		event_target:leader_2 = { save_event_target_as = chosen_leader }
		hidden_effect = {
			random_list = {
				70 = { country_event = { id = ag_zeta_psionics.1031 } }
				20 = { country_event = { id = ag_zeta_psionics.1032 } }
				10 = { country_event = { id = ag_zeta_psionics.1033 } }
			}
		}
	}
	option = {
		name = "utopia.3190.2.b"
		custom_tooltip = "shroud.unknown.chances.medium"
		trigger = { exists = event_target:leader_2 event_target:leader_2 = { has_leader_flag = medium_psi } }
		event_target:leader_2 = { save_event_target_as = chosen_leader }
		hidden_effect = {
			random_list = {
				50 = { country_event = { id = ag_zeta_psionics.1031 } }
				30 = { country_event = { id = ag_zeta_psionics.1032 } }
				20 = { country_event = { id = ag_zeta_psionics.1033 } }
			}
		}
	}
	option = {
		name = "utopia.3190.3.b"
		custom_tooltip = "shroud.unknown.chances.low"
		trigger = { exists = event_target:leader_2 event_target:leader_2 = { has_leader_flag = low_psi } }
		event_target:leader_2 = { save_event_target_as = chosen_leader }
		hidden_effect = {
			random_list = {
				30 = { country_event = { id = ag_zeta_psionics.1031 } }
				40 = { country_event = { id = ag_zeta_psionics.1032 } }
				30 = { country_event = { id = ag_zeta_psionics.1033 } }
			}
		}
	}
	
	# Leader 3
	option = {
		name = "utopia.3190.1.c"
		custom_tooltip = "shroud.unknown.chances.high"
		trigger = { exists = event_target:leader_3 event_target:leader_3 = { has_leader_flag = high_psi } }
		event_target:leader_3 = { save_event_target_as = chosen_leader }
		hidden_effect = {
			random_list = {
				70 = { country_event = { id = ag_zeta_psionics.1031 } }
				20 = { country_event = { id = ag_zeta_psionics.1032 } }
				10 = {
					modifier = {
						factor = 0
						has_relic = r_zro_crystal
					}
					country_event = { id = ag_zeta_psionics.1033 }
				}
			}
		}
	}
	option = {
		name = "utopia.3190.2.c"
		custom_tooltip = "shroud.unknown.chances.medium"
		trigger = { exists = event_target:leader_3 event_target:leader_3 = { has_leader_flag = medium_psi } }
		event_target:leader_3 = { save_event_target_as = chosen_leader }
		hidden_effect = {
			random_list = {
				50 = { country_event = { id = ag_zeta_psionics.1031 } }
				30 = { country_event = { id = ag_zeta_psionics.1032 } }
				20 = {
					modifier = {
						factor = 0
						has_relic = r_zro_crystal
					}
					country_event = { id = ag_zeta_psionics.1033 }
				}
			}
		}
	}
	option = {
		name = "utopia.3190.3.c"
		custom_tooltip = "shroud.unknown.chances.low"
		trigger = { exists = event_target:leader_3 event_target:leader_3 = { has_leader_flag = low_psi } }
		event_target:leader_3 = { save_event_target_as = chosen_leader }
		hidden_effect = {
			random_list = {
				30 = { country_event = { id = ag_zeta_psionics.1031 } }
				40 = { country_event = { id = ag_zeta_psionics.1032 } }
				30 = {
					modifier = {
						factor = 0
						has_relic = r_zro_crystal
					}
					country_event = { id = ag_zeta_psionics.1033 }
				}
			}
		}
	}
	
	option = {
		name = "exit.shroud"
		custom_tooltip = "exit.shroud.tooltip"
		default_hide_option = yes
	}
}
country_event = {
	id = ag_zeta_psionics.1031
	title = "ag_zeta_psionics.1000.name"
	desc = "utopia.3191.desc"
	diplomatic = yes
	diplomatic_title = BLANK_STRING
	force_open = yes
	picture_event_data = { portrait = shroud1 room = ag_excited_shroud_room }
	is_triggered_only = yes
	immediate = { set_country_flag = shroud_diplomacy_engaged set_country_flag = shroud_vision_10 }
	after = { hidden_effect = {
		remove_country_flag = shroud_diplomacy_engaged
		set_timed_country_flag = { flag = positive_shroud_outcome days = 1800 }
	} }
	option = {
		name = "exit.shroud"
		default_hide_option = yes
		event_target:chosen_leader = {
			remove_all_negative_traits = yes
			remove_trait = leader_trait_psionic
			if = {
				limit = { NOT = { any_owned_leader = { ag_zeta_psionics_is_chosen_one = yes } } }
				add_trait = leader_trait_chosen
			}
			else = { add_trait = ag_dummy_leader_trait_chosen }
		}
	}
}
country_event = {
	id = ag_zeta_psionics.1032
	title = "ag_zeta_psionics.1000.name"
	desc = "utopia.3192.desc"
	diplomatic = yes
	diplomatic_title = BLANK_STRING
	force_open = yes
	picture_event_data = { portrait = shroud1 room = ag_excited_shroud_room }
	is_triggered_only = yes
	immediate = { set_country_flag = shroud_diplomacy_engaged }
	after = { hidden_effect = {
		remove_country_flag = shroud_diplomacy_engaged
		set_timed_country_flag = { flag = negative_shroud_outcome days = 1800 }
	} }
	option = {
		name = "exit.shroud"
		event_target:chosen_leader = { kill_leader = { show_notification = no } }
		default_hide_option = yes
	}
}
country_event = {
	id = ag_zeta_psionics.1033
	title = "ag_zeta_psionics.1000.name"
	desc = "utopia.3193.desc"
	diplomatic = yes
	diplomatic_title = BLANK_STRING
	force_open = yes
	picture_event_data = { portrait = shroud1 room = ag_excited_shroud_room }
	is_triggered_only = yes
	immediate = { set_country_flag = shroud_diplomacy_engaged }
	after = { hidden_effect = {
		remove_country_flag = shroud_diplomacy_engaged
		set_timed_country_flag = { flag = negative_shroud_outcome days = 1800 }
	} }
	option = {
		name = "exit.shroud"
		event_target:chosen_leader = { kill_leader = { show_notification = no } }
		hidden_effect = {
			if = {
				limit = { OR = { NOT = { has_global_flag = ag_zeta_crisis_stage_3 } has_global_flag = ag_zeta_crisis_ended } }
				country_event = { id = utopia.3024 }
			}
			else = { country_event = { id = ag_zeta_psionics.1035 } }
		}
		default_hide_option = yes
	}
}

# Shroud Invader Version.
country_event = {
	id = ag_zeta_psionics.1035
	title = "ag_zeta_psionics.1035.name"
	desc = "ag_zeta_psionics.1035.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_m_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_fleet_evil_room }
	show_sound = event_red_alert
	location = event_target:ag_target_system.star
	is_triggered_only = yes
	immediate = {
		random_system_within_border = { limit = { is_capital_system = no } save_event_target_as = ag_target_system }
		if = { limit = { NOT = { exists = event_target:ag_target_system } } random_system_within_border = { limit = { is_capital_system = no } } }
		event_target:ag_target_system = {
			random_system_planet = { save_event_target_as = ag_target_planet }
			create_fleet = {
				name = "NAME_ag_zeta_crisis_small_portal_fleet"
				settings = {
					is_boss = yes
					spawn_debris = no
				}
				effect = {
					set_fleet_flag = ag_zeta_crisis_small_portal
					set_owner = event_target:ag_zeta_crisis_country
					create_ship = {
						name = "NAME_ag_zeta_crisis_small_portal_ship"
						design = "NAME_ag_zeta_crisis_small_portal"
						prefix = no
						effect = {
							ag_difficulty_bonus = yes
							ag_set_disable_at_health = { ag_value = 0.05 ag_disable_type = event }
						}
					}
					set_location = { target = event_target:ag_target_planet distance = 15 angle = 0 }
					fleet_event = { id = ag_zeta_psionics.82 days = 1080 random = 720 }
				}
			}
			ag_spawn_zeta_crisis_assault_fleet = yes
			if = {
				limit = { exists = space_owner }
				if = {
					limit = {
						OR = { has_galactic_custodian = yes has_galactic_emperor = yes }
						space_owner = {
							is_ai = yes
							is_galactic_community_member = yes
							is_galactic_custodian = no
							is_galactic_emperor = no
						}
					}
					space_owner = { save_event_target_as = ag_target_community_member }
					if = {
						limit = { has_galactic_custodian = yes }
						random_playable_country = {
							limit = { is_galactic_custodian = yes }
							country_event = { id = ag_zeta_psionics.103 scopes = { from = event_target:ag_target_system } }
						}
					}
					else_if = {
						limit = { has_galactic_emperor = yes }
						random_playable_country = {
							limit = { is_galactic_emperor = yes }
							country_event = { id = ag_zeta_psionics.104 scopes = { from = event_target:ag_target_system } }
						}
					}
				}
			}
		}
	}
	option = { name = "ag_zeta_psionics.1035.a" }
}

country_event = {
	id = ag_zeta_psionics.1036
	title = "ag_zeta_psionics.1036.name"
	desc = "ag_zeta_psionics.1036.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_s_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_psionics_room }
	show_sound = event_psionic
	location = root
	is_triggered_only = yes
	after = { hidden_effect = { every_owned_leader = {
		limit = { has_trait = ag_dummy_leader_trait_chosen }
		reroll_random = yes
		random_list = {
			80 = {
				remove_trait = ag_dummy_leader_trait_chosen
				add_trait = leader_trait_psionic
			}
			20 = { }
		}
	} } }
	option = {
		name = "ag_zeta_psionics.1036.a"
		custom_tooltip = "ag_zeta_psionics.1036.a.tooltip"
	}
}
leader_event = {
	id = ag_zeta_psionics.1037
	title = "ag_zeta_psionics.1037.name"
	desc = "ag_zeta_psionics.1037.desc"
	is_triggered_only = yes
	diplomatic = yes
	custom_gui = "ag_ancient_event_s_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_ruined_system_room }
	show_sound = event_life_support_fail
	immediate = {
		reroll_random = yes
		random_list = { 50 = { } 50 = { owner = { country_event = { id = ag_zeta_psionics.1035 days = 5 random = 5 } } } }
		ag_kill_leader = { ag_notification = yes }
	}
	option = {
		name = "ag_zeta_psionics.1037.a"
		tooltip = { ag_kill_leader = { ag_notification = yes } }
	}
}

# Psi Jump Drives
country_event = {
	id = ag_zeta_psionics.1040
	title = "ag_zeta_psionics.1000.name"
	desc = "utopia.3160.desc"
	diplomatic = yes
	diplomatic_title = BLANK_STRING
	force_open = yes
	picture_event_data = { portrait = shroud1 room = ag_excited_shroud_room }
	is_triggered_only = yes
	immediate = { set_country_flag = shroud_diplomacy_engaged }
	after = { hidden_effect = { remove_country_flag = shroud_diplomacy_engaged } }
	option = {
		name = "utopia.3160.a"
		custom_tooltip = "shroud.unknown.chances.medium"
		hidden_effect = {
			reroll_random = yes
			random_list = {
				60 = { country_event = { id = ag_zeta_psionics.1041 } }
				40 = {
					modifier = { factor = 0.5 has_relic = r_zro_crystal }
					country_event = { id = ag_zeta_psionics.1042 }
				}
			}
		}
	}
	option = {
		name = "exit.shroud"
		custom_tooltip = "exit.shroud.tooltip"
		default_hide_option = yes
	}
}
# Success
country_event = {
	id = ag_zeta_psionics.1041
	title = "utopia.3161.name"
	desc = "utopia.3161.desc"
	diplomatic = yes
	diplomatic_title = BLANK_STRING
	force_open = yes
	picture_event_data = { portrait = shroud1 room = ag_excited_shroud_room }
	is_triggered_only = yes
	immediate = { set_country_flag = shroud_diplomacy_engaged }
	after = { hidden_effect = {
		remove_country_flag = shroud_diplomacy_engaged
		set_timed_country_flag = { flag = positive_shroud_outcome days = 1800 }
	} }
	option = {
		name = "exit.shroud"
		ag_add_research_option = { ag_tech = tech_psi_jump_drive_1 }
		default_hide_option = yes
	}
}
# Failure
country_event = {
	id = ag_zeta_psionics.1042
	title = "curse.bestowed"
	desc = "utopia.3162.desc"
	diplomatic = yes
	diplomatic_title = BLANK_STRING
	force_open = yes
	picture_event_data = { portrait = shroud1 room = ag_excited_shroud_room }
	is_triggered_only = yes
	immediate = { set_country_flag = shroud_diplomacy_engaged }
	after = { hidden_effect = {
		remove_country_flag = shroud_diplomacy_engaged
		set_timed_country_flag = { flag = negative_shroud_outcome days = 1800 }
	} }
	option = {
		name = "exit.shroud"
		default_hide_option = yes
		ag_add_shroud_negative_modifier = { ag_modifier = "shroud_neg_speed" }
	}
}

# Psionic Shield
country_event = {
	id = ag_zeta_psionics.1043
	title = "ag_zeta_psionics.1000.name"
	desc = "utopia.3170.desc"
	diplomatic = yes
	diplomatic_title = BLANK_STRING
	force_open = yes
	picture_event_data = { portrait = shroud1 room = ag_excited_shroud_room }
	is_triggered_only = yes
	immediate = { set_country_flag = shroud_diplomacy_engaged }
	after = { hidden_effect = { remove_country_flag = shroud_diplomacy_engaged } }
	option = {
		name = "utopia.3170.a"
		custom_tooltip = "shroud.unknown.chances.medium"
		hidden_effect = {
			reroll_random = yes
			random_list = {
				60 = { country_event = { id = ag_zeta_psionics.1044 } }
				40 = {
					modifier = { factor = 0.5 has_relic = r_zro_crystal }
					country_Event = { id = ag_zeta_psionics.1045 }
				}
			}
		}
	}
	option = {
		name = "exit.shroud"
		custom_tooltip = "exit.shroud.tooltip"
		default_hide_option = yes
	}
}
# Shield Penetrated
country_event = {
	id = ag_zeta_psionics.1044
	title = "utopia.3171.name"
	desc = "utopia.3171.desc"
	diplomatic = yes
	diplomatic_title = BLANK_STRING
	force_open = yes
	picture_event_data = { portrait = shroud1 room = ag_excited_shroud_room }
	is_triggered_only = yes
	immediate = { set_country_flag = shroud_diplomacy_engaged }
	after = { hidden_effect = {
		remove_country_flag = shroud_diplomacy_engaged
		set_timed_country_flag = { flag = positive_shroud_outcome days = 1800 }
	} }
	option = {
		name = "exit.shroud"
		ag_add_research_option = { ag_tech = tech_psionic_shield }
		default_hide_option = yes
	}
}
# Failed to Penetrate Shield
country_event = {
	id = ag_zeta_psionics.1045
	title = "ag_zeta_psionics.1000.name"
	desc = "utopia.3172.desc"
	diplomatic = yes
	diplomatic_title = BLANK_STRING
	force_open = yes
	picture_event_data = { portrait = shroud1 room = ag_excited_shroud_room }
	is_triggered_only = yes
	immediate = { set_country_flag = shroud_diplomacy_engaged }
	after = { hidden_effect = {
		remove_country_flag = shroud_diplomacy_engaged
		set_timed_country_flag = { flag = negative_shroud_outcome days = 1800 }
	} }
	option = {
		name = "exit.shroud"
		custom_tooltip = "exit.shroud.tooltip"
		hidden_effect = {
			if = {
				limit = { OR = { NOT = { has_global_flag = ag_zeta_crisis_stage_3 } has_global_flag = ag_zeta_crisis_ended } }
				country_event = { id = utopia.3024 }
			}
			else = { country_event = { id = ag_zeta_psionics.1035 } }
		}
		default_hide_option = yes
	}
}

# Precognition Interface
country_event = {
	id = ag_zeta_psionics.1046
	title = "ag_zeta_psionics.1000.name"
	desc = "utopia.3180.desc"
	diplomatic = yes
	diplomatic_title = BLANK_STRING
	force_open = yes
	picture_event_data = { portrait = shroud1 room = ag_excited_shroud_room }
	is_triggered_only = yes
	immediate = { set_country_flag = shroud_diplomacy_engaged }
	after = { hidden_effect = { remove_country_flag = shroud_diplomacy_engaged } }
	option = {
		name = "utopia.3180.a"
		custom_tooltip = "shroud.unknown.chances.medium"
		hidden_effect = {
			reroll_random = yes
			random_list = {
				60 = { country_event = { id = ag_zeta_psionics.1047 } }
				40 = {
					modifier = { factor = 0.5 has_relic = r_zro_crystal }
					country_Event = { id = ag_zeta_psionics.1048 }
				}
			}
		}
	}
	option = {
		name = "exit.shroud"
		custom_tooltip = "exit.shroud.tooltip"
		default_hide_option = yes
	}
}
# Success
country_event = {
	id = ag_zeta_psionics.1047
	title = "utopia.3181.name"
	desc = "utopia.3181.desc"
	diplomatic = yes
	diplomatic_title = BLANK_STRING
	force_open = yes
	picture_event_data = { portrait = shroud1 room = ag_excited_shroud_room }
	is_triggered_only = yes
	immediate = { set_country_flag = shroud_diplomacy_engaged }
	after = { hidden_effect = {
		remove_country_flag = shroud_diplomacy_engaged
		set_timed_country_flag = { flag = positive_shroud_outcome days = 1800 }
	} }
	option = {
		name = "exit.shroud"
		ag_add_research_option = { ag_tech = tech_precognition_interface }
		default_hide_option = yes
	}
}
# Failure
country_event = {
	id = ag_zeta_psionics.1048
	title = "ag_zeta_psionics.1000.name"
	desc = "utopia.3182.desc"
	diplomatic = yes
	diplomatic_title = BLANK_STRING
	force_open = yes
	picture_event_data = { portrait = shroud1 room = ag_excited_shroud_room }
	is_triggered_only = yes
	immediate = { set_country_flag = shroud_diplomacy_engaged }
	after = { hidden_effect = {
		remove_country_flag = shroud_diplomacy_engaged
		set_timed_country_flag = { flag = negative_shroud_outcome days = 1800 }
	} }
	option = {
		name = "exit.shroud"
		default_hide_option = yes
		hidden_effect = {
			remove_modifier = "shroud_cooldown"
			if = {
				limit = { has_relic = r_zro_crystal }
				add_modifier = { modifier = "shroud_precog_cooldown" days = 1800 }
			}
			else = { add_modifier = { modifier = "shroud_precog_cooldown" days = 3600 } }
		}
	}
}

# Attempt to Contact a Major Entity
country_event = {
	id = ag_zeta_psionics.1050
	title = "ag_zeta_psionics.1000.name"
	desc = "utopia.3005.desc"
	diplomatic = yes
	diplomatic_title = BLANK_STRING
	force_open = yes
	picture_event_data = { portrait = shroud1 room = ag_excited_shroud_room }
	is_triggered_only = yes
	immediate = { set_country_flag = shroud_diplomacy_engaged }
	after = { hidden_effect = { remove_country_flag = shroud_diplomacy_engaged } }
	option = {
		name = "utopia.3005.a"
		set_country_flag = contact_composer
		hidden_effect = { country_event = { id = ag_zeta_psionics.1051 } }
	}
	option = {
		name = "utopia.3005.b"
		set_country_flag = contact_eater
		hidden_effect = { country_event = { id = ag_zeta_psionics.1051 } }
	}
	option = {
		name = "utopia.3005.c"
		set_country_flag = contact_instrument
		hidden_effect = { country_event = { id = ag_zeta_psionics.1051 } }
	}
	option = {
		name = "utopia.3005.d"
		set_country_flag = contact_whisperers
		hidden_effect = { country_event = { id = ag_zeta_psionics.1051 } }
	}
	option = {
		name = "exit.shroud"
		custom_tooltip = "exit.shroud.tooltip"
		default_hide_option = yes
	}
}
# Patron Spirit
country_event = {
	id = ag_zeta_psionics.1051
	title = "ag_zeta_psionics.1000.name"
	desc = "utopia.3300.desc"
	diplomatic = yes
	diplomatic_title = BLANK_STRING
	force_open = yes
	picture_event_data = { portrait = shroud1 room = ag_excited_shroud_room }
	is_triggered_only = yes
	immediate = {
		set_country_flag = shroud_diplomacy_engaged
		if = {
			limit = { NOT = { has_country_flag = offered_covenant } }
			set_country_flag = offered_covenant
		}
		if = {
			limit = { any_owned_leader = { ag_zeta_psionics_is_chosen_one = yes } }
			random_owned_leader = { limit = { ag_zeta_psionics_is_chosen_one = yes } save_event_target_as = chosen_one }
			set_country_flag = has_chosen_one
		}
		else = {
			reroll_random = yes
			random_list = {
				33 = { modifier = { factor = 2 has_relic = r_zro_crystal } set_country_flag = patron_deity_chance_high }
				33 = { set_country_flag = patron_deity_chance_medium }
				33 = { modifier = { factor = 0.5 has_relic = r_zro_crystal } set_country_flag = patron_deity_chance_low }
			}
		}
	}
	after = { hidden_effect = {
		remove_country_flag = shroud_diplomacy_engaged
		remove_country_flag = patron_deity_chance_high
		remove_country_flag = patron_deity_chance_medium
		remove_country_flag = patron_deity_chance_low
	} }
	option = {
		name = "utopia.3300.1.a"
		custom_tooltip = "shroud.unknown.chances.high"
		trigger = { has_country_flag = patron_deity_chance_high }
		hidden_effect = {
			reroll_random = yes
			random_list = {
				70 = { country_event = { id = ag_zeta_psionics.1054 }}
				20 = { country_event = { id = ag_zeta_psionics.1053 }}
				10 = { country_event = { id = ag_zeta_psionics.1052 }}
			}
		}
	}
	option = {
		name = "utopia.3300.1.b"
		custom_tooltip = "shroud.unknown.chances.medium"
		trigger = { has_country_flag = patron_deity_chance_medium }
		hidden_effect = {
			reroll_random = yes
			random_list = {
				50 = { country_event = { id = ag_zeta_psionics.1054 }}
				30 = { country_event = { id = ag_zeta_psionics.1053 }}
				20 = { country_event = { id = ag_zeta_psionics.1052 }}
			}
		}
	}
	option = {
		name = "utopia.3300.1.c"
		custom_tooltip = "shroud.unknown.chances.low"
		trigger = { has_country_flag = patron_deity_chance_low }
		hidden_effect = {
			reroll_random = yes
			random_list = {
				30 = { country_event = { id = ag_zeta_psionics.1054 }}
				40 = { country_event = { id = ag_zeta_psionics.1053 }}
				30 = { country_event = { id = ag_zeta_psionics.1052 }}
			}
		}
	}
	option = {
		name = "utopia.3300.1.d"
		custom_tooltip = "shroud.unknown.chances.high"
		trigger = { has_country_flag = has_chosen_one }
		hidden_effect = {
			reroll_random = yes
			random_list = {
				85 = { country_event = { id = ag_zeta_psionics.1054 }}
				10 = { country_event = { id = ag_zeta_psionics.1053 }}
				5 = { country_event = { id = ag_zeta_psionics.1052 }}
			}
		}
	}
	option = {
		name = "exit.shroud"
		custom_tooltip = "exit.shroud.tooltip"
		default_hide_option = yes
	}
}
# Failure
country_event = {
	id = ag_zeta_psionics.1052
	title = "ag_zeta_psionics.1000.name"
	desc = "utopia.3301.desc"
	diplomatic = yes
	diplomatic_title = BLANK_STRING
	force_open = yes
	picture_event_data = { portrait = shroud1 room = ag_excited_shroud_room }
	is_triggered_only = yes
	immediate = { set_country_flag = shroud_diplomacy_engaged }
	after = { hidden_effect = {
		remove_country_flag = shroud_diplomacy_engaged
		set_timed_country_flag = { flag = negative_shroud_outcome days = 1800 }
	} }
	option = {
		name = "exit.shroud"
		default_hide_option = yes
	}
}
# Critical Failure
country_event = {
	id = ag_zeta_psionics.1053
	title = "ag_zeta_psionics.1000.name"
	desc = "utopia.3302.desc"
	diplomatic = yes
	diplomatic_title = BLANK_STRING
	force_open = yes
	picture_event_data = { portrait = shroud1 room = ag_excited_shroud_room }
	is_triggered_only = yes
	immediate = {
		set_country_flag = shroud_diplomacy_engaged
		random_owned_leader = {
			limit = { OR = {
				ag_zeta_psionics_is_chosen_one = yes
				has_trait = leader_trait_psionic
			} }
			save_event_target_as = leader_to_kill
		}
	}
	after = { hidden_effect = {
		remove_country_flag = shroud_diplomacy_engaged
		set_timed_country_flag = { flag = negative_shroud_outcome days = 1800 }
	} }
	option = {
		name = "exit.shroud"
		default_hide_option = yes
		event_target:leader_to_kill = { kill_leader = { show_notification = no } }
	}
}
# Pick a Patron to contact
country_event = {
	id = ag_zeta_psionics.1054
	hide_window = yes
	is_triggered_only = yes
	immediate = {
		random_list = {
			25 = {	# The Whisperers in the Void
				modifier = {
					factor = 1.5
					OR = {
						has_civic = civic_cutthroat_politics
						has_civic = civic_technocracy
						is_scavenger = yes
						has_civic = civic_criminal_heritage
						has_toxic_baths = yes
						has_civic = civic_shadow_council
					}
				}
				modifier = {
					factor = 1.3
					OR = {
						has_tradition = tr_subterfuge_finish
						has_tradition = tr_discovery_finish
					}
				}
				modifier = {
					factor = 1.3
					OR = {
						has_ascension_perk = ap_enigmatic_engineering
						has_ascension_perk = ap_technological_ascendancy
					}
				}
				modifier = {
					factor = 1.3
					has_ethic = ethic_materialist
				}
				modifier = {
					factor = 1.5
					has_ethic = ethic_fanatic_materialist
				}
				modifier = {
					factor = 1.6
					any_envoy = {
						has_envoy_task = {
							task = spy_network
						}
					}
				}
				modifier = {
					factor = 0.7
					has_civic = civic_inwards_perfection
				}
				modifier = {
					factor = 0.3
					has_ethic = ethic_spiritualist
				}
				modifier = {
					factor = 0.05
					has_ethic = ethic_fanatic_spiritualist
				}
				modifier = {
					factor = 0
					OR = {
						has_country_flag = contact_composer
						has_country_flag = contact_eater
						has_country_flag = contact_instrument
					}
				}
				country_event = { id = ag_zeta_psionics.1055 }
			}
			25 = {	# The Composer of Strands
				modifier = {
					factor = 1.5
					OR = {
						has_civic = civic_environmentalist
						is_catalytic_empire = yes
						has_civic = civic_idyllic_bloom
						has_toxic_baths = yes
					}
				}
				modifier = {
					factor = 1.3
					has_tradition = tr_adaptability_finish
				}
				modifier = {
					factor = 1.3
					OR = {
						has_ascension_perk = ap_consecrated_worlds
						has_ascension_perk = ap_xeno_compatibility
					}
				}
				modifier = {
					factor = 1.3
					has_ethic = ethic_xenophile
				}
				modifier = {
					factor = 1.5
					has_ethic = ethic_fanatic_xenophile
				}
				modifier = {
					factor = 1.6
					num_buildings = { type = building_clinic value = 0 }
					num_buildings = { type = building_hospital value = 0 }
				}
				modifier = {
					factor = 0.7
					is_relentless_industrialist_empire = yes
				}
				modifier = {
					factor = 0.3
					has_ethic = ethic_xenophobe
				}
				modifier = {
					factor = 0.05
					has_ethic = ethic_fanatic_xenophobe
				}
				modifier = {
					factor = 0
					OR = {
						has_country_flag = contact_whisperers
						has_country_flag = contact_eater
						has_country_flag = contact_instrument
					}
				}
				country_event = { id = ag_zeta_psionics.1056 }
			}
			25 = {	# The Eater of Worlds
				modifier = {
					factor = 1.5
					OR = {
						has_civic = civic_citizen_service
						has_civic = civic_fanatic_purifiers
						has_civic = civic_distinguished_admiralty
						has_civic = civic_naval_contractors
						has_civic = civic_barbaric_despoilers
						has_civic = civic_private_military_companies
					}
				}
				modifier = {
					factor = 1.3
					has_tradition = tr_supremacy_finish
				}
				modifier = {
					factor = 1.3
					OR = {
						has_ascension_perk = ap_galactic_force_projection
						has_ascension_perk = ap_interstellar_dominion
					}
				}
				modifier = {
					factor = 1.3
					has_ethic = ethic_militarist
				}
				modifier = {
					factor = 1.5
					has_ethic = ethic_fanatic_militarist
				}
				modifier = {
					factor = 1.6
					is_at_war = yes
				}
				modifier = {
					factor = 0.7
					OR = {
						has_civic = civic_inwards_perfection
						has_civic = civic_agrarian_idyll
					}
				}
				modifier = {
					factor = 0.3
					has_ethic = ethic_pacifist
				}
				modifier = {
					factor = 0.05
					has_ethic = ethic_fanatic_pacifist
				}
				modifier = {
					factor = 0
					OR = {
						has_country_flag = contact_composer
						has_country_flag = contact_whisperers
						has_country_flag = contact_instrument
					}
				}
				country_event = { id = ag_zeta_psionics.1057 }
			}
			25 = {	# The Instrument of Desire
				modifier = {
					factor = 1.5
					OR = {
						has_civic = civic_aristocratic_elite
						has_civic = civic_feudal_realm
						has_civic = civic_slaver_guilds
						has_civic = civic_pleasure_seekers
						has_toxic_baths = yes
						has_civic = civic_indentured_assets
						has_civic = civic_corporate_hedonism
					}
				}
				modifier = {
					factor = 1.3
					has_tradition = tr_domination_finish
				}
				modifier = {
					factor = 1.3
					OR = {
						has_ascension_perk = ap_shared_destiny
						has_ascension_perk = ap_imperial_prerogative
					}
				}
				modifier = {
					factor = 1.3
					has_ethic = ethic_authoritarian
				}
				modifier = {
					factor = 1.5
					has_ethic = ethic_fanatic_authoritarian
				}
				modifier = {
					factor = 1.6
					AND = {
						is_at_war = no
						ruler = { has_trait = leader_trait_substance_abuser }
						any_owned_planet = { is_colony = yes has_designation = col_resort }
					}
				}
				modifier = {
					factor = 0.7
					has_civic = civic_shared_burden
				}
				modifier = {
					factor = 0.3
					has_ethic = ethic_egalitarian
				}
				modifier = {
					factor = 0.05
					has_ethic = ethic_fanatic_egalitarian
				}
				modifier = {
					factor = 0
					OR = {
						has_country_flag = contact_composer
						has_country_flag = contact_eater
						has_country_flag = contact_whisperers
					}
				}
				country_event = { id = ag_zeta_psionics.1058 }
			}
			2 = {
				modifier = {
					factor = 5
					any_country = {
						NOT = { is_same_value = root }
						has_crisis_level = crisis_level_5 # Someone wants to destroy the galaxy? Let's give them a challenge.
					}
				}
				modifier = {
					factor = 5
					has_country_flag = knights_met_end_of_cycle
				}
				modifier = {
					factor = 0.3
					OR = {
						has_country_flag = contact_composer
						has_country_flag = contact_eater
						has_country_flag = contact_instrument
						has_country_flag = contact_whisperers
					}
				}
				if = {
					limit = { NOT = { has_global_flag = end_of_the_cycle } }
					country_event = { id = ag_zeta_psionics.1059 } # The End of the Cycle - extremely rare
				}
				else = {
					reroll_random = yes
					random_list = {
						25 = { country_event = { id = ag_zeta_psionics.1055 } }	# The Whisperers in the Void
						25 = { country_event = { id = ag_zeta_psionics.1056 } }	# The Composer of Strands
						25 = { country_event = { id = ag_zeta_psionics.1057 } }	# The Eater of Worlds
						25 = { country_event = { id = ag_zeta_psionics.1058 } }	# The Instrument of Desire
					}
				}
			}
		}
	}
	after = {
		remove_country_flag = contact_composer
		remove_country_flag = contact_eater
		remove_country_flag = contact_instrument
		remove_country_flag = contact_whisperers
	}
}
# The Whisperers in the Void
country_event = {
	id = ag_zeta_psionics.1055
	title = "ag_zeta_psionics.1000.name"
	desc = "utopia.3304.desc"
	diplomatic = yes
	diplomatic_title = BLANK_STRING
	force_open = yes
	picture_event_data = { portrait = shroud1 room = ag_excited_shroud_room }
	is_triggered_only = yes
	immediate = { set_country_flag = shroud_diplomacy_engaged }
	after = { hidden_effect = { remove_country_flag = shroud_diplomacy_engaged } }
	option = {
		name = "utopia.3304.a"
		trigger = { NOT = { has_country_flag = tradition_covenant } }
		custom_tooltip = "covenant.tooltip"
		add_modifier = { modifier = covenant_whisperers_in_the_void_0 days = -1 }
		begin_event_chain = { event_chain = "whisperers_covenant_chain" target = this }
		hidden_effect = {
			set_country_flag = has_shroud_patron
			set_country_flag = whisperers_covenant_confirmed
			country_event = { id = utopia.3310 } # Covenant Sealed
			set_variable = { which = whisperers_covenant_rank value = 1 }
		}
	}
	option = { #Tradition Covenant
		name = "utopia.3304.a"
		trigger = { has_country_flag = tradition_covenant }
		custom_tooltip = "covenant.tooltip"
		add_modifier = { modifier = covenant_whisperers_in_the_void_0 days = -1 }
		hidden_effect = {
			set_country_flag = has_shroud_patron
			remove_country_flag = tradition_covenant
			country_event = { id = utopia.3310 } # Covenant Sealed
			if = {
				limit = { has_tradition = tr_psionics_finish NOT = { has_country_flag = confirmation_incoming } }
				country_event = { id = utopia.2658 days = 360 }
			}
		}
	}
	option = {
		name = "exit.shroud"
		custom_tooltip = "exit.shroud.tooltip"
		default_hide_option = yes
		hidden_effect = { remove_country_flag = form_covenant_flag }
	}
}
# The Composer of Strands
country_event = {
	id = ag_zeta_psionics.1056
	title = "ag_zeta_psionics.1000.name"
	desc = "utopia.3305.desc"
	diplomatic = yes
	diplomatic_title = BLANK_STRING
	force_open = yes
	picture_event_data = { portrait = shroud1 room = ag_excited_shroud_room }
	is_triggered_only = yes
	immediate = { set_country_flag = shroud_diplomacy_engaged }
	after = { hidden_effect = { remove_country_flag = shroud_diplomacy_engaged } }
	option = {
		name = "utopia.3305.a"
		trigger = { NOT = { has_country_flag = tradition_covenant } }
		custom_tooltip = "covenant.tooltip"
		add_modifier = { modifier = covenant_composer_of_strands_0 days = -1 }
		begin_event_chain = { event_chain = "composer_covenant_chain" target = this }
		hidden_effect = {
			set_country_flag = has_shroud_patron
			set_country_flag = composer_covenant_confirmed
			country_event = { id = utopia.3310 } # Covenant Sealed
			set_variable = { which = composer_covenant_rank value = 1 }
		}
	}
	option = { #Tradition Covenant
		name = "utopia.3305.a"
		trigger = { has_country_flag = tradition_covenant }
		custom_tooltip = "covenant.tooltip"
		add_modifier = { modifier = covenant_composer_of_strands_0 days = -1 }
		hidden_effect = {
			set_country_flag = has_shroud_patron
			remove_country_flag = tradition_covenant
			country_event = { id = utopia.3310 } # Covenant Sealed
			if = {
				limit = { has_tradition = tr_psionics_finish NOT = { has_country_flag = confirmation_incoming } }
				country_event = { id = utopia.2658 days = 360 }
			}
		}
	}
	option = {
		name = "exit.shroud"
		custom_tooltip = "exit.shroud.tooltip"
		default_hide_option = yes
		hidden_effect = { remove_country_flag = form_covenant_flag }
	}
}
# The Eater of Worlds
country_event = {
	id = ag_zeta_psionics.1057
	title = "ag_zeta_psionics.1000.name"
	desc = "utopia.3306.desc"
	diplomatic = yes
	diplomatic_title = BLANK_STRING
	force_open = yes
	picture_event_data = { portrait = shroud1 room = ag_excited_shroud_room }
	is_triggered_only = yes
	immediate = { set_country_flag = shroud_diplomacy_engaged }
	after = { hidden_effect = { remove_country_flag = shroud_diplomacy_engaged } }
	option = {
		name = "utopia.3306.a"
		trigger = { NOT = { has_country_flag = tradition_covenant } }
		custom_tooltip = "covenant.tooltip"
		add_modifier = { modifier = covenant_eater_of_worlds_0 days = -1 }
		begin_event_chain = { event_chain = "eater_covenant_chain" target = this }
		hidden_effect = {
			set_country_flag = has_shroud_patron
			set_country_flag = eater_covenant_confirmed
			country_event = { id = utopia.3310 } # Covenant Sealed
			random_owned_planet = {
				limit = { is_capital = no any_owned_pop = { is_sapient = yes is_robot_pop = no } }
				random_owned_pop = { limit = { is_sapient = yes is_robot_pop = no } kill_pop = yes }
			}
			set_variable = { which = eater_covenant_rank value = 1 }
		}
	}
	option = { # tradition covenant
		name = "utopia.3306.a"
		trigger = { has_country_flag = tradition_covenant }
		custom_tooltip = "covenant.tooltip"
		add_modifier = { modifier = covenant_eater_of_worlds_0 days = -1 }
		hidden_effect = {
			set_country_flag = has_shroud_patron
			remove_country_flag = tradition_covenant
			country_event = { id = utopia.3310 } # Covenant Sealed
			random_owned_planet = {
				limit = { is_capital = no any_owned_pop = { is_sapient = yes is_robot_pop = no } }
				random_owned_pop = { limit = { is_sapient = yes is_robot_pop = no } kill_pop = yes }
			}
			if = {
				limit = { has_tradition = tr_psionics_finish 	NOT = { has_country_flag = confirmation_incoming } }
				country_event = { id = utopia.2658 days = 360 }
			}
		}
	}
	option = {
		name = "exit.shroud"
		custom_tooltip = "exit.shroud.tooltip"
		default_hide_option = yes
		hidden_effect = { remove_country_flag = form_covenant_flag }
	}
}
# The Instrument of Desire
country_event = {
	id = ag_zeta_psionics.1058
	title = "ag_zeta_psionics.1000.name"
	desc = "utopia.3307.desc"
	diplomatic = yes
	diplomatic_title = BLANK_STRING
	force_open = yes
	picture_event_data = { portrait = shroud1 room = ag_excited_shroud_room }
	is_triggered_only = yes
	immediate = { set_country_flag = shroud_diplomacy_engaged }
	after = { hidden_effect = { remove_country_flag = shroud_diplomacy_engaged } }
	option = {
		name = "utopia.3307.a"
		trigger = { NOT = { has_country_flag = tradition_covenant } }
		custom_tooltip = "covenant.tooltip"
		add_modifier = { modifier = covenant_instrument_of_desire_0 days = -1 }
		begin_event_chain = { event_chain = "instrument_covenant_chain" target = this }
		hidden_effect = {
			set_country_flag = has_shroud_patron
			set_country_flag = instrument_covenant_confirmed
			country_event = { id = utopia.3310 } # Covenant Sealed
			set_variable = { which = instrument_covenant_rank value = 1 }
		}
	}
	option = { #Tradition Covenant
		name = "utopia.3307.a"
		trigger = { has_country_flag = tradition_covenant }
		custom_tooltip = "covenant.tooltip"
		add_modifier = { modifier = covenant_instrument_of_desire_0 days = -1 }
		hidden_effect = {
			set_country_flag = has_shroud_patron
			remove_country_flag = tradition_covenant
			country_event = { id = utopia.3310 } # Covenant Sealed
			if = {
				limit = {
					has_tradition = tr_psionics_finish
					NOT = { has_country_flag = confirmation_incoming }
				}
				country_event = { id = utopia.2658 days = 360 }
			}
		}
	}
	option = {
		name = "exit.shroud"
		custom_tooltip = "exit.shroud.tooltip"
		default_hide_option = yes
		hidden_effect = { remove_country_flag = form_covenant_flag }
	}
}
# The End of the Cycle
country_event = {
	id = ag_zeta_psionics.1059
	title = "ag_zeta_psionics.1000.name"
	desc = "utopia.3308.desc"
	diplomatic = yes
	diplomatic_title = BLANK_STRING
	force_open = yes
	picture_event_data = { portrait = shroud1 room = ag_excited_shroud_room }
	is_triggered_only = yes
	immediate = { set_country_flag = shroud_diplomacy_engaged }
	after = { hidden_effect = {
		remove_country_flag = shroud_diplomacy_engaged
		remove_country_flag = tradition_covenant
	} }
	option = {
		name = "utopia.3308.a"
		custom_tooltip = "covenant.cycle.tooltip"
		add_modifier = { modifier = covenant_end_of_the_cycle days = 18000 } # You really shouldn't have done that...
		hidden_effect = {
			set_global_flag = end_of_the_cycle
			set_country_flag = has_shroud_patron
			set_country_flag = covenant_end_of_the_cycle
			every_owned_planet = {
				limit = { NOT = { has_modifier = covenant_shroud_marked } }
				add_modifier = { modifier = covenant_shroud_marked days = -1 }
			}
			every_subject = {
				every_owned_planet = {
					limit = { NOT = { has_modifier = covenant_shroud_marked } }
					add_modifier = { modifier = covenant_shroud_marked days = -1 }
				}
			}
			country_event = { id = utopia.3310 } # Covenant Sealed
			country_event = { id = utopia.3320 days = 18000 }
		}
	}
	option = {
		name = "exit.shroud"
		custom_tooltip = "exit.shroud.tooltip"
		default_hide_option = yes
		hidden_effect = { remove_country_flag = form_covenant_flag }
	}
}

# Eerie Obelisk
country_event = {
	id = ag_zeta_psionics.1060
	title = "ag_zeta_psionics.1000.name"
	desc = "ag_zeta_psionics.1060.desc"
	diplomatic = yes
	diplomatic_title = BLANK_STRING
	force_open = yes
	picture_event_data = { portrait = shroud1 room = ag_excited_shroud_room }
	is_triggered_only = yes
	immediate = { set_country_flag = shroud_diplomacy_engaged }
	after = { hidden_effect = { remove_country_flag = shroud_diplomacy_engaged } }
	option = {
		name = "ag_zeta_psionics.1060.a"
		custom_tooltip = "shroud.unknown.chances.medium"
		hidden_effect = {
			reroll_random = yes
			random_list = {
				60 = { country_event = { id = ag_zeta_psionics.1061 } }
				40 = {
					modifier = { factor = 0.5 has_relic = r_zro_crystal }
					country_event = { id = ag_zeta_psionics.1062 }
				}
			}
		}
	}
	option = {
		name = "exit.shroud"
		custom_tooltip = "exit.shroud.tooltip"
		default_hide_option = yes
	}
}
# Success
country_event = {
	id = ag_zeta_psionics.1061
	title = "ag_zeta_psionics.1061.name"
	desc = "ag_zeta_psionics.1061.desc"
	diplomatic = yes
	diplomatic_title = BLANK_STRING
	force_open = yes
	picture_event_data = { portrait = shroud1 room = ag_excited_shroud_room }
	is_triggered_only = yes
	immediate = { set_country_flag = shroud_diplomacy_engaged }
	after = { hidden_effect = {
		remove_country_flag = shroud_diplomacy_engaged
		set_timed_country_flag = { flag = positive_shroud_outcome days = 1800 }
	} }
	option = {
		name = "exit.shroud"
		ag_add_research_option = { ag_tech = tech_ag_eerie_obelisk }
		default_hide_option = yes
	}
}
# Failure
country_event = {
	id = ag_zeta_psionics.1062
	title = "curse.bestowed"
	desc = "ag_zeta_psionics.1062.desc"
	diplomatic = yes
	diplomatic_title = BLANK_STRING
	force_open = yes
	picture_event_data = { portrait = shroud1 room = ag_excited_shroud_room }
	is_triggered_only = yes
	immediate = { set_country_flag = shroud_diplomacy_engaged }
	after = { hidden_effect = {
		remove_country_flag = shroud_diplomacy_engaged
		set_timed_country_flag = { flag = negative_shroud_outcome days = 1800 }
	} }
	option = {
		name = "exit.shroud"
		default_hide_option = yes
		ag_add_shroud_negative_modifier = { ag_modifier = "shroud_neg_growth" }
	}
}

# on_building_complete, on_building_replaced, Build eerie obelisk.
planet_event = {
	id = ag_zeta_psionics.1063
	hide_window = yes
	is_triggered_only = yes
	trigger = { has_building = ag_eerie_obelisk_dummy }
	immediate = {
		remove_building = ag_eerie_obelisk_dummy
		random_list = {
			10 = {
				modifier = { add = 30 owner = { has_country_flag = composer_covenant_confirmed } }
				add_building = ag_eerie_obelisk_1
				ag_set_eerie_obelisk_multiplier = yes
			}
			10 = {
				modifier = { add = 30 owner = { has_country_flag = eater_covenant_confirmed } }
				add_building = ag_eerie_obelisk_2
				ag_set_eerie_obelisk_multiplier = yes
			}
			10 = {
				modifier = { add = 30 owner = { has_country_flag = instrument_covenant_confirmed } }
				add_building = ag_eerie_obelisk_3
				ag_set_eerie_obelisk_multiplier = yes
			}
			10 = {
				modifier = { add = 30 owner = { has_country_flag = whisperers_covenant_confirmed } }
				add_building = ag_eerie_obelisk_4
				ag_set_eerie_obelisk_multiplier = yes
			}
			10 = { add_building = ag_eerie_obelisk_5 ag_set_eerie_obelisk_multiplier = yes }
			10 = { add_building = ag_eerie_obelisk_6 ag_set_eerie_obelisk_multiplier = yes }
			10 = { add_building = ag_eerie_obelisk_7 ag_set_eerie_obelisk_multiplier = yes }
			5 = { planet_event = { id = ag_zeta_psionics.1064 } }
			5 = { planet_event = { id = ag_zeta_psionics.1065 } }
			5 = { planet_event = { id = ag_zeta_psionics.1066 } }
			5 = { planet_event = { id = ag_zeta_psionics.1067 } }
		}
	}
}
planet_event = {
	id = ag_zeta_psionics.1064
	title = "ag_zeta_psionics.1064.name"
	desc = "ag_zeta_psionics.1064.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_s_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_ruined_system_room }
	show_sound = event_super_explosion
	location = root
	is_triggered_only = yes
	option = {
		name = "ag_zeta_psionics.1064.a"
		locked_random_list = {
			10 = { add_planet_devastation = 10 }
			10 = { add_planet_devastation = 15 }
			10 = { add_planet_devastation = 20 }
			10 = { add_planet_devastation = 25 }
		}
		add_deposit = ag_zeta_crisis_bombardment_crater
		random_owned_pop = { kill_pop = yes }
	}
}
planet_event = {
	id = ag_zeta_psionics.1065
	title = "ag_zeta_psionics.1065.name"
	desc = "ag_zeta_psionics.1065.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_s_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_ruined_system_room }
	show_sound = event_super_explosion
	location = root
	is_triggered_only = yes
	after = {
		locked_random_list = {
			10 = { add_planet_devastation = 10 }
			10 = { add_planet_devastation = 15 }
			10 = { add_planet_devastation = 20 }
			10 = { add_planet_devastation = 25 }
		}
		add_deposit = ag_zeta_crisis_bombardment_crater
		random_owned_pop = { limit = { has_job = telepath } kill_pop = yes }
		create_fleet = {
			name = "NAME_Psionic_Avatar"
			settings = {
				can_upgrade = no
				can_change_composition = no
				can_change_leader = no
				uses_naval_capacity = no
				spawn_debris = no
			}
			effect = {
				set_owner = root
				create_ship = {
					name = "NAME_Avatar"
					design = "NAME_Shroud_Avatar"
					prefix = no
					upgradable = no
				}
				set_location = root
			}
		}
	}
	option = { name = "ag_zeta_psionics.1065.a" }
	option = { name = "ag_zeta_psionics.1065.b" }
}
planet_event = {
	id = ag_zeta_psionics.1066
	title = "ag_zeta_psionics.1066.name"
	desc = "ag_zeta_psionics.1066.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_s_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_ruined_system_room }
	show_sound = event_super_explosion
	location = root
	is_triggered_only = yes
	after = {
		locked_random_list = {
			10 = { add_planet_devastation = 10 }
			10 = { add_planet_devastation = 15 }
			10 = { add_planet_devastation = 20 }
			10 = { add_planet_devastation = 25 }
		}
		add_deposit = ag_zeta_crisis_bombardment_crater
		random_owned_pop = { limit = { has_job = telepath } kill_pop = yes }
		create_army = {
			name = "NAME_Avatar"
			owner = root
			species = root
			type = "shroud_army"
		}
	}
	option = { name = "ag_zeta_psionics.1066.a" }
	option = { name = "ag_zeta_psionics.1066.b" }
}
planet_event = {
	id = ag_zeta_psionics.1067
	title = "ag_zeta_psionics.1067.name"
	desc = "ag_zeta_psionics.1067.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_s_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_ruined_system_room }
	show_sound = event_super_explosion
	location = root
	is_triggered_only = yes
	immediate = {
		if = {
			limit = {
				OR = { NOT = { has_global_flag = ag_zeta_crisis_stage_3 } has_global_flag = ag_zeta_crisis_ended }
				NOT = { exists = event_target:shroud_country }
			}
			create_country = {
				name = "NAME_Creatures_of_the_Shroud"
				type = shroud_spirits
				flag = {
					icon = {
						category = "special"
						file = "the_shroud.dds"
					}
					background= {
						category = "backgrounds"
						file = "00_solid.dds"
					}
					colors={
						"dark_purple"
						"black"
						"null"
						"null"
					}
				}
			}
			last_created_country = {
				establish_communications_no_message = root
				save_global_event_target_as = shroud_country
			}
		}
	}
	after = {
		locked_random_list = {
			10 = { add_planet_devastation = 10 }
			10 = { add_planet_devastation = 15 }
			10 = { add_planet_devastation = 20 }
			10 = { add_planet_devastation = 25 }
		}
		add_deposit = ag_zeta_crisis_bombardment_crater
		random_owned_pop = { limit = { has_job = telepath } kill_pop = yes }
		if = {
			limit = { OR = { NOT = { has_global_flag = ag_zeta_crisis_stage_3 } has_global_flag = ag_zeta_crisis_ended } }
			create_fleet = {
				name = "NAME_Corrupted_Avatar"
				settings = {
					can_upgrade = no
					can_change_composition = no
					can_change_leader = no
					uses_naval_capacity = no
					spawn_debris = no
				}
				effect = {
					set_owner = event_target:shroud_country
					create_ship = {
						name = "NAME_Corrupted_Avatar"
						design = "NAME_Corrupted_Avatar"
						prefix = no
						upgradable = no
					}
					set_fleet_stance = aggressive
					set_aggro_range_measure_from = return_point
					set_aggro_range = 300
					set_location = root
				}
			}
		}
		else = {
			create_fleet = {
				name = "NAME_Corrupted_Avatar"
				settings = {
					can_upgrade = no
					can_change_composition = no
					can_change_leader = no
					uses_naval_capacity = no
					spawn_debris = no
				}
				effect = {
					set_owner = event_target:ag_zeta_crisis_country
					create_ship = {
						name = "NAME_Corrupted_Avatar"
						design = "NAME_Corrupted_Avatar"
						prefix = no
						upgradable = no
					}
					set_fleet_stance = aggressive
					set_aggro_range_measure_from = return_point
					set_aggro_range = 300
					set_location = root
				}
			}
		}
	}
	option = { name = "ag_zeta_psionics.1067.a" }
	option = { name = "ag_zeta_psionics.1067.b" }
}

# Psionic Power Core
country_event = {
	id = ag_zeta_psionics.1070
	title = "ag_zeta_psionics.1000.name"
	desc = {
		trigger = { NOT = { has_global_flag = ag_zeta_crisis_stage_3 } }
		text = "ag_zeta_psionics.1070.a.desc"
	}
	desc = {
		trigger = { has_global_flag = ag_zeta_crisis_stage_3 }
		text = "ag_zeta_psionics.1070.b.desc"
	}
	diplomatic = yes
	diplomatic_title = BLANK_STRING
	force_open = yes
	picture_event_data = { portrait = shroud1 room = ag_excited_shroud_room }
	is_triggered_only = yes
	immediate = { set_country_flag = shroud_diplomacy_engaged }
	after = { hidden_effect = { remove_country_flag = shroud_diplomacy_engaged } }
	option = {
		name = "ag_zeta_psionics.1070.a"
		custom_tooltip = "shroud.unknown.chances.medium"
		hidden_effect = {
			reroll_random = yes
			random_list = {
				60 = { country_event = { id = ag_zeta_psionics.1071 } }
				40 = {
					modifier = { factor = 0.5 has_relic = r_zro_crystal }
					country_event = { id = ag_zeta_psionics.1072 }
				}
			}
		}
	}
	option = {
		name = "exit.shroud"
		custom_tooltip = "exit.shroud.tooltip"
		default_hide_option = yes
	}
}
# Success
country_event = {
	id = ag_zeta_psionics.1071
	title = "ag_zeta_psionics.1071.name"
	desc = "ag_zeta_psionics.1071.desc"
	diplomatic = yes
	diplomatic_title = BLANK_STRING
	force_open = yes
	picture_event_data = { portrait = shroud1 room = ag_excited_shroud_room }
	is_triggered_only = yes
	immediate = { set_country_flag = shroud_diplomacy_engaged }
	after = { hidden_effect = {
		remove_country_flag = shroud_diplomacy_engaged
		set_timed_country_flag = { flag = positive_shroud_outcome days = 1800 }
	} }
	option = {
		name = "exit.shroud"
		ag_add_research_option = { ag_tech = tech_ag_shroud_power_core }
		default_hide_option = yes
	}
}
# Failure
country_event = {
	id = ag_zeta_psionics.1072
	title = "curse.bestowed"
	desc = "ag_zeta_psionics.1072.desc"
	diplomatic = yes
	diplomatic_title = BLANK_STRING
	force_open = yes
	picture_event_data = { portrait = shroud1 room = ag_excited_shroud_room }
	is_triggered_only = yes
	immediate = { set_country_flag = shroud_diplomacy_engaged }
	after = { hidden_effect = {
		remove_country_flag = shroud_diplomacy_engaged
		set_timed_country_flag = { flag = negative_shroud_outcome days = 1800 }
	} }
	option = {
		name = "exit.shroud"
		default_hide_option = yes
		ag_add_shroud_negative_modifier = { ag_modifier = "shroud_neg_research" }
	}
}

# Psionic Weapon Boost
country_event = {
	id = ag_zeta_psionics.1073
	title = "ag_zeta_psionics.1000.name"
	desc = "ag_zeta_psionics.1073.desc"
	diplomatic = yes
	diplomatic_title = BLANK_STRING
	force_open = yes
	picture_event_data = { portrait = shroud1 room = ag_excited_shroud_room }
	is_triggered_only = yes
	immediate = { set_country_flag = shroud_diplomacy_engaged }
	after = { hidden_effect = { remove_country_flag = shroud_diplomacy_engaged } }
	option = {
		name = "ag_zeta_psionics.1073.a"
		custom_tooltip = "shroud.unknown.chances.medium"
		hidden_effect = {
			reroll_random = yes
			random_list = {
				60 = { country_event = { id = ag_zeta_psionics.1074 } }
				40 = {
					modifier = { factor = 0.5 has_relic = r_zro_crystal }
					country_event = { id = ag_zeta_psionics.1075 }
				}
			}
		}
	}
	option = {
		name = "exit.shroud"
		custom_tooltip = "exit.shroud.tooltip"
		default_hide_option = yes
	}
}
# Success
country_event = {
	id = ag_zeta_psionics.1074
	title = "ag_zeta_psionics.1074.name"
	desc = "ag_zeta_psionics.1074.desc"
	diplomatic = yes
	diplomatic_title = BLANK_STRING
	force_open = yes
	picture_event_data = { portrait = shroud1 room = ag_excited_shroud_room }
	is_triggered_only = yes
	immediate = { set_country_flag = shroud_diplomacy_engaged }
	after = { hidden_effect = {
		remove_country_flag = shroud_diplomacy_engaged
		set_timed_country_flag = { flag = positive_shroud_outcome days = 1800 }
	} }
	option = {
		name = "exit.shroud"
		ag_add_research_option = { ag_tech = tech_ag_shroud_weapon_buff }
		default_hide_option = yes
	}
}
# Failure
country_event = {
	id = ag_zeta_psionics.1075
	title = "curse.bestowed"
	desc = "ag_zeta_psionics.1075.desc"
	diplomatic = yes
	diplomatic_title = BLANK_STRING
	force_open = yes
	picture_event_data = { portrait = shroud1 room = ag_excited_shroud_room }
	is_triggered_only = yes
	immediate = { set_country_flag = shroud_diplomacy_engaged }
	after = { hidden_effect = {
		remove_country_flag = shroud_diplomacy_engaged
		set_timed_country_flag = { flag = negative_shroud_outcome days = 1800 }
	} }
	option = {
		name = "exit.shroud"
		default_hide_option = yes
		ag_add_shroud_negative_modifier = { ag_modifier = "shroud_neg_unity" }
	}
}

# Psionic Ships
country_event = {
	id = ag_zeta_psionics.1080
	title = "ag_zeta_psionics.1000.name"
	desc = "ag_zeta_psionics.1080.desc"
	diplomatic = yes
	diplomatic_title = BLANK_STRING
	force_open = yes
	picture_event_data = { portrait = shroud1 room = ag_excited_shroud_room }
	is_triggered_only = yes
	immediate = { set_country_flag = shroud_diplomacy_engaged }
	after = { hidden_effect = { remove_country_flag = shroud_diplomacy_engaged } }
	option = {
		name = "ag_zeta_psionics.1080.a"
		custom_tooltip = "shroud.unknown.chances.medium"
		hidden_effect = {
			reroll_random = yes
			random_list = {
				60 = { country_event = { id = ag_zeta_psionics.1081 } }
				40 = {
					modifier = { factor = 0.5 has_relic = r_zro_crystal }
					country_event = { id = ag_zeta_psionics.1082 }
				}
			}
		}
	}
	option = {
		name = "exit.shroud"
		custom_tooltip = "exit.shroud.tooltip"
		default_hide_option = yes
	}
}
# Success
country_event = {
	id = ag_zeta_psionics.1081
	title = "ag_zeta_psionics.1081.name"
	desc = "ag_zeta_psionics.1081.desc"
	diplomatic = yes
	diplomatic_title = BLANK_STRING
	force_open = yes
	picture_event_data = { portrait = shroud1 room = ag_excited_shroud_room }
	is_triggered_only = yes
	immediate = { set_country_flag = shroud_diplomacy_engaged }
	after = { hidden_effect = {
		remove_country_flag = shroud_diplomacy_engaged
		set_timed_country_flag = { flag = positive_shroud_outcome days = 1800 }
	} }
	option = {
		name = "exit.shroud"
		ag_add_research_option = { ag_tech = tech_ag_ancient_psionic_ship }
		default_hide_option = yes
	}
}
# Failure
country_event = {
	id = ag_zeta_psionics.1082
	title = "curse.bestowed"
	desc = "ag_zeta_psionics.1082.desc"
	diplomatic = yes
	diplomatic_title = BLANK_STRING
	force_open = yes
	picture_event_data = { portrait = shroud1 room = ag_excited_shroud_room }
	is_triggered_only = yes
	immediate = {
		set_country_flag = shroud_diplomacy_engaged
		random_owned_leader = {
			limit = { is_ruler = no is_event_leader = no }
			save_event_target_as = ag_target_leader
		}
		if = {
			limit = { NOT = { exists = event_target:ag_target_leader } }
			random_owned_leader = {
				limit = { is_event_leader = no }
				save_event_target_as = ag_target_leader
			}
			if = {
				limit = { NOT = { exists = event_target:ag_target_leader } }
				random_owned_leader = { save_event_target_as = ag_target_leader }
			}
		}
	}
	after = { hidden_effect = {
		remove_country_flag = shroud_diplomacy_engaged
		set_timed_country_flag = { flag = negative_shroud_outcome days = 1800 }
	} }
	option = {
		name = "exit.shroud"
		default_hide_option = yes
		event_target:ag_target_leader = { ag_kill_leader = yes }
	}
}

# Psionic Weapons.
country_event = {
	id = ag_zeta_psionics.1083
	title = "ag_zeta_psionics.1083.name"
	desc = "ag_zeta_psionics.1083.desc"
	diplomatic = yes
	diplomatic_title = BLANK_STRING
	force_open = yes
	picture_event_data = { portrait = shroud1 room = ag_excited_shroud_room }
	is_triggered_only = yes
	immediate = { set_country_flag = shroud_diplomacy_engaged }
	after = { hidden_effect = { remove_country_flag = shroud_diplomacy_engaged } }
	option = {
		name = "ag_zeta_psionics.1083.a"
		custom_tooltip = "shroud.unknown.chances.medium"
		hidden_effect = {
			reroll_random = yes
			random_list = {
				60 = { country_event = { id = ag_zeta_psionics.1084 } }
				40 = {
					modifier = { factor = 0.5 has_relic = r_zro_crystal }
					country_event = { id = ag_zeta_psionics.1085 }
				}
			}
		}
	}
	option = {
		name = "exit.shroud"
		custom_tooltip = "exit.shroud.tooltip"
		default_hide_option = yes
	}
}
# Success
country_event = {
	id = ag_zeta_psionics.1084
	title = "ag_zeta_psionics.1084.name"
	desc = "ag_zeta_psionics.1084.desc"
	diplomatic = yes
	diplomatic_title = BLANK_STRING
	force_open = yes
	picture_event_data = { portrait = shroud1 room = ag_excited_shroud_room }
	is_triggered_only = yes
	immediate = { set_country_flag = shroud_diplomacy_engaged }
	after = { hidden_effect = {
		remove_country_flag = shroud_diplomacy_engaged
		set_timed_country_flag = { flag = positive_shroud_outcome days = 1800 }
	} }
	option = {
		name = "exit.shroud"
		ag_add_research_option = { ag_tech = tech_ag_ancient_extradimensional_weapon }
		default_hide_option = yes
	}
}
# Failure
country_event = {
	id = ag_zeta_psionics.1085
	title = "curse.bestowed"
	desc = "ag_zeta_psionics.1085.desc"
	diplomatic = yes
	diplomatic_title = BLANK_STRING
	force_open = yes
	picture_event_data = { portrait = shroud1 room = ag_excited_shroud_room }
	is_triggered_only = yes
	immediate = { set_country_flag = shroud_diplomacy_engaged }
	after = { hidden_effect = {
		remove_country_flag = shroud_diplomacy_engaged
		set_timed_country_flag = { flag = negative_shroud_outcome days = 1800 }
	} }
	option = {
		name = "exit.shroud"
		default_hide_option = yes
		random_owned_planet = {
			limit = { num_pops > 0 }
			locked_random_list = {
				10 = { random_owned_pop = { kill_pop = yes } }
				10 = { while = { count = 2 random_owned_pop = { kill_pop = yes } } }
				10 = { while = { count = 3 random_owned_pop = { kill_pop = yes } } }
				10 = { while = { count = 4 random_owned_pop = { kill_pop = yes } } }
				10 = { while = { count = 5 random_owned_pop = { kill_pop = yes } } }
			}
		}
	}
}
