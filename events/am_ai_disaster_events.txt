namespace = aidisasters

event = {
	id = aidisasters.1
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {	
		if = {
			limit = { 
				years_passed > 100 
			}
			every_country = {
				limit = {
					is_ai = yes
					is_regular_empire = yes
					is_country_type = default
					num_owned_planets > 9
				}
				random_owned_planet = {
					limit = { 
						num_pops > 84
					}	
					if = {
						limit = {
							not = { has_modifier = galactic_exodus_urge }
							nor = {
								has_modifier = environmental_collapse_begun
								has_modifier = environmental_collapse_accelerating
								has_modifier = environmental_collapse_deadline
								has_modifier = core_meltdown_begun
								has_modifier = core_meltdown_accelerating
								has_modifier = core_meltdown_deadline
							}
							num_pops > 84
						}
						random_list = {
							15 = {
								add_modifier = {
									modifier = galactic_exodus_urge
									days = 720
								}
							}
							10 = {
								add_modifier = {
									modifier = galactic_exodus_urge
									days = 1800
								}						
							}
							5 = {
								add_modifier = {
									modifier = galactic_exodus_urge
									days = 3600
								}						
							}
							70 = {}						
						}
					}
					if = {
						limit = {
							has_modifier = galactic_exodus_urge
							num_pops > 90
						}
						while = {
							limit = { num_pops > 90 }
							random_owned_pop = {
								kill_pop = yes
							}
						}
					}
					
					if = {
						limit = {
							has_modifier = environmental_collapse_deadline
							num_pops > 90
						}
						random_list = {
							85 = {}
							15 = {
								remove_modifier = environmental_collapse_deadline
								every_owned_pop = {
									kill_pop = yes
								}
								remove_all_buildings = yes
								if = {
									limit = {
										or = {
											is_planet_class = pc_gaia
											is_planet_class = pc_tropical
											is_planet_class = pc_savannah
											is_planet_class = pc_alpine
											is_planet_class = pc_continental
										}
									}
									change_pc = pc_toxic
									clear_deposits = yes								
								}
								if = {
									limit = {
										or = {
											is_planet_class = pc_desert
											is_planet_class = pc_arid
										}
									}
									change_pc = pc_barren
									clear_deposits = yes								
								}
								if = {
									limit = {
										or = {
											is_planet_class = pc_ocean
											is_planet_class = pc_arctic
											is_planet_class = pc_tundra
										}
									}
									random_list = {
										50 = {
											change_pc = pc_barren_cold
										}
										50 = {
											change_pc = pc_frozen
										}
									}
									clear_deposits = yes								
								}							
							}
						}
					}
					else_if = {
						limit = {
							has_modifier = core_meltdown_deadline
							num_pops > 90
						}
						random_list = {
							90 = {}
							10 = {
								remove_modifier = core_meltdown_deadline
								every_owned_pop = {
									kill_pop = yes
								}
								remove_all_buildings = yes
								change_pc = pc_shattered
								clear_deposits = yes
								random_list = {
									1 = {
										add_deposit = d_minerals_4
										add_deposit = d_minerals_4
										add_deposit = d_minerals_4
										add_deposit = d_minerals_4
									}
									1 = {
										add_deposit = d_minerals_4
										add_deposit = d_minerals_4
										add_deposit = d_minerals_4
									}
									1 = {
										add_deposit = d_minerals_4
										add_deposit = d_minerals_4
									}
									1 = {
										add_deposit = d_minerals_4
									}
								}							
							}
						}
					}
					
					if = {
						limit = { 
							has_modifier = environmental_collapse_accelerating
							num_pops > 87
						}
						random_list = {
							90 = {}
							10 = {
								remove_modifier = environmental_collapse_accelerating
								add_modifier = {
									modifier = environmental_collapse_deadline
									days = -1
								}
							}
						}
					}
					else_if = {
						limit = { 
							has_modifier = core_meltdown_accelerating
							num_pops > 87
						}
						random_list = {
							90 = {}
							10 = {
								remove_modifier = core_meltdown_accelerating
								add_modifier = {
									modifier = core_meltdown_deadline
									days = -1
								}
							}
						}
					}				

					if = {
						limit = { 
							has_modifier = environmental_collapse_begun
							num_pops > 85
						}
						random_list = {
							75 = {}
							25 = {
								remove_modifier = environmental_collapse_begun
								add_modifier = {
									modifier = environmental_collapse_accelerating
									days = -1
								}
							}
						}
					}
					else_if = {
						limit = { 
							has_modifier = core_meltdown_begun
							num_pops > 85
						}
						random_list = {
							75 = {}
							25 = {
								remove_modifier = core_meltdown_begun
								add_modifier = {
									modifier = core_meltdown_accelerating
									days = -1
								}
							}
						}
					}

					if = {
						limit = {
							mid_game_years_passed >= 0
							num_pops > 85
							nor = {
								has_modifier = environmental_collapse_begun
								has_modifier = environmental_collapse_accelerating
								has_modifier = environmental_collapse_deadline
								has_modifier = core_meltdown_begun
								has_modifier = core_meltdown_accelerating
								has_modifier = core_meltdown_deadline
								has_modifier = galactic_exodus_urge
							}
							not = { is_planet_class = pc_habitat }
							not = { is_planet_class = pc_ringworld_habitable }
							not = { is_planet_class = pc_city }
							not = { is_planet_class = pc_relic }
							not = { is_planet_class = pc_gas_giant_habitable }
							not = { is_planet_class = pc_frozen_habitable }
							not = { is_planet_class = pc_molten_habitable }
							not = { is_planet_class = pc_asteroid_habitable }
							not = { is_planet_class = pc_ice_asteroid_habitable }
							not = { is_planet_class = pc_toxic_habitable }
							not = { is_planet_class = pc_barren_habitable }
							not = { is_planet_class = pc_nuked }
						}
						random_list = {
							15 = {
								add_modifier = {
									modifier = environmental_collapse_begun
									days = -1
								}
							}
							5 = {
								add_modifier = {
									modifier = core_meltdown_begun
									days = -1
								}
							}
							80 = {}
						}
					}
					else_if = {
						limit = {
							num_pops > 90
							nor = {
								has_modifier = environmental_collapse_begun
								has_modifier = environmental_collapse_accelerating
								has_modifier = environmental_collapse_deadline
								has_modifier = core_meltdown_begun
								has_modifier = core_meltdown_accelerating
								has_modifier = core_meltdown_deadline
								has_modifier = galactic_exodus_urge
							}
							not = { is_planet_class = pc_habitat }
							not = { is_planet_class = pc_ringworld_habitable }
							not = { is_planet_class = pc_city }
							not = { is_planet_class = pc_relic }
							not = { is_planet_class = pc_gas_giant_habitable }
							not = { is_planet_class = pc_frozen_habitable }
							not = { is_planet_class = pc_molten_habitable }
							not = { is_planet_class = pc_asteroid_habitable }
							not = { is_planet_class = pc_ice_asteroid_habitable }
							not = { is_planet_class = pc_toxic_habitable }
							not = { is_planet_class = pc_barren_habitable }
							not = { is_planet_class = pc_nuked }
						}
						random_list = {
							20 = {
								add_modifier = {
									modifier = environmental_collapse_begun
									days = -1
								}
							}
							10 = {
								add_modifier = {
									modifier = core_meltdown_begun
									days = -1
								}
							}
							70 = {}
						}
					}
				}
			}
		}
	}
}