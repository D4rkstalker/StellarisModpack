namespace = insecticon_hive_planet

#Turns Planet into a Tomb World
planet_event = {
	id = insecticon_hive_planet.0
	hide_window = yes

	is_triggered_only = yes

	trigger = {
		planet_devastation >= 100
		is_planet_class = pc_insecticon_hive
	}

	immediate = {
		remove_modifier = insecticon_hive_stage_1
		remove_modifier = insecticon_hive_stage_2
		remove_modifier = insecticon_hive_stage_3
		remove_planet_flag = insecticon_hive_stage_1
		remove_planet_flag = insecticon_hive_stage_2
		remove_planet_flag = insecticon_hive_stage_3
		destroy_colony = yes
		random_list = {
			50 = { change_pc = pc_barren }
			50 = { change_pc = pc_barren_cold }
		}
		reset_planet = yes
		add_modifier = { modifier = "terraforming_candidate" days = -1 }
	}
}

###Truns a newly colonized Planet into a Infested World
planet_event = {
	id = insecticon_hive_planet.1
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		habitable_structure = no
		owner = {
			has_origin = origin_insecticon_hive
		}
		NOR = {
			is_planet_class = pc_insecticon_hive
			is_planet_class = pc_city
			is_planet_class = pc_relic
			is_planet_class = pc_habitat
			is_planet_class = pc_ringworld_habitable
		}
		NOR = {
			has_planet_flag = insecticon_hive_stage_1
			has_planet_flag = insecticon_hive_stage_2
			has_planet_flag = insecticon_hive_stage_3
		}
	}

	immediate = {
		set_planet_flag = insecticon_hive_stage_1
		change_pc = pc_insecticon_hive
		set_planet_entity = {
			entity = "infested_planet_01_entity"
		}
		clear_deposits = yes
		add_modifier = {
			modifier = insecticon_hive_stage_1
			days = -1
		}
		add_deposit = d_insecticon_hive
	}
}	

###Adds "No insecticon" Modifier to a Planet
planet_event = {
	id = insecticon_hive_planet.2
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		habitable_structure = no
		is_colony = yes
		owner = {
			has_origin = origin_insecticon_hive
		}
		NOT = {
			is_planet_class = pc_insecticon_hive
		}
		NOR = {
			has_planet_flag = insecticon_hive_stage_1
			has_planet_flag = insecticon_hive_stage_2
			has_planet_flag = insecticon_hive_stage_3
		}
	}

	immediate = {
		add_modifier = {
			modifier = insecticon_hive_stage_0
			days = -1
		}
	}
}

###Removes "No insecticon" Modifier on a Planet that is not owned by a insecticon Hive
planet_event = {
	id = insecticon_hive_planet.3
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		habitable_structure = no
		is_colony = yes
		NOT = {
			owner = {
				has_origin = origin_insecticon_hive
			}
		}
	}

	immediate = {
		remove_modifier = insecticon_hive_stage_0
	}
}

###Adds a Pop to a conquered Planet
planet_event = {
	id = insecticon_hive_planet.4
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		is_colony = yes
		owner = {
			has_origin = origin_insecticon_hive
		}
		NOT = {
			is_planet_class = pc_insecticon_hive
		}
	}

	immediate = {
		create_pop = { species = owner_main_species }
		create_pop = { species = owner_main_species }
	}
}


# Colony Consumed
country_event = {
	id = insecticon_hive_planet.185
	title = "insecticon_hive_planet.185.name"
	desc = "insecticon_hive_planet.185.desc"

	is_triggered_only = yes

	show_sound = event_screams

	trigger = {
		owner = {
			has_valid_civic = civic_insecticon_hive
		}

		from = {
			num_free_districts = { type = any value <= 0 }
		}
	}

	picture = GFX_evt_cold_barren

	immediate = {
		from = {
			every_owned_pop = {
				resettle_pop = {
					pop = this
					planet = owner.capital_scope
				}
			}

			change_pc = pc_barren_cold
			clear_deposits = yes
		}
	}

	option = {
		name = insecticon_hive_planet.185.a
		custom_tooltip = insecticon_hive_planet.185.a.tooltip
		if = {
			limit = {
				has_ascension_perk = ap_become_the_crisis
			}
			complete_crisis_objective = crisobj_destroy_worlds
		}
	}
}