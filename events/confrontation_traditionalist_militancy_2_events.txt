namespace = confrontations_traditionalist_militancy_furious

pop_faction_event = {
    id = confrontations_traditionalist_militancy_furious.1
    hide_window = yes

    is_triggered_only = yes

    immediate = {
        random_list = {
            25 = {
                # Ruler assassination
                pop_faction_event = { id = confrontations_traditionalist_militancy_furious.2 }
            }
            25 = {
                # Faction assassinated non government faction
                pop_faction_event = { id = confrontations_traditionalist_militancy_furious.3 }
            }
            25 = {
                # Use an upset event
                pop_faction_event = { id = confrontations_traditionalist_militancy_upset.1 }
            }
            25 = {
                # Use a peaceful event
                pop_faction_event = { id = confrontations_traditionalist_militancy_peaceful.1 }
            }
        }
    }
}

# Ruler assassination
pop_faction_event = {
    id = confrontations_traditionalist_militancy_furious.2
    title = confrontations_traditionalist_militancy_furious.2
    desc = confrontations_traditionalist_militancy_furious.2.desc
    hide_window = no

    is_triggered_only = yes

    picture = GFX_evt_crisis_declared
    show_sound = event_super_explosion

    trigger = {
        owner = {
            count_owned_leader = {
                limit = {
                    leader_class = ruler
                }
                count > 0
            }
        }
    }

    immediate = {
        owner = { country_event = { id = confrontations_traditionalist.2 } }
    }

    option = {
        name = confrontations_traditionalist_militancy_furious.2.a

        owner = {
            add_resource = {
                ideological_purity_current_value = -25
                traditionalist_militancy_current_value = 10
                traditionalist_support = 10
            }

            add_modifier = {
                modifier = traditionalist_ruler_assassination_continue_modifier
                years = 3
            }

            # Kill ruler
            kill_leader = {
                type = ruler
                show_notification = yes
            }
        }
    }
}

# Faction assassinated non government faction
pop_faction_event = {
    id = confrontations_traditionalist_militancy_furious.3
    title = confrontations_traditionalist_militancy_furious.3
    desc = confrontations_traditionalist_militancy_furious.3.desc
    hide_window = no

    is_triggered_only = yes

    picture = GFX_evt_space_funeral
    show_sound = event_super_explosion

    trigger = {
        # Is there a non government faction that is not the same as root
        # This is faction infighting
        owner = {
            count_pop_faction = {
                limit = {
                    NOT = {
                        is_same_value = root
                    }
                    NOR = {
                        is_pop_faction_type = gov_imperialist
                        is_pop_faction_type = gov_supremacist
                        is_pop_faction_type = gov_progressive
                        is_pop_faction_type = gov_technologist
                        is_pop_faction_type = gov_prosperity
                        is_pop_faction_type = gov_xenoist
                        is_pop_faction_type = gov_totalitarian
                        is_pop_faction_type = gov_traditionalist
                    }
                    owner = {
                        count_owned_leader = {
                            limit = {
                                leader_of_faction = prevprev
                                NOT = {
                                    leader_class = ruler
                                }
                            }

                            count = 1
                        }
                    }
                }
                count > 0
            }
        }
    }

    immediate = {
        owner = {
            random_pop_faction = {
                limit = {
                    NOT = {
                        is_same_value = root
                    }
                    NOR = {
                        is_pop_faction_type = gov_imperialist
                        is_pop_faction_type = gov_supremacist
                        is_pop_faction_type = gov_progressive
                        is_pop_faction_type = gov_technologist
                        is_pop_faction_type = gov_prosperity
                        is_pop_faction_type = gov_xenoist
                        is_pop_faction_type = gov_totalitarian
                        is_pop_faction_type = gov_traditionalist
                    }
                    owner = {
                        count_owned_leader = {
                            limit = {
                                NOT = {
                                    leader_class = ruler
                                }
                                leader_of_faction = prevprev
                            }
                            count = 1
                        }
                    }
                }
                weights = {
                    base = 1
                    modifier = {
                        add = 1
                        is_pop_faction_type = technologist
                    }
                    modifier = {
                        add = 3
                        is_pop_faction_type = technologist_radicals
                    }
                }
                save_event_target_as = assassinated_leader_faction

                owner = {
                    every_owned_leader = {
                        limit = {
                            leader_of_faction = event_target:assassinated_leader_faction
                        }
                        save_event_target_as = assassinated_faction_leader
                    }
                }
            }
            owner = { country_event = { id = confrontations_traditionalist.2 } }
        }

        event_target:assassinated_faction_leader = {
            kill_leader = {
                show_notification = yes
            }
        }
    }

    option = {
        name = confrontations_traditionalist_militancy_furious.3.a

        owner = {
            add_resource = {
                ideological_purity_current_value = -25
            }
            if = {
                limit = {
                    event_target:assassinated_leader_faction = {
                        OR = {
                            is_pop_faction_type = imperialist
                            is_pop_faction_type = imperialist_radicals
                        }
                    }
                }
                add_resource = {
                    imperialist_militancy_current_value = 10
                    imperialist_support = 100
                }
                add_modifier = {
                    modifier = imperialist_faction_leader_assassination_continue_modifier
                    years = 3
                }
            }
            else_if = {
                limit = {
                    event_target:assassinated_leader_faction = {
                        OR = {
                            is_pop_faction_type = supremacist
                            is_pop_faction_type = supremacist_radicals
                        }
                    }
                }
                add_resource = {
                    supremacist_militancy_current_value = 10
                    supremacist_support = 100
                }
                add_modifier = {
                    modifier = supremacist_faction_leader_assassination_continue_modifier
                    years = 3
                }
            }
            else_if = {
                limit = {
                    event_target:assassinated_leader_faction = {
                        OR = {
                            is_pop_faction_type = progressive
                            is_pop_faction_type = progressive_radicals
                        }
                    }
                }
                add_resource = {
                    progressive_militancy_current_value = 10
                    progressive_support = 100
                }
                add_modifier = {
                    modifier = progressive_faction_leader_assassination_continue_modifier
                    years = 3
                }
            }
            else_if = {
                limit = {
                    event_target:assassinated_leader_faction = {
                        OR = {
                            is_pop_faction_type = technologist
                            is_pop_faction_type = technologist_radicals
                        }
                    }
                }
                add_resource = {
                    technologist_militancy_current_value = 10
                    technologist_support = 100
                }
                add_modifier = {
                    modifier = technologist_faction_leader_assassination_continue_modifier
                    years = 3
                }
            }
            else_if = {
                limit = {
                    event_target:assassinated_leader_faction = {
                        OR = {
                            is_pop_faction_type = prosperity
                            is_pop_faction_type = prosperity_radicals
                        }
                    }
                }
                add_resource = {
                    prosperity_militancy_current_value = 10
                    prosperity_support = 100
                }
                add_modifier = {
                    modifier = prosperity_faction_leader_assassination_continue_modifier
                    years = 3
                }
            }
            else_if = {
                limit = {
                    event_target:assassinated_leader_faction = {
                        OR = {
                            is_pop_faction_type = xenoist
                            is_pop_faction_type = xenoist_radicals
                        }
                    }
                }
                add_resource = {
                    xenoist_militancy_current_value = 10
                    xenoist_support = 100
                }
                add_modifier = {
                    modifier = xenoist_faction_leader_assassination_continue_modifier
                    years = 3
                }
            }
            else_if = {
                limit = {
                    event_target:assassinated_leader_faction = {
                        OR = {
                            is_pop_faction_type = totalitarian
                            is_pop_faction_type = totalitarian_radicals
                        }
                    }
                }
                add_resource = {
                    totalitarian_militancy_current_value = 10
                    totalitarian_support = 100
                }
                add_modifier = {
                    modifier = totalitarian_faction_leader_assassination_continue_modifier
                    years = 3
                }
            }
            else_if = {
                limit = {
                    event_target:assassinated_leader_faction = {
                        OR = {
                            is_pop_faction_type = traditionalist
                            is_pop_faction_type = traditionalist_radicals
                        }
                    }
                }
                add_resource = {
                    traditionalist_militancy_current_value = 10
                    traditionalist_support = 100
                }
                add_modifier = {
                    modifier = traditionalist_faction_leader_assassination_continue_modifier
                    years = 3
                }
            }
        }
    }
}