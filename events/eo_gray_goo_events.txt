namespace = eo_gray_goo

planet_event = {
	id = eo_gray_goo.1
	hide_window = yes

	is_triggered_only = yes

	trigger = {
		is_planet_class = pc_gray_goo
		has_planet_flag = gray_goo_harvest_world
	}

	immediate = {
		if = {
			limit = {
				NOT = { has_deposit = d_gray_goo_resources }
				from = {
					has_origin = origin_gray_goo
				}
			}
			remove_deposit = d_nanites_deposit
			add_deposit = d_gray_goo_resources
		}
		if = {
			limit = {
				NOT = { has_deposit = d_nanites_deposit }
				from = {
					NOT = { has_origin = origin_gray_goo }
				}
			}
			remove_deposit = d_gray_goo_resources
			add_deposit = d_nanites_deposit
		}
	}
}

country_event = {
	id = eo_gray_goo.2
	title = eo_gray_goo.2.name
	desc = eo_gray_goo.2.desc
	picture = GFX_evt_gray_goo
	location = event_target:gray_gooed_planet

	is_triggered_only = yes

	option = {
		name = eo_exofungus.14.a
		add_monthly_resource_mult = {
			resource = energy
			value = @tier4materialreward
			min = @tier4materialmin
			max = @tier4materialmax
		}
		add_monthly_resource_mult = {
			resource = minerals
			value = @tier4materialreward
			min = @tier4materialmin
			max = @tier4materialmax
		}
		add_monthly_resource_mult = {
			resource = food
			value = @tier4materialreward
			min = @tier4materialmin
			max = @tier4materialmax
		}
	}
}

planet_event = {
	id = eo_gray_goo.3
	hide_window = yes

	is_triggered_only = yes

	trigger = {
		has_orbital_bombardment_stance = nanomachine
	}
	
	immediate = {
		save_event_target_as = bombarded_planet
		from = {
			add_resource = {
				energy = 150
			}
			create_message = {
				type = MESSAGE_GRAY_GOO_POP_BOMBED
				localization = MESSAGE_GRAY_GOO_POP_BOMBED_DESC
				days = 20
				target = event_target:bombarded_planet
				variable = {
					type = name
					localization = PLANET
					scope = event_target:bombarded_planet
				}
			}
		}
	}
}

planet_event = {
	id = eo_gray_goo.4
	hide_window = yes

	is_triggered_only = yes

	trigger = {
		has_orbital_bombardment_stance = nanomachine
	}
	
	immediate = {
		change_pc = pc_gray_goo
		clear_deposits = yes
		clear_blockers = yes
		set_planet_flag = gray_goo_harvest_world
		if = {
			limit = {
				space_owner = {
					has_origin = origin_gray_goo
				}
			}
			add_deposit = d_gray_goo_resources
		}
		else = {
			add_deposit = d_nanites_deposit
		}
	}
}