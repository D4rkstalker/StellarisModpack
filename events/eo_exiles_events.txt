namespace = eo_exiles

ship_event = {
	id = eo_exiles.1
	hide_window = yes

	is_triggered_only = yes

	trigger = {
		is_ship_size = exile_ark_colonizer
		owner = {
			has_origin = origin_exiles
		}
	}

	immediate = {
		set_timed_ship_flag = {
			flag = recently_constructed_ark_ship
			years = 5
		}
	}
}

planet_event = {
	id = eo_exiles.2
	hide_window = yes

	is_triggered_only = yes

	trigger = {
		exists = FROM
		FROM = { is_ship_size = exile_ark_colonizer }
	}

	immediate = {
		set_planet_flag = exiles_ark_colonized
	}
}

planet_event = {
	id = eo_exiles.3
	hide_window = yes

	is_triggered_only = yes

	trigger = {
		has_planet_flag = exiles_ark_colonized
	}

	immediate = {
		random_owned_pop = {
			root = {
				while = {
					count = 2
					create_pop = {
						species = prev
						ethos = prev.owner
					}
				}
			}
		}
	}
}

planet_event = {
	id = eo_exiles.4
	hide_window = yes

	is_triggered_only = yes

	trigger = {
		has_planet_flag = exiles_ark_colonized
		exists = FROM
		FROM = { NOT = { is_ship_size = exile_ark_colonizer} }
	}

	immediate = {
		remove_planet_flag = exiles_ark_colonized
	}
}

planet_event = {
	id = eo_exiles.5
	title = eo_exiles.5.name
	desc = {
		trigger = {
			exiles_future_uncertain = no
		}
		text = eo_exiles.5.desc
	}
	desc = {
		trigger = {
			exiles_future_uncertain = yes
		}
		text = eo_exiles.5.desc.uncertain
	}
	picture = {
		trigger = {
			exiles_future_uncertain = no
		}
		picture = GFX_evt_crisis_defeated
	}
	picture = {
		trigger = {
			exiles_future_uncertain = yes
		}
		picture = GFX_evt_alien_propaganda
	}
	show_sound = {
		trigger = {
			exiles_future_uncertain = no
		}
		sound = event_celebration
	}
	show_sound = {
		trigger = {
			exiles_future_uncertain = yes
		}
		sound = event_conversation
	}
	location = this

	is_triggered_only = yes

	trigger = {
		from = {
			has_origin = origin_exiles
			NOT = { has_country_flag = exiles_future_ensured }
			count_owned_pop = {
				limit = { is_same_species = from }
				count >= 25
			}
		}
		fromfrom = {
			is_same_species = from
		}
	}

	option = {
		name = {
			trigger = {
				exiles_future_uncertain = no
			}
			text = eo_exiles.5.a
		}
		name = {
			trigger = {
				exiles_future_uncertain = yes
			}
			text = eo_exiles.5.a.uncertain
		}
		owner = {
			set_country_flag = exiles_future_ensured
			add_monthly_resource_mult = {
				resource = unity
				value = 60
			}
		}
	}
}

planet_event = {
	id = eo_exiles.7
	hide_window = yes

	is_triggered_only = yes

	trigger = {
		owner = {
			has_origin = origin_exiles
			num_owned_planets = 2
		}
		any_owned_pop = {
			is_same_species = owner
		}
	}

	immediate = {
		planet_event = { id = eo_exiles.6 days = 90 }
	}
}

planet_event = {
	id = eo_exiles.6
	title = eo_exiles.6.name
	desc = {
		trigger = {
			owner = {
				is_machine_empire = no
				is_hive_empire = no
			}
		}
		text = eo_exiles.6.desc.normal
	}
	desc = {
		trigger = {
			owner = {
				is_hive_empire = yes
			}
		}
		text = eo_exiles.6.desc.hive
	}
	desc = {
		trigger = {
			owner = {
				is_machine_empire = yes
			}
		}
		text = eo_exiles.6.desc.machine
	}
	picture = GFX_evt_colony_settlement
	location = this

	is_triggered_only = yes

	option = { # Generator district
		name = {
			trigger = {
				owner = {
					is_machine_empire = no
					is_hive_empire = no
				}
			}
			text = eo_exiles.6.a.normal
		}
		name = {
			trigger = {
				owner = { is_hive_empire = yes }
			}
			text = eo_exiles.6.a.hive
		}
		name = {
			trigger = {
				owner = { is_machine_empire = yes }
			}
			text = eo_exiles.6.a.machine
		}
		trigger = {
			num_free_districts = { type = district_generator value > 0 }
		}
		add_district = district_generator
		ai_chance = {
			factor = 100
			modifier = {
				factor = 2
				owner = { resource_stockpile_compare = { resource = energy value < 1 } }
			}
			modifier = {
				factor = 1.5
				owner = {
					resource_stockpile_compare = { resource = energy value < 100 }
					has_monthly_income = { resource = energy value < 0 }
				}
			}
			modifier = {
				factor = 1.5
				owner = {
					is_at_war = yes
					has_deficit = energy
				}
			}
			modifier = {
				factor = 1.25
				owner = { is_machine_empire = yes }
			}
		}
	}
	option = { # Agri district
		name = {
			trigger = {
				owner = {
					is_machine_empire = no
					is_hive_empire = no
				}
			}
			text = eo_exiles.6.b.normal
		}
		name = {
			trigger = {
				owner = { is_hive_empire = yes }
			}
			text = eo_exiles.6.b.hive
		}
		name = {
			trigger = {
				owner = { is_machine_empire = yes }
			}
			text = eo_exiles.6.b.machine
		}
		trigger = {
			num_free_districts = { type = district_farming value > 0 }
		}
		add_district = district_farming
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				owner = { country_uses_food = no }
			}
			modifier = {
				factor = 2
				owner = {
					country_uses_food = yes
					resource_stockpile_compare = { resource = food value < 1 }
				}
			}
			modifier = {
				factor = 1.5
				owner = {
					country_uses_food = yes
					resource_stockpile_compare = { resource = food value < 100 }
					has_monthly_income = { resource = food value < 0 }
				}
			}
			modifier = {
				factor = 1.5
				owner = {
					country_uses_food = yes
					has_deficit = food
					any_situation = {
						is_situation_type = situation_planetary_revolt
					}
				}
			}
		}
	}
	option = { # Mining district
		name = {
			trigger = {
				owner = {
					is_machine_empire = no
					is_hive_empire = no
				}
			}
			text = eo_exiles.6.c.normal
		}
		name = {
			trigger = {
				owner = { is_hive_empire = yes }
			}
			text = eo_exiles.6.c.hive
		}
		name = {
			trigger = {
				owner = { is_machine_empire = yes }
			}
			text = eo_exiles.6.c.machine
		}
		trigger = {
			num_free_districts = { type = district_mining value > 0 }
		}
		add_district = district_mining
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				owner = { country_uses_food = no }
			}
			modifier = {
				factor = 2
				owner = {
					resource_stockpile_compare = { resource = minerals value < 1 }
				}
			}
			modifier = {
				factor = 1.5
				owner = {
					resource_stockpile_compare = { resource = minerals value < 100 }
					has_monthly_income = { resource = minerals value < 0 }
				}
			}
			modifier = {
				factor = 1.5
				owner = {
					is_lithoid_empire = yes
					has_deficit = minerals
					any_situation = {
						is_situation_type = situation_planetary_revolt
					}
				}
			}
		}
	}
}

planet_event = {
	id = eo_exiles.8
	title = eo_exiles.8.name
	desc = {
		trigger = {
			owner = {
				is_regular_empire = yes
			}
		}
		text = eo_exiles.8.desc.normal
	}
	desc = {
		trigger = {
			owner = {
				is_hive_empire = yes
			}
		}
		text = eo_exiles.8.desc.hive
	}
	desc = {
		trigger = {
			owner = {
				is_machine_empire = yes
			}
		}
		text = eo_exiles.8.desc.machine
	}
	picture = GFX_evt_animal_wildlife
	location = this

	is_triggered_only = yes
	trigger = {
		owner = {
			has_origin = origin_exiles
			NOT = {
				has_country_flag = colonized_ideal_planet
			}
		}
		is_ideal_planet_class = {
			who = owner
			status = yes
		}
	}

	option = {
		name = eo_exiles.8.a
		set_country_flag = colonized_ideal_planet
		if = {
			limit = {
				is_machine_empire = yes
			}
			add_modifier = {
				modifier = exile_a_new_home_machine
				years = 20
			}
		}
		else_if = {
			limit = {
				is_hive_empire = yes
			}
			add_modifier = {
				modifier = exile_a_new_home_hive
				years = 20
			}
		}
		else = {
			add_modifier = {
				modifier = exile_a_new_home
				years = 20
			}
		}
	}
}

planet_event = {
	id = eo_exiles.9
	hide_window = yes

	is_triggered_only = yes

	trigger = {
		OR = {
			has_modifier = exile_a_new_home
			has_modifier = exile_a_new_home_hive
			has_modifier = exile_a_new_home_machine
		}
	}

	immediate = {
		remove_modifier = exile_a_new_home
		remove_modifier = exile_a_new_home_hive
		remove_modifier = exile_a_new_home_machine
	}
}