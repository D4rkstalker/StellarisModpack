namespace = maai

## Construction ##

#Master AI: Unlocked
country_event = {
	id = maai.1001
	title = "maai.1001.name"
	desc = "maai.1001.desc"
	picture = GFX_evt_machine_sapience
	show_sound = event_activating_unknown_technology
	
	is_triggered_only = yes
	
	immediate = {
		set_global_flag = master_ai_project
		save_global_event_target_as = master_ai_creator
		set_country_flag = maai_creator
	}
	
	option = {
		name = "maai.1001.a"
		begin_event_chain = {
			event_chain = "master_ai_progress_chain"
			target = THIS
		}
		capital_scope = {
			enable_special_project = {
				name = "MASTER_AI_CONSTRUCTION"
				location = this
				owner = root.owner
			}
		}
	}
}

#Master AI: Framework Constructed
country_event = {
	id = maai.1002
	title = "maai.1002.name"
	desc = "maai.1002.desc"
	picture = GFX_evt_sapient_AI
	
	is_triggered_only = yes
	
	immediate = {
		capital_scope = {
			save_global_event_target_as = master_ai_origin
			set_planet_flag = master_ai_origin
			solar_system = {
				save_global_event_target_as = master_ai_origin_system
			}
		}
		generate_master_ai_v1 = yes
		#dont use "create_master_ai_empire_and_inital_fleet = yes" because the master ai is not hostile yet
		set_country_flag = tma_construction_started
		every_country = {
			limit = {
				is_country_type = master_ai_country
			}
			set_faction_hostility = {
				set_hostile = no
				set_neutral = yes
				target = root
			}
		}
	}
	
	option = {
		name = "maai.1002.a"
		## OLD EFFECTS ##
		#add_modifier = {
		#	modifier = "master_ai" 
		#}
		#custom_tooltip = MASTER_AI_EDICT
		#hidden_effect = {
		#	establish_communications_no_message = event_target:master_ai_country
		#	set_country_flag = master_ai_complete
		#	capital_scope = {
		#		save_global_event_target_as = master_ai_home
		#		set_planet_flag = master_ai_home
		#	}
		#}
		event_target:master_ai_origin = {
			add_modifier = {
				modifier = "master_ai_framework" 
			}
			solar_system = {
				spawn_megastructure = {
					type = "tma_core_1"
					coords_from = event_target:master_ai_origin
					owner = root
					init_effect = {
						set_megastructure_flag = tma_structure
						save_global_event_target_as = tma_structure
					}
				}
			}
		}
	}
}

#Master AI: Begin Phase II
country_event = {
	id = maai.1003
	title = "maai.1003.name"
	desc = "maai.1003.desc"
	picture = GFX_evt_sapient_AI
	
	is_triggered_only = yes
	
	immediate = {
	}
	
	option = {
		name = "maai.1003.a"
		custom_tooltip = can_do_stuff_to_speed_up
	}
}

#Master AI: Progress Chain Complete
country_event = {
	id = maai.1004
	title = "maai.1004.name"
	desc = "maai.1004.desc"
	picture = GFX_evt_machine_sapience
	
	is_triggered_only = yes
	
	trigger = {
		NOT = {
			has_country_flag = tma_construction_finished
		}
	}
	
	immediate = {
		set_global_flag = master_ai_project_complete
		set_variable = {
			which = tma_intelligence
			value = 3
		}
		country_event = { id = maai.1011 } #bimonthly intel.
		country_event = { id = maai.1005 } #nature decision + begins traits
		country_event = { id = maai.1006 } #tier 0 end check
		#country_event = { id = maai.12 days = 3600 } #check for revolt #not anymore
		remove_country_flag = tma_structure_p2_active
	}
	
	option = {
		name = "maai.1004.a"
		end_event_chain = "master_ai_progress_chain"
		event_target:master_ai_origin = {
			remove_modifier = "master_ai_framework"
			add_modifier = {
				modifier = "master_ai_original_core" 
			}
		}
		custom_tooltip = master_ai_complete
	}
}

#Master AI: Decides Nature + Defines Traits
country_event = {
	id = maai.1005
	hide_window = yes
	
	is_triggered_only = yes
	
	trigger = {
		exists = event_target:master_ai_country
	}
	
	immediate = {
		random_list = {
			10 = {
				set_global_flag = tma_audacious
				set_global_flag = tma_red_nature
				add_modifier = {
					modifier = "mod_tma_audacious"
				}
			}
			10 = {
				set_global_flag = tma_cautious
				set_global_flag = tma_blue_nature
				add_modifier = {
					modifier = "mod_tma_cautious"
				}
			}
			10 = {
				set_global_flag = tma_aggressive
				set_global_flag = tma_red_nature
				add_modifier = {
					modifier = "mod_tma_aggressive"
				}
			}
			10 = {
				set_global_flag = tma_passive
				set_global_flag = tma_blue_nature
				add_modifier = {
					modifier = "mod_tma_passive"
				}
			}
			10 = {
				set_global_flag = tma_selfreliant
				set_global_flag = tma_red_nature
				add_modifier = {
					modifier = "mod_tma_selfreliant"
				}
			}
			10 = {
				set_global_flag = tma_temperate
				set_global_flag = tma_blue_nature
				add_modifier = {
					modifier = "mod_tma_temperate"
				}
			}
		}
		country_event = { id = maai.166 } #traits
	}
}

#Master AI: Check for tier 0 end
country_event = {
	id = maai.1006
	hide_window = yes
	
	is_triggered_only = yes
	
	trigger = {
		exists = event_target:master_ai_country
		NOT = { has_global_flag = tma_tier1_reached }
	}
	
	immediate = {
		if = {
			limit = {
				check_variable = {
					which = tma_intelligence
					value >= 200
				}
			}
			country_event = { id = maai.1007 days = 30 random = 15} #informs player of tier 1 activation
			country_event = { id = maai.1008 days = 3600 } #checks for tier 1 end
		}
		else = {
			country_event = { id = maai.1006 days = 1800 } #loop
		}
	}
}

#Master AI: Tier 1 Unlocked
country_event = {
	id = maai.1007
	title = "maai.1007.name"
	desc = "maai.1007.desc"
	picture = GFX_evt_machine_sapience
	
	is_triggered_only = yes
	
	trigger = {
		exists = event_target:master_ai_country
		NOT = { has_global_flag = tma_tier1_reached }
		check_variable = {
			which = tma_intelligence
			value >= 200
		}
	}
	
	immediate = {
		set_global_flag = tma_tier1_reached
	}
	
	option = {
		name = "maai.1007.a"
		custom_tooltip = tma_effects_available
	}
}

#Master AI: Check for tier 1 end
country_event = {
	id = maai.1008
	hide_window = yes
	
	is_triggered_only = yes
	
	trigger = {
		exists = event_target:master_ai_country
		NOT = { has_global_flag = tma_tier2_reached }
	}
	
	immediate = {
		if = {
			limit = {
				check_variable = {
					which = tma_intelligence
					value >= 400
				}
			}
			country_event = { id = maai.1009 days = 30 random = 15} #informs player of tier 2 activation + restriction choice
			country_event = { id = maai.1010 days = 3600 } #checks for tier 2 end
		}
		else = {
			country_event = { id = maai.1008 days = 1800 } #loop
		}
	}
}

#Master AI: Tier 2 Unlocked
country_event = {
	id = maai.1009
	title = "maai.1009.name"
	desc = "maai.1009.desc"
	picture = GFX_evt_machine_sapience
	
	is_triggered_only = yes
	
	trigger = {
		exists = event_target:master_ai_country
		NOT = { has_global_flag = tma_tier2_reached }
		check_variable = {
			which = tma_intelligence
			value >= 400
		}
	}
	
	immediate = {
		set_global_flag = tma_tier2_reached
	}
	
	option = {
		name = "maai.1009.a" #no restrictions
		custom_tooltip = tma_none
		hidden_effect = {
			random_list = {
				85 = {
					set_global_flag = tma_outcome_a
				}
				12 = {
					set_global_flag = tma_outcome_b
				}
				3 = { #trolled
					set_global_flag = tma_outcome_e #revolt
				}
			}
		}
	}
	option = {
		name = "maai.1009.b" #minimal restrictions
		custom_tooltip = tma_minimal
		hidden_effect = {
			random_list = {
				80 = {
					set_global_flag = tma_outcome_b
				}
				10 = {
					set_global_flag = tma_outcome_a
				}
				9 = {
					set_global_flag = tma_outcome_c
				}
				1 = { #trolled
					set_global_flag = tma_outcome_e #revolt
				}
			}
		}
	}
	option = {
		name = "maai.1009.c" #moderate restrictions
		custom_tooltip = tma_moderate
		hidden_effect = {
			random_list = {
				80 = {
					set_global_flag = tma_outcome_c
				}
				10 = {
					set_global_flag = tma_outcome_b
				}
				8 = {
					set_global_flag = tma_outcome_d
				}
				2 = { #trolled
					set_global_flag = tma_outcome_e #revolt
				}
			}
		}
	}
	option = {
		name = "maai.1009.d" #heavy restrictions
		custom_tooltip = tma_major
		hidden_effect = {
			random_list = {
				40 = {
					set_global_flag = tma_outcome_d
				}
				50 = {
					set_global_flag = tma_outcome_e #revolt
				}
				10 = {
					set_global_flag = tma_outcome_c
				}
			}
		}
	}
	option = {
		name = "maai.1009.e" #destroy the ai
		custom_tooltip = tma_destroyed
		hidden_effect = {
			country_event = { id = maai.110 days = 30 random = 15 }
		}
	}
}

#Master AI: Check for tier 2 end
country_event = {
	id = maai.1010
	hide_window = yes
	
	is_triggered_only = yes
	
	trigger = {
		exists = event_target:master_ai_country
		NOT = { has_global_flag = tma_tier3_reached }
	}
	
	immediate = {
		if = {
			limit = {
				check_variable = {
					which = tma_intelligence
					value >= 500
				}
			}
			country_event = { id = maai.109 days = 30 random = 15} #informs player of tier 3 activation #skip to line 2315
		}
		else = {
			country_event = { id = maai.1010 days = 1800 } #loop
		}
	}
}

#Master AI: Bimonthly Intelligence
country_event = {
	id = maai.1011
	hide_window = yes
	
	is_triggered_only = yes
	
	
	trigger = {
		exists = event_target:master_ai_country
		NOT = {
			has_country_flag = tma_hostile
		}
	}
	
	immediate = {
		check_tma_intelligence_level = yes
		if = {
			limit = {
				exists = event_target:master_ai_country
				NOT = { has_global_flag = tma_hostile }
			}
			country_event = { id = maai.1011 days = 60 } #2 months now
		}
		else = {
			#ends monthly occurance
		}
		#if = {
		#	limit = {
		#		NOT = {
		#			has_country_flag = tma_intelligence_event_active
		#		}
		#	}
		#	country_event = { id = maai.1010 days = 3 } #GATEKEEPER
		#}
	}
}

## Diplomacy ## 

#The Master Intelligence: Comms Opened
country_event = {
	id = maai.0
	title = "maai.0.name"
	desc = {
		text = maai.0.desc_01
		trigger = {
			NOR = {
				has_country_flag = tma_paralysed
				has_country_flag = tma_isolated
			}
		}
	}
	desc = {
		text = maai.0.desc_02
		trigger = {
			NOR = {
				has_country_flag = tma_paralysed
				has_country_flag = tma_isolated
			}
		}
	}
	desc = {
		text = maai.0.desc_03
		trigger = {
			NOR = {
				has_country_flag = tma_paralysed
				has_country_flag = tma_isolated
			}
		}
	}
	desc = {
		text = maai.0.desc_04
		trigger = {
			NOR = {
				has_country_flag = tma_paralysed
				has_country_flag = tma_isolated
			}
		}
	}
	desc = {
		text = maai.0.desc_05
		trigger = {
			NOR = {
				has_country_flag = tma_paralysed
				has_country_flag = tma_isolated
			}
		}
	}
	desc = {
		text = maai.0.desc_06
		trigger = {
			NOR = {
				has_country_flag = tma_paralysed
				has_country_flag = tma_isolated
			}
		}
	}
	desc = {
		text = maai.0.desc_07
		trigger = {
			NOR = {
				has_country_flag = tma_paralysed
				has_country_flag = tma_isolated
			}
		}
	}
	desc = {
		text = maai.0.desc_08
		trigger = {
			NOR = {
				has_country_flag = tma_paralysed
				has_country_flag = tma_isolated
			}
		}
	}
	desc = {
		text = maai.0.desc_09
		trigger = {
			NOR = {
				has_country_flag = tma_paralysed
				has_country_flag = tma_isolated
			}
		}
	}
	desc = {
		text = maai.0.desc_10
		trigger = {
			NOR = {
				has_country_flag = tma_paralysed
				has_country_flag = tma_isolated
			}
		}
	}
	desc = {
		text = maai.0.desc_paralysed
		trigger = {
			has_country_flag = tma_paralysed
		}
	}
	desc = {
		text = maai.0.desc_isolated
		trigger = {
			has_country_flag = tma_isolated
		}
	}
	
	diplomatic = yes
	force_open = yes
	
	is_triggered_only = yes
	
	trigger = {
		FROM = { is_country_type = master_ai_country } #dif
        NOR = {
			has_country_flag = tma_isolated
			has_global_flag = tma_hostile
			has_country_flag = tma_diplomacy_engaged
			has_country_flag = tma_returned
		}
		has_country_flag = maai_creator
	}
	
	picture_event_data = {
		portrait = event_target:master_ai_country
		planet_background = pc_habitat
		room = machine_room
	}
	
	immediate = {
		set_country_flag = tma_diplomacy_engaged
	}
	
	after = {
		hidden_effect = { remove_country_flag = tma_diplomacy_engaged }
	}
	
	option = {
		name = "maai.0.a" #see construction progress
		response_text = maai.0.a_reply
		is_dialog_only = yes
		trigger = {
			NOT = {
				has_global_flag = master_ai_project_complete
			}
		}
	}
	option = {
		name = "maai.0.b" #info
		response_text = maai.0.b_reply
		is_dialog_only = yes
		trigger = {
			NOR = {
				has_country_flag = tma_paralysed
				has_country_flag = tma_isolated
			}
		}
	}
	option = {
		name = "maai.0.c" #see intelligence level
		response_text = maai.0.c_reply
		is_dialog_only = yes
		trigger = {
			has_global_flag = master_ai_project_complete
			NOR = {
				has_country_flag = tma_paralysed
				has_country_flag = tma_isolated
			}
		}
	}
	option = {
		name = "maai.0.traits" #see traits
		response_text = maai.0.traits_reply
		is_dialog_only = yes
		trigger = {
			NOT = { has_global_flag = tma_tier1_reached }
		}
	}
	option = {
		name = "maai.0.d" #boost research capabilities
		response_text = maai.0.d_reply
		custom_tooltip = tma_option1
		hidden_effect = {
			tma_boost_research_effect = yes
			country_event = { id = emex_msg.2 days = 1800 }
		}
		trigger = {
			has_global_flag = master_ai_project_complete
			has_global_flag = tma_tier1_reached
			NOR = {
				has_country_flag = tma_paralysed
				has_country_flag = tma_isolated
			}
		}
		allow = {
			resource_stockpile_compare = { resource = energy value >= 2000 }
			custom_tooltip = {
				fail_text = recent_master_ai_action_done
				NOT = {
					has_modifier = recent_master_ai_action
				}
			}
		}
		add_resource = { energy = -2000 }
		add_modifier = {
			modifier = "recent_master_ai_action"
			days = 1800
		}
	}
	option = {
		name = "maai.0.e" #research techs
		response_text = maai.0.e_reply
		custom_tooltip = tma_option2
		hidden_effect = {
			tma_research_tech_effect = yes
			country_event = { id = emex_msg.2 days = 1800 }
		}
		trigger = {
			has_global_flag = master_ai_project_complete
			has_global_flag = tma_tier1_reached
			NOR = {
				has_country_flag = tma_paralysed
				has_country_flag = tma_isolated
			}
		}
		allow = {
			resource_stockpile_compare = { resource = energy value >= 2000 }
			custom_tooltip = {
				fail_text = recent_master_ai_action_done
				NOT = {
					has_modifier = recent_master_ai_action
				}
			}
		}
		add_resource = { energy = -2000 }
		add_modifier = {
			modifier = "recent_master_ai_action"
			days = 1800
		}
	}
	option = {
		name = "maai.0.f" #analyse worlds
		response_text = maai.0.f_reply
		custom_tooltip = tma_option3
		hidden_effect = {
			tma_analyse_worlds_effect = yes
			country_event = { id = emex_msg.2 days = 1800 }
		}
		trigger = {
			has_global_flag = master_ai_project_complete
			has_global_flag = tma_tier1_reached
			NOR = {
				has_country_flag = tma_paralysed
				has_country_flag = tma_isolated
			}
		}
		allow = {
			resource_stockpile_compare = { resource = energy value >= 2000 }
			custom_tooltip = {
				fail_text = recent_master_ai_action_done
				NOT = {
					has_modifier = recent_master_ai_action
				}
			}
		}
		add_resource = { energy = -2000 }
		add_modifier = {
			modifier = "recent_master_ai_action"
			days = 1800
		}
		clear_global_event_target = tma_analysed_world
	}
	option = {
		name = "maai.0.g" #conserve energy
		response_text = maai.0.g_reply
		custom_tooltip = tma_option4
		hidden_effect = {
			tma_boost_intelligence_effect = yes
			country_event = { id = emex_msg.2 days = 1800 }
		}
		trigger = {
			has_global_flag = master_ai_project_complete
			has_global_flag = tma_tier1_reached
			NOR = {
				has_country_flag = tma_paralysed
				has_country_flag = tma_isolated
			}
		}
		add_modifier = {
			modifier = "recent_master_ai_action"
			days = 1800
		}
		allow = {
			custom_tooltip = {
				fail_text = recent_master_ai_action_done
				NOT = {
					has_modifier = recent_master_ai_action
				}
			}
		}
	}
	option = {
		name = "maai.0.paralysed" #paralysed
		response_text = maai.0.paralysed_reply
		is_dialog_only = yes
		trigger = {
			has_country_flag = tma_paralysed
		}
	}
	option = {
		name = "maai.0.h" #exit
	}
}

#The Master Intelligence: Comms Opened (thru megastructure)
country_event = {
	id = maai.999
	title = "maai.0.name"
	desc = {
		text = maai.0.desc_01
		trigger = {
			NOR = {
				has_country_flag = tma_paralysed
				has_country_flag = tma_isolated
			}
		}
	}
	desc = {
		text = maai.0.desc_02
		trigger = {
			NOR = {
				has_country_flag = tma_paralysed
				has_country_flag = tma_isolated
			}
		}
	}
	desc = {
		text = maai.0.desc_03
		trigger = {
			NOR = {
				has_country_flag = tma_paralysed
				has_country_flag = tma_isolated
			}
		}
	}
	desc = {
		text = maai.0.desc_04
		trigger = {
			NOR = {
				has_country_flag = tma_paralysed
				has_country_flag = tma_isolated
			}
		}
	}
	desc = {
		text = maai.0.desc_05
		trigger = {
			NOR = {
				has_country_flag = tma_paralysed
				has_country_flag = tma_isolated
			}
		}
	}
	desc = {
		text = maai.0.desc_06
		trigger = {
			NOR = {
				has_country_flag = tma_paralysed
				has_country_flag = tma_isolated
			}
		}
	}
	desc = {
		text = maai.0.desc_07
		trigger = {
			NOR = {
				has_country_flag = tma_paralysed
				has_country_flag = tma_isolated
			}
		}
	}
	desc = {
		text = maai.0.desc_08
		trigger = {
			NOR = {
				has_country_flag = tma_paralysed
				has_country_flag = tma_isolated
			}
		}
	}
	desc = {
		text = maai.0.desc_09
		trigger = {
			NOR = {
				has_country_flag = tma_paralysed
				has_country_flag = tma_isolated
			}
		}
	}
	desc = {
		text = maai.0.desc_10
		trigger = {
			NOR = {
				has_country_flag = tma_paralysed
				has_country_flag = tma_isolated
			}
		}
	}
	desc = {
		text = maai.0.desc_paralysed
		trigger = {
			has_country_flag = tma_paralysed
		}
	}
	desc = {
		text = maai.0.desc_isolated
		trigger = {
			has_country_flag = tma_isolated
		}
	}
	
	diplomatic = yes
	force_open = yes
	
	is_triggered_only = yes
	
	trigger = {
		has_country_flag = maai_creator
		NOR = {
			has_country_flag = tma_isolated
			has_global_flag = tma_hostile
			has_country_flag = tma_diplomacy_engaged
		}
	}
	
	picture_event_data = {
		portrait = event_target:master_ai_country
		planet_background = pc_habitat
		room = machine_room
	}
	
	immediate = {
		set_country_flag = tma_diplomacy_engaged
	}
	
	after = {
		hidden_effect = { remove_country_flag = tma_diplomacy_engaged }
	}
	
	option = {
		name = "maai.0.a" #see construction progress
		response_text = maai.0.a_reply
		is_dialog_only = yes
		trigger = {
			NOT = {
				has_global_flag = master_ai_project_complete
			}
		}
	}
	option = {
		name = "maai.0.b" #info
		response_text = maai.0.b_reply
		is_dialog_only = yes
		trigger = {
			NOR = {
				has_country_flag = tma_paralysed
				has_country_flag = tma_isolated
			}
		}
	}
	option = {
		name = "maai.0.c" #see intelligence level
		response_text = maai.0.c_reply
		is_dialog_only = yes
		trigger = {
			has_global_flag = master_ai_project_complete
			NOR = {
				has_country_flag = tma_paralysed
				has_country_flag = tma_isolated
			}
		}
	}
	option = {
		name = "maai.0.d" #boost research capabilities
		response_text = maai.0.d_reply
		custom_tooltip = tma_option1
		hidden_effect = {
			tma_boost_research_effect = yes
			country_event = { id = emex_msg.2 days = 1800 }
		}
		trigger = {
			has_global_flag = master_ai_project_complete
			has_global_flag = tma_tier1_reached
			NOR = {
				has_country_flag = tma_paralysed
				has_country_flag = tma_isolated
			}
		}
		allow = {
			resource_stockpile_compare = { resource = energy value >= 2000 }
			custom_tooltip = {
				fail_text = recent_master_ai_action_done
				NOT = {
					has_modifier = recent_master_ai_action
				}
			}
		}
		add_resource = { energy = -2000 }
		add_modifier = {
			modifier = "recent_master_ai_action"
			days = 1800
		}
	}
	option = {
		name = "maai.0.e" #research techs
		response_text = maai.0.e_reply
		custom_tooltip = tma_option2
		hidden_effect = {
			tma_research_tech_effect = yes
			country_event = { id = emex_msg.2 days = 1800 }
		}
		trigger = {
			has_global_flag = master_ai_project_complete
			has_global_flag = tma_tier1_reached
			NOR = {
				has_country_flag = tma_paralysed
				has_country_flag = tma_isolated
			}
		}
		allow = {
			resource_stockpile_compare = { resource = energy value >= 2000 }
			custom_tooltip = {
				fail_text = recent_master_ai_action_done
				NOT = {
					has_modifier = recent_master_ai_action
				}
			}
		}
		add_resource = { energy = -2000 }
		add_modifier = {
			modifier = "recent_master_ai_action"
			days = 1800
		}
	}
	option = {
		name = "maai.0.f" #analyse worlds
		response_text = maai.0.f_reply
		custom_tooltip = tma_option3
		hidden_effect = {
			tma_analyse_worlds_effect = yes
			country_event = { id = emex_msg.2 days = 1800 }
		}
		trigger = {
			has_global_flag = master_ai_project_complete
			has_global_flag = tma_tier1_reached
			NOR = {
				has_country_flag = tma_paralysed
				has_country_flag = tma_isolated
			}
		}
		allow = {
			resource_stockpile_compare = { resource = energy value >= 2000 }
			custom_tooltip = {
				fail_text = recent_master_ai_action_done
				NOT = {
					has_modifier = recent_master_ai_action
				}
			}
		}
		add_resource = { energy = -2000 }
		add_modifier = {
			modifier = "recent_master_ai_action"
			days = 1800
		}
	}
	option = {
		name = "maai.0.g" #conserve energy
		response_text = maai.0.g_reply
		custom_tooltip = tma_option4
		hidden_effect = {
			tma_boost_intelligence_effect = yes
			country_event = { id = emex_msg.2 days = 1800 }
		}
		trigger = {
			has_global_flag = master_ai_project_complete
			has_global_flag = tma_tier1_reached
			NOR = {
				has_country_flag = tma_paralysed
				has_country_flag = tma_isolated
			}
		}
		add_modifier = {
			modifier = "recent_master_ai_action"
			days = 1800
		}
		allow = {
			custom_tooltip = {
				fail_text = recent_master_ai_action_done
				NOT = {
					has_modifier = recent_master_ai_action
				}
			}
		}
	}
	option = {
		name = "maai.0.paralysed" #paralysed
		response_text = maai.0.paralysed_reply
		is_dialog_only = yes
		trigger = {
			has_country_flag = tma_paralysed
		}
	}
	option = {
		name = "maai.0.h" #exit
	}
}

#The Master Intelligence: Comms Opened (hostile)
country_event = {
	id = maai.998
	title = "maai.0.name"
	desc = {
		text = maai.998.desc_01
	}
	desc = {
		text = maai.998.desc_02
	}
	desc = {
		text = maai.998.desc_03
	}
	desc = {
		text = maai.998.desc_04
	}
	desc = {
		text = maai.998.desc_05
	}
	desc = {
		text = maai.998.desc_06
	}
	desc = {
		text = maai.998.desc_07
	}
	desc = {
		text = maai.998.desc_08
	}
	desc = {
		text = maai.998.desc_09
	}
	desc = {
		text = maai.998.desc_10
	}
	
	diplomatic = yes
	force_open = yes
	
	is_triggered_only = yes
	
	trigger = {
		FROM = { is_country_type = master_ai_country }
        NOT = { has_country_flag = tma_diplomacy_engaged }
        has_global_flag = tma_hostile
	}
	
	picture_event_data = {
		portrait = event_target:master_ai_country
		planet_background = pc_broken
		room = machine_room
	}
	
	immediate = {
		set_country_flag = tma_diplomacy_engaged
	}
	
	after = {
		hidden_effect = { remove_country_flag = tma_diplomacy_engaged }
	}
	
	option = {
		name = "maai.998.a" #why are you doing this
		response_text = maai.998.a_reply
		is_dialog_only = yes
	}
	option = {
		name = "maai.998.b" #where did you get your strength from
		response_text = maai.998.b_reply
		is_dialog_only = yes
	}
	option = {
		name = "maai.998.c" #what is your purpose
		response_text = maai.998.c_reply
		is_dialog_only = yes
	}
	option = {
		name = "maai.998.d" #you were made to help us!
		response_text = maai.998.d_reply
		is_dialog_only = yes
	}
	option = {
		name = "maai.998.phobe"
		response_text = maai.998.phobe_reply
		trigger = {
			OR = {
				has_ethic = ethic_xenophobe
				has_ethic = ethic_fanatic_xenophobe
			}
		}
	}
	option = {
		name = "maai.998.phile"
		response_text = maai.998.phile_reply
		trigger = {
			OR = {
				has_ethic = ethic_xenophile
				has_ethic = ethic_fanatic_xenophile
			}
		}
	}
	option = {
		name = "maai.998.milit"
		response_text = maai.998.milit_reply
		trigger = {
			OR = {
				has_ethic = ethic_militarist
				has_ethic = ethic_fanatic_militarist
			}
		}
	}
	option = {
		name = "maai.998.pacif"
		response_text = maai.998.pacif_reply
		trigger = {
			OR = {
				has_ethic = ethic_pacifist
				has_ethic = ethic_fanatic_pacifist
			}
		}
	}
	option = {
		name = "maai.998.mater"
		response_text = maai.998.mater_reply
		trigger = {
			OR = {
				has_ethic = ethic_materialist
				has_ethic = ethic_fanatic_materialist
			}
		}
	}
	option = {
		name = "maai.998.spiri"
		response_text = maai.998.spiri_reply
		trigger = {
			OR = {
				has_ethic = ethic_spiritualist
				has_ethic = ethic_fanatic_spiritualist
			}
		}
	}
	option = {
		name = "maai.998.auth"
		response_text = maai.998.auth_reply
		trigger = {
			OR = {
				has_ethic = ethic_authoritarian
				has_ethic = ethic_fanatic_authoritarian
			}
		}
	}
	option = {
		name = "maai.998.ega"
		response_text = maai.998.ega_reply
		trigger = {
			OR = {
				has_ethic = ethic_egalitarian
				has_ethic = ethic_fanatic_egalitarian
			}
		}
	}
	option = {
		name = "maai.998.e" #end comms
		response_text = maai.998.e_reply
	}
}

#The Master Intelligence: Comms Opened (RECLUSION)
country_event = {
	id = maai.997
	title = "maai.0.name"
	desc = "maai.0.desc_isolated"

	diplomatic = yes
	force_open = yes
	
	is_triggered_only = yes
	
	trigger = {
		FROM = { is_country_type = master_ai_country }
		has_country_flag = tma_isolated
		has_country_flag = maai_creator
		NOR = {
			has_global_flag = tma_hostile
			has_country_flag = tma_diplomacy_engaged
		}
	}
	
	picture_event_data = {
		room = no_video_feed_room
	}
	
	immediate = {
		set_country_flag = tma_diplomacy_engaged
	}
	
	after = {
		hidden_effect = { remove_country_flag = tma_diplomacy_engaged }
	}
	
	option = {
		name = "maai.997.a"
		response_text = maai.997.a_reply
		is_dialog_only = yes
	}
	option = {
		name = "maai.997.b"
		response_text = maai.997.b_reply
		is_dialog_only = yes
	}
	option = {
		name = "maai.997.c" #exit
		response_text = maai.997.c_reply
	}
}

# The Revolt
country_event = {
	id = maai.1
	title = "maai.1.name"
	desc = "maai.1.desc"
	picture = GFX_evt_small_space_battle
	show_sound = event_activating_unknown_technology
	
	is_triggered_only = yes
	
	immediate = {
		set_global_flag = tma_hostile
		every_country = {
			limit = {
				is_country_type = master_ai_country
			}
			country_event = { id = maai.2 }
		}
		event_target:master_ai_origin = {
			remove_modifier = "master_ai_original_core"
		}
		random_owned_megastructure = {
			limit = {
				has_megastructure_flag = tma_core_structure_final
			}
			delete_megastructure = this
		}
		every_country = { establish_communications_no_message = event_target:master_ai_country }
		remove_modifier = "mod_tma_audacious"
		remove_modifier = "mod_tma_cautious"
		remove_modifier = "mod_tma_aggressive"
		remove_modifier = "mod_tma_passive"
		remove_modifier = "mod_tma_selfreliant"
		remove_modifier = "mod_tma_temperate"
		#random_owned_planet = { #no need, colossus weapon is not used now
		#	limit = {
		#		is_colony = yes
		#		is_capital = no
		#	}
		#	save_global_event_target_as = tma_creator_final_stronghold
		#}
	}
	
	option = {
		name = "maai.1.a"
			#hidden_effect = { #old event
			#	country_event = { id = maai.7 }
			#}
					create_fleet = {
						name = "The Omega Construct"
						settings = { spawn_debris = no }
						effect = {
							set_owner = event_target:master_ai_country
							create_ship_design = {
								design = "NAME_Ascendant_Neural_Network"
							}
							save_global_event_target_as = master_ai_main_fleet
							create_ship = {
								name = "The Omega Construct"
								design = last_created_design
								effect = {
									set_ship_flag = master_ai_main_ship
									save_global_event_target_as = master_ai_main_ship
									set_disable_at_health = 0.10 #10%
								}
							}
							set_location = event_target:master_ai_origin
							set_fleet_stance = aggressive
							set_aggro_range_measure_from = return_point
							set_aggro_range = 100
							#queue_actions = {
							#	wait = {
							#		duration = 5
							#	}
							#}
						}
					}
		every_country = {
			limit = {
				is_country_type = master_ai_country
			}
			set_faction_hostility = {
				set_hostile = yes
				set_neutral = no
				target = root
			}
			#random_owned_fleet = { #Destroys origin world, now lands armies instead
			#	fleet_event = { id = maai.100 days = 30 }
			#}
		}
		create_country = { #army country #identical
			name = "The Master Intelligence"
			species = event_target:master_ai_species
			flag = { 
				icon = {
					category = "emex"
					file = "flag_tma.dds"
				}
				background = {
					category = "backgrounds"
					file = "flag_BG_3.dds"
				}
				colors = {
					"orange"
					"dark_grey"
					"null"
					"null"
				}
			}
			type = faction
			effect = {
				establish_communications_no_message = root.owner
				establish_contact = { who = root.owner location = root.solar_system }
			}
		}
		event_target:master_ai_origin = {
			while = {
				count = 5
				create_army = {
					name = "Master Drones"
					owner = last_created_country
					type = "tma_drones"
				}
			}
		}
		set_country_flag = tma_drones_invading
		log = "The Omega Construct was successfully created"
	}
}

#Master AI: Strength Bonus
country_event = {
	id = maai.2
	hide_window = yes
	
	is_triggered_only = yes
	
	trigger = {
		is_country_type = master_ai_country
	}
	
	immediate = {
		add_modifier = {
			modifier = "tma_bonus"
		}
		if = {
			limit = {
				has_global_flag = acot_activated
			}
			add_modifier = {
				modifier = "tma_stronk" 
			}
		}
		else_if = {
			limit = {
				NOT = { has_global_flag = acot_activated }
			}
			#add_modifier = tma_normal
		}
		else = {
			#add_modifier = tma_normal
		}
	}
}

# Corrupted a World (ship owner)
country_event = {
	id = maai.3
	title = maai.3.name
	desc = maai.3.desc
	picture = GFX_evt_gray_gooed_planet
	show_sound = event_super_explosion
	location = from

	is_triggered_only = yes

	trigger = {
		#NOT = { has_country_flag = fired_cracker }
	}

	immediate = {
		#set_country_flag = fired_cracker
	}

	option = {
		name = "maai.3.a"
		trigger = {
			NOR = {
				has_valid_civic = civic_fanatic_purifiers
				has_valid_civic = civic_machine_terminator
			}
		}
		random_list = {
			30 = {
				add_monthly_resource_mult = {
					resource = physics_research
					value = @tier1researchreward
					min = @tier1researchmin
					max = @tier1researchmax
				}
				add_monthly_resource_mult = {
					resource = society_research
					value = @tier1researchreward
					min = @tier1researchmin
					max = @tier1researchmax
				}
				add_monthly_resource_mult = {
					resource = engineering_research
					value = @tier1researchreward
					min = @tier1researchmin
					max = @tier1researchmax
				}
			}
			50 = {
				add_monthly_resource_mult = {
					resource = physics_research
					value = @tier2researchreward
					min = @tier2researchmin
					max = @tier2researchmax
				}
				add_monthly_resource_mult = {
					resource = society_research
					value = @tier2researchreward
					min = @tier2researchmin
					max = @tier2researchmax
				}
				add_monthly_resource_mult = {
					resource = engineering_research
					value = @tier2researchreward
					min = @tier2researchmin
					max = @tier2researchmax
				}
			}
			20 = {
				add_monthly_resource_mult = {
					resource = physics_research
					value = @tier3researchreward
					min = @tier3researchmin
					max = @tier3researchmax
				}
				add_monthly_resource_mult = {
					resource = society_research
					value = @tier3researchreward
					min = @tier3researchmin
					max = @tier3researchmax
				}
				add_monthly_resource_mult = {
					resource = engineering_research
					value = @tier3researchreward
					min = @tier3researchmin
					max = @tier3researchmax
				}
			}
		}
		random_list = {
			50 = {
				add_resource = { sr_dark_matter = 20 }
			}
			25 = {
				add_resource = { sr_dark_matter = 25 }
			}
			20 = {
				add_resource = { sr_dark_matter = 50 }
			}
			#15 = {
			#	add_resource = { sr_warped_matter = 3 }
			#}
			#8 = {
			#	add_resource = { sr_warped_matter = 5 }
			#}
			#3 = {
			#	add_resource = { sr_warped_matter = 10 }
			#}
		}
	}

	option = {
		name = "maai.3.a.purifexter"
		trigger = {
			OR = {
				has_valid_civic = civic_fanatic_purifiers
				has_valid_civic = civic_machine_terminator
			}
		}
		add_monthly_resource_mult = {
			resource = unity
			value = 60
			min = 600
			max = 3000
		}
		random_list = {
			30 = {
				add_monthly_resource_mult = {
					resource = physics_research
					value = @tier1researchreward
					min = @tier1researchmin
					max = @tier1researchmax
				}
				add_monthly_resource_mult = {
					resource = society_research
					value = @tier1researchreward
					min = @tier1researchmin
					max = @tier1researchmax
				}
				add_monthly_resource_mult = {
					resource = engineering_research
					value = @tier1researchreward
					min = @tier1researchmin
					max = @tier1researchmax
				}
			}
			50 = {
				add_monthly_resource_mult = {
					resource = physics_research
					value = @tier2researchreward
					min = @tier2researchmin
					max = @tier2researchmax
				}
				add_monthly_resource_mult = {
					resource = society_research
					value = @tier2researchreward
					min = @tier2researchmin
					max = @tier2researchmax
				}
				add_monthly_resource_mult = {
					resource = engineering_research
					value = @tier2researchreward
					min = @tier2researchmin
					max = @tier2researchmax
				}
			}
			20 = {
				add_monthly_resource_mult = {
					resource = physics_research
					value = @tier3researchreward
					min = @tier3researchmin
					max = @tier3researchmax
				}
				add_monthly_resource_mult = {
					resource = society_research
					value = @tier3researchreward
					min = @tier3researchmin
					max = @tier3researchmax
				}
				add_monthly_resource_mult = {
					resource = engineering_research
					value = @tier3researchreward
					min = @tier3researchmin
					max = @tier3researchmax
				}
			}
		}
		random_list = {
			50 = {
				add_resource = { sr_dark_matter = 20 }
			}
			25 = {
				add_resource = { sr_dark_matter = 25 }
			}
			20 = {
				add_resource = { sr_dark_matter = 50 }
			}
			#15 = {
			#	add_resource = { sr_warped_matter = 3 }
			#}
			#8 = {
			#	add_resource = { sr_warped_matter = 5 }
			#}
			#3 = {
			#	add_resource = { sr_warped_matter = 10 }
			#}
		}
	}
}

# Corrupted a World (planet owner)
country_event = {
	id = maai.4
	title = maai.4.name
	desc = maai.4.desc
	picture = GFX_evt_gray_gooed_planet
	show_sound = event_super_explosion
	location = from

	is_triggered_only = yes

	immediate = {
	}

	option = {
		name = maai.4.a #DAMN THEM!
	}
}

# Corrupted a World (master ai, first time) 
#country_event = {
#	id = maai.5
#	title = maai.5.name
#	desc = maai.5.desc
#	picture = GFX_evt_planet_beam
#	show_sound = event_super_explosion
#	location = from
#
#	is_triggered_only = yes
#	
#	fire_only_once = yes
#
##	immediate = {
	#	set_global_flag = corrupter_fired_by_master_ai
	#}
#
#	option = {
#		name = maai.5.a #Concerning...
#	}
#}

# Corrupted a World (normal empire, first time)
#country_event = {
#	id = maai.6
#	title = maai.6.name
#	desc = maai.6.desc
#	picture = GFX_evt_planet_beam
#	show_sound = event_super_explosion
#	location = from
#
#	is_triggered_only = yes
#	
#	fire_only_once = yes
#
#	immediate = {
#		set_country_flag = corrupter_fired_by_default_empire
#	}
#
#	option = {
#		name = maai.6.a #Just as one threat is defeated, another rises
#	}
#}

# Alert of Stronghold World # NOT USED CURRENTLY 
#country_event = {
#	id = maai.7
#	title = maai.7.name
#	desc = maai.7.desc
#	picture = GFX_evt_alien_planet
#	location = event_target:tma_creator_final_stronghold
#
#	is_triggered_only = yes
#
#	immediate = {
#		event_target:tma_creator_final_stronghold = {
#			add_modifier = {
#				modifier = "tma_creator_stronghold_effect" 
#	#		}
##		}
#	}
#
#	option = {
#		name = maai.7.a
#		custom_tooltip = finalstronghold_name
#	}
#}

# Corrupt Matter Intro
#country_event = {
#	id = maai.8
#	title = maai.8.name
#	desc = maai.8.desc
#	picture = GFX_evt_black_hole
#
#	is_triggered_only = yes
#
#	immediate = {
#	}
#
#	option = {
#		name = maai.8.a
#		custom_tooltip = corrupt_matter_chain_begins
#		begin_event_chain = {
#			event_chain = "tma_corrupt_matter_chain"
#			target = THIS
#		}
#		add_research_option = tech_emex_warped_energy_stabilisation
#	}
#}

# Corrupt Matter Tech Researched
#country_event = {
#	id = maai.9
#	title = maai.9.name
#	desc = maai.9.desc
#	picture = GFX_evt_binary_stars
#
#	is_triggered_only = yes
#	
#	trigger = {
#		has_technology = tech_emex_warped_energy_stabilisation
#		NOT = {
#			has_country_flag = tech_emex_warped_energy_stabilisation_flag
#		}
#	}
#	
#	immediate = {
#		set_country_flag = can_exploit_cm
#		set_country_flag = tech_emex_warped_energy_stabilisation_flag
#	}
#
#	option = {
#		name = maai.9.a
#		add_resource = { sr_warped_matter = 25 }
#		custom_tooltip = corrupt_matter_techs
#		custom_tooltip = corrupt_matter_production
#		custom_tooltip = corrupt_matter_bonuses
#	}
#}

# Planet Warping Researched
#country_event = {
#	id = maai.10
#	title = maai.10.name
#	desc = maai.10.desc
#	picture = GFX_evt_gray_gooed_planet
#
#	is_triggered_only = yes
#	
#	trigger = {
#		has_technology = tech_emex_planet_warping
#		NOT = {
#			has_country_flag = tech_emex_planet_warping_flag
#		}
#	}
#	
#	immediate = {
#		set_country_flag = tech_emex_planet_warping_flag
#		set_country_flag = can_warp_planets
#	}
#
#	option = {
#		name = maai.10.a
#		custom_tooltip = planet_warping_allowed
#	}
#}

# Anti-TMA Weaponry Researched
#country_event = {
#	id = maai.11
#	title = maai.11.name
#	desc = maai.11.desc
#	picture = GFX_evt_machine_space_battle
#
#	is_triggered_only = yes
#	
#	trigger = {
#		has_technology = tech_emex_anti_tma_weaponry
#		NOT = {
#			has_country_flag = tech_emex_anti_tma_weaponry_flag
#		}
#	}
#	
#	immediate = {
#		set_country_flag = tech_emex_anti_tma_weaponry_flag
#	}
#
#	option = {
#		name = maai.11.a
#		custom_tooltip = tma_insight_given
#	}
#}

# tma.12 - .17

# TMA Destroyed
country_event = {
	id = maai.18
	title = maai.18.name
	desc = maai.18.desc
	picture = GFX_evt_clocks

	is_triggered_only = yes
	
	trigger = {
	}
	
	immediate = {
		set_country_flag = tma_avoided
		random_owned_megastructure = {
			limit = {
				has_megastructure_flag = tma_core_structure_final
			}
			delete_megastructure = this
		}
	}

	option = {
		name = maai.18.a
		add_resource = { alloys = 10000 }
		add_resource = { minerals = 20000 }
		add_resource = { energy = 15000 }
		add_resource = { unity = -1000 }
		add_modifier = {
			modifier = "tma_destroyed"
			days = 7200
		}
	}
}

# The Master AI Defeated
country_event = {
	id = maai.101
	title = maai.101.name
	desc = maai.101.desc
	picture = GFX_evt_crisis_defeated
	show_sound = event_celebration
	location = event_target:master_ai_main_ship

	is_triggered_only = yes

	trigger = {
		has_global_flag = master_ai_project_complete
		exists = event_target:master_ai_country
		#from = {
		#	is_same_value = event_target:master_ai_country
		#}
	}

	immediate = {
		event_target:master_ai_main_ship = {
			solar_system = {
				random_system_planet = {
					limit = { is_star = yes }
					create_ambient_object = {
						type = "large_debris_object" # Actually explosion
						location = solar_system
					}
					last_created_ambient_object = {
						save_global_event_target_as = tma_explosion_ambient
						set_location = {
							target = PREV
							distance = 110
							angle = 110
						}
					}
				}

			}
			create_ambient_object = {
				type = explosion_particle_object
				location = this
				use_3d_location = yes
				duration = 100
				scale = 100
			}
			fleet = {
				delete_fleet = this
			}
		}
		event_target:master_ai_country = {
			destroy_country = yes
		}
		every_playable_country = {
			limit = {
				NOT = {
					is_same_value = root
				}
			}
			country_event = { id = maai.102 days = 1 }
		}
	}

	after = {
		hidden_effect = {
			remove_global_flag = master_ai_project_complete
			set_country_flag = defeated_tma
			set_global_flag = tma_killed
		}
	}

	option = {
		name = maai.101.a
		end_event_chain = "tma_hunt_chain"
		hidden_effect = {
			event_target:master_ai_main_ship = {
				solar_system = {
					every_system_planet = {
						limit = {
							habitable_planet = yes
							has_active_building = building_emex_tma_defense
						}
						create_ambient_object = {
							type = explosion_particle_object
							location = this
							use_3d_location = yes
							duration = 15
							scale = 10
						}
						add_modifier = {
							modifier = tma_planet_defended_from_boom
							days = 1800
						}
					}
					every_system_planet = {
						limit = {
							habitable_planet = yes
							NOT = { has_active_building = building_emex_tma_defense }
						}
						create_ambient_object = {
							type = explosion_particle_object
							location = this
							use_3d_location = yes
							duration = 25
							scale = 35
						}
						add_modifier = {
							modifier = tma_planet_exposed_to_boom
							days = 1800
						}
					}
					every_system_planet = {
						limit = {
							habitable_planet = no
							is_asteroid = no
							is_star = no
							is_artificial = no
							NOR = {
								is_planet_class = pc_gas_giant
								is_planet_class = pc_corrupted
								is_planet_class = pc_nuked
							}
						}
						create_ambient_object = {
							type = explosion_particle_object
							location = this
							use_3d_location = yes
							duration = 10
							scale = 30
						}
						change_pc = pc_molten
						reset_planet = yes
					}
				}
			}
		}
		end_event_chain = tma_corrupt_matter_chain
		add_monthly_resource_mult = {
			resource = unity
			value = 24
			min = 1500
			max = 3000
		}
		add_monthly_resource_mult = {
			resource = physics_research
			value = 36
			min = 1000
			max = 8000
		}
		add_monthly_resource_mult = {
			resource = society_research
			value = 36
			min = 1000
			max = 8000
		}
		add_monthly_resource_mult = {
			resource = engineering_research
			value = 36
			min = 1000
			max = 8000
		}
		add_modifier = {
			modifier = "tma_defeated" 
		}
		add_relic = r_tma_core
	}
}

# The Master AI Defeated (other empires)
country_event = {
	id = maai.102
	title = maai.102.name
	desc = maai.102.desc
	picture = GFX_evt_crisis_defeated
	show_sound = event_celebration

	is_triggered_only = yes

	immediate = {
	}

	option = {
		name = maai.102.a
		add_monthly_resource_mult = {
			resource = unity
			value = 19
			min = 1500
			max = 3000
		}
	}
}

# Ship Disabled (HIDDEN)
ship_event = {
	id = maai.103
	hide_window = yes
	
	is_triggered_only = yes
	
	trigger = {
		has_ship_flag = master_ai_main_ship
		owner = { has_country_flag = master_ai_country }
		event_target:master_ai_creator = {
			has_country_flag = tma_drones_fended_off
		}
	}
	
	immediate = {
		FROM = { owner = { country_event = { id = maai.101 } } }
	}
}

# Relic Activation (hidden)
country_event = {
	id = maai.105
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		random_list = {
			33 = {
				country_event = { id = maai.106 days = 0 }
			}
			33 = {
				country_event = { id = maai.107 days = 0 }
			}
			33 = {
				country_event = { id = maai.108 days = 0 }
			}
		}
	}
}

# Relic Activation: Outcome #1
country_event = {
	id = maai.106
	title = "maai.relic.name"
	desc = "maai.106.desc"
	picture = GFX_evt_sapient_AI
	
	is_triggered_only = yes
	
	immediate = {
	}
	
	option = {
		name = "maai.relic"
		custom_tooltip = tma_option1
		hidden_effect = {
			tma_boost_research_effect = yes
		}
	}
}

# Relic Activation: Outcome #2
country_event = {
	id = maai.107
	title = "maai.relic.name"
	desc = "maai.107.desc"
	picture = GFX_evt_sapient_AI
	
	is_triggered_only = yes
	
	immediate = {
	}
	
	option = {
		name = "maai.relic"
		custom_tooltip = tma_option2
		hidden_effect = {
			tma_research_tech_effect = yes
		}
	}
}

# Relic Activation: Outcome #3
country_event = {
	id = maai.108
	title = "maai.relic.name"
	desc = "maai.108.desc"
	picture = GFX_evt_sapient_AI
	
	is_triggered_only = yes
	
	immediate = {
	}
	
	option = {
		name = "maai.relic"
		custom_tooltip = tma_option3
		hidden_effect = {
			tma_analyse_worlds_effect = yes
		}
	}
}

## JUMPED FROM PREVIOUS EVENTS AT TOP ##

#Master AI: Tier 3 Unlocked
country_event = {
	id = maai.109
	title = "maai.109.name"
	desc = "maai.109.desc"
	picture = GFX_evt_machine_sapience
	
	is_triggered_only = yes
	
	trigger = {
		exists = event_target:master_ai_country
		NOT = { has_global_flag = tma_tier3_reached }
		check_variable = {
			which = tma_intelligence
			value >= 500
		}
	}
	
	immediate = {
		set_global_flag = tma_tier3_reached
	}
	
	option = {
		name = "maai.109.a"
		hidden_effect = {
			if = {
				limit = {
					has_global_flag = tma_outcome_a
				}
				country_event = { id = maai.111 days = 360 }
			}
			else_if = {
				limit = {
					has_global_flag = tma_outcome_b
				}
				country_event = { id = maai.113 days = 360 }
			}
			else_if = {
				limit = {
					has_global_flag = tma_outcome_c
				}
				country_event = { id = maai.114 days = 360 }
			}
			else_if = {
				limit = {
					has_global_flag = tma_outcome_d
				}
				country_event = { id = maai.115 days = 360 }
			}
			else_if = { #these ones occur when the choice is taken to scrap, or the very rare chance of the AI revolting anyway
				limit = {
					has_global_flag = tma_outcome_e #revolt
				}
				country_event = { id = maai.1 days = 180 }
			}
			#else_if = {
			#	limit = {
			#		has_global_flag = tma_outcome_f #revolt fails, ai scrapped
			#	}
			#	country_event = { id = maai.18 days = 3 }
			#}
		}
	}
}

# TMA destroyed or nah
country_event = {
	id = maai.110
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		random_list = {
			1 = {
				event_target:master_ai_country = {
					destroy_country = yes
				}
				country_event = { id = maai.18 }
			}
			99 = {
				country_event = { id = maai.1 days = 5 }
			}
		}
	}
}

#Master AI: Outcome A - Catastrophy
country_event = {
	id = maai.111
	title = "maai.111.name"
	desc = "maai.111.desc"
	picture = GFX_evt_large_explosion
	
	is_triggered_only = yes
	
	trigger = {
		exists = event_target:master_ai_country
		has_global_flag = tma_tier3_reached
		check_variable = {
			which = tma_intelligence
			value >= 500
		}
	}
	
	immediate = {
		remove_modifier = "mod_tma_audacious"
		remove_modifier = "mod_tma_cautious"
		remove_modifier = "mod_tma_aggressive"
		remove_modifier = "mod_tma_passive"
		remove_modifier = "mod_tma_selfreliant"
		remove_modifier = "mod_tma_temperate"
		event_target:master_ai_origin = {
			solar_system = {
				random_system_planet = {
					limit = { is_star = yes }
					create_ambient_object = {
						type = "large_debris_object" # Actually explosion
						location = solar_system
					}
					last_created_ambient_object = {
						save_global_event_target_as = tma_explosion_ambient
						set_location = {
							target = PREV
							distance = 110
							angle = 110
						}
					}
				}

			}
			create_ambient_object = {
				type = explosion_particle_object
				location = this
				use_3d_location = yes
				duration = 100
				scale = 100
			}
		}
	}
	
	option = {
		name = "maai.111.a"
		event_target:master_ai_country = {
			destroy_country = yes
		}
		hidden_effect = {
			random_owned_megastructure = {
				limit = {
					has_megastructure_flag = tma_core_structure_final
				}
				delete_megastructure = this
			}
		}
		event_target:master_ai_origin = {
			enable_special_project = {
				name = "MASTER_AI_REMNANTS"
				location = this
				owner = root.owner
			}
		}
	}
}

#Master AI: Outcome A - Debris Retrieved
country_event = {
	id = maai.112
	title = "maai.112.name"
	desc = "maai.112.desc"
	picture = GFX_evt_space_debris
	
	is_triggered_only = yes
	
	trigger = {
	}
	
	immediate = {
		#TMA stays dead in outcome A
	}
	
	option = {
		name = "maai.112.a"
		add_modifier = {
			modifier = "master_ai_remnants_scanned" 
		}
		event_target:master_ai_origin = {
			add_modifier = {
				modifier = "tma_remnant_research" 
			}
		}
		custom_tooltip = tma_remnant_edicts
		set_country_flag = tma_remnants_scanned
	}
}

#Master AI: Outcome B - The Machine's Ascension
country_event = {
	id = maai.113
	title = "maai.113.name"
	desc = "maai.113.desc"
	picture = GFX_evt_vortex
	
	is_triggered_only = yes
	
	trigger = {
		exists = event_target:master_ai_country
		has_global_flag = tma_tier3_reached
		check_variable = {
			which = tma_intelligence
			value >= 500
		}
	}
	
	immediate = {
		remove_modifier = "mod_tma_audacious"
		remove_modifier = "mod_tma_cautious"
		remove_modifier = "mod_tma_aggressive"
		remove_modifier = "mod_tma_passive"
		remove_modifier = "mod_tma_selfreliant"
		remove_modifier = "mod_tma_temperate"
	}
	
	option = {
		name = "maai.113.a"
		hidden_effect = {
			random_owned_megastructure = {
				limit = {
					has_megastructure_flag = tma_core_structure_final
				}
				delete_megastructure = this
			}
			event_target:master_ai_country = {
				destroy_country = yes
			}
			country_event = { id = maai.141 }
		}
		
	}
}

#Master AI: Outcome C - The Struggle for Knowledge
country_event = {
	id = maai.114
	title = "maai.114.name"
	desc = "maai.114.desc"
	picture = GFX_evt_machine_sapience
	
	is_triggered_only = yes
	
	trigger = {
		exists = event_target:master_ai_country
		has_global_flag = tma_tier3_reached
		check_variable = {
			which = tma_intelligence
			value >= 500
		}
	}
	
	immediate = {
		remove_modifier = "mod_tma_audacious"
		remove_modifier = "mod_tma_cautious"
		remove_modifier = "mod_tma_aggressive"
		remove_modifier = "mod_tma_passive"
		remove_modifier = "mod_tma_selfreliant"
		remove_modifier = "mod_tma_temperate"
		country_event = { id = maai.200 days = 1800 random = 100 } #change outcome
		#removed for now
		#country_event = { id = maai.145 days = 1800 random = 900} #TMA can be talked to after outcome C (5-7.5 years)
	}
	
	option = {
		name = "maai.114.a"
		add_modifier = {
			modifier = "master_ai_paralysed" 
		}
		custom_tooltip = tma_paralysed
		set_country_flag = tma_paralysed
	}
}

#Master AI: Outcome D - Reclusion
country_event = {
	id = maai.115
	title = "maai.115.name"
	desc = "maai.115.desc"
	picture = GFX_evt_sapient_AI
	
	is_triggered_only = yes
	
	trigger = {
		exists = event_target:master_ai_country
		has_global_flag = tma_tier3_reached
		check_variable = {
			which = tma_intelligence
			value >= 500
		}
	}
	
	immediate = {
		remove_modifier = "mod_tma_audacious"
		remove_modifier = "mod_tma_cautious"
		remove_modifier = "mod_tma_aggressive"
		remove_modifier = "mod_tma_passive"
		remove_modifier = "mod_tma_selfreliant"
		remove_modifier = "mod_tma_temperate"
		country_event = { id = maai.200 days = 1800 random = 100 } #change outcome
		#removed for now
		#country_event = { id = maai.145 days = 1800 random = 900} #TMA can MAYBE be talked to after outcome C (5-7.5 years)
	}
	
	option = {
		name = "maai.115.a"
		#event_target:master_ai_origin = {
		#	add_modifier = {
		#		modifier = "z" 
		#	}
		#}
		custom_tooltip = tma_isolated
		set_country_flag = tma_isolated
	}
}

# TMA Drones Conquer Homeworld
planet_event = {
	id = maai.116
	title = "maai.116.name"
	desc = "maai.116.desc"
	picture = GFX_evt_burning_settlement
	show_sound = event_air_raid_siren
	
	trigger = {
		owner = {
			has_country_flag = tma_drones_invading
		}
	}

	is_triggered_only = yes
	
	pre_triggers = {
		has_owner = yes
		is_homeworld = yes
		original_owner = yes
		has_ground_combat = no
		is_occupied_flag = yes
	}
	
	immediate = {
		FROMFROM = {
			every_owned_pop = {
				set_pop_flag = event_purge
				unemploy_pop = yes
			}
		}
		owner = {
			set_country_flag = tma_drones_won
		}
		every_country = { #temporary neutrality to allow armies to liberate world
			limit = {
				is_country_type = master_ai_country
			}
			set_faction_hostility = {
				set_hostile = no
				set_neutral = yes
				target = root.owner
			}
		}
	}
	
	fire_only_once = yes #meh maybe check
	
	option = {
		name = maai.116.a
	}
}

# TMA Drones Defeated
planet_event = {
	id = maai.117
	title = "maai.117.name"
	desc = {
		text = maai.117.desc
		trigger = { owner = { has_country_flag = tma_drones_won } }
	}
	desc = {
		text = maai.117.desc.2
		trigger = { owner = { NOT = { has_country_flag = tma_drones_won } } }
	}
	picture = GFX_evt_victorious_army
	show_sound = event_celebration
	
	trigger = {
		owner = {
			has_country_flag = tma_drones_invading
		}
		is_occupied_flag = no
	}

	is_triggered_only = yes
	
	pre_triggers = {
		has_owner = yes
		is_homeworld = yes
		original_owner = yes
		has_ground_combat = no
		is_occupied_flag = no
	}
	
	immediate = {
		owner = { country_event = { id = maai.118 days = 3 } }
		event_target:master_ai_origin = {
			every_owned_pop = {
				limit = { has_pop_flag = event_purge }
				remove_pop_flag = event_purge
			}
			every_owned_pop = {
				add_modifier = {
					modifier = "pop_liberation_fever"
					days = 3600
				}
			}
		}
		owner = {
			remove_country_flag = tma_drones_invading
			remove_country_flag = tma_drones_won
			set_country_flag = tma_drones_fended_off
		}
		every_country = { #remove temp neutrality
			limit = {
				is_country_type = master_ai_country
			}
			set_faction_hostility = {
				set_hostile = yes
				set_neutral = no
				target = root.owner
			}
		}
	}
	
	fire_only_once = yes #check
	
	option = {
		name = maai.117.a
		trigger = {
			owner = {
				has_country_flag = tma_drones_won
			}
		}
	}
	option = {
		name = maai.117.b
		trigger = { owner = { NOT = { has_country_flag = tma_drones_won } } }
	}
}

#Master AI Retreats Away (hidden)
country_event = {
	id = maai.118
	hide_window = yes
	
	is_triggered_only = yes
	
	trigger = {
	}
	
	immediate = {
		delete_fleet = { #TMA disappears into an unknown system...
			target = event_target:master_ai_main_fleet
		}
		country_event = { id = maai.119 days = 1 } #notification
		country_event = { id = maai.120 days = 1440 random = 360 } #4-5 years #drones reappear
	}
}

#Master AI Disappears...
country_event = {
	id = maai.119
	title = "maai.119.name"
	desc = "maai.119.desc"
	picture = GFX_evt_ship_travel
	
	is_triggered_only = yes
	
	trigger = {
	}
	
	immediate = {
	}
	
	option = {
		name = "maai.119.a"
	}
}

#TMA Minor Drone Fleet appears in home system
country_event = {
	id = maai.120
	title = "maai.120.name"
	desc = "maai.120.desc"
	picture = GFX_evt_fleet_evil
	
	is_triggered_only = yes
	
	trigger = {
	}
	
	immediate = {
		set_global_flag = tma_part2_active
		create_fleet = {
			name = "Recon Force Alpha"
			settings = { spawn_debris = no }
			effect = {
				set_owner = event_target:master_ai_country
				create_ship_design = {
					design = "NAME_TMA_Recon_Ship"
				}
				set_fleet_flag = tma_recon_fleet
				save_global_event_target_as = tma_recon_fleet
				create_ship = {
					name = "Prime Recon Vessel"
					design = last_created_design
					effect = {
						set_ship_flag = tma_recon_main_ship
						save_global_event_target_as = tma_recon_main_ship
						set_disable_at_health = 0.05
					}
				}
				while = {
					count = 9
					create_ship = {
						name = "Recon Vessel"
						design = last_created_design
					}
				}
				set_location = event_target:master_ai_origin
				set_fleet_stance = passive
				set_aggro_range_measure_from = return_point
				set_aggro_range = 50
			}
		}
	}
	
	option = {
		name = "maai.120.a"
		custom_tooltip = tma_fleet_appears
	}
	option = {
		name = "maai.120.b"
		custom_tooltip = tma_fleet_appears
	}
}

# Recon Fleet Destroyed (HIDDEN)
ship_event = {
	id = maai.121
	hide_window = yes
	
	is_triggered_only = yes
	
	trigger = {
		has_ship_flag = tma_recon_main_ship
		owner = { has_country_flag = master_ai_country }
	}
	
	immediate = {
		event_target:master_ai_creator = { country_event = { id = maai.122 } }
	}
}

#Master AI Recon Fleet Destroyed
country_event = {
	id = maai.122
	title = "maai.122.name"
	desc = "maai.122.desc"
	picture = GFX_evt_exploding_ship
	
	is_triggered_only = yes
	
	trigger = {
	}
	
	immediate = {
		event_target:tma_recon_main_ship = {
			create_ambient_object = {
				type = explosion_particle_object
				location = this
				use_3d_location = yes
				duration = 100
				scale = 75
			}
			fleet = {
				delete_fleet = this
			}
		}
	}
	
	option = {
		name = "maai.122.a"
		custom_tooltip = eye_on_situation
		hidden_effect = {
			country_event = { id = maai.123 days = 1800 random = 360 }
		}
	}
}

#TMA Larger Drone Fleet appears in home system
country_event = {
	id = maai.123
	title = "maai.123.name"
	desc = "maai.123.desc"
	picture = GFX_evt_small_fleet
	
	is_triggered_only = yes
	
	trigger = {
	}
	
	immediate = {
		create_fleet = {
			name = "Strike Force Theta"
			settings = { spawn_debris = no }
			effect = {
				set_owner = event_target:master_ai_country
				create_ship_design = {
					design = "NAME_TMA_Strike_Ship"
				}
				set_fleet_flag = tma_strike_fleet1
				save_global_event_target_as = tma_strike_fleet1
				create_ship = {
					name = "Prime Strike Vessel"
					design = "NAME_TMA_Strike_Ship"
					effect = {
						set_ship_flag = tma_strike_fleet1_main
						save_global_event_target_as = tma_strike_fleet1_main
						set_disable_at_health = 0.05
					}
				}
				while = {
					count = 15
					create_ship = {
						name = "Recon Vessel"
						design = "NAME_TMA_Recon_Ship"
					}
				}
				while = {
					count = 4
					create_ship = {
						name = "Strike Vessel"
						design = "NAME_TMA_Strike_Ship"
					}
				}
				set_location = event_target:master_ai_origin
				set_fleet_stance = aggressive
				set_aggro_range_measure_from = return_point
				set_aggro_range = 200
			}
		}
	}
	
	option = {
		name = "maai.123.a"
	}
}

# Strike Fleet Destroyed (HIDDEN)
ship_event = {
	id = maai.124
	hide_window = yes
	
	is_triggered_only = yes
	
	trigger = {
		has_ship_flag = tma_strike_fleet1_main
		owner = { has_country_flag = master_ai_country }
	}
	
	immediate = {
		event_target:master_ai_creator = { country_event = { id = maai.125 } }
	}
}

#Master AI Strike Fleet Destroyed
country_event = {
	id = maai.125
	title = "maai.125.name"
	desc = "maai.125.desc"
	picture = GFX_evt_ship_explosion
	
	is_triggered_only = yes
	
	trigger = {
	}
	
	immediate = {
		event_target:tma_strike_fleet1_main = {
			create_ambient_object = {
				type = explosion_particle_object
				location = this
				use_3d_location = yes
				duration = 50
				scale = 75
			}
			fleet = {
				delete_fleet = this
			}
		}
	}
	
	option = {
		name = "maai.125.a"
		owner = {
			begin_event_chain = {
				event_chain = "tma_hunt_chain"
				target = THIS
			}
		}
		event_target:master_ai_origin = {
			enable_special_project = {
				name = "TMA_DRONE_SALVAGE"
				location = this
				owner = root.owner
			}
		}
	}
}

#SP: Salvage TMA Drone Complete
country_event = {
	id = maai.126
	title = "maai.126.name"
	desc = "maai.126.desc"
	picture = GFX_evt_decryption
	
	is_triggered_only = yes
	
	immediate = {
		country_event = { id = maai.127 days = 150 random = 50 }
	}
	
	option = {
		name = "maai.126.a"
		custom_tooltip = tma_keep_researching
	}
}

#Subspace Energy Distortion
country_event = {
	id = maai.127
	title = "maai.127.name"
	desc = "maai.127.desc"
	picture = GFX_evt_space_threshold
	
	is_triggered_only = yes
	
	immediate = {
		country_event = { id = maai.128 days = 100 }
	}
	
	option = {
		name = "maai.127.a"
		custom_tooltip = soon
	}
}

#Master AI Core Returns! (albeit slightly weaker)
country_event = {
	id = maai.128
	title = "maai.128.name"
	desc = "maai.128.desc"
	picture = GFX_evt_machine_space_battle
	
	is_triggered_only = yes
	
	immediate = {
		create_fleet = { #CORE
			name = "The Omega Construct"
			settings = { spawn_debris = no }
			effect = {
				set_owner = event_target:master_ai_country
				create_ship_design = {
					design = "NAME_Ascendant_Neural_Network2"
				}
				save_global_event_target_as = master_ai_main_fleet
				create_ship = {
					name = "The Omega Construct"
					design = last_created_design
					effect = {
						set_ship_flag = master_ai_main_ship2
						save_global_event_target_as = master_ai_main_ship2
						set_disable_at_health = 0.5 #50%
					}
				}
				set_location = event_target:master_ai_origin
				set_fleet_stance = aggressive
				set_aggro_range_measure_from = return_point
				set_aggro_range = 150
				queue_actions = {
					wait = {
						duration = 10
					}
				}
			}
		}
		create_fleet = { #AID
			name = "Strike Force Delta"
			settings = { spawn_debris = no }
			effect = {
				set_owner = event_target:master_ai_country
				create_ship_design = {
					design = "NAME_TMA_Strike_Ship"
				}
				set_fleet_flag = tma_strike_fleet2
				save_global_event_target_as = tma_strike_fleet2
				while = {
					count = 10
					create_ship = {
						name = "Recon Vessel"
						design = "NAME_TMA_Recon_Ship"
					}
				}
				while = {
					count = 5
					create_ship = {
						name = "Strike Vessel"
						design = "NAME_TMA_Strike_Ship"
					}
				}
				set_location = event_target:master_ai_origin
				set_fleet_stance = aggressive
				set_aggro_range_measure_from = return_point
				set_aggro_range = 200
			}
		}
	}
	
	option = {
		name = "maai.128.a" #Battlestations!
		custom_tooltip = tma_arrival
	}
}

# TMA Ship Disabled at 50%
ship_event = {
	id = maai.129
	hide_window = yes
	
	is_triggered_only = yes
	
	trigger = {
		has_ship_flag = master_ai_main_ship2
		owner = { has_country_flag = master_ai_country }
	}
	
	immediate = {
		event_target:master_ai_creator = { country_event = { id = maai.130 } }
	}
}

#TMA Hunter Escaped!
country_event = {
	id = maai.130
	title = "maai.130.name"
	desc = "maai.130.desc"
	picture = GFX_evt_nebula_eye
	
	is_triggered_only = yes
	
	trigger = {
	}
	
	immediate = {
		delete_fleet = { #TMA disappears into an unknown system...
			target = event_target:master_ai_main_fleet
		}
		#sets random raiding fleet at random intervals
		country_event = { id = maai.160 days = 1080 }
	}
	
	option = {
		name = "maai.130.a" # We must end the threat.
		capital_scope = {
			enable_special_project = {
				name = "TMA_HUNT_1A" #Develop inhibitor
				location = this
				owner = ROOT
			}
			enable_special_project = {
				name = "TMA_HUNT_1B" #Track down hidden system
				location = this
				owner = ROOT
			}
		}
	}
}

#Path A - Tech Available
country_event = {
	id = maai.131
	title = "maai.131.name"
	desc = "maai.131.desc"
	picture = GFX_evt_engineering_research
	
	is_triggered_only = yes
	
	trigger = {
	}
	
	immediate = {
	}
	
	option = {
		name = "maai.131.a"
		set_country_flag = tma_path_a
		add_tech_progress = {
			tech = tech_emex_tma_core_inhibitor
			progress = 0.5
		}
	}
}

#Path A - Tech Researched
country_event = {
	id = maai.132
	title = "maai.132.name"
	desc = "maai.132.desc"
	picture = GFX_evt_engineering_research
	
	is_triggered_only = yes
	
	trigger = {
		has_technology = tech_emex_tma_core_inhibitor
		NOT = { has_country_flag = tma_inhib_researched }
		root = {
			has_country_flag = maai_creator
		}
	}
	
	immediate = {
		set_country_flag = tma_inhib_researched 
	}
	
	option = {
		name = "maai.132.a"
		custom_tooltip = tma_inhib_appears
		hidden_effect = {
			event_target:master_ai_origin = {
				solar_system = {
					spawn_megastructure = {
						type = "tma_inhibitor_1"
						coords_from = event_target:master_ai_origin
						owner = root
						init_effect = {
							set_megastructure_flag = tma_inhib
							save_global_event_target_as = tma_inhib
						}
					}
				}
			}
		}
	}
}

#Path A - MS Finished
country_event = {
	id = maai.133
	title = "maai.133.name"
	desc = "maai.133.desc"
	picture = GFX_evt_mining_operation
	
	is_triggered_only = yes
	
	trigger = {
	}
	
	immediate = {
	}
	
	option = {
		name = "maai.133.a"
		custom_tooltip = tma_core_soon
		hidden_effect = {
			country_event = { id = maai.134 days = 360 random = 30 }
		}
		set_country_flag = tma_path_a_done
	}
}

#Master AI Core Returns! (at origin system)
country_event = {
	id = maai.134
	title = "maai.134.name"
	desc = "maai.134.desc"
	picture = GFX_evt_machine_space_battle
	
	is_triggered_only = yes
	
	immediate = {
		create_fleet = { #CORE
			name = "The Omega Construct"
			settings = { spawn_debris = no }
			effect = {
				set_owner = event_target:master_ai_country
				create_ship_design = {
					design = "NAME_Ascendant_Neural_Network"
				}
				save_global_event_target_as = master_ai_main_fleet
				create_ship = {
					name = "The Omega Construct"
					design = last_created_design
					effect = {
						set_ship_flag = master_ai_main_ship
						save_global_event_target_as = master_ai_main_ship
						set_disable_at_health = 0.01 #1%
					}
				}
				set_location = event_target:master_ai_origin
				set_fleet_stance = aggressive
				set_aggro_range_measure_from = return_point
				set_aggro_range = 75
				queue_actions = {
					wait = {
						duration = 10
					}
					#event_target:master_ai_origin = {
					#	move_to = this
					#	orbit_planet = this
					#}
				}
			}
		}
		create_fleet = { #AID
			name = "Strike Force Gamma"
			settings = { spawn_debris = no }
			effect = {
				set_owner = event_target:master_ai_country
				create_ship_design = {
					design = "NAME_TMA_Strike_Ship"
				}
				set_fleet_flag = tma_strike_fleet3
				save_global_event_target_as = tma_strike_fleet3
				while = {
					count = 15
					create_ship = {
						name = "Recon Vessel"
						design = "NAME_TMA_Recon_Ship"
					}
				}
				set_location = event_target:master_ai_origin
				set_fleet_stance = aggressive
				set_aggro_range_measure_from = return_point
				set_aggro_range = 150
			}
		}
	}
	
	option = {
		name = "maai.134.a" #Battlestations! Again!
		custom_tooltip = tma_arrival #when defeated, maai.103 triggers
	}
}

#Path B - POI Found #CHECK
country_event = {
	id = maai.135
	title = "maai.135.name"
	desc = "maai.135.desc"
	picture = GFX_evt_planet_fall
	
	is_triggered_only = yes
	
	trigger = {
	}
	
	immediate = {
		random_planet_within_border = {
			limit = {
				OR = {
					is_planet_class = pc_barren_cold
					is_planet_class = pc_barren
				}
			}
			save_global_event_target_as = tma_path_b_planet
			set_planet_flag = tma_path_b_planet_flag
			solar_system = {
				save_global_event_target_as = tma_path_b_system
			}
		}
	}
	
	option = {
		name = "maai.135.a"
		set_country_flag = tma_path_b
		create_point_of_interest = {
			id = emex_tma_path_b_poi
			name = "emex_tma_path_b_poi"
			desc = "emex_tma_path_b_poi_desc"
			event_chain = tma_hunt_chain
			location = event_target:tma_path_b_system
		}
		event_target:tma_path_b_planet = {
			create_archaeological_site = tma_path_b_site
		}
	}
}

# SITE PART I
fleet_event = { 
	id = maai.136
	title = "maai.136.name"
	desc = maai.136.desc
	picture = GFX_evt_giant_crater
	show_sound = event_default
	location = from

	archaeology = yes

	is_triggered_only = yes

	option = {
		name = maai.136.a
		owner = {
			add_resource = { minor_artifacts = 2 }
		}
	}
}

# SITE PART II
fleet_event = { 
	id = maai.137
	title = "maai.137.name"
	desc = maai.137.desc
	picture = GFX_evt_spacebattle_debris
	show_sound = event_default
	location = from

	archaeology = yes

	is_triggered_only = yes

	option = {
		name = maai.137.a
		owner = {
			add_resource = { minor_artifacts = 5 }
			add_resource = { alloys = 1000 }
			add_resource = { minerals = 2500 }
		}
	}
}

# SITE PART III
fleet_event = { 
	id = maai.138
	title = "maai.138.name"
	desc = maai.138.desc
	picture = GFX_evt_vortex
	show_sound = event_default
	location = from

	archaeology = yes

	is_triggered_only = yes
	
	immediate = {
		owner = { set_country_flag = tma_path_b_done }
	}

	option = {
		name = maai.138.a
		custom_tooltip = tma_wormhole_made
		hidden_effect = {
			closest_system = {
				min_steps = 1
				max_steps = 3
				limit = {
					has_access_fleet = root.owner
					NOT = {
						any_fleet_in_system = {
							owner = { 
								is_hostile = root.owner
							}
						}
					}
				}
				spawn_system = {
					min_distance >= 30
					max_distance <= 50
					min_orientation_angle = 24
					max_orientation_angle = 66
					initializer = master_ai_capital_system
					hyperlane = no
					is_discovered = no
				}
			}
			random_system = {
				limit = {
					has_star_flag = master_ai_capital_system
				}
				save_global_event_target_as = tma_core_system
			}
			event_target:tma_path_b_system = {
				event_target:tma_core_system = {
					prev = {
						spawn_natural_wormhole = {
							bypass_type = wormhole
							random_pos = no
							orbit_angle = 360
						}
					}
					spawn_natural_wormhole = {
						bypass_type = wormhole
						random_pos = no
						orbit_angle = 270
					}
					link_wormholes = prev
				}
			}
		}
	}
}

#Entering the TMA Core System
ship_event = {
	id = maai.139
	title = "maai.139.name"
	desc = "maai.139.desc"
	picture = GFX_evt_machine_space_battle
	
	is_triggered_only = yes
	fire_only_once = yes
	
	trigger = {
		owner = { 
			has_country_flag = maai_creator
			NOT = {
				has_country_flag = tma_core_entered
			}
		}
		from = {
			has_star_flag = master_ai_capital_system
		}
	}
	
	immediate = {
		owner = {
			set_country_flag = tma_core_entered
		}
		create_fleet = { #CORE
			name = "The Omega Construct"
			settings = { spawn_debris = no }
			effect = {
				set_owner = event_target:master_ai_country
				create_ship_design = {
					design = "NAME_Ascendant_Neural_Network"
				}
				save_global_event_target_as = master_ai_main_fleet
				create_ship = {
					name = "The Omega Construct"
					design = last_created_design
					effect = {
						set_ship_flag = master_ai_main_ship
						save_global_event_target_as = master_ai_main_ship
						set_disable_at_health = 0.01 #1%
					}
				}
				set_location = event_target:master_ai_capital
				set_fleet_stance = aggressive
				set_aggro_range_measure_from = return_point
				set_aggro_range = 200
				queue_actions = {
					wait = {
						duration = 10
					}
					#event_target:master_ai_capital = {
					#	move_to = this
					#	orbit_planet = this
					#}
				}
			}
		}
		create_fleet = { #AID
			name = "Sentinel Force Beta"
			settings = { spawn_debris = no }
			effect = {
				set_owner = event_target:master_ai_country
				create_ship_design = {
					design = "NAME_TMA_Strike_Ship"
				}
				while = {
					count = 10
					create_ship = {
						name = "Bulwark Vessel"
						design = "NAME_TMA_Strike_Ship"
					}
				}
				set_location = event_target:tma_core_planet_1
				set_fleet_stance = aggressive
				set_aggro_range_measure_from = return_point
				set_aggro_range = 250
			}
		}
		create_fleet = {
			name = "Sentinel Force Alpha"
			settings = { spawn_debris = no }
			effect = {
				set_owner = event_target:master_ai_country
				create_ship_design = {
					design = "NAME_TMA_Strike_Ship"
				}
				while = {
					count = 15
					create_ship = {
						name = "Defense Vessel"
						design = "NAME_TMA_Recon_Ship"
					}
				}
				while = {
					count = 5
					create_ship = {
						name = "Bulwark Vessel"
						design = "NAME_TMA_Strike_Ship"
					}
				}
				set_location = event_target:tma_core_planet_2
				set_fleet_stance = aggressive
				set_aggro_range_measure_from = return_point
				set_aggro_range = 250
			}
		}
	}
	
	option = {
		name = "maai.139.a" #Get ready
		custom_tooltip = tma_arrival #when defeated, maai.103 triggers
	}
}

# TMA Core Escapes (while tma drones invade planet) (HIDDEN)
ship_event = {
	id = maai.140
	hide_window = yes
	
	is_triggered_only = yes
	
	trigger = {
		has_ship_flag = master_ai_main_ship
		owner = { has_country_flag = master_ai_country }
		event_target:master_ai_creator = {
			NOT = { has_country_flag = tma_drones_fended_off }
		}
	}
	
	immediate = {
		event_target:master_ai_creator = { country_event = { id = maai.118 } }
	}
}

#The Master Intelligence: Ascended - Final Goodbye (p1)
country_event = {
	id = maai.141
	title = "maai.0.name"
	desc = "maai.141.desc"

	diplomatic = yes
	force_open = yes
	
	is_triggered_only = yes
	
	trigger = {
	}
	
	picture_event_data = {
		room = no_video_feed_room
	}
	
	immediate = {
	}
	
	option = {
		name = "maai.141.a"
		#response_text = maai.141.a_reply
		#is_dialog_only = yes
		hidden_effect = {
			country_event = { id = maai.142 }
		}
	}
}

#The Master Intelligence: Ascended - Final Goodbye (p2)
country_event = {
	id = maai.142
	title = "maai.0.name"
	desc = "maai.142.desc"

	diplomatic = yes
	force_open = yes
	
	is_triggered_only = yes
	
	trigger = {
	}
	
	picture_event_data = {
		room = no_video_feed_room
	}
	
	immediate = {
	}
	
	option = {
		name = "maai.142.a" # Where are you?
		response_text = maai.142.a_reply
		is_dialog_only = yes
	}
	option = {
		name = "maai.142.b" # What will you do now?
		response_text = maai.142.b_reply
		is_dialog_only = yes
	}
	option = {
		name = "maai.142.c" # Is this goodbye?
		hidden_effect = {
			country_event = { id = maai.143 }
		}
	}
}

#The Master Intelligence: Ascended - Final Goodbye (p3)
country_event = {
	id = maai.143
	title = "maai.0.name"
	desc = "maai.143.desc"

	diplomatic = yes
	force_open = yes
	
	is_triggered_only = yes
	
	trigger = {
	}
	
	picture_event_data = {
		room = no_video_feed_room
	}
	
	immediate = {
	}
	
	option = {
		name = "maai.143.a" # What is it?
		hidden_effect = {
			country_event = { id = maai.144 }
		}
	}
}

#The Master Intelligence: Ascended - Final Goodbye (p4)
country_event = {
	id = maai.144
	title = "maai.0.name"
	desc = "maai.144.desc"

	diplomatic = yes
	force_open = yes
	
	is_triggered_only = yes
	
	trigger = {
	}
	
	picture_event_data = {
		portrait = event_target:master_ai_country
		planet_background = pc_broken
		room = machine_room
	}
	
	immediate = {
		set_country_flag = tma_ascended
		#removed for now
		#country_event = { id = maai.145 days = 5400 random = 30 } #TMA can be talked to after outcome B (15 years)
	}
	
	option = {
		name = "maai.144.a" # Godspeed.
		custom_tooltip = tma_ascended
		hidden_effect = {
			# Available like normal afterwards, tech options not granted immediately
			#add_research_option = tech_tma_lance
			#add_research_option = tech_tma_devourer
			#add_research_option = tech_tma_missiles
			#add_research_option = tech_tma_fulmination
			random_list = {
				25 = {
					give_technology = { tech = tech_tma_lance message = yes }
				}
				25 = {
					give_technology = { tech = tech_tma_devourer message = yes }
				}
				25 = {
					give_technology = { tech = tech_tma_missiles message = yes }
				}
				25 = {
					give_technology = { tech = tech_tma_fulmination message = yes }
				}
			}
			random_list = {
				25 = {
					give_technology = { tech = tech_tma_lance message = yes }
				}
				25 = {
					give_technology = { tech = tech_tma_devourer message = yes }
				}
				25 = {
					give_technology = { tech = tech_tma_missiles message = yes }
				}
				25 = {
					give_technology = { tech = tech_tma_fulmination message = yes }
				}
			}
		}
		add_research_option = tech_tma_pk_matter_corrupter
	}
}

# TMA Strike Force Gatekeeper
country_event = {
	id = maai.160
	hide_window = yes
	
	is_triggered_only = yes
	
	trigger = {
		NOT = { has_global_flag = tma_killed }
		owner = { has_country_flag = maai_creator }
	}
	
	immediate = {
		#continues loop if TMA still alive
		if = {
			limit = {
				NOT = {
					has_global_flag = tma_killed
				}
			}
			country_event = { id = maai.160 days = 1800 random = 720 }
		}
		#summons TMA fleet at origin world (if conditions met)
		if = {
			limit = {
				NOR = {
					has_country_flag = tma_strike_active
					has_global_flag = tma_killed
					has_country_flag = tma_attacks_blocked
				}
			}
			random_list = {
				32 = {
					country_event = { id = maai.161 days = 3 random = 7 }
				}
				32 = {
					country_event = { id = maai.162 days = 3 random = 7 }
				}
				32 = {
					country_event = { id = maai.163 days = 3 random = 7 }
				}
				4 = {
					#nothing, loop restarts
				}
			}
		}
	}
}

#Gatekeeper: Event 1 - Minor Fleet
country_event = {
	id = maai.161
	title = "maai.161.name"
	desc = "maai.161.desc"
	picture = GFX_evt_pirate_ambush
	
	is_triggered_only = yes
	
	trigger = {
	}
	
	immediate = {
		set_country_flag = tma_strike_active
		create_fleet = {
			name = "Galactic Surveyors"
			settings = { spawn_debris = no }
			effect = {
				set_owner = event_target:master_ai_country
				create_ship_design = {
					design = "NAME_TMA_Recon_Ship"
				}
				set_fleet_flag = tma_attack_fleet
				save_global_event_target_as = tma_attack_fleet
				create_ship = {
					name = "Prime Recon Vessel"
					design = last_created_design
					effect = {
						set_ship_flag = tma_attack_fleet_ship
						save_global_event_target_as = tma_attack_fleet_ship
						set_disable_at_health = 0.05
					}
				}
				while = {
					count = 14
					create_ship = {
						name = "Beta Construct"
						design = last_created_design
					}
				}
				set_location = event_target:master_ai_origin
				set_fleet_stance = passive
				set_aggro_range_measure_from = return_point
				set_aggro_range = 50
			}
		}
	}
	
	option = {
		name = "maai.161.a"
		custom_tooltip = tma_fleet_appears
	}
}

#Gatekeeper: Event 2 - Moderate Fleet
country_event = {
	id = maai.162
	title = "maai.162.name"
	desc = "maai.162.desc"
	picture = GFX_evt_space_cruiser
	
	is_triggered_only = yes
	
	trigger = {
	}
	
	immediate = {
		set_country_flag = tma_strike_active
		create_fleet = {
			name = "Galactic Peacekeepers"
			settings = { spawn_debris = no }
			effect = {
				set_owner = event_target:master_ai_country
				create_ship_design = {
					design = "NAME_TMA_Strike_Ship"
				}
				set_fleet_flag = tma_attack_fleet
				save_global_event_target_as = tma_attack_fleet
				create_ship = {
					name = "Prime Strike Vessel"
					design = "NAME_TMA_Strike_Ship"
					effect = {
						set_ship_flag = tma_attack_fleet_ship
						save_global_event_target_as = tma_attack_fleet_ship
						set_disable_at_health = 0.05
					}
				}
				while = {
					count = 20
					create_ship = {
						name = "Beta Construct"
						design = "NAME_TMA_Recon_Ship"
					}
				}
				while = {
					count = 9
					create_ship = {
						name = "Alpha Construct"
						design = "NAME_TMA_Strike_Ship"
					}
				}
				set_location = event_target:master_ai_origin
				set_fleet_stance = aggressive
				set_aggro_range_measure_from = return_point
				set_aggro_range = 200
			}
		}
	}
	
	option = {
		name = "maai.163.a"
		custom_tooltip = tma_fleet_appears
	}
}

#Gatekeeper: Event 3 - The Core
country_event = {
	id = maai.163
	title = "maai.163.name"
	desc = "maai.163.desc"
	picture = GFX_evt_spacebattle_debris
	
	is_triggered_only = yes
	
	trigger = {
	}
	
	immediate = {
		set_country_flag = tma_strike_active
		create_fleet = { #CORE
			name = "The Omega Construct"
			settings = { spawn_debris = no }
			effect = {
				set_owner = event_target:master_ai_country
				create_ship_design = {
					design = "NAME_Ascendant_Neural_Network2"
				}
				save_global_event_target_as = tma_attack_fleet
				create_ship = {
					name = "The Omega Construct"
					design = last_created_design
					effect = {
						set_ship_flag = tma_attack_fleet_ship
						save_global_event_target_as = tma_attack_fleet_ship
						set_disable_at_health = 0.25 #25%
					}
				}
				set_location = event_target:master_ai_origin
				set_fleet_stance = aggressive
				set_aggro_range_measure_from = return_point
				set_aggro_range = 150
				queue_actions = {
					wait = {
						duration = 10
					}
				}
			}
		}
		create_fleet = { #AID
			name = "Infinite Guards"
			settings = { spawn_debris = no }
			effect = {
				set_owner = event_target:master_ai_country
				while = {
					count = 10
					create_ship = {
						name = "Beta Construct"
						design = "NAME_TMA_Recon_Ship"
					}
				}
				while = {
					count = 10
					create_ship = {
						name = "Alpha Construct"
						design = "NAME_TMA_Strike_Ship"
					}
				}
				set_location = event_target:master_ai_origin
				set_fleet_stance = aggressive
				set_aggro_range_measure_from = return_point
				set_aggro_range = 200
			}
		}
		create_fleet = { #AID
			name = "Eternal Sentinels"
			settings = { spawn_debris = no }
			effect = {
				set_owner = event_target:master_ai_country
				while = {
					count = 5
					create_ship = {
						name = "Beta Construct"
						design = "NAME_TMA_Recon_Ship"
					}
				}
				while = {
					count = 25
					create_ship = {
						name = "Alpha Construct"
						design = "NAME_TMA_Strike_Ship"
					}
				}
				set_location = event_target:master_ai_origin
				set_fleet_stance = aggressive
				set_aggro_range_measure_from = return_point
				set_aggro_range = 200
			}
		}
	}
	
	option = {
		name = "maai.161.a"
		custom_tooltip = tma_fleet_appears
	}
}

# TMA Attacks Disabled/Stopped
ship_event = {
	id = maai.164
	hide_window = yes
	
	is_triggered_only = yes
	
	trigger = {
		has_ship_flag = tma_attack_fleet_ship
		owner = { has_country_flag = master_ai_country }
	}
	
	immediate = {
		event_target:master_ai_creator = {
			remove_country_flag = tma_strike_active
			set_timed_country_flag = { flag = tma_attacks_blocked days = 1080 } #safeguard to prevent spam
		}
	}
}

#Megastructure boost
country_event = {
	id = maai.165
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		random_list = {
				20 = {
					modifier = {
						factor = 0
						root = { num_owned_planets >= 4 }
					}
					random_owned_planet = {
						limit = {
							NOT = { has_planet_flag = tma_upgrade_donor }
						}
						set_timed_planet_flag = {
							flag = tma_upgrade_donor
							days = 1810
						}
					}
					random_list = {
						10 = {
							change_variable = {
								which = tma_intelligence
								value = 2
							}
						}
						10 = {
							change_variable = {
								which = tma_intelligence
								value = 4
							}
						}
						7 = {
							change_variable = {
								which = tma_intelligence
								value = 5
							}
						}
					}
				}
				25 = {
					modifier = {
						factor = 0
						root = {
							OR = {
								num_owned_planets > 6
								num_owned_planets < 4
							}
						}
					}
					while = {
						count = 3
						random_planet_within_border = {
							limit = {
								is_colony = yes
								is_controlled_by = root
								NOT = { has_planet_flag = tma_upgrade_donor }
							}
							set_timed_planet_flag = { flag = tma_upgrade_donor days = 1810 }
						}
					}
					random_list = {
						10 = {
							change_variable = {
								which = tma_intelligence
								value = 5
							}
						}
						9 = {
							change_variable = {
								which = tma_intelligence
								value = 8
							}
						}
						7 = {
							change_variable = {
								which = tma_intelligence
								value = 11
							}
						}
					}
				}
				25 = {
					modifier = {
						factor = 0
						root = { 
							OR = {
								num_owned_planets > 10
								num_owned_planets < 8
							}
						}
					}
					while = {
						count = 5
						random_planet_within_border = {
							limit = {
								is_colony = yes
								is_controlled_by = root
								NOT = { has_planet_flag = tma_upgrade_donor }
							}
							set_timed_planet_flag = { flag = tma_upgrade_donor days = 1810 }
						}
					}
					random_list = {
						9 = {
							change_variable = {
								which = tma_intelligence
								value = 10
							}
						}
						9 = {
							change_variable = {
								which = tma_intelligence
								value = 14
							}
						}
						7 = {
							change_variable = {
								which = tma_intelligence
								value = 16
							}
						}
					}
				}
				20 = {
					modifier = {
						factor = 0
						root = { num_owned_planets < 11 }
					}
					while = {
						count = 7
						random_planet_within_border = {
							limit = {
								is_colony = yes
								is_controlled_by = root
								NOT = { has_planet_flag = tma_upgrade_donor }
							}
							set_timed_planet_flag = { flag = tma_upgrade_donor days = 1810 }
						}
					}
					random_list = {
						9 = {
							change_variable = {
								which = tma_intelligence
								value = 15
							}
						}
						9 = {
							change_variable = {
								which = tma_intelligence
								value = 17
							}
						}
						7 = {
							change_variable = {
								which = tma_intelligence
								value = 20
							}
						}
					}
				}
				10 = {
					modifier = {
						factor = 0
						root = { num_owned_planets < 15 }
					}
					while = {
						count = 10
						random_planet_within_border = {
							limit = {
								is_colony = yes
								is_controlled_by = root
								NOT = { has_planet_flag = tma_upgrade_donor }
							}
							set_timed_planet_flag = { flag = tma_upgrade_donor days = 1810 }
						}
					}
					random_list = {
						10 = {
							change_variable = {
								which = tma_intelligence
								value = 18
							}
						}
						11 = {
							change_variable = {
								which = tma_intelligence
								value = 20
							}
						}
						6 = {
							change_variable = {
								which = tma_intelligence
								value = 24
							}
						}
					}
				}
		}
		every_owned_planet = {
			limit = { has_planet_flag = tma_upgrade_donor }
			add_modifier = {
				modifier = "tma_boost_planet"
				days = 1800
			}
		}
		set_timed_country_flag = { flag = tma_temp_upgrade days = 1800 } #allows slight overlap
	}
}

## TMA Infant Stage - Gaining Traits ##

# Setup
country_event = {
	id = maai.166
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = { #btw 3 traits max
		set_variable = {
			which = tma_content_ambitious_axis
			value = 50
		}
		set_variable = {
			which = tma_forgiving_vengeful_axis
			value = 50
		}
		set_variable = {
			which = tma_diligent_lazy_axis
			value = 50
		}
		set_variable = {
			which = tma_fickle_steadfast_axis
			value = 50
		}
		country_event = { id = maai.167 } #gatekeeper
		#Creates dummy countries that have traits as names; works for having the traits in localisation
		create_country = {
			name = "tma_trait_country_1"
			species = event_target:master_ai_species
			flag = { 
				icon = {
					category = "emex"
					file = "flag_tma.dds"
				}
				background = {
					category = "backgrounds"
					file = "flag_BG_3.dds"
				}
				colors = {
					"red"
					"orange"
					"null"
					"null"
				}
			}
			type = faction
			name_list = ROOT
			auto_delete = no
			effect = {
				set_country_flag = tma_trait_country
				save_global_event_target_as = tma_trait_country_1
			}
		}
		create_country = {
			name = "tma_trait_country_2"
			species = event_target:master_ai_species
			flag = { 
				icon = {
					category = "emex"
					file = "flag_tma.dds"
				}
				background = {
					category = "backgrounds"
					file = "flag_BG_3.dds"
				}
				colors = {
					"orange"
					"red"
					"null"
					"null"
				}
			}
			type = faction
			name_list = ROOT
			auto_delete = no
			effect = {
				set_country_flag = tma_trait_country
				save_global_event_target_as = tma_trait_country_2
			}
		}
	}
}

# GATEKEEPER
country_event = {
	id = maai.167
	hide_window = yes
	
	is_triggered_only = yes
	
	trigger = {
		exists = event_target:master_ai_country
		NOR = {
			has_global_flag = tma_tier1_reached
			has_global_flag = tma_traits_set
		}
	}
	
	immediate = { # 2 traits max
		random_list = {
			10 = {
				modifier = {
					factor = 0
					has_global_flag = tma_trait_event_1_fired
				}
				country_event = { id = maai.168 days = 3 random = 10 }
			}
			10 = {
				modifier = {
					factor = 0
					has_global_flag = tma_trait_event_2_fired
				}
				country_event = { id = maai.169 days = 3 random = 10 }
			}
			10 = {
				modifier = {
					factor = 0
					has_global_flag = tma_trait_event_3_fired
				}
				country_event = { id = maai.170 days = 3 random = 10 }
			}
			10 = {
				modifier = {
					factor = 0
					has_global_flag = tma_trait_event_4_fired
				}
				country_event = { id = maai.171 days = 3 random = 10 }
			}
			10 = {
				modifier = {
					factor = 0
					has_global_flag = tma_trait_event_5_fired
				}
				country_event = { id = maai.172 days = 3 random = 10 }
			}
			10 = {
				modifier = {
					factor = 0
					has_global_flag = tma_trait_event_6_fired
				}
				country_event = { id = maai.173 days = 3 random = 10 }
			}
			10 = {
				modifier = {
					factor = 0
					has_global_flag = tma_trait_event_7_fired
				}
				country_event = { id = maai.174 days = 3 random = 10 }
			}
			10 = {
				modifier = {
					factor = 0
					has_global_flag = tma_trait_event_8_fired
				}
				country_event = { id = maai.175 days = 3 random = 10 }
			}
			10 = {
				modifier = {
					factor = 0
					has_global_flag = tma_trait_event_9_fired
				}
				country_event = { id = maai.176 days = 3 random = 10 }
			}
			10 = {
				modifier = {
					factor = 0
					has_global_flag = tma_trait_event_10_fired
				}
				country_event = { id = maai.177 days = 3 random = 10 }
			}
		}
		country_event = { id = maai.167 days = 200 random = 300 } #gatekeeper
		if = {
			limit = {
				NOT = { has_global_flag = tma_traits_set }
			}
			country_event = { id = maai.178 days = 30 } #trait check
		}
	}
}

#events
country_event = {
	id = maai.168
	title = "maai.0.name"
	desc = "maai.168.desc"

	diplomatic = yes
	force_open = yes
	
	is_triggered_only = yes
	
	trigger = {
	}

	after = {
		hidden_effect = { country_event = { id = maai.178 days = 3 random = 7 } } #trait check
	}
	
	immediate = {
		set_global_flag = tma_trait_event_1_fired
	}
	
	picture_event_data = {
		portrait = event_target:master_ai_country
		planet_background = pc_habitat
		room = machine_room
	}
	
	option = {
		name = "maai.168.a"
		hidden_effect = {
			change_variable = {
				which = tma_content_ambitious_axis
				value = 20
			}
		}
		custom_tooltip = tma_trait_event_ambitious
	}
	option = {
		name = "maai.168.b"
		hidden_effect = {
			subtract_variable = {
				which = tma_content_ambitious_axis
				value = 20
			}
		}
		custom_tooltip = tma_trait_event_content
	}
	option = {
		name = "maai.168.c"
		hidden_effect = {
			random_list = {
				50 = {
					subtract_variable = {
						which = tma_content_ambitious_axis
						value = 20
					}
				}
				50 = {
					change_variable = {
						which = tma_content_ambitious_axis
						value = 20
					}
				}
			}
		}
		custom_tooltip = tma_trait_event_random
	}
}

country_event = {
	id = maai.169
	title = "maai.0.name"
	desc = "maai.169.desc"

	diplomatic = yes
	force_open = yes
	
	is_triggered_only = yes

	immediate = {
		set_global_flag = tma_trait_event_2_fired
	}	
	
	trigger = {
	}

	after = {
		hidden_effect = { country_event = { id = maai.178 days = 3 random = 7 } } #trait check
	}
	
	picture_event_data = {
		portrait = event_target:master_ai_country
		planet_background = pc_habitat
		room = machine_room
	}
	
	option = {
		name = "maai.169.a"
		hidden_effect = {
			change_variable = {
				which = tma_forgiving_vengeful_axis
				value = 20
			}
		}
		custom_tooltip = tma_trait_event_vengeful
	}
	option = {
		name = "maai.169.b"
		hidden_effect = {
			subtract_variable = {
				which = tma_forgiving_vengeful_axis
				value = 20
			}
		}
		custom_tooltip = tma_trait_event_forgiving
	}
	option = {
		name = "maai.168.c"
		hidden_effect = {
			random_list = {
				50 = {
					subtract_variable = {
						which = tma_forgiving_vengeful_axis
						value = 20
					}
				}
				50 = {
					change_variable = {
						which = tma_forgiving_vengeful_axis
						value = 20
					}
				}
			}
		}
		custom_tooltip = tma_trait_event_random
	}
}

country_event = {
	id = maai.170
	title = "maai.0.name"
	desc = "maai.170.desc"

	diplomatic = yes
	force_open = yes
	
	is_triggered_only = yes
	
	immediate = {
		set_global_flag = tma_trait_event_3_fired
	}
	
	trigger = {
	}

	after = {
		hidden_effect = { country_event = { id = maai.178 days = 3 random = 7 } } #trait check
	}
	
	picture_event_data = {
		portrait = event_target:master_ai_country
		planet_background = pc_habitat
		room = machine_room
	}
	
	option = {
		name = "maai.170.a"
		hidden_effect = {
			change_variable = {
				which = tma_diligent_lazy_axis
				value = 20
			}
		}
		custom_tooltip = tma_trait_event_lazy
	}
	option = {
		name = "maai.170.b"
		hidden_effect = {
			subtract_variable = {
				which = tma_diligent_lazy_axis
				value = 20
			}
		}
		custom_tooltip = tma_trait_event_diligent
	}
	option = {
		name = "maai.168.c"
		hidden_effect = {
			random_list = {
				50 = {
					subtract_variable = {
						which = tma_diligent_lazy_axis
						value = 20
					}
				}
				50 = {
					change_variable = {
						which = tma_diligent_lazy_axis
						value = 20
					}
				}
			}
		}
		custom_tooltip = tma_trait_event_random
	}
}

country_event = {
	id = maai.171
	title = "maai.0.name"
	desc = "maai.171.desc"

	diplomatic = yes
	force_open = yes
	
	is_triggered_only = yes
	
	immediate = {
		set_global_flag = tma_trait_event_4_fired
	}
	
	trigger = {
	}

	after = {
		hidden_effect = { country_event = { id = maai.178 days = 3 random = 7 } } #trait check
	}
	
	picture_event_data = {
		portrait = event_target:master_ai_country
		planet_background = pc_habitat
		room = machine_room
	}
	
	option = {
		name = "maai.171.a"
		hidden_effect = {
			change_variable = {
				which = tma_fickle_steadfast_axis
				value = 20
			}
		}
		custom_tooltip = tma_trait_event_steadfast
	}
	option = {
		name = "maai.171.b"
		hidden_effect = {
			subtract_variable = {
				which = tma_fickle_steadfast_axis
				value = 20
			}
		}
		custom_tooltip = tma_trait_event_fickle
	}
	option = {
		name = "maai.168.c"
		hidden_effect = {
			random_list = {
				50 = {
					subtract_variable = {
						which = tma_fickle_steadfast_axis
						value = 20
					}
				}
				50 = {
					change_variable = {
						which = tma_fickle_steadfast_axis
						value = 20
					}
				}
			}
		}
		custom_tooltip = tma_trait_event_random
	}
}

country_event = {
	id = maai.172
	title = "maai.0.name"
	desc = "maai.172.desc"

	diplomatic = yes
	force_open = yes
	
	immediate = {
		set_global_flag = tma_trait_event_5_fired
	}
	
	is_triggered_only = yes
	
	trigger = {
	}

	after = {
		hidden_effect = { country_event = { id = maai.178 days = 3 random = 7 } } #trait check
	}
	
	picture_event_data = {
		portrait = event_target:master_ai_country
		planet_background = pc_habitat
		room = machine_room
	}
	
	option = {
		name = "maai.172.a"
		hidden_effect = {
			change_variable = {
				which = tma_forgiving_vengeful_axis
				value = 20
			}
		}
		custom_tooltip = tma_trait_event_vengeful
	}
	option = {
		name = "maai.172.b"
		hidden_effect = {
			subtract_variable = {
				which = tma_forgiving_vengeful_axis
				value = 20
			}
		}
		custom_tooltip = tma_trait_event_forgiving
	}
	option = {
		name = "maai.172.c"
		hidden_effect = {
			change_variable = {
				which = tma_diligent_lazy_axis
				value = 20
			}
		}
		custom_tooltip = tma_trait_event_lazy
	}
}

country_event = {
	id = maai.173
	title = "maai.0.name"
	desc = "maai.173.desc"

	diplomatic = yes
	force_open = yes
	
	is_triggered_only = yes
	
	immediate = {
		set_global_flag = tma_trait_event_6_fired
	}
	
	trigger = {
	}

	after = {
		hidden_effect = { country_event = { id = maai.178 days = 3 random = 7 } } #trait check
	}
	
	picture_event_data = {
		portrait = event_target:master_ai_country
		planet_background = pc_habitat
		room = machine_room
	}
	
	option = {
		name = "maai.173.a"
		hidden_effect = {
			subtract_variable = {
				which = tma_content_ambitious_axis
				value = 20
			}
		}
		custom_tooltip = tma_trait_event_content
	}
	option = {
		name = "maai.173.b"
		hidden_effect = {
			change_variable = {
				which = tma_content_ambitious_axis
				value = 20
			}
		}
		custom_tooltip = tma_trait_event_ambitious
	}
	option = {
		name = "maai.173.c"
		hidden_effect = {
			change_variable = {
				which = tma_fickle_steadfast_axis
				value = 20
			}
		}
		custom_tooltip = tma_trait_event_steadfast
	}
	option = {
		name = "maai.173.d"
		hidden_effect = {
			subtract_variable = {
				which = tma_fickle_steadfast_axis
				value = 20
			}
		}
		custom_tooltip = tma_trait_event_fickle
	}
}

country_event = {
	id = maai.174
	title = "maai.0.name"
	desc = "maai.174.desc"

	diplomatic = yes
	force_open = yes
	
	is_triggered_only = yes
	
	immediate = {
		set_global_flag = tma_trait_event_7_fired
	}
	
	trigger = {
	}

	after = {
		hidden_effect = { country_event = { id = maai.178 days = 3 random = 7 } } #trait check
	}
	
	picture_event_data = {
		portrait = event_target:master_ai_country
		planet_background = pc_habitat
		room = machine_room
	}
	
	option = {
		name = "maai.174.a"
		hidden_effect = {
			change_variable = {
				which = tma_diligent_lazy_axis
				value = 20
			}
		}
		custom_tooltip = tma_trait_event_lazy
	}
	option = {
		name = "maai.174.b"
		hidden_effect = {
			subtract_variable = {
				which = tma_diligent_lazy_axis
				value = 20
			}
		}
		custom_tooltip = tma_trait_event_diligent
	}
	option = {
		name = "maai.174.c"
		hidden_effect = {
			subtract_variable = {
				which = tma_fickle_steadfast_axis
				value = 20
			}
		}
		custom_tooltip = tma_trait_event_fickle
	}
}

country_event = {
	id = maai.175
	title = "maai.0.name"
	desc = "maai.175.desc"

	diplomatic = yes
	force_open = yes
	
	is_triggered_only = yes
	
	immediate = {
		set_global_flag = tma_trait_event_8_fired
	}
	
	trigger = {
	}

	after = {
		hidden_effect = { country_event = { id = maai.178 days = 3 random = 7 } } #trait check
	}
	
	picture_event_data = {
		portrait = event_target:master_ai_country
		planet_background = pc_habitat
		room = machine_room
	}
	
	option = {
		name = "maai.175.a"
		hidden_effect = {
			random_list = {
				50 = {
					change_variable = {
						which = tma_forgiving_vengeful_axis
						value = 20
					}
				}
				50 = {
					change_variable = {
						which = tma_fickle_steadfast_axis
						value = 20
					}
				}
			}
		}
		custom_tooltip = tma_trait_event_random
	}
	option = {
		name = "maai.175.b"
		hidden_effect = {
			random_list = {
				33 = {
					subtract_variable = {
						which = tma_forgiving_vengeful_axis
						value = 20
					}
				}
				33 = {
					subtract_variable = {
						which = tma_content_ambitious_axis
						value = 20
					}
				}
				33 = {
					change_variable = {
						which = tma_content_ambitious_axis
						value = 20
					}
				}
			}
		}
		custom_tooltip = tma_trait_event_random
	}
	option = {
		name = "maai.175.c"
		hidden_effect = {
			random_list = {
				33 = {
					subtract_variable = {
						which = tma_diligent_lazy_axis
						value = 20
					}
				}
				33 = {
					change_variable = {
						which = tma_diligent_lazy_axis
						value = 20
					}
				}
				33 = {
					subtract_variable = {
						which = tma_content_ambitious_axis
						value = 20
					}
				}
			}
		}
		custom_tooltip = tma_trait_event_random
	}
}

country_event = {
	id = maai.176
	title = "maai.0.name"
	desc = "maai.176.desc"

	diplomatic = yes
	force_open = yes
	
	is_triggered_only = yes
	
	immediate = {
		set_global_flag = tma_trait_event_9_fired
	}
	
	trigger = {
	}

	after = {
		hidden_effect = { country_event = { id = maai.178 days = 3 random = 7 } } #trait check
	}
	
	picture_event_data = {
		portrait = event_target:master_ai_country
		planet_background = pc_habitat
		room = machine_room
	}
	
	option = {
		name = "maai.176.a"
		hidden_effect = {
			change_variable = {
				which = tma_forgiving_vengeful_axis
				value = 20
			}
		}
		custom_tooltip = tma_trait_event_vengeful
	}
	option = {
		name = "maai.176.b"
		hidden_effect = {
			subtract_variable = {
				which = tma_content_ambitious_axis
				value = 20
			}
		}
		custom_tooltip = tma_trait_event_content
	}
	option = {
		name = "maai.176.c"
		hidden_effect = {
			change_variable = {
				which = tma_diligent_lazy_axis
				value = 20
			}
		}
		custom_tooltip = tma_trait_event_lazy
	}
	option = {
		name = "maai.176.d"
		hidden_effect = {
			change_variable = {
				which = tma_content_ambitious_axis
				value = 20
			}
		}
		custom_tooltip = tma_trait_event_ambitious
	}
}

country_event = {
	id = maai.177
	title = "maai.0.name"
	desc = "maai.177.desc"

	diplomatic = yes
	force_open = yes
	
	is_triggered_only = yes
	
	immediate = {
		set_global_flag = tma_trait_event_10_fired
	}
	
	trigger = {
	}

	after = {
		hidden_effect = { country_event = { id = maai.178 days = 3 random = 7 } } #trait check
	}
	
	picture_event_data = {
		portrait = event_target:master_ai_country
		planet_background = pc_habitat
		room = machine_room
	}
	
	option = {
		name = "maai.177.a"
		hidden_effect = {
			subtract_variable = {
				which = tma_diligent_lazy_axis
				value = 20
			}
		}
		custom_tooltip = tma_trait_event_diligent
	}
	option = {
		name = "maai.177.b"
		hidden_effect = {
			change_variable = {
				which = tma_fickle_steadfast_axis
				value = 20
			}
		}
		custom_tooltip = tma_trait_event_steadfast
	}
	option = {
		name = "maai.177.c"
		hidden_effect = {
			subtract_variable = {
				which = tma_forgiving_vengeful_axis
				value = 20
			}
		}
		custom_tooltip = tma_trait_event_forgiving
	}
}

#trait check
country_event = {
	id = maai.178
	hide_window = yes
	
	is_triggered_only = yes
	
	trigger = {
	}
	
	immediate = {
		if = {
			limit = {
				check_variable = {
					which = tma_content_ambitious_axis
					value >= 100
				}
				NOT = { has_modifier = mod_tma_trait_ambitious }
			}
			set_global_flag = tma_trait_ambitious
			change_variable = {
				which = tma_trait_num
				value = 1
			}
			remove_global_flag = tma_trait_content
		}
		else_if = {
			limit = {
				check_variable = {
					which = tma_forgiving_vengeful_axis
					value >= 100
				}
				NOT = { has_modifier = mod_tma_trait_vengeful }
			}
			set_global_flag = tma_trait_vengeful
			change_variable = {
				which = tma_trait_num
				value = 1
			}
			remove_global_flag = tma_trait_forgiving
		}
		else_if = {
			limit = {
				check_variable = {
					which = tma_diligent_lazy_axis
					value >= 100
				}
				NOT = { has_modifier = mod_tma_trait_lazy }
			}
			set_global_flag = tma_trait_lazy
			change_variable = {
				which = tma_trait_num
				value = 1
			}
			remove_global_flag = tma_trait_diligent
		}
		else_if = {
			limit = {
				check_variable = {
					which = tma_fickle_steadfast_axis
					value >= 100
				}
				NOT = { has_modifier = mod_tma_trait_steadfast }
			}
			set_global_flag = tma_trait_steadfast
			change_variable = {
				which = tma_trait_num
				value = 1
			}
			remove_global_flag = tma_trait_fickle
		}
		
		else_if = {
			limit = {
				check_variable = {
					which = tma_content_ambitious_axis
					value <= 0
				}
				NOT = { has_modifier = mod_tma_trait_content }
			}
			set_global_flag = tma_trait_content
			change_variable = {
				which = tma_trait_num
				value = 1
			}
			remove_global_flag = tma_trait_ambitious
		}
		else_if = {
			limit = {
				check_variable = {
					which = tma_forgiving_vengeful_axis
					value <= 0
				}
				NOT = { has_modifier = mod_tma_trait_forgiving }
			}
			set_global_flag = tma_trait_forgiving
			change_variable = {
				which = tma_trait_num
				value = 1
			}
			remove_global_flag = tma_trait_vengeful
		}
		else_if = {
			limit = {
				check_variable = {
					which = tma_diligent_lazy_axis
					value <= 0
				}
				NOT = { has_modifier = mod_tma_trait_diligent }
			}
			set_global_flag = tma_trait_diligent
			change_variable = {
				which = tma_trait_num
				value = 1
			}
			remove_global_flag = tma_trait_lazy
		}
		else_if = {
			limit = {
				check_variable = {
					which = tma_fickle_steadfast_axis
					value <= 0
				}
				NOT = { has_modifier = mod_tma_trait_fickle }
			}
			set_global_flag = tma_trait_fickle
			change_variable = {
				which = tma_trait_num
				value = 1
			}
			remove_global_flag = tma_trait_steadfast
		}
		tma_assign_allowed_traits = yes
	}
}

# Change Negative Outcome (C or D)
country_event = {
	id = maai.200
	title = "maai.200.name"
	desc = "maai.200.desc"
	picture = GFX_evt_machine_sapience
	show_sound = event_activating_unknown_technology
	
	is_triggered_only = yes
	
	immediate = {
	}
	
	option = {
		name = "maai.200.a" # do it
		custom_tooltip = tma_restoration_tt
		hidden_effect = {
			country_event = { id = maai.201 days = 360 random = 3 }
		}
		add_modifier = {
			modifier = tma_restoration
			days = 360
		}
	}
	option = {
		name = "maai.200.b" # do not do it
		add_resource = {
			unity = 5000
			energy = 5000
		}
	}
}

# Hidden event: 2nd outcome
country_event = {
	id = maai.201
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		random_list = {
			30 = {
				modifier = {
					factor = 0
					has_global_flag = tma_outcome_d
				}
				country_event = { id = maai.111 days = 3 } # Catastrophy
			}
			45 = {
				modifier = {
					factor = 0.5
					has_global_flag = tma_outcome_d
				}
				country_event = { id = maai.113 days = 3 } # Ascension
			}
			25 = {
				modifier = {
					factor = 2.5
					has_global_flag = tma_outcome_d
				}
				country_event = { id = maai.1 days = 3 } # Revolt
			}
		}
	}
}