namespace = machinedlcpp #processing power

country_event = {
	id = machinedlcpp.1
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		has_authority = auth_machine_intelligence
		NOT = { has_valid_civic = civic_machine_clockwork }
	}

	immediate = {
		capital_scope = {
			add_building = building_machinedlc_planet_processor_1
			set_timed_planet_flag = {
				flag = machinedlc_recently_built_processor
				days = 60
			}
			while = { create_pop = { species = owner.species } count = 2 }
			#check machinedlcmod_event_pop_district_adjustment scripted effect
			if = {
				limit = {
					owner = {
						NOR = {
							has_valid_civic = civic_machine_trader
							has_origin = origin_machine_heritage
							has_valid_civic = civic_machine_clockwork
							has_valid_civic = civic_machine_rock_body
							has_valid_civic = civic_machine_synth_skin
							has_valid_civic = civic_machine_emotion_emulator_intelligence
							has_valid_civic = civic_machinedlc_planet_cracker
						}					
					}
				}
				remove_district = district_generator
				add_district = district_nexus
				create_pop = { species = owner.species }
			}
		}
	}
}
#processing capacity calculations
event = {
	id = machinedlcpp.2
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		any_country = {
			has_global_flag = machinedlc_new_feature_1
			has_authority = auth_machine_intelligence 
			NOR = {
				has_valid_civic = civic_machine_clockwork
				has_modifier = mod_civic_machine_clockwork
			}
		}
	}

	immediate = {
		every_country = {
			limit = {
				has_global_flag = machinedlc_new_feature_1
				has_authority = auth_machine_intelligence
				NOR = {
					has_valid_civic = civic_machine_clockwork
					has_modifier = mod_civic_machine_clockwork
				}
			}
			clear_mod_machinedlc_processing_capacity = yes
			#plus
			if = {
				limit = {
					resource_income_compare = { resource = machinedlc_processing_capacity value >= 0 } 
					resource_income_compare = { resource = machinedlc_processing_capacity value <= 2000 } 
				}
				calculate_machinedlc_processing_capacity_2000 = yes
			}
			if = {
				limit = {
					resource_income_compare = { resource = machinedlc_processing_capacity value > 2000 } 
					resource_income_compare = { resource = machinedlc_processing_capacity value <= 4000 } 
				}
				calculate_machinedlc_processing_capacity_4000 = yes
			}
			if = {
				limit = {
					resource_income_compare = { resource = machinedlc_processing_capacity value > 4000 } 
					resource_income_compare = { resource = machinedlc_processing_capacity value <= 6000 } 
				}
				calculate_machinedlc_processing_capacity_6000 = yes
			}
			if = {
				limit = {
					resource_income_compare = { resource = machinedlc_processing_capacity value > 6000 } 
					resource_income_compare = { resource = machinedlc_processing_capacity value <= 8000 } 
				}
				calculate_machinedlc_processing_capacity_8000 = yes
			}
			if = {
				limit = {
					resource_income_compare = { resource = machinedlc_processing_capacity value > 8000 } 
					resource_income_compare = { resource = machinedlc_processing_capacity value <= 10000 } 
				}
				calculate_machinedlc_processing_capacity_10000 = yes
			}
			if = {
				limit = {
					resource_income_compare = { resource = machinedlc_processing_capacity value > 10000 } 
					resource_income_compare = { resource = machinedlc_processing_capacity value <= 12000 } 
				}
				calculate_machinedlc_processing_capacity_12000 = yes
			}
			if = {
				limit = {
					resource_income_compare = { resource = machinedlc_processing_capacity value > 12000 } 
					resource_income_compare = { resource = machinedlc_processing_capacity value <= 14000 } 
				}
				calculate_machinedlc_processing_capacity_14000 = yes
			}
			if = {
				limit = {
					resource_income_compare = { resource = machinedlc_processing_capacity value > 14000 } 
					resource_income_compare = { resource = machinedlc_processing_capacity value <= 16000 } 
				}
				calculate_machinedlc_processing_capacity_16000 = yes
			}
			if = {
				limit = {
					resource_income_compare = { resource = machinedlc_processing_capacity value > 16000 } 
					resource_income_compare = { resource = machinedlc_processing_capacity value <= 18000 } 
				}
				calculate_machinedlc_processing_capacity_18000 = yes
			}
			if = {
				limit = { resource_income_compare = { resource = machinedlc_processing_capacity value > 18000 } }
				calculate_machinedlc_processing_capacity_20000 = yes
			}
			#minus
			if = {
				limit = {
					resource_income_compare = { resource = machinedlc_processing_demand value < 0 }
					resource_income_compare = { resource = machinedlc_processing_demand value >= -1999 }
				}
				calculate_machinedlc_processing_demand_2000 = yes
			}
			if = {
				limit = {
					resource_income_compare = { resource = machinedlc_processing_demand value < -1999 }
					resource_income_compare = { resource = machinedlc_processing_demand value >= -3999 }
				}
				calculate_machinedlc_processing_demand_4000 = yes
			}
			if = {
				limit = {
					resource_income_compare = { resource = machinedlc_processing_demand value < -3999 }
					resource_income_compare = { resource = machinedlc_processing_demand value >= -5999 }
				}
				calculate_machinedlc_processing_demand_6000 = yes
			}
			if = {
				limit = {
					resource_income_compare = { resource = machinedlc_processing_demand value < -5999 }
					resource_income_compare = { resource = machinedlc_processing_demand value >= -7999 }
				}
				calculate_machinedlc_processing_demand_8000 = yes
			}
			if = {
				limit = {
					resource_income_compare = { resource = machinedlc_processing_demand value < -7999 }
					resource_income_compare = { resource = machinedlc_processing_demand value >= -9999 }
				}
				calculate_machinedlc_processing_demand_10000 = yes
			}
			if = {
				limit = {
					resource_income_compare = { resource = machinedlc_processing_demand value < -9999 }
					resource_income_compare = { resource = machinedlc_processing_demand value >= -11999 }
				}
				calculate_machinedlc_processing_demand_12000 = yes
			}
			if = {
				limit = {
					resource_income_compare = { resource = machinedlc_processing_demand value < -11999 }
					resource_income_compare = { resource = machinedlc_processing_demand value >= -13999 }
				}
				calculate_machinedlc_processing_demand_14000 = yes
			}
			if = {
				limit = {
					resource_income_compare = { resource = machinedlc_processing_demand value < -13999 }
					resource_income_compare = { resource = machinedlc_processing_demand value >= -15999 }
				}
				calculate_machinedlc_processing_demand_16000 = yes
			}
			if = {
				limit = {
					resource_income_compare = { resource = machinedlc_processing_demand value < -15999 }
					resource_income_compare = { resource = machinedlc_processing_demand value >= -17999 }
				}
				calculate_machinedlc_processing_demand_18000 = yes
			}
			if = {
				limit = { resource_income_compare = { resource = machinedlc_processing_demand value < -17999 } }
				calculate_machinedlc_processing_demand_20000 = yes
			}

			if = {
				limit = {
					check_variable = {
						which = var_machinedlc_processing_capacity
						value >= var_machinedlc_processing_demand
					}
				}
				machinedlc_processing_capacity_calc = yes
				else = { machinedlc_processing_demand_calc = yes }
			}
		}
	}
}