#--	
#--		--------------------------- --------------------------- --------------------------- ---------------------------
#--		Fallen Empire Expanded - Awakening Events for Fallen Empires with new ethos
#--		--------------------------- --------------------------- --------------------------- ---------------------------
#--	
#--		PREFACE
#--		�	This file handles awakening events of Fallen Empires Expanded.
#--		�	Instead of replacing the entire event file directly, Fallen Empires Expanded overrides the ID of select events.
#--		�	Overriding ID enhances mod compatability as no event text files are being replaced.
#--		�	The purpose of the overriding is to make default events compatible with new features and fallen empires in FEE.
#--		�	Without this file, mod-added fallen empires with new ethos cannot awaken. 
#--
#--		EVENTS
#--		�	fallen_empires_awakening.6 		Event for awakening Hive Mind FE's in response to the awakening of another FE
#--		�	fallen_empires_awakening.7 		Descriptor event for Awakened Hive Mind Fallen Empire
#--		�	fallen_empires_awakening.8 		Event for awakening Militarist FE's in response to global crisis or War in Heaven
#--		�	fallen_empires_awakening.9 		Descriptor event for Awakened Militarist Fallen Empire
#--		�	fallen_empires_awakening.10		Event for awakening Ascended Spiritualist Fallen Empire
#--		�	fallen_empires_awakening.11		Descriptor event for Awakened Ascended Spiritualist Fallen Empire
#--		
#--		AWAKENING/WiH EVENT READINESS
#--		�	Fanatic Militarist 		READY	     [Militarist won't engage in WiH, uses custom mechanics]
#--		�	Fanatic Pacifist 		READY		 [Empire not yet implemented, event ready for future use]
#--		�	Hive Mind 				READY		 [Hive Mind won't engage in WiH, uses custom mechanics]


namespace = fallen_empires_awakening

# Hive Mind Awakens in respond to another Awakening - leads to Assimilation Proclamation Events
country_event = {
	id = fallen_empires_awakening.6
	title = OK
	desc = OK
	hide_window = yes
	
	trigger = {
		years_passed > 150
		has_global_flag = sleepers_awake_happened
		NOT = { has_global_flag = FEE_swarm_waking }
		is_fallen_empire_hive_mind = yes
	}
	
	mean_time_to_happen = {
		years = 30
		modifier = {
			factor = 0.5
			has_global_flag = war_in_heaven_started
		}
	}
	
	immediate = {
		set_global_flag = FEE_swarm_waking
		country_event = { id = fallen_empires_awakening.3 }
		
		# Notify
		every_country = {
			limit = {
				is_ai = no
			}
			country_event = { id = fallen_empires_awakening.7 }
		}
	}
}

# Hive Mind Awakening Descriptor Event
country_event = {
	id = fallen_empires_awakening.7
	title = fallen_empires_awakening.7.name
	desc = fallen_empires_awakening.7.desc
	picture = GFX_evt_fallen_empire
	show_sound = event_alien_signal
	location = from

	is_triggered_only = yes

	option = {
		name = fallen_empires_awakening.7.a
	}
}
		
	
#Militarist Awakes in Response to Crisis - Leads to Militarist Superstate (Precursor Preeminence TBA and linked to the end of a WiH, not to a crisis specifically.)

country_event = {
	id = fallen_empires_awakening.8
	title = OK
	desc = OK
	
	hide_window = yes
	
	trigger = {
		has_global_flag = galactic_crisis_happened
		is_fallen_empire_militarist = yes
		NOT = { has_global_flag = FEE_militarist_waking }
		NOT = { is_awakened_fallen_empire_militarist = yes }
	}
	
	mean_time_to_happen = {
		years = 10
		# Modifier to occur more rapidly if a Fallen Empire has lost a war
		modifier = {
			factor = 0.5
			has_global_flag = fallen_empire_lost_war
		}
		# Modifier to occur immediately if Puppet State dies
		modifier = {
			factor = 0.01
			NOT = { exists = event_target:MilitaristPuppet }
		}
		
	}
	
	immediate = {
		save_global_event_target_as = AwakenedMilitarist
		set_global_flag = FEE_militarist_waking
		country_event = { id = fallen_empires_awakening.3 }
		
		# Notify
		every_country = {
			limit = {
				is_ai = no
			}
			country_event = { id = fallen_empires_awakening.2 }
		}
	}
}

country_event = {
	id = fallen_empires_awakening.10
	title = OK
	desc = OK
	hide_window = yes
	
	trigger = {
		is_fallen_empire_ascended_spiritualist = yes
		OR = {
			AND = {
				has_modifier = covenant_composer_of_strands
				has_modifier = covenant_eater_of_worlds
				has_modifier = covenant_instrument_of_desire
				has_modifier = covenant_whisperers_in_the_void
			}
			has_country_flag = FEE_ascended_spiritualist_all_covenants
		}
		NOT = { has_global_flag = FEE_ascended_spiritualist_waking }
	}
	
	mean_time_to_happen = {
		years = 5
	}
	
	immediate = {
		set_global_flag = FEE_psionic_storm
		set_global_flag = high_awaken_chance
		set_global_flag = FEE_ascended_spiritualist_waking
		set_timed_global_flag = {
			flag = FEE_psionic_storm_level_1
			years = 30
		}
		set_variable = {
			which = "FEE_psionic_storm_progression"
			value = 0
		}
		remove_modifier = covenant_composer_of_strands
		remove_modifier = covenant_eater_of_worlds
		remove_modifier = covenant_instrument_of_desire
		remove_modifier = covenant_whisperers_in_the_void
		add_modifier = {
			modifier = FEE_psionic_ascendance
			days = -1
		}
		country_event = { id = fallen_empires_awakening.3 }
		
		# Notify
		every_country = {
			limit = {
				is_ai = no
			}
			country_event = { id = fallen_empires_awakening.11 }
		}
	}
}

country_event = {
	id = fallen_empires_awakening.11
	title = fallen_empires_awakening.11.name
	desc = {
		trigger = {
			switch = {
				trigger = has_ethic
				ethic_fanatic_spiritualist = { text = fallen_empires_awakening.11.spiritualist.desc }
				ethic_spiritualist = { text = fallen_empires_awakening.11.spiritualist.desc }
				default = { text = fallen_empires_awakening.11.default.desc }
			}
		}
	}
	picture = GFX_evt_fallen_empire
	show_sound = event_alien_signal
	location = from

	is_triggered_only = yes
	
	immediate = { 
	}

	option = {
		name = fallen_empires_awakening.11.a
		
		custom_tooltip = fallen_empires_awakening.effects.tooltip
		
	}
}