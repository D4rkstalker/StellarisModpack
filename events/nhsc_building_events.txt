namespace = nhsc_buildings

## ################################################################################################################# ##
##                        Events to set or unset flags for ownership of ESC resource buildings                       ##
## ################################################################################################################# ##

# Nanite Foundry
country_event = {
    id = nhsc_buildings.10
    is_triggered_only = yes
    hide_window = yes

    # Fallen Empires don't care about this, so...
    trigger = {
        NOR = {
            is_country_type = fallen_empire
			is_country_type = awakened_fallen_empire
        }
    }

    immediate = {
        if = {
            limit = {
                any_owned_planet = {
                    OR = {
                        has_building_construction = nhsc_building_nanite_foundry
                        has_building = nhsc_building_nanite_foundry
                        has_building = nhsc_building_nanite_containment # Machine Fallen Empire building
                    }
                }
            }
            # set flag [AI usage]
            set_country_flag = nhsc_has_nanite_foundry
        }
        # remove flag [AI usage]
        else = {
            remove_country_flag = nhsc_has_nanite_foundry
        }
    }
}

# Psionic Containment
country_event = {
    id = nhsc_buildings.20
    is_triggered_only = yes
    hide_window = yes

    # Fallen Empires don't care about this, so...
    trigger = {
        NOR = {
            is_country_type = fallen_empire
			is_country_type = awakened_fallen_empire
        }
    }

    immediate = {
        if = {
            limit = {
                any_owned_planet = {
                    OR = {
                        has_building_construction = nhsc_building_psionic_containment
                        has_building = nhsc_building_psionic_containment
                        has_building = nhsc_building_psi_energy_spire # Spiritualist Fallen Empire building
                    }
                }
            }
            # set flag [AI usage]
            set_country_flag = nhsc_has_psionic_containment
        }
        # remove flag [AI usage]
        else = {
            remove_country_flag = nhsc_has_psionic_containment
        }
    }
}

# Graviton Condenser
country_event = {
    id = nhsc_buildings.30
    is_triggered_only = yes
    hide_window = yes

    # Fallen Empires don't care about this, so...
    trigger = {
        NOR = {
            is_country_type = fallen_empire
			is_country_type = awakened_fallen_empire
        }
    }

    immediate = {
        if = {
            limit = {
                any_owned_planet = {
                    OR = {
                        has_building_construction = nhsc_building_graviton_condenser
                        has_building = nhsc_building_graviton_condenser
                        has_building = nhsc_building_localized_gravity_fault # Materialist Fallen Empire building
                    }
                }
            }
            # set flag [AI usage]
            set_country_flag = nhsc_has_graviton_condenser
        }
        # remove flag [AI usage]
        else = {
            remove_country_flag = nhsc_has_graviton_condenser
        }
    }
}

# Living crystal farms
country_event = {
    id = nhsc_buildings.40
    is_triggered_only = yes
    hide_window = yes

    # Fallen Empires don't care about this, so...
    trigger = {
        NOR = {
            is_country_type = fallen_empire
			is_country_type = awakened_fallen_empire
        }
    }

    immediate = {
        if = {
            limit = {
                any_owned_planet = {
                    OR = {
                        has_building_construction = building_esc_crystal_farm_1
                        has_building_construction = building_esc_crystal_farm_2
                        has_building = building_esc_crystal_farm_1
                        has_building = building_esc_crystal_farm_2
                        has_building = nhsc_building_crystalline_manufacture # Xenophile Fallen Empire building
                    }
                }
            }
            # set flag [AI usage]
            set_country_flag = nhsc_has_living_crystal_farm
        }
        # remove flag [AI usage]
        else = {
            remove_country_flag = nhsc_has_living_crystal_farm
        }
    }
}

# Dimensional Breach
country_event = {
    id = nhsc_buildings.50
    is_triggered_only = yes
    hide_window = yes

    # Fallen Empires don't care about this, so...
    trigger = {
        NOR = {
            is_country_type = fallen_empire
			is_country_type = awakened_fallen_empire
        }
    }

    immediate = {
        if = {
            limit = {
                any_owned_planet = {
                    OR = {
                        has_building_construction = nhsc_building_dimensional_breach
                        has_building = nhsc_building_dimensional_breach
                    }
                }
            }
            # set flag [AI usage]
            set_country_flag = nhsc_has_dimensional_breach
        }
        # remove flag [AI usage]
        else = {
            remove_country_flag = nhsc_has_dimensional_breach
        }
    }
}

# Enigmatic Energy Coil
country_event = {
    id = nhsc_buildings.60
    is_triggered_only = yes
    hide_window = yes

    # Fallen Empires don't care about this, so...
    trigger = {
        NOR = {
            is_country_type = fallen_empire
			is_country_type = awakened_fallen_empire
        }
    }

    immediate = {
        if = {
            limit = {
                any_owned_planet = {
                    OR = {
                        has_building_construction = nhsc_building_enigmatic_coil
                        has_building = nhsc_building_enigmatic_coil
                    }
                }
            }
            # set flag [AI usage]
            set_country_flag = nhsc_has_enigmatic_coil
        }
        # remove flag [AI usage]
        else = {
            remove_country_flag = nhsc_has_enigmatic_coil
        }
    }
}

## ################################################################################################################# ##
##                                   Events to manage the Mantle Mining Facility                                     ##
## ################################################################################################################# ##

### random resource boons from mantle miner
event = {
    id = nhsc_buildings.110
    is_triggered_only = yes
    hide_window = yes

    immediate = {
        every_planet = {
            limit = {
                is_colony = yes
                num_pops > 0
                OR = {
                    has_building = nhsc_building_magmaminer_1
                    has_building = nhsc_building_magmaminer_2
                }
            }

            random_list = {
                90 = {}
                2 = { planet_event = { id = nhsc_buildings.111 days = 60 } }
                2 = { planet_event = { id = nhsc_buildings.112 days = 30 } }
                2 = { planet_event = { id = nhsc_buildings.113 days = 90 } }
                2 = { planet_event = { id = nhsc_buildings.114 days = 30 } }
                2 = { planet_event = { id = nhsc_buildings.115 days = 60 } }
            }
        }
    }
}

# extra minerals
planet_event = {
    id = nhsc_buildings.111
    is_triggered_only = yes
    title = "nhsc_buildings.111.name"
    desc = "nhsc_buildings.111.desc"
    picture = GFX_evt_mining_operations

    option = {
        name = EXCELLENT
            owner = {
            add_resource = {
                minerals = 500
            }
        }
    }
}

# some alloys
planet_event = {
    id = nhsc_buildings.112
    is_triggered_only = yes
    title = "nhsc_buildings.112.name"
    desc = "nhsc_buildings.112.desc"
    picture = GFX_evt_mining_operations

    option = {
        name = EXCELLENT
        owner = {
            add_resource = {
                alloys = 100
            }
        }
    }
}

# some rare crystals
planet_event = {
    id = nhsc_buildings.113
    is_triggered_only = yes
    title = "nhsc_buildings.113.name"
    desc = "nhsc_buildings.113.desc"
    picture = GFX_evt_mining_operations

    option = {
        name = EXCELLENT
        owner = {
            add_resource = {
                rare_crystals = 50
            }
        }
    }
}

# some volatile motes
planet_event = {
    id = nhsc_buildings.114
    is_triggered_only = yes
    title = "nhsc_buildings.114.name"
    desc = "nhsc_buildings.114.desc"
    picture = GFX_evt_mining_operations

    option = {
        name = EXCELLENT
        owner = {
            add_resource = {
                volatile_motes = 50
            }
        }
    }
}

# some exotic gases
planet_event = {
    id = nhsc_buildings.115
    is_triggered_only = yes
    title = "nhsc_buildings.115.name"
    desc = "nhsc_buildings.115.desc"
    picture = GFX_evt_mining_operations

    option = {
        name = EXCELLENT
        owner = {
            add_resource = {
                exotic_gases = 50
            }
        }
    }
}
