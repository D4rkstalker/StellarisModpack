namespace = ag_iota

# Hidden, Spawn the Iota Area
country_event = {
    id = ag_iota.1
    hide_window = yes
	is_triggered_only = yes
	
    immediate = {
		ag_spawn_ancient_system = { ag_system_to_spawn = "ag_ancient_iota_init" }
		ag_spawned_system_effect = yes
		create_point_of_interest = {
			id = ag_iota_area
			name = "ag_iota_area"
			desc = "ag_iota_area_desc"
			event_chain = ag_hidden_system_chain
			location = event_target:ag_ancient_iota_star
		}
		random_system = {
			limit = {
				has_star_flag = ag_ancient_iota_system
			}
			isolate_system = yes
		}
    }
	
	after = {
		every_country = {
			limit = {
				has_special_project = ag_located_iota_area
			}
			abort_special_project = {
				type = "ag_located_iota_area"
				location = capital_scope
			}
		}
	}
}

# on_entering_system_fleet, Notification for entering the Iota Area first time
fleet_event = {
	id = ag_iota.2
	title = "ag_iota.2.name"
	desc = "ag_iota.2.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_ruined_system_room }
	show_sound = event_mystic_reveal_light
	location = root
	is_triggered_only = yes
	
	trigger = {
		from = {
			has_star_flag = ag_ancient_iota_system
		}
		owner = {
			is_ai = no
			NOT = {
				has_country_flag = ag_iota_area_entered
			}
		}
	}
	
    immediate = {
		owner = {
			set_country_flag = ag_iota_area_entered
			remove_point_of_interest = ag_iota_area
			create_point_of_interest = {
				id = ag_iota_area_alt
				name = "ag_iota_area"
				desc = "ag_ancient_coordinate"
				event_chain = "ag_hidden_system_chain"
				location = root.solar_system
			}
			country_event = { id = ag_iota.3 days = 180 random = 180 }
		}
	}
	
	option = {
		name = "ag_iota.2.a"
	}
	option = {
		name = "ag_iota.2.b"
	}
	option = {
		name = "ag_iota.2.c"
		trigger = {
			OR = {
				has_ethic = ethic_xenophobe
				has_ethic = ethic_fanatic_xenophobe
			}
		}
	}
	option = {
		name = "ag_iota.2.d"
		trigger = {
			OR = {
				has_ethic = ethic_xenophile
				has_ethic = ethic_fanatic_xenophile
			}
		}
	}
}

# Communication from enclave
country_event = {
    id = ag_iota.3
	title = "ag_iota.3.name"
	desc = "ag_iota.3.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_throne_room }
	show_sound = event_radio_chatter
	is_triggered_only = yes

	trigger = {
		ag_can_first_contact_with_iota_enclave = yes
	}
	
    immediate = {
		establish_communications_no_message = event_target:ag_ancient_iota_enclave
    }
	
	option = {
		name = "ag_iota.3.a"
		if = {
			limit = {
				OR = {
					has_ethic = ethic_xenophile
					has_ethic = ethic_fanatic_xenophile
				}
			}
			add_monthly_resource_mult = {
				resource = influence
				value = @tier1influencecontactxenophile
				min = @tier1influencecontactmin
				max = @tier1influencecontactmax
			}
		}
		else = {
			add_monthly_resource_mult = {
				resource = influence
				value = @tier1influencecontact
				min = @tier1influencecontactmin
				max = @tier1influencecontactmax
			}
		}
		hidden_effect = {
			country_event = { id = ag_iota.4 }
		}
	}
}
country_event = {
    id = ag_iota.4
	title = "ag_iota.4.name"
	desc = "ag_iota.4.desc"
	
	is_triggered_only = yes
	
	diplomatic = yes
	force_open = yes
	custom_gui = "ag_ancient_event_diplomacy_window"
	custom_gui_option = "ag_ancient_event_diplomacy_option"

	picture_event_data = {
		portrait = event_target:ag_ancient_iota_enclave
		room = ag_ancient_structure_room
	}

	trigger = {
		ag_can_first_contact_with_iota_enclave = yes
	}

	option = {
		name = "ag_iota.4.a"
		trigger = {
			NOR = {
				has_valid_civic = civic_fanatic_purifiers
				has_valid_civic = civic_hive_devouring_swarm
				has_valid_civic = civic_machine_terminator
			}
		}
	}
	option = {
		name = "ag_iota.4.b"
		trigger = {
			has_valid_civic = civic_fanatic_purifiers
		}
	}
	option = {
		name = "ag_iota.4.c"
		trigger = {
			has_valid_civic = civic_hive_devouring_swarm
		}
	}
	option = {
		name = "ag_iota.4.d"
		trigger = {
			has_valid_civic = civic_machine_terminator
		}
	}
}

# Communication with enclave, menu
country_event = {
	id = ag_iota.10
	title = "ag_iota.10.name"
	# a - e: 	natural to player, default
	# f - j: 	friendly to player, default
	# k - l: 	natural to player, has agreement with player
	# m - n: 	friendly to player, has agreement with player
	# o: 	 	has starbase building agreement
	# p - t: 	hostile to player
	# response: response to other actions
	desc = {
		trigger = {
			ag_has_recently_flag_iota_enclave = no
			NOR = {
				has_valid_civic = civic_fanatic_purifiers
				has_valid_civic = civic_hive_devouring_swarm
				has_valid_civic = civic_machine_terminator
			}
			event_target:ag_ancient_iota_enclave = {
				NOT = { is_hostile = root }
				trust = { who = root value < 50 }
			}
		}
		text = "ag_iota.10.a.desc"
	}
	desc = {
		trigger = {
			ag_has_recently_flag_iota_enclave = no
			NOR = {
				has_valid_civic = civic_fanatic_purifiers
				has_valid_civic = civic_hive_devouring_swarm
				has_valid_civic = civic_machine_terminator
			}
			event_target:ag_ancient_iota_enclave = {
				NOT = { is_hostile = root }
				trust = { who = root value < 50 }
			}
		}
		text = "ag_iota.10.b.desc"
	}
	desc = {
		trigger = {
			ag_has_recently_flag_iota_enclave = no
			NOR = {
				has_valid_civic = civic_fanatic_purifiers
				has_valid_civic = civic_hive_devouring_swarm
				has_valid_civic = civic_machine_terminator
			}
			event_target:ag_ancient_iota_enclave = {
				NOT = { is_hostile = root }
				trust = { who = root value < 50 }
			}
		}
		text = "ag_iota.10.c.desc"
	}
	desc = {
		trigger = {
			ag_has_recently_flag_iota_enclave = no
			NOR = {
				has_valid_civic = civic_fanatic_purifiers
				has_valid_civic = civic_hive_devouring_swarm
				has_valid_civic = civic_machine_terminator
			}
			event_target:ag_ancient_iota_enclave = {
				NOT = { is_hostile = root }
				trust = { who = root value < 50 }
			}
		}
		text = "ag_iota.10.d.desc"
	}
	desc = {
		trigger = {
			ag_has_recently_flag_iota_enclave = no
			NOR = {
				has_valid_civic = civic_fanatic_purifiers
				has_valid_civic = civic_hive_devouring_swarm
				has_valid_civic = civic_machine_terminator
			}
			event_target:ag_ancient_iota_enclave = {
				NOT = { is_hostile = root }
				trust = { who = root value < 50 }
			}
		}
		text = "ag_iota.10.e.desc"
	}
	desc = {
		trigger = {
			ag_has_recently_flag_iota_enclave = no
			NOR = {
				has_valid_civic = civic_fanatic_purifiers
				has_valid_civic = civic_hive_devouring_swarm
				has_valid_civic = civic_machine_terminator
			}
			event_target:ag_ancient_iota_enclave = {
				NOT = { is_hostile = root }
				trust = { who = root value >= 50 }
			}
		}
		text = "ag_iota.10.f.desc"
	}
	desc = {
		trigger = {
			ag_has_recently_flag_iota_enclave = no
			NOR = {
				has_valid_civic = civic_fanatic_purifiers
				has_valid_civic = civic_hive_devouring_swarm
				has_valid_civic = civic_machine_terminator
			}
			event_target:ag_ancient_iota_enclave = {
				NOT = { is_hostile = root }
				trust = { who = root value >= 50 }
			}
		}
		text = "ag_iota.10.g.desc"
	}
	desc = {
		trigger = {
			ag_has_recently_flag_iota_enclave = no
			NOR = {
				has_valid_civic = civic_fanatic_purifiers
				has_valid_civic = civic_hive_devouring_swarm
				has_valid_civic = civic_machine_terminator
			}
			event_target:ag_ancient_iota_enclave = {
				NOT = { is_hostile = root }
				trust = { who = root value >= 50 }
			}
		}
		text = "ag_iota.10.h.desc"
	}
	desc = {
		trigger = {
			ag_has_recently_flag_iota_enclave = no
			NOR = {
				has_valid_civic = civic_fanatic_purifiers
				has_valid_civic = civic_hive_devouring_swarm
				has_valid_civic = civic_machine_terminator
			}
			event_target:ag_ancient_iota_enclave = {
				NOT = { is_hostile = root }
				trust = { who = root value >= 50 }
			}
		}
		text = "ag_iota.10.i.desc"
	}
	desc = {
		trigger = {
			ag_has_recently_flag_iota_enclave = no
			NOR = {
				has_valid_civic = civic_fanatic_purifiers
				has_valid_civic = civic_hive_devouring_swarm
				has_valid_civic = civic_machine_terminator
			}
			event_target:ag_ancient_iota_enclave = {
				NOT = { is_hostile = root }
				trust = { who = root value >= 50 }
			}
		}
		text = "ag_iota.10.j.desc"
	}
	desc = {
		trigger = {
			ag_has_recently_flag_iota_enclave = no
			NOR = {
				has_valid_civic = civic_fanatic_purifiers
				has_valid_civic = civic_hive_devouring_swarm
				has_valid_civic = civic_machine_terminator
			}
			ag_has_valid_trade_with_iota_enclave = yes
			event_target:ag_ancient_iota_enclave = {
				NOT = { is_hostile = root }
				trust = { who = root value < 50 }
			}
		}
		text = "ag_iota.10.k.desc"
	}
	desc = {
		trigger = {
			ag_has_recently_flag_iota_enclave = no
			NOR = {
				has_valid_civic = civic_fanatic_purifiers
				has_valid_civic = civic_hive_devouring_swarm
				has_valid_civic = civic_machine_terminator
			}
			ag_has_valid_trade_with_iota_enclave = yes
			event_target:ag_ancient_iota_enclave = {
				NOT = { is_hostile = root }
				trust = { who = root value < 50 }
			}
		}
		text = "ag_iota.10.l.desc"
	}
	desc = {
		trigger = {
			ag_has_recently_flag_iota_enclave = no
			NOR = {
				has_valid_civic = civic_fanatic_purifiers
				has_valid_civic = civic_hive_devouring_swarm
				has_valid_civic = civic_machine_terminator
			}
			ag_has_valid_trade_with_iota_enclave = yes
			event_target:ag_ancient_iota_enclave = {
				NOT = { is_hostile = root }
				trust = { who = root value >= 50 }
			}
		}
		text = "ag_iota.10.m.desc"
	}
	desc = {
		trigger = {
			ag_has_recently_flag_iota_enclave = no
			NOR = {
				has_valid_civic = civic_fanatic_purifiers
				has_valid_civic = civic_hive_devouring_swarm
				has_valid_civic = civic_machine_terminator
			}
			ag_has_valid_trade_with_iota_enclave = yes
			event_target:ag_ancient_iota_enclave = {
				NOT = { is_hostile = root }
				trust = { who = root value >= 50 }
			}
		}
		text = "ag_iota.10.n.desc"
	}
	desc = {
		trigger = {
			ag_has_recently_flag_iota_enclave = no
			NOR = {
				has_valid_civic = civic_fanatic_purifiers
				has_valid_civic = civic_hive_devouring_swarm
				has_valid_civic = civic_machine_terminator
			}
			has_country_flag = ag_ancient_iota_enclave_building_flag
			event_target:ag_ancient_iota_enclave = {
				NOT = { is_hostile = root }
				trust = { who = root value >= 50 }
			}
		}
		text = "ag_iota.10.o.desc"
	}
	desc = {
		trigger = {
			OR = {
				has_valid_civic = civic_fanatic_purifiers
				has_valid_civic = civic_hive_devouring_swarm
				has_valid_civic = civic_machine_terminator
				is_hostile = event_target:ag_ancient_iota_enclave
			}
		}
		text = "ag_iota.10.p.desc"
	}
	desc = {
		trigger = {
			OR = {
				has_valid_civic = civic_fanatic_purifiers
				has_valid_civic = civic_hive_devouring_swarm
				has_valid_civic = civic_machine_terminator
				is_hostile = event_target:ag_ancient_iota_enclave
			}
		}
		text = "ag_iota.10.q.desc"
	}
	desc = {
		trigger = {
			OR = {
				has_valid_civic = civic_fanatic_purifiers
				has_valid_civic = civic_hive_devouring_swarm
				has_valid_civic = civic_machine_terminator
				is_hostile = event_target:ag_ancient_iota_enclave
			}
		}
		text = "ag_iota.10.r.desc"
	}
	desc = {
		trigger = {
			OR = {
				has_valid_civic = civic_fanatic_purifiers
				has_valid_civic = civic_hive_devouring_swarm
				has_valid_civic = civic_machine_terminator
				is_hostile = event_target:ag_ancient_iota_enclave
			}
		}
		text = "ag_iota.10.s.desc"
	}
	desc = {
		trigger = {
			OR = {
				has_valid_civic = civic_fanatic_purifiers
				has_valid_civic = civic_hive_devouring_swarm
				has_valid_civic = civic_machine_terminator
				is_hostile = event_target:ag_ancient_iota_enclave
			}
		}
		text = "ag_iota.10.t.desc"
	}
	desc = {
		trigger = {
			NOR = {
				has_valid_civic = civic_fanatic_purifiers
				has_valid_civic = civic_hive_devouring_swarm
				has_valid_civic = civic_machine_terminator
			}
			has_country_flag = ag_recently_support_iota_enclave
		}
		text = "ag_iota.21.a.response"
	}
	desc = {
		trigger = {
			NOR = {
				has_valid_civic = civic_fanatic_purifiers
				has_valid_civic = civic_hive_devouring_swarm
				has_valid_civic = civic_machine_terminator
			}
			has_country_flag = ag_recently_cancel_support_iota_enclave
		}
		text = "ag_iota.22.a.response"
	}
	desc = {
		trigger = {
			NOR = {
				has_valid_civic = civic_fanatic_purifiers
				has_valid_civic = civic_hive_devouring_swarm
				has_valid_civic = civic_machine_terminator
			}
			has_country_flag = ag_recently_living_metal_trade_iota_enclave
		}
		text = "ag_iota.32.response"
	}
	desc = {
		trigger = {
			NOR = {
				has_valid_civic = civic_fanatic_purifiers
				has_valid_civic = civic_hive_devouring_swarm
				has_valid_civic = civic_machine_terminator
			}
			has_country_flag = ag_recently_nanites_trade_iota_enclave
		}
		text = "ag_iota.33.response"
	}
	desc = {
		trigger = {
			NOR = {
				has_valid_civic = civic_fanatic_purifiers
				has_valid_civic = civic_hive_devouring_swarm
				has_valid_civic = civic_machine_terminator
			}
			has_country_flag = ag_recently_dark_matter_trade_iota_enclave
		}
		text = "ag_iota.34.response"
	}
	desc = {
		trigger = {
			NOR = {
				has_valid_civic = civic_fanatic_purifiers
				has_valid_civic = civic_hive_devouring_swarm
				has_valid_civic = civic_machine_terminator
			}
			has_country_flag = ag_recently_cancel_living_metal_trade_iota_enclave
		}
		text = "ag_iota.35.a.response"
	}
	desc = {
		trigger = {
			NOR = {
				has_valid_civic = civic_fanatic_purifiers
				has_valid_civic = civic_hive_devouring_swarm
				has_valid_civic = civic_machine_terminator
			}
			has_country_flag = ag_recently_cancel_nanites_trade_iota_enclave
		}
		text = "ag_iota.35.b.response"
	}
	desc = {
		trigger = {
			NOR = {
				has_valid_civic = civic_fanatic_purifiers
				has_valid_civic = civic_hive_devouring_swarm
				has_valid_civic = civic_machine_terminator
			}
			has_country_flag = ag_recently_cancel_dark_matter_trade_iota_enclave
		}
		text = "ag_iota.35.c.response"
	}
	desc = {
		trigger = {
			NOR = {
				has_valid_civic = civic_fanatic_purifiers
				has_valid_civic = civic_hive_devouring_swarm
				has_valid_civic = civic_machine_terminator
			}
			has_country_flag = ag_recently_ask_for_building_iota_enclave
		}
		text = "ag_iota.10.g.response"
	}
	
	is_triggered_only = yes
	
	diplomatic = yes
	force_open = yes
	custom_gui = "ag_ancient_event_diplomacy_window"
	custom_gui_option = "ag_ancient_event_diplomacy_option"

	picture_event_data = {
		portrait = event_target:ag_ancient_iota_enclave
		room = ag_ancient_structure_room
	}

	trigger = {
		ag_can_communicate_with_iota_enclave = yes
	}

	immediate = {
		if = {
			limit = {
				NOT = {
					has_country_flag = ag_ancient_iota_enclave_diplomacy_engaged
				}
			}
			set_country_flag = ag_ancient_iota_enclave_diplomacy_engaged
		}
	}

	#资助
	option = {
		name = "ag_iota.10.a"
		trigger = {
			NOR = {
				has_country_flag = ag_support_iota_enclave_actived
				is_hostile = event_target:ag_ancient_iota_enclave
				has_valid_civic = civic_fanatic_purifiers
				has_valid_civic = civic_hive_devouring_swarm
				has_valid_civic = civic_machine_terminator
			}
		}
		hidden_effect = {
			country_event = { id = ag_iota.21 }
			ag_remove_all_recently_flag = yes
		}
	}
	#撤回资助
	option = {
		name = "ag_iota.10.b"
		trigger = {
			has_country_flag = ag_support_iota_enclave_actived
			NOR = {
				is_hostile = event_target:ag_ancient_iota_enclave
				has_valid_civic = civic_fanatic_purifiers
				has_valid_civic = civic_hive_devouring_swarm
				has_valid_civic = civic_machine_terminator
			}
		}
		hidden_effect = {
			country_event = { id = ag_iota.22 }
			ag_remove_all_recently_flag = yes
		}
	}
	#交易资源
	option = {
		name = "ag_iota.10.c"
		trigger = {
			NOR = {
				is_hostile = event_target:ag_ancient_iota_enclave
				has_valid_civic = civic_fanatic_purifiers
				has_valid_civic = civic_hive_devouring_swarm
				has_valid_civic = civic_machine_terminator
			}
			custom_tooltip = {
				fail_text = "ag_iota.require_no_3_trades"
				NAND = {
					has_country_flag = ag_living_metal_trade_iota_enclave_actived
					has_country_flag = ag_nanites_trade_iota_enclave_actived
					has_country_flag = ag_dark_matter_trade_iota_enclave_actived
				}
			}
		}
		allow = {
			custom_tooltip = {
				fail_text = "ag_iota.request_trust_25"
				event_target:ag_ancient_iota_enclave = {
					trust = { who = root value >= 25 }
				}
			}
		}
		hidden_effect = {
			country_event = { id = ag_iota.31 }
			ag_remove_all_recently_flag = yes
		}
	}
	#停止交易资源
	option = {
		name = "ag_iota.10.d"
		trigger = {
			ag_has_valid_trade_with_iota_enclave = yes
			NOR = {
				is_hostile = event_target:ag_ancient_iota_enclave
				has_valid_civic = civic_fanatic_purifiers
				has_valid_civic = civic_hive_devouring_swarm
				has_valid_civic = civic_machine_terminator
			}
		}
		hidden_effect = {
			country_event = { id = ag_iota.35 }
			ag_remove_all_recently_flag = yes
		}
	}
	#查阅古代档案
	option = {
		name = "ag_iota.10.e"
		trigger = {
			NOR = {
				is_hostile = event_target:ag_ancient_iota_enclave
				has_valid_civic = civic_fanatic_purifiers
				has_valid_civic = civic_hive_devouring_swarm
				has_valid_civic = civic_machine_terminator
			}
		}
		allow = {
			custom_tooltip = {
				fail_text = "ag_iota.request_trust_50"
				event_target:ag_ancient_iota_enclave = {
					trust = { who = root value >= 50 }
				}
			}
		}
		hidden_effect = {
			country_event = { id = ag_iota.41 }
			ag_remove_all_recently_flag = yes
		}
	}
	#介绍一下你们自己？
	option = {
		name = "ag_iota.10.f"
		trigger = {
			NOR = {
				is_hostile = event_target:ag_ancient_iota_enclave
				has_valid_civic = civic_fanatic_purifiers
				has_valid_civic = civic_hive_devouring_swarm
				has_valid_civic = civic_machine_terminator
			}
		}
		hidden_effect = {
			country_event = { id = ag_iota.51 }
			ag_remove_all_recently_flag = yes
		}
	}
	#建立合作设施
	option = {
		name = "ag_iota.10.g"
		trigger = {
			NOR = {
				has_country_flag = ag_ancient_iota_enclave_building_flag
				is_hostile = event_target:ag_ancient_iota_enclave
				has_valid_civic = civic_fanatic_purifiers
				has_valid_civic = civic_hive_devouring_swarm
				has_valid_civic = civic_machine_terminator
			}
		}
		allow = {
			custom_tooltip = {
				fail_text = "ag_iota.request_trust_90"
				event_target:ag_ancient_iota_enclave = {
					trust = { who = root value >= 90 }
				}
			}
		}
		hidden_effect = {
			country_event = { id = ag_iota.10 }
			set_country_flag = ag_ancient_iota_enclave_building_flag
			set_country_flag = ag_recently_ask_for_building_iota_enclave
		}
	}
	#再见。
	option = {
		name = "ag_iota.10.h"
		trigger = {
			NOR = {
				is_hostile = event_target:ag_ancient_iota_enclave
				has_valid_civic = civic_fanatic_purifiers
				has_valid_civic = civic_hive_devouring_swarm
				has_valid_civic = civic_machine_terminator
			}
		}
		default_hide_option = yes
		hidden_effect = {
			remove_country_flag = ag_ancient_iota_enclave_diplomacy_engaged
			ag_remove_all_recently_flag = yes
		}
	}
	option = {
		name = "ag_iota.10.i"
		trigger = {
			is_hostile = event_target:ag_ancient_iota_enclave
			NOR = {
				has_valid_civic = civic_fanatic_purifiers
				has_valid_civic = civic_hive_devouring_swarm
				has_valid_civic = civic_machine_terminator
			}
		}
		hidden_effect = {
			remove_country_flag = ag_ancient_iota_enclave_diplomacy_engaged
			ag_remove_all_recently_flag = yes
		}
	}
	option = {
		name = "ag_iota.10.j"
		trigger = {
			has_valid_civic = civic_fanatic_purifiers
		}
		hidden_effect = {
			remove_country_flag = ag_ancient_iota_enclave_diplomacy_engaged
			ag_remove_all_recently_flag = yes
		}
	}
	option = {
		name = "ag_iota.10.k"
		trigger = {
			has_valid_civic = civic_hive_devouring_swarm
		}
		hidden_effect = {
			remove_country_flag = ag_ancient_iota_enclave_diplomacy_engaged
			ag_remove_all_recently_flag = yes
		}
	}
	option = {
		name = "ag_iota.10.l"
		trigger = {
			has_valid_civic = civic_machine_terminator
		}
		hidden_effect = {
			remove_country_flag = ag_ancient_iota_enclave_diplomacy_engaged
			ag_remove_all_recently_flag = yes
		}
	}
}


#飞地通讯界面-提供资助

country_event = {
	id = ag_iota.21
	title = "ag_iota.21.name"
	desc = "ag_iota.21.desc"
	
	is_triggered_only = yes
	
	diplomatic = yes
	force_open = yes
	custom_gui = "ag_ancient_event_diplomacy_window"
	custom_gui_option = "ag_ancient_event_diplomacy_option"

	picture_event_data = {
		portrait = event_target:ag_ancient_iota_enclave
		room = ag_ancient_structure_room
	}

	trigger = {
		NOT = { is_hostile = event_target:ag_ancient_iota_enclave }
		ag_can_communicate_with_iota_enclave = yes
	}

	option = {
		name = "ag_iota.21.a"
		allow = {
			resource_stockpile_compare = {
				resource = energy
				value >= 1000
			}
			resource_stockpile_compare = {
				resource = alloys
				value >= 600
			}
		}
		add_resource = {
			energy = -1000
			alloys = -600
		}
		custom_tooltip = "ag_iota.21.a.tooltip"
		hidden_effect = {
			set_country_flag = ag_recently_support_iota_enclave
			set_country_flag = ag_support_iota_enclave_actived
			event_target:ag_ancient_iota_enclave = {
				add_trust = {
					who = root
					amount = 5
				}
			}
			add_modifier = {
				modifier = ag_support_iota_enclave
				days = -1
			}
			set_timed_country_flag = {
				flag = ag_recently_support_iota_enclave_timer
				days = 360
			}
			country_event = { id = ag_iota.10 }
		}
	}
	option = {
		name = "ag_iota.21.b"
		hidden_effect = {
			country_event = { id = ag_iota.10 }
		}
	}
	option = {
		name = "ag_iota.21.c"
		default_hide_option = yes
		hidden_effect = {
			remove_country_flag = ag_ancient_iota_enclave_diplomacy_engaged
		}
	}
}


#飞地通讯界面-取消提供资助

country_event = {
	id = ag_iota.22
	title = "ag_iota.22.name"
	desc = "ag_iota.22.desc"
	
	is_triggered_only = yes
	
	diplomatic = yes
	force_open = yes
	custom_gui = "ag_ancient_event_diplomacy_window"
	custom_gui_option = "ag_ancient_event_diplomacy_option"

	picture_event_data = {
		portrait = event_target:ag_ancient_iota_enclave
		room = ag_ancient_structure_room
	}

	trigger = {
		NOT = { is_hostile = event_target:ag_ancient_iota_enclave }
		ag_can_communicate_with_iota_enclave = yes
	}

	option = {
		name = "ag_iota.22.a"
		if = {
			limit = {
				has_country_flag = ag_recently_support_iota_enclave_timer
			}
			add_resource = {
				energy = 750
				alloys = 450
			}
		}
		custom_tooltip = "ag_iota.22.a.tooltip"
		hidden_effect = {
			set_country_flag = ag_recently_cancel_support_iota_enclave
			event_target:ag_ancient_iota_enclave = {
				add_trust = {
					who = root
					amount = -5
				}
			}
			remove_country_flag = ag_support_iota_enclave_actived
			remove_modifier = ag_support_iota_enclave
			country_event = { id = ag_iota.10 }
		}
	}
	option = {
		name = "ag_iota.22.b"
		hidden_effect = {
			country_event = { id = ag_iota.10 }
		}
	}
	option = {
		name = "ag_iota.22.c"
		default_hide_option = yes
		hidden_effect = {
			remove_country_flag = ag_ancient_iota_enclave_diplomacy_engaged
		}
	}
}


#飞地通讯界面-交易资源

country_event = {
	id = ag_iota.31
	title = "ag_iota.31.name"
	desc = {
		trigger = {
			event_target:ag_ancient_iota_enclave = {
				trust = { who = root value < 50 }
			}
		}
		text = "ag_iota.31.a.desc"
	}
	desc = {
		trigger = {
			event_target:ag_ancient_iota_enclave = {
				trust = { who = root value >= 50 }
			}
		}
		text = "ag_iota.31.b.desc"
	}
	
	is_triggered_only = yes
	
	diplomatic = yes
	force_open = yes
	custom_gui = "ag_ancient_event_diplomacy_window"
	custom_gui_option = "ag_ancient_event_diplomacy_option"

	picture_event_data = {
		portrait = event_target:ag_ancient_iota_enclave
		room = ag_ancient_structure_room
	}

	trigger = {
		NOT = { is_hostile = event_target:ag_ancient_iota_enclave }
		ag_can_communicate_with_iota_enclave = yes
	}

	option = {
		name = "ag_iota.31.a"
		allow = {
			custom_tooltip = {
				fail_text = "ag_iota.31.a.fail_text"
				NOT = {
					has_country_flag = ag_living_metal_trade_iota_enclave_actived
				}
			}
		}
		hidden_effect = {
			country_event = { id = ag_iota.32 }
		}
	}
	option = {
		name = "ag_iota.31.b"
		allow = {
			custom_tooltip = {
				fail_text = "ag_iota.31.b.fail_text"
				NOT = {
					has_country_flag = ag_nanites_trade_iota_enclave_actived
				}
			}
		}
		hidden_effect = {
			country_event = { id = ag_iota.33 }
		}
	}
	option = {
		name = "ag_iota.31.c"
		allow = {
			custom_tooltip = {
				fail_text = "ag_iota.31.c.fail_text"
				NOT = {
					has_country_flag = ag_dark_matter_trade_iota_enclave_actived
				}
			}
		}
		hidden_effect = {
			country_event = { id = ag_iota.34 }
		}
	}
	option = {
		name = "ag_iota.31.d"
		hidden_effect = {
			country_event = { id = ag_iota.10 }
		}
	}
	option = {
		name = "ag_iota.31.e"
		default_hide_option = yes
		hidden_effect = {
			remove_country_flag = ag_ancient_iota_enclave_diplomacy_engaged
		}
	}
}


#飞地通讯界面-交易活性金属

country_event = {
	id = ag_iota.32
	title = "ag_iota.32.name"
	desc = "ag_iota.32.desc"
	
	is_triggered_only = yes
	
	diplomatic = yes
	force_open = yes
	custom_gui = "ag_ancient_event_diplomacy_window"
	custom_gui_option = "ag_ancient_event_diplomacy_option"

	picture_event_data = {
		portrait = event_target:ag_ancient_iota_enclave
		room = ag_ancient_structure_room
	}

	trigger = {
		NOT = { is_hostile = event_target:ag_ancient_iota_enclave }
		ag_can_communicate_with_iota_enclave = yes
	}

	option = {
		name = "ag_iota.32.a"
		custom_tooltip = "ag_iota.opinion_5"
		allow = {
			resource_stockpile_compare = {
				resource = energy
				value >= 1000
			}
		}
		add_resource = {
			energy = -1000
		}
		hidden_effect = {
			set_country_flag = ag_living_metal_trade_iota_enclave_actived
			set_country_flag = ag_recently_living_metal_trade_iota_enclave
			event_target:ag_ancient_iota_enclave = {
				add_trust = {
					who = root
					amount = 5
				}
			}
			add_modifier = {
				modifier = ag_iota_enclave_living_metal_trade_1
				days = -1
			}
			set_timed_country_flag = {
				flag = ag_iota_enclave_living_metal_trade_1_timer
				days = 360
			}
			country_event = { id = ag_iota.10 }
		}
	}
	option = {
		name = "ag_iota.32.b"
		custom_tooltip = "ag_iota.opinion_5"
		allow = {
			resource_stockpile_compare = {
				resource = energy
				value >= 2000
			}
		}
		add_resource = {
			energy = -2000
		}
		hidden_effect = {
			set_country_flag = ag_living_metal_trade_iota_enclave_actived
			set_country_flag = ag_recently_living_metal_trade_iota_enclave
			event_target:ag_ancient_iota_enclave = {
				add_trust = {
					who = root
					amount = 5
				}
			}
			add_modifier = {
				modifier = ag_iota_enclave_living_metal_trade_2
				days = -1
			}
			set_timed_country_flag = {
				flag = ag_iota_enclave_living_metal_trade_2_timer
				days = 360
			}
			country_event = { id = ag_iota.10 }
		}
	}
	option = {
		name = "ag_iota.32.c"
		custom_tooltip = "ag_iota.opinion_5"
		allow = {
			resource_stockpile_compare = {
				resource = energy
				value >= 3000
			}
		}
		add_resource = {
			energy = -3000
		}
		hidden_effect = {
			set_country_flag = ag_living_metal_trade_iota_enclave_actived
			set_country_flag = ag_recently_living_metal_trade_iota_enclave
			event_target:ag_ancient_iota_enclave = {
				add_trust = {
					who = root
					amount = 5
				}
			}
			add_modifier = {
				modifier = ag_iota_enclave_living_metal_trade_3
				days = -1
			}
			set_timed_country_flag = {
				flag = ag_iota_enclave_living_metal_trade_3_timer
				days = 360
			}
			country_event = { id = ag_iota.10 }
		}
	}
	option = {
		name = "ag_iota.32.d"
		custom_tooltip = "ag_iota.opinion_5"
		allow = {
			resource_stockpile_compare = {
				resource = energy
				value >= 4000
			}
		}
		add_resource = {
			energy = -4000
		}
		hidden_effect = {
			set_country_flag = ag_living_metal_trade_iota_enclave_actived
			set_country_flag = ag_recently_living_metal_trade_iota_enclave
			event_target:ag_ancient_iota_enclave = {
				add_trust = {
					who = root
					amount = 5
				}
			}
			add_modifier = {
				modifier = ag_iota_enclave_living_metal_trade_4
				days = -1
			}
			set_timed_country_flag = {
				flag = ag_iota_enclave_living_metal_trade_4_timer
				days = 360
			}
			country_event = { id = ag_iota.10 }
		}
	}
	option = {
		name = "ag_iota.32.e"
		custom_tooltip = "ag_iota.opinion_5"
		allow = {
			resource_stockpile_compare = {
				resource = energy
				value >= 5000
			}
		}
		add_resource = {
			energy = -5000
		}
		hidden_effect = {
			set_country_flag = ag_living_metal_trade_iota_enclave_actived
			set_country_flag = ag_recently_living_metal_trade_iota_enclave
			event_target:ag_ancient_iota_enclave = {
				add_trust = {
					who = root
					amount = 5
				}
			}
			add_modifier = {
				modifier = ag_iota_enclave_living_metal_trade_5
				days = -1
			}
			set_timed_country_flag = {
				flag = ag_iota_enclave_living_metal_trade_5_timer
				days = 360
			}
			country_event = { id = ag_iota.10 }
		}
	}
	option = {
		name = "ag_iota.32.f"
		hidden_effect = {
			country_event = { id = ag_iota.10 }
		}
	}
	option = {
		name = "ag_iota.32.g"
		default_hide_option = yes
		hidden_effect = {
			remove_country_flag = ag_ancient_iota_enclave_diplomacy_engaged
		}
	}
}


#飞地通讯界面-纳米机器

country_event = {
	id = ag_iota.33
	title = "ag_iota.33.name"
	desc = "ag_iota.33.desc"
	
	is_triggered_only = yes
	
	diplomatic = yes
	force_open = yes
	custom_gui = "ag_ancient_event_diplomacy_window"
	custom_gui_option = "ag_ancient_event_diplomacy_option"

	picture_event_data = {
		portrait = event_target:ag_ancient_iota_enclave
		room = ag_ancient_structure_room
	}

	trigger = {
		NOT = { is_hostile = event_target:ag_ancient_iota_enclave }
		ag_can_communicate_with_iota_enclave = yes
	}

	option = {
		name = "ag_iota.33.a"
		custom_tooltip = "ag_iota.opinion_5"
		allow = {
			resource_stockpile_compare = {
				resource = energy
				value >= 1000
			}
		}
		add_resource = {
			energy = -1000
		}
		hidden_effect = {
			set_country_flag = ag_nanites_trade_iota_enclave_actived
			set_country_flag = ag_recently_nanites_trade_iota_enclave
			event_target:ag_ancient_iota_enclave = {
				add_trust = {
					who = root
					amount = 5
				}
			}
			add_modifier = {
				modifier = ag_iota_enclave_nanites_trade_1
				days = -1
			}
			set_timed_country_flag = {
				flag = ag_iota_enclave_nanites_trade_1_timer
				days = 360
			}
			country_event = { id = ag_iota.10 }
		}
	}
	option = {
		name = "ag_iota.33.b"
		custom_tooltip = "ag_iota.opinion_5"
		allow = {
			resource_stockpile_compare = {
				resource = energy
				value >= 2000
			}
		}
		add_resource = {
			energy = -2000
		}
		hidden_effect = {
			set_country_flag = ag_nanites_trade_iota_enclave_actived
			set_country_flag = ag_recently_nanites_trade_iota_enclave
			event_target:ag_ancient_iota_enclave = {
				add_trust = {
					who = root
					amount = 5
				}
			}
			add_modifier = {
				modifier = ag_iota_enclave_nanites_trade_2
				days = -1
			}
			set_timed_country_flag = {
				flag = ag_iota_enclave_nanites_trade_2_timer
				days = 360
			}
			country_event = { id = ag_iota.10 }
		}
	}
	option = {
		name = "ag_iota.33.c"
		custom_tooltip = "ag_iota.opinion_5"
		allow = {
			resource_stockpile_compare = {
				resource = energy
				value >= 3000
			}
		}
		add_resource = {
			energy = -3000
		}
		hidden_effect = {
			set_country_flag = ag_nanites_trade_iota_enclave_actived
			set_country_flag = ag_recently_nanites_trade_iota_enclave
			event_target:ag_ancient_iota_enclave = {
				add_trust = {
					who = root
					amount = 5
				}
			}
			add_modifier = {
				modifier = ag_iota_enclave_nanites_trade_3
				days = -1
			}
			set_timed_country_flag = {
				flag = ag_iota_enclave_nanites_trade_3_timer
				days = 360
			}
			country_event = { id = ag_iota.10 }
		}
	}
	option = {
		name = "ag_iota.33.d"
		custom_tooltip = "ag_iota.opinion_5"
		allow = {
			resource_stockpile_compare = {
				resource = energy
				value >= 4000
			}
		}
		add_resource = {
			energy = -4000
		}
		hidden_effect = {
			set_country_flag = ag_nanites_trade_iota_enclave_actived
			set_country_flag = ag_recently_nanites_trade_iota_enclave
			event_target:ag_ancient_iota_enclave = {
				add_trust = {
					who = root
					amount = 5
				}
			}
			add_modifier = {
				modifier = ag_iota_enclave_nanites_trade_4
				days = -1
			}
			set_timed_country_flag = {
				flag = ag_iota_enclave_nanites_trade_4_timer
				days = 360
			}
			country_event = { id = ag_iota.10 }
		}
	}
	option = {
		name = "ag_iota.33.e"
		custom_tooltip = "ag_iota.opinion_5"
		allow = {
			resource_stockpile_compare = {
				resource = energy
				value >= 5000
			}
		}
		add_resource = {
			energy = -5000
		}
		hidden_effect = {
			set_country_flag = ag_nanites_trade_iota_enclave_actived
			set_country_flag = ag_recently_nanites_trade_iota_enclave
			event_target:ag_ancient_iota_enclave = {
				add_trust = {
					who = root
					amount = 5
				}
			}
			add_modifier = {
				modifier = ag_iota_enclave_nanites_trade_5
				days = -1
			}
			set_timed_country_flag = {
				flag = ag_iota_enclave_nanites_trade_5_timer
				days = 360
			}
			country_event = { id = ag_iota.10 }
		}
	}
	option = {
		name = "ag_iota.33.f"
		hidden_effect = {
			country_event = { id = ag_iota.10 }
		}
	}
	option = {
		name = "ag_iota.33.g"
		default_hide_option = yes
		hidden_effect = {
			remove_country_flag = ag_ancient_iota_enclave_diplomacy_engaged
		}
	}
}


#飞地通讯界面-暗物质

country_event = {
	id = ag_iota.34
	title = "ag_iota.34.name"
	desc = "ag_iota.34.desc"
	
	is_triggered_only = yes
	
	diplomatic = yes
	force_open = yes
	custom_gui = "ag_ancient_event_diplomacy_window"
	custom_gui_option = "ag_ancient_event_diplomacy_option"

	picture_event_data = {
		portrait = event_target:ag_ancient_iota_enclave
		room = ag_ancient_structure_room
	}

	trigger = {
		NOT = { is_hostile = event_target:ag_ancient_iota_enclave }
		ag_can_communicate_with_iota_enclave = yes
	}

	option = {
		name = "ag_iota.34.a"
		custom_tooltip = "ag_iota.opinion_5"
		allow = {
			resource_stockpile_compare = {
				resource = energy
				value >= 1000
			}
		}
		add_resource = {
			energy = -1000
		}
		hidden_effect = {
			set_country_flag = ag_dark_matter_trade_iota_enclave_actived
			set_country_flag = ag_recently_dark_matter_trade_iota_enclave
			event_target:ag_ancient_iota_enclave = {
				add_trust = {
					who = root
					amount = 5
				}
			}
			add_modifier = {
				modifier = ag_iota_enclave_dark_matter_trade_1
				days = -1
			}
			set_timed_country_flag = {
				flag = ag_iota_enclave_dark_matter_trade_1_timer
				days = 360
			}
			country_event = { id = ag_iota.10 }
		}
	}
	option = {
		name = "ag_iota.34.b"
		custom_tooltip = "ag_iota.opinion_5"
		allow = {
			resource_stockpile_compare = {
				resource = energy
				value >= 2000
			}
		}
		add_resource = {
			energy = -2000
		}
		hidden_effect = {
			set_country_flag = ag_dark_matter_trade_iota_enclave_actived
			set_country_flag = ag_recently_dark_matter_trade_iota_enclave
			event_target:ag_ancient_iota_enclave = {
				add_trust = {
					who = root
					amount = 5
				}
			}
			add_modifier = {
				modifier = ag_iota_enclave_dark_matter_trade_2
				days = -1
			}
			set_timed_country_flag = {
				flag = ag_iota_enclave_dark_matter_trade_2_timer
				days = 360
			}
			country_event = { id = ag_iota.10 }
		}
	}
	option = {
		name = "ag_iota.34.c"
		custom_tooltip = "ag_iota.opinion_5"
		allow = {
			resource_stockpile_compare = {
				resource = energy
				value >= 3000
			}
		}
		add_resource = {
			energy = -3000
		}
		hidden_effect = {
			set_country_flag = ag_dark_matter_trade_iota_enclave_actived
			set_country_flag = ag_recently_dark_matter_trade_iota_enclave
			event_target:ag_ancient_iota_enclave = {
				add_trust = {
					who = root
					amount = 5
				}
			}
			add_modifier = {
				modifier = ag_iota_enclave_dark_matter_trade_3
				days = -1
			}
			set_timed_country_flag = {
				flag = ag_iota_enclave_dark_matter_trade_3_timer
				days = 360
			}
			country_event = { id = ag_iota.10 }
		}
	}
	option = {
		name = "ag_iota.34.d"
		custom_tooltip = "ag_iota.opinion_5"
		allow = {
			resource_stockpile_compare = {
				resource = energy
				value >= 4000
			}
		}
		add_resource = {
			energy = -4000
		}
		hidden_effect = {
			set_country_flag = ag_dark_matter_trade_iota_enclave_actived
			set_country_flag = ag_recently_dark_matter_trade_iota_enclave
			event_target:ag_ancient_iota_enclave = {
				add_trust = {
					who = root
					amount = 5
				}
			}
			add_modifier = {
				modifier = ag_iota_enclave_dark_matter_trade_4
				days = -1
			}
			set_timed_country_flag = {
				flag = ag_iota_enclave_dark_matter_trade_4_timer
				days = 360
			}
			country_event = { id = ag_iota.10 }
		}
	}
	option = {
		name = "ag_iota.34.e"
		custom_tooltip = "ag_iota.opinion_5"
		allow = {
			resource_stockpile_compare = {
				resource = energy
				value >= 5000
			}
		}
		add_resource = {
			energy = -5000
		}
		hidden_effect = {
			set_country_flag = ag_dark_matter_trade_iota_enclave_actived
			set_country_flag = ag_recently_dark_matter_trade_iota_enclave
			event_target:ag_ancient_iota_enclave = {
				add_trust = {
					who = root
					amount = 5
				}
			}
			add_modifier = {
				modifier = ag_iota_enclave_dark_matter_trade_5
				days = -1
			}
			set_timed_country_flag = {
				flag = ag_iota_enclave_dark_matter_trade_5_timer
				days = 360
			}
			country_event = { id = ag_iota.10 }
		}
	}
	option = {
		name = "ag_iota.34.f"
		hidden_effect = {
			country_event = { id = ag_iota.10 }
		}
	}
	option = {
		name = "ag_iota.34.g"
		default_hide_option = yes
		hidden_effect = {
			remove_country_flag = ag_ancient_iota_enclave_diplomacy_engaged
		}
	}
}


#飞地通讯界面-暗物质

country_event = {
	id = ag_iota.35
	title = "ag_iota.35.name"
	desc = "ag_iota.35.desc"
	
	is_triggered_only = yes
	
	diplomatic = yes
	force_open = yes
	custom_gui = "ag_ancient_event_diplomacy_window"
	custom_gui_option = "ag_ancient_event_diplomacy_option"

	picture_event_data = {
		portrait = event_target:ag_ancient_iota_enclave
		room = ag_ancient_structure_room
	}

	trigger = {
		NOT = { is_hostile = event_target:ag_ancient_iota_enclave }
		ag_can_communicate_with_iota_enclave = yes
	}

	option = {
		name = "ag_iota.35.a"
		custom_tooltip = "ag_iota.opinion_5_neg"
		trigger = {
			has_country_flag = ag_living_metal_trade_iota_enclave_actived
		}
		switch = {
			trigger = has_country_flag
			ag_iota_enclave_living_metal_trade_1_timer = { add_resource = { energy = 750 } }
			ag_iota_enclave_living_metal_trade_2_timer = { add_resource = { energy = 1500 } }
			ag_iota_enclave_living_metal_trade_3_timer = { add_resource = { energy = 2250 } }
			ag_iota_enclave_living_metal_trade_4_timer = { add_resource = { energy = 3000 } }
			ag_iota_enclave_living_metal_trade_5_timer = { add_resource = { energy = 3750 } }
		}
		hidden_effect = {
			remove_country_flag = ag_living_metal_trade_iota_enclave_actived
			set_country_flag = ag_recently_cancel_living_metal_trade_iota_enclave
			event_target:ag_ancient_iota_enclave = {
				add_trust = {
					who = root
					amount = -5
				}
			}
			remove_modifier = ag_iota_enclave_dark_matter_trade_1
			remove_modifier = ag_iota_enclave_dark_matter_trade_2
			remove_modifier = ag_iota_enclave_dark_matter_trade_3
			remove_modifier = ag_iota_enclave_dark_matter_trade_4
			remove_modifier = ag_iota_enclave_dark_matter_trade_5
			country_event = { id = ag_iota.10 }
		}
	}
	option = {
		name = "ag_iota.35.d"
		custom_tooltip = "ag_iota.opinion_5_neg"
		trigger = {
			has_country_flag = ag_nanites_trade_iota_enclave_actived
		}
		switch = {
			trigger = has_country_flag
			ag_iota_enclave_nanites_trade_1_timer = { add_resource = { energy = 750 } }
			ag_iota_enclave_nanites_trade_2_timer = { add_resource = { energy = 1500 } }
			ag_iota_enclave_nanites_trade_3_timer = { add_resource = { energy = 2250 } }
			ag_iota_enclave_nanites_trade_4_timer = { add_resource = { energy = 3000 } }
			ag_iota_enclave_nanites_trade_5_timer = { add_resource = { energy = 3750 } }
		}
		hidden_effect = {
			remove_country_flag = ag_nanites_trade_iota_enclave_actived
			set_country_flag = ag_recently_cancel_nanites_trade_iota_enclave
			event_target:ag_ancient_iota_enclave = {
				add_trust = {
					who = root
					amount = -5
				}
			}
			remove_modifier = ag_iota_enclave_dark_matter_trade_1
			remove_modifier = ag_iota_enclave_dark_matter_trade_2
			remove_modifier = ag_iota_enclave_dark_matter_trade_3
			remove_modifier = ag_iota_enclave_dark_matter_trade_4
			remove_modifier = ag_iota_enclave_dark_matter_trade_5
			country_event = { id = ag_iota.10 }
		}
	}
	option = {
		name = "ag_iota.35.c"
		custom_tooltip = "ag_iota.opinion_5_neg"
		trigger = {
			has_country_flag = ag_dark_matter_trade_iota_enclave_actived
		}
		switch = {
			trigger = has_country_flag
			ag_iota_enclave_dark_matter_trade_1_timer = { add_resource = { energy = 750 } }
			ag_iota_enclave_dark_matter_trade_2_timer = { add_resource = { energy = 1500 } }
			ag_iota_enclave_dark_matter_trade_3_timer = { add_resource = { energy = 2250 } }
			ag_iota_enclave_dark_matter_trade_4_timer = { add_resource = { energy = 3000 } }
			ag_iota_enclave_dark_matter_trade_5_timer = { add_resource = { energy = 3750 } }
		}
		hidden_effect = {
			remove_country_flag = ag_dark_matter_trade_iota_enclave_actived
			set_country_flag = ag_recently_cancel_dark_matter_trade_iota_enclave
			event_target:ag_ancient_iota_enclave = {
				add_trust = {
					who = root
					amount = -5
				}
			}
			remove_modifier = ag_iota_enclave_dark_matter_trade_1
			remove_modifier = ag_iota_enclave_dark_matter_trade_2
			remove_modifier = ag_iota_enclave_dark_matter_trade_3
			remove_modifier = ag_iota_enclave_dark_matter_trade_4
			remove_modifier = ag_iota_enclave_dark_matter_trade_5
			country_event = { id = ag_iota.10 }
		}
	}
	option = {
		name = "ag_iota.35.d"
		hidden_effect = {
			country_event = { id = ag_iota.10 }
		}
	}
	option = {
		name = "ag_iota.35.e"
		default_hide_option = yes
		hidden_effect = {
			remove_country_flag = ag_ancient_iota_enclave_diplomacy_engaged
		}
	}
}


#飞地通讯界面-查阅古代档案

country_event = {
	id = ag_iota.41
	title = "ag_iota.41.name"
	desc = "ag_iota.41.desc"
	
	is_triggered_only = yes
	
	diplomatic = yes
	force_open = yes
	custom_gui = "ag_ancient_event_diplomacy_window"
	custom_gui_option = "ag_ancient_event_diplomacy_option"

	picture_event_data = {
		portrait = event_target:ag_ancient_iota_enclave
		room = ag_ancient_structure_room
	}

	trigger = {
		NOT = { is_hostile = event_target:ag_ancient_iota_enclave }
		ag_can_communicate_with_iota_enclave = yes
	}

	option = {
		name = "ag_iota.41.a"
		trigger = {
			always = no
			any_system = {
				has_star_flag = ag_ancient_alpha_system
			}
		}
		hidden_effect = {
			country_event = { id = ag_iota.411 }
		}
	}
	option = {
		name = "ag_iota.41.b"
		trigger = {
			any_system = {
				has_star_flag = ag_ancient_beta_system
			}
		}
		hidden_effect = {
			country_event = { id = ag_iota.412 }
		}
	}
	option = {
		name = "ag_iota.41.c"
		trigger = {
			any_system = {
				has_star_flag = ag_ancient_gamma_system
			}
		}
		hidden_effect = {
			country_event = { id = ag_iota.413 }
		}
	}
	option = {
		name = "ag_iota.41.d"
		trigger = {
			any_system = {
				has_star_flag = ag_ancient_delta_system
			}
		}
		hidden_effect = {
			country_event = { id = ag_iota.414 }
		}
	}
	option = {
		name = "ag_iota.41.e"
		trigger = {
			always = no
			any_system = {
				has_star_flag = ag_ancient_epsilon_system
			}
		}
		hidden_effect = {
			country_event = { id = ag_iota.415 }
		}
	}
	option = {
		name = "ag_iota.41.f"
		trigger = {
			always = no
			any_system = {
				has_star_flag = ag_ancient_eta_system
			}
		}
		hidden_effect = {
			country_event = { id = ag_iota.416 }
		}
	}
	option = {
		name = "ag_iota.41.g"
		trigger = {
			any_system = {
				has_star_flag = ag_ancient_zeta_system
			}
		}
		hidden_effect = {
			country_event = { id = ag_iota.417 }
		}
	}
	option = {
		name = "ag_iota.41.h"
		trigger = {
			any_system = {
				has_star_flag = ag_ancient_theta_system
			}
		}
		hidden_effect = {
			country_event = { id = ag_iota.418 }
		}
	}
	option = {
		name = "ag_iota.41.return"
		hidden_effect = {
			country_event = { id = ag_iota.10 }
		}
	}
	option = {
		name = "ag_iota.41.exit"
		default_hide_option = yes
		hidden_effect = {
			remove_country_flag = ag_ancient_iota_enclave_diplomacy_engaged
		}
	}
}


#飞地通讯界面-查阅古代档案-A星域

country_event = {
	id = ag_iota.411
	title = "ag_iota.411.name"
	desc = "ag_iota.411.desc"
	
	is_triggered_only = yes
	
	diplomatic = yes
	force_open = yes
	custom_gui = "ag_ancient_event_diplomacy_window"
	custom_gui_option = "ag_ancient_event_diplomacy_option"

	picture_event_data = {
		portrait = event_target:ag_ancient_iota_enclave
		room = ag_ancient_structure_room
	}

	trigger = {
		NOT = { is_hostile = event_target:ag_ancient_iota_enclave }
		ag_can_communicate_with_iota_enclave = yes
	}

	option = {
		name = "ag_iota.41.return"
		hidden_effect = {
			country_event = { id = ag_iota.10 }
		}
	}
	option = {
		name = "ag_iota.41.exit"
		default_hide_option = yes
		hidden_effect = {
			remove_country_flag = ag_ancient_iota_enclave_diplomacy_engaged
		}
	}
}


#飞地通讯界面-查阅古代档案-B星域
country_event = {
	id = ag_iota.412
	title = "ag_iota.412.name"
	desc = "ag_iota.412.desc"
	
	is_triggered_only = yes
	
	diplomatic = yes
	force_open = yes
	custom_gui = "ag_ancient_event_diplomacy_window"
	custom_gui_option = "ag_ancient_event_diplomacy_option"

	picture_event_data = {
		portrait = event_target:ag_ancient_iota_enclave
		room = ag_ancient_structure_room
	}

	trigger = {
		NOT = { is_hostile = event_target:ag_ancient_iota_enclave }
		ag_can_communicate_with_iota_enclave = yes
	}

	option = {
		name = "ag_iota.41.introduce"
		response_text = "ag_iota.412.introduce.response"
		is_dialog_only = yes
		allow = {
			OR = {
				has_country_flag = ag_iota_41_beta_1_flag
				resource_stockpile_compare = {
					resource = energy
					value >= 1000
				}
			}
		}
		if = {
			limit = {
				NOT = {
					has_country_flag = ag_iota_41_beta_1_flag
				}
			}
			add_resource = { energy = -1000 }
			set_country_flag = ag_iota_41_beta_1_flag
		}
	}
	option = {
		name = "ag_iota.41.reward"
		response_text = "ag_iota.41.reward.response"
		is_dialog_only = yes
		trigger = {
			has_global_flag = ag_aneient_beta_psionic_effect_ended
			NOT = {
				has_country_flag = ag_ancient_beta_data_flag
			}
		}
		allow = {
			resource_stockpile_compare = {
				resource = energy
				value >= 5000
			}
			custom_tooltip = {
				fail_text = "ag_iota.41.failed"
				NOT = { has_country_flag = ag_ancient_beta_data_flag }
			}
		}
		add_resource = { energy = -5000 }
		hidden_effect = {
			set_country_flag = ag_ancient_beta_data_flag
			if = {
				limit = { has_country_flag = ag_has_research_project_203 }
				ag_iota_data_research_buff = { ag_project_id = 203 ag_no_change_difficulty = no }
			}
			if = {
				limit = { has_country_flag = ag_has_research_project_206 }
				ag_iota_data_research_buff = { ag_project_id = 206 ag_no_change_difficulty = no }
			}
		}
	}
	option = {
		name = "ag_iota.41.return"
		hidden_effect = {
			country_event = { id = ag_iota.10 }
		}
	}
	option = {
		name = "ag_iota.41.exit"
		default_hide_option = yes
		hidden_effect = {
			remove_country_flag = ag_ancient_iota_enclave_diplomacy_engaged
		}
	}
}


#飞地通讯界面-查阅古代档案-Γ星域
country_event = {
	id = ag_iota.413
	title = "ag_iota.413.name"
	desc = "ag_iota.413.desc"
	
	is_triggered_only = yes
	
	diplomatic = yes
	force_open = yes
	custom_gui = "ag_ancient_event_diplomacy_window"
	custom_gui_option = "ag_ancient_event_diplomacy_option"

	picture_event_data = {
		portrait = event_target:ag_ancient_iota_enclave
		room = ag_ancient_structure_room
	}

	trigger = {
		NOT = { is_hostile = event_target:ag_ancient_iota_enclave }
		ag_can_communicate_with_iota_enclave = yes
	}

	option = {
		name = "ag_iota.41.introduce"
		response_text = "ag_iota.413.introduce.response"
		is_dialog_only = yes
		allow = {
			OR = {
				has_country_flag = ag_iota_41_gamma_1_flag
				resource_stockpile_compare = {
					resource = energy
					value >= 1000
				}
			}
		}
		if = {
			limit = {
				NOT = {
					has_country_flag = ag_iota_41_gamma_1_flag
				}
			}
			add_resource = { energy = -1000 }
			set_country_flag = ag_iota_41_gamma_1_flag
		}
	}
	option = {
		name = "ag_iota.41.reward"
		response_text = "ag_iota.41.reward.response"
		is_dialog_only = yes
		trigger = {
			has_country_flag = ag_gamma_70_fired
			NOT = {
				has_country_flag = ag_ancient_gamma_data_flag
			}
		}
		allow = {
			resource_stockpile_compare = {
				resource = energy
				value >= 5000
			}
			custom_tooltip = {
				fail_text = "ag_iota.41.failed"
				NOT = {
					has_country_flag = ag_ancient_gamma_data_flag
				}
			}
		}
		add_resource = { energy = -5000 }
		hidden_effect = {
			set_country_flag = ag_ancient_gamma_data_flag
			if = {
				limit = { has_country_flag = ag_has_research_project_302 }
				ag_iota_data_research_buff = { ag_project_id = 302 ag_no_change_difficulty = no }
			}
		}
	}
	option = {
		name = "ag_iota.41.return"
		hidden_effect = {
			country_event = { id = ag_iota.10 }
		}
	}
	option = {
		name = "ag_iota.41.exit"
		default_hide_option = yes
		hidden_effect = {
			remove_country_flag = ag_ancient_iota_enclave_diplomacy_engaged
		}
	}
}


#飞地通讯界面-查阅古代档案-Δ星域
country_event = {
	id = ag_iota.414
	title = "ag_iota.414.name"
	desc = "ag_iota.414.desc"
	
	is_triggered_only = yes
	
	diplomatic = yes
	force_open = yes
	custom_gui = "ag_ancient_event_diplomacy_window"
	custom_gui_option = "ag_ancient_event_diplomacy_option"

	picture_event_data = {
		portrait = event_target:ag_ancient_iota_enclave
		room = ag_ancient_structure_room
	}

	trigger = {
		NOT = { is_hostile = event_target:ag_ancient_iota_enclave }
		ag_can_communicate_with_iota_enclave = yes
	}

	option = {
		name = "ag_iota.41.introduce"
		response_text = "ag_iota.414.introduce.response"
		is_dialog_only = yes
		allow = {
			OR = {
				has_country_flag = ag_iota_41_delta_1_flag
				resource_stockpile_compare = {
					resource = energy
					value >= 1000
				}
			}
		}
		if = {
			limit = {
				NOT = {
					has_country_flag = ag_iota_41_delta_1_flag
				}
			}
			add_resource = { energy = -1000 }
			set_country_flag = ag_iota_41_delta_1_flag
		}
	}
	option = {
		name = "ag_iota.41.reward"
		response_text = "ag_iota.41.reward.response"
		is_dialog_only = yes
		trigger = {
			has_country_flag = ag_delta_titan_destroyed
			NOT = {
				has_country_flag = ag_ancient_delta_data_flag
			}
		}
		allow = {
			resource_stockpile_compare = {
				resource = energy
				value >= 5000
			}
			custom_tooltip = {
				fail_text = "ag_iota.41.failed"
				NOT = {
					has_country_flag = ag_ancient_delta_data_flag
				}
			}
		}
		add_resource = { energy = -5000 }
		hidden_effect = {
			set_country_flag = ag_ancient_delta_data_flag
			if = {
				limit = { has_country_flag = ag_has_research_project_403 }
				ag_iota_data_research_buff = { ag_project_id = 403 ag_no_change_difficulty = no }
			}
		}
	}
	option = {
		name = "ag_iota.41.return"
		hidden_effect = {
			country_event = { id = ag_iota.10 }
		}
	}
	option = {
		name = "ag_iota.41.exit"
		default_hide_option = yes
		hidden_effect = {
			remove_country_flag = ag_ancient_iota_enclave_diplomacy_engaged
		}
	}
}


#飞地通讯界面-查阅古代档案-E星域
country_event = {
	id = ag_iota.415
	title = "ag_iota.415.name"
	desc = "ag_iota.415.desc"
	
	is_triggered_only = yes
	
	diplomatic = yes
	force_open = yes
	custom_gui = "ag_ancient_event_diplomacy_window"
	custom_gui_option = "ag_ancient_event_diplomacy_option"

	picture_event_data = {
		portrait = event_target:ag_ancient_iota_enclave
		room = ag_ancient_structure_room
	}

	trigger = {
		NOT = { is_hostile = event_target:ag_ancient_iota_enclave }
		ag_can_communicate_with_iota_enclave = yes
	}

	option = {
		name = "ag_iota.41.return"
		hidden_effect = {
			country_event = { id = ag_iota.10 }
		}
	}
	option = {
		name = "ag_iota.41.exit"
		default_hide_option = yes
		hidden_effect = {
			remove_country_flag = ag_ancient_iota_enclave_diplomacy_engaged
		}
	}
}


#飞地通讯界面-查阅古代档案-H星域
country_event = {
	id = ag_iota.416
	title = "ag_iota.416.name"
	desc = "ag_iota.416.desc"
	
	is_triggered_only = yes
	
	diplomatic = yes
	force_open = yes
	custom_gui = "ag_ancient_event_diplomacy_window"
	custom_gui_option = "ag_ancient_event_diplomacy_option"

	picture_event_data = {
		portrait = event_target:ag_ancient_iota_enclave
		room = ag_ancient_structure_room
	}

	trigger = {
		NOT = { is_hostile = event_target:ag_ancient_iota_enclave }
		ag_can_communicate_with_iota_enclave = yes
	}

	option = {
		name = "ag_iota.41.return"
		hidden_effect = {
			country_event = { id = ag_iota.10 }
		}
	}
	option = {
		name = "ag_iota.41.exit"
		default_hide_option = yes
		hidden_effect = {
			remove_country_flag = ag_ancient_iota_enclave_diplomacy_engaged
		}
	}
}


#飞地通讯界面-查阅古代档案-Z星域
country_event = {
	id = ag_iota.417
	title = "ag_iota.417.name"
	desc = "ag_iota.417.desc"
	
	is_triggered_only = yes
	
	diplomatic = yes
	force_open = yes
	custom_gui = "ag_ancient_event_diplomacy_window"
	custom_gui_option = "ag_ancient_event_diplomacy_option"

	picture_event_data = {
		portrait = event_target:ag_ancient_iota_enclave
		room = ag_ancient_structure_room
	}

	trigger = {
		NOT = { is_hostile = event_target:ag_ancient_iota_enclave }
		ag_can_communicate_with_iota_enclave = yes
	}

	option = {
		name = "ag_iota.41.introduce"
		response_text = "ag_iota.417.introduce.response"
		is_dialog_only = yes
		allow = {
			OR = {
				has_country_flag = ag_iota_41_zeta_1_flag
				resource_stockpile_compare = {
					resource = energy
					value >= 1000
				}
			}
		}
		if = {
			limit = {
				NOT = {
					has_country_flag = ag_iota_41_zeta_1_flag
				}
			}
			add_resource = { energy = -1000 }
			set_country_flag = ag_iota_41_zeta_1_flag
		}
	}
	option = {
		name = "ag_iota.41.return"
		hidden_effect = {
			country_event = { id = ag_iota.10 }
		}
	}
	option = {
		name = "ag_iota.41.exit"
		default_hide_option = yes
		hidden_effect = {
			remove_country_flag = ag_ancient_iota_enclave_diplomacy_engaged
		}
	}
}


#飞地通讯界面-查阅古代档案-Θ星域
country_event = {
	id = ag_iota.418
	title = "ag_iota.418.name"
	desc = "ag_iota.418.desc"
	
	is_triggered_only = yes
	
	diplomatic = yes
	force_open = yes
	custom_gui = "ag_ancient_event_diplomacy_window"
	custom_gui_option = "ag_ancient_event_diplomacy_option"

	picture_event_data = {
		portrait = event_target:ag_ancient_iota_enclave
		room = ag_ancient_structure_room
	}

	trigger = {
		NOT = { is_hostile = event_target:ag_ancient_iota_enclave }
		ag_can_communicate_with_iota_enclave = yes
	}

	option = {
		name = "ag_iota.41.introduce"
		response_text = "ag_iota.418.introduce.response"
		is_dialog_only = yes
		allow = {
			OR = {
				has_country_flag = ag_iota_41_theta_1_flag
				resource_stockpile_compare = {
					resource = energy
					value >= 1000
				}
			}
		}
		if = {
			limit = {
				NOT = {
					has_country_flag = ag_iota_41_theta_1_flag
				}
			}
			add_resource = { energy = -1000 }
			set_country_flag = ag_iota_41_theta_1_flag
		}
	}
	option = {
		name = "ag_iota.41.return"
		hidden_effect = {
			country_event = { id = ag_iota.10 }
		}
	}
	option = {
		name = "ag_iota.41.exit"
		default_hide_option = yes
		hidden_effect = {
			remove_country_flag = ag_ancient_iota_enclave_diplomacy_engaged
		}
	}
}


#飞地通讯界面-介绍一下你们自己？

country_event = {
	id = ag_iota.51
	title = "ag_iota.51.name"
	desc = {
		trigger = {
			event_target:ag_ancient_iota_enclave = {
				trust = { who = root value < 50 }
			}
		}
		text = "ag_iota.51.a.desc"
	}
	desc = {
		trigger = {
			event_target:ag_ancient_iota_enclave = {
				trust = { who = root value >= 50 }
			}
		}
		text = "ag_iota.51.b.desc"
	}
	
	is_triggered_only = yes
	
	diplomatic = yes
	force_open = yes
	custom_gui = "ag_ancient_event_diplomacy_window"
	custom_gui_option = "ag_ancient_event_diplomacy_option"

	picture_event_data = {
		portrait = event_target:ag_ancient_iota_enclave
		room = ag_ancient_structure_room
	}

	trigger = {
		NOT = { is_hostile = event_target:ag_ancient_iota_enclave }
		ag_can_communicate_with_iota_enclave = yes
	}

	#你们是谁？
	option = {
		name = "ag_iota.51.a"
		response_text = "ag_iota.51.a.response"
		is_dialog_only = yes
		trigger = {
			event_target:ag_ancient_iota_enclave = {
				trust = {
					who = root
					value < 50
				}
			}
		}
	}
	option = {
		name = "ag_iota.51.b"
		response_text = "ag_iota.51.b.response"
		is_dialog_only = yes
		trigger = {
			event_target:ag_ancient_iota_enclave = {
				trust = {
					who = root
					value >= 50
				}
			}
		}
	}
	#你们的历史是怎样的？
	option = {
		name = "ag_iota.51.c"
		response_text = "ag_iota.51.c.response"
		is_dialog_only = yes
		trigger = {
			event_target:ag_ancient_iota_enclave = {
				trust = {
					who = root
					value < 50
				}
			}
		}
	}
	option = {
		name = "ag_iota.51.d"
		trigger = {
			event_target:ag_ancient_iota_enclave = {
				trust = {
					who = root
					value >= 50
				}
			}
		}
		hidden_effect = {
			country_event = { id = ag_iota.52 }
		}
	}
	option = {
		name = "ag_iota.51.return"
		hidden_effect = {
			country_event = { id = ag_iota.10 }
		}
	}
	option = {
		name = "ag_iota.51.exit"
		default_hide_option = yes
		hidden_effect = {
			remove_country_flag = ag_ancient_iota_enclave_diplomacy_engaged
		}
	}
}


#飞地通讯界面-介绍一下你们自己？-历史1

country_event = {
	id = ag_iota.52
	title = "ag_iota.52.name"
	desc = "ag_iota.52.desc"
	
	is_triggered_only = yes
	
	diplomatic = yes
	force_open = yes
	custom_gui = "ag_ancient_event_diplomacy_window"
	custom_gui_option = "ag_ancient_event_diplomacy_option"

	picture_event_data = {
		portrait = event_target:ag_ancient_iota_enclave
		room = ag_ancient_structure_room
	}

	trigger = {
		NOT = { is_hostile = event_target:ag_ancient_iota_enclave }
		ag_can_communicate_with_iota_enclave = yes
	}

	option = {
		name = "ag_iota.52.a"
		hidden_effect = {
			country_event = { id = ag_iota.53 }
		}
	}
	option = {
		name = "ag_iota.32.g"
		trigger = { always = no }
		default_hide_option = yes
		hidden_effect = {
			remove_country_flag = ag_ancient_iota_enclave_diplomacy_engaged
		}
	}
}


#飞地通讯界面-介绍一下你们自己？-历史2

country_event = {
	id = ag_iota.53
	title = "ag_iota.53.name"
	desc = "ag_iota.53.desc"
	
	is_triggered_only = yes
	
	diplomatic = yes
	force_open = yes
	custom_gui = "ag_ancient_event_diplomacy_window"
	custom_gui_option = "ag_ancient_event_diplomacy_option"

	picture_event_data = {
		portrait = event_target:ag_ancient_iota_enclave
		room = ag_ancient_structure_room
	}

	trigger = {
		NOT = { is_hostile = event_target:ag_ancient_iota_enclave }
		ag_can_communicate_with_iota_enclave = yes
	}

	option = {
		name = "ag_iota.53.a"
		hidden_effect = {
			country_event = { id = ag_iota.54 }
		}
	}
	option = {
		name = "ag_iota.32.g"
		trigger = { always = no }
		default_hide_option = yes
		hidden_effect = {
			remove_country_flag = ag_ancient_iota_enclave_diplomacy_engaged
		}
	}
}


#飞地通讯界面-介绍一下你们自己？-历史3

country_event = {
	id = ag_iota.54
	title = "ag_iota.54.name"
	desc = "ag_iota.54.desc"
	
	is_triggered_only = yes
	
	diplomatic = yes
	force_open = yes
	custom_gui = "ag_ancient_event_diplomacy_window"
	custom_gui_option = "ag_ancient_event_diplomacy_option"

	picture_event_data = {
		portrait = event_target:ag_ancient_iota_enclave
		room = ag_ancient_structure_room
	}

	trigger = {
		NOT = { is_hostile = event_target:ag_ancient_iota_enclave }
		ag_can_communicate_with_iota_enclave = yes
	}

	option = {
		name = "ag_iota.54.a"
		hidden_effect = {
			country_event = { id = ag_iota.10 }
		}
	}
	option = {
		name = "ag_iota.32.g"
		trigger = { always = no }
		default_hide_option = yes
		hidden_effect = {
			remove_country_flag = ag_ancient_iota_enclave_diplomacy_engaged
		}
	}
}


#每月检查好感度及交易是否需要因为缺少资源而取消

event = {
	id = ag_iota.61
	hide_window = yes

	is_triggered_only = yes

	trigger = {
		any_country = {
			OR = {
				has_modifier = ag_support_iota_enclave
				has_modifier = ag_iota_enclave_living_metal_trade_1
				has_modifier = ag_iota_enclave_living_metal_trade_2
				has_modifier = ag_iota_enclave_living_metal_trade_3
				has_modifier = ag_iota_enclave_living_metal_trade_4
				has_modifier = ag_iota_enclave_living_metal_trade_5
				has_modifier = ag_iota_enclave_nanites_trade_1
				has_modifier = ag_iota_enclave_nanites_trade_2
				has_modifier = ag_iota_enclave_nanites_trade_3
				has_modifier = ag_iota_enclave_nanites_trade_4
				has_modifier = ag_iota_enclave_nanites_trade_5
				has_modifier = ag_iota_enclave_dark_matter_trade_1
				has_modifier = ag_iota_enclave_dark_matter_trade_2
				has_modifier = ag_iota_enclave_dark_matter_trade_3
				has_modifier = ag_iota_enclave_dark_matter_trade_4
				has_modifier = ag_iota_enclave_dark_matter_trade_5
			}
		}
	}

	immediate = {
		every_country = {
			limit = {
				OR = {
					has_modifier = ag_support_iota_enclave
					has_modifier = ag_iota_enclave_living_metal_trade_1
					has_modifier = ag_iota_enclave_living_metal_trade_2
					has_modifier = ag_iota_enclave_living_metal_trade_3
					has_modifier = ag_iota_enclave_living_metal_trade_4
					has_modifier = ag_iota_enclave_living_metal_trade_5
					has_modifier = ag_iota_enclave_nanites_trade_1
					has_modifier = ag_iota_enclave_nanites_trade_2
					has_modifier = ag_iota_enclave_nanites_trade_3
					has_modifier = ag_iota_enclave_nanites_trade_4
					has_modifier = ag_iota_enclave_nanites_trade_5
					has_modifier = ag_iota_enclave_dark_matter_trade_1
					has_modifier = ag_iota_enclave_dark_matter_trade_2
					has_modifier = ag_iota_enclave_dark_matter_trade_3
					has_modifier = ag_iota_enclave_dark_matter_trade_4
					has_modifier = ag_iota_enclave_dark_matter_trade_5
				}
			}
			if = {
				limit = {
					OR = {
						has_deficit = energy
						has_deficit = alloys
						AND = {
							resource_stockpile_compare = {
								resource = energy
								value < 1000
							}
							has_monthly_income = {
								resource = energy
								value < 0
							}
						}
						AND = {
							resource_stockpile_compare = {
								resource = alloys
								value < 600
							}
							has_monthly_income = {
								resource = alloys
								value < 0
							}
						}
					}
					has_modifier = ag_support_iota_enclave
				}
				remove_modifier = ag_support_iota_enclave
				remove_country_flag = ag_support_iota_enclave_actived
				event_target:ag_ancient_iota_enclave = { add_trust = { who = prev amount = -5 } }
				set_country_flag = ag_iota_enclave_trade_cancel_lack_resource
			}
			if = {
				limit = {
					OR = {
						has_deficit = energy
						AND = {
							resource_stockpile_compare = {
								resource = energy
								value < 1000
							}
							has_monthly_income = {
								resource = energy
								value < 0
							}
						}
					}
					ag_has_valid_trade_with_iota_enclave = yes
				}
				remove_modifier = ag_iota_enclave_living_metal_trade_1
				remove_modifier = ag_iota_enclave_living_metal_trade_2
				remove_modifier = ag_iota_enclave_living_metal_trade_3
				remove_modifier = ag_iota_enclave_living_metal_trade_4
				remove_modifier = ag_iota_enclave_living_metal_trade_5
				remove_modifier = ag_iota_enclave_nanites_trade_1
				remove_modifier = ag_iota_enclave_nanites_trade_2
				remove_modifier = ag_iota_enclave_nanites_trade_3
				remove_modifier = ag_iota_enclave_nanites_trade_4
				remove_modifier = ag_iota_enclave_nanites_trade_5
				remove_modifier = ag_iota_enclave_dark_matter_trade_1
				remove_modifier = ag_iota_enclave_dark_matter_trade_2
				remove_modifier = ag_iota_enclave_dark_matter_trade_3
				remove_modifier = ag_iota_enclave_dark_matter_trade_4
				remove_modifier = ag_iota_enclave_dark_matter_trade_5
				if = {
					limit = { has_country_flag = ag_living_metal_trade_iota_enclave_actived }
					remove_country_flag = ag_living_metal_trade_iota_enclave_actived
					event_target:ag_ancient_iota_enclave = { add_trust = { who = prev amount = -5 } }
				}
				if = {
					limit = { has_country_flag = ag_nanites_trade_iota_enclave_actived }
					remove_country_flag = ag_nanites_trade_iota_enclave_actived
					event_target:ag_ancient_iota_enclave = { add_trust = { who = prev amount = -5 } }
				}
				if = {
					limit = { has_country_flag = ag_dark_matter_trade_iota_enclave_actived }
					remove_country_flag = ag_dark_matter_trade_iota_enclave_actived
					event_target:ag_ancient_iota_enclave = { add_trust = { who = prev amount = -5 } }
				}
				set_country_flag = ag_iota_enclave_trade_cancel_lack_resource
			}
			if = {
				limit = { has_country_flag = ag_support_iota_enclave_actived }
				event_target:ag_ancient_iota_enclave = { add_trust = { who = prev amount = 1 } }
			}
			if = {
				limit = { has_country_flag = ag_living_metal_trade_iota_enclave_actived }
				event_target:ag_ancient_iota_enclave = { add_trust = { who = prev amount = 1 } }
			}
			if = {
				limit = { has_country_flag = ag_nanites_trade_iota_enclave_actived }
				event_target:ag_ancient_iota_enclave = { add_trust = { who = prev amount = 1 } }
			}
			if = {
				limit = { has_country_flag = ag_dark_matter_trade_iota_enclave_actived }
				event_target:ag_ancient_iota_enclave = { add_trust = { who = prev amount = 1 } }
			}
			if = {
				limit = { has_country_flag = ag_iota_enclave_trade_cancel_lack_resource }
				remove_country_flag = ag_iota_enclave_trade_cancel_lack_resource
				country_event = { id = ag_iota.62 }
			}
		}
	}
}


#通知：协议由于缺少资源而取消

country_event = {
	id = ag_iota.62
	title = "ag_iota.62.name"
	desc = "ag_iota.62.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_s_window"
	custom_gui_option = "ag_ancient_event_s_option"
	picture_event_data = { room = ag_event_throne_room }
	show_sound = event_mystic_reveal
	location = root
	is_triggered_only = yes
	
	option = {
		name = "ag_iota.62.a"
	}
}


#中立飞地被攻击（隐藏事件）

country_event = {
	id = ag_iota.71
	hide_window = yes
	is_triggered_only = yes
	
	trigger = {
		NOR = {
			has_valid_civic = civic_fanatic_purifiers
			has_valid_civic = civic_hive_devouring_swarm
			has_valid_civic = civic_machine_terminator
		}
		from = {
			is_country_type = ag_ancient_iota_enclave
		}
	}

	immediate = {
		event_target:ag_ancient_iota_enclave = {
			add_trust = {
				who = root
				amount = -100
			}
		}
		if = {
			limit = {
				OR = {
					has_country_flag = ag_support_iota_enclave_actived
					has_country_flag = ag_ancient_iota_enclave_building_flag
					ag_has_valid_trade_with_iota_enclave = yes
				}
			}
			remove_country_flag = ag_support_iota_enclave_actived
			remove_country_flag = ag_living_metal_trade_iota_enclave_actived
			remove_country_flag = ag_nanites_trade_iota_enclave_actived
			remove_country_flag = ag_dark_matter_trade_iota_enclave_actived
			remove_country_flag = ag_ancient_iota_enclave_building_flag
			remove_modifier = ag_support_iota_enclave
			remove_modifier = ag_iota_enclave_living_metal_trade_1
			remove_modifier = ag_iota_enclave_living_metal_trade_2
			remove_modifier = ag_iota_enclave_living_metal_trade_3
			remove_modifier = ag_iota_enclave_living_metal_trade_4
			remove_modifier = ag_iota_enclave_living_metal_trade_5
			remove_modifier = ag_iota_enclave_nanites_trade_1
			remove_modifier = ag_iota_enclave_nanites_trade_2
			remove_modifier = ag_iota_enclave_nanites_trade_3
			remove_modifier = ag_iota_enclave_nanites_trade_4
			remove_modifier = ag_iota_enclave_nanites_trade_5
			remove_modifier = ag_iota_enclave_dark_matter_trade_1
			remove_modifier = ag_iota_enclave_dark_matter_trade_2
			remove_modifier = ag_iota_enclave_dark_matter_trade_3
			remove_modifier = ag_iota_enclave_dark_matter_trade_4
			remove_modifier = ag_iota_enclave_dark_matter_trade_5
			country_event = { id = ag_iota.72 }
		}
	}
}


#飞地通讯界面-中立飞地被攻击

country_event = {
	id = ag_iota.72
	title = "ag_iota.72.name"
	desc = "ag_iota.72.desc"
	
	is_triggered_only = yes
	
	diplomatic = yes
	force_open = yes
	custom_gui = "ag_ancient_event_diplomacy_window"
	custom_gui_option = "ag_ancient_event_diplomacy_option"

	picture_event_data = {
		portrait = event_target:ag_ancient_iota_enclave
		room = ag_ancient_structure_room
	}

	trigger = {
		exists = event_target:ag_ancient_iota_enclave
	}

	option = {
		name = "ag_iota.72.a"
	}
}


#飞地被摧毁（隐藏事件）

country_event = {
	id = ag_iota.73
	hide_window = yes
	
	is_triggered_only = yes
	
	trigger = {
		is_country_type = ag_ancient_iota_enclave
		fromfrom = { is_ship_size = ag_iota_station_1 }
	}
	
	immediate = {
		from = { 
			if = {
				limit = {
					has_communications = root
				}
				set_country_flag = ag_known_iota_enclave
			}
			country_event = { id = ag_iota.74 }
			save_event_target_as = ag_iota_enclave_killer
		}
		every_country = {
			limit = {
				NOR = {
					is_same_value = root
					is_same_value = from
				}
				has_communications = root
			}
			country_event = { id = ag_iota.75 }
		}
	}
}


#通知：飞地被我们摧毁

country_event = {
	id = ag_iota.74
	title = "ag_iota.74.name"
	desc = {
		trigger = {
			has_country_flag = ag_known_iota_enclave
		}
		text = "ag_iota.74.a.desc"
	}
	desc = {
		trigger = {
			NOT = {
				has_country_flag = ag_known_iota_enclave
			}
		}
		text = "ag_iota.74.b.desc"
	}
	diplomatic = yes
	custom_gui = "ag_ancient_event_s_window"
	custom_gui_option = "ag_ancient_event_s_option"
	picture_event_data = { room = ag_event_small_space_battle_room }
	location = event_target:ag_ancient_iota_star
	show_sound = event_space_battle
	
	is_triggered_only = yes
	
	immediate = { set_country_flag = ag_destroyed_iota_enclave }
	after = { clear_variable = ag_ancient_knowledge_common_var }
	
	option = {
		name = "ag_iota.74.a"
		add_resource = {
			physics_research = 5000
			society_research = 5000
			engineering_research = 5000
		}
		large_artifact_reward = yes
		hidden_effect = {
			random_list = {
				10 = { set_variable = { which = ag_ancient_knowledge_common_var value = 5 } }
				10 = { set_variable = { which = ag_ancient_knowledge_common_var value = 6 } }
				10 = { set_variable = { which = ag_ancient_knowledge_common_var value = 7 } }
				10 = { set_variable = { which = ag_ancient_knowledge_common_var value = 8 } }
				10 = { set_variable = { which = ag_ancient_knowledge_common_var value = 9 } }
				10 = { set_variable = { which = ag_ancient_knowledge_common_var value = 10 } }
			}
		}
		ag_add_ancient_knowledge = { ag_value = ag_ancient_knowledge_common_var ag_custom_tooltip = "ag_gain_ancient_knowledge_common.tooltip" ag_notification_desc = "" }
		hidden_effect = { remove_country_flag = ag_known_iota_enclave }
	}
}


#通知：飞地被摧毁

country_event = {
	id = ag_iota.75
	title = "ag_iota.75.name"
	desc = {
		trigger = {
			has_communications = event_target:ag_iota_enclave_killer
		}
		text = "ag_iota.75.a.desc"
	}
	desc = {
		trigger = {
			NOT = {
				has_communications = event_target:ag_iota_enclave_killer
			}
		}
		text = "ag_iota.75.b.desc"
	}
	diplomatic = yes
	custom_gui = "ag_ancient_event_s_window"
	custom_gui_option = "ag_ancient_event_s_option"
	picture_event_data = { room = ag_event_space_debris_room }
	location = event_target:ag_ancient_iota_star
	show_sound = event_ship_bridge
	
	is_triggered_only = yes
	
	immediate = {
		if = {
			limit = {
				OR = {
					has_country_flag = ag_support_iota_enclave_actived
					has_country_flag = ag_ancient_iota_enclave_building_flag
					ag_has_valid_trade_with_iota_enclave = yes
				}
			}
			remove_country_flag = ag_support_iota_enclave_actived
			remove_country_flag = ag_living_metal_trade_iota_enclave_actived
			remove_country_flag = ag_nanites_trade_iota_enclave_actived
			remove_country_flag = ag_dark_matter_trade_iota_enclave_actived
			remove_country_flag = ag_ancient_iota_enclave_building_flag
			remove_modifier = ag_support_iota_enclave
			remove_modifier = ag_iota_enclave_living_metal_trade_1
			remove_modifier = ag_iota_enclave_living_metal_trade_2
			remove_modifier = ag_iota_enclave_living_metal_trade_3
			remove_modifier = ag_iota_enclave_living_metal_trade_4
			remove_modifier = ag_iota_enclave_living_metal_trade_5
			remove_modifier = ag_iota_enclave_nanites_trade_1
			remove_modifier = ag_iota_enclave_nanites_trade_2
			remove_modifier = ag_iota_enclave_nanites_trade_3
			remove_modifier = ag_iota_enclave_nanites_trade_4
			remove_modifier = ag_iota_enclave_nanites_trade_5
			remove_modifier = ag_iota_enclave_dark_matter_trade_1
			remove_modifier = ag_iota_enclave_dark_matter_trade_2
			remove_modifier = ag_iota_enclave_dark_matter_trade_3
			remove_modifier = ag_iota_enclave_dark_matter_trade_4
			remove_modifier = ag_iota_enclave_dark_matter_trade_5
			set_country_flag = ag_has_trade_with_iota_enclave
		}
	}
	
	option = {
		name = "ag_iota.75.a"
		trigger = {
			NOR = {
				has_valid_civic = civic_fanatic_purifiers
				has_valid_civic = civic_hive_devouring_swarm
				has_valid_civic = civic_machine_terminator
			}
		}
	}
	option = {
		name = "ag_iota.75.b"
		trigger = {
			has_country_flag = ag_has_trade_with_iota_enclave
			NOR = {
				has_valid_civic = civic_fanatic_purifiers
				has_valid_civic = civic_hive_devouring_swarm
				has_valid_civic = civic_machine_terminator
			}
		}
		hidden_effect = {
			remove_country_flag = ag_has_trade_with_iota_enclave
		}
	}
	option = {
		name = "ag_iota.75.c"
		trigger = {
			OR = {
				has_valid_civic = civic_fanatic_purifiers
				has_valid_civic = civic_hive_devouring_swarm
				has_valid_civic = civic_machine_terminator
			}
		}
	}
}


#受到一定损失后有机会研究弱点（隐藏事件）

country_event = {
	id = ag_iota.81
	hide_window = yes
	
	is_triggered_only = yes
	
	trigger = {
		is_ai = no
		exists = event_target:ag_ancient_iota_enclave
		from = {
			is_country_type = ag_ancient_iota_enclave
			is_same_value = event_target:ag_ancient_iota_enclave
		}
		NOT = {
			has_country_flag = ag_has_ancient_iota_enclave_weakness
		}
	}
	
	immediate = {
		if = {
			limit = {
				check_variable = {
					which = ag_ancient_iota_enclave_killcount
					value < 1
				}
			}
			set_variable = {
				which = ag_ancient_iota_enclave_killcount
				value = 1
			}
		}
		fromfrom = {
			root = {
				ag_hostile_kill_counter = {
					ag_variable_name = ag_ancient_iota_enclave_killcount
				}
			}
		}
		if = {
			limit = {
				check_variable = {
					which = ag_ancient_iota_enclave_killcount
					value > 512
				}
				NOT = {
					has_country_flag = ag_has_ancient_iota_enclave_weakness
				}
			}
			set_variable = {
				which = ag_ancient_iota_enclave_killcount
				value = 512
			}
			random_list = {
				25 = {
					country_event = {
						id = ag_iota.82
						days = 30
						random = 30
					}
					set_country_flag = ag_has_ancient_iota_enclave_weakness
				}
				75 = {
				}
			}
		}
	}
}


#获得弱点研究项目

country_event = {
	id = ag_iota.82
	title = "ag_iota.82.name"
	desc = "ag_iota.82.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_s_window"
	custom_gui_option = "ag_ancient_event_s_option"
	picture_event_data = { room = ag_event_sabotaged_ship_room }
	show_sound = event_yellow_alert
	
	is_triggered_only = yes

	trigger = {
		exists = event_target:ag_ancient_iota_enclave
	}
	
	option = {
		name = "ag_iota.82.a"
		enable_special_project = {
			name = "ag_find_ancient_iota_enclave_weakness"
			location = capital_scope
			owner = root
		}
	}
	option = {
		name = "ag_iota.82.b"
		add_resource = { influence = 120 }
	}
}


#完成特殊计划：研究弱点

country_event = {
	id = ag_iota.83
	title = "ag_iota.83.name"
	desc = "ag_iota.83.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_s_window"
	custom_gui_option = "ag_ancient_event_s_option"
	picture_event_data = { room = ag_event_physics_research_room }
	show_sound = event_laboratory_sound
	
	is_triggered_only = yes

	option = {
		name = "ag_iota.83.a"
		if = {
			limit = {
				NOT = {
					has_modifier = ag_ancient_iota_enclave_weakness
				}
			}
			add_modifier = {
				modifier = ag_ancient_iota_enclave_weakness
				days = -1
			}
		}
	}
}


#研究事件：星环生产区段

country_event = {
	id = ag_iota.91
	title = "ag_iota.91.name"
	desc = "ag_iota.91.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_archaeological_dig_room }
	show_sound = event_finding_loot
	location = event_target:ag_ancient_iota_shielded_world
	
	mean_time_to_happen = {
		years = 6
	}
	
	trigger = {
		NOT = { has_global_flag = ag_iota_construction_section_unlocked }
		has_country_flag = ag_known_construction_section
		NOT = { has_country_flag = ag_iota_91_fired }
		any_system_within_border = {
			has_star_flag = ag_ancient_iota_system
		}
	}
	
	immediate = {
		set_country_flag = ag_iota_91_fired
		event_target:ag_ancient_iota_shielded_world = {
			solar_system = {
				random_system_planet = {
					limit = {
						has_planet_flag = ag_ancient_construction_section_0
					}
					save_event_target_as = ag_ancient_construction_section_loc
				}
			}
		}
	}
	
	option = {
		name = "ag_iota.91.a"
		enable_special_project = {
			name = "ag_iota_construction_section"
			location = event_target:ag_ancient_construction_section_loc
			owner = root
		}
		ai_chance = {
			factor = 1000
		}
	}
	option = {
		name = "ag_iota.91.b"
		add_resource = { influence = 100 }
		ai_chance = {
			factor = 0
		}
	}
}


#完成特殊计划：生产区段

country_event = {
	id = ag_iota.92
	title = "ag_iota.92.name"
	desc = "ag_iota.92.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_s_window"
	custom_gui_option = "ag_ancient_event_s_option"
	picture_event_data = { room = ag_event_ringworld_room }
	show_sound = event_think_tank_build_complete
	location = from
	is_triggered_only = yes
	
	immediate = {
		set_global_flag = ag_iota_construction_section_unlocked
		set_country_flag = ag_known_construction_section
		event_target:ag_ancient_iota_shielded_world = {
			solar_system = {
				ag_spawn_ancient_construction_section = yes
			}
		}
	}
	
	option = {
		name = "ag_iota.92.a"
	}
}
