namespace = systemcraft

country_event = {
	id = systemcraft.1
	title = systemcraft.1.name
	desc = systemcraft.1.desc

	picture = GFX_evt_binary_stars
	show_sound = event_dyson_sphere_build_complete
	
	is_triggered_only = yes

	option = {
		name = systemcraft.1.a
	}
}

country_event = {
	id = systemcraft.10
	title = systemcraft.10.name
	desc = systemcraft.10.desc

	picture = GFX_evt_binary_stars
	show_sound = event_dyson_sphere_build_start
	
	is_triggered_only = yes
	
	trigger = {
		FROM = { 
			is_megastructure_type = stellar_systemcraft_0
		}
	}

	option = {
		name = systemcraft.10.a
	}
}

country_event = {
	id = systemcraft.11
	title = systemcraft.11.name
	desc = systemcraft.11.desc

	picture = GFX_evt_binary_stars
	show_sound = event_dyson_sphere_build_upgrade_panel
	
	is_triggered_only = yes
	
	trigger = {
		FROM = { 
			is_megastructure_type = stellar_systemcraft_1
		}
	}

	option = {
		name = systemcraft.11.a
	}
}

country_event = {
	id = systemcraft.12
	title = systemcraft.12.name
	desc = systemcraft.12.desc

	picture = GFX_evt_binary_stars
	show_sound = event_dyson_sphere_build_upgrade_panel
	
	is_triggered_only = yes
	
	trigger = {
		FROM = { 
			is_megastructure_type = stellar_systemcraft_2
		}
	}

	option = {
		name = systemcraft.12.a
	}
}

country_event = {
	id = systemcraft.13
	title = systemcraft.13.name
	desc = systemcraft.13.desc

	picture = GFX_evt_binary_stars
	show_sound = event_dyson_sphere_build_upgrade_panel
	
	is_triggered_only = yes
	
	trigger = {
		FROM = { 
			is_megastructure_type = stellar_systemcraft_3
		}
	}

	option = {
		name = systemcraft.13.a
	}
}

country_event = {
	id = systemcraft.14
	title = systemcraft.14.name
	desc = systemcraft.14.desc

	picture = GFX_evt_binary_stars
	show_sound = event_dyson_sphere_build_upgrade_panel
	
	is_triggered_only = yes
	
	trigger = {
		FROM = { 
			is_megastructure_type = stellar_systemcraft_4
		}
	}

	option = {
		name = systemcraft.14.a
	}
}

#complete
country_event = {
	id = systemcraft.15
	title = systemcraft.15.name
	desc = systemcraft.15.desc

	picture = GFX_evt_binary_stars
	show_sound = event_dyson_sphere_build_complete
	
	is_triggered_only = yes
	
	trigger = {
		FROM = { 
			is_megastructure_type = stellar_systemcraft_5
		}
	}

	option = {
		name = systemcraft.15.a
		hidden_effect = {
			random_list = {
				70 = {
					if = {
						limit = {
							is_at_war = yes
							NOT = {
								has_global_flag = war_in_heaven_ongoing
							}
						}
						country_event = { id = systemcraft.100 days = 30 random = 10 } #an empire currently at war gets scared	
					}
				}
				30 = {}
			}
		}
	}
}

#crew acquired
country_event = {
	id = systemcraft.16
	title = systemcraft.16.name
	desc = systemcraft.16.desc

	picture = GFX_evt_binary_stars
	
	is_triggered_only = yes

	option = {
		name = systemcraft.16.a
	}
}

country_event = {
	id = systemcraft.1000
	location = FROMFROM
	hide_window = yes
	
	is_triggered_only = yes
	
	trigger = {
		FROM = { 
			is_megastructure_type = stellar_systemcraft_5
		}
	}
	
	immediate = {
		FROM.planet = {
			solar_system = {
				spawn_planet = {
					class = "pc_barycenter"
					orbit_distance_offset = 1
					orbit_angle_offset = 1
					size = 1
				}
				random_system_planet = {
					limit = {
						is_planet_class = pc_barycenter
					}
					save_event_target_as = systemcraft_planet
				}
			}
		}
		if = {
			limit = {
				FROM.planet = {
					is_star = yes
				}
			}
			every_country = {
				limit = {
					is_country = ROOT
				}
				create_fleet = {
					name = "The Stellar Systemcraft"
					settings = { 
						spawn_debris = no  
						can_change_composition = no 
						is_boss = yes
					}
					effect = {
						set_owner = PREV
						create_ship = {
							name = "The Stellar Systemcraft"
							random_existing_design = giga_systemcraft 
						}
						set_location = event_target:systemcraft_planet
					}
				}
				event_target:systemcraft_planet = {
					remove_planet = yes
				}
			}
			FROM.planet = {
				clear_deposits = yes
				change_pc = pc_giga_empty_space
				set_name = "Empty Space"			
			}
		}
	}
}

###A random enemy country surrenders if player isn't genocidal###
country_event = {
	id = systemcraft.100
	
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		random_country = {
			limit = {
				exists = THIS
				NOR = {
					has_civic = civic_machine_terminator
					has_civic = civic_hive_devouring_swarm
					has_civic = civic_fanatic_purifiers
				}
				is_at_war_with = root
				is_ai = yes
				OR = {
					is_country_type = fallen_empire
					is_country_type = awakened_fallen_empire
					is_country_type = default
				}
				OR = {
					relative_power = {
						who = root
						category = fleet
						value = equivalent
					}
					relative_power = {
						who = root
						category = fleet
						value = inferior
					}
					relative_power = {
						who = root
						category = fleet
						value = pathetic
					}
				}
			}
			save_event_target_as = systemcraft_surrender_empire
		}
		country_event = { id = systemcraft.101 days = 1 }
	}
}

country_event = {
	id = systemcraft.101
	title = TRANSMISSION
	desc = systemcraft.101.desc
	
	diplomatic = yes
	
	is_triggered_only = yes
	
	picture_event_data = {
		portrait = event_target:systemcraft_surrender_empire
		room = event_target:systemcraft_surrender_empire.ruler
	}
	
	option = {
		name = systemcraft.101.a #sure
		event_target:systemcraft_surrender_empire = {
			set_subject_of = {
				who = root
				subject_type = vassal
			}
		}
	}

	option = {
		name = systemcraft.101.b #nah
	}
}