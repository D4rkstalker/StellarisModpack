
###############################
### Civil Wars by MrFunEGUY ###
###############################

namespace = civplan

country_event = { # - Remove instability counter on stability increase
	id = civplan.1000
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		NOR = {
			years_passed < 10
			is_subject = yes
			has_ethic = ethic_gestalt_consciousness
		}
	}

	immediate = {
		if = {
			limit = {
				any_owned_planet = {
					num_pops >= 5
					is_capital = no
					is_colony = yes
					planet_stability <= 25
					solar_system = {
						NOT = { has_star_flag = capital_system_no_revolt }
					}
					NOR = {
						has_planet_flag = revolt_tick_1
						has_planet_flag = revolt_tick_2
						has_planet_flag = revolt_tick_3
						has_planet_flag = revolt_tick_4
						has_planet_flag = revolt_tick_5
					}
				}
			}
			random_owned_planet = {
				limit = {
					num_pops >= 5
					is_capital = no
					is_colony = yes
					planet_stability <= 25
					solar_system = {
						NOT = { has_star_flag = capital_system_no_revolt }
					}
					NOR = {
						has_planet_flag = revolt_tick_1
						has_planet_flag = revolt_tick_2
						has_planet_flag = revolt_tick_3
						has_planet_flag = revolt_tick_4
						has_planet_flag = revolt_tick_5
					}
				}
				set_planet_flag = revolt_tick_1
			}
		}
		else_if = {
			limit = {
				any_owned_planet = {
					num_pops >= 5
					is_capital = no
					is_colony = yes
					planet_stability <= 25
					solar_system = {
						NOT = { has_star_flag = capital_system_no_revolt }
					}
					has_planet_flag = revolt_tick_1
				}
			}
			random_owned_planet = {
				limit = {
					num_pops >= 5
					is_capital = no
					is_colony = yes
					planet_stability <= 25
					solar_system = {
						NOT = { has_star_flag = capital_system_no_revolt }
					}
					has_planet_flag = revolt_tick_1
				}
				remove_planet_flag = revolt_tick_1
				set_planet_flag = revolt_tick_2
			}
		}
		else_if = {
			limit = {
				any_owned_planet = {
					num_pops >= 5
					is_capital = no
					is_colony = yes
					planet_stability <= 25
					solar_system = {
						NOT = { has_star_flag = capital_system_no_revolt }
					}
					has_planet_flag = revolt_tick_2
				}
			}
			random_owned_planet = {
				limit = {
					num_pops >= 5
					is_capital = no
					is_colony = yes
					planet_stability <= 25
					solar_system = {
						NOT = { has_star_flag = capital_system_no_revolt }
					}
					has_planet_flag = revolt_tick_2
				}
				remove_planet_flag = revolt_tick_2
				set_planet_flag = revolt_tick_3
			}
		}
		else_if = {
			limit = {
				any_owned_planet = {
					num_pops >= 5
					is_capital = no
					is_colony = yes
					planet_stability <= 25
					solar_system = {
						NOT = { has_star_flag = capital_system_no_revolt }
					}
					has_planet_flag = revolt_tick_3
				}
			}
			random_owned_planet = {
				limit = {
					num_pops >= 5
					is_capital = no
					is_colony = yes
					planet_stability <= 25
					solar_system = {
						NOT = { has_star_flag = capital_system_no_revolt }
					}
					has_planet_flag = revolt_tick_3
				}
				remove_planet_flag = revolt_tick_3
				set_planet_flag = revolt_tick_4
			}
		}
		else_if = {
			limit = {
				any_owned_planet = {
					num_pops >= 5
					is_capital = no
					is_colony = yes
					planet_stability <= 25
					solar_system = {
						NOT = { has_star_flag = capital_system_no_revolt }
					}
					has_planet_flag = revolt_tick_4
				}
			}
			random_owned_planet = {
				limit = {
					num_pops >= 5
					is_capital = no
					is_colony = yes
					planet_stability <= 25
					solar_system = {
						NOT = { has_star_flag = capital_system_no_revolt }
					}
					has_planet_flag = revolt_tick_4
				}
				remove_planet_flag = revolt_tick_4
				set_planet_flag = revolt_tick_5
				add_modifier = { modifier = planetary_rebels days = -1 }
				save_event_target_as = separatist_planet
				planet_event = { id = civplan.9000 }
			}
		}
	}
}

planet_event = {
	id = civplan.9000
	picture = GFX_evt_spy_network
	title = civplan.9000.name
	desc = civplan.9000.desc
	hide_window = no
	is_triggered_only = yes

	option = {
		name = civplan.9000.a
		ai_chance = { factor = 1 }
	}
}

country_event = { # - Remove instability counter on stability increase
	id = civplan.1001
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		NOR = {
			years_passed < 10
			is_subject = yes
			has_ethic = ethic_gestalt_consciousness
		}
	}

	immediate = {
		if = {
			limit = {
				any_owned_planet = {
					AND = {
						planet_stability > 25
						OR = {
							has_planet_flag = revolt_tick_1
							has_planet_flag = revolt_tick_2
							has_planet_flag = revolt_tick_3
							has_planet_flag = revolt_tick_4
							has_planet_flag = revolt_tick_5
						}
					}
				}
			}
			random_owned_planet = {
				limit = {
					AND = {
						planet_stability > 25
						OR = {
							has_planet_flag = revolt_tick_1
							has_planet_flag = revolt_tick_2
							has_planet_flag = revolt_tick_3
							has_planet_flag = revolt_tick_4
							has_planet_flag = revolt_tick_5
						}
					}
				}
				remove_planet_flag = revolt_tick_1
				remove_planet_flag = revolt_tick_2
				remove_planet_flag = revolt_tick_3
				remove_planet_flag = revolt_tick_4
				if = {
					limit = {
						has_planet_flag = revolt_tick_5
					}
				}
				remove_planet_flag = revolt_tick_5
				planet_event = { id = civplan.9001 }
			}
		}
	}
}

planet_event = {
	id = civplan.9001
	picture = GFX_evt_colony_settlement
	title = civplan.9001.name
	desc = civplan.9001.desc
	hide_window = no
	is_triggered_only = yes

	option = {
		name = civplan.9001.a
		ai_chance = { factor = 1 }
	}
}

country_event = { # - Authoritarian
	id = civplan.1002
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		if = {
			limit = {
				any_owned_planet = {
					num_pops >= 1
					is_capital = no
					is_colony = yes
					solar_system = {
						NOT = { has_star_flag = capital_system_no_revolt }
					}
					pop_percentage = {
						percentage >= 0.15
						limit = { pop_has_ethic = ethic_authoritarian }
					}
				}
			}
			random_owned_planet = {
				limit = {
					num_pops >= 1
					is_capital = no
					is_colony = yes
					solar_system = {
						NOT = { has_star_flag = capital_system_no_revolt }
					}
					pop_percentage = {
						percentage >= 0.15
						limit = { pop_has_ethic = ethic_authoritarian }
					}
				}
				set_planet_flag = authoritarian_faction_revolt_planet
				save_event_target_as = civil_war_planet
				solar_system = {
					set_star_flag = civil_war_flip
					set_star_flag = civwar_planet
				}
			}
			while = {
				count = 10
				if = {
					limit = {
						any_system_within_border = {
							has_star_flag = civwar_planet
						}
					}
					random_system_within_border = {
						limit = {
							NOT = { has_star_flag = capital_system_no_revolt }
							any_neighbor_system = {
								has_star_flag = civwar_planet
							}
						}
						set_star_flag = civil_war_flip
					}
				}
			}
			country_event = { id = civwarcountry.1004 }
		}
		else = {
			# No War if no planet meets critera
		}
	}
}

country_event = { # - egalitarian
	id = civplan.1003
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		if = {
			limit = {
				any_owned_planet = {
					num_pops >= 1
					is_capital = no
					is_colony = yes
					solar_system = {
						NOT = { has_star_flag = capital_system_no_revolt }
					}
					pop_percentage = {
						percentage >= 0.15
						limit = { pop_has_ethic = ethic_egalitarian }
					}
				}
			}
			random_owned_planet = {
				limit = {
					num_pops >= 1
					is_capital = no
					is_colony = yes
					solar_system = {
						NOT = { has_star_flag = capital_system_no_revolt }
					}
					pop_percentage = {
						percentage >= 0.15
						limit = { pop_has_ethic = ethic_egalitarian }
					}
				}
				set_planet_flag = egalitarian_faction_revolt_planet
				save_event_target_as = civil_war_planet
				solar_system = {
					set_star_flag = civil_war_flip
					set_star_flag = civwar_planet
				}
			}
			while = {
				count = 10
				if = {
					limit = {
						any_system_within_border = {
							has_star_flag = civwar_planet
						}
					}
					random_system_within_border = {
						limit = {
							NOT = { has_star_flag = capital_system_no_revolt }
							any_neighbor_system = {
								has_star_flag = civwar_planet
							}
						}
						set_star_flag = civil_war_flip
					}
				}
			}
			country_event = { id = civwarcountry.1005 }
		}
		else = {
			# No War if no planet meets critera
		}
	}
}

country_event = { # - militarist
	id = civplan.1004
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		if = {
			limit = {
				any_owned_planet = {
					num_pops >= 1
					is_capital = no
					is_colony = yes
					solar_system = {
						NOT = { has_star_flag = capital_system_no_revolt }
					}
					pop_percentage = {
						percentage >= 0.15
						limit = { pop_has_ethic = ethic_militarist }
					}
				}
			}
			random_owned_planet = {
				limit = {
					num_pops >= 1
					is_capital = no
					is_colony = yes
					solar_system = {
						NOT = { has_star_flag = capital_system_no_revolt }
					}
					pop_percentage = {
						percentage >= 0.15
						limit = { pop_has_ethic = ethic_militarist }
					}
				}
				set_planet_flag = militarist_faction_revolt_planet
				save_event_target_as = civil_war_planet
				solar_system = {
					set_star_flag = civil_war_flip
					set_star_flag = civwar_planet
				}
			}
			while = {
				count = 10
				if = {
					limit = {
						any_system_within_border = {
							has_star_flag = civwar_planet
						}
					}
					random_system_within_border = {
						limit = {
							NOT = { has_star_flag = capital_system_no_revolt }
							any_neighbor_system = {
								has_star_flag = civwar_planet
							}
						}
						set_star_flag = civil_war_flip
					}
				}
			}
			country_event = { id = civwarcountry.1006 }
		}
		else = {
			# No War if no planet meets critera
		}
	}
}

country_event = { # - pacifist
	id = civplan.1005
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		if = {
			limit = {
				any_owned_planet = {
					num_pops >= 1
					is_capital = no
					is_colony = yes
					solar_system = {
						NOT = { has_star_flag = capital_system_no_revolt }
					}
					pop_percentage = {
						percentage >= 0.15
						limit = { pop_has_ethic = ethic_pacifist }
					}
				}
			}
			random_owned_planet = {
				limit = {
					num_pops >= 1
					is_capital = no
					is_colony = yes
					solar_system = {
						NOT = { has_star_flag = capital_system_no_revolt }
					}
					pop_percentage = {
						percentage >= 0.15
						limit = { pop_has_ethic = ethic_pacifist }
					}
				}
				set_planet_flag = pacifist_faction_revolt_planet
				save_event_target_as = civil_war_planet
				solar_system = {
					set_star_flag = civil_war_flip
					set_star_flag = civwar_planet
				}
			}
			while = {
				count = 10
				if = {
					limit = {
						any_system_within_border = {
							has_star_flag = civwar_planet
						}
					}
					random_system_within_border = {
						limit = {
							NOT = { has_star_flag = capital_system_no_revolt }
							any_neighbor_system = {
								has_star_flag = civwar_planet
							}
						}
						set_star_flag = civil_war_flip
					}
				}
			}
			country_event = { id = civwarcountry.1007 }
		}
		else = {
			# No War if no planet meets critera
		}
	}
}

country_event = { # - materialist
	id = civplan.1006
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		if = {
			limit = {
				any_owned_planet = {
					num_pops >= 1
					is_capital = no
					is_colony = yes
					solar_system = {
						NOT = { has_star_flag = capital_system_no_revolt }
					}
					pop_percentage = {
						percentage >= 0.15
						limit = { pop_has_ethic = ethic_materialist }
					}
				}
			}
			random_owned_planet = {
				limit = {
					num_pops >= 1
					is_capital = no
					is_colony = yes
					solar_system = {
						NOT = { has_star_flag = capital_system_no_revolt }
					}
					pop_percentage = {
						percentage >= 0.15
						limit = { pop_has_ethic = ethic_materialist }
					}
				}
				set_planet_flag = materialist_faction_revolt_planet
				save_event_target_as = civil_war_planet
				solar_system = {
					set_star_flag = civil_war_flip
					set_star_flag = civwar_planet
				}
			}
			while = {
				count = 10
				if = {
					limit = {
						any_system_within_border = {
							has_star_flag = civwar_planet
						}
					}
					random_system_within_border = {
						limit = {
							NOT = { has_star_flag = capital_system_no_revolt }
							any_neighbor_system = {
								has_star_flag = civwar_planet
							}
						}
						set_star_flag = civil_war_flip
					}
				}
			}
			country_event = { id = civwarcountry.1008 }
		}
		else = {
			# No War if no planet meets critera
		}
	}
}

country_event = { # - spiritualist
	id = civplan.1007
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		if = {
			limit = {
				any_owned_planet = {
					num_pops >= 1
					is_capital = no
					is_colony = yes
					solar_system = {
						NOT = { has_star_flag = capital_system_no_revolt }
					}
					pop_percentage = {
						percentage >= 0.15
						limit = { pop_has_ethic = ethic_spiritualist }
					}
				}
			}
			random_owned_planet = {
				limit = {
					num_pops >= 1
					is_capital = no
					is_colony = yes
					solar_system = {
						NOT = { has_star_flag = capital_system_no_revolt }
					}
					pop_percentage = {
						percentage >= 0.15
						limit = { pop_has_ethic = ethic_spiritualist }
					}
				}
				set_planet_flag = spiritualist_faction_revolt_planet
				save_event_target_as = civil_war_planet
				solar_system = {
					set_star_flag = civil_war_flip
					set_star_flag = civwar_planet
				}
			}
			while = {
				count = 10
				if = {
					limit = {
						any_system_within_border = {
							has_star_flag = civwar_planet
						}
					}
					random_system_within_border = {
						limit = {
							NOT = { has_star_flag = capital_system_no_revolt }
							any_neighbor_system = {
								has_star_flag = civwar_planet
							}
						}
						set_star_flag = civil_war_flip
					}
				}
			}
			country_event = { id = civwarcountry.1009 }
		}
		else = {
			# No War if no planet meets critera
		}
	}
}

country_event = { # - xenophile
	id = civplan.1008
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		if = {
			limit = {
				any_owned_planet = {
					num_pops >= 1
					is_capital = no
					is_colony = yes
					solar_system = {
						NOT = { has_star_flag = capital_system_no_revolt }
					}
					pop_percentage = {
						percentage >= 0.15
						limit = { pop_has_ethic = ethic_xenophile }
					}
				}
			}
			random_owned_planet = {
				limit = {
					num_pops >= 1
					is_capital = no
					is_colony = yes
					solar_system = {
						NOT = { has_star_flag = capital_system_no_revolt }
					}
					pop_percentage = {
						percentage >= 0.15
						limit = { pop_has_ethic = ethic_xenophile }
					}
				}
				set_planet_flag = xenophile_faction_revolt_planet
				save_event_target_as = civil_war_planet
				solar_system = {
					set_star_flag = civil_war_flip
					set_star_flag = civwar_planet
				}
			}
			while = {
				count = 10
				if = {
					limit = {
						any_system_within_border = {
							has_star_flag = civwar_planet
						}
					}
					random_system_within_border = {
						limit = {
							NOT = { has_star_flag = capital_system_no_revolt }
							any_neighbor_system = {
								has_star_flag = civwar_planet
							}
						}
						set_star_flag = civil_war_flip
					}
				}
			}
			country_event = { id = civwarcountry.1010 }
		}
		else = {
			# No War if no planet meets critera
		}
	}
}

country_event = { # - xenophobe
	id = civplan.1009
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		if = {
			limit = {
				any_owned_planet = {
					num_pops >= 1
					is_capital = no
					is_colony = yes
					solar_system = {
						NOT = { has_star_flag = capital_system_no_revolt }
					}
					pop_percentage = {
						percentage >= 0.15
						limit = { pop_has_ethic = ethic_xenophobe }
					}
				}
			}
			random_owned_planet = {
				limit = {
					num_pops >= 1
					is_capital = no
					is_colony = yes
					solar_system = {
						NOT = { has_star_flag = capital_system_no_revolt }
					}
					pop_percentage = {
						percentage >= 0.15
						limit = { pop_has_ethic = ethic_xenophobe }
					}
				}
				set_planet_flag = xenophobe_faction_revolt_planet
				save_event_target_as = civil_war_planet
				solar_system = {
					set_star_flag = civil_war_flip
					set_star_flag = civwar_planet
				}
			}
			while = {
				count = 10
				if = {
					limit = {
						any_system_within_border = {
							has_star_flag = civwar_planet
						}
					}
					random_system_within_border = {
						limit = {
							NOT = { has_star_flag = capital_system_no_revolt }
							any_neighbor_system = {
								has_star_flag = civwar_planet
							}
						}
						set_star_flag = civil_war_flip
					}
				}
			}
			country_event = { id = civwarcountry.1011 }
		}
		else = {
			# No War if no planet meets critera
		}
	}
}

country_event = { # - Socialism
	id = civplan.1010
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		if = {
			limit = {
				any_owned_planet = {
					num_pops >= 1
					is_capital = no
					is_colony = yes
					solar_system = {
						NOT = { has_star_flag = capital_system_no_revolt }
					}
					pop_percentage = {
						percentage >= 0.15
						limit = { pop_has_ethic = ethic_socialism }
					}
				}
			}
			random_owned_planet = {
				limit = {
					num_pops >= 1
					is_capital = no
					is_colony = yes
					solar_system = {
						NOT = { has_star_flag = capital_system_no_revolt }
					}
					pop_percentage = {
						percentage >= 0.15
						limit = { pop_has_ethic = ethic_socialism }
					}
				}
				set_planet_flag = socialism_faction_revolt_planet
				save_event_target_as = civil_war_planet
				solar_system = {
					set_star_flag = civil_war_flip
					set_star_flag = civwar_planet
				}
			}
			while = {
				count = 10
				if = {
					limit = {
						any_system_within_border = {
							has_star_flag = civwar_planet
						}
					}
					random_system_within_border = {
						limit = {
							NOT = { has_star_flag = capital_system_no_revolt }
							any_neighbor_system = {
								has_star_flag = civwar_planet
							}
						}
						set_star_flag = civil_war_flip
					}
				}
			}
			country_event = { id = civwarcountry.1012 }
		}
		else = {
			# No War if no planet meets critera
		}
	}
}

country_event = { # - Capitalism
	id = civplan.1011
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		if = {
			limit = {
				any_owned_planet = {
					num_pops >= 1
					is_capital = no
					is_colony = yes
					solar_system = {
						NOT = { has_star_flag = capital_system_no_revolt }
					}
					pop_percentage = {
						percentage >= 0.15
						limit = { pop_has_ethic = ethic_capitalism }
					}
				}
			}
			random_owned_planet = {
				limit = {
					num_pops >= 1
					is_capital = no
					is_colony = yes
					solar_system = {
						NOT = { has_star_flag = capital_system_no_revolt }
					}
					pop_percentage = {
						percentage >= 0.15
						limit = { pop_has_ethic = ethic_capitalism }
					}
				}
				set_planet_flag = capitalism_faction_revolt_planet
				save_event_target_as = civil_war_planet
				solar_system = {
					set_star_flag = civil_war_flip
					set_star_flag = civwar_planet
				}
			}
			while = {
				count = 10
				if = {
					limit = {
						any_system_within_border = {
							has_star_flag = civwar_planet
						}
					}
					random_system_within_border = {
						limit = {
							NOT = { has_star_flag = capital_system_no_revolt }
							any_neighbor_system = {
								has_star_flag = civwar_planet
							}
						}
						set_star_flag = civil_war_flip
					}
				}
			}
			country_event = { id = civwarcountry.1013 }
		}
		else = {
			# No War if no planet meets critera
		}
	}
}

#######################
# Planetary Rebellion #
#######################

# Vanilla
planet_event = {
	id = civplan.2000
	picture = GFX_evt_open_revolt
	title = civplan.2000.name
	desc = civplan.2000.desc
	hide_window = no
	is_triggered_only = yes

	immediate = {
		save_event_target_as = rebellion_planet
		set_planet_flag = planetary_rebellion
		random_list = {
			40 = {
				create_rebels = {
					name = random
					type = default
					species = event_target:civwar_species
					ignore_initial_colony_error = yes
					day_zero_contact = no
					authority = auth_democratic
					ethos = { 
						ethic = ethic_fanatic_egalitarian
						ethic = random
						ethic = random
					}
					origin = origin_civ_rebellion
					civics = {
						civic = random
						civic = random
					}
					flag = random

					effect = {
						save_event_target_as = current_civwar_rebels
						root = {
							if = {
								limit = {
									num_pops >= 1
									num_pops < 5
								}
								while = {
									count = 3
									create_army = {
										name = random
										owner = event_target:current_civwar_rebels
										species = event_target:civwar_species
										type = "planetary_rebel_army"
									}
								}
							}
							else_if = {
								limit = {
									num_pops >= 5
									num_pops < 10
								}
								while = {
									count = 5
									create_army = {
										name = random
										owner = event_target:current_civwar_rebels
										species = event_target:civwar_species
										type = "planetary_rebel_army"
									}
								}
							}
							else_if = {
								limit = {
									num_pops >= 10
									num_pops < 20
								}
								while = {
									count = 10
									create_army = {
										name = random
										owner = event_target:current_civwar_rebels
										species = event_target:civwar_species
										type = "planetary_rebel_army"
									}
								}
							}
							else_if = {
								limit = {
									num_pops >= 20
									num_pops < 30
								}
								while = {
									count = 15
									create_army = {
										name = random
										owner = event_target:current_civwar_rebels
										species = event_target:civwar_species
										type = "planetary_rebel_army"
									}
								}
							}
							else_if = {
								limit = {
									num_pops >= 30
									num_pops < 40
								}
								while = {
									count = 20
									create_army = {
										name = random
										owner = event_target:current_civwar_rebels
										species = event_target:civwar_species
										type = "planetary_rebel_army"
									}
								}
							}
							else_if = {
								limit = {
									num_pops >= 40
								}
								while = {
									count = 25
									create_army = {
										name = random
										owner = event_target:current_civwar_rebels
										species = event_target:civwar_species
										type = "planetary_rebel_army"
									}
								}
							}
						}
						#country_event = { id = civwar.1023 } # setup happens here now
					}
				}
			}
			20 = {
				create_rebels = {
					name = random
					type = default
					species = event_target:civwar_species
					ignore_initial_colony_error = yes
					day_zero_contact = no
					authority = auth_oligarchic
					ethos = { 
						ethic = random
						ethic = random
						ethic = random
					}
					origin = origin_civ_rebellion
					civics = {
						civic = random
						civic = random
					}
					flag = random
					effect = {
						save_event_target_as = current_civwar_rebels
						root = {
							if = {
								limit = {
									num_pops >= 1
									num_pops < 5
								}
								while = {
									count = 3
									create_army = {
										name = random
										owner = event_target:current_civwar_rebels
										species = event_target:civwar_species
										type = "planetary_rebel_army"
									}
								}
							}
							else_if = {
								limit = {
									num_pops >= 5
									num_pops < 10
								}
								while = {
									count = 5
									create_army = {
										name = random
										owner = event_target:current_civwar_rebels
										species = event_target:civwar_species
										type = "planetary_rebel_army"
									}
								}
							}
							else_if = {
								limit = {
									num_pops >= 10
									num_pops < 20
								}
								while = {
									count = 10
									create_army = {
										name = random
										owner = event_target:current_civwar_rebels
										species = event_target:civwar_species
										type = "planetary_rebel_army"
									}
								}
							}
							else_if = {
								limit = {
									num_pops >= 20
									num_pops < 30
								}
								while = {
									count = 15
									create_army = {
										name = random
										owner = event_target:current_civwar_rebels
										species = event_target:civwar_species
										type = "planetary_rebel_army"
									}
								}
							}
							else_if = {
								limit = {
									num_pops >= 30
									num_pops < 40
								}
								while = {
									count = 20
									create_army = {
										name = random
										owner = event_target:current_civwar_rebels
										species = event_target:civwar_species
										type = "planetary_rebel_army"
									}
								}
							}
							else_if = {
								limit = {
									num_pops >= 40
								}
								while = {
									count = 25
									create_army = {
										name = random
										owner = event_target:current_civwar_rebels
										species = event_target:civwar_species
										type = "planetary_rebel_army"
									}
								}
							}
						}
						#country_event = { id = civwar.1023 } # setup happens here now
					}
				}
			}
			15 = {
				create_rebels = {
					name = random
					type = default
					species = event_target:civwar_species
					ignore_initial_colony_error = yes
					day_zero_contact = no
					authority = auth_dictatorial
					ethos = { 
						ethic = ethic_fanatic_authoritarian
						ethic = random
						ethic = random
					}
					origin = origin_civ_rebellion
					civics = {
						civic = random
						civic = random
					}
					flag = random
					effect = {
						save_event_target_as = current_civwar_rebels
						root = {
							if = {
								limit = {
									num_pops >= 1
									num_pops < 5
								}
								while = {
									count = 3
									create_army = {
										name = random
										owner = event_target:current_civwar_rebels
										species = event_target:civwar_species
										type = "planetary_rebel_army"
									}
								}
							}
							else_if = {
								limit = {
									num_pops >= 5
									num_pops < 10
								}
								while = {
									count = 5
									create_army = {
										name = random
										owner = event_target:current_civwar_rebels
										species = event_target:civwar_species
										type = "planetary_rebel_army"
									}
								}
							}
							else_if = {
								limit = {
									num_pops >= 10
									num_pops < 20
								}
								while = {
									count = 10
									create_army = {
										name = random
										owner = event_target:current_civwar_rebels
										species = event_target:civwar_species
										type = "planetary_rebel_army"
									}
								}
							}
							else_if = {
								limit = {
									num_pops >= 20
									num_pops < 30
								}
								while = {
									count = 15
									create_army = {
										name = random
										owner = event_target:current_civwar_rebels
										species = event_target:civwar_species
										type = "planetary_rebel_army"
									}
								}
							}
							else_if = {
								limit = {
									num_pops >= 30
									num_pops < 40
								}
								while = {
									count = 20
									create_army = {
										name = random
										owner = event_target:current_civwar_rebels
										species = event_target:civwar_species
										type = "planetary_rebel_army"
									}
								}
							}
							else_if = {
								limit = {
									num_pops >= 40
								}
								while = {
									count = 25
									create_army = {
										name = random
										owner = event_target:current_civwar_rebels
										species = event_target:civwar_species
										type = "planetary_rebel_army"
									}
								}
							}
						}
						#country_event = { id = civwar.1023 } # setup happens here now
					}
				}
			}
			15 = {
				create_rebels = {
					name = random
					type = default
					species = event_target:civwar_species
					ignore_initial_colony_error = yes
					day_zero_contact = no
					authority = auth_imperial
					ethos = { 
						ethic = ethic_fanatic_authoritarian
						ethic = random
						ethic = random
					}
					origin = origin_civ_rebellion
					civics = {
						civic = random
						civic = random
					}
					flag = random
					effect = {
						save_event_target_as = current_civwar_rebels
						root = {
							if = {
								limit = {
									num_pops >= 1
									num_pops < 5
								}
								while = {
									count = 3
									create_army = {
										name = random
										owner = event_target:current_civwar_rebels
										species = event_target:civwar_species
										type = "planetary_rebel_army"
									}
								}
							}
							else_if = {
								limit = {
									num_pops >= 5
									num_pops < 10
								}
								while = {
									count = 5
									create_army = {
										name = random
										owner = event_target:current_civwar_rebels
										species = event_target:civwar_species
										type = "planetary_rebel_army"
									}
								}
							}
							else_if = {
								limit = {
									num_pops >= 10
									num_pops < 20
								}
								while = {
									count = 10
									create_army = {
										name = random
										owner = event_target:current_civwar_rebels
										species = event_target:civwar_species
										type = "planetary_rebel_army"
									}
								}
							}
							else_if = {
								limit = {
									num_pops >= 20
									num_pops < 30
								}
								while = {
									count = 15
									create_army = {
										name = random
										owner = event_target:current_civwar_rebels
										species = event_target:civwar_species
										type = "planetary_rebel_army"
									}
								}
							}
							else_if = {
								limit = {
									num_pops >= 30
									num_pops < 40
								}
								while = {
									count = 20
									create_army = {
										name = random
										owner = event_target:current_civwar_rebels
										species = event_target:civwar_species
										type = "planetary_rebel_army"
									}
								}
							}
							else_if = {
								limit = {
									num_pops >= 40
								}
								while = {
									count = 25
									create_army = {
										name = random
										owner = event_target:current_civwar_rebels
										species = event_target:civwar_species
										type = "planetary_rebel_army"
									}
								}
							}
						}
						#country_event = { id = civwar.1023 } # setup happens here now
					}
				}
			}
		}
	}

	option = {
		name = civplan.2000.a
		ai_chance = { factor = 1 }
	}
}

# More Authorities / ECA
planet_event = {
	id = civplan.2100
	picture = GFX_evt_open_revolt
	title = civplan.2000.name
	desc = civplan.2000.desc
	hide_window = no
	is_triggered_only = yes

	immediate = {
		save_event_target_as = rebellion_planet
		set_planet_flag = planetary_rebellion
		random_list = {
			20 = {
				create_rebels = {
					name = random
					type = default
					species = event_target:civwar_species
					ignore_initial_colony_error = yes
					day_zero_contact = no
					authority = auth_oligarchic
					ethos = { 
						ethic = ethic_fanatic_militarist
						ethic = random
						ethic = random
					}
					origin = origin_civ_rebellion
					civics = {
						civic = random
						civic = random
						civic = random
					}
					flag = random
					effect = {
						save_event_target_as = current_civwar_rebels
						root = {
							if = {
								limit = {
									num_pops >= 1
									num_pops < 5
								}
								while = {
									count = 3
									create_army = {
										name = random
										owner = event_target:current_civwar_rebels
										species = event_target:civwar_species
										type = "planetary_rebel_army"
									}
								}
							}
							else_if = {
								limit = {
									num_pops >= 5
									num_pops < 10
								}
								while = {
									count = 5
									create_army = {
										name = random
										owner = event_target:current_civwar_rebels
										species = event_target:civwar_species
										type = "planetary_rebel_army"
									}
								}
							}
							else_if = {
								limit = {
									num_pops >= 10
									num_pops < 20
								}
								while = {
									count = 10
									create_army = {
										name = random
										owner = event_target:current_civwar_rebels
										species = event_target:civwar_species
										type = "planetary_rebel_army"
									}
								}
							}
							else_if = {
								limit = {
									num_pops >= 20
									num_pops < 30
								}
								while = {
									count = 15
									create_army = {
										name = random
										owner = event_target:current_civwar_rebels
										species = event_target:civwar_species
										type = "planetary_rebel_army"
									}
								}
							}
							else_if = {
								limit = {
									num_pops >= 30
									num_pops < 40
								}
								while = {
									count = 20
									create_army = {
										name = random
										owner = event_target:current_civwar_rebels
										species = event_target:civwar_species
										type = "planetary_rebel_army"
									}
								}
							}
							else_if = {
								limit = {
									num_pops >= 40
								}
								while = {
									count = 25
									create_army = {
										name = random
										owner = event_target:current_civwar_rebels
										species = event_target:civwar_species
										type = "planetary_rebel_army"
									}
								}
							}
						}
						#country_event = { id = civwar.1023 } # setup happens here now
					}
				}
			}
			14 = {
				create_rebels = {
					name = random
					type = default
					species = event_target:civwar_species
					ignore_initial_colony_error = yes
					day_zero_contact = no
					authority = auth_democratic
					ethos = { 
						ethic = ethic_fanatic_egalitarian
						ethic = random
						ethic = random
						ethic = random
					}
					origin = origin_civ_rebellion
					civics = {
						civic = random
						civic = random
						civic = random
					}
					flag = random

					effect = {
						save_event_target_as = current_civwar_rebels
						root = {
							if = {
								limit = {
									num_pops >= 1
									num_pops < 5
								}
								while = {
									count = 3
									create_army = {
										name = random
										owner = event_target:current_civwar_rebels
										species = event_target:civwar_species
										type = "planetary_rebel_army"
									}
								}
							}
							else_if = {
								limit = {
									num_pops >= 5
									num_pops < 10
								}
								while = {
									count = 5
									create_army = {
										name = random
										owner = event_target:current_civwar_rebels
										species = event_target:civwar_species
										type = "planetary_rebel_army"
									}
								}
							}
							else_if = {
								limit = {
									num_pops >= 10
									num_pops < 20
								}
								while = {
									count = 10
									create_army = {
										name = random
										owner = event_target:current_civwar_rebels
										species = event_target:civwar_species
										type = "planetary_rebel_army"
									}
								}
							}
							else_if = {
								limit = {
									num_pops >= 20
									num_pops < 30
								}
								while = {
									count = 15
									create_army = {
										name = random
										owner = event_target:current_civwar_rebels
										species = event_target:civwar_species
										type = "planetary_rebel_army"
									}
								}
							}
							else_if = {
								limit = {
									num_pops >= 30
									num_pops < 40
								}
								while = {
									count = 20
									create_army = {
										name = random
										owner = event_target:current_civwar_rebels
										species = event_target:civwar_species
										type = "planetary_rebel_army"
									}
								}
							}
							else_if = {
								limit = {
									num_pops >= 40
								}
								while = {
									count = 25
									create_army = {
										name = random
										owner = event_target:current_civwar_rebels
										species = event_target:civwar_species
										type = "planetary_rebel_army"
									}
								}
							}
						}
						#country_event = { id = civwar.1023 } # setup happens here now
					}
				}
			}
			14 = {
				create_rebels = {
					name = random
					type = default
					species = event_target:civwar_species
					ignore_initial_colony_error = yes
					day_zero_contact = no
					authority = auth_direct_democratic
					ethos = { 
						ethic = ethic_fanatic_egalitarian
						ethic = random
						ethic = random
						ethic = random
					}
					origin = origin_civ_rebellion
					civics = {
						civic = random
						civic = random
						civic = random
					}
					flag = random

					effect = {
						save_event_target_as = current_civwar_rebels
						root = {
							if = {
								limit = {
									num_pops >= 1
									num_pops < 5
								}
								while = {
									count = 3
									create_army = {
										name = random
										owner = event_target:current_civwar_rebels
										species = event_target:civwar_species
										type = "planetary_rebel_army"
									}
								}
							}
							else_if = {
								limit = {
									num_pops >= 5
									num_pops < 10
								}
								while = {
									count = 5
									create_army = {
										name = random
										owner = event_target:current_civwar_rebels
										species = event_target:civwar_species
										type = "planetary_rebel_army"
									}
								}
							}
							else_if = {
								limit = {
									num_pops >= 10
									num_pops < 20
								}
								while = {
									count = 10
									create_army = {
										name = random
										owner = event_target:current_civwar_rebels
										species = event_target:civwar_species
										type = "planetary_rebel_army"
									}
								}
							}
							else_if = {
								limit = {
									num_pops >= 20
									num_pops < 30
								}
								while = {
									count = 15
									create_army = {
										name = random
										owner = event_target:current_civwar_rebels
										species = event_target:civwar_species
										type = "planetary_rebel_army"
									}
								}
							}
							else_if = {
								limit = {
									num_pops >= 30
									num_pops < 40
								}
								while = {
									count = 20
									create_army = {
										name = random
										owner = event_target:current_civwar_rebels
										species = event_target:civwar_species
										type = "planetary_rebel_army"
									}
								}
							}
							else_if = {
								limit = {
									num_pops >= 40
								}
								while = {
									count = 25
									create_army = {
										name = random
										owner = event_target:current_civwar_rebels
										species = event_target:civwar_species
										type = "planetary_rebel_army"
									}
								}
							}
						}
						#country_event = { id = civwar.1023 } # setup happens here now
					}
				}
			}
			14 = {
				create_rebels = {
					name = random
					type = default
					species = event_target:civwar_species
					ignore_initial_colony_error = yes
					day_zero_contact = no
					authority = auth_strict_democratic
					ethos = { 
						ethic = ethic_fanatic_egalitarian
						ethic = random
						ethic = random
						ethic = random
					}
					origin = origin_civ_rebellion
					civics = {
						civic = random
						civic = random
						civic = random
					}
					flag = random

					effect = {
						save_event_target_as = current_civwar_rebels
						root = {
							if = {
								limit = {
									num_pops >= 1
									num_pops < 5
								}
								while = {
									count = 3
									create_army = {
										name = random
										owner = event_target:current_civwar_rebels
										species = event_target:civwar_species
										type = "planetary_rebel_army"
									}
								}
							}
							else_if = {
								limit = {
									num_pops >= 5
									num_pops < 10
								}
								while = {
									count = 5
									create_army = {
										name = random
										owner = event_target:current_civwar_rebels
										species = event_target:civwar_species
										type = "planetary_rebel_army"
									}
								}
							}
							else_if = {
								limit = {
									num_pops >= 10
									num_pops < 20
								}
								while = {
									count = 10
									create_army = {
										name = random
										owner = event_target:current_civwar_rebels
										species = event_target:civwar_species
										type = "planetary_rebel_army"
									}
								}
							}
							else_if = {
								limit = {
									num_pops >= 20
									num_pops < 30
								}
								while = {
									count = 15
									create_army = {
										name = random
										owner = event_target:current_civwar_rebels
										species = event_target:civwar_species
										type = "planetary_rebel_army"
									}
								}
							}
							else_if = {
								limit = {
									num_pops >= 30
									num_pops < 40
								}
								while = {
									count = 20
									create_army = {
										name = random
										owner = event_target:current_civwar_rebels
										species = event_target:civwar_species
										type = "planetary_rebel_army"
									}
								}
							}
							else_if = {
								limit = {
									num_pops >= 40
								}
								while = {
									count = 25
									create_army = {
										name = random
										owner = event_target:current_civwar_rebels
										species = event_target:civwar_species
										type = "planetary_rebel_army"
									}
								}
							}
						}
						#country_event = { id = civwar.1023 } # setup happens here now
					}
				}
			}
			16 = {
				create_rebels = {
					name = random
					type = default
					species = event_target:civwar_species
					ignore_initial_colony_error = yes
					day_zero_contact = no
					authority = auth_democratic_dictatorship
					ethos = { 
						ethic = ethic_fanatic_militarist
						ethic = random
						ethic = random
					}
					origin = origin_civ_rebellion
					civics = {
						civic = random
						civic = random
						civic = random
					}
					flag = random
					effect = {
						save_event_target_as = current_civwar_rebels
						root = {
							if = {
								limit = {
									num_pops >= 1
									num_pops < 5
								}
								while = {
									count = 3
									create_army = {
										name = random
										owner = event_target:current_civwar_rebels
										species = event_target:civwar_species
										type = "planetary_rebel_army"
									}
								}
							}
							else_if = {
								limit = {
									num_pops >= 5
									num_pops < 10
								}
								while = {
									count = 5
									create_army = {
										name = random
										owner = event_target:current_civwar_rebels
										species = event_target:civwar_species
										type = "planetary_rebel_army"
									}
								}
							}
							else_if = {
								limit = {
									num_pops >= 10
									num_pops < 20
								}
								while = {
									count = 10
									create_army = {
										name = random
										owner = event_target:current_civwar_rebels
										species = event_target:civwar_species
										type = "planetary_rebel_army"
									}
								}
							}
							else_if = {
								limit = {
									num_pops >= 20
									num_pops < 30
								}
								while = {
									count = 15
									create_army = {
										name = random
										owner = event_target:current_civwar_rebels
										species = event_target:civwar_species
										type = "planetary_rebel_army"
									}
								}
							}
							else_if = {
								limit = {
									num_pops >= 30
									num_pops < 40
								}
								while = {
									count = 20
									create_army = {
										name = random
										owner = event_target:current_civwar_rebels
										species = event_target:civwar_species
										type = "planetary_rebel_army"
									}
								}
							}
							else_if = {
								limit = {
									num_pops >= 40
								}
								while = {
									count = 25
									create_army = {
										name = random
										owner = event_target:current_civwar_rebels
										species = event_target:civwar_species
										type = "planetary_rebel_army"
									}
								}
							}
						}
						#country_event = { id = civwar.1023 } # setup happens here now
					}
				}
			}
			13 = {
				create_rebels = {
					name = random
					type = default
					species = event_target:civwar_species
					ignore_initial_colony_error = yes
					day_zero_contact = no
					authority = auth_dictatorial
					ethos = { 
						ethic = ethic_fanatic_militarist
						ethic = random
						ethic = random
					}
					origin = origin_civ_rebellion
					civics = {
						civic = random
						civic = random
						civic = random
					}
					flag = random
					effect = {
						save_event_target_as = current_civwar_rebels
						root = {
							if = {
								limit = {
									num_pops >= 1
									num_pops < 5
								}
								while = {
									count = 3
									create_army = {
										name = random
										owner = event_target:current_civwar_rebels
										species = event_target:civwar_species
										type = "planetary_rebel_army"
									}
								}
							}
							else_if = {
								limit = {
									num_pops >= 5
									num_pops < 10
								}
								while = {
									count = 5
									create_army = {
										name = random
										owner = event_target:current_civwar_rebels
										species = event_target:civwar_species
										type = "planetary_rebel_army"
									}
								}
							}
							else_if = {
								limit = {
									num_pops >= 10
									num_pops < 20
								}
								while = {
									count = 10
									create_army = {
										name = random
										owner = event_target:current_civwar_rebels
										species = event_target:civwar_species
										type = "planetary_rebel_army"
									}
								}
							}
							else_if = {
								limit = {
									num_pops >= 20
									num_pops < 30
								}
								while = {
									count = 15
									create_army = {
										name = random
										owner = event_target:current_civwar_rebels
										species = event_target:civwar_species
										type = "planetary_rebel_army"
									}
								}
							}
							else_if = {
								limit = {
									num_pops >= 30
									num_pops < 40
								}
								while = {
									count = 20
									create_army = {
										name = random
										owner = event_target:current_civwar_rebels
										species = event_target:civwar_species
										type = "planetary_rebel_army"
									}
								}
							}
							else_if = {
								limit = {
									num_pops >= 40
								}
								while = {
									count = 25
									create_army = {
										name = random
										owner = event_target:current_civwar_rebels
										species = event_target:civwar_species
										type = "planetary_rebel_army"
									}
								}
							}
						}
						#country_event = { id = civwar.1023 } # setup happens here now
					}
				}
			}
			8 = {
				create_rebels = {
					name = random
					type = default
					species = event_target:civwar_species
					ignore_initial_colony_error = yes
					day_zero_contact = no
					authority = auth_imperial
					ethos = { 
						ethic = ethic_fanatic_authoritarian
						ethic = random
						ethic = random
					}
					origin = origin_civ_rebellion
					civics = {
						civic = random
						civic = random
						civic = random
					}
					flag = random
					effect = {
						save_event_target_as = current_civwar_rebels
						root = {
							if = {
								limit = {
									num_pops >= 1
									num_pops < 5
								}
								while = {
									count = 3
									create_army = {
										name = random
										owner = event_target:current_civwar_rebels
										species = event_target:civwar_species
										type = "planetary_rebel_army"
									}
								}
							}
							else_if = {
								limit = {
									num_pops >= 5
									num_pops < 10
								}
								while = {
									count = 5
									create_army = {
										name = random
										owner = event_target:current_civwar_rebels
										species = event_target:civwar_species
										type = "planetary_rebel_army"
									}
								}
							}
							else_if = {
								limit = {
									num_pops >= 10
									num_pops < 20
								}
								while = {
									count = 10
									create_army = {
										name = random
										owner = event_target:current_civwar_rebels
										species = event_target:civwar_species
										type = "planetary_rebel_army"
									}
								}
							}
							else_if = {
								limit = {
									num_pops >= 20
									num_pops < 30
								}
								while = {
									count = 15
									create_army = {
										name = random
										owner = event_target:current_civwar_rebels
										species = event_target:civwar_species
										type = "planetary_rebel_army"
									}
								}
							}
							else_if = {
								limit = {
									num_pops >= 30
									num_pops < 40
								}
								while = {
									count = 20
									create_army = {
										name = random
										owner = event_target:current_civwar_rebels
										species = event_target:civwar_species
										type = "planetary_rebel_army"
									}
								}
							}
							else_if = {
								limit = {
									num_pops >= 40
								}
								while = {
									count = 25
									create_army = {
										name = random
										owner = event_target:current_civwar_rebels
										species = event_target:civwar_species
										type = "planetary_rebel_army"
									}
								}
							}
						}
						#country_event = { id = civwar.1023 } # setup happens here now
					}
				}
			}
		}
	}

	option = {
		name = civplan.2000.a
		ai_chance = { factor = 1 }
	}
}

# Rebels Win
country_event = {
	id = civplan.2001
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		from = {
			is_country_type = rebel
		}
		fromfrom = {
			has_planet_flag = planetary_rebellion
		}
	}

	immediate = {

		save_event_target_as = current_civwar_originator

		from = {
			save_event_target_as = current_civwar_rebels
			country_event = { id = civwar.1023 }
		}

		fromfrom = {
			remove_planet_flag = planetary_rebellion
			remove_planet_flag = revolt_tick_5
			save_event_target_as = rebellion_planet
			remove_modifier = planetary_rebels
		}

		add_intel = {
			who = event_target:current_civwar_rebels
			amount = 35
		}

		remove_country_flag = empire_sprawl_10_25
		remove_country_flag = empire_sprawl_25_50
		remove_country_flag = empire_sprawl_50_plus

		country_event = { id = civwar.1031 }
	}
}

# Rebels Lose
country_event = {
	id = civplan.2002
	picture = GFX_evt_victorious_army
	title = civplan.2002.name
	desc = civplan.2002.desc
	hide_window = no
	is_triggered_only = yes

	trigger = {
		is_country_type = default
		fromfrom = {
			has_planet_flag = planetary_rebellion
			controller = { is_same_value = root }
		}
	}

	immediate = {
		fromfrom = {
			set_timed_planet_flag = { flag = rebellion_suppressed days = 1800 }
			remove_planet_flag = planetary_rebellion
			remove_planet_flag = revolt_tick_5
			remove_modifier = planetary_rebels
			save_event_target_as = rebellion_planet
		}
	}
}