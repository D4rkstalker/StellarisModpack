namespace = ag_ancient_knowledge

country_event = {
	id = ag_ancient_knowledge.1
	title = "ag_ancient_knowledge.1.name"
	desc = "ag_ancient_knowledge.1.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_knowledge_window"
	picture_event_data = {
		room = ag_ancient_knowledge_room
		portrait = root.species
	}
	show_sound = event_default
	
	is_triggered_only = yes
	trigger = { NOT = { has_country_flag = ag_ancient_knowledge_window_opened } }
	immediate = {
		set_country_flag = ag_ancient_knowledge_window_opened
		if = { limit = { NOT = { has_country_flag = ag_ancient_knowledge_noti_fired } } set_country_flag = ag_ancient_knowledge_noti_fired }
		if = { limit = { NOT = { is_variable_set = ag_num_using_ancient_knowledge } } set_variable = { which = ag_num_using_ancient_knowledge value = 0 } }
		if = { limit = { NOT = { is_variable_set = ag_num_constructed_ancient_building_cores } } set_variable = { which = ag_num_constructed_ancient_building_cores value = 0 } }
		set_variable = { which = ag_num_ancient_ships value = 0 }
		every_controlled_ship = {
			limit = { OR = { ag_is_ancient_ship_locked = yes ag_is_ancient_ship_unlocked = yes } }
			prev = { change_variable = { which = ag_num_ancient_ships value = 1 } }
		}
	}
	after = { hidden_effect = { remove_country_flag = ag_ancient_knowledge_window_opened } }
	option = { name = ""  custom_gui = "ag_ancient_knowledge_option_description" default_hide_option = yes hidden_effect = { remove_country_flag = ag_ancient_knowledge_window_opened } }
	
	####################################
	###			Country Buff
	####################################
	option = {
		name = "ag_ancient_knowledge.1.group_buff"
		custom_gui = "ag_ancient_knowledge_extend_option"
		custom_tooltip = "ag_ancient_knowledge.1.group_buff.open.tooltip"
		trigger = { hidden_trigger = { NOT = { has_country_flag = ag_ancient_knowledge_menu_group_buff_opened } } }
		hidden_effect = { set_country_flag = ag_ancient_knowledge_menu_group_buff_opened ag_restart_ancient_knowledge_event = yes }
	}
	option = { name = "" custom_gui = "ag_ancient_knowledge_extended_background_option" trigger = { hidden_trigger = { has_country_flag = ag_ancient_knowledge_menu_group_buff_opened } } }
	option = {
		name = "ag_ancient_knowledge.1.a_alt"
		custom_gui = "ag_ancient_knowledge_common_option"
		trigger = { hidden_trigger = { has_country_flag = ag_ancient_knowledge_menu_group_buff_opened has_country_flag = ag_ancient_knowledge_action_1 } }
		remove_modifier = "ag_ancient_knowledge_research_buff"
		hidden_effect = {
			ag_change_ancient_knowledge_action_state = { ag_action_id = 1 }
			subtract_variable = { which = ag_num_using_ancient_knowledge value = 1 }
			ag_restart_ancient_knowledge_event = yes
		}
	}
	option = {
		name = "ag_ancient_knowledge.1.a"
		custom_gui = "ag_ancient_knowledge_common_option"
		# custom_tooltip = "ag_ancient_knowledge_cost_text_1"
		trigger = { hidden_trigger = { has_country_flag = ag_ancient_knowledge_menu_group_buff_opened NOT = { has_country_flag = ag_ancient_knowledge_action_1 } } }
		allow = { resource_stockpile_compare = { resource = ag_ancient_knowledge value > 1 mult = ag_num_using_ancient_knowledge } }
		add_modifier = { modifier = "ag_ancient_knowledge_research_buff" days = -1 }
		hidden_effect = {
			ag_change_ancient_knowledge_action_state = { ag_action_id = 1 }
			change_variable = { which = ag_num_using_ancient_knowledge value = 1 }
			ag_restart_ancient_knowledge_event = yes
		}
	}
	option = {
		name = "ag_ancient_knowledge.1.b_alt"
		custom_gui = "ag_ancient_knowledge_common_option"
		trigger = { hidden_trigger = { has_country_flag = ag_ancient_knowledge_menu_group_buff_opened has_country_flag = ag_ancient_knowledge_action_2 } }
		remove_modifier = "ag_ancient_knowledge_archaeology_buff"
		hidden_effect = {
			ag_change_ancient_knowledge_action_state = { ag_action_id = 2 }
			subtract_variable = { which = ag_num_using_ancient_knowledge value = 1 }
			ag_restart_ancient_knowledge_event = yes
		}
	}
	option = {
		name = "ag_ancient_knowledge.1.b"
		custom_gui = "ag_ancient_knowledge_common_option"
		# custom_tooltip = "ag_ancient_knowledge_cost_text_1"
		trigger = { hidden_trigger = { has_country_flag = ag_ancient_knowledge_menu_group_buff_opened NOT = { has_country_flag = ag_ancient_knowledge_action_2 } } }
		allow = { resource_stockpile_compare = { resource = ag_ancient_knowledge value > 1 mult = ag_num_using_ancient_knowledge } }
		add_modifier = { modifier = "ag_ancient_knowledge_archaeology_buff" days = -1 }
		hidden_effect = {
			ag_change_ancient_knowledge_action_state = { ag_action_id = 2 }
			change_variable = { which = ag_num_using_ancient_knowledge value = 1 }
			ag_restart_ancient_knowledge_event = yes
		}
	}
	option = {
		name = "ag_ancient_knowledge.1.c_alt"
		custom_gui = "ag_ancient_knowledge_common_option"
		trigger = { hidden_trigger = { has_country_flag = ag_ancient_knowledge_menu_group_buff_opened has_country_flag = ag_ancient_knowledge_action_3 } }
		remove_modifier = "ag_ancient_knowledge_projects_buff"
		hidden_effect = {
			ag_change_ancient_knowledge_action_state = { ag_action_id = 3 }
			subtract_variable = { which = ag_num_using_ancient_knowledge value = 1 }
			ag_restart_ancient_knowledge_event = yes
		}
	}
	option = {
		name = "ag_ancient_knowledge.1.c"
		custom_gui = "ag_ancient_knowledge_common_option"
		# custom_tooltip = "ag_ancient_knowledge_cost_text_1"
		trigger = { hidden_trigger = { has_country_flag = ag_ancient_knowledge_menu_group_buff_opened NOT = { has_country_flag = ag_ancient_knowledge_action_3 } } }
		allow = { resource_stockpile_compare = { resource = ag_ancient_knowledge value > 1 mult = ag_num_using_ancient_knowledge } }
		add_modifier = { modifier = "ag_ancient_knowledge_projects_buff" days = -1 }
		hidden_effect = {
			ag_change_ancient_knowledge_action_state = { ag_action_id = 3 }
			change_variable = { which = ag_num_using_ancient_knowledge value = 1 }
			ag_restart_ancient_knowledge_event = yes
		}
	}
	option = {
		name = "ag_ancient_knowledge.1.d_alt"
		custom_gui = "ag_ancient_knowledge_common_option"
		trigger = { hidden_trigger = { has_country_flag = ag_ancient_knowledge_menu_group_buff_opened has_country_flag = ag_ancient_knowledge_action_4 } }
		remove_modifier = "ag_ancient_knowledge_industry_buff"
		hidden_effect = {
			ag_change_ancient_knowledge_action_state = { ag_action_id = 4 }
			subtract_variable = { which = ag_num_using_ancient_knowledge value = 1 }
			ag_restart_ancient_knowledge_event = yes
		}
	}
	option = {
		name = "ag_ancient_knowledge.1.d"
		custom_gui = "ag_ancient_knowledge_common_option"
		# custom_tooltip = "ag_ancient_knowledge_cost_text_1"
		trigger = { hidden_trigger = { has_country_flag = ag_ancient_knowledge_menu_group_buff_opened NOT = { has_country_flag = ag_ancient_knowledge_action_4 } } }
		allow = { resource_stockpile_compare = { resource = ag_ancient_knowledge value > 1 mult = ag_num_using_ancient_knowledge } }
		add_modifier = { modifier = "ag_ancient_knowledge_industry_buff" days = -1 }
		hidden_effect = {
			ag_change_ancient_knowledge_action_state = { ag_action_id = 4 }
			change_variable = { which = ag_num_using_ancient_knowledge value = 1 }
			ag_restart_ancient_knowledge_event = yes
		}
	}
	option = {
		name = "ag_ancient_knowledge.1.e_alt"
		custom_gui = "ag_ancient_knowledge_common_option"
		trigger = { hidden_trigger = { has_country_flag = ag_ancient_knowledge_menu_group_buff_opened has_country_flag = ag_ancient_knowledge_action_5 } }
		remove_modifier = "ag_ancient_knowledge_spacecraft_buff"
		hidden_effect = {
			ag_change_ancient_knowledge_action_state = { ag_action_id = 5 }
			subtract_variable = { which = ag_num_using_ancient_knowledge value = 1 }
			ag_restart_ancient_knowledge_event = yes
		}
	}
	option = {
		name = "ag_ancient_knowledge.1.e"
		custom_gui = "ag_ancient_knowledge_common_option"
		# custom_tooltip = "ag_ancient_knowledge_cost_text_1"
		trigger = { hidden_trigger = { has_country_flag = ag_ancient_knowledge_menu_group_buff_opened NOT = { has_country_flag = ag_ancient_knowledge_action_5 } } }
		allow = { resource_stockpile_compare = { resource = ag_ancient_knowledge value > 1 mult = ag_num_using_ancient_knowledge } }
		add_modifier = { modifier = "ag_ancient_knowledge_spacecraft_buff" days = -1 }
		hidden_effect = {
			ag_change_ancient_knowledge_action_state = { ag_action_id = 5 }
			change_variable = { which = ag_num_using_ancient_knowledge value = 1 }
			ag_restart_ancient_knowledge_event = yes
		}
	}
	option = {
		name = "ag_ancient_knowledge.1.q_alt"
		custom_gui = "ag_ancient_knowledge_common_option"
		trigger = { hidden_trigger = { has_country_flag = ag_ancient_knowledge_menu_group_buff_opened has_country_flag = ag_ancient_knowledge_action_6 } }
		remove_modifier = "ag_ancient_knowledge_fleet_build_buff"
		hidden_effect = {
			ag_change_ancient_knowledge_action_state = { ag_action_id = 6 }
			subtract_variable = { which = ag_num_using_ancient_knowledge value = 1 }
			ag_restart_ancient_knowledge_event = yes
		}
	}
	option = {
		name = "ag_ancient_knowledge.1.q"
		custom_gui = "ag_ancient_knowledge_common_option"
		# custom_tooltip = "ag_ancient_knowledge_cost_text_1"
		trigger = { hidden_trigger = { has_country_flag = ag_ancient_knowledge_menu_group_buff_opened NOT = { has_country_flag = ag_ancient_knowledge_action_6 } } }
		allow = { resource_stockpile_compare = { resource = ag_ancient_knowledge value > 1 mult = ag_num_using_ancient_knowledge } }
		add_modifier = { modifier = "ag_ancient_knowledge_fleet_build_buff" days = -1 }
		hidden_effect = {
			ag_change_ancient_knowledge_action_state = { ag_action_id = 6 }
			change_variable = { which = ag_num_using_ancient_knowledge value = 1 }
			ag_restart_ancient_knowledge_event = yes
		}
	}
	option = {
		name = "ag_ancient_knowledge.1.r_alt"
		custom_gui = "ag_ancient_knowledge_common_option"
		trigger = { hidden_trigger = { has_country_flag = ag_ancient_knowledge_menu_group_buff_opened has_country_flag = ag_ancient_knowledge_action_7 } }
		remove_modifier = "ag_ancient_knowledge_planet_construction_buff"
		hidden_effect = {
			ag_change_ancient_knowledge_action_state = { ag_action_id = 7 }
			subtract_variable = { which = ag_num_using_ancient_knowledge value = 1 }
			ag_restart_ancient_knowledge_event = yes
		}
	}
	option = {
		name = "ag_ancient_knowledge.1.r"
		custom_gui = "ag_ancient_knowledge_common_option"
		# custom_tooltip = "ag_ancient_knowledge_cost_text_1"
		trigger = { hidden_trigger = { has_country_flag = ag_ancient_knowledge_menu_group_buff_opened NOT = { has_country_flag = ag_ancient_knowledge_action_7 } } }
		allow = { resource_stockpile_compare = { resource = ag_ancient_knowledge value > 1 mult = ag_num_using_ancient_knowledge } }
		add_modifier = { modifier = "ag_ancient_knowledge_planet_construction_buff" days = -1 }
		hidden_effect = {
			ag_change_ancient_knowledge_action_state = { ag_action_id = 7 }
			change_variable = { which = ag_num_using_ancient_knowledge value = 1 }
			ag_restart_ancient_knowledge_event = yes
		}
	}
	option = {
		name = "ag_ancient_knowledge.1.s"
		custom_gui = "ag_ancient_knowledge_common_option"
		custom_tooltip = "ag_ancient_knowledge.1.s.tooltip"
		# custom_tooltip = "ag_ancient_knowledge_cost_text_1"
		trigger = { hidden_trigger = { has_country_flag = ag_ancient_knowledge_menu_group_buff_opened NOT = { has_special_project = "ag_ancient_knowledge_leader_level" } } }
		allow = {
			resource_stockpile_compare = { resource = ag_ancient_knowledge value > 1 mult = value:ag_ancient_knowlege_leader_lvl_cost }
			any_owned_leader = { has_skill < 10 }
		}
		ag_subtract_ancient_knowledge = { ag_value = value:ag_ancient_knowlege_leader_lvl_cost }
		enable_special_project = {
			name = "ag_ancient_knowledge_leader_level"
			location = root.capital_scope
			owner = root
		}
		hidden_effect = {
			every_owned_leader = { limit = { has_skill < 10 } set_leader_flag = ag_ancient_knowledge_leader_level_target }
			ag_restart_ancient_knowledge_event = yes
		}
	}
	option = {
		name = "ag_ancient_knowledge.1.group_buff"
		custom_gui = "ag_ancient_knowledge_fold_option"
		custom_tooltip = "ag_ancient_knowledge.1.group_buff.close.tooltip"
		trigger = { hidden_trigger = { has_country_flag = ag_ancient_knowledge_menu_group_buff_opened } }
		hidden_effect = { remove_country_flag = ag_ancient_knowledge_menu_group_buff_opened ag_restart_ancient_knowledge_event = yes }
	}
	
	####################################
	###		Build Ancient Buildings
	####################################
	option = {
		name = "ag_ancient_knowledge.1.group_ancient_building"
		custom_tooltip = "ag_ancient_knowledge.1.group_ancient_building.open.tooltip"
		custom_gui = "ag_ancient_knowledge_extend_option"
		trigger = { hidden_trigger = { NOT = { has_country_flag = ag_ancient_knowledge_menu_group_ancient_building_opened } } }
		hidden_effect = { set_country_flag = ag_ancient_knowledge_menu_group_ancient_building_opened ag_restart_ancient_knowledge_event = yes }
	}
	option = { name = "" custom_gui = "ag_ancient_knowledge_extended_background_option" trigger = { hidden_trigger = { has_country_flag = ag_ancient_knowledge_menu_group_ancient_building_opened } } }
	option = {
		name = "ag_ancient_knowledge.1.f"
		custom_gui = "ag_ancient_knowledge_common_option"
		custom_tooltip = "ag_ancient_knowledge.1.f.tooltip"
		# custom_tooltip = "ag_ancient_knowledge_cost_text_2_alt"
		trigger = { hidden_trigger = { has_country_flag = ag_ancient_knowledge_menu_group_ancient_building_opened has_technology = tech_ag_class_5_singularity_research } }
		allow = {
			custom_tooltip = {
				fail_text = "ag_requires_no_ancient_knowledges_cooldown"
				NOR = {
					has_modifier = "ag_ancient_knowledges_cooldown"
					has_country_flag = ag_ancient_building_core_1
					has_country_flag = ag_ancient_building_core_2
					has_country_flag = ag_ancient_building_core_3
					has_country_flag = ag_ancient_building_core_4
				}
			}
			resource_stockpile_compare = { resource = ag_ancient_knowledge value >= 1 mult = value:ag_ancient_building_core_cost|ag_resource|ag_ancient_knowledge| }
			resource_stockpile_compare = { resource = minor_artifacts value >= 1 mult = value:ag_ancient_building_core_cost|ag_resource|minor_artifacts| }
			resource_stockpile_compare = { resource = sr_living_metal value >= 1 mult = value:ag_ancient_building_core_cost|ag_resource|sr_living_metal| }
			resource_stockpile_compare = { resource = nanites value >= 1 mult = value:ag_ancient_building_core_cost|ag_resource|nanites| }
			resource_stockpile_compare = { resource = sr_dark_matter value >= 1 mult = value:ag_ancient_building_core_cost|ag_resource|sr_dark_matter| }
		}
		ag_subtract_ancient_knowledge = { ag_value = value:ag_ancient_building_core_cost|ag_resource|ag_ancient_knowledge| }
		add_resource = { minor_artifacts = -1 mult = value:ag_ancient_building_core_cost|ag_resource|minor_artifacts| }
		add_resource = { sr_living_metal = -1 mult = value:ag_ancient_building_core_cost|ag_resource|sr_living_metal| }
		add_resource = { nanites = -1 mult = value:ag_ancient_building_core_cost|ag_resource|nanites| }
		add_resource = { sr_dark_matter = -1 mult = value:ag_ancient_building_core_cost|ag_resource|sr_dark_matter| }
		add_modifier = { modifier = "ag_ancient_knowledges_cooldown" days = 1 time_multiplier = value:ag_ancient_building_core_time }
		hidden_effect = {
			set_country_flag = ag_ancient_building_core_1
			country_event = { id = ag_ancient_knowledge.20 days = 360 }
			ag_restart_ancient_knowledge_event = yes
		}
	}
	option = {
		name = "ag_ancient_knowledge.1.g"
		custom_gui = "ag_ancient_knowledge_common_option"
		custom_tooltip = "ag_ancient_knowledge.1.g.tooltip"
		# custom_tooltip = "ag_ancient_knowledge_cost_text_2_alt"
		trigger = { hidden_trigger = { has_country_flag = ag_ancient_knowledge_menu_group_ancient_building_opened has_technology = tech_ag_matter_generator_research } }
		allow = {
			custom_tooltip = {
				fail_text = "ag_requires_no_ancient_knowledges_cooldown"
				NOR = {
					has_modifier = "ag_ancient_knowledges_cooldown"
					has_country_flag = ag_ancient_building_core_1
					has_country_flag = ag_ancient_building_core_2
					has_country_flag = ag_ancient_building_core_3
					has_country_flag = ag_ancient_building_core_4
				}
			}
			resource_stockpile_compare = { resource = ag_ancient_knowledge value >= 1 mult = value:ag_ancient_building_core_cost|ag_resource|ag_ancient_knowledge| }
			resource_stockpile_compare = { resource = minor_artifacts value >= 1 mult = value:ag_ancient_building_core_cost|ag_resource|minor_artifacts| }
			resource_stockpile_compare = { resource = sr_living_metal value >= 1 mult = value:ag_ancient_building_core_cost|ag_resource|sr_living_metal| }
			resource_stockpile_compare = { resource = nanites value >= 1 mult = value:ag_ancient_building_core_cost|ag_resource|nanites| }
			resource_stockpile_compare = { resource = sr_dark_matter value >= 1 mult = value:ag_ancient_building_core_cost|ag_resource|sr_dark_matter| }
		}
		ag_subtract_ancient_knowledge = { ag_value = value:ag_ancient_building_core_cost|ag_resource|ag_ancient_knowledge| }
		add_resource = { minor_artifacts = -1 mult = value:ag_ancient_building_core_cost|ag_resource|minor_artifacts| }
		add_resource = { sr_living_metal = -1 mult = value:ag_ancient_building_core_cost|ag_resource|sr_living_metal| }
		add_resource = { nanites = -1 mult = value:ag_ancient_building_core_cost|ag_resource|nanites| }
		add_resource = { sr_dark_matter = -1 mult = value:ag_ancient_building_core_cost|ag_resource|sr_dark_matter| }
		add_modifier = { modifier = "ag_ancient_knowledges_cooldown" days = 1 time_multiplier = value:ag_ancient_building_core_time }
		hidden_effect = {
			set_country_flag = ag_ancient_building_core_2
			country_event = { id = ag_ancient_knowledge.20 days = 360 }
			ag_restart_ancient_knowledge_event = yes
		}
	}
	option = {
		name = "ag_ancient_knowledge.1.h"
		custom_gui = "ag_ancient_knowledge_common_option"
		custom_tooltip = "ag_ancient_knowledge.1.h.tooltip"
		# custom_tooltip = "ag_ancient_knowledge_cost_text_2_alt"
		trigger = { hidden_trigger = { has_country_flag = ag_ancient_knowledge_menu_group_ancient_building_opened has_technology = tech_ag_fabrication_facility_research } }
		allow = {
			custom_tooltip = {
				fail_text = "ag_requires_no_ancient_knowledges_cooldown"
				NOR = {
					has_modifier = "ag_ancient_knowledges_cooldown"
					has_country_flag = ag_ancient_building_core_1
					has_country_flag = ag_ancient_building_core_2
					has_country_flag = ag_ancient_building_core_3
					has_country_flag = ag_ancient_building_core_4
				}
			}
			resource_stockpile_compare = { resource = ag_ancient_knowledge value >= 1 mult = value:ag_ancient_building_core_cost|ag_resource|ag_ancient_knowledge| }
			resource_stockpile_compare = { resource = minor_artifacts value >= 1 mult = value:ag_ancient_building_core_cost|ag_resource|minor_artifacts| }
			resource_stockpile_compare = { resource = sr_living_metal value >= 1 mult = value:ag_ancient_building_core_cost|ag_resource|sr_living_metal| }
			resource_stockpile_compare = { resource = nanites value >= 1 mult = value:ag_ancient_building_core_cost|ag_resource|nanites| }
			resource_stockpile_compare = { resource = sr_dark_matter value >= 1 mult = value:ag_ancient_building_core_cost|ag_resource|sr_dark_matter| }
		}
		ag_subtract_ancient_knowledge = { ag_value = value:ag_ancient_building_core_cost|ag_resource|ag_ancient_knowledge| }
		add_resource = { minor_artifacts = -1 mult = value:ag_ancient_building_core_cost|ag_resource|minor_artifacts| }
		add_resource = { sr_living_metal = -1 mult = value:ag_ancient_building_core_cost|ag_resource|sr_living_metal| }
		add_resource = { nanites = -1 mult = value:ag_ancient_building_core_cost|ag_resource|nanites| }
		add_resource = { sr_dark_matter = -1 mult = value:ag_ancient_building_core_cost|ag_resource|sr_dark_matter| }
		add_modifier = { modifier = "ag_ancient_knowledges_cooldown" days = 1 time_multiplier = value:ag_ancient_building_core_time }
		hidden_effect = {
			set_country_flag = ag_ancient_building_core_3
			country_event = { id = ag_ancient_knowledge.20 days = 360 }
			ag_restart_ancient_knowledge_event = yes
		}
	}
	option = {
		name = "ag_ancient_knowledge.1.i"
		custom_gui = "ag_ancient_knowledge_common_option"
		custom_tooltip = "ag_ancient_knowledge.1.i.tooltip"
		# custom_tooltip = "ag_ancient_knowledge_cost_text_2_alt"
		trigger = { hidden_trigger = { has_country_flag = ag_ancient_knowledge_menu_group_ancient_building_opened has_technology = tech_ag_ancient_unknown_building_research } }
		allow = {
			custom_tooltip = {
				fail_text = "ag_requires_no_ancient_knowledges_cooldown"
				NOR = {
					has_modifier = "ag_ancient_knowledges_cooldown"
					has_country_flag = ag_ancient_building_core_1
					has_country_flag = ag_ancient_building_core_2
					has_country_flag = ag_ancient_building_core_3
					has_country_flag = ag_ancient_building_core_4
				}
			}
			resource_stockpile_compare = { resource = ag_ancient_knowledge value >= 1 mult = value:ag_ancient_building_core_cost|ag_resource|ag_ancient_knowledge| }
			resource_stockpile_compare = { resource = minor_artifacts value >= 1 mult = value:ag_ancient_building_core_cost|ag_resource|minor_artifacts| }
			resource_stockpile_compare = { resource = sr_living_metal value >= 1 mult = value:ag_ancient_building_core_cost|ag_resource|sr_living_metal| }
			resource_stockpile_compare = { resource = nanites value >= 1 mult = value:ag_ancient_building_core_cost|ag_resource|nanites| }
			resource_stockpile_compare = { resource = sr_dark_matter value >= 1 mult = value:ag_ancient_building_core_cost|ag_resource|sr_dark_matter| }
		}
		ag_subtract_ancient_knowledge = { ag_value = value:ag_ancient_building_core_cost|ag_resource|ag_ancient_knowledge| }
		add_resource = { minor_artifacts = -1 mult = value:ag_ancient_building_core_cost|ag_resource|minor_artifacts| }
		add_resource = { sr_living_metal = -1 mult = value:ag_ancient_building_core_cost|ag_resource|sr_living_metal| }
		add_resource = { nanites = -1 mult = value:ag_ancient_building_core_cost|ag_resource|nanites| }
		add_resource = { sr_dark_matter = -1 mult = value:ag_ancient_building_core_cost|ag_resource|sr_dark_matter| }
		add_modifier = { modifier = "ag_ancient_knowledges_cooldown" days = 1 time_multiplier = value:ag_ancient_building_core_time }
		hidden_effect = {
			set_country_flag = ag_ancient_building_core_4
			country_event = { id = ag_ancient_knowledge.20 days = 360 }
			ag_restart_ancient_knowledge_event = yes
		}
	}
	option = {
		name = "ag_ancient_knowledge.1.group_ancient_building"
		custom_gui = "ag_ancient_knowledge_fold_option"
		custom_tooltip = "ag_ancient_knowledge.1.group_ancient_building.close.tooltip"
		trigger = { hidden_trigger = { has_country_flag = ag_ancient_knowledge_menu_group_ancient_building_opened } }
		hidden_effect = { remove_country_flag = ag_ancient_knowledge_menu_group_ancient_building_opened ag_restart_ancient_knowledge_event = yes }
	}
	
	####################################
	###		Develop New Technologies
	####################################
	option = {
		name = "ag_ancient_knowledge.1.group_new_technologies"
		custom_tooltip = "ag_ancient_knowledge.1.group_new_technologies.open.tooltip"
		custom_gui = "ag_ancient_knowledge_extend_option"
		trigger = { hidden_trigger = { NOT = { has_country_flag = ag_ancient_knowledge_menu_group_new_technologies_opened } } }
		hidden_effect = { set_country_flag = ag_ancient_knowledge_menu_group_new_technologies_opened ag_restart_ancient_knowledge_event = yes }
	}
	option = { name = "" custom_gui = "ag_ancient_knowledge_extended_background_option" trigger = { hidden_trigger = { has_country_flag = ag_ancient_knowledge_menu_group_new_technologies_opened } } }
	option = {
		name = "ag_ancient_knowledge.1.j"
		custom_gui = "ag_ancient_knowledge_common_option"
		custom_tooltip = "ag_ancient_knowledge.1.j.tooltip"
		# custom_tooltip = "ag_ancient_knowledge_cost_text_2_alt"
		trigger = { hidden_trigger = {
			has_country_flag = ag_ancient_knowledge_menu_group_new_technologies_opened
			NOT = { has_country_flag = ag_ancient_knowledge_1_j_flag }
			OR = {
				has_technology = tech_corvette_hull_2
				has_technology = tech_destroyer_hull_2
				has_technology = tech_cruiser_hull_2
				has_technology = tech_battleship_hull_2
				has_technology = tech_titan_hull_2
				has_technology = tech_ag_aura_battleship_hull_2
			}
			check_variable = { which = ag_num_ancient_ships value >= 2 }
		} }
		allow = {
			resource_stockpile_compare = { resource = ag_ancient_knowledge value >= 2 }
			resource_stockpile_compare = { resource = minor_artifacts value >= 25 }
			resource_stockpile_compare = { resource = nanites value >= 600 }
		}
		add_resource = { minor_artifacts = -25 nanites = -600 }
		hidden_effect = {
			set_country_flag = ag_ancient_knowledge_1_j_flag
			ag_give_research_project = { ag_project_id = @ag_ship_hull_upgrade_project_id ag_progress = 1 }
			ag_subtract_ancient_knowledge = { ag_value = 2 }
			ag_restart_ancient_knowledge_event = yes
		}
	}
	option = {
		name = "ag_ancient_knowledge.1.k"
		custom_gui = "ag_ancient_knowledge_common_option"
		custom_tooltip = "ag_ancient_knowledge.1.k.tooltip"
		# custom_tooltip = "ag_ancient_knowledge_cost_text_3_alt"
		trigger = { hidden_trigger = {
			has_country_flag = ag_ancient_knowledge_menu_group_new_technologies_opened
			NOT = { has_country_flag = ag_ancient_knowledge_1_k_flag }
			OR = {
				has_technology = tech_corvette_hull_2
				has_technology = tech_destroyer_hull_2
				has_technology = tech_cruiser_hull_2
				has_technology = tech_battleship_hull_2
				has_technology = tech_titan_hull_2
				has_technology = tech_ag_aura_battleship_hull_2
			}
			check_variable = { which = ag_num_ancient_ships value >= 3 }
		} }
		allow = {
			resource_stockpile_compare = { resource = ag_ancient_knowledge value >= 3 }
			resource_stockpile_compare = { resource = minor_artifacts value >= 50 }
			resource_stockpile_compare = { resource = nanites value >= 800 }
		}
		add_resource = { minor_artifacts = -50 nanites = -800 }
		hidden_effect = {
			set_country_flag = ag_ancient_knowledge_1_k_flag
			ag_give_research_project = { ag_project_id = @ag_ship_bow_upgrade_project_id ag_progress = 1 }
			ag_subtract_ancient_knowledge = { ag_value = 3 }
			ag_restart_ancient_knowledge_event = yes
		}
	}
	option = {
		name = "ag_ancient_knowledge.1.l"
		custom_gui = "ag_ancient_knowledge_common_option"
		custom_tooltip = "ag_ancient_knowledge.1.l.tooltip"
		# custom_tooltip = "ag_ancient_knowledge_cost_text_2_alt"
		trigger = { hidden_trigger = {
			has_country_flag = ag_ancient_knowledge_menu_group_new_technologies_opened
			NOT = { has_country_flag = ag_ancient_knowledge_1_l_flag }
			has_technology = tech_planetary_shield_generator
			has_technology = tech_centralized_command
			has_technology = tech_global_defense_grid
			has_technology = tech_ag_ancient_shield_1
			has_technology = tech_ag_ancient_shield_2
		} }
		allow = {
			resource_stockpile_compare = { resource = ag_ancient_knowledge value >= 2 }
			resource_stockpile_compare = { resource = minor_artifacts value >= 25 }
		}
		add_resource = { minor_artifacts = -25 }
		hidden_effect = {
			set_country_flag = ag_ancient_knowledge_1_l_flag
			ag_give_research_project = { ag_project_id = @ag_advanced_fortress_project_id ag_progress = 1 }
			ag_subtract_ancient_knowledge = { ag_value = 2 }
			ag_restart_ancient_knowledge_event = yes
		}
	}
	option = {
		name = "ag_ancient_knowledge.1.m"
		custom_gui = "ag_ancient_knowledge_common_option"
		custom_tooltip = "ag_ancient_knowledge.1.m.tooltip"
		# custom_tooltip = "ag_ancient_knowledge_cost_text_4_alt"
		trigger = { hidden_trigger = {
			has_country_flag = ag_ancient_knowledge_menu_group_new_technologies_opened
			NOT = { has_country_flag = ag_ancient_knowledge_1_m_flag }
			OR = {
				has_technology = tech_ag_anti_penetration
				has_technology = tech_ag_weapon_debuff
				has_technology = tech_ag_ship_debuff
			}
			any_controlled_ship = { OR = {
				is_ship_size = ag_aura_battleship
				has_component = ag_player_anti_penetration_aura
				has_component = ag_player_weapon_debuff_aura
				has_component = ag_player_ship_debuff_aura
			} }
			any_controlled_ship = { OR = { ag_is_ancient_ship_locked = yes ag_is_ancient_ship_unlocked = yes } }
		} }
		allow = {
			resource_stockpile_compare = { resource = ag_ancient_knowledge value >= 4 }
			resource_stockpile_compare = { resource = minor_artifacts value >= 40 }
		}
		add_resource = { minor_artifacts = -40 }
		hidden_effect = {
			set_country_flag = ag_ancient_knowledge_1_m_flag
			ag_give_research_project = { ag_project_id = @ag_advanced_auras_project_id ag_progress = 0.75 }
			ag_subtract_ancient_knowledge = { ag_value = 4 }
			ag_restart_ancient_knowledge_event = yes
		}
	}
	option = {
		name = "ag_ancient_knowledge.1.n"
		custom_gui = "ag_ancient_knowledge_common_option"
		custom_tooltip = "ag_ancient_knowledge.1.n.tooltip"
		# custom_tooltip = "ag_ancient_knowledge_cost_text_3_alt"
		trigger = { hidden_trigger = {
			has_country_flag = ag_ancient_knowledge_menu_group_new_technologies_opened
			NOT = { has_country_flag = ag_ancient_knowledge_1_n_flag }
			has_global_flag = ag_ancient_wandering_ship_destroyed
			any_owned_megastructure = { OR = {
				is_megastructure_type = ag_ancient_anchor_station_0
				is_megastructure_type = ag_ancient_anchor_station_1
				is_megastructure_type = ag_ancient_anchor_station_2
				is_megastructure_type = ag_ancient_anchor_station_player
			} }
		} }
		allow = {
			resource_stockpile_compare = { resource = ag_ancient_knowledge value >= 3 }
			resource_stockpile_compare = { resource = minor_artifacts value >= 20 }
		}
		add_resource = { minor_artifacts = -20 }
		hidden_effect = {
			set_country_flag = ag_ancient_knowledge_1_n_flag
			ag_give_research_project = { ag_project_id = @ag_reverse_engineering_anchor_station_project_id ag_progress = 0.25 }
			ag_subtract_ancient_knowledge = { ag_value = 3 }
			ag_restart_ancient_knowledge_event = yes
		}
	}
	option = {
		name = "ag_ancient_knowledge.1.p"
		custom_gui = "ag_ancient_knowledge_common_option"
		custom_tooltip = "ag_ancient_knowledge.1.p.tooltip"
		# custom_tooltip = "ag_ancient_knowledge_cost_text_3_alt"
		trigger = { hidden_trigger = {
			has_country_flag = ag_ancient_knowledge_menu_group_new_technologies_opened
			NOT = { has_country_flag = ag_ancient_knowledge_1_p_flag }
			has_country_flag = ag_known_construction_section
			has_technology = tech_mega_shipyard
		} }
		allow = {
			resource_stockpile_compare = { resource = ag_ancient_knowledge value >= 3 }
			resource_stockpile_compare = { resource = minor_artifacts value >= 30 }
		}
		add_resource = { minor_artifacts = -30 }
		hidden_effect = {
			set_country_flag = ag_ancient_knowledge_1_p_flag
			ag_give_research_project = { ag_project_id = @ag_construction_sections_project_id ag_progress = 0.25 }
			ag_subtract_ancient_knowledge = { ag_value = 3 }
			ag_restart_ancient_knowledge_event = yes
		}
	}
	option = {
		name = "ag_ancient_knowledge.1.group_new_technologies"
		custom_gui = "ag_ancient_knowledge_fold_option"
		custom_tooltip = "ag_ancient_knowledge.1.group_new_technologies.close.tooltip"
		trigger = { hidden_trigger = { has_country_flag = ag_ancient_knowledge_menu_group_new_technologies_opened } }
		hidden_effect = { remove_country_flag = ag_ancient_knowledge_menu_group_new_technologies_opened ag_restart_ancient_knowledge_event = yes }
	}
	
	###########################################################################
	# New Researchable Ship with Subsystems: (2) Add an option to open research window.
	###########################################################################
	####################################
	###		Research Ancient Ships
	####################################
	option = {
		name = "ag_ancient_knowledge.1.group_ancient_ships"
		custom_tooltip = "ag_ancient_knowledge.1.group_ancient_ships.open.tooltip"
		custom_gui = "ag_ancient_knowledge_extend_option"
		trigger = { hidden_trigger = { NOT = { has_country_flag = ag_ancient_knowledge_menu_group_ancient_ships_opened } } }
		hidden_effect = { set_country_flag = ag_ancient_knowledge_menu_group_ancient_ships_opened ag_restart_ancient_knowledge_event = yes }
	}
	option = { name = "" custom_gui = "ag_ancient_knowledge_extended_background_option" trigger = { hidden_trigger = { has_country_flag = ag_ancient_knowledge_menu_group_ancient_ships_opened } } }
	option = { name = "ag_ancient_knowledge.1.a1" custom_gui = "ag_ancient_knowledge_common_option"
		trigger = { hidden_trigger = { has_country_flag = ag_ancient_knowledge_menu_group_ancient_ships_opened
			any_controlled_ship = { NOT = { has_ship_flag = ag_event_alpha_titan } OR = { is_ship_size = ag_alpha_titan_0 is_ship_size = ag_alpha_titan_1 } }
		} }
		hidden_effect = { country_event = { id = ag_ship_special.101 } }
	}
	option = { name = "ag_ancient_knowledge.1.b1" custom_gui = "ag_ancient_knowledge_common_option"
		trigger = { hidden_trigger = { has_country_flag = ag_ancient_knowledge_menu_group_ancient_ships_opened any_controlled_ship = { OR = {
			is_ship_size = ag_beta_station_type1_0
			is_ship_size = ag_beta_station_type1_1
		} } } }
		hidden_effect = { country_event = { id = ag_ship_special.201 } }
	}
	option = {		# This is not a ship actually.
		name = "ag_ancient_knowledge.1.o"
		custom_gui = "ag_ancient_knowledge_common_option"
		custom_tooltip = "ag_ancient_knowledge.1.o.tooltip"
		# custom_tooltip = "ag_ancient_knowledge_cost_text_2_alt"
		trigger = { hidden_trigger = {
			has_country_flag = ag_ancient_knowledge_menu_group_ancient_ships_opened
			NOR = {
				has_country_flag = ag_ancient_knowledge_1_o_flag
				has_technology = tech_ag_beta_station_type2_effect
				has_tech_option = tech_ag_beta_station_type2_effect
			}
			has_global_flag = ag_aneient_beta_psionic_effect_ended
			has_technology = tech_ag_beta_station_type2
			any_owned_megastructure = { is_megastructure_type = ag_beta_station_type2_megastructure }
		} }
		allow = {
			resource_stockpile_compare = { resource = ag_ancient_knowledge value >= 2 }
			resource_stockpile_compare = { resource = minor_artifacts value >= 25 }
		}
		add_resource = { minor_artifacts = -25 }
		hidden_effect = {
			set_country_flag = ag_ancient_knowledge_1_o_flag
			ag_give_research_project = { ag_project_id = @ag_beta_psionic_station_project_id }
			ag_subtract_ancient_knowledge = { ag_value = 2 }
			ag_restart_ancient_knowledge_event = yes
		}
	}
	option = { name = "ag_ancient_knowledge.1.c1" custom_gui = "ag_ancient_knowledge_common_option"
		trigger = { hidden_trigger = { has_country_flag = ag_ancient_knowledge_menu_group_ancient_ships_opened any_controlled_ship = { OR = {
			is_ship_size = ag_gamma_station_0
			is_ship_size = ag_gamma_station_1
		} } } }
		hidden_effect = { country_event = { id = ag_ship_special.301 } }
	}
	option = { name = "ag_ancient_knowledge.1.c2" custom_gui = "ag_ancient_knowledge_common_option"
		trigger = { hidden_trigger = { has_country_flag = ag_ancient_knowledge_menu_group_ancient_ships_opened any_controlled_ship = { OR = {
			is_ship_size = ag_gamma_battlecruiser_0
			is_ship_size = ag_gamma_battlecruiser_1
		} } } }
		hidden_effect = { country_event = { id = ag_ship_special.302 } }
	}
	option = { name = "ag_ancient_knowledge.1.c3" custom_gui = "ag_ancient_knowledge_common_option"
		trigger = { hidden_trigger = { has_country_flag = ag_ancient_knowledge_menu_group_ancient_ships_opened any_controlled_ship = { OR = {
			is_ship_size = ag_gamma_escort_0
			is_ship_size = ag_gamma_escort_1
		} } } }
		hidden_effect = { country_event = { id = ag_ship_special.303 } }
	}
	option = { name = "ag_ancient_knowledge.1.c4" custom_gui = "ag_ancient_knowledge_common_option"
		trigger = { hidden_trigger = { has_country_flag = ag_ancient_knowledge_menu_group_ancient_ships_opened any_controlled_ship = { OR = {
			is_ship_size = ag_gamma_titan_0
			is_ship_size = ag_gamma_titan_1
		} } } }
		hidden_effect = { country_event = { id = ag_ship_special.304 } }
	}
	option = { name = "ag_ancient_knowledge.1.d1" custom_gui = "ag_ancient_knowledge_common_option"
		trigger = { hidden_trigger = { has_country_flag = ag_ancient_knowledge_menu_group_ancient_ships_opened any_controlled_ship = { OR = {
			is_ship_size = ag_delta_titan_0
			is_ship_size = ag_delta_titan_1
		} } } }
		hidden_effect = { country_event = { id = ag_ship_special.401 } }
	}
	option = { name = "ag_ancient_knowledge.1.d2" custom_gui = "ag_ancient_knowledge_common_option"
		trigger = { hidden_trigger = { has_country_flag = ag_ancient_knowledge_menu_group_ancient_ships_opened any_controlled_ship = { OR = {
			is_ship_size = ag_delta_platform_0
			is_ship_size = ag_delta_platform_1
			is_ship_size = ag_delta_platform_00
			is_ship_size = ag_delta_platform_10
		} } } }
		hidden_effect = { country_event = { id = ag_ship_special.402 } }
	}
	option = { name = "ag_ancient_knowledge.1.e1" custom_gui = "ag_ancient_knowledge_common_option"
		trigger = { hidden_trigger = { has_country_flag = ag_ancient_knowledge_menu_group_ancient_ships_opened any_controlled_ship = { OR = {
			is_ship_size = ag_epsilon_titan_0
			is_ship_size = ag_epsilon_titan_1
		} } } }
		hidden_effect = { country_event = { id = ag_ship_special.501 } }
	}
	option = { name = "ag_ancient_knowledge.1.f1" custom_gui = "ag_ancient_knowledge_common_option"
		trigger = { hidden_trigger = {
			has_country_flag = ag_ancient_knowledge_menu_group_ancient_ships_opened
			has_global_flag = ag_eta_titan_event_ended
			OR = {
				any_owned_megastructure = { OR = {
					is_megastructure_type = ag_ancient_eta_gateway_megastructure_0
					is_megastructure_type = ag_ancient_eta_gateway_megastructure_1
					is_megastructure_type = ag_ancient_eta_gateway_megastructure_2
					is_megastructure_type = ag_ancient_eta_gateway_megastructure_3
					is_megastructure_type = ag_ancient_eta_gateway_megastructure_4
					is_megastructure_type = ag_ancient_eta_gateway_megastructure_5
					is_megastructure_type = ag_ancient_eta_gateway_megastructure_opening
					is_megastructure_type = ag_ancient_eta_gateway_megastructure_closing
					is_megastructure_type = ag_ancient_eta_gateway_megastructure_opening_blue
					is_megastructure_type = ag_ancient_eta_gateway_megastructure_closed_alt
					is_megastructure_type = ag_ancient_eta_gateway_megastructure_damaged_alt
				} }
				any_controlled_ship = { OR = {
					is_ship_size = ag_eta_gateway_0
					is_ship_size = ag_eta_gateway_1
				} }
			}
		} }
		hidden_effect = { country_event = { id = ag_ship_special.601 } }
	}
	option = { name = "ag_ancient_knowledge.1.f2" custom_gui = "ag_ancient_knowledge_common_option"
		trigger = { hidden_trigger = { has_country_flag = ag_ancient_knowledge_menu_group_ancient_ships_opened any_controlled_ship = { OR = {
			is_ship_size = ag_eta_titan_0
			is_ship_size = ag_eta_titan_1
		} } } }
		hidden_effect = { country_event = { id = ag_ship_special.602 } }
	}
	option = { name = "ag_ancient_knowledge.1.g1" custom_gui = "ag_ancient_knowledge_common_option"
		trigger = { hidden_trigger = { has_country_flag = ag_ancient_knowledge_menu_group_ancient_ships_opened any_controlled_ship = { OR = {
			is_ship_size = ag_zeta_titan
			is_ship_size = ag_zeta_titan_psi
		} } } }
		hidden_effect = { country_event = { id = ag_ship_special.701 } }
	}
	option = { name = "ag_ancient_knowledge.1.g2" custom_gui = "ag_ancient_knowledge_common_option"
		trigger = { hidden_trigger = { has_country_flag = ag_ancient_knowledge_menu_group_ancient_ships_opened any_controlled_ship = { OR = {
			is_ship_size = ag_zeta_battleship
			is_ship_size = ag_zeta_battleship_psi
		} } } }
		hidden_effect = { country_event = { id = ag_ship_special.702 } }
	}
	option = { name = "ag_ancient_knowledge.1.g3" custom_gui = "ag_ancient_knowledge_common_option"
		trigger = { hidden_trigger = { has_country_flag = ag_ancient_knowledge_menu_group_ancient_ships_opened any_controlled_ship = { OR = {
			is_ship_size = ag_zeta_destroyer
			is_ship_size = ag_zeta_destroyer_psi
		} } } }
		hidden_effect = { country_event = { id = ag_ship_special.703 } }
	}
	option = { name = "ag_ancient_knowledge.1.g4" custom_gui = "ag_ancient_knowledge_common_option"
		trigger = { hidden_trigger = { has_country_flag = ag_ancient_knowledge_menu_group_ancient_ships_opened any_controlled_ship = { OR = {
			is_ship_size = ag_ancient_zeta_psionic_container
			is_ship_size = ag_ancient_zeta_psionic_container_alt
		} } } }
		hidden_effect = { country_event = { id = ag_ship_special.704 } }
	}
	option = { name = "ag_ancient_knowledge.1.h1" custom_gui = "ag_ancient_knowledge_common_option"
		trigger = { hidden_trigger = { has_country_flag = ag_ancient_knowledge_menu_group_ancient_ships_opened any_controlled_ship = { OR = { is_ship_size = ag_experiment_ship is_ship_size = ag_experiment_ship_hostile } } } }
		hidden_effect = { country_event = { id = ag_ship_special.801 } }
	}
	option = { name = "ag_ancient_knowledge.1.251" custom_gui = "ag_ancient_knowledge_common_option"
		trigger = { hidden_trigger = { has_country_flag = ag_ancient_knowledge_menu_group_ancient_ships_opened exists = event_target:ag_starlight_2_ship } }
		hidden_effect = { country_event = { id = ag_ship_special.2501 } }
	}
	option = { name = "ag_ancient_knowledge.1.261" custom_gui = "ag_ancient_knowledge_common_option"
		trigger = { hidden_trigger = { has_country_flag = ag_ancient_knowledge_menu_group_ancient_ships_opened any_controlled_ship = { OR = {
			is_ship_size = ag_ancient_wandering_ship_0
			is_ship_size = ag_ancient_wandering_ship_1
		} } } }
		hidden_effect = { country_event = { id = ag_ship_special.2601 } }
	}
	option = {
		name = "ag_ancient_knowledge.1.group_ancient_ships"
		custom_gui = "ag_ancient_knowledge_fold_option"
		custom_tooltip = "ag_ancient_knowledge.1.group_ancient_ships.close.tooltip"
		trigger = { hidden_trigger = { has_country_flag = ag_ancient_knowledge_menu_group_ancient_ships_opened } }
		hidden_effect = { remove_country_flag = ag_ancient_knowledge_menu_group_ancient_ships_opened ag_restart_ancient_knowledge_event = yes }
	}
}

# Notification for first time know ancient knowledge.
country_event = {
	id = ag_ancient_knowledge.2
	title = "ag_ancient_knowledge.2.name"
	desc = "ag_ancient_knowledge.2.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_throne_room }
	show_sound = event_mystic_reveal
	
	is_triggered_only = yes
	immediate = {
		if = {
			limit = { NOT = { has_country_flag = ag_ancient_knowledge_noti_fired } }
			set_country_flag = ag_ancient_knowledge_noti_fired
		}
		# if = {
			# limit = { has_country_flag = ag_ancient_knowledge_window_opened }
			# remove_country_flag = ag_ancient_knowledge_window_opened
		# }
		# if = {
			# limit = { has_country_flag = ag_ship_special_opened }
			# remove_country_flag = ag_ship_special_opened
		# }
		# if = {
			# limit = { has_country_flag = ag_subsystem_selector_opened }
			# remove_country_flag = ag_subsystem_selector_opened
		# }
	}
	
	option = {
		name = "ag_ancient_knowledge.2.a"
		custom_tooltip = "ag_ancient_knowledge.2.a.tooltip"
	}
}

country_event = {
	id = ag_ancient_knowledge.11
	title = "ag_ancient_knowledge.11.name"
	desc = "ag_ancient_knowledge.11.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_m_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_throne_room }
	show_sound = event_default
	location = root.capital_scope
	
	is_triggered_only = yes

	option = {
		name = "ag_ancient_knowledge.11.a"
		custom_tooltip = "ag_ancient.66.a.tooltip"
		hidden_effect = { add_resource = { ag_class_5_singularity = 1 } }
	}
}
country_event = {
	id = ag_ancient_knowledge.12
	title = "ag_ancient_knowledge.12.name"
	desc = "ag_ancient_knowledge.12.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_m_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_throne_room }
	show_sound = event_default
	location = root.capital_scope
	
	is_triggered_only = yes

	option = {
		name = "ag_ancient_knowledge.12.a"
		custom_tooltip = "ag_ancient.67.a.tooltip"
		hidden_effect = { add_resource = { ag_matter_generator = 1 } }
	}
}
country_event = {
	id = ag_ancient_knowledge.13
	title = "ag_ancient_knowledge.13.name"
	desc = "ag_ancient_knowledge.13.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_m_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_throne_room }
	show_sound = event_default
	location = root.capital_scope
	
	is_triggered_only = yes

	option = {
		name = "ag_ancient_knowledge.13.a"
		custom_tooltip = "ag_ancient.68.a.tooltip"
		hidden_effect = { add_resource = { ag_fabrication_facility = 1 } }
	}
}
country_event = {
	id = ag_ancient_knowledge.14
	title = "ag_ancient_knowledge.14.name"
	desc = "ag_ancient_knowledge.14.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_m_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_throne_room }
	show_sound = event_default
	location = root.capital_scope
	
	is_triggered_only = yes

	option = {
		name = "ag_ancient_knowledge.14.a"
		custom_tooltip = "ag_ancient.69.a.tooltip"
		hidden_effect = { add_resource = { ag_ancient_unknown_building = 1 } }
	}
}
country_event = {
	id = ag_ancient_knowledge.15
	title = "ag_ancient_knowledge.15.name"
	desc = "ag_ancient_knowledge.15.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_s_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_galactic_senate_room }
	show_sound = event_default
	location = root.capital_scope
	
	is_triggered_only = yes

	option = {
		name = "ag_ancient_knowledge.15.a"
		ag_add_research_option = { ag_tech = tech_ag_ship_hull_upgrade }
	}
}
country_event = {
	id = ag_ancient_knowledge.16
	title = "ag_ancient_knowledge.16.name"
	desc = "ag_ancient_knowledge.16.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_s_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_galactic_senate_room }
	show_sound = event_default
	location = root.capital_scope
	
	is_triggered_only = yes

	option = {
		name = "ag_ancient_knowledge.16.a"
		ag_add_research_option = { ag_tech = tech_ag_ship_bow_upgrade }
	}
}
country_event = {
	id = ag_ancient_knowledge.17
	title = "ag_ancient_knowledge.17.name"
	desc = "ag_ancient_knowledge.17.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_s_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_galactic_senate_room }
	show_sound = event_default
	location = root.capital_scope
	
	is_triggered_only = yes

	option = {
		name = "ag_ancient_knowledge.17.a"
		ag_add_research_option = { ag_tech = tech_ag_ancient_fortress }
	}
}
country_event = {
	id = ag_ancient_knowledge.18
	title = "ag_ancient_knowledge.18.name"
	desc = "ag_ancient_knowledge.18.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_s_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_galactic_senate_room }
	show_sound = event_default
	location = root.capital_scope
	
	is_triggered_only = yes
	immediate = { set_country_flag = ag_aura_battleship_t2_aura_flag }

	option = { name = "ag_ancient_knowledge.18.a" }
}
country_event = {
	id = ag_ancient_knowledge.19
	title = "ag_ancient_knowledge.19.name"
	desc = "ag_ancient_knowledge.19.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_m_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_galactic_senate_room }
	show_sound = event_default
	location = root.capital_scope
	
	is_triggered_only = yes

	option = {
		name = "ag_ancient_knowledge.19.a"
		ag_add_research_option = { ag_tech = tech_ag_ancient_anchor_station_mega }
	}
}

country_event = {
	id = ag_ancient_knowledge.20
	hide_window = yes
	is_triggered_only = yes
	immediate = {
		if = { limit = { has_modifier = "ag_ancient_knowledges_cooldown" } country_event = { id = ag_ancient_knowledge.20 days = 30 } }
		else = {
			change_variable = { which = ag_num_constructed_ancient_building_cores value = 1 }
			if = {
				limit = { has_country_flag = ag_ancient_building_core_1 }
				remove_country_flag = ag_ancient_building_core_1
				country_event = { id = ag_ancient_knowledge.11 }
			}
			else_if = {
				limit = { has_country_flag = ag_ancient_building_core_2 }
				remove_country_flag = ag_ancient_building_core_2
				country_event = { id = ag_ancient_knowledge.12 }
			}
			else_if = {
				limit = { has_country_flag = ag_ancient_building_core_3 }
				remove_country_flag = ag_ancient_building_core_3
				country_event = { id = ag_ancient_knowledge.13 }
			}
			else_if = {
				limit = { has_country_flag = ag_ancient_building_core_4 }
				remove_country_flag = ag_ancient_building_core_4
				country_event = { id = ag_ancient_knowledge.14 }
			}
		}
	}
}

# Gain Ancient Knowledge on survey ancient systems
country_event = {
	id = ag_ancient_knowledge.21
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		from = { ag_is_ancient_system = yes }
		exists = fromfrom
		fromfrom = { is_scope_type = fleet exists = leader }
	}

	immediate = {
		reroll_random = yes
		random_list = {
			50 = { }
			50 = {
				modifier = { factor = 1.5 fromfrom.leader = { has_trait_tier1or2 = { TRAIT = leader_trait_roamer } } }
				modifier = { factor = 1.5 fromfrom.leader = { has_trait = leader_trait_maniacal } }
				modifier = { factor = 2 fromfrom.leader = { has_trait_tier1or2 = { TRAIT = leader_trait_meticulous } } }
				modifier = { factor = 2 fromfrom.leader = { has_trait_tier1or2 = { TRAIT = leader_trait_archaeologist } } }
				fromfrom.leader = { ag_set_leader_skill_variable = { ag_which = ag_ancient_knowledge_temp } }
				# formula: 0.17 * ScientistSkills - 0.00425 * ScientistSkills^2.
				set_variable = { which = ag_ancient_knowledge_temp_2 value = ag_ancient_knowledge_temp }
				multiply_variable = { which = ag_ancient_knowledge_temp_2 value = ag_ancient_knowledge_temp }
				multiply_variable = { which = ag_ancient_knowledge_temp_2 value = 0.00425 }
				multiply_variable = { which = ag_ancient_knowledge_temp value = 0.17 }
				subtract_variable = { which = ag_ancient_knowledge_temp value = ag_ancient_knowledge_temp_2 }
				if = {
					limit = { check_variable = { which = ag_ancient_knowledge_temp value > 0 } }
					ag_add_ancient_knowledge = {
						ag_value = ag_ancient_knowledge_temp
						ag_notification = yes
						ag_notification_desc = "message_ag_gain_ancient_knowledge_survey_desc"
						ag_who = root.fromfrom
						ag_location = root.from
					}
				}
				clear_variable = ag_ancient_knowledge_temp
				clear_variable = ag_ancient_knowledge_temp_2
			}
		}
	}
}

# Ancient Knowledge from iota enclave.
country_event = {
	id = ag_ancient_knowledge.22
	hide_window = yes
	is_triggered_only = yes
	trigger = { has_modifier = "ag_support_iota_enclave" }

	immediate = {
		reroll_random = yes
		random_list = {
			75 = { }
			25 = {
				random_owned_leader = {
					limit = { OR = { is_councilor_type = councilor_research is_councilor_type = councilor_gestalt_scientist } }
					ag_set_leader_skill_variable = { ag_which = ag_phy_skill_bonus ag_scale = 0.1 }
					ag_set_leader_skill_variable = { ag_which = ag_soc_skill_bonus ag_scale = 0.1 }
					ag_set_leader_skill_variable = { ag_which = ag_eng_skill_bonus ag_scale = 0.1 }
				}
				# set_variable = { which = ag_scientist_skill_scale value = 0.667 }

				set_variable = { which = ag_ancient_knowledge_researcher_temp value = ag_phy_skill_bonus }
				change_variable = { which = ag_ancient_knowledge_researcher_temp value = ag_soc_skill_bonus }
				change_variable = { which = ag_ancient_knowledge_researcher_temp value = ag_eng_skill_bonus }
				divide_variable = { which = ag_ancient_knowledge_researcher_temp value = 4.5 }
				
				# set_variable = { which = ag_ancient_knowledge_researcher_temp value = value:ag_scientist_avg_skills }
				ag_randomize_variable = { ag_which = ag_ancient_knowledge_researcher_temp ag_scale = 3 }
				if = {
					limit = { check_variable = { which = ag_ancient_knowledge_researcher_temp value > 0 } }
					ag_add_ancient_knowledge = {
						ag_value = ag_ancient_knowledge_researcher_temp
						ag_notification = yes
						ag_notification_desc = "message_ag_gain_ancient_knowledge_iota_desc"
						ag_location = event_target:ag_ancient_iota_star
					}
				}
				clear_variable = ag_phy_skill_bonus
				clear_variable = ag_soc_skill_bonus
				clear_variable = ag_eng_skill_bonus
				clear_variable = ag_ancient_knowledge_researcher_temp
			}
		}
	}
}

# Ancient Knowledge from research ancient ships
country_event = {
	id = ag_ancient_knowledge.23
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		reroll_random = yes
		random_list = {
			50 = { }
			50 = {
				set_variable = { which = ag_ancient_knowledge_2_temp value = 1.0 }
				set_variable = { which = ag_ancient_knowledge_2_temp_alt value = 0 }
				ag_randomize_variable = { ag_which = ag_ancient_knowledge_2_temp_alt ag_scale = 10 }
				change_variable = { which = ag_ancient_knowledge_2_temp value = ag_ancient_knowledge_2_temp_alt }
				if = {
					limit = { check_variable = { which = ag_ancient_knowledge_2_temp value > 0 } }
					ag_add_ancient_knowledge = {
						ag_value = ag_ancient_knowledge_2_temp
						ag_notification = yes
						ag_notification_desc = "message_ag_gain_ancient_knowledge_ancient_ships_desc"
					}
				}
				clear_variable = ag_ancient_knowledge_2_temp
				clear_variable = ag_ancient_knowledge_2_temp_alt
			}
		}
	}
}
country_event = {
	id = ag_ancient_knowledge.24
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		reroll_random = yes
		random_list = {
			25 = { }
			75 = {
				set_variable = { which = ag_ancient_knowledge_2_temp value = 1.25 }
				set_variable = { which = ag_ancient_knowledge_3_temp_alt value = 0 }
				ag_randomize_variable = { ag_which = ag_ancient_knowledge_3_temp_alt ag_scale = 10 }
				change_variable = { which = ag_ancient_knowledge_3_temp value = ag_ancient_knowledge_3_temp_alt }
				if = {
					limit = { check_variable = { which = ag_ancient_knowledge_3_temp value > 0 } }
					ag_add_ancient_knowledge = {
						ag_value = ag_ancient_knowledge_3_temp
						ag_notification = yes
						ag_notification_desc = "message_ag_gain_ancient_knowledge_ancient_ships_desc"
					}
				}
				clear_variable = ag_ancient_knowledge_3_temp
				clear_variable = ag_ancient_knowledge_3_temp_alt
			}
		}
	}
}

# Gain Ancient Knowledge from explore ancient ruins
country_event = {
	id = ag_ancient_knowledge.25
	title = "ag_ancient_knowledge.25.name"
	desc = "ag_ancient_knowledge.25.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_s_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_archaeological_dig_room }
	show_sound = event_default
	location = from
	
	is_triggered_only = yes

	immediate = {
		from = { every_owned_pop = { root = { change_variable = { which = ag_planet_pop_counter value = 1 } } } }
		if = {
			limit = { check_variable = { which = ag_planet_pop_counter value < 10 } }
			set_variable = { which = ag_ancient_knowledge_planet_temp value = 0.75 }
		}
		else_if = {
			limit = { check_variable = { which = ag_planet_pop_counter value < 40 } }
			set_variable = { which = ag_ancient_knowledge_planet_temp value = 1 }
		}
		else_if = {
			limit = { check_variable = { which = ag_planet_pop_counter value < 80 } }
			set_variable = { which = ag_ancient_knowledge_planet_temp value = 1.25 }
		}
		else_if = {
			limit = { always = yes }
			set_variable = { which = ag_ancient_knowledge_planet_temp value = 1.5 }
		}
		if = {
			limit = { from = { exists = sector sector = { exists = leader } } }
			from.sector.sector_capital.leader = { ag_set_leader_skill_variable = { ag_which = ag_ancient_knowledge_planet_factor ag_scale = 0.1 } }
		}
		else = { set_variable = { which = ag_ancient_knowledge_planet_factor value = 0 } }
		change_variable = { which = ag_ancient_knowledge_planet_factor value = 0.5 }
		multiply_variable = { which = ag_ancient_knowledge_planet_temp value = ag_ancient_knowledge_planet_factor }
	}

	after = { hidden_effect = {
		clear_variable = ag_ancient_knowledge_planet_temp
		clear_variable = ag_ancient_knowledge_planet_factor
		clear_variable = ag_planet_pop_counter
	} }

	option = {
		name = "ag_ancient_knowledge.25.a"
		ag_add_ancient_knowledge = {
			ag_value = ag_ancient_knowledge_planet_temp
			ag_notification_desc = ""
		}
	}
}

# Gain Ancient Knowledge from building ancient ships
country_event = {
	id = ag_ancient_knowledge.26
	hide_window = yes
	is_triggered_only = yes
	immediate = {
		reroll_random = yes
		random_list = {
			98 = { }
			2 = { ag_add_ancient_knowledge = {
				ag_value = 0.5
				ag_notification = yes
				ag_notification_desc = "message_ag_gain_ancient_knowledge_built_ships_desc"
			} }
		}
	}
}
ship_event = {
	id = ag_ancient_knowledge.27
	hide_window = yes
	is_triggered_only = yes
	trigger = { OR = {
		is_ship_size = ag_beta_station_type1_dummy_alt
		ag_is_buildable_ancient_ship = yes
	} }
	immediate = { owner = { country_event = { id = ag_ancient_knowledge.26 } } }
}

# Gain Ancient Knowledge from destroying ancient ships
country_event = {
	id = ag_ancient_knowledge.28
	hide_window = yes
	is_triggered_only = yes
	immediate = {
		set_variable = { which = ag_ancient_knowledge_d_temp value = 0 }
		ag_randomize_variable = { ag_which = ag_ancient_knowledge_d_temp ag_scale = 10 }
		change_variable = { which = ag_ancient_knowledge_d_temp value = 1 }
		if = {
			limit = { check_variable = { which = ag_ancient_knowledge_d_temp value > 0 } }
			ag_add_ancient_knowledge = {
				ag_value = ag_ancient_knowledge_d_temp
				ag_notification = yes
				ag_notification_desc = "message_ag_gain_ancient_knowledge_destroyed_ships_desc"
			}
		}
	}
	after = { hidden_effect = { clear_variable = ag_ancient_knowledge_d_temp } }
}

country_event = {
	id = ag_ancient_knowledge.30
	hide_window = yes
	is_triggered_only = yes
	immediate = {
		if = {
			limit = { NOT = { has_country_flag = ag_ban_ancient_knowledge_31 } }
			country_event = { id = ag_ancient_knowledge.31 }
		}
		else = { every_owned_leader = {
			limit = { has_leader_flag = ag_ancient_knowledge_leader_level_target }
			reroll_random = yes
			random_list = {
				20 = { add_skill_without_trait_selection = 2 }
				80 = { add_skill_without_trait_selection = 1 }
			}
			remove_leader_flag = ag_ancient_knowledge_leader_level_target
		} }
	}
}
country_event = {
	id = ag_ancient_knowledge.31
	title = "ag_ancient_knowledge.31.name"
	desc = "ag_ancient_knowledge.31.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_s_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_archaeological_dig_room }
	show_sound = event_default
	is_triggered_only = yes
	after = { every_owned_leader = {
		limit = { has_leader_flag = ag_ancient_knowledge_leader_level_target }
		hidden_effect = { reroll_random = yes }
		random_list = {
			20 = { add_skill_without_trait_selection = 2 }
			80 = { add_skill_without_trait_selection = 1 }
		}
		hidden_effect = { remove_leader_flag = ag_ancient_knowledge_leader_level_target }
	} }
	option = { name = "ag_ancient_knowledge.31.a" }
	option = {
		name = "ag_ancient_knowledge.31.b"
		hidden_effect = { set_country_flag = ag_ban_ancient_knowledge_31 }
	}
}
