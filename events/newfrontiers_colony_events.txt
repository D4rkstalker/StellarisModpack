############################
#
# Colony Events
#
# Written by Annatar
#
############################

namespace = newfrontiers_colony_event


# Ancient Machine
planet_event = {
	id = newfrontiers_colony_event.1
	title = "newfrontiers_colony_event.1.name"
	desc = "newfrontiers_colony_event.1.desc"
	picture = GFX_evt_outpost
	show_sound = event_mystic_reveal
	location = ROOT
	
	trigger = {
		has_global_flag = catastrophic_event_on
		has_modifier = "ancient_cities"
		is_moon = yes
		is_moon_of_gas_giant = yes
		has_owner = yes
		original_owner = yes
		is_homeworld = no
		owner = { 
			is_ai = no
			NOT = { has_authority = auth_machine_intelligence }
		}
		has_ground_combat = no
		is_occupied_flag = no
		num_pops > 0
		is_capital = no
		OR = {
			is_planet_class = pc_arctic
			is_planet_class = pc_alpine
			is_planet_class = pc_tundra
		}
		NOT = {
			has_planet_flag = colony_event
		} 
	}
	
	is_triggered_only = yes
	
	immediate = {
		set_planet_flag = ancient_machine
		set_planet_flag = colony_event
	}
	
	option = {
		name = INTERESTING
		begin_event_chain = {
			event_chain = "ancient_machine_chain"
			target = ROOT
		}
		enable_special_project = {
			name = "ANCIENT_MACHINE_1_PROJECT"
			location = this
			owner = root
		}
		enable_special_project = {
			name = "ANCIENT_MACHINE_2_PROJECT"
			location = this
			owner = root
		}
	}
}

# Ancient Machine Dismantled
planet_event = {
	id = newfrontiers_colony_event.2
	title = "newfrontiers_colony_event.2.name"
	desc = "newfrontiers_colony_event.2.desc"
	picture = GFX_evt_outpost
	show_sound = event_construction
	location = ROOT
	
	is_triggered_only = yes
	
	option = {
		name = EXCELLENT
		if = {
			owner = {
				add_monthly_resource_mult = {
					resource = society_research
					value = 48
					min = 300
					max = 1000
				}
			}
			break = yes
		}
	}
}

# Special Project Completed 1
planet_event = {
	id = newfrontiers_colony_event.3
	title = "PROJECT_COMPLETE"
	desc = "newfrontiers_colony_event.3.desc"
	picture = GFX_evt_brown_dwarf
	show_sound = event_activating_unknown_technology
	location = ROOT
	
	is_triggered_only = yes
	
	immediate = {
		solar_system = {
			every_system_planet = {
				planet_event = { id = newfrontiers_colony_event.7 }
			}
		}
		random_list = {
			33 = { change_pc = pc_continental }
			33 = { change_pc = pc_tropical }
			33 = { change_pc = pc_ocean }
		}
	}
	
	option = {
		name = REMARKABLE
		custom_tooltip = ancient_machine_completed
	}
}

# Special Project Completed 2
planet_event = {
	id = newfrontiers_colony_event.4
	title = "PROJECT_COMPLETE"
	desc = "newfrontiers_colony_event.4.desc"
	picture = GFX_evt_brown_dwarf
	show_sound = event_activating_unknown_technology
	location = ROOT
	
	is_triggered_only = yes
	
	immediate = {
		solar_system = {
			every_system_planet = {
				planet_event = { id = newfrontiers_colony_event.8 }
			}
		}
		change_pc = pc_gaia
	}
	
	option = {
		name = MARVELOUS
		add_modifier = {
			modifier = "gaia_world"
			days = -1
		}
	}
}

# Special Project Completed 3
planet_event = {
	id = newfrontiers_colony_event.5
	title = "PROJECT_COMPLETE"
	desc = "newfrontiers_colony_event.5.desc"
	picture = GFX_evt_frozen_planet
	show_sound = event_air_raid_siren
	location = ROOT
	
	is_triggered_only = yes
	
	immediate = {
		destroy_colony = yes
		change_pc = pc_frozen
		reset_planet = yes
	}
	
	option = {
		name = TERRIBLE
		custom_tooltip = newfrontiers_colony_event.destroy_colony.tooltip
		add_modifier = {
			modifier = "lost_world"
			days = -1
		}
	}
}

# Special Project Completed 4
planet_event = {
	id = newfrontiers_colony_event.6
	title = "PROJECT_COMPLETE"
	desc = "newfrontiers_colony_event.6.desc"
	picture = GFX_evt_exploding_planet
	show_sound = event_air_raid_siren
	location = ROOT
	
	is_triggered_only = yes
	
	immediate = {
		solar_system = {
			every_system_planet = {
				planet_event = { id = newfrontiers_colony_event.7 }
			}
		}
		destroy_colony = yes
		change_pc = pc_broken
		reset_planet = yes
	}
	
	option = {
		name = CURSES
		custom_tooltip = newfrontiers_colony_event.destroy_colony.tooltip
		add_modifier = {
			modifier = "lost_world"
			days = -1
		}
		set_deposit = d_society_5
	}
}

# Brown Dwarf Y
planet_event = {
	id = newfrontiers_colony_event.7
	hide_window = yes
	
	is_triggered_only = yes
	
	trigger = {
		is_planet_class = pc_gas_giant
		any_moon = { has_planet_flag = ancient_machine }
	}
	
	immediate = {
		change_pc = pc_y_star
	}
}

# Brown Dwarf T
planet_event = {
	id = newfrontiers_colony_event.8
	hide_window = yes
	
	is_triggered_only = yes
	
	trigger = {
		is_planet_class = pc_gas_giant
		any_moon = { has_planet_flag = ancient_machine }
	}
	
	immediate = {
		change_pc = pc_t_star
	}
}

### Orbit Change ###

# Change in the orbit of the planet
planet_event = {
	id = newfrontiers_colony_event.9
	hide_window = yes
	
	trigger = {
		solar_system = {
			has_star_flag = binary_system
		}
		has_owner = yes
#		owner = { 
#			is_ai = no
#			NOT = { has_authority = auth_machine_intelligence }
#		}
		has_ground_combat = no
		is_occupied_flag = no
		is_moon = no
		num_pops > 0
		OR = {
			is_planet_class = pc_desert
			is_planet_class = pc_arid
			is_planet_class = pc_savannah
			is_planet_class = pc_tropical
			is_planet_class = pc_ocean
			is_planet_class = pc_continental
			is_planet_class = pc_arctic
			is_planet_class = pc_alpine
			is_planet_class = pc_tundra
			is_planet_class = pc_gaia
		}
		NOR = {
			has_planet_flag = colony_event
			has_global_flag = planetary_catastrophe
		} 
	}
	
	is_triggered_only = yes
	
	immediate = {
		set_global_flag = planetary_catastrophe
		set_planet_flag = orbital_change
		set_planet_flag = colony_event
		
		random_list = {
			50 = { planet_event = { id = newfrontiers_colony_event.10 days = 7200 random = 3600 }} #Orbit Reduction
			50 = { planet_event = { id = newfrontiers_colony_event.11 days = 7200 random = 3600 }}	#Orbit Increase
		}
	}
}

# Orbit Reduction - Beginning
planet_event = {
	id = newfrontiers_colony_event.10
	title = "newfrontiers_colony_event.10.name"
	desc = "newfrontiers_colony_event.10.desc"
	picture = GFX_evt_colony_settlement
	show_sound = event_air_raid_siren
	location = ROOT
	
	is_triggered_only = yes
	
	immediate = {
		random_list = {
			#Stage I
			50 = { planet_event = { id = newfrontiers_colony_event.12 days = 7200 random = 3650 }}
			#End Event
			50 = { 
				remove_global_flag = planetary_catastrophe
				remove_planet_flag = orbital_change
				remove_planet_flag = colony_event
			}	
		}
	}
	
	option = {
		name = DISCONCERTING
		hidden_effect = {
			if = {
				limit = { 
					OR = {
						is_planet_class = pc_arid
						is_planet_class = pc_desert
					}
				}
				random_list = {
					50 = {
						if = {
							limit = { NOT = { has_planet_modifier = "pm_heavy_sandstorms" } }
							add_modifier = {
								modifier = "heavy_sandstorms"
								days = -1
							}
						}
					}
					50 = {
						#Null
					}
				}
			}
			if = {
				limit = { 
					is_planet_class = pc_savannah
				}
				random_list = {
					50 = {
						if = {
							limit = { NOT = { has_planet_modifier = "pm_prolonged_drought" } }
							add_modifier = {
								modifier = "prolonged_drought"
								days = -1
							}
						}
					}
					50 = {
						#Null
					}
				}
			}
			if = {
				limit = { 
					OR = {
						is_planet_class = pc_continental
						is_planet_class = pc_tropical
						is_planet_class = pc_tundra
					}
				}
				random_list = {
					25 = {
						if = {
							limit = { NOT = { has_planet_modifier = "pm_terrible_hurricanes" } }
							add_modifier = {
								modifier = "terrible_hurricanes"
								days = -1
							}
						}
					}
					25 = {
						if = {
							limit = { NOT = { has_planet_modifier = "pm_incessant_thunderstorm" } }
							add_modifier = {
								modifier = "incessant_thunderstorm"
								days = -1
							}
						}
					}
					50 = {
						#Null
					}
				}
			}
			if = {
				limit = { 
					OR = {
						is_planet_class = pc_ocean
						is_planet_class = pc_gaia
					}
				}
				random_list = {
					50 = {
						if = {
							limit = { NOT = { has_planet_modifier = "pm_incessant_thunderstorm" } }
							add_modifier = {
								modifier = "incessant_thunderstorm"
								days = -1
							}
						}
					}
					50 = {
						#Null
					}
				}
			}
			if = {
				limit = { 
					OR = {
						is_planet_class = pc_arctic
						is_planet_class = pc_alpine
					}
				}
				if = {
					limit = { has_planet_modifier = "pm_heavy_blizzards" }
					remove_modifier = "heavy_blizzards"
				}
				if = {
					limit = { has_planet_modifier = "pm_monstrous_avalanches" }
					remove_modifier = "monstrous_avalanches"
				}
			}
		}
	}
}

# Orbit Increase - Beginning
planet_event = {
	id = newfrontiers_colony_event.11
	title = "newfrontiers_colony_event.11.name"
	desc = "newfrontiers_colony_event.11.desc"
	picture = GFX_evt_colony_settlement
	show_sound = event_air_raid_siren
	location = ROOT
	
	is_triggered_only = yes
	
	immediate = {
		random_list = {
			#Stage I
			50 = { planet_event = { id = newfrontiers_colony_event.13 days = 7200 random = 3650 }}
			#End Event
			50 = { 
				remove_global_flag = planetary_catastrophe
				remove_planet_flag = orbital_change
				remove_planet_flag = colony_event
			}	
		}
	}
	
	option = {
		name = DISCONCERTING
		hidden_effect = {
			if = {
				limit = { 
					OR = {
						is_planet_class = pc_arid
						is_planet_class = pc_desert
						is_planet_class = pc_savannah
						is_planet_class = pc_continental
						is_planet_class = pc_tropical
						is_planet_class = pc_tundra
						is_planet_class = pc_gaia
					}
				}
				if = {
					limit = { has_planet_modifier = "pm_heavy_sandstorms" }
					remove_modifier = "heavy_sandstorms"
				}
				if = {
					limit = { has_planet_modifier = "pm_prolonged_drought" }
					remove_modifier = "prolonged_drought"
				}
				if = {
					limit = { has_planet_modifier = "pm_terrible_hurricanes" }
					remove_modifier = "terrible_hurricanes"
				}
				if = {
					limit = { has_planet_modifier = "pm_incessant_thunderstorm" }
					remove_modifier = "incessant_thunderstorm"
				}
			}
			if = {
				limit = { 
					OR = {
						is_planet_class = pc_arctic
						is_planet_class = pc_alpine
					}
				}
				random_list = {
					25 = {
						if = {
							limit = { NOT = { has_planet_modifier = "pm_heavy_blizzards" } }
							add_modifier = {
								modifier = "heavy_blizzards"
								days = -1
							}
						}
					}
					25 = {
						if = {
							limit = { NOT = { has_planet_modifier = "pm_monstrous_avalanches" } }
							add_modifier = {
								modifier = "monstrous_avalanches"
								days = -1
							}
						}
					}
					50 = {
						#Null
					}
				}
			}
		}
	}
}

# Orbit Reduction - Stages
planet_event = {
	id = newfrontiers_colony_event.12
	title = "newfrontiers_colony_event.12.name"
	desc = "newfrontiers_colony_event.12.desc"
	picture = GFX_evt_colony_settlement
	show_sound = event_air_raid_siren
	location = ROOT
	
	is_triggered_only = yes
	
	trigger = {
		has_planet_flag = orbital_change
	}
	
	immediate = {
	
		if = {
			limit = { 
				is_planet_class = pc_desert
			}
			if = {
				limit = { NOT = { has_planet_modifier = "pm_dune_world" } }
				set_planet_entity = {
					picture = pc_dune
					entity = dune_planet_01_entity
				}
				clear_planet_modifiers = yes
				add_modifier = {
					modifier = "dune_world"
					days = -1
				}
				reroll_deposits = yes
				
				random_list = {
					#Next Stage
					50 = { planet_event = { id = newfrontiers_colony_event.12 days = 10950 random = 3650 }}
					#End Event
					50 = { 
						remove_global_flag = planetary_catastrophe
						remove_planet_flag = orbital_change
						remove_planet_flag = colony_event
					}
				}
		
			}
			else = {
				#End Event
				planet_event = { id = newfrontiers_colony_event.34 days = 1 }
			}
		}
		if = {
			limit = { 
				is_planet_class = pc_arid
			}
			change_pc = pc_desert
			set_planet_entity = {
				picture = pc_dune
				entity = dune_planet_01_entity
			}
			clear_planet_modifiers = yes
			add_modifier = {
				modifier = "dune_world"
				days = -1
			}
			reset_planet = yes
			
			random_list = {
				#Next Stage
				50 = { planet_event = { id = newfrontiers_colony_event.12 days = 10950 random = 3650 }}
				#End Event
				50 = { 
					remove_global_flag = planetary_catastrophe
					remove_planet_flag = orbital_change
					remove_planet_flag = colony_event
				}
			}
		}
		if = {
			limit = { 
				is_planet_class = pc_savannah
			}
			random_list = {
				50 = { change_pc = pc_arid }
				50 = { change_pc = pc_desert }
			}
			#climate_change = yes
			reset_planet = yes
			
			random_list = {
				#Next Stage
				50 = { planet_event = { id = newfrontiers_colony_event.12 days = 10950 random = 3650 }}
				#End Event
				50 = { 
					remove_global_flag = planetary_catastrophe
					remove_planet_flag = orbital_change
					remove_planet_flag = colony_event
				}
			}
		}
		if = {
			limit = { 
				OR = {
					is_planet_class = pc_continental
					is_planet_class = pc_tropical
				}
			}
			change_pc = pc_savannah
			#climate_change = yes
			reset_planet = yes
			
			random_list = {
				#Next Stage
				50 = { planet_event = { id = newfrontiers_colony_event.12 days = 10950 random = 3650 }}
				#End Event
				50 = { 
					remove_global_flag = planetary_catastrophe
					remove_planet_flag = orbital_change
					remove_planet_flag = colony_event
				}
			}
		}
		if = {
			limit = { 
				OR = {
					is_planet_class = pc_ocean
					is_planet_class = pc_gaia
					is_planet_class = pc_tundra
				}
			}
			random_list = {
				50 = { change_pc = pc_continental }
				50 = { change_pc = pc_tropical }
			}
			#climate_change = yes
			reset_planet = yes
			
			random_list = {
				#Next Stage
				50 = { planet_event = { id = newfrontiers_colony_event.12 days = 10950 random = 3650 }}
				#End Event
				50 = { 
					remove_global_flag = planetary_catastrophe
					remove_planet_flag = orbital_change
					remove_planet_flag = colony_event
				}
			}
		}
		if = {
			limit = { 
				OR = {
					is_planet_class = pc_arctic
					is_planet_class = pc_alpine
				}
			}
			random_list = {
				50 = { change_pc = pc_continental }
				50 = { change_pc = pc_ocean }
			}
			#climate_change = yes
			reset_planet = yes
			
			random_list = {
				#Next Stage
				50 = { planet_event = { id = newfrontiers_colony_event.12 days = 10950 random = 3650 }}
				#End Event
				50 = { 
					remove_global_flag = planetary_catastrophe
					remove_planet_flag = orbital_change
					remove_planet_flag = colony_event
				}
			}
		}
	}
	
	option = {
		name = TERRIBLE
		custom_tooltip = newfrontiers_colony_event.12.tooltip
	}
}

# Orbit Increase - Stages
planet_event = {
	id = newfrontiers_colony_event.13
	title = "newfrontiers_colony_event.13.name"
	desc = "newfrontiers_colony_event.13.desc"
	picture = GFX_evt_colony_settlement
	show_sound = event_air_raid_siren
	location = ROOT
	
	is_triggered_only = yes
	
	trigger = {
		has_planet_flag = orbital_change
	}
	
	immediate = {
		random_list = {
			#Next Stage
			50 = { planet_event = { id = newfrontiers_colony_event.13 days = 10950 random = 3650 }}
			#End Event
			50 = { 
				remove_global_flag = planetary_catastrophe
				remove_planet_flag = orbital_change
				remove_planet_flag = colony_event
			}	
		}
	}
	
	immediate = {
	
		if = {
			limit = { 
				OR = {
					is_planet_class = pc_arid
					is_planet_class = pc_desert
				}
			}
			change_pc = pc_savannah
			#climate_change = yes
			reset_planet = yes
			random_list = {
				#Next Stage
				50 = { planet_event = { id = newfrontiers_colony_event.13 days = 10950 random = 3650 }}
				#End Event
				50 = { 
					remove_global_flag = planetary_catastrophe
					remove_planet_flag = orbital_change
					remove_planet_flag = colony_event
				}	
			}
		}
		if = {
			limit = {
				OR = {
					is_planet_class = pc_savannah
					is_planet_class = pc_tropical
					is_planet_class = pc_gaia
				}
			}
			change_pc = pc_tundra
			#climate_change = yes
			reset_planet = yes
			random_list = {
				#Next Stage
				50 = { planet_event = { id = newfrontiers_colony_event.13 days = 10950 random = 3650 }}
				#End Event
				50 = { 
					remove_global_flag = planetary_catastrophe
					remove_planet_flag = orbital_change
					remove_planet_flag = colony_event
				}	
			}
		}
		if = {
			limit = { 
				is_planet_class = pc_continental
			}
			random_list = {
				50 = { change_pc = pc_tundra }
				50 = { change_pc = pc_alpine }
			}
			#climate_change = yes
			reset_planet = yes
			random_list = {
				#Next Stage
				50 = { planet_event = { id = newfrontiers_colony_event.13 days = 10950 random = 3650 }}
				#End Event
				50 = { 
					remove_global_flag = planetary_catastrophe
					remove_planet_flag = orbital_change
					remove_planet_flag = colony_event
				}	
			}
		}
		if = {
			limit = { 
				is_planet_class = pc_ocean
			}
			change_pc = pc_arctic
			set_planet_entity = {
				picture = pc_glacial
				entity = glacial_planet_01_entity
			}
			clear_planet_modifiers = yes
			add_modifier = {
				modifier = "glacial_world"
				days = -1
			}
			reroll_deposits = yes
			#climate_change = yes
			reset_planet = yes
			random_list = {
				#Next Stage
				50 = { planet_event = { id = newfrontiers_colony_event.13 days = 10950 random = 3650 }}
				#End Event
				50 = { 
					remove_global_flag = planetary_catastrophe
					remove_planet_flag = orbital_change
					remove_planet_flag = colony_event
				}	
			}
		}
		if = {
			limit = { 
				is_planet_class = pc_tundra
			}
			change_pc = pc_arctic
			set_planet_entity = {
				picture = pc_glacial
				entity = glacial_planet_01_entity
			}
			clear_planet_modifiers = yes
			add_modifier = {
				modifier = "glacial_world"
				days = -1
			}
			reset_planet = yes
			
			random_list = {
				#Next Stage
				50 = { planet_event = { id = newfrontiers_colony_event.13 days = 10950 random = 3650 }}
				#End Event
				50 = { 
					remove_global_flag = planetary_catastrophe
					remove_planet_flag = orbital_change
					remove_planet_flag = colony_event
				}
			}
		}
		if = {
			limit = { 
				is_planet_class = pc_alpine
			}
			if = {
				limit = { NOT = { has_planet_modifier = "pm_tempest_world" } }
				set_planet_entity = {
					picture = pc_tempest
					entity = tempest_planet_01_entity
				}
				clear_planet_modifiers = yes
				add_modifier = {
					modifier = "tempest_world"
					days = -1
				}
				reroll_deposits = yes
				
				random_list = {
					#Next Stage
					50 = { planet_event = { id = newfrontiers_colony_event.13 days = 10950 random = 3650 }}
					#End Event
					50 = { 
						remove_global_flag = planetary_catastrophe
						remove_planet_flag = orbital_change
						remove_planet_flag = colony_event
					}
				}
		
			}
			else = {
				change_pc = pc_arctic
				set_planet_entity = {
					picture = pc_glacial
					entity = glacial_planet_01_entity
				}
				clear_planet_modifiers = yes
				add_modifier = {
					modifier = "glacial_world"
					days = -1
				}
				reroll_deposits = yes
				#climate_change = yes
				reset_planet = yes
				random_list = {
					#Next Stage
					50 = { planet_event = { id = newfrontiers_colony_event.13 days = 10950 random = 3650 }}
					#End Event
					50 = { 
						remove_global_flag = planetary_catastrophe
						remove_planet_flag = orbital_change
						remove_planet_flag = colony_event
					}	
				}
			}
		}
		if = {
			limit = { 
				is_planet_class = pc_arctic
			}
			if = {
				limit = { NOT = { has_planet_modifier = "pm_glacial_world" } }
				set_planet_entity = {
					picture = pc_glacial
					entity = glacial_planet_01_entity
				}
				clear_planet_modifiers = yes
				add_modifier = {
					modifier = "glacial_world"
					days = -1
				}
				reroll_deposits = yes
				
				random_list = {
					#Next Stage
					50 = { planet_event = { id = newfrontiers_colony_event.13 days = 10950 random = 3650 }}
					#End Event
					50 = { 
						remove_global_flag = planetary_catastrophe
						remove_planet_flag = orbital_change
						remove_planet_flag = colony_event
					}
				}
		
			}
			else = {
				#End Event
				
				planet_event = { id = newfrontiers_colony_event.35 days = 1 }
			}
		}
	}
	
	option = {
		name = TERRIBLE
		custom_tooltip = newfrontiers_colony_event.13.tooltip
	}
}

# Orbit Increase - Bad End Hot
planet_event = {
	id = newfrontiers_colony_event.34
	title = "newfrontiers_colony_event.34.name"
	desc = "newfrontiers_colony_event.34.desc"
	picture = GFX_evt_city_ruins
	show_sound = event_air_raid_siren
	location = ROOT
	
	is_triggered_only = yes
	
	immediate = {
		change_pc = pc_barren
		destroy_colony = yes
		reset_planet = yes
		remove_global_flag = planetary_catastrophe
		remove_planet_flag = orbital_change
		remove_planet_flag = colony_event
		
		set_planet_entity = {
			picture = pc_scorched
			entity = scorched_planet_01_entity
		}
		add_modifier = {
			modifier = "scorched_world"
			days = -1
		}
	}
	
	option = {
		name = TERRIBLE
		custom_tooltip = newfrontiers_colony_event.destroy_colony.tooltip
		add_modifier = {
			modifier = "lost_world"
			days = -1
		}
		set_deposit = d_society_5
	}
}

# Orbit Increase - Bad End Cold
planet_event = {
	id = newfrontiers_colony_event.35
	title = "newfrontiers_colony_event.35.name"
	desc = "newfrontiers_colony_event.35.desc"
	picture = GFX_evt_city_ruins
	show_sound = event_air_raid_siren
	location = ROOT
	
	is_triggered_only = yes
	
	immediate = {
		change_pc = pc_frozen
		destroy_colony = yes
		reset_planet = yes
		remove_global_flag = planetary_catastrophe
		remove_planet_flag = orbital_change
		remove_planet_flag = colony_event
	}
	
	option = {
		name = TERRIBLE
		custom_tooltip = newfrontiers_colony_event.destroy_colony.tooltip
		add_modifier = {
			modifier = "lost_world"
			days = -1
		}
		set_deposit = d_society_5
	}
}

### Moon Collision ###

# The determinant of the collision
planet_event = {
	id = newfrontiers_colony_event.14
	hide_window = yes
	
	trigger = {
		has_owner = yes
#		owner = { 
#			is_ai = no
#			NOT = { has_authority = auth_machine_intelligence }
#		}
		has_ground_combat = no
		is_occupied_flag = no
		OR = {
			is_moon = yes
			has_moon = yes
		}
		num_pops > 0
		OR = {
			is_planet_class = pc_desert
			is_planet_class = pc_arid
			is_planet_class = pc_savannah
			is_planet_class = pc_tropical
			is_planet_class = pc_ocean
			is_planet_class = pc_continental
			is_planet_class = pc_arctic
			is_planet_class = pc_alpine
			is_planet_class = pc_tundra
			is_planet_class = pc_gaia
		}
		NOR = {
			has_planet_flag = colony_event
			has_global_flag = planetary_catastrophe
		} 
	}
	
	is_triggered_only = yes
	
	immediate = {
		set_global_flag = planetary_catastrophe
		set_planet_flag = moon_collision
		set_planet_flag = colony_event
		
		if = {
			limit = { is_moon = yes }
			planet_event = { id = newfrontiers_colony_event.15 days = 7200 random = 3600 } #Collision of the moons
		}
		if = {
			limit = { has_moon = yes }
			planet_event = { id = newfrontiers_colony_event.16 days = 7200 random = 3600 } #The Fall of the moon
		}
	}
}

# Collision of the moons - Beginning
planet_event = {
	id = newfrontiers_colony_event.15
	title = "newfrontiers_colony_event.15.name"
	desc = "newfrontiers_colony_event.15.desc"
	picture = GFX_evt_colony_settlement
	show_sound = event_air_raid_siren
	location = ROOT
	
	is_triggered_only = yes
	
	immediate = {
		planet_event = { id = newfrontiers_colony_event.17 days = 7200 random = 3650 }
	}
	
	option = {
		name = "newfrontiers_colony_event.warn_settlements"
		add_modifier = {
			modifier = "apocalypse"
			days = -1
		}
	}
	
	option = {
		name = "newfrontiers_colony_event.keep_secret"
	}
}

# The Fall of the moon - Beginning
planet_event = {
	id = newfrontiers_colony_event.16
	title = "newfrontiers_colony_event.16.name"
	desc = "newfrontiers_colony_event.16.desc"
	picture = GFX_evt_colony_settlement
	show_sound = event_air_raid_siren
	location = ROOT
	
	is_triggered_only = yes
	
	immediate = {
		planet_event = { id = newfrontiers_colony_event.18 days = 7200 random = 3650 }
	}
	
	option = {
		name = "newfrontiers_colony_event.warn_settlements"
		add_modifier = {
			modifier = "apocalypse"
			days = -1
		}
	}
	
	option = {
		name = "newfrontiers_colony_event.keep_secret"
	}
}

# Collision of the moons - End
planet_event = {
	id = newfrontiers_colony_event.17
	title = "newfrontiers_colony_event.17.name"
	desc = "newfrontiers_colony_event.17.desc"
	picture = GFX_evt_colony_settlement
	show_sound = event_air_raid_siren
	location = ROOT
	
	is_triggered_only = yes
	
	immediate = {
		solar_system = {
			every_planet = {
				limit = { any_moon = { has_planet_flag = moon_collision } }
				random_moon = {
					limit = { any_moon = { NOT = { has_planet_flag = moon_collision } } }
					remove_planet = yes
				}
			}
			
		}
		remove_global_flag = planetary_catastrophe
		remove_planet_flag = moon_collision
		remove_planet_flag = colony_event
		destroy_colony = yes
		change_pc = pc_broken
		reset_planet = yes
	}
	
	option = {
		name = TERRIBLE
		custom_tooltip = newfrontiers_colony_event.destroy_colony.tooltip
		add_modifier = {
			modifier = "lost_world"
			days = -1
		}
		set_deposit = d_society_5
	}
}

# The Fall of the moon - End
planet_event = {
	id = newfrontiers_colony_event.18
	title = "newfrontiers_colony_event.18.name"
	desc = "newfrontiers_colony_event.18.desc"
	picture = GFX_evt_colony_settlement
	show_sound = event_air_raid_siren
	location = ROOT
	
	is_triggered_only = yes
	
	immediate = {
		random_moon = {
			remove_planet = yes
		}
		remove_global_flag = planetary_catastrophe
		remove_planet_flag = moon_collision
		remove_planet_flag = colony_event
		destroy_colony = yes
		change_pc = pc_broken
		reset_planet = yes
	}
	
	option = {
		name = TERRIBLE
		custom_tooltip = newfrontiers_colony_event.destroy_colony.tooltip
		add_modifier = {
			modifier = "lost_world"
			days = -1
		}
		set_deposit = d_society_5
	}
}

### Climate Change ###

# Changing of the climate
planet_event = {
	id = newfrontiers_colony_event.19
	hide_window = yes
	
	trigger = {
		has_owner = yes
#		owner = { 
#			is_ai = no
#			NOT = { has_authority = auth_machine_intelligence }
#		}
		has_ground_combat = no
		is_occupied_flag = no
		num_pops > 0
		OR = {
			is_planet_class = pc_tropical
			is_planet_class = pc_ocean
			is_planet_class = pc_continental
			is_planet_class = pc_arctic
			is_planet_class = pc_alpine
			is_planet_class = pc_tundra
		}
		NOR = {
			has_planet_flag = colony_event
			has_global_flag = planetary_catastrophe
		} 
	}
	
	is_triggered_only = yes
	
	immediate = {
		set_global_flag = planetary_catastrophe
		set_planet_flag = climate_change
		set_planet_flag = colony_event
		
		if = {
			limit = { is_planet_class = pc_ocean }
			planet_event = { id = newfrontiers_colony_event.20 days = 7200 random = 3600 } #Drought Age
		}
		if = {
			limit = {
				OR = {
					is_planet_class = pc_continental
					is_planet_class = pc_tropical
				}
			}
			random_list = {
				50 = { planet_event = { id = newfrontiers_colony_event.20 days = 7200 random = 3600 } } #Drought Age
				50 = { planet_event = { id = newfrontiers_colony_event.21 days = 7200 random = 3600 } } #ice Age 
			}
		}
		if = {
			limit = {
				OR = {
					is_planet_class = pc_alpine
					is_planet_class = pc_tundra
				}
			}
			random_list = {
				50 = { planet_event = { id = newfrontiers_colony_event.21 days = 7200 random = 3600 } } #ice Age
				50 = { planet_event = { id = newfrontiers_colony_event.22 days = 7200 random = 3600 } } #Global Warming
			}
		}
		if = {
			limit = { is_planet_class = pc_arctic }
			planet_event = { id = newfrontiers_colony_event.22 days = 7200 random = 3600 } #Global Warming
		}
	}
}

# Drought Age - Beginning
planet_event = {
	id = newfrontiers_colony_event.20
	title = "newfrontiers_colony_event.20.name"
	desc = "newfrontiers_colony_event.20.desc"
	picture = GFX_evt_colony_settlement
	show_sound = event_air_raid_siren
	location = ROOT
	
	is_triggered_only = yes
	
	immediate = {
		planet_event = { id = newfrontiers_colony_event.23 days = 7200 random = 3650 }
	}
	
	option = {
		name = DISCONCERTING
		add_modifier = {
			modifier = "drought_age"
			days = -1
		}
	}
}

# ice Age - Beginning
planet_event = {
	id = newfrontiers_colony_event.21
	title = "newfrontiers_colony_event.21.name"
	desc = "newfrontiers_colony_event.21.desc"
	picture = GFX_evt_colony_settlement
	show_sound = event_air_raid_siren
	location = ROOT
	
	is_triggered_only = yes
	
	immediate = {
		planet_event = { id = newfrontiers_colony_event.24 days = 7200 random = 3650 }
	}
	
	option = {
		name = DISCONCERTING
		add_modifier = {
			modifier = "ice_age"
			days = -1
		}
	}
}

# Global Warming - Beginning
planet_event = {
	id = newfrontiers_colony_event.22
	title = "newfrontiers_colony_event.22.name"
	desc = "newfrontiers_colony_event.22.desc"
	picture = GFX_evt_colony_settlement
	show_sound = event_air_raid_siren
	location = ROOT
	
	is_triggered_only = yes
	
	immediate = {
		planet_event = { id = newfrontiers_colony_event.25 days = 7200 random = 3650 }
	}
	
	option = {
		name = DISCONCERTING
		add_modifier = {
			modifier = "global_warming"
			days = -1
		}
	}
}

# Drought Age - Stages
planet_event = {
	id = newfrontiers_colony_event.23
	title = "newfrontiers_colony_event.23.name"
	desc = "newfrontiers_colony_event.23.desc"
	picture = GFX_evt_colony_settlement
	show_sound = event_air_raid_siren
	location = ROOT
	
	is_triggered_only = yes
	
	option = {
		name = DISCONCERTING
		hidden_effect = {
			if = {
				limit = { is_planet_class = pc_ocean }
				change_pc = pc_continental
				#climate_change = yes
				reset_planet = yes
				custom_tooltip = newfrontiers_colony_event.23.a.tooltip
				planet_event = { id = newfrontiers_colony_event.23 days = 7200 random = 3650 }
				break = yes
			}
			if = {
				limit = { 
					OR = {
						is_planet_class = pc_continental
						is_planet_class = pc_tropical
					}
				}
				change_pc = pc_savannah
				#climate_change = yes
				reset_planet = yes
				custom_tooltip = newfrontiers_colony_event.23.b.tooltip
				planet_event = { id = newfrontiers_colony_event.23 days = 7200 random = 3650 }
				break = yes
			}
			if = {
				limit = { is_planet_class = pc_savannah }
				random_list = {
					50 = {
						change_pc = pc_desert
						custom_tooltip = newfrontiers_colony_event.23.d.tooltip
					}
					50 = {
						change_pc = pc_arid
						custom_tooltip = newfrontiers_colony_event.23.c.tooltip
					}
				}
				#climate_change = yes
				reset_planet = yes
				remove_modifier = "drought_age"
				remove_global_flag = planetary_catastrophe
				remove_planet_flag = climate_change
				remove_planet_flag = colony_event
				break = yes
			}
		}
	}
}

# ice Age - Stages
planet_event = {
	id = newfrontiers_colony_event.24
	title = "newfrontiers_colony_event.24.name"
	desc = "newfrontiers_colony_event.24.desc"
	picture = GFX_evt_colony_settlement
	show_sound = event_air_raid_siren
	location = ROOT
	
	is_triggered_only = yes
	
	option = {
		name = DISCONCERTING
		hidden_effect = {
			if = {
				limit = { is_planet_class = pc_tropical }
				change_pc = pc_continental
				#climate_change = yes
				reset_planet = yes
				custom_tooltip = newfrontiers_colony_event.24.a.tooltip
				planet_event = { id = newfrontiers_colony_event.24 days = 7200 random = 3650 }
				break = yes
			}
			if = {
				limit = { is_planet_class = pc_continental }
				random_list = {
					50 = { 
						change_pc = pc_alpine
						custom_tooltip = newfrontiers_colony_event.24.b.tooltip
					}
					50 = { 
						change_pc = pc_tundra 
						custom_tooltip = newfrontiers_colony_event.24.с.tooltip
					}
				}
				#climate_change = yes
				reset_planet = yes
				planet_event = { id = newfrontiers_colony_event.24 days = 7200 random = 3650 }
				break = yes
			}
			if = {
				limit = { 
					OR = {
						is_planet_class = pc_alpine
						is_planet_class = pc_tundra
					} 
				}
				change_pc = pc_arctic
				#climate_change = yes
				reset_planet = yes
				remove_modifier = "ice_age"
				custom_tooltip = newfrontiers_colony_event.24.d.tooltip
				remove_global_flag = planetary_catastrophe
				remove_planet_flag = climate_change
				remove_planet_flag = colony_event
				break = yes
			}
		}
	}
}

# Global Warming - Stages
planet_event = {
	id = newfrontiers_colony_event.25
	title = "newfrontiers_colony_event.25.name"
	desc = "newfrontiers_colony_event.25.desc"
	picture = GFX_evt_colony_settlement
	show_sound = event_air_raid_siren
	location = ROOT
	
	is_triggered_only = yes
	
	option = {
		name = DISCONCERTING
		hidden_effect = {
			if = {
				limit = { is_planet_class = pc_arctic }
				random_list = {
					50 = { 
						change_pc = pc_alpine 
						custom_tooltip = newfrontiers_colony_event.25.a.tooltip
					}
					50 = { 
						change_pc = pc_tundra 
						custom_tooltip = newfrontiers_colony_event.25.b.tooltip
					}
				}
				#climate_change = yes
				reset_planet = yes
				planet_event = { id = newfrontiers_colony_event.25 days = 7200 random = 3650 }
				break = yes
			}
			if = {
				limit = { 
					OR = {
						is_planet_class = pc_alpine
						is_planet_class = pc_tundra
					} 
				}
				change_pc = pc_continental
				#climate_change = yes
				reset_planet = yes
				custom_tooltip = newfrontiers_colony_event.25.c.tooltip
				planet_event = { id = newfrontiers_colony_event.25 days = 7200 random = 3650 }
				break = yes
			}
			if = {
				limit = { is_planet_class = pc_continental }
				random_list = {
					50 = { 
						change_pc = pc_tropical 
						custom_tooltip = newfrontiers_colony_event.25.d.tooltip
					}
					50 = { 
						change_pc = pc_ocean 
						custom_tooltip = newfrontiers_colony_event.25.e.tooltip
					}
				}
				#climate_change = yes
				reset_planet = yes
				remove_modifier = "global_warming"
				remove_global_flag = planetary_catastrophe
				remove_planet_flag = climate_change
				remove_planet_flag = colony_event
				break = yes
			}
		}
	}
}


### Awakened Planet ###

# Volcanic activity - Beginning
planet_event = {
	id = newfrontiers_colony_event.26
	title = "newfrontiers_colony_event.26.name"
	desc = "newfrontiers_colony_event.26.desc"
	picture = GFX_evt_volcano
	show_sound = event_mystic_reveal
	
	trigger = {
		has_owner = yes
#		owner = { 
#			is_ai = no
#			NOT = { has_authority = auth_machine_intelligence }
#		}
		has_ground_combat = no
		is_occupied_flag = no
		num_pops > 0
		OR = {
			is_planet_class = pc_desert
			is_planet_class = pc_arid
			is_planet_class = pc_savannah
			is_planet_class = pc_tropical
			is_planet_class = pc_ocean
			is_planet_class = pc_continental
			is_planet_class = pc_arctic
			is_planet_class = pc_alpine
			is_planet_class = pc_tundra
			is_planet_class = pc_gaia
		}
		NOR = {
			has_planet_flag = colony_event
			has_global_flag = planetary_catastrophe
		} 
	}
	
	is_triggered_only = yes
	
	immediate = {
		set_global_flag = planetary_catastrophe
		set_planet_flag = awakened_planet
		set_planet_flag = colony_event
		planet_event = { id = newfrontiers_colony_event.27 days = 365 random = 90 }
	}
	
	option = {
		name = INTRIGUING
		add_deposit = d_active_volcano
		add_deposit = d_geothermal_vent
	}
}

# Volcanic activity - Stage I
planet_event = {
	id = newfrontiers_colony_event.27
	title = "newfrontiers_colony_event.27.name"
	desc = "newfrontiers_colony_event.27.desc"
	picture = GFX_evt_volcano
	show_sound = event_air_raid_siren
	
	is_triggered_only = yes
	
	immediate = {
		planet_event = { id = newfrontiers_colony_event.28 days = 730 random = 365 }
	}
	
	option = {
		name = DISCONCERTING
		add_deposit = d_active_volcano
		add_deposit = d_active_volcano
		if = {
			limit = { NOT = { has_planet_modifier = "pm_unstable_tectonics" } }
			add_modifier = {
				modifier = "unstable_tectonics"
				days = -1
			}
		}
	}
}

# Volcanic activity - Stage II
planet_event = {
	id = newfrontiers_colony_event.28
	title = "newfrontiers_colony_event.28.name"
	desc = "newfrontiers_colony_event.28.desc"
	picture = GFX_evt_burning_settlement
	show_sound = event_air_raid_siren
	
	is_triggered_only = yes
	
	immediate = {
		planet_event = { id = newfrontiers_colony_event.29 days = 730 random = 365 }
	}
	
	option = {
		name = WORRYING
		add_deposit = d_active_volcano
		add_deposit = d_active_volcano
		add_deposit = d_active_volcano
		if = {
			limit = { NOT = { has_planet_modifier = "pm_toxic_atmosphere" } }
			add_modifier = {
				modifier = "toxic_atmosphere"
				days = -1
			}
		}
	}
}

# Volcanic activity - Stage III
planet_event = {
	id = newfrontiers_colony_event.29
	title = "newfrontiers_colony_event.29.name"
	desc = "newfrontiers_colony_event.29.desc"
	picture = GFX_evt_burning_settlement
	show_sound = event_air_raid_siren
	
	is_triggered_only = yes
	
	immediate = {
		planet_event = { id = newfrontiers_colony_event.30 days = 1825 random = 365 }
	}
	
	option = {
		name = TERRIBLE
		add_deposit = d_active_volcano
		add_deposit = d_active_volcano
		add_deposit = d_active_volcano
		add_modifier = {
			modifier = "apocalypse"
			days = -1
		}
	}
}

planet_event = {
	id = newfrontiers_colony_event.30
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		random_list = {
			#Good End
			50 = { planet_event = { id = newfrontiers_colony_event.31 } } 
			#Bad End
			50 = {  
				if = {
				limit = {
					OR = {
						is_planet_class = pc_desert
						is_planet_class = pc_arid
						is_planet_class = pc_savannah
					}
				}
				planet_event = { id = newfrontiers_colony_event.32 }
			}
			if = {
				limit = {
					OR = {
						is_planet_class = pc_tropical
						is_planet_class = pc_ocean
						is_planet_class = pc_continental
						is_planet_class = pc_arctic
						is_planet_class = pc_alpine
						is_planet_class = pc_tundra
						is_planet_class = pc_gaia
					}
				}
				planet_event = { id = newfrontiers_colony_event.33 }
			}
			} 
		}
	}
}

# Volcanic activity - Stage IV Good
planet_event = {
	id = newfrontiers_colony_event.31
	title = "newfrontiers_colony_event.31.name"
	desc = "newfrontiers_colony_event.31.desc"
	picture = GFX_evt_colony_settlement
	show_sound = event_mystic_reveal
	
	is_triggered_only = yes
	
	immediate = {
		remove_global_flag = planetary_catastrophe
		remove_planet_flag = awakened_planet
		remove_planet_flag = colony_event
	}
	
	option = {
		name = REMARKABLE
		remove_modifier = "unstable_tectonics"
		remove_modifier = "toxic_atmosphere"
		remove_modifier = "apocalypse"
	}
}

# Volcanic activity - Stage IV Bad 1
planet_event = {
	id = newfrontiers_colony_event.32
	title = "newfrontiers_colony_event.32.name"
	desc = "newfrontiers_colony_event.32.desc"
	picture = GFX_evt_molten
	show_sound = event_air_raid_siren
	
	is_triggered_only = yes
	
	immediate = {
		remove_global_flag = planetary_catastrophe
		remove_planet_flag = awakened_planet
		remove_planet_flag = colony_event
		destroy_colony = yes
		change_pc = pc_molten
		reset_planet = yes
	}
	
	option = {
		name = CURSES
		custom_tooltip = newfrontiers_colony_event.destroy_colony.tooltip
		add_modifier = {
			modifier = "lost_world"
			days = -1
		}
		set_deposit = d_society_5
	}
}

# Volcanic activity - Stage IV Bad 2
planet_event = {
	id = newfrontiers_colony_event.33
	title = "newfrontiers_colony_event.33.name"
	desc = "newfrontiers_colony_event.33.desc"
	picture = GFX_evt_toxic_planet
	show_sound = event_air_raid_siren
	
	is_triggered_only = yes
	
	immediate = {
		remove_global_flag = planetary_catastrophe
		remove_planet_flag = awakened_planet
		remove_planet_flag = colony_event
		destroy_colony = yes
		change_pc = pc_toxic
		reset_planet = yes
	}
	
	option = {
		name = CURSES
		custom_tooltip = newfrontiers_colony_event.destroy_colony.tooltip
		add_modifier = {
			modifier = "lost_world"
			days = -1
		}
		set_deposit = d_society_5
	}
}


# Gatekeeper - Colony Events
event = {
	id = newfrontiers_colony_event.100
	hide_window = yes
	is_triggered_only = yes
	
	trigger = {
		has_global_flag = catastrophic_event_on
	}
	
	immediate = {
		random_list = {
			10 = { 
				#Orbit Change
				every_planet = {
					planet_event = { id = newfrontiers_colony_event.9 days = 30 random = 90 }
				}
			}
			10 = {
				#Moon Collision
				every_planet = {
					planet_event = { id = newfrontiers_colony_event.14 days = 30 random = 90 }
				}
			}
			15 = {
				#Climate Change
				every_planet = {
					planet_event = { id = newfrontiers_colony_event.19 days = 30 random = 90 }
				}
			}
			5 = {
				#Awakened Planet
				every_planet = {
					planet_event = { id = newfrontiers_colony_event.26 days = 30 random = 90 }
				}
			}
			60 = {
				#Null
			}
		}
	}
}

