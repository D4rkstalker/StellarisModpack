# Mod by Terak_Lapis

namespace = dpboo

country_event = { # Testevent for Diplocheat
	id = dpboo.1
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		add_modifier = {
			modifier = diplocheat
			days = -1
		}
	}
}

country_event = { # Testevent for Diploforce
	id = dpboo.2
	hide_window = yes
	is_triggered_only = yes
	immediate = {
		add_resource = {
			diploforce = 1000
		}
	}
}

country_event = { # Testevent for Diplodrugs
	id = dpboo.3
	hide_window = yes
	is_triggered_only = yes
	immediate = {
		add_resource = {
			diplodrugs = 1000
		}
	}
}


# Churl Power
country_event = { # Churlpowers
	id = dpboo.20
	is_triggered_only = no
	hide_window = yes
	trigger = {
		has_ascension_perk = ap_churl
		NOT = {
			has_country_flag = churl_activated
		}
	}

	immediate = { # Gives you the Churl Powers
		set_country_flag = churl_activated 
		add_modifier = {
			modifier = churl_power
			days = -1
		}
		country_event = {
			id = dpboo.21
		}
	}
}

country_event = { # Gives you the Churl -  This ones shows up
	id = dpboo.21
	is_triggered_only = no
	hide_window = no
	title = "churl_ap_evt_title"
	desc = "churl_ap_evt_desc"
	show_sound = event_announcement
	picture = GFX_evt_fleet_evil
	location = capital_scope
	trackable = yes

	trigger = {
		NOR = {
			has_country_flag = churl_fired
			has_global_flag = churl_fired_global
		}
		has_ascension_perk = ap_churl
	}

	option = {
		name = PERFECT
		hidden_effect = {
			set_country_flag = churl_fired
			set_global_flag = churl_fired_global
		}
		create_leader = {
			class = admiral 
			species = owner_main_species
			name = "NAME_CHURL_ADMIRAL"
			skill = 9
			traits = {
				trait = leader_trait_admiral_hells_heart
				trait = leader_trait_army_logistician
				trait = leader_trait_dragonslayer
			}
		}
	}

}

# Galactic Community

# Mil_1 Adopt Events

country_event = { # is hidden - prep for 1001 - checks conditions
	id = dpboo.1000
	hide_window = yes

	trigger = { # Only fires when Mili 1 is active
		is_active_resolution = "resolution_mil_1"
		has_global_flag = mil_1_active
		NOR = { # prevented to ensure no eventual dobble proposing causes problems
			has_global_flag = mil_2_active
			has_global_flag = mil_3_active
			has_global_flag = mil_final_active
			has_country_flag = mil_temp_1
		}
		is_country_type = default
	}

	immediate = {
		save_event_target_as = prop_buyer
		country_event = {
			id = dpboo.1001 # The visible one
			days = 1
		}
		hidden_effect = {
			set_timed_global_flag = {
				flag = temp_1_mil_1
				days = 3
			}
		}
		random_owned_ship = {
			save_event_target_as = mil_1_location
		}		
		set_country_flag = mil_temp_1
	}

}

country_event = { # buy armies or scare your citizen
	id = dpboo.1001
	hide_window = no
	is_triggered_only = yes
	picture = GFX_evt_announcement
	show_sound = event_celebration
	title = "evt_mil_1_title"
	desc = "evt_mil_1_main_desc"
	trackable = yes
	location = event_target:mil_1_location

	trigger = {
		has_global_flag = temp_1_mil_1
		is_active_resolution = "resolution_mil_1"
		is_country_type = default
	}

	immediate = {
		remove_global_flag = temp_1_mil_1
	}

	option = { # Buy Armies
		name = "buy_option_mil_1"
		spawn_armies_mil1 = yes
		add_resource = { # Cost of employing Armys
			energy = -2500
			influence = -50
			diploforce = 5
		}
		hidden_effect = {
			set_country_flag = bought_armies_mil1	
		}
	}

	option = {
		name = "no_money_option"
		hidden_effect = {
			add_modifier = {
				modifier = scared_citizen
				years = 7
			}
			country_event = {
				id = dpboo.1002
			}
		}
	}
}

country_event = { # informs you of panic
	id = dpboo.1002
	picture = GFX_evt_atmospheric_flight
	title = "scared_mil_title"
	desc = "scared_mil_desc"
	is_triggered_only = yes

	immediate = {
		set_timed_country_flag = {
			flag = scared_citizen
			days = 1800
		}
	}

	option = {
		name = "worrying_option"
	}
}

planet_event = { # Should Create the army on the Planet
	id = dpboo.1003
	hide_window = yes
	is_triggered_only = yes

	pre_triggers = {
		has_owner = yes 
		is_capital = yes
		is_occupied_flag = no
		has_ground_combat = no

	}

	trigger = {
		owner = {
			has_country_flag = bought_armies_mil1
		}
		is_active_resolution = "resolution_mil_1"
	}

	immediate = {
		create_army = {
			name = "NAME_Army_mil1"
			species = root.owner
			owner = root.owner
			type = defense_army
		}
	}
}

# Mil_2 Event

country_event = { # hidden - checks conditions - prep for 1101
	id = dpboo.1100
	hide_window = yes
	trigger = {
		is_active_resolution = "resolution_mil_2"
		has_global_flag = mil_2_active
		NOT = { # Prevent double triggering
			has_global_flag = mil_1_active
			has_global_flag = mil_3_active
			has_global_flag = mil_final_active 
			has_country_flag = mil_temp_2
		}
		is_country_type = default
	}

	immediate = {
		country_event = {
			id = dpboo.1101
			days = 1
		}
		set_timed_global_flag = {
			flag = temp_1_mil_2
			days = 3
		}
		random_owned_starbase = {
			save_event_target_as = mil_2_location
		}
		set_country_flag = mil_temp_2
	}
}

country_event = { # Main Event for 1101 - Shipbuild Challange
	id = dpboo.1101
	hide_window = no
	picture = GFX_evt_federation_fleet
	title = "evt_mil_2_title"
	desc = "evt_mil_2_desc"
	show_sound = event_spy_orb_build_upgrade # Mod by Terak_Lapis
	is_triggered_only = yes
	trackable = yes
	location = event_target:mil_2_location

	immediate = {
		set_country_flag = chance_to_build_up
		remove_global_flag = temp_1_mil_2
	}

	option = {
		name = "favor_morebuild_option"
		hidden_effect = {
			remove_country_flag = chance_to_build_up
			set_timed_country_flag = {
				flag = fleet_built_boost
				days = 1800
			}
			add_modifier = {
				modifier = starship_build_fever
				days = 1800
			}
			add_resource = { # Expensive but worth it if you want to wage war quickly
				alloys = 2000
				influence = 100
				unity = 50
				diploforce = 5
			}
		}
	}

	option = {
		name = "no_money_option"
		hidden_effect = {
			remove_country_flag = chance_to_build_up
			set_country_flag = failed_our_crew
			add_modifier = {
				modifier = scared_citizen
				days = 1800
			}
			country_event = {
				id = dpboo.1002 # We failed our People
			}
		}
		
	}
}

# Mil_3 Event

country_event = { # hidden - checks conditions - prep for 1201
	id = dpboo.1200
	hide_window = yes
	trigger = {
		is_active_resolution = "resolution_mil_3"
		has_global_flag = mil_3_active
		NOT = { # Prevent double triggering
			has_global_flag = mil_1_active
			has_global_flag = mil_2_active
			has_global_flag = mil_final_active
			has_country_flag = mil_temp_3
		}
		is_country_type = default
	}

	immediate = {
		country_event = {
			id = dpboo.1201
			days = 1
		}
		set_timed_global_flag = {
			flag = temp_1_mil_3
			days = 3
		}
		random_owned_starbase = {
			save_event_target_as = mil_3_location
		}
		set_country_flag = mil_temp_3
	}
}

country_event = { # Buy yourself a nice Ship - Main 1201
	id = dpboo.1201
	hide_window = no
	picture = GFX_evt_galactic_senate
	show_sound = event_assembly_fight
	title = "evt_mil_3_title"
	desc = "evt_mil_3_desc"
	trackable = no
	location = capital_scope
	is_triggered_only = yes

	immediate = {
		set_country_flag = chanche_to_get_ships
		remove_global_flag = temp_1_mil_3
	}

	option = { # buy titan
		name = "buy_titan"
		spawn_titan_mil3 = yes
		add_resource = {
			alloys = -2800
			energy = -2500
			rare_crystals = -200
			sr_dark_matter = -40
			diploforce = 5
		}
		hidden_effect = {
			remove_country_flag = chanche_to_get_ships
			set_country_flag = got_titan
			#random_owned_starbase = {
			#	create_fleet = {
			#		name = "NAME_Titan_Fleet"
			#		effect = {
			#			set_owner = PREV
			#			set_fleet_flag = got_titan_fleet
			#			set_fleet_stance = passive
			#			set_aggro_range_measure_from = self
			#			set_aggro_range = 50
			#			create_ship = {
			#				name = "NAME_Titan_mil3"
			#				design = NAME_Titan_mil3
			#			}
			#		}
			#		
			#	}
			#	
			#}			
		}
	}

	option = { # buy battleship
		name = "buy_battleship"
		spawn_battleship_mil3 = yes
		add_resource = {
			alloys = -1700
			energy = -1000
			rare_crystals = -200
			sr_dark_matter = -4
			diploforce = 5
		}
		hidden_effect = {
			remove_country_flag = chanche_to_get_ships
			set_country_flag = got_battleship
			#random_owned_starbase = {
			#	create_fleet = {
			#		name = "NAME_Titan_Fleet"
			#		effect = {
			#			set_owner = PREV
			#			set_fleet_flag = got_titan_fleet
			#			set_fleet_stance = passive
			#			set_aggro_range_measure_from = self
			#			set_aggro_range = 50
			#			create_ship = {
			#				name = "NAME_Battleship_mil3"
			#				design = NAME_Battleship_mil3
			#			}
			#		}
			#		
			#	}
			#	
			#}			
		}
	}

	option = { # buy cruiser
		name = "buy_cruiser"
		spawn_cruiser_mil3 = yes
		add_resource = {
			alloys = -900
			energy = -500
			rare_crystals = -100
			sr_dark_matter = -1
			diploforce = 5
		}
		hidden_effect = {
			remove_country_flag = chanche_to_get_ships
			set_country_flag = got_titan
			#random_owned_starbase = {
			#	create_fleet = {
			#		name = "NAME_Titan_Fleet"
			#		effect = {
			#			set_owner = PREVPREV
			#			set_fleet_flag = got_titan_fleet
			#			set_fleet_stance = passive
			#			set_aggro_range_measure_from = self
			#			set_aggro_range = 50
			#			create_ship = {
			#				name = "NAME_Cruiser_mil3"
			#				design = NAME_Cruiser_mil3
			#			}
			#		}
			#		
			#	}
			#	
			#}			
		}
	}

	option = { # Scrap them
		name = "scrap_option"
		hidden_effect = {
			remove_country_flag = chanche_to_get_ships
			set_country_flag = scrap_parts		
		}
		add_resource = {
			minerals = 500
		}
	}
}

# Mil_final Event

country_event = { # hidden - checks conditions - prep for 1301
	id = dpboo.1300
	hide_window = yes
	trigger = {
		is_active_resolution = "resolution_mil_final"
		has_global_flag = mil_final_active
		NOT = { # Prevent double triggering
			has_global_flag = mil_1_active
			has_global_flag = mil_2_active
			has_global_flag = mil_3_active
			has_country_flag = mil_temp_final
		}
		is_country_type = default
	}

	immediate = {
		country_event = {
			id = dpboo.1301
			days = 1
		}
		set_timed_global_flag = {
			flag = temp_1_mil_final
			days = 3
		}
		capital_scope = {
			save_event_target_as = mil_final_location
		}
		set_country_flag = mil_temp_final
	}
}

country_event = { # Main Event - 1301 Code - Prep for War
	id = dpboo.1301
	hide_window = no
	picture = GFX_evt_fallen_empire_awakes
	show_sound = event_conversation
	title = "evt_mil_final_title"
	desc = "evt_mil_final_desc"
	trackable = yes
	location = event_target:mil_final_location
	is_triggered_only = yes	

	immediate = {
		set_country_flag = war_preperations
		remove_global_flag = temp_1_mil_final
	}

	option = { # Wartimes
		name = "prepare"
		hidden_effect = {
			remove_country_flag = war_preperations
			set_country_flag = prepare_for_the_worst
			add_modifier = {
				modifier = mil_spending_high
				days = -1
			}
		}
		add_resource = {
			energy = -750
			alloys = -4000
			influence = 300
		}
	}

	option = { # Peacetimes
		name = "everthing_will_be_fine"
		hidden_effect = {
			add_modifier = {
				modifier = mil_spending_low
				days = -1
			}
		}
		add_resource = {
			unity = 500
			influence = -200
			alloys = 200
			energy = 500
		}
	}
	
}

# Planned Followup with aggressor from within
# Sport Match for Preperators
# Festival for Peacelovers
# Costs from Prep
# Fleetbuildup events over time

event = { # as support for tmtt
	id = dpboo.0
	is_triggered_only = yes
	hide_window = yes
	immediate = {
		set_global_flag = diplo_ventures_active
	}
}
country_event = {
	id = dpboo.70000
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		set_global_flag = diplo_ventures_active
	}
}