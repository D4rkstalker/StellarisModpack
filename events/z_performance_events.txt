namespace = z_performance

#_添加基础flag
event = {
	id = z_performance.12
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		set_global_flag = z_performance_installed	#_MOD安装
		set_global_flag = z_performance_always		#_每日
		set_timed_global_flag = { flag = z_manual_job_check days = 3 }		#_start检测
		every_country = { country_event = { id = z_performance.10  days = 45 random = 5  } }
	}
}
###_万用初始化
country_event = {
	id = z_performance.101
	hide_window = yes
	fire_only_once = yes
	trigger = { is_ai = no }
	mean_time_to_happen = { days = 23 }
	
	immediate = {
		if = {
			limit = { NOT = { has_global_flag = z_performance_installed } }
			set_global_flag = z_performance_installed
			remove_global_flag = z_performance_high
			remove_global_flag = z_performance_mid
			remove_global_flag = z_performance_low
			remove_global_flag = z_performance_never
			#remove_global_flag = z_allow_nojob_check
			set_global_flag = z_performance_always
			set_global_flag = z_allow_job_check			#_全人口检测
			every_country = { country_event = { id = z_performance.10  days = 45 random = 5  } }
		}
	}
}




#_提示-是否开启优化
country_event = {
	id = z_performance.10
	title = z_performance_start_title
	desc = z_performance_start_title_desc
	picture = GFX_evt_z_performance
	is_triggered_only = yes
	
	trigger = {
		is_ai = no
		NOT = { has_global_flag = z_performance_start }
	}
	immediate = { set_global_flag = z_performance_start }
	
	#_开启优化
	option = {
		name = z_performance.10.a
		custom_tooltip = z_performance.10.a.tooltip
		trigger = { has_global_flag = z_performance_always }
		hidden_effect = {
			remove_global_flag = z_performance_always
			set_global_flag = z_performance_high
		}
	}
	#_不开启优化
	option = {
		name = z_performance.10.b
		custom_tooltip = z_performance.10.b.tooltip
		trigger = { has_global_flag = z_performance_always }
	}
}



#_z_modmenu
country_event = {
	id = z_performance.11
	title = z_performance_title
	desc = z_performance_title_desc
	picture = GFX_evt_z_performance
	is_triggered_only = yes
	
	immediate = {
		if = {
			limit = { NOT = { has_global_flag = z_performance_start } }
			set_global_flag = z_performance_start
		}
	}

	#_6天/月
	option = {
		name = z_performance.11.a
		custom_tooltip = z_performance.11.a.tooltip
		trigger = { has_global_flag = z_performance_always }
		hidden_effect = {
			remove_global_flag = z_performance_always
			set_global_flag = z_performance_high
			
			country_event = { id = z_performance.11 }
		}
	}
	#_3天/月
	option = {
		name = z_performance.11.b
		custom_tooltip = z_performance.11.b.tooltip
		trigger = { has_global_flag = z_performance_high }
		hidden_effect = {
			remove_global_flag = z_performance_high
			set_global_flag = z_performance_mid
			
			country_event = { id = z_performance.11 }
		}
	}
	#_1天/月
	option = {
		name = z_performance.11.c
		custom_tooltip = z_performance.11.c.tooltip
		trigger = { has_global_flag = z_performance_mid }
		hidden_effect = {
			
			remove_global_flag = z_performance_mid
			set_global_flag = z_performance_low
			
			country_event = { id = z_performance.11 }
		}
	}
	#_每日
	option = {
		name = z_performance.11.e
		custom_tooltip = z_performance.11.e.tooltip
		trigger = { has_global_flag = z_performance_low }
		hidden_effect = {
			remove_global_flag = z_performance_low
			set_global_flag = z_performance_always
			
			country_event = { id = z_performance.11 }
		}
	}
	
	#_重启
	option = {
		name = z_performance.11.f
		custom_tooltip = z_performance.11.f.tooltip
		trigger = { has_global_flag = z_performance_never }
		hidden_effect = {
			remove_global_flag = z_performance_never
			set_global_flag = z_performance_high
			
			country_event = { id = z_performance.11 }
		}
	}
	#_关闭检测
	option = {
		name = z_performance.11.f1
		custom_tooltip = z_performance.11.f1.tooltip
		hidden_effect = {
			remove_global_flag = z_performance_always
			remove_global_flag = z_allow_job_check		#_全人口检测
			remove_global_flag = z_performance_high
			remove_global_flag = z_performance_mid
			remove_global_flag = z_performance_low
			set_global_flag = z_performance_never
			country_event = { id = z_performance.11 }
		}
	}
	
#	#_不优化失业
#	option = {
#		name = z_performance.11.f3
#		custom_tooltip = z_performance.11.f3.tooltip
#		trigger = { NOT = { has_global_flag = z_allow_nojob_check } }
#		hidden_effect = {
#			set_global_flag = z_allow_nojob_check
#			country_event = { id = z_performance.11 }
#		}
#	}
#	#_优化失业-默认
#	option = {
#		name = z_performance.11.f4
#		custom_tooltip = z_performance.11.f4.tooltip
#		trigger = { has_global_flag = z_allow_nojob_check }
#		hidden_effect = {
#			remove_global_flag = z_allow_nojob_check
#			country_event = { id = z_performance.11 }
#		}
#	}
	
#	#_跳过第一天 开启-默认
#	option = {
#		name = z_performance.11.f5
#		custom_tooltip = z_performance.11.f5.tooltip
#		trigger = { NOT = { has_global_flag = z_performance_skip_1st } }
#		hidden_effect = {
#			set_global_flag = z_performance_skip_1st
#			country_event = { id = z_performance.11 }
#		}
#	}
#	#_跳过第一天 关闭
#	option = {
#		name = z_performance.11.f6
#		custom_tooltip = z_performance.11.f6.tooltip
#		trigger = { has_global_flag = z_performance_skip_1st }
#		hidden_effect = {
#			remove_global_flag = z_performance_skip_1st
#			country_event = { id = z_performance.11 }
#		}
#	}
	
	#_Debug 默认设置
	option = {
		name = z_performance.11.f2
		custom_tooltip = z_performance.11.f2.tooltip
		hidden_effect = {
			remove_global_flag = z_performance_high
			remove_global_flag = z_performance_mid
			remove_global_flag = z_performance_low
			remove_global_flag = z_performance_never
			#remove_global_flag = z_allow_nojob_check
			set_global_flag = z_performance_always
			country_event = { id = z_performance.11 }
		}
	}
	#_银河系人口数量检测
	option = {
		name = z_performance.11.g1
		custom_tooltip = z_performance.11.g1.tooltip
		hidden_effect = {
			set_variable = { which = z_galaxy_pop_num_var value = 0 }
			every_country = {
				limit = { num_pops > 0 }
				every_owned_pop = {
					ROOT = {
						change_variable = { which = z_galaxy_pop_num_var value = 1 }
					}
				}
			}
			country_event = { id = z_performance.111 }		#_显示人口/参数清零
		}
	}
	#_退回z_modmenu
	option = {
		name = z_performance.11.g
		custom_tooltip = z_performance.11.g.tooltip
		hidden_effect = {
			country_event = { id = z_modmenu.1 }
		}
	}
	#_关闭设置
	option = {
		name = z_performance.11.h
		custom_tooltip = z_performance.11.h.tooltip
	}
}
#_人口总数显示
country_event = {
	id = z_performance.111
	title = z_num_pop_title
	desc = z_num_pop_title_desc
	picture = GFX_evt_z_performance
	is_triggered_only = yes
	option = {
		name = z_performance.111.a
		hidden_effect = {
			set_variable = { which = z_galaxy_pop_num_var value = 0 }
			country_event = { id = z_performance.11 }
		}
	}
	#_退回z_modmenu
	option = {
		name = z_performance.11.g
		custom_tooltip = z_performance.11.g.tooltip
		hidden_effect = {
			country_event = { id = z_modmenu.1 }
		}
	}
	#_关闭设置
	option = {
		name = z_performance.11.h
		custom_tooltip = z_performance.11.h.tooltip
	}
}



#_always	[26/26]/1月
event = {
	id = z_performance.1
	hide_window = yes
	is_triggered_only = yes
	
	trigger = {
		has_global_flag = z_performance_always
	}
	
	immediate = {
		set_timed_global_flag = { flag = z_allow_job_check1 days = 4 }
		set_timed_global_flag = { flag = z_allow_job_check2 days = 30 }
	}
}
#_high	[3/5]/1月
event = {
	id = z_performance.2
	hide_window = yes
	is_triggered_only = yes
	
	trigger = {
		has_global_flag = z_performance_high
	}
	
	immediate = {
		set_timed_global_flag = { flag = z_allow_job_check1 days = 22 }
		set_timed_global_flag = { flag = z_allow_job_check2 days = 25 }
	}
}
#_mid	[1/3]/1月
event = {
	id = z_performance.3
	hide_window = yes
	is_triggered_only = yes
	
	trigger = {
		has_global_flag = z_performance_mid
	}
	
	immediate = {
		set_timed_global_flag = { flag = z_allow_job_check1 days = 26 }
		set_timed_global_flag = { flag = z_allow_job_check2 days = 27 }
	}
}
#_low	[1/3]/2月
event = {
	id = z_performance.4
	hide_window = yes
	is_triggered_only = yes
	
	trigger = {
		NOT = { has_global_flag = z_allow_job_check2 }
		has_global_flag = z_performance_low
	}
	
	immediate = {
		set_timed_global_flag = { flag = z_allow_job_check1 days = 56 }
		set_timed_global_flag = { flag = z_allow_job_check2 days = 57 }
	}
}
#_never	[0/3]/2月
event = {
	id = z_performance.5
	hide_window = yes
	is_triggered_only = yes
	
	trigger = {
		NOT = { has_global_flag = z_allow_job_check2 }
		has_global_flag = z_performance_never
	}
	
	immediate = {
		set_timed_global_flag = { flag = z_allow_job_check1 days = 57 }
		set_timed_global_flag = { flag = z_allow_job_check2 days = 57 }
	}
}



#_23日手动检测
country_event = {
	id = z_performance.6
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		set_timed_global_flag = { flag = z_manual_job_check days = 23 }
	}
}



#_中期事件 高频率转中频率
event = {
	id = z_performance.7
	hide_window = yes
	is_triggered_only = yes
	fire_only_once = yes
	trigger = { mid_game_years_passed >= -1 }
	
	immediate = {
		if = {
			limit = {
				NOR = {
					has_global_flag = z_performance_mid
					has_global_flag = z_performance_low
					has_global_flag = z_performance_never
				}
			}
		}
		remove_global_flag = z_performance_always
		remove_global_flag = z_performance_high
		set_global_flag = z_performance_mid
	}
}