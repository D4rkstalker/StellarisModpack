namespace = outbreak_evt
country_event = {
	#disease detected
	id = outbreak_evt.0001
	hide_window = no
	is_triggered_only = yes
	show_sound = unrest_alert
	title = "outbreak_start"
	picture = GFX_evt_galactic_senate
	desc = "outbreak_start_desc"
	location = event_target:virus_outbreak_planet
	immediate = {
		random_owned_planet = {
			limit = {
				has_modifier = pandemic_lesser
			}
			save_event_target_as = virus_outbreak_planet
		}
	}
	option = {
		name = UNFORTUNATE
		hidden_effect = {
			country_event = {
				id = outbreak_evt.0002
				days = 300
			}
		}
	}
}

country_event = {
	#disease worsens + spread begins explosively
	id = outbreak_evt.0002
	hide_window = no
	is_triggered_only = yes
	show_sound = unrest_alert
	location = event_target:virus_outbreak_planet
	title = "outbreak_worsens"
	picture = GFX_evt_galactic_senate
	desc = "outbreak_worsens_desc"
	immediate = {
		event_target:virus_outbreak_planet = {
			remove_modifier = pandemic_lesser
			add_modifier = {
				modifier = pandemic_Greater
				days = 3600
			}
		}
	}
	trigger = {
		NOT = {
			has_country_flag = virus_vaccine
		}
		OR = {
			any_owned_planet = {
				has_modifier = pandemic_lesser
			}
			any_owned_planet = {
				has_modifier = pandemic_Greater
			}
		}
		any_owned_planet = {
			NOT = {
				has_modifier = pandemic_lesser
			}
			NOT = {
				has_modifier = pandemic_Greater
			}
		}
	}
	option = {
		name = UNFORTUNATE
		hidden_effect = {
			random_list = {
				50 = {
					#Spreads twice,each spread triggers the secondary spread event
					random_owned_planet = {
						limit = {
							NOR = {
								has_modifier = pandemic_lesser
								has_modifier = pandemic_Greater
								has_planet_flag = virus_targeted
							}
						}
						set_timed_planet_flag = {
							flag = virus_targeted
							days = 2
						}
					}
					add_modifier = {
						modifier = pandemic_lesser
						days = 300
					}
					save_event_target_as = virus_spread_one
					planet_event = {
						id = outbreak_evt.1000
					}
					random_owned_planet = {
						limit = {
							NOR = {
								has_modifier = pandemic_lesser
								has_modifier = pandemic_Greater
							}
						}
						add_modifier = {
							modifier = pandemic_lesser
							days = 360
						}
						save_event_target_as = virus_spread_two
						planet_event = {
							id = outbreak_evt.1000
							days = 320
						}
					}
				}
				30 = {
					#Spreads thrice,each spread triggers the secondary spread event
					random_owned_planet = {
						limit = {
							NOR = {
								has_modifier = pandemic_lesser
								has_modifier = pandemic_Greater
								has_planet_flag = virus_targeted
							}
						}
						set_timed_planet_flag = {
							flag = virus_targeted
							days = 2
						}
						add_modifier = {
							modifier = pandemic_lesser
							days = 360
						}
						save_event_target_as = virus_spread_one
						planet_event = {
							id = outbreak_evt.1000
							days = 300
						}
					}
					random_owned_planet = {
						limit = {
							NOR = {
								has_modifier = pandemic_lesser
								has_modifier = pandemic_Greater
								has_planet_flag = virus_targeted
							}
						}
						set_timed_planet_flag = {
							flag = virus_targeted
							days = 2
						}
						add_modifier = {
							modifier = pandemic_lesser
							days = 360
						}
						save_event_target_as = virus_spread_two
						planet_event = {
							id = outbreak_evt.1000
							days = 320
						}
					}
					random_owned_planet = {
						limit = {
							NOR = {
								has_modifier = pandemic_lesser
								has_modifier = pandemic_Greater
								has_planet_flag = virus_targeted
							}
						}
						set_timed_planet_flag = {
							flag = virus_targeted
							days = 2
						}
						add_modifier = {
							modifier = pandemic_lesser
							days = 360
						}
						save_event_target_as = virus_spread_three
						planet_event = {
							id = outbreak_evt.1000
							days = 340
						}
					}
				}
				20 = {
					#Spreads 4 times,each spread triggers the secondary spread event
					random_owned_planet = {
						limit = {
							NOR = {
								has_modifier = pandemic_lesser
								has_modifier = pandemic_Greater
								has_planet_flag = virus_targeted
							}
						}
						set_timed_planet_flag = {
							flag = virus_targeted
							days = 2
						}
						add_modifier = {
							modifier = pandemic_lesser
							days = 360
						}
						save_event_target_as = virus_spread_one
						planet_event = {
							id = outbreak_evt.1000
							days = 300
						}
					}
					random_owned_planet = {
						limit = {
							NOR = {
								has_modifier = pandemic_lesser
								has_modifier = pandemic_Greater
								has_planet_flag = virus_targeted
							}
						}
						set_timed_planet_flag = {
							flag = virus_targeted
							days = 2
						}
						add_modifier = {
							modifier = pandemic_lesser
							days = 360
						}
						save_event_target_as = virus_spread_two
						planet_event = {
							id = outbreak_evt.1000
							days = 320
						}
					}
					random_owned_planet = {
						limit = {
							NOR = {
								has_modifier = pandemic_lesser
								has_modifier = pandemic_Greater
								has_planet_flag = virus_targeted
							}
						}
						set_timed_planet_flag = {
							flag = virus_targeted
							days = 2
						}
						add_modifier = {
							modifier = pandemic_lesser
							days = 360
						}
						save_event_target_as = virus_spread_three
						planet_event = {
							id = outbreak_evt.1000
							days = 340
						}
					}
					random_owned_planet = {
						limit = {
							NOR = {
								has_modifier = pandemic_lesser
								has_modifier = pandemic_Greater
								has_planet_flag = virus_targeted
							}
						}
						set_timed_planet_flag = {
							flag = virus_targeted
							days = 2
						}
						add_modifier = {
							modifier = pandemic_lesser
							days = 360
						}
						save_event_target_as = virus_spread_four
						planet_event = {
							id = outbreak_evt.1000
							days = 360
						}
					}
				}
			}
		}
	}
}

planet_event = {
	#secondary infection of new planets
	id = outbreak_evt.1000
	hide_window = no
	location = from
	show_sound = unrest_alert
	is_triggered_only = yes
	title = "outbreak_planet"
	picture = GFX_evt_galactic_senate
	desc = "outbreak_planet_desc"
	trigger = {
		NOT = {
			has_country_flag = virus_vaccine
		}
	}
	immediate = {
		save_event_target_as = infected_planet
		remove_modifier = pandemic_lesser
		add_modifier = {
			modifier = pandemic_Greater
			days = 3600
		}
		random_list = {
			20 = {
				random_neighbor_country = {
					limit = {
						is_galactic_emperor = no
						is_country_type = default
						is_machine_empire = no
						is_synthetic_empire = no
						any_owned_planet = {
							NOR = {
								has_modifier = pandemic_lesser
								has_modifier = pandemic_Greater
								has_planet_flag = virus_targeted
							}
						}
					}
					random_list = {
						50 = {
							random_owned_planet = {
								add_modifier = {
									modifier = pandemic_lesser
								}
								country_event = {
									id = outbreak_evt.0001
								}
							}
						}
						50 = {
						}
					}
				}
			}
			50 = {
			}
			30 = {
				random_owned_planet = {
					limit = {
						NOR = {
							has_modifier = pandemic_lesser
							has_modifier = pandemic_Greater
							has_planet_flag = virus_targeted
						}
					}
					set_timed_planet_flag = {
						flag = virus_targeted
						days = 2
					}
					add_modifier = {
						modifier = pandemic_lesser
						days = 360
					}
					save_event_target_as = virus_spread_one
					planet_event = {
						id = outbreak_evt.1000
						days = 300
					}
				}
				random_neighbor_country = {
					limit = {
						is_country_type = default
						is_machine_empire = no
						is_synthetic_empire = no
						is_galactic_emperor = no
						any_owned_planet = {
							NOR = {
								has_modifier = pandemic_lesser
								has_modifier = pandemic_Greater
								has_planet_flag = virus_targeted
							}
						}
					}
					random_list = {
						50 = {
							random_owned_planet = {
								add_modifier = {
									modifier = pandemic_lesser
								}
								country_event = {
									id = outbreak_evt.0001
								}
							}
						}
						50 = {
						}
					}
				}
			}
		}
	}
	option = {
		name = ACKNOWLEDGED
	}
}

country_event = {
	#trigger failsafe
	id = outbreak_evt.1100
	hide_window = yes
	location = from
	show_sound = unrest_alert
	is_triggered_only = yes
	picture = GFX_evt_galactic_senate
	immediate = {
		every_playable_country = {
			country_event = {
				id = outbreak_evt.1101
			}
		}
	}
}

country_event = {
	#failsafe
	id = outbreak_evt.1101
	hide_window = no
	show_sound = event_psionic
	is_triggered_only = yes
	picture = GFX_evt_civil_action
	title = "outbreak_failsafe"
	desc = "outbreak_failsafe_desc"
	trigger = {
		any_owned_planet = {
			has_modifier = pandemic_lesser
			has_modifier = pandemic_Greater
			has_planet_flag = virus_targeted
		}
	}
	immediate = {
		every_owned_planet = {
			remove_modifier = pandemic_lesser
			remove_modifier = pandemic_Greater
		}
		set_timed_country_flag = {
			flag = virus_vaccine
			days = 4800
		}
	}
	option = {
		name = WORRYING
	}
}

country_event = {
	#lableak
	id = outbreak_evt.1111
	hide_window = no
	show_sound = event_psionic
	is_triggered_only = yes
	picture = GFX_evt_civil_action
	title = "outbreak_lableak"
	desc = "outbreak_lableak_desc"
	trigger = {
	}
	immediate = {
		every_owned_planet = {
			remove_modifier = pandemic_lesser
			remove_modifier = pandemic_Greater
		}
		set_timed_country_flag = {
			flag = virus_vaccine
			days = 4800
		}
	}
	option = {
		trigger = {
			is_galactic_emperor = no
		}
		name = WORRYING
	}
	option = {
		add_resource = {
			influence = -150
		}
		add_imperial_authority = -15
		trigger = {
			is_galactic_emperor = yes
		}
		name = "lableak_response"
		if = {
			limit = {
				NOT ={ has_modifier = humiliated }
			}
			add_modifier = {
				modifier = humiliated
				days = 3600
			}
		}
		}
	}
