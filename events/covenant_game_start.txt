namespace = covenant_game_start
@reckoning_time = 18000


country_event = {
    id = covenant_game_start.1
    hide_window = yes
    is_triggered_only = yes

    trigger = {
        is_country_type = default
    }

    immediate = {
        log = "Fired covenant_game_start.1"
        switch = {
            trigger = has_origin
            origin_instrument_covenant = {
                add_modifier = {modifier=covenant_instrument_of_desire days = -1}
                set_country_flag = has_shroud_patron
            }
            origin_eater_covenant = {
                add_modifier = {modifier=covenant_eater_of_worlds days = -1}
                set_country_flag = has_shroud_patron
            }
            origin_whisperers_covenant = {
                add_modifier = {modifier = covenant_whisperers_in_the_void days = -1}
                set_country_flag = has_shroud_patron
            }
            origin_composer_covenant = {
                add_modifier = {modifier = covenant_composer_of_strands days = -1}
                set_country_flag = has_shroud_patron
            }
            origin_end_covenant = {#This one's a bit more complicated
                set_global_flag = end_of_the_cycle
                add_modifier = { modifier = covenant_end_of_the_cycle days = @reckoning_time}
                set_country_flag = has_shroud_patron
                set_country_flag = covenant_end_of_the_cycle
			    every_owned_planet = {
				    limit = { NOT = { has_modifier = covenant_shroud_marked } }
				    add_modifier = { modifier = covenant_shroud_marked days = -1 }
			    }
                begin_event_chain = {
                    event_chain = "cycle_sacrifices_chain"
                    target = this
                }
                country_event = { id = covenant_events.3 days = @reckoning_time }
            }
            default = {
                log = "No covenant detected"
            }
        }
    }
}