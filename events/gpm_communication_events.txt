namespace = gpm_com


# Triggered when two empires discover each other
# This = Empire 1
# From = Empire 2
# Fromfromfrom = System where contact occurred


### Meet fallen empire as lost FE colony civic start
country_event = {
	id = gpm_com.1
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		FROM = {
			is_country_type = default
			exists = ruler
			ruler = {
				species = {
					has_trait = "trait_gpm_high_status"
				}
			}
		}
		
		OR = {
			is_country_type = fallen_empire
			is_country_type = awakened_fallen_empire
		}
	}

	immediate = {
		add_opinion_modifier = {
			who = from
			modifier = opinion_respected_species
		}
	}
}

# message event to let empÃ®res know the other party has a relic - Empire 1
country_event = {
	id = gpm_com.2
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		OR = {
			FROM = {
				OR = {
					is_country_type = default
					is_country_type = fallen_empire
					is_country_type = awakened_fallen_empire
				}
				OR = {
					gpm_has_vanilla_precursor_relic = yes
					gpm_has_modded_precursor_relic = yes
					gpm_has_modded_non_precursor_relic = yes
				}
			}
			THIS = {
				OR = {
					is_country_type = default
					is_country_type = fallen_empire
					is_country_type = awakened_fallen_empire
				}
				OR = {
					gpm_has_vanilla_precursor_relic = yes
					gpm_has_modded_precursor_relic = yes
					gpm_has_modded_non_precursor_relic = yes
				}
			}
		}
	}

	immediate = {
		log = "Message event triggered gpm_com.2"
		log = "FROM = [from.GetName]"
		log = "Root = [root.GetName]"
		if = {
			limit = {
				FROM = {
					OR = {
						gpm_has_vanilla_precursor_relic = yes
						gpm_has_modded_precursor_relic = yes
						gpm_has_modded_non_precursor_relic = yes
					}
				}
			}
			root = {
				log = "[from.GetName] has relic -> [root.GetName] gets message"
				log = "FROM = [from.GetName]"
				log = "Root = [root.GetName]"
				create_message = {
					type = GPM_MESSAGE_NEIGHBOUR_RELIC_RUMOUR
					localization = GPM_MESSAGE_NEIGHBOUR_RELIC_RUMOUR_DESC
					days = 30
					target = FROM.capital_scope
					variable = {
						type = name
						localization = COUNTRY
						scope = FROM
					}
				}
			}
		}
		if = {
			limit = {
				root = {
					OR = {
						gpm_has_vanilla_precursor_relic = yes
						gpm_has_modded_precursor_relic = yes
						gpm_has_modded_non_precursor_relic = yes
					}
				}
			}
			FROM = {
				log = "[root.GetName] has relic -> [from.GetName] gets message"
				log = "FROM = [from.GetName]"
				log = "This = [this.GetName]"
				log = "Root = [root.GetName]"
				create_message = {
					type = GPM_MESSAGE_NEIGHBOUR_RELIC_RUMOUR
					localization = GPM_MESSAGE_NEIGHBOUR_RELIC_RUMOUR_DESC
					days = 30
					target = root.capital_scope
					variable = {
						type = name
						localization = COUNTRY
						scope = root
					}
				}
			}
		}
	}
}