namespace = pw_archaeology

## Archaeology: Drained Paradise. -> 100

# Stage 1 - Demetrius Cornucopia
fleet_event = {
	id = pw_archaeology.105
	title = pw_archaeology.105.name
	desc = pw_archaeology.105.desc
	picture = GFX_evt_pw_demetrius_cornucopia
	show_sound = event_ghost_town
	is_triggered_only = yes

	archaeology = yes

	immediate = {
		from = { set_site_progress_locked = yes }
	}

	after = {
		from = { set_site_progress_locked = no }
	}

	option = {
		name = CURIOUS
		small_artifact_reward = yes
	}
}

# Stage 2 - Helios Tower
fleet_event = {
	id = pw_archaeology.110
	title = pw_archaeology.110.name
	desc = pw_archaeology.110.desc
	picture = GFX_evt_pw_helios_tower
	show_sound = event_machinery

	archaeology = yes

	is_triggered_only = yes

	immediate = {
		from = { set_site_progress_locked = yes }
	}

	after = {
		from = { set_site_progress_locked = no }
	}

	option = {
		name = INTERESTING
		small_artifact_reward = yes
	}
}

# Stage 3 - Erebus Project
fleet_event = {
	id = pw_archaeology.115
	title = pw_archaeology.115.name
	desc = pw_archaeology.115.desc
	picture = GFX_evt_pw_erebus_project
	show_sound = event_drilling

	archaeology = yes

	is_triggered_only = yes

	immediate = {
		from = { set_site_progress_locked = yes }
	}

	after = {
		from = { set_site_progress_locked = no }
	}

	option = {
		name = pw_archaeology.115.a
		small_artifact_reward = yes
		allow = {
			owner = { resource_stockpile_compare = { resource = minerals value >= 1500 }}
		}
		owner = {
			add_resource = { minerals = -1500 }
		}
	}
}

# Stage 4 - Fixed planet surface
fleet_event = {
	id = pw_archaeology.120
	title = pw_archaeology.120.name
	desc = pw_archaeology.120.desc
	picture = GFX_evt_desert
	show_sound = event_mystic_reveal

	archaeology = yes

	is_triggered_only = yes

	immediate = {
		from = { set_site_progress_locked = yes }
	}

	after = {
		from = { set_site_progress_locked = no }
	}

	option = {
		name = CONTINUE
		small_artifact_reward = yes
		allow = {
			owner = { resource_stockpile_compare = { resource = energy value >= 1500 }}
		}
		owner = {
			add_resource = {
				energy = -1500
			}
			add_research_option = tech_terrestrial_sculpting
			add_tech_progress = {
				tech = tech_terrestrial_sculpting
				progress = 0.05
			}
		}
	}
}

# Stage 5 - Fixed planet atmosphere
fleet_event = {
	id = pw_archaeology.125
	title = pw_archaeology.125.name
	desc = pw_archaeology.125.desc
	picture = GFX_evt_ocean
	show_sound = event_solar_fusion

	archaeology = yes

	is_triggered_only = yes

	immediate = {
		from = { set_site_progress_locked = yes }
	}

	after = {
		from = { set_site_progress_locked = no }
	}

	option = {
		name = pw_archaeology.125.a
		small_artifact_reward = yes
		trigger = {
			owner = { country_uses_food = yes }
		}
		allow = {
			owner = { resource_stockpile_compare = { resource = food value >= 1500 }}
		}
		owner = {
			add_resource = {
				food = -1500
			}
			add_research_option = tech_ecological_adaptation
			add_tech_progress = {
				tech = tech_ecological_adaptation
				progress = 0.05
			}
		}
	}

	option = {
		name = pw_archaeology.125.b
		small_artifact_reward = yes
		trigger = {
			owner = { country_uses_food = no }
		}
		allow = {
			owner = { resource_stockpile_compare = { resource = energy value >= 1500 }}
		}
		owner = {
			add_resource = {
				energy = -1500
			}
			add_research_option = tech_ecological_adaptation
			add_tech_progress = {
				tech = tech_ecological_adaptation
				progress = 0.05
			}
		}
	}
}

# Stage 6 - Fixed planet ecosphere and restored Gaia
fleet_event = {
	id = pw_archaeology.130
	title = pw_archaeology.130.name
	desc = pw_archaeology.130.desc
	picture = GFX_evt_gaia
	show_sound = event_alien_nature

	archaeology = yes

	is_triggered_only = yes

	immediate = {
		from = { set_site_progress_locked = yes }
	}

	after = {
		from = { set_site_progress_locked = no }
	}

	option = {
		name = FANTASTIC
		small_artifact_reward = yes
		owner = {
			add_research_option = tech_climate_restoration
			add_tech_progress = {
				tech = tech_climate_restoration
				progress = 0.05
			}
		}
		from.planet = {
			change_pc = pc_gaia
			hidden_effect = {
				reroll_deposits = yes
				add_modifier = {
					modifier = pw_mod_gaia_unstable_weather
				}
			}
			add_deposit = pw_d_ancient_cornucopia
			add_deposit = pw_d_ancient_solar_tower
			add_deposit = pw_d_ancient_mining_project
		}
	}
}
