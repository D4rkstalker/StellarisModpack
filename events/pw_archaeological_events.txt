namespace = pw_archaeology

## Archaeology: Drained Paradise. -> 100

# Stage 1 - Demetrius Cornucopia
fleet_event = {
	id = pw_archaeology.105
	title = pw_archaeology.105.name
	desc = pw_archaeology.105.desc
	picture = GFX_evt_pw_demetrius_cornucopia
	show_sound = event_ghost_town
	is_triggered_only = yes

	archaeology = yes

	immediate = {
		from = { set_site_progress_locked = yes }
	}

	after = {
		from = { set_site_progress_locked = no }
	}

	option = {
		name = CURIOUS
		small_artifact_reward = yes
	}
}

# Stage 2 - Helios Tower
fleet_event = {
	id = pw_archaeology.110
	title = pw_archaeology.110.name
	desc = pw_archaeology.110.desc
	picture = GFX_evt_pw_helios_tower
	show_sound = event_machinery

	archaeology = yes

	is_triggered_only = yes

	immediate = {
		from = { set_site_progress_locked = yes }
	}

	after = {
		from = { set_site_progress_locked = no }
	}

	option = {
		name = INTERESTING
		small_artifact_reward = yes
	}
}

# Stage 3 - Erebus Project
fleet_event = {
	id = pw_archaeology.115
	title = pw_archaeology.115.name
	desc = pw_archaeology.115.desc
	picture = GFX_evt_pw_erebus_project
	show_sound = event_drilling

	archaeology = yes

	is_triggered_only = yes

	immediate = {
		from = { set_site_progress_locked = yes }
	}

	after = {
		from = { set_site_progress_locked = no }
	}

	option = {
		name = pw_archaeology.115.a
		small_artifact_reward = yes
		allow = {
			owner = { resource_stockpile_compare = { resource = minerals value >= 1500 }}
		}
		owner = {
			add_resource = { minerals = -1500 }
		}
	}
}

# Stage 4 - Fixed planet surface
fleet_event = {
	id = pw_archaeology.120
	title = pw_archaeology.120.name
	desc = pw_archaeology.120.desc
	picture = GFX_evt_desert
	show_sound = event_mystic_reveal

	archaeology = yes

	is_triggered_only = yes

	immediate = {
		from = { set_site_progress_locked = yes }
	}

	after = {
		from = { set_site_progress_locked = no }
	}

	option = {
		name = CONTINUE
		small_artifact_reward = yes
		allow = {
			owner = { resource_stockpile_compare = { resource = energy value >= 1500 }}
		}
		owner = {
			add_resource = {
				energy = -1500
			}
			add_research_option = tech_terrestrial_sculpting
			add_tech_progress = {
				tech = tech_terrestrial_sculpting
				progress = 0.05
			}
		}
	}
}

# Stage 5 - Fixed planet atmosphere
fleet_event = {
	id = pw_archaeology.125
	title = pw_archaeology.125.name
	desc = pw_archaeology.125.desc
	picture = GFX_evt_ocean
	show_sound = event_solar_fusion

	archaeology = yes

	is_triggered_only = yes

	immediate = {
		from = { set_site_progress_locked = yes }
	}

	after = {
		from = { set_site_progress_locked = no }
	}

	option = {
		name = pw_archaeology.125.a
		small_artifact_reward = yes
		trigger = {
			owner = { country_uses_food = yes }
		}
		allow = {
			owner = { resource_stockpile_compare = { resource = food value >= 1500 }}
		}
		owner = {
			add_resource = {
				food = -1500
			}
			add_research_option = tech_ecological_adaptation
			add_tech_progress = {
				tech = tech_ecological_adaptation
				progress = 0.05
			}
		}
	}

	option = {
		name = pw_archaeology.125.b
		small_artifact_reward = yes
		trigger = {
			owner = { country_uses_food = no }
		}
		allow = {
			owner = { resource_stockpile_compare = { resource = energy value >= 1500 }}
		}
		owner = {
			add_resource = {
				energy = -1500
			}
			add_research_option = tech_ecological_adaptation
			add_tech_progress = {
				tech = tech_ecological_adaptation
				progress = 0.05
			}
		}
	}
}

# Stage 6 - Fixed planet ecosphere and restored Gaia
fleet_event = {
	id = pw_archaeology.130
	title = pw_archaeology.130.name
	desc = pw_archaeology.130.desc
	picture = GFX_evt_gaia
	show_sound = event_alien_nature

	archaeology = yes

	is_triggered_only = yes

	immediate = {
		from = { set_site_progress_locked = yes }
	}

	after = {
		from = { set_site_progress_locked = no }
	}

	option = {
		name = FANTASTIC
		small_artifact_reward = yes
		owner = {
			add_research_option = tech_climate_restoration
			add_tech_progress = {
				tech = tech_climate_restoration
				progress = 0.05
			}
		}
		from.planet = {
			change_pc = pc_gaia
			hidden_effect = {
				reroll_deposits = yes
				add_modifier = {
					modifier = pw_mod_gaia_unstable_weather
				}
			}
			add_deposit = pw_d_ancient_cornucopia
			add_deposit = pw_d_ancient_solar_tower
			add_deposit = pw_d_ancient_mining_project
		}
	}
}


## Archaeology: Lunar Archive. -> 200

# Stage 1 - Particle Museum
fleet_event = {
	id = pw_archaeology.205
	title = pw_archaeology.205.name
	desc = pw_archaeology.205.desc
	picture = GFX_evt_physics_research
	show_sound = event_solar_fusion
	is_triggered_only = yes

	archaeology = yes

	immediate = {
		from = { set_site_progress_locked = yes }
	}

	after = {
		from = { set_site_progress_locked = no }
	}

	option = {
		name = CURIOUS
		small_artifact_reward = yes
		owner = {
			add_monthly_resource_mult = {
				resource = physics_research
				value = @tier3researchreward
				min = @tier3researchmin
				max = @tier3researchmax
			}
		}
	}
}

# Stage 2 - Library of Babel
fleet_event = {
	id = pw_archaeology.210
	title = pw_archaeology.210.name
	desc = pw_archaeology.210.desc
	picture = GFX_evt_resource_cache
	show_sound = event_laboratory_sound

	archaeology = yes

	is_triggered_only = yes

	immediate = {
		from = { set_site_progress_locked = yes }
	}

	after = {
		from = { set_site_progress_locked = no }
	}

	option = {
		name = INTERESTING
		small_artifact_reward = yes
		owner = {
			add_monthly_resource_mult = {
				resource = society_research
				value = @tier3researchreward
				min = @tier3researchmin
				max = @tier3researchmax
			}
		}
	}
}

# Stage 3 - Mechanist Collection
fleet_event = {
	id = pw_archaeology.215
	title = pw_archaeology.215.name
	desc = pw_archaeology.215.desc
	picture = GFX_evt_robot_assembly_plant
	show_sound = event_robot_encounter

	archaeology = yes

	is_triggered_only = yes

	immediate = {
		from = { set_site_progress_locked = yes }
	}

	after = {
		from = { set_site_progress_locked = no }
	}

	option = {
		name = INTERESTING
		small_artifact_reward = yes
		owner = {
			add_monthly_resource_mult = {
				resource = engineering_research
				value = @tier3researchreward
				min = @tier3researchmin
				max = @tier3researchmax
			}
		}
	}
}

# Stage 4 - Cradle Initiative
fleet_event = {
	id = pw_archaeology.220
	title = pw_archaeology.220.name
	desc = pw_archaeology.220.desc
	picture = GFX_evt_gaia
	show_sound = ui_queuing_terraforming

	archaeology = yes

	is_triggered_only = yes

	immediate = {
		from = { set_site_progress_locked = yes }
	}

	after = {
		from = { set_site_progress_locked = no }
	}

	option = {
		name = INTERESTING
		medium_artifact_reward = yes
		if = {
			limit = {
				from.planet.solar_system = {
					any_system_planet = {
						uninhabitable_regular_planet = yes
						NOT = { has_modifier = terraforming_candidate }
					}
				}
			}
			from.planet.solar_system = {
				random_system_planet = {
					add_modifier = {
						modifier = terraforming_candidate
					}
				}
			}
		}
		else = {
			owner = {
				add_monthly_resource_mult = {
					resource = society_research
					value = @tier3researchreward
					min = @tier3researchmin
					max = @tier3researchmax
				}
			}
		}
	}
}

# Stage 5 - Holoarchive
fleet_event = {
	id = pw_archaeology.225
	title = pw_archaeology.225.name
	desc = pw_archaeology.225.desc
	picture = GFX_evt_ancient_databank
	show_sound = event_mystic_reveal

	archaeology = yes

	is_triggered_only = yes

	immediate = {
		from = { set_site_progress_locked = yes }
	}

	after = {
		from = { set_site_progress_locked = no }
	}

	option = {
		name = FASCINATING
		medium_artifact_reward = yes
		from.planet = {
			add_modifier = { modifier = pw_pm_lunar_archive }
			add_deposit = d_physics_5
			add_deposit = d_society_5
			add_deposit = d_engineering_5
		}
		from.planet.orbit = {
			add_deposit = pw_d_lunar_archive
		}
		hidden_effect = {
			owner = {
				country_event = {
					id = pw_archaeology.230
					days = 30
					random = 30
				}
			}
		}
	}
}

#Add Grand Archive tech
country_event = {
	id = pw_archaeology.230
	title = pw_archaeology.230.name
	desc = pw_archaeology.230.desc
	picture = GFX_evt_ancient_databank
	is_triggered_only = yes

	trigger = {
		is_materialist = yes
		NOT = { has_technology = pw_tech_materialist_archiving }
	}

	#Add the tech
	option = {
		name = pw_archaeology.230.a
		if = {
			limit = { NOT = { has_tech_option = pw_tech_materialist_archiving } }
			add_research_option = pw_tech_materialist_archiving
			add_tech_progress = {
				tech = pw_tech_materialist_archiving
				progress = 0.10
			}
		}
		else = {
			add_tech_progress = {
				tech = pw_tech_materialist_archiving
				progress = 0.25
			}
		}
	}

	#No need for such thing
	option = {
		name = pw_archaeology.230.b
		add_monthly_resource_mult = {
			resource = influence
			value = @tier2influencereward
			min = @tier2influencemin
			max = @tier2influencemax
		}
	}
}

## Archaeology: Lunar Archive. -> 300

# Stage 1 - Leviathan Description
fleet_event = {
	id = pw_archaeology.305
	title = pw_archaeology.305.name
	desc = pw_archaeology.305.desc
	picture = GFX_evt_bone_building
	show_sound = event_big_door_opening
	is_triggered_only = yes

	archaeology = yes

	immediate = {
		from = { set_site_progress_locked = yes }
	}

	after = {
		from = { set_site_progress_locked = no }
	}

	option = {
		name = CURIOUS
		small_artifact_reward = yes
	}
}

# Stage 2 - Codex of the Ages
fleet_event = {
	id = pw_archaeology.310
	title = pw_archaeology.310.name
	desc = pw_archaeology.310.desc
	picture = GFX_evt_pw_codex_of_the_ages
	show_sound = event_mystic_reveal

	archaeology = yes

	is_triggered_only = yes

	immediate = {
		from = { set_site_progress_locked = yes }
	}

	after = {
		from = { set_site_progress_locked = no }
	}

	option = {
		name = pw_archaeology.310.a
		small_artifact_reward = yes
		hidden_effect = {
			random_list = {
				40 = {
					modifier = {
						factor = 0
						is_gestalt = yes
					}
					fleet_event = {
						id = pw_archaeology.311
						days = 10
					}
				}
				60 = {
					fleet_event = {
						id = pw_archaeology.313
						days = 10
					}
				}
			}
		}
	}

	option = {
		name = pw_archaeology.310.b
		small_artifact_reward = yes
		hidden_effect = {
			random_list = {
				40 = {
					modifier = {
						factor = 0
						is_gestalt = yes
					}
					fleet_event = {
						id = pw_archaeology.312
						days = 10
					}
				}
				60 = {
					fleet_event = {
						id = pw_archaeology.313
						days = 10
					}
				}
			}
		}
	}

	option = {
		name = pw_archaeology.310.c
		small_artifact_reward = yes
		owner = {
			add_monthly_resource_mult = {
				resource = society_research
				value = @tier2researchreward
				min = @tier2researchmin
				max = @tier2researchmax
			}
		}
	}
}

#Stage 2 (option 1) - Knowledge of past ages
fleet_event = {
	id = pw_archaeology.311
	title = pw_archaeology.311.name
	desc = pw_archaeology.311.desc
	picture = GFX_evt_pw_codex_of_the_ages
	show_sound = event_mystic_reveal

	is_triggered_only = yes

	option = {
		name = pw_archaeology.311.a
		leader = {
			add_trait = pw_leader_trait_scientist_codex_of_past_ages
		}
	}
}

#Stage 2 (option 2) - Knowledge of future ages
fleet_event = {
	id = pw_archaeology.312
	title = pw_archaeology.312.name
	desc = pw_archaeology.312.desc
	picture = GFX_evt_pw_codex_of_the_ages
	show_sound = event_mystic_reveal

	is_triggered_only = yes

	option = {
		name = pw_archaeology.312.a
		owner = {
			add_random_research_option = {
				tier = 2
				add_progress = 0.15
				fail_effects = {
					add_random_research_option = {
						tier = 3
						add_progress = 0.10
						fail_effects = {
							add_random_research_option = {
								tier = 4
								add_progress = 0.05
								fail_effects = {
									add_monthly_resource_mult = {
										resource = society_research
										value = @tier3researchreward
										min = @tier3researchmin
										max = @tier3researchmax
									}
								}
							}
						}
					}
				}
			}
		}
	}
}

#Stage 2 (option 3 random) - Only unity
fleet_event = {
	id = pw_archaeology.313
	title = pw_archaeology.313.name
	desc = pw_archaeology.313.desc
	picture = GFX_evt_pw_codex_of_the_ages
	show_sound = event_mystic_reveal

	is_triggered_only = yes

	option = {
		name = pw_archaeology.313.a
		owner = {
			add_monthly_resource_mult = {
				resource = unity
				value = @tier2unityreward
				min = @tier2unitymin
				max = @tier2unitymax
			}
		}
	}
}

# Stage 3 - Stargazing Mirror
fleet_event = {
	id = pw_archaeology.315
	title = pw_archaeology.315.name
	desc = pw_archaeology.315.desc
	picture = GFX_evt_pw_stargazing_mirror
	show_sound = event_mystic_reveal

	archaeology = yes

	is_triggered_only = yes

	immediate = {
		from = { set_site_progress_locked = yes }
	}

	after = {
		from = { set_site_progress_locked = no }
	}

	option = {
		name = pw_archaeology.315.a
		small_artifact_reward = yes
		hidden_effect = {
			fleet_event = {
				id = pw_archaeology.316
				days = 10
			}
		}
	}

	option = {
		name = pw_archaeology.315.b
		small_artifact_reward = yes
		hidden_effect = {
			fleet_event = {
				id = pw_archaeology.317
				days = 10
			}
		}
	}

	option = {
		name = pw_archaeology.315.c
		small_artifact_reward = yes
		owner = {
			add_monthly_resource_mult = {
				resource = society_research
				value = @tier2researchreward
				min = @tier2researchmin
				max = @tier2researchmax
			}
		}
	}
}

#Stage 3 (option 1) - Introspective Gaze
fleet_event = {
	id = pw_archaeology.316
	title = pw_archaeology.316.name
	desc = pw_archaeology.316.desc
	picture = GFX_evt_pw_stargazing_mirror
	show_sound = event_mystic_reveal

	is_triggered_only = yes

	option = {
		name = pw_archaeology.316.a
		owner = {
			add_monthly_resource_mult = {
				resource = unity
				value = @tier3unityreward
				min = @tier3unitymin
				max = @tier3unitymax
			}
		}
	}
}

#Stage 3 (option 2) - Extrospective Gaze
fleet_event = {
	id = pw_archaeology.317
	title = pw_archaeology.317.name
	desc = pw_archaeology.317.desc
	picture = GFX_evt_pw_stargazing_mirror
	show_sound = event_mystic_reveal

	is_triggered_only = yes

	option = {
		name = pw_archaeology.317.a
		owner = {
			add_monthly_resource_mult = {
				resource = influence
				value = @tier2influencereward
				min = @tier2influencemin
				max = @tier2influencemax
			}
		}
	}
}

# Stage 4 - Heart of the Leviathan
fleet_event = {
	id = pw_archaeology.320
	title = pw_archaeology.320.name
	desc = pw_archaeology.320.desc
	picture = GFX_evt_surreal_visions
	show_sound = ui_queuing_terraforming

	archaeology = yes

	is_triggered_only = yes

	immediate = {
		from = { set_site_progress_locked = yes }
	}

	after = {
		from = { set_site_progress_locked = no }
	}

	option = {
		name = pw_archaeology.320.a
		medium_artifact_reward = yes
		owner = {
			add_modifier = {
				modifier = pw_holy_reliquary_heart_of_the_leviathan_preserved
			}
		}
		from.planet = {
			add_deposit = d_society_5
		}
		hidden_effect = {
			owner = {
				country_event = {
					id = pw_archaeology.330
					days = 30
					random = 30
				}
			}
		}
	}

	option = {
		name = pw_archaeology.320.b
		medium_artifact_reward = yes
		owner = {
			add_modifier = {
				modifier = pw_holy_reliquary_heart_of_the_leviathan_study
			}
		}
		hidden_effect = {
			owner = {
				country_event = {
					id = pw_archaeology.330
					days = 30
					random = 30
				}
			}
		}
	}
}

#Add Holy Reliquary
country_event = {
	id = pw_archaeology.330
	title = pw_archaeology.330.name
	desc = pw_archaeology.330.desc
	picture = GFX_evt_psionics
	is_triggered_only = yes

	trigger = {
		is_spiritualist = yes
		NOT = { has_technology = pw_tech_spiritual_artifacts_studies }
	}

	#Add the tech
	option = {
		name = pw_archaeology.330.a
		if = {
			limit = { NOT = { has_tech_option = pw_tech_spiritual_artifacts_studies } }
			add_research_option = pw_tech_spiritual_artifacts_studies
			add_tech_progress = {
				tech = pw_tech_spiritual_artifacts_studies
				progress = 0.10
			}
		}
		else = {
			add_tech_progress = {
				tech = pw_tech_spiritual_artifacts_studies
				progress = 0.25
			}
		}
	}

	#No need for such thing
	option = {
		name = pw_archaeology.330.b
		add_monthly_resource_mult = {
			resource = influence
			value = @tier2influencereward
			min = @tier2influencemin
			max = @tier2influencemax
		}
	}
}

## Archaeology: Translunar Network. -> 400

# Stage 1 - Tunnel Entrance
fleet_event = {
	id = pw_archaeology.405
	title = pw_archaeology.405.name
	desc = pw_archaeology.405.desc
	picture = GFX_evt_hidden_door
	show_sound = event_door_opening
	is_triggered_only = yes

	archaeology = yes

	immediate = {
		from = { set_site_progress_locked = yes }
	}

	after = {
		from = { set_site_progress_locked = no }
	}

	option = {
		name = CURIOUS
		small_artifact_reward = yes
	}
}

# Stage 2 - Species Analysis
fleet_event = {
	id = pw_archaeology.410
	title = pw_archaeology.410.name
	desc = pw_archaeology.410.desc
	picture = GFX_evt_scanning_remains
	show_sound = event_scanner

	archaeology = yes

	is_triggered_only = yes

	immediate = {
		from = { set_site_progress_locked = yes }
	}

	after = {
		from = { set_site_progress_locked = no }
	}

	option = {
		name = INTERESTING
		small_artifact_reward = yes
		owner = {
			add_monthly_resource_mult = {
				resource = society_research
				value = @tier3researchreward
				min = @tier3researchmin
				max = @tier3researchmax
			}
		}
	}
}

# Stage 3 - Living Spaces
fleet_event = {
	id = pw_archaeology.415
	title = pw_archaeology.415.name
	desc = pw_archaeology.415.desc
	picture = GFX_evt_derelict_interior
	show_sound = event_dig_site

	archaeology = yes

	is_triggered_only = yes

	immediate = {
		from = { set_site_progress_locked = yes }
	}

	after = {
		from = { set_site_progress_locked = no }
	}

	option = {
		name = pw_archaeology.415.a
		small_artifact_reward = yes
		owner = {
			add_monthly_resource_mult = {
				resource = engineering_research
				value = @tier3researchreward
				min = @tier3researchmin
				max = @tier3researchmax
			}
			add_monthly_resource_mult = {
				resource = unity
				value = @tier2unityreward
				min = @tier2unitymin
				max = @tier2unitymax
			}
		}
	}
}

# Stage 4 - Storage Area
fleet_event = {
	id = pw_archaeology.420
	title = pw_archaeology.420.name
	desc = pw_archaeology.420.desc
	picture = GFX_evt_resource_cache
	show_sound = event_finding_loot

	archaeology = yes

	is_triggered_only = yes

	immediate = {
		from = { set_site_progress_locked = yes }
	}

	after = {
		from = { set_site_progress_locked = no }
	}

	option = {
		name = INTERESTING
		small_artifact_reward = yes
		owner = {
			add_monthly_resource_mult = {
				resource = physics_research
				value = @tier3researchreward
				min = @tier3researchmin
				max = @tier3researchmax
			}
			add_monthly_resource_mult = {
				resource = minerals
				value = @tier3materialreward
				min = @tier3materialmin
				max = @tier3materialmax
			}
			add_resource = {
				rare_crystals = 200
				volatile_motes = 200
			}
		}
	}
}

# Stage 5 - Demise
fleet_event = {
	id = pw_archaeology.425
	title = pw_archaeology.425.name
	desc = pw_archaeology.425.desc
	picture = GFX_evt_worrying_signal
	show_sound = event_worrying_signal

	archaeology = yes

	is_triggered_only = yes

	immediate = {
		from = { set_site_progress_locked = yes }
	}

	after = {
		from = { set_site_progress_locked = no }
	}

	option = {
		name = FASCINATING
		medium_artifact_reward = yes
		from.planet = {
			add_deposit = d_minerals_7
			add_deposit = d_rare_crystals_1
			add_deposit = d_volatile_motes_1
		}
		owner = {
			add_monthly_resource_mult = {
				resource = unity
				value = @tier2unityreward
				min = @tier2unitymin
				max = @tier2unitymax
			}
		}
	}
}

#Add Transplanetary Logistics Network tech
country_event = {
	id = pw_archaeology.430
	title = pw_archaeology.430.name
	desc = pw_archaeology.430.desc
	picture = GFX_evt_city_planet
	is_triggered_only = yes

	trigger = {
		is_egalitarian = yes
		NOT = { has_technology = pw_tech_transplanetary_logistics }
	}

	#Add the tech
	option = {
		name = pw_archaeology.430.a
		if = {
			limit = { NOT = { has_tech_option = pw_tech_transplanetary_logistics } }
			add_research_option = pw_tech_transplanetary_logistics
			add_tech_progress = {
				tech = pw_tech_transplanetary_logistics
				progress = 0.10
			}
		}
		else = {
			add_tech_progress = {
				tech = pw_tech_transplanetary_logistics
				progress = 0.25
			}
		}
	}

	#No need for such thing
	option = {
		name = pw_archaeology.430.b
		add_monthly_resource_mult = {
			resource = influence
			value = @tier2influencereward
			min = @tier2influencemin
			max = @tier2influencemax
		}
	}
}
