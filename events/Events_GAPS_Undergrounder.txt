namespace = Events_GAPS_Undergrounder

country_event = {
	id = Events_GAPS_Undergrounder.1
	is_triggered_only = yes
	hide_window = yes

	trigger = {
		owner = { has_origin = Origin_GAPS_The_Undergrounder }
	}

	immediate = {
		set_country_flag = Flag_Identification_GAPS_I_Am_Undergrounders
		every_owned_planet = { 
			limit = { is_colony = yes }
			add_deposit = d_GAPS_Great_Dig
			add_deposit = d_GAPS_Great_Dig
			add_deposit = d_GAPS_Great_Dig
			add_deposit = d_GAPS_Great_Dig			
			change_variable = {
				which = "GAPS_Devestation_To_Add" 
				value = 12
			}
		}
	}
}



country_event = {
	id = Events_GAPS_Undergrounder.2
	title = Events_GAPS_Undergrounder.2.name
	desc = Events_GAPS_Undergrounder.2.desc
	picture = GFX_evt_unidentified_ship
	show_sound = megastructure_upgraded_01
	hide_window = no
	is_triggered_only = yes

	trigger = {
		owner = { has_origin = Origin_GAPS_Drone_Replicators }
		OR = {
			last_increased_tech = Tech_GAPS_Undergrounder_Great_Dig_1
			last_increased_tech = Tech_GAPS_Undergrounder_Great_Dig_2
			last_increased_tech = Tech_GAPS_Undergrounder_Great_Dig_3
			last_increased_tech = Tech_GAPS_Undergrounder_Great_Dig_4
			last_increased_tech = Tech_GAPS_Undergrounder_Great_Dig_5
		}
	}

	option = {
		name = "Events_GAPS_Undergrounder.Buildings"
		custom_tooltip = "Events_GAPS_Undergrounder.Buildings.Tooltip"
		hidden_effect = {
			set_country_flag = Flag_Country_GAPS_Undergrounder_Buildings
		}
		trigger = {
			NOT = { has_country_flag = Flag_Country_GAPS_Undergrounder_Buildings }
		}
		ai_chance = {
			factor = 20
		}
	}

	option = {
		name = "Events_GAPS_Undergrounder.Districts"
		custom_tooltip = "Events_GAPS_Undergrounder.Districts.Tooltip"
		hidden_effect = {
			set_country_flag = Flag_Country_GAPS_Undergrounder_Districts
		}
		trigger = {
			NOT = { has_country_flag = Flag_Country_GAPS_Undergrounder_Districts }
		}
		ai_chance = {
			factor = 20
		}
	}

	option = {
		name = "Events_GAPS_Undergrounder.Demotion"
		custom_tooltip = "Events_GAPS_Undergrounder.Demotion.Tooltip"
		hidden_effect = {
			set_country_flag = Flag_Country_GAPS_Undergrounder_Demotion
		}
		trigger = {
			NOT = { has_country_flag = Flag_Country_GAPS_Undergrounder_Demotion }
		}
		ai_chance = {
			factor = 20
		}
	}

	option = {
		name = "Events_GAPS_Undergrounder.Habitability"
		custom_tooltip = "Events_GAPS_Undergrounder.Habitability.Tooltip"
		hidden_effect = {
			set_country_flag = Flag_Country_GAPS_Undergrounder_Habitability
		}
		trigger = {
			NOT = { has_country_flag = Flag_Country_GAPS_Undergrounder_Habitability }
		}
		ai_chance = {
			factor = 20
		}
	}

	option = {
		name = "Events_GAPS_Undergrounder.Growth"
		custom_tooltip = "Events_GAPS_Undergrounder.Growth.Tooltip"
		hidden_effect = {
			set_country_flag = Flag_Country_GAPS_Undergrounder_Growth
		}
		trigger = {
			NOT = { has_country_flag = Flag_Country_GAPS_Undergrounder_Growth }
		}
		ai_chance = {
			factor = 20
		}
	}
}
planet_event = {
	id = Events_GAPS_Undergrounder.3
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		while = { 
			count = GAPS_Devestation_To_Add 
			add_planet_devastation = 1
		}
	}
}
# 
#last_district_changed - Checks if the last district queued/unqueued/built/demolished/upgraded was the specified district
#On District queued built
# This = Planet
planet_event = {
	id = Events_GAPS_Undergrounder.41
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		OR = {
			last_district_changed = district_GAPS_Underground_Mines
			last_district_changed = district_GAPS_Underground_Generator
			last_district_changed = district_GAPS_Underground_City
			last_district_changed = district_GAPS_Underground_Farming
		}
	}
	immediate = {
		if = {
			limit = { last_district_changed = district_GAPS_Underground_Mines }
			this = { add_deposit = d_GAPS_Underground_District_Mine }
		}
		else_if = {
			limit = { last_district_changed = district_GAPS_Underground_Generator }
			this = { add_deposit = d_GAPS_Underground_District_Generator }
		}
		else_if = {
			limit = { last_district_changed = district_GAPS_Underground_City }
			this = { add_deposit = d_GAPS_Underground_District_City }
		}
		else_if = {
			limit = { last_district_changed = district_GAPS_Underground_Farming }
			this = { add_deposit = d_GAPS_Underground_District_Farm }
		}
	}
}
#last_district_changed - Checks if the last district queued/unqueued/built/demolished/upgraded was the specified district
#On District unqueued demolished
# This = Planet
planet_event = {
	id = Events_GAPS_Undergrounder.42
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		OR = {
			last_district_changed = district_GAPS_Underground_Mines
			last_district_changed = district_GAPS_Underground_Generator
			last_district_changed = district_GAPS_Underground_City
			last_district_changed = district_GAPS_Underground_Farming
		}
	}
	immediate = {
		if = {
			limit = { last_district_changed = district_GAPS_Underground_Mines }
			this = { remove_deposit = d_GAPS_Underground_District_Mine }
		}
		else_if = {
			limit = { last_district_changed = district_GAPS_Underground_Generator }
			this = { remove_deposit = d_GAPS_Underground_District_Generator }
		}
		else_if = {
			limit = { last_district_changed = district_GAPS_Underground_City }
			this = { remove_deposit = d_GAPS_Underground_District_City }
		}
		else_if = {
			limit = { last_district_changed = district_GAPS_Underground_Farming }
			this = { remove_deposit = d_GAPS_Underground_District_Farm }
		}
	}
}
country_event = {
	id = Events_GAPS_Undergrounder.71
	title = Events_GAPS_Undergrounder.71.name
	desc = Events_GAPS_Undergrounder.71.desc
	picture = GFX_evt_unidentified_ship
	show_sound = megastructure_upgraded_01
	hide_window = no
	is_triggered_only = yes

	immediate = {
		set_country_flag = Flag_Country_GAPS_Undergrounder_Studied_Subterraneans
	}
}
country_event = {
	id = Events_GAPS_Undergrounder.72
	title = Events_GAPS_Undergrounder.72.name
	desc = Events_GAPS_Undergrounder.72.desc
	picture = GFX_evt_unidentified_ship
	show_sound = megastructure_upgraded_01
	hide_window = no
	is_triggered_only = yes

	immediate = {
		set_country_flag = Flag_Country_GAPS_Undergrounder_Studied_Cave_Shrooms
	}
}
country_event = {
	id = Events_GAPS_Undergrounder.73
	title = Events_GAPS_Undergrounder.73.name
	desc = Events_GAPS_Undergrounder.73.desc
	picture = GFX_evt_unidentified_ship
	show_sound = megastructure_upgraded_01
	hide_window = no
	is_triggered_only = yes

	immediate = {
		set_country_flag = Flag_Country_GAPS_Undergrounder_Studied_Cave_Shrooms
	}
}
country_event = {
	id = Events_GAPS_Undergrounder.74
	title = Events_GAPS_Undergrounder.74.name
	desc = Events_GAPS_Undergrounder.74.desc
	picture = GFX_evt_unidentified_ship
	show_sound = megastructure_upgraded_01
	hide_window = no
	is_triggered_only = yes

	immediate = {
		set_country_flag = Flag_Country_GAPS_Undergrounder_Studied_Mining_Tunnels_Relic
	}
}