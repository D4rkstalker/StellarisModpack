#############################################
# Genesis
#############################################
namespace = nep_genesis
ship_event = {
	id = nep_genesis.1
	hide_window = yes
	
	is_triggered_only = yes
	
	fire_only_once = yes
	
	immediate = {
		set_global_flag = nep_genesis_spawn
	}
}
#############################################
# White Goo Crisis
# Idea by Kertheon
#############################################
namespace = nep_whitegoo

event = {
	id = nep_whitegoo.1000
	hide_window = yes
	
	trigger = {
		has_global_flag = nep_whitegoo_can_spawn
		NOT = { has_global_flag = nep_whitegoo_spawn }
		if = {
			limit = { has_global_flag = nep_whitegoo_midgame }
			mid_game_years_passed >= 0
		}
		else_if = {
			limit = { has_global_flag = nep_whitegoo_2300 }
			years_passed >= 100
		}
		else_if = {
			limit = { has_global_flag = nep_whitegoo_2200 }
			always = yes
		}
		else_if = {
			limit = { has_global_flag = nep_whitegoo_2250 }
			years_passed >= 50
		}
		else_if = {
			limit = { has_global_flag = nep_whitegoo_2350 }
			years_passed >= 150
		}
		else_if = {
			limit = { has_global_flag = nep_whitegoo_endgame }
			end_game_years_passed > 0
		}
		else_if = {
			limit = { has_global_flag = nep_whitegoo_2400 }
			years_passed >= 200
		}
	}
	
	is_triggered_only = yes
	
	immediate = {
		switch = {	
			trigger = has_global_flag
			nep_whitegoo_15 = {
				random_list = {
					1 = { 
						event_target:global_event_country = { country_event = { id = nep_whitegoo.1 days = 5 random = 355 } }
					}
					14 = { break = yes }
				}
			}
			nep_whitegoo_40 = {
				random_list = {
					1 = { 
						event_target:global_event_country = { country_event = { id = nep_whitegoo.1 days = 5 random = 355 } }
					}
					39 = { break = yes }
				}
			}
			nep_whitegoo_110 = {
				random_list = {
					1 = { 
						event_target:global_event_country = { country_event = { id = nep_whitegoo.1 days = 5 random = 355 } }
					}
					109 = { break = yes }
				}
			}
			nep_whitegoo_225 = {
				random_list = {
					1 = { 
						event_target:global_event_country = { country_event = { id = nep_whitegoo.1 days = 5 random = 355 } }
					}
					224 = { break = yes }
				}
			}
			nep_whitegoo_470 = {
				random_list = {
					1 = { 
						event_target:global_event_country = { country_event = { id = nep_whitegoo.1 days = 5 random = 355 } }
					}
					469 = { break = yes }
				}
			}
			nep_whitegoo_1105 = {
				random_list = {
					1 = { 
						event_target:global_event_country = { country_event = { id = nep_whitegoo.1 days = 5 random = 355 } }
					}
					1104 = { break = yes }
				}
			}
		}
	}
}
	

country_event = {
	id = nep_whitegoo.1
	hide_window = yes
	
	fire_only_once = yes
	
	is_triggered_only = yes
	
	immediate = {
		set_global_flag = nep_whitegoo_spawn
		set_global_flag = nep_whitegoo_begin
		random_system = {
			limit = {
				is_rim_system = no
				nep_st_is_not_outer_or_fe_system = yes
				NOR = {
					has_star_flag = empire_home_system
					has_star_flag = empire_cluster
					has_star_flag = hostile_system
					has_star_flag = guardian
				}			
				any_neighbor_system = {
					is_rim_system = no
					nep_st_is_not_outer_or_fe_system = yes
					NOR = {
						has_star_flag = empire_home_system
						has_star_flag = empire_cluster
					}
				}
			}
			save_global_event_target_as = nep_whitegoo_system_1
			#log = "nep_white_goo_1:[this.GetName]"
			nep_whitegoo_1 = yes
		}
		random_system = {
			limit = {
				is_rim_system = no
				nep_st_is_not_outer_or_fe_system = yes
				NOR = {
					has_star_flag = empire_home_system
					has_star_flag = empire_cluster
					has_star_flag = hostile_system
					has_star_flag = guardian
				}			
				any_neighbor_system = {
					is_rim_system = no
					nep_st_is_not_outer_or_fe_system = yes
					NOR = {
						has_star_flag = empire_home_system
						has_star_flag = empire_cluster
					}
				}
				distance = {
					source = event_target:nep_whitegoo_system_1
					min_jumps = 10
					max_jumps = 100
				}
			}
			save_global_event_target_as = nep_whitegoo_system_2
			#log = "nep_white_goo_2:[this.GetName]"
			nep_whitegoo_1 = yes
		}
		random_system = {
			limit = {
				is_rim_system = no
				nep_st_is_not_outer_or_fe_system = yes
				NOR = {
					has_star_flag = empire_home_system
					has_star_flag = empire_cluster
					has_star_flag = hostile_system
					has_star_flag = guardian
				}			
				any_neighbor_system = {
					is_rim_system = no
					nep_st_is_not_outer_or_fe_system = yes
					NOR = {
						has_star_flag = empire_home_system
						has_star_flag = empire_cluster
					}
				}
				distance = {
					source = event_target:nep_whitegoo_system_1
					min_jumps = 10
					max_jumps = 100
				}
				distance = {
					source = event_target:nep_whitegoo_system_2
					min_jumps = 10
					max_jumps = 100
				}
			}
			save_global_event_target_as = nep_whitegoo_system_3
			#log = "nep_white_goo_3:[this.GetName]"
			nep_whitegoo_1 = yes
		}
		add_global_ship_design = "NAME_nep_station_whitegoo"
		country_event = { id = nep_whitegoo.2 days = 30 random = 3 }
		country_event = { id = nep_whitegoo.3 days = 720 random = 100 }
		country_event = { id = nep_whitegoo.4 days = 1560 random = 120 }
	}
}

country_event = {
	id = nep_whitegoo.2
	hide_window = yes
	
	is_triggered_only = yes
	
	trigger = {
		has_global_flag = nep_whitegoo_begin
		is_same_value = event_target:global_event_country
	}
	
	immediate = {
		#log = "fire wg.2 root:[Root.GetName]"
		every_system = {
			limit = {
				NOR = {
					has_star_flag = nep_whitegoo_1
					has_star_flag = nep_whitegoo_no_effect
				}
				any_neighbor_system = {
					has_star_flag = nep_whitegoo_1
				}
			}
			nep_whitegoo_1 = yes
		}
		country_event = { id = nep_whitegoo.2 days = 30 random = 3 }
	}
}

country_event = {
	id = nep_whitegoo.3
	hide_window = yes
	
	is_triggered_only = yes
	
	trigger = {
		has_global_flag = nep_whitegoo_begin
		is_same_value = event_target:global_event_country
	}
	immediate = {
		#log = "fire wg.3 root:[Root.GetName]"
		event_target:nep_whitegoo_system_1 = {
			nep_whitegoo_2 = yes
		}
		event_target:nep_whitegoo_system_2 = {
			nep_whitegoo_2 = yes
		}
		event_target:nep_whitegoo_system_3 = {
			nep_whitegoo_2 = yes
		}
		country_event = { id = nep_whitegoo.31 days = 30 random = 3 }
	}
}

country_event = {
	id = nep_whitegoo.31
	hide_window = yes
	
	is_triggered_only = yes
	
	trigger = {
		has_global_flag = nep_whitegoo_begin
		is_same_value = event_target:global_event_country
	}
	
	immediate = {
		#log = "fire wg.31 root:[Root.GetName]"
		every_system = {
			limit = {
				has_star_flag = nep_whitegoo_1
				NOR = {
					has_star_flag = nep_whitegoo_2
					has_star_flag = nep_whitegoo_no_effect
				}
				any_neighbor_system = {
					has_star_flag = nep_whitegoo_2
				}
			}
			nep_whitegoo_2 = yes
		}
		country_event = { id = nep_whitegoo.31 days = 30 random = 3 }
	}
}

country_event = {
	id = nep_whitegoo.4
	hide_window = yes
	
	is_triggered_only = yes
	
	trigger = {
		has_global_flag = nep_whitegoo_begin
		is_same_value = event_target:global_event_country
	}
	immediate = {		
		#log = "fire wg.4 root:[Root.GetName]"
		event_target:nep_whitegoo_system_1 = {
			nep_whitegoo_3 = yes
		}
		event_target:nep_whitegoo_system_2 = {
			nep_whitegoo_3 = yes
		}
		event_target:nep_whitegoo_system_3 = {
			nep_whitegoo_3 = yes
		}
		country_event = { id = nep_whitegoo.41 days = 30 random = 3 }
	}
}

country_event = {
	id = nep_whitegoo.41
	hide_window = yes
	
	is_triggered_only = yes
	
	trigger = {
		has_global_flag = nep_whitegoo_begin
		is_same_value = event_target:global_event_country
	}
	
	immediate = {
		#log = "fire wg.41 root:[Root.GetName]"
		every_system = {
			limit = {
				has_star_flag = nep_whitegoo_2
				NOR = {
					has_star_flag = nep_whitegoo_3
					has_star_flag = nep_whitegoo_no_effect
				}
				any_neighbor_system = {
					has_star_flag = nep_whitegoo_3
				}
			}
			nep_whitegoo_3 = yes
		}
		country_event = { id = nep_whitegoo.41 days = 30 random = 3 }
	}
}

#Notifition
#stage1
planet_event = {
	id = nep_whitegoo.5000
	hide_window = yes

	is_triggered_only = yes
	
	trigger = {
		solar_system = {
			exists = space_owner
			space_owner = { NOT = { has_country_flag = nep_whitegoo_noti } }
		}
	}
	
	immediate = {
		#log = "fire wg.5000 root:[Root.GetName]"
		solar_system.space_owner = { 
			country_event = { id = nep_whitegoo.50000 }
			set_country_flag = nep_whitegoo_noti 
		}
	}
}

country_event = {
	id = nep_whitegoo.50000
	title = nep_whitegoo.5000.name
	desc = nep_whitegoo.5000.desc
	picture = GFX_evt_gray_gooed_planet
	location = FROM.solar_system
	
	is_triggered_only = yes
	
	immediate = {
		#log = "fire wg.50000 root:[Root.GetName]"
	}
	
	option = {
		name = nep_whitegoo.5000.a
	}
}

# stage2
planet_event = {
	id = nep_whitegoo.5001
	hide_window = yes

	is_triggered_only = yes
	
	trigger = {
		solar_system = {
			exists = space_owner
			space_owner = { NOT = { has_country_flag = nep_whitegoo_2_noti } }
		}
	}
	
	immediate = {
		#log = "fire wg.5001 root:[Root.GetName]"
		solar_system.space_owner = { 
			country_event = { id = nep_whitegoo.50010 }
			set_country_flag = nep_whitegoo_2_noti 
		}
	}
}

country_event = {
	id = nep_whitegoo.50010
	title = nep_whitegoo.5001.name
	desc = nep_whitegoo.5001.desc
	picture = GFX_evt_gray_gooed_planet
	location = From.solar_system
	
	is_triggered_only = yes
	
	immediate = {
		#log = "fire wg.50010 root:[Root.GetName]"
	}
	
	option = {
		name = nep_whitegoo.5001.a
	}
}

# stage3
planet_event = {
	id = nep_whitegoo.5002
	hide_window = yes
	is_triggered_only = yes
	
	trigger = {
		solar_system = {
			exists = space_owner
			space_owner = { NOT = { has_country_flag = nep_whitegoo_3_noti } }
		}
	}
	
	immediate = {
		#log = "fire wg.5002 root:[Root.GetName]"
		solar_system.space_owner = {
			country_event = { id = nep_whitegoo.50020 }
			set_country_flag = nep_whitegoo_3_noti 
		}
	}
}

country_event = {
	id = nep_whitegoo.50020
	title = nep_whitegoo.5002.name
	desc = nep_whitegoo.5002.desc
	picture = GFX_evt_gray_gooed_planet
	location = From.solar_system
	
	is_triggered_only = yes
	
	immediate = {
		#log = "fire wg.50020 root:[Root.GetName]"
	}
	
	option = {
		name = nep_whitegoo.5002.a
	}
}

#Techonology
country_event = {
	id = nep_whitegoo.5
	title = nep_whitegoo.5.name
	desc = nep_whitegoo.5.desc
	picture = GFX_evt_gray_gooed_planet

	trigger = {
		has_global_flag = nep_whitegoo_begin
		OR = {
			has_country_flag = nep_whitegoo_2_noti
			has_country_flag = nep_whitegoo_3_noti
		}
		NOT = { has_country_flag = nep_whitegoo_tech }
	}
	
	mean_time_to_happen = {
		months = 7
	}
	
	immediate = {
		#log = "fire wg.5 root:[Root.GetName]"
		set_country_flag = nep_whitegoo_tech
	}
	
	option = {
		name = nep_whitegoo.5.a
		add_research_option = tech_nep_whitegoo_1
	}
}

country_event = {
	id = nep_whitegoo.51
	title = nep_whitegoo.51.name
	desc = nep_whitegoo.51.desc
	picture = GFX_evt_gray_gooed_planet

	trigger = {
		has_global_flag = nep_whitegoo_begin
		NOT = { has_country_flag = nep_whitegoo_tech }
		any_neighbor_country = {
			has_country_flag = nep_whitegoo_tech
		}
	}
	
	mean_time_to_happen = {
		months = 15
	}
	
	immediate = {
		#log = "fire wg.51 root:[Root.GetName]"
		set_country_flag = nep_whitegoo_tech
	}
	
	option = {
		name = nep_whitegoo.51.a
		add_research_option = tech_nep_whitegoo_1
	}
}

#On_actions
#on_entering_system_fleet
fleet_event = {
	id = nep_whitegoo.6
	hide_window = yes
		
	is_triggered_only = yes
	
	trigger = {
		has_global_flag = nep_whitegoo_begin
		NOT = { has_global_flag = nep_whitegoo_end }
	}
	
	immediate = {
		#log = "fire wg.6 root:[Root.GetName]"
		remove_modifier = nep_whitegoo_fleet
		if = {
			limit = {
				owner = { NOT = { has_technology = tech_nep_whitegoo_3_3 } }
				from = { has_star_flag = nep_whitegoo_1 }
			}
			add_modifier = {
				modifier = nep_whitegoo_fleet
				days = -1
			}
		}
	}
}

#on_tech_increased
country_event = {
	id = nep_whitegoo.61
	hide_window = yes
		
	is_triggered_only = yes
	
	trigger = {
		has_global_flag = nep_whitegoo_begin
		OR = {
			last_increased_tech = tech_nep_whitegoo_3_2
			last_increased_tech = tech_nep_whitegoo_3_3
		}
	}
	
	immediate = {
		#log = "fire wg.61 root:[Root.GetName]"
		if = {
			limit = {
				last_increased_tech = tech_nep_whitegoo_3_2
			}
			every_system_within_border = {
				every_system_planet = {
					remove_modifier = nep_whitegoo_1
				}
			}
		}
		if = {
			limit = {
				last_increased_tech = tech_nep_whitegoo_3_3
			}
			every_owned_fleet = {
				limit = { 
					exists = solar_system 
					solar_system = { has_star_flag = nep_whitegoo_1 } 
				}
				add_modifier = { modifier = nep_whitegoo_fleet days = -1 }
			}
		}
	}
}


#on_fleet_disbanded
country_event = {
	id = nep_whitegoo.62
	hide_window = yes
		
	is_triggered_only = yes
	
	trigger = {
		has_global_flag = nep_whitegoo_begin
		from = { is_ship_size = nep_station_whitegoo }
	}
	
	immediate = {
		#log = "fire wg.62 root:[Root.GetName]"
		from.solar_system = {
			remove_star_flag = nep_whitegoo_no_effect
			every_neighbor_system = {
				limit = { 
					NOR = {
						any_ship_in_system = {
							is_ship_size = nep_station_whitegoo
						}
						any_neighbor_system = {
							any_ship_in_system = {
								is_ship_size = nep_station_whitegoo
							}
						}
					}
				}
				remove_star_flag = nep_whitegoo_no_effect
			}
		}
		event_target:nep_whitegoo_system_1 = {
			if = {
				limit = { 
					AND = {
						NOT = { has_star_flag = nep_whitegoo_no_effect }
						NOR = {
							has_star_flag = nep_whitegoo_1
							has_star_flag = nep_whitegoo_2
							has_star_flag = nep_whitegoo_3
						}
					}
				}
				nep_whitegoo_3 = yes
			}
		}
		event_target:nep_whitegoo_system_2 = {
			if = {
				limit = { 
					AND = {
						NOT = { has_star_flag = nep_whitegoo_no_effect }
						NOR = {
							has_star_flag = nep_whitegoo_1
							has_star_flag = nep_whitegoo_2
							has_star_flag = nep_whitegoo_3
						}
					}
				}
				nep_whitegoo_3 = yes
			}
		}
		event_target:nep_whitegoo_system_3 = {
			if = {
				limit = { 
					AND = {
						NOT = { has_star_flag = nep_whitegoo_no_effect }
						NOR = {
							has_star_flag = nep_whitegoo_1
							has_star_flag = nep_whitegoo_2
							has_star_flag = nep_whitegoo_3
						}
					}
				}
				nep_whitegoo_3 = yes
			}
		}
	}
}


#on_fleet_destroyed_victim
country_event = {
	id = nep_whitegoo.63
	hide_window = yes
		
	is_triggered_only = yes
	
	trigger = {
		has_global_flag = nep_whitegoo_begin
		fromfrom = { is_ship_size = nep_station_whitegoo }
	}
	
	immediate = {
		#log = "fire wg.63 root:[Root.GetName]"
		fromfrom.solar_system = {
			remove_star_flag = nep_whitegoo_no_effect
			every_neighbor_system = {
				limit = { 
					NOR = {
						any_ship_in_system = {
							is_ship_size = nep_station_whitegoo
						}
						any_neighbor_system = {
							any_ship_in_system = {
								is_ship_size = nep_station_whitegoo
							}
						}
					}			
				}
				remove_star_flag = nep_whitegoo_no_effect
			}
		}
		event_target:nep_whitegoo_system_1 = {
			if = {
				limit = { 
					AND = {
						NOT = { has_star_flag = nep_whitegoo_no_effect }
						NOR = {
							has_star_flag = nep_whitegoo_1
							has_star_flag = nep_whitegoo_2
							has_star_flag = nep_whitegoo_3
						}
					}
				}
				nep_whitegoo_3 = yes
			}
		}
		event_target:nep_whitegoo_system_2 = {
			if = {
				limit = { 
					AND = {
						NOT = { has_star_flag = nep_whitegoo_no_effect }
						NOR = {
							has_star_flag = nep_whitegoo_1
							has_star_flag = nep_whitegoo_2
							has_star_flag = nep_whitegoo_3
						}
					}
				}
				nep_whitegoo_3 = yes
			}
		}
		event_target:nep_whitegoo_system_3 = {
			if = {
				limit = { 
					AND = {
						NOT = { has_star_flag = nep_whitegoo_no_effect }
						NOR = {
							has_star_flag = nep_whitegoo_1
							has_star_flag = nep_whitegoo_2
							has_star_flag = nep_whitegoo_3
						}
					}
				}
				nep_whitegoo_3 = yes
			}
		}
	}
}

#on_building_outpost_station
#on_starbase_transfer
ship_event = {
	id = nep_whitegoo.64
	hide_window = yes
		
	is_triggered_only = yes
	
	trigger = {
		has_global_flag = nep_whitegoo_begin
		exists = owner 
		owner = { has_technology = tech_nep_whitegoo_3_2 }
	}
	
	immediate = {
		#log = "fire wg.64 root:[Root.GetName]"
		solar_system = {
			every_system_planet = {
				remove_modifier = nep_whitegoo_1
			}
		}
	}
}

#Cavaneers
country_event = {
	id = nep_whitegoo.7
	title = cara_home_main.title
	custom_gui = "enclave_caravaneer_window"
	desc = nep_whitegoo.7.desc
	
	trigger = {
		has_global_flag = nep_whitegoo_begin
		has_country_flag = nep_whitegoo_noti
		exists = event_target:caravaneer_home_country
		has_technology = tech_nep_whitegoo_4
		has_communications = event_target:caravaneer_home_country
		NOT = { has_country_flag = nep_whitegoo_tech_sell }
		event_target:caravaneer_home_country = {
			NOT = { is_hostile = root }
			NOT = { has_country_flag = nep_whitegoo_tech_gain }
		}
		NOR = {
			caravaneer_base_active_diplo = yes
			has_active_event = { 
				nep_whitegoo.7
				nep_whitegoo.71
			}
		}
		is_fallen_empire = no
	}
	
	mean_time_to_happen = {
		months = 3
	}
	
	diplomatic = yes
	
	picture_event_data = {
		portrait = event_target:caravaneer_home_country
		room = caravaneer_home_room
		planet_background = pc_barren_cold
	}
	
	immediate = {
		#log = "fire wg.7 root:[Root.GetName]"
		set_country_flag = nep_whitegoo_tech_sell
	}
	
	option = {
		name = nep_whitegoo.7.a
		add_resource = {
			energy = 5000
			influence = 100
		}
		event_target:caravaneer_home_country = { set_country_flag = nep_whitegoo_tech_gain }
	}
	
	option = {
		name = nep_whitegoo.7.b
	}
}

country_event = {
	id = nep_whitegoo.71
	title = cara_home_main.title
	custom_gui = "enclave_caravaneer_window"
	desc = nep_whitegoo.71.desc
	
	trigger = {
		has_global_flag = nep_whitegoo_begin
		has_country_flag = nep_whitegoo_noti
		exists = event_target:caravaneer_home_country
		NOT = { has_technology = tech_nep_whitegoo_4 }
		has_communications = event_target:caravaneer_home_country
		NOT = { has_country_flag = nep_whitegoo_tech_buy }
		event_target:caravaneer_home_country = {
			NOT = { is_hostile = root }
			has_country_flag = nep_whitegoo_tech_gain
		}
		NOR = {
			caravaneer_base_active_diplo = yes
			has_active_event = { 
				nep_whitegoo.7
				nep_whitegoo.71
			}
		}
		is_fallen_empire = no
	}
	
	mean_time_to_happen = {
		months = 3
	}
	
	diplomatic = yes
	
	picture_event_data = {
		portrait = event_target:caravaneer_home_country
		room = caravaneer_home_room
		planet_background = pc_barren_cold
	}
	
	immediate = {
		#log = "fire wg.71 root:[Root.GetName]"
		set_country_flag = nep_whitegoo_tech_buy
	}
	
	option = {
		name = nep_whitegoo.71.a
		add_resource = {
			energy = -3500
		}
		add_research_option = tech_nep_whitegoo_4
		add_tech_progress = {
			tech = tech_nep_whitegoo_4
			progress = 0.8
		}
	}	
	option = {
		name = nep_whitegoo.71.b
	}
}

#Origin found
country_event = {
	id = nep_whitegoo.8000
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		has_global_flag = nep_whitegoo_begin
		NOT = { has_global_flag = nep_whitegoo_end }
		NOT = { has_country_flag = nep_whitegoo_8000_temp }
		count_owned_ship = {
			count >=3
			limit = { is_ship_size = nep_station_whitegoo }
		}
	}
	
	immediate = {
		#log = "fire wg.8000 root:[Root.GetName]"
		set_country_flag = nep_whitegoo_8000_temp
		country_event = { id = nep_whitegoo.8001 days = 30 random = 30 }
	}
}


country_event = {
	id = nep_whitegoo.8001
	hide_window = yes

	is_triggered_only = yes
	
	trigger = {
		has_global_flag = nep_whitegoo_begin
		NOT = { has_global_flag = nep_whitegoo_end }
	}
	
	immediate = {
		#log = "fire wg.8001 root:[Root.GetName]"
		random_list = {
			1 = { country_event = { id = nep_whitegoo.8 days = 30 random = 30 } }
			2 = { country_event = { id = nep_whitegoo.8001 days = 30 random = 30 } }
		}
	}
}

country_event = {
	id = nep_whitegoo.8
	title = nep_whitegoo.8.name
	desc = nep_whitegoo.8.desc
	picture = GFX_evt_gray_gooed_planet
	
	is_triggered_only = yes
	
	trigger = {
		has_global_flag = nep_whitegoo_begin
		NOT = { has_global_flag = nep_whitegoo_end }
	}
	
	immediate = {
		#log = "fire wg.8 root:[Root.GetName]"
	}
	
	option = {
		name = nep_whitegoo.8.a
		add_research_option = tech_nep_whitegoo_5
	}
}


country_event = {
	id = nep_whitegoo.81
	title = nep_whitegoo.81.name
	desc = nep_whitegoo.81.desc
	picture = GFX_evt_gray_gooed_planet
	
	is_triggered_only = yes

	trigger = {
		has_global_flag = nep_whitegoo_begin
		NOT = { has_global_flag = nep_whitegoo_82_triggered }
		last_increased_tech = tech_nep_whitegoo_5
		NOT = { has_global_flag = nep_whitegoo_end }
	}
	
	immediate = {
		#log = "fire wg.81 root:[Root.GetName]"
		event_target:nep_whitegoo_system_1 = {
			random_system_planet = {
				limit = { is_star = yes }
				save_event_target_as = nep_whitegoo_81_temp_1
			}
		}
		event_target:nep_whitegoo_system_2 = {
			random_system_planet = {
				limit = { is_star = yes }
				save_event_target_as = nep_whitegoo_81_temp_2
			}
		}
		event_target:nep_whitegoo_system_3 = {
			random_system_planet = {
				limit = { is_star = yes }
				save_event_target_as = nep_whitegoo_81_temp_3
			}
		}
	}
	
	option = {
		name = nep_whitegoo.81.a
		begin_event_chain = { event_chain = nep_whitegoo_chain target = root }
		enable_special_project = {
			name = nep_whitegoo_research
			location = event_target:nep_whitegoo_81_temp_1
			owner = root
		}
		enable_special_project = {
			name = nep_whitegoo_research
			location = event_target:nep_whitegoo_81_temp_2
			owner = root
		}
		enable_special_project = {
			name = nep_whitegoo_research
			location = event_target:nep_whitegoo_81_temp_3
			owner = root
		}
	}
}

country_event = {
	id = nep_whitegoo.82
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		#log = "fire wg.82 root:[Root.GetName]"		
		set_country_flag = nep_whitegoo_83_temp
		set_global_flag = nep_whitegoo_82_triggered
		set_spawn_system_batch = begin
		event_target:nep_whitegoo_system_1 = {
			spawn_system = {
				min_distance >= 20
				max_distance <= 40
				hyperlane = no
				initializer = "nep_whitegoo_init_1"
			}
			random_system = {
				limit = { has_star_flag = nep_whitegoo_portal_1 }
				add_hyperlane = { from = prev to = this }
				save_event_target_as = nep_whitegoo_portal_1
			}
		}
		event_target:nep_whitegoo_system_2 = {
			spawn_system = {
				min_distance >= 20
				max_distance <= 40
				hyperlane = no
				initializer = "nep_whitegoo_init_1"
			}
			random_system = {
				limit = { 
					has_star_flag = nep_whitegoo_portal_1
					NOT = { has_hyperlane_to = event_target:nep_whitegoo_system_1 }
				}
				add_hyperlane = { from = prev to = this }
				save_event_target_as = nep_whitegoo_portal_2
			}
		}
		event_target:nep_whitegoo_system_3 = {
			spawn_system = {
				min_distance >= 20
				max_distance <= 40
				hyperlane = no
				initializer = "nep_whitegoo_init_1"
			}
			random_system = {
				limit = { 
					has_star_flag = nep_whitegoo_portal_1
					NOT = { has_hyperlane_to = event_target:nep_whitegoo_system_1 }
					NOT = { has_hyperlane_to = event_target:nep_whitegoo_system_2 }
				}
				add_hyperlane = { from = prev to = this }
				save_event_target_as = nep_whitegoo_portal_3
			}
		}
		no_scope = {
			spawn_system = {
				min_distance >= 494
				max_distance <= 494
				min_orientation_angle = 295
				max_orientation_angle = 296
				hyperlane = no
				initializer = nep_whitegoo_init_3
			}
		}
		random_system = {
			limit = { has_star_flag = nep_whitegoo_origin }
			save_global_event_target_as = nep_whitegoo_origin
			while = {
				count = 3
				spawn_system = {
					min_distance >= 10
					max_distance <= 20
					hyperlane = no
					initializer = "nep_whitegoo_init_2"
				}
			}
			while = {
				count = 3
				random_system = {
					limit = {
						has_star_flag = nep_whitegoo_portal_1
						has_natural_wormhole = no
					}
					spawn_natural_wormhole = {
						bypass_type = wormhole
						random_pos = yes
					}
					random_system = {
						limit = { 
							has_star_flag = nep_whitegoo_portal_2
							has_natural_wormhole = no
						}
						add_hyperlane = { from = prevprev to = this }
						spawn_natural_wormhole = {
							bypass_type = wormhole
							random_pos = yes
						}
						link_wormholes = prev
					}
				}
			}
		}
		set_spawn_system_batch = end
		every_system = {
			limit = {
				OR = {
					has_star_flag = nep_whitegoo_portal_1
					has_star_flag = nep_whitegoo_portal_2
					has_star_flag = nep_whitegoo_origin
				}
			}
			nep_whitegoo_1 = yes
			nep_whitegoo_2 = yes
			nep_whitegoo_3 = yes
		}
		every_country = {
			country_event = { id = nep_whitegoo.83 }
		}
	}
}

country_event = {
	id = nep_whitegoo.83
	title = nep_whitegoo.83.name
	desc = {
		trigger = { has_country_flag = nep_whitegoo_83_temp }
		text = nep_whitegoo.83.desc
	}
	desc = {
		trigger = { NOT = { has_country_flag = nep_whitegoo_83_temp } }
		text = nep_whitegoo.83.desc.a
	}
	picture = GFX_evt_gray_gooed_planet
	location = event_target:nep_whitegoo_origin
	
	is_triggered_only = yes
	
	immediate = {
		#log = "fire wg.83 root:[Root.GetName]"
		abort_special_project = nep_whitegoo_research
	}
	
	option = {
		name = nep_whitegoo.83.a
		if = {
			limit = { NOT = { has_event_chain = nep_whitegoo_chain } }
			begin_event_chain = { event_chain = nep_whitegoo_chain target = root }
		}
		create_point_of_interest = {
			id = nep_whitegoo_poi.0.1
			name = "nep_whitegoo_poi_name"
			desc = "nep_whitegoo_poi_desc"
			event_chain = nep_whitegoo_chain
			category = nep_whitegoo_83_cat
			location = event_target:nep_whitegoo_portal_1
		}
		create_point_of_interest = {
			id = nep_whitegoo_poi.0.2
			name = "nep_whitegoo_poi_name"
			desc = "nep_whitegoo_poi_desc"
			event_chain = nep_whitegoo_chain
			category = nep_whitegoo_83_cat
			location = event_target:nep_whitegoo_portal_2
		}
		create_point_of_interest = {
			id = nep_whitegoo_poi.0.3
			name = "nep_whitegoo_poi_name"
			desc = "nep_whitegoo_poi_desc"
			event_chain = nep_whitegoo_chain
			category = nep_whitegoo_83_cat
			location = event_target:nep_whitegoo_portal_3
		}
		create_point_of_interest = {
			id = nep_whitegoo_poi.1
			name = "nep_whitegoo_poi_name"
			desc = "nep_whitegoo_poi_desc"
			event_chain = nep_whitegoo_chain
			location = event_target:nep_whitegoo_origin
		}
	}
}

country_event = {
	id = nep_whitegoo.9
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		#log = "fire wg.9 root:[Root.GetName]"
		remove_global_flag = nep_whitegoo_begin
		set_global_flag = nep_whitegoo_end
		every_system = {
			limit = { has_star_flag = nep_whitegoo_no_effect }
			remove_star_flag = nep_whitegoo_no_effect
		}
		every_system = {
			limit = {
				OR = {
					has_star_flag = nep_whitegoo_1
					has_star_flag = nep_whitegoo_2
					has_star_flag = nep_whitegoo_3
				}
			}
			save_event_target_as = nep_whitegoo_9000_temp
			remove_star_flag = nep_whitegoo_1
			remove_star_flag = nep_whitegoo_2
			remove_star_flag = nep_whitegoo_3
			remove_modifier = nep_whitegoo_system_1
			remove_modifier = nep_whitegoo_system_2
			remove_modifier = nep_whitegoo_system_3
			every_system_ambient_object = {
				limit = { has_ambient_object_flag = nep_whitegoo_ambient_object }
				destroy_ambient_object = this
			}
			every_system_planet = {
				if = { 
					limit = { has_modifier = nep_whitegoo_1 }
					remove_modifier = nep_whitegoo_1
				}
				if = { 
					limit = { has_modifier = nep_whitegoo_2 }
					remove_modifier = nep_whitegoo_2
				}
				if = { 
					limit = { has_modifier = nep_whitegoo_3 }
					remove_modifier = nep_whitegoo_3
				}
			}
			every_fleet_in_system = {
				remove_modifier = nep_whitegoo_fleet
			}
		}
		#country_event = { id = nep_whitegoo.9000 }
	}
}

# country_event = {
	# id = nep_whitegoo.9000
	# hide_window = yes
	
	# is_triggered_only = yes
	
	# immediate = {
		# if = {
			# limit = { has_global_flag = nep_whitegoo_begin }
			# remove_global_flag = nep_whitegoo_begin
			# set_global_flag = nep_whitegoo_end
		# }
		# every_system = {
			# limit = {
				# OR = {
					# has_star_flag = nep_whitegoo_1
					# has_star_flag = nep_whitegoo_2
					# has_star_flag = nep_whitegoo_3
				# }
			# }
			# save_event_target_as = nep_whitegoo_9000_temp
			# remove_star_flag = nep_whitegoo_1
			# remove_star_flag = nep_whitegoo_2
			# remove_star_flag = nep_whitegoo_3
			# remove_modifier = nep_whitegoo_system_1
			# remove_modifier = nep_whitegoo_system_2
			# remove_modifier = nep_whitegoo_system_3
			# every_system_ambient_object = {
				# limit = { has_ambient_object_flag = nep_whitegoo_ambient_object }
				# destroy_ambient_object = this
			# }
			# every_system_planet = {
				# if = { 
					# limit = { has_modifier = nep_whitegoo_1 }
					# remove_modifier = nep_whitegoo_1
				# }
				# if = { 
					# limit = { has_modifier = nep_whitegoo_2 }
					# remove_modifier = nep_whitegoo_2
				# }
				# if = { 
					# limit = { has_modifier = nep_whitegoo_3 }
					# remove_modifier = nep_whitegoo_3
				# }
			# }
			# every_fleet_in_system = {
				# remove_modifier = nep_whitegoo_fleet
			# }
		# }
	 # if = {
			# limit = { NOT = { exists = event_target:nep_whitegoo_9000_temp } }
			# set_global_flag = nep_whitegoo_end
			# every_country = {
				# remove_country_flag = nep_whitegoo_8000_temp
				# remove_country_flag = nep_whitegoo_83_temp
			# }
		# }
		# else = {
			# country_event = { id = nep_whitegoo.9000 days = 30 random = 3 }
		# }
	#}
#}

country_event = {
	id = nep_whitegoo.91
	title = nep_whitegoo.91.name
	desc = nep_whitegoo.91.desc
	picture = GFX_evt_gray_gooed_planet
	
	is_triggered_only = yes
	
	immediate = {
		
	}
	
	option = {
		name = nep_whitegoo.91.a
		end_event_chain = nep_whitegoo_chain		
		hidden_effect = {
			remove_point_of_interest = nep_whitegoo_poi.0.1
			remove_point_of_interest = nep_whitegoo_poi.0.2
			remove_point_of_interest = nep_whitegoo_poi.0.3
			remove_point_of_interest = nep_whitegoo_poi.1
		}
	}
}

event = {
	id = nep_whitegoo.9998
	hide_window = yes
	
	is_triggered_only = yes
	trigger = {
		has_global_flag = nep_whitegoo_end
		event_target:nep_whitegoo_origin = {
			exists = owner
			NOT = { any_ship_in_system = { is_ship_size = nep_station_whitegoo }}
		}
	}
	
	immediate = {
		event_target:nep_whitegoo_origin = {
			random_system_planet = {
				limit = { is_star = no }
				save_event_target_as = nep_whitegoo_9998_temp
				create_fleet = {
					settings = {
						can_upgrade = no
						can_change_composition = no
						can_change_leader = no
						uses_naval_capacity = no
						spawn_debris = no
					}
					effect = {
						set_owner = event_target:nep_whitegoo_origin.owner
						create_ship = {
							design = "NAME_nep_station_whitegoo"
						}
						set_location = {
							target = event_target:nep_whitegoo_9998_temp
							distance = 0
							angle = 0
						}
					}
				}
			}
		}
	}
}
country_event = {
	id = nep_whitegoo.9999
	title = nep_whitegoo.9999.name
	desc = nep_whitegoo.9999.desc
	picture = GFX_evt_gray_gooed_planet
	
	trigger = {
		has_global_flag = nep_whitegoo_end
		any_owned_ship = {
			is_ship_size = nep_station_whitegoo
			solar_system = {
				has_star_flag = nep_whitegoo_origin
			}
		}
		NOR = {
			has_country_flag = nep_whitegoo_9999_triggered
			has_technology = tech_nanite_transmutation
		}
	}
	
	mean_time_to_happen = {
		months = 12
	}
	
	immediate = {
		
	}
	
	option = {
		name = nep_whitegoo.9999.a
		add_research_option = tech_nanite_transmutation
		hidden_effect = { set_country_flag = nep_whitegoo_9999_triggered }
	}
}

###############################################
# Grand Pirate Centrary
###############################################
namespace = nep_gpc
event = {
	id = nep_gpc.0
	hide_window = yes
	
	trigger = {
		exists = event_target:caravaneer_home_country
		any_playable_country = {
			is_ai = no			
			NOR = {
				has_ethic = ethic_fanatic_xenophobe
				has_valid_civic = civic_fanatic_purifiers
				has_valid_civic = civic_hive_devouring_swarm
				has_valid_civic = civic_machine_terminator
				has_origin = origin_nep_deus_ex_machina
			}
			has_communications = event_target:caravaneer_home_country
			event_target:caravaneer_home_country = {
				NOT = { is_hostile = prev }
			}
			num_owned_planets >= 3
			fleet_power >= 30000
		}
	}
	
	fire_only_once = yes
	is_triggered_only = yes
	
	immediate = {
		set_global_flag = nep_gpc_spawn
		random_playable_country = {
			limit = { 
				is_ai = no 
				NOR = {
					has_ethic = ethic_fanatic_xenophobe
					has_valid_civic = civic_fanatic_purifiers
					has_valid_civic = civic_hive_devouring_swarm
					has_valid_civic = civic_machine_terminator
					has_origin = origin_nep_deus_ex_machina
				}
				has_communications = event_target:caravaneer_home_country
				event_target:caravaneer_home_country = {
					NOT = { is_hostile = prev }
				}
				num_owned_planets >= 3
				fleet_power >= 5000
			}
			country_event = { id = nep_gpc.1099 days = 360 random = 3600 }
		}
	}
}

country_event = {
	id = nep_gpc.1099
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		random_system = {
			limit = {
				any_system_planet = {
					is_colony = yes
					is_capital = no
					owner = {
						is_country_type = default
					}
				}
				distance = {
					source = root.capital_scope
					use_bypasses = yes
					min_jumps = 5 
					max_jumps = 20
				}
				has_access_fleet = root
			}
			random_system_planet = {
				limit = { is_colony = yes }
				save_global_event_target_as = nep_escort_destiny
			}
		}
		if = {
			limit = { 
				exists = event_target:nep_escort_destiny
				any_owned_fleet = {
					can_access_system = root.capital_scope.solar_system
					can_access_system = event_target:nep_escort_destiny.solar_system
				}
			}
			country_event = { id = nep_gpc.1 }
		}
		else = { country_event = { id = nep_gpc.1099 days = 360 random = 1800 } }
	}
}

#Cavaneers
country_event = {
	id = nep_gpc.1
	title = cara_home_main.title
	custom_gui = "enclave_caravaneer_window"
	desc = nep_gpc.1.desc
	
	diplomatic = yes
	is_triggered_only = yes

	picture_event_data = {
		portrait = event_target:caravaneer_home_country
		room = caravaneer_home_room
		planet_background = pc_city
	}
		
	immediate = {
	
	}
	
	option = {
		name = nep_gpc.1.a #agreed
		#custom_tooltip = nep_gpc.1.a.tooltip
		hidden_effect = {
			country_event = { id = nep_gpc.1000 } 
		}
	}
	
	option = {
		name = nep_gpc.1.b #refused
		trigger = {
			NOT = { has_ethic = ethic_xenophobe }
		}
		default_hide_option = yes
		set_global_flag = nep_gpc_end
	}
	
	option = {
		name = nep_gpc.1.c #xeno scrums
		trigger = {
			has_ethic = ethic_xenophobe
		}
		default_hide_option = yes
		set_global_flag = nep_gpc_end
	}
}

country_event = {
	id = nep_gpc.1000
	title = cara_home_main.title
	custom_gui = "enclave_caravaneer_window"
	desc = nep_gpc.1000.desc
	
	diplomatic = yes
	is_triggered_only = yes

	picture_event_data = {
		portrait = event_target:caravaneer_home_country
		room = caravaneer_home_room
		planet_background = pc_city
	}
	
	is_triggered_only = yes
	
	immediate = {
		set_country_flag = nep_gpc_country
		create_species = {
			name = random
			class = random_non_machine
			portrait = random
			traits = random
		}
		create_country = {
			name = "NAME_Caravaneer_Fleet2"
			type = caravaneer_fleet
			authority = auth_corporate
			civics = {
				civic = civic_caravaneer_fleet2
			}
			species = last_created_species
			flag = {
				icon = {
					category = "special"
					file = "caravaneer_02.dds"
				}
				background= {
					category = "backgrounds"
					file = "new_dawn.dds"
				}
				colors={
					"dark_purple"
					"pink"
					"null"
					"null"
				}
			}
			ethos = {
				ethic = ethic_egalitarian
				ethic = ethic_pacifist
				ethic = ethic_xenophile
			}
			ignore_initial_colony_error = yes
			effect = {
				set_country_flag = nep_caravaneer_fleet_country
				set_graphical_culture = caravaneer_01
				save_global_event_target_as = nep_caravaneer_fleet_country
				create_fleet = {
					name = "NAME_Caravaneer_Fleet2_fleet"
					settings = { spawn_debris = no }
					effect = {
						set_fleet_stance = passive
						set_formation_scale = 2.5
						set_owner = prev
						create_ship = {
							name = "NAME_Schooner"
							design = NAME_Schooner
						}
						while = {
							count = 10
							create_ship = {
								name = "NAME_Yojimbo"
								design = NAME_Yojimbo
							}
						}
						while = {
							count = 6
							create_ship = {
								name = "NAME_Gunslinger"
								design = NAME_Gunslinger
							}
						}
						set_location = {
							target = root.capital_scope
							angle = 180
							distance = 40
						}
						set_fleet_flag = nep_cara_fleet
						save_global_event_target_as = nep_caravaneer_fleet_fleet
						set_fleet_stance = passive
						prev = {
							set_custom_capital_location = event_target:nep_caravaneer_fleet_fleet
						}
					}
				}
				create_leader = {
					class = governor
					species = prev
					name = random
					skill = 5
				}
				set_leader = last_created_leader
			}
		}
		establish_communications_no_message = event_target:nep_caravaneer_fleet_country
	}
	
	option = {
		name = OK
		enable_special_project = {
			name = "nep_escort_assignment"
			owner = root
			location = event_target:nep_caravaneer_fleet_fleet
		}
	}
}

country_event = {
	id = nep_gpc.1002
	title = cara_home_main.title
	custom_gui = "enclave_caravaneer_window"
	desc = nep_gpc.1002.desc
	
	diplomatic = yes
	is_triggered_only = yes

	picture_event_data = {
		portrait = event_target:caravaneer_home_country
		room = caravaneer_home_room
		planet_background = pc_city
	}
		
	immediate = {
	
	}
	
	option = {
		name = OK
		default_hide_option = yes
		add_resource = {
			energy = -500
		}
	}
	
	after = {		
		event_target:nep_caravaneer_fleet_country = {
			destroy_country = yes
		}
		set_global_flag = nep_gpc_end
	}
}

ship_event = {
	id = nep_gpc.2000
	hide_window = yes
	is_triggered_only = yes
	immediate = {
		log = "fire gp.2000 root:[Root.GetName] owner:[owner.GetName]"
		owner = { country_event = { id = nep_gpc.2 } }
	}
}

country_event = {
	id = nep_gpc.2
	title = cara_home_main.title
	custom_gui = "enclave_caravaneer_window"
	desc = nep_gpc.2.desc
	
	diplomatic = yes
	is_triggered_only = yes

	picture_event_data = {
		portrait = event_target:caravaneer_home_country
		room = caravaneer_home_room
		planet_background = pc_city
	}
		
	immediate = {
	
	}
	
	option = {
		name = OK
	}
	
	after = {
		set_country_flag = nep_escort_country
		event_target:nep_caravaneer_fleet_fleet = {
			auto_move_to_planet = {
				target = event_target:nep_escort_destiny
				clear_auto_move_on_arrival = yes
			}
		}
		root.from = {
			fleet = {
				auto_follow_fleet = {
					target = event_target:nep_caravaneer_fleet_fleet
					attack_fleet = no
				}
			}
		}
	}
}

#on_entering_system_fleet
fleet_event = {
	id = nep_gpc.2001
	hide_window = yes
	
	is_triggered_only = yes
	
	trigger = {
		has_global_flag = nep_gpc_spawn
		NOT = { has_global_flag = nep_gpc_end }
		exists = event_target:nep_caravaneer_fleet_fleet
		root = { is_same_value = event_target:nep_caravaneer_fleet_fleet }
	}
	
	immediate = {
		if = {
			limit = {
				solar_system = { has_owner = yes }
			}
			if = {
				limit = {
					solar_system = { trade_protected_value < 5 }
				}
				random_list = {
					2 = {}
					1 = { fleet_event = { id = nep_gpc.2002 } }
				}
			}
			else_if = {
				limit = {
					solar_system = { trade_protected_value < 20 }
				}
				random_list = {
					4 = {}
					1 = { fleet_event = { id = nep_gpc.2002 } }
				}
			}
			else_if = {
				limit = {
					solar_system = { trade_protected_value < 30 }
				}
				random_list = {
					6 = {}
					1 = { fleet_event = { id = nep_gpc.2002 } }
				}
			}
			else_if = {
				limit = {
					solar_system = { trade_protected_value < 40 }
				}
				random_list = {
					8 = {}
					1 = { fleet_event = { id = nep_gpc.2002 } }
				}
			}
			else_if = {
				limit = {
					solar_system = { trade_protected_value < 50 }
				}
				random_list = {
					10 = {}
					1 = { fleet_event = { id = nep_gpc.2002 } }
				}
			}
			else_if = {
				limit = {
					solar_system = { trade_protected_value < 60 }
				}
				random_list = {
					12 = {}
					1 = { fleet_event = { id = nep_gpc.2002 } }
				}
			}
			else_if = {
				limit = {
					solar_system = { trade_protected_value < 70 }
				}
				random_list = {
					14 = {}
					1 = { fleet_event = { id = nep_gpc.2002 } }
				}
			}
			else_if = {
				limit = {
					solar_system = { trade_protected_value < 80 }
				}
				random_list = {
					16 = {}
					1 = { fleet_event = { id = nep_gpc.2002 } }
				}
			}
			else_if = {
				limit = {
					solar_system = { trade_protected_value < 90 }
				}
				random_list = {
					18 = {}
					1 = { fleet_event = { id = nep_gpc.2002 } }
				}
			}
			else_if = {
				limit = {
					solar_system = { trade_protected_value < 100 }
				}
				random_list = {
					20 = {}
					1 = { fleet_event = { id = nep_gpc.2002 } }
				}
			}
			else_if = {
				limit = {
					solar_system = { trade_protected_value < 110 }
				}
				random_list = {
					22 = {}
					1 = { fleet_event = { id = nep_gpc.2002 } }
				}
			}
			else_if = {
				limit = {
					solar_system = { trade_protected_value < 120 }
				}
				random_list = {
					24 = {}
					1 = { fleet_event = { id = nep_gpc.2002 } }
				}
			}
			else_if = {
				limit = {
					solar_system = { trade_protected_value < 130 }
				}
				random_list = {
					26 = {}
					1 = { fleet_event = { id = nep_gpc.2002 } }
				}
			}
			else_if = {
				limit = {
					solar_system = { trade_protected_value < 140 }
				}
				random_list = {
					28 = {}
					1 = { fleet_event = { id = nep_gpc.2002 } }
				}
			}
		}
		else = {
			random_list = {
				29 = {}
				1 = { fleet_event = { id = nep_gpc.2002 } }
			}
		}
	}
}


fleet_event = {
	id = nep_gpc.2002
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		if = {
			limit = { NOT = { exists = event_target:nep_gpc_species_1 } }
			create_species = {
				name = random
				class = random_non_machine
				portrait = random
				traits = {
					trait = trait_very_strong
					trait = trait_nomadic
				}
			}
			last_created_species = {
				save_global_event_target_as = nep_gpc_species_1			
			}			
		}
		create_country = {
			name = "NAME_Pirates"
			type = pirate
			species = event_target:nep_gpc_species_1
			name_list = "PRT1"
			flag = {
				background = {
					category = "backgrounds"
					file = "00_solid.dds"
				}
				colors ={
					"black"
					"black"
					"null"
					"null"
				}
			}
			effect = {
				save_event_target_as = pirate_band
			}
		}
		event_target:pirate_band = {
			set_name = random
			randomize_flag_symbol = "pirate"
			every_country = {
				establish_communications_no_message = prev
			}
			set_country_flag = nep_gpc_pirate1
			create_leader = {
				class = admiral
				species = owner_main_species
				name = random
				skill = 1
				randomize_traits = yes
			}
			create_fleet = {
				name = "NAME_Pirate_Fleet"
				effect = {
					set_owner = event_target:pirate_band
					create_pirate_ships_9 = yes
					assign_leader = last_created_leader
					set_location = {
						target = event_target:nep_caravaneer_fleet_fleet
						distance = 250
						angle = random
					}
					set_fleet_stance = aggressive
					set_aggro_range_measure_from = self
					set_aggro_range = 800
				}
			}
		}
	}	
}

#on_fleet_destroyed_perp
country_event = {
	id = nep_gpc.2003
	title = nep_gpc.2003.name
	desc = nep_gpc.2003.desc
	picture = GFX_evt_pirate_armada
	
	trigger = {
		NOT = { has_global_flag = nep_gpc_end }
		is_country_type = default
		from = { has_country_flag = nep_gpc_pirate1 }
	}
	
	is_triggered_only = yes
	
	immediate = {
		if = {
			limit = {
				NOT = { has_global_flag = nep_gpc_stage_2 }
				NOT = { has_global_flag = nep_gpc_2003_temp }
			}
			random_list = {
				1 = { }
				1 = { set_global_flag = nep_gpc_2003_temp }
			}
		}
	}
	
	option = {
		name = nep_gpc.2003.a
		trigger = { has_country_flag = nep_escort_country }
		add_resource = {
			energy = -1000
			influence = 50
		}
		hidden_effect = {
			set_global_flag = nep_gpc_end
			remove_global_flag = nep_gpc_2003_temp
		}
	}
	
	option = {
		name = nep_gpc.2003.b
		trigger = { 
			has_global_flag = nep_gpc_2003_temp
			NOT = { has_global_flag = nep_gpc_stage_2 }
		}
		hidden_effect = { 
			set_global_flag = nep_gpc_stage_2
			remove_global_flag = nep_gpc_2003_temp
			country_event = { id = nep_gpc.3 days = 15 random = 15 }
			root.fromfrom.solar_system = { save_global_event_target_as = nep_gpc_stage_2_beginpoint }
		}
	}
	
	option = {
		name = nep_gpc.2003.c
		add_resource = {
			minerals = 80
			energy = 50
		}
		hidden_effect = {
			remove_global_flag = nep_gpc_2003_temp
		}
	}
}

#on_fleet_auto_move_arrival
country_event = {
	id = nep_gpc.2004
	hide_window = yes
	
	is_triggered_only = yes
	
	trigger = {
		has_global_flag = nep_gpc_spawn
		#NOT = { has_global_flag = nep_gpc_end }
		exists = event_target:nep_caravaneer_fleet_fleet
		from = { is_same_value = event_target:nep_caravaneer_fleet_fleet }
	}
	
	immediate = {
		random_country = {
			limit = { has_country_flag = nep_escort_country }
			country_event = { id = nep_gpc.2005 }
		}
	}
}

country_event = {
	id = nep_gpc.2005
	title = nep_gpc.2005.name
	desc = nep_gpc.2005.desc
	picture = GFX_evt_caravaneers
	
	
	is_triggered_only = yes
	
	immediate = {}
	
	option = {
		name = nep_gpc.2005.a
		add_resource = {
			energy = 3000
			consumer_goods = 1500
			unity = 1000
			influence = 100
		}
	}
	
	after = {
		hidden_effect = {
			remove_country_flag = nep_escort_country	
			event_target:nep_caravaneer_fleet_country = {
				destroy_country = yes
			}
			if = {
				limit = {
					NOT = { has_global_flag = nep_gpc_stage_2 }
					NOT = { has_global_flag = nep_gpc_end }
				}
				set_global_flag = nep_gpc_end
			}
			clear_global_event_target = nep_escort_destiny
		}
	}
}

country_event = {
	id = nep_gpc.2006
	hide_window = yes
	
	is_triggered_only = yes
	
	trigger = {
		exists = event_target:nep_caravaneer_fleet_fleet
		fromfrom = { is_same_value = event_target:nep_caravaneer_fleet_fleet }
	}
	
	immediate = {
		random_country = {
			limit = { has_country_flag = nep_escort_country }
			country_event = { id = nep_gpc.2007 }
		}
	}
}

country_event = {
	id = nep_gpc.2007
	title = nep_gpc.2007.name
	desc = nep_gpc.2007.desc
	picture = GFX_evt_exploding_ship
	
	is_triggered_only = yes
		
	immediate = {
		clear_global_event_target = nep_escort_destiny
	}
	
	option = {
		name = nep_gpc.2007.a
		trigger = {
			fromfrom = { 
				OR = {
					is_country_type = default
					is_country_type = dormant_marauders
					is_country_type = awakened_marauders
					is_country_type = fallen_empire
					is_country_type = awakened_fallen_empire
				}
			}
		}
		add_resource = {
			influence = -100
		}
		add_opinion_modifier = { modifier = opinion_nep_you_destroy_our_escort who = root.fromfrom }
	}
	
	option = {
		name = nep_gpc.2007.b
		trigger = {
			fromfrom = { 
				NOR = {
					is_country_type = default
					is_country_type = dormant_marauders
					is_country_type = awakened_marauders
					is_country_type = fallen_empire
					is_country_type = awakened_fallen_empire
				}
			}
		}
		add_resource = {
			influence = -150
		}
	}
	
	after = {
		remove_country_flag = nep_escort_country		
		hidden_effect = {
			event_target:nep_caravaneer_fleet_country = {
				destroy_country = yes
			}
		}
		if = {
			limit = {
				AND = {
					NOT = { has_global_flag = nep_gpc_stage_2 }
					NOT = { has_global_flag = nep_gpc_end }
				}
			}
			set_global_flag = nep_gpc_end
		}
	}
}

country_event = {
	id = nep_gpc.3
	title = nep_gpc.3.name
	desc = nep_gpc.3.desc
	picture = GFX_evt_pirate_armada
	
	is_triggered_only = yes
	
	immediate = {
		random_system = {
			limit = {
				nep_st_is_not_outer_or_fe_system = yes
				distance = {
					source = event_target:nep_gpc_stage_2_beginpoint
					min_jumps = 5
					max_jumps = 12
				}
			}
			set_spawn_system_batch = begin
			spawn_system = {
				min_distance >= 20
				max_distance <= 40
				hyperlane = yes
				initializer = "nep_gpc_init_01"
			}
			set_spawn_system_batch = end
		}
		clear_global_event_target = nep_gpc_stage_2_beginpoint
		if = {
			limit = { NOT = { exists = event_target:nep_gpc_species_1 } }
			create_species = {
				name = random
				class = random_non_machine
				portrait = random
				traits = {
					trait = trait_very_strong
					trait = trait_nomadic
				}
			}
			last_created_species = {
				save_global_event_target_as = nep_gpc_species_1			
			}
		}
		random_system = {
			limit = { has_star_flag = nep_gpc_system_1 }
			random_system_planet = {
				save_event_target_as = pirate_home
				create_country = {
					name = "NAME_nep_Grand_Captain_Balfour"
					type = pirate
					species = event_target:nep_gpc_species_1
					name_list = "PRT1"
					flag = {
						background = {
							category = "backgrounds"
							file = "00_solid.dds"
						}
						colors ={
							"black"
							"black"
							"null"
							"null"
						}
					}
					effect = {
						save_event_target_as = pirate_band
					}
				}
				last_created_country = {
					create_leader = {
						class = admiral
						species = owner_main_species
						name = "NAME_nep_Grand_Captain_Balfour"
						skill = 10
						randomize_traits = yes
					}
					create_fleet = {
						name = "NAME_nep_Grand_Captain_Balfour"
						effect = {
							set_owner = event_target:pirate_band
							create_ship_design = {
								design = "NAME_Pirate_Galleon"
							}
							while = {
								count = 3
								create_ship = {
									name = random
									design = last_created_design
									graphical_culture = "pirate_01"
								}
							}
							create_ship_design = {
								design = "NAME_Skull"
							}
							while = {
								count = 18
								create_ship = {
									name = random
									design = last_created_design
									graphical_culture = "pirate_01"
								}
							}
							create_ship_design = {
								design = "NAME_Brigand"
							}
							while = {
								count = 18
								create_ship = {
									name = random
									design = last_created_design
									graphical_culture = "pirate_01"
								}
							}
							assign_leader = last_created_leader
							set_location = {
								target = event_target:pirate_home
								distance = 10
								angle = random
							}
							set_fleet_stance = aggressive
							set_aggro_range_measure_from = self
							set_aggro_range = 800
							save_event_target_as = nep_grand_captain
						}
					}
					create_fleet = {
						name = "NAME_Pirate_Station"
						effect = {
							set_owner = event_target:pirate_band
							create_ship = {
								name = random
								design = "NAME_Pirate_Nest"
								graphical_culture = "pirate_01"
							}
							set_location = event_target:pirate_home
						}
					}
				}
				event_target:pirate_band = {
					randomize_flag_symbol = "pirate"
					every_country = {
						establish_communications_no_message = prev
					}
					set_country_flag = nep_gpc_grand_captain
				}
			}
		}
	}
	
	option = {
		name = nep_gpc.3.a
		create_point_of_interest = {
			id = nep_gpc.3.poi.0
			name = "nep_gpc_poi_name"
			desc = "nep_gpc_poi_desc"
			location = event_target:nep_grand_captain
		}		
	}
}

country_event = {
	id = nep_gpc.3001
	title = nep_gpc.3001.name
	desc = nep_gpc.3001.desc
	picture = GFX_evt_exploding_ship
	
	is_triggered_only = yes
	
	fire_only_once = yes
	
	trigger = {
		from = { has_country_flag = nep_gpc_grand_captain }
		fromfromfrom = {
			NOT = { is_ship_size = pirate_station }
		}
	}
	
	immediate = {
		
	}
	
	option = {
		name = nep_gpc.3001.a
		trigger = {
			NOR = {
				has_ethic = ethic_fanatic_xenophile
				has_ethic = ethic_fanatic_pacifist
			}
		}
		add_resource = {
			influence = 50
		}
		hidden_effect = {
			every_playable_country = { country_event = { id = nep_gpc.3002 days = 30 } }
			country_event = { id = nep_gpc.4 days = 120 random = 15 }
			every_playable_country = { country_event = { id = nep_gpc.4001 days = 150 } }
		}
	}
	
	
	option = {
		name = nep_gpc.3001.b
		default_hide_option = yes
		add_resource = {
			influence = 10
		}
		hidden_effect = {
			set_global_flag = nep_gpc_end
		}
	}
}

country_event = {
	id = nep_gpc.3002
	title = nep_gpc.3002.name
	desc = nep_gpc.3002.desc
	picture = GFX_evt_news_room
		
	is_triggered_only = yes
	
	immediate = { }
	
	option = {
		name = nep_gpc.3002.a
	}
}


country_event = {
	id = nep_gpc.4
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		set_global_flag = nep_gpc_pirate_waves
		every_playable_country = {
			country_event = { id = nep_gpc.4002 }
		}
		event_target:global_event_country = {
			country_event = { id = nep_gpc.4003 days = 720 random = 360 } #pirate kings
			country_event = { id = nep_gpc.4010 days = 720 random = 360 } #pirates in nobody
		}
		country_event = { id = nep_gpc.4099 days = 3600 random = 3600 } #wave end
	}
}

country_event = {
	id = nep_gpc.4001
	title = nep_gpc.4001.name
	desc = nep_gpc.4001.desc
	picture = GFX_evt_news_room
		
	is_triggered_only = yes
	
	immediate = { }
	
	option = {
		name = nep_gpc.4001.a
		add_modifier = {
			modifier = nep_gpc_piracy
			days = -1
		}
	}
}

country_event = {
	id = nep_gpc.4002
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		remove_country_flag = pirates_spawned
		if = {
			limit = { has_global_flag = nep_gpc_pirate_waves }
			country_event = { id = nep_gpc.4002 days = 360 random = 720 }
		}
	}
}

country_event = {
	id = nep_gpc.4003
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		set_spawn_system_batch = begin
		random_rim_system = {
			spawn_system = {
				min_distance >= 20
				max_distance <= 40
				hyperlane = yes
				initializer = "nep_gpc_init_02"
			}
			random_system = {
				limit = { has_star_flag = nep_gpc_system_2 }
				remove_star_flag = nep_gpc_system_2
				set_star_flag = nep_gpc_tawni_balfour
			}
		}
		random_rim_system = {
			spawn_system = {
				min_distance >= 20
				max_distance <= 40
				hyperlane = yes
				initializer = "nep_gpc_init_02"
			}
			random_system = {
				limit = { has_star_flag = nep_gpc_system_2 }
				remove_star_flag = nep_gpc_system_2
				set_star_flag = nep_gpc_pete_girly
			}
		}
		random_rim_system = {
			spawn_system = {
				min_distance >= 20
				max_distance <= 40
				hyperlane = yes
				initializer = "nep_gpc_init_02"
			}
			random_system = {
				limit = { has_star_flag = nep_gpc_system_2 }
				remove_star_flag = nep_gpc_system_2
				set_star_flag = nep_gpc_captain_swift
			}
		}
		random_rim_system = {
			spawn_system = {
				min_distance >= 20
				max_distance <= 40
				hyperlane = yes
				initializer = "nep_gpc_init_02"
			}
			random_system = {
				limit = { has_star_flag = nep_gpc_system_2 }
				remove_star_flag = nep_gpc_system_2
				set_star_flag = nep_gpc_cyrca
			}
		}
		set_spawn_system_batch = end
		country_event = { id = nep_gpc.40031 }
		country_event = { id = nep_gpc.40032 }
		country_event = { id = nep_gpc.40033 }
		country_event = { id = nep_gpc.40034 }
	}
	
	after = {
		every_playable_country = {
			country_event = { id = nep_gpc.40035 }
		}
	}
}

country_event = {
	id = nep_gpc.40031
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		random_system = {
			limit = { has_star_flag = nep_gpc_tawni_balfour }
			random_system_planet = {
				save_event_target_as = pirate_home
				create_country = {
					name = "NAME_nep_Tawni_Balfour"
					type = pirate
					species = event_target:nep_gpc_species_1
					name_list = "PRT1"
					flag = {
						background = {
							category = "backgrounds"
							file = "00_solid.dds"
						}
						colors ={
							"black"
							"black"
							"null"
							"null"
						}
					}
					effect = {
						save_event_target_as = pirate_band
					}
				}
				last_created_country = {
					create_leader = {
						class = admiral
						species = owner_main_species
						name = "NAME_nep_Tawni_Balfour"
						skill = 3
						randomize_traits = yes
					}
					create_fleet = {
						name = "NAME_nep_Tawni_Balfour"
						effect = {
							set_owner = event_target:pirate_band
							create_ship_design = {
								design = "NAME_Pirate_Galleon"
							}
							while = {
								count = 3
								create_ship = {
									name = random
									design = last_created_design
									graphical_culture = "pirate_01"
								}
							}
							create_ship_design = {
								design = "NAME_Skull"
							}
							while = {
								count = 25
								create_ship = {
									name = random
									design = last_created_design
									graphical_culture = "pirate_01"
								}
							}
							create_ship_design = {
								design = "NAME_Brigand"
							}
							while = {
								count = 25
								create_ship = {
									name = random
									design = last_created_design
									graphical_culture = "pirate_01"
								}
							}
							assign_leader = last_created_leader
							set_location = {
								target = event_target:pirate_home
								distance = 10
								angle = random
							}
							set_fleet_stance = aggressive
							set_aggro_range_measure_from = self
							set_aggro_range = 800
							set_fleet_flag = nep_gpc_tawni_balfour_fleet
						}
					}
					create_fleet = {
						name = "NAME_Pirate_Station"
						effect = {
							set_owner = event_target:pirate_band
							create_ship = {
								name = random
								design = "NAME_Pirate_Nest"
								graphical_culture = "pirate_01"
							}
							set_location = event_target:pirate_home
						}
					}
				}
				event_target:pirate_band = {
					randomize_flag_symbol = "pirate"
					every_country = {
						establish_communications_no_message = prev
					}
					set_country_flag = nep_gpc_tawni_balfour
				}
			}
		}
	}
}

country_event = {
	id = nep_gpc.40032
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		random_system = {
			limit = { has_star_flag = nep_gpc_pete_girly }
			random_system_planet = {
				save_event_target_as = pirate_home
				create_country = {
					name = "NAME_nep_Pete_Girly"
					type = pirate
					species = event_target:nep_gpc_species_1
					name_list = "PRT1"
					flag = {
						background = {
							category = "backgrounds"
							file = "00_solid.dds"
						}
						colors ={
							"black"
							"black"
							"null"
							"null"
						}
					}
					effect = {
						save_event_target_as = pirate_band
					}
				}
				last_created_country = {
					create_leader = {
						class = admiral
						species = owner_main_species
						name = "NAME_nep_Pete_Girly"
						skill = 4
						randomize_traits = yes
					}
					create_fleet = {
						name = "NAME_nep_Pete_Girly"
						effect = {
							set_owner = event_target:pirate_band
							create_ship_design = {
								design = "NAME_Pirate_Galleon"
							}
							while = {
								count = 2
								create_ship = {
									name = random
									design = last_created_design
									graphical_culture = "pirate_01"
								}
							}
							create_ship_design = {
								design = "NAME_Skull"
							}
							while = {
								count = 50
								create_ship = {
									name = random
									design = last_created_design
									graphical_culture = "pirate_01"
								}
							}
							create_ship_design = {
								design = "NAME_Brigand"
							}
							while = {
								count = 30
								create_ship = {
									name = random
									design = last_created_design
									graphical_culture = "pirate_01"
								}
							}
							assign_leader = last_created_leader
							set_location = {
								target = event_target:pirate_home
								distance = 10
								angle = random
							}
							set_fleet_stance = aggressive
							set_aggro_range_measure_from = self
							set_aggro_range = 800
							set_fleet_flag = nep_gpc_pete_girly_fleet
						}
					}
					create_fleet = {
						name = "NAME_Pirate_Station"
						effect = {
							set_owner = event_target:pirate_band
							create_ship = {
								name = random
								design = "NAME_Pirate_Nest"
								graphical_culture = "pirate_01"
							}
							set_location = event_target:pirate_home
						}
					}
				}
				event_target:pirate_band = {
					randomize_flag_symbol = "pirate"
					every_country = {
						establish_communications_no_message = prev
					}
					set_country_flag = nep_gpc_pete_girly
				}
			}
		}
	}
}

country_event = {
	id = nep_gpc.40033
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		random_system = {
			limit = { has_star_flag = nep_gpc_captain_swift }
			random_system_planet = {
				save_event_target_as = pirate_home
				create_species = {
					name = random
					class = random_non_machine
					portrait = random
					traits = {
						trait = trait_very_strong
						trait = trait_nomadic
					}
				}
				last_created_species = {
					save_event_target_as = nep_gpc_species_2			
				}
				create_country = {
					name = "NAME_nep_Captain_Swift"
					type = pirate
					species = event_target:nep_gpc_species_2
					name_list = "PRT1"
					flag = {
						background = {
							category = "backgrounds"
							file = "00_solid.dds"
						}
						colors ={
							"black"
							"black"
							"null"
							"null"
						}
					}
					effect = {
						save_event_target_as = pirate_band
					}
				}
				last_created_country = {
					create_leader = {
						class = admiral
						species = owner_main_species
						name = "NAME_nep_Captain_Swift"
						skill = 6
						randomize_traits = yes
					}
					create_fleet = {
						name = "NAME_nep_Captain_Swift"
						effect = {
							set_owner = event_target:pirate_band
							create_ship_design = {
								design = "NAME_Pirate_Galleon"
							}
							while = {
								count = 5
								create_ship = {
									name = random
									design = last_created_design
									graphical_culture = "pirate_01"
								}
							}
							create_ship_design = {
								design = "NAME_Corsair"
							}
							while = {
								count = 8
								create_ship = {
									name = random
									design = last_created_design
									graphical_culture = "pirate_01"
								}
							}
							create_ship_design = {
								design = "NAME_Black_Earl"
							}
							while = {
								count = 20
								create_ship = {
									name = random
									design = last_created_design
									graphical_culture = "pirate_01"
								}
							}
							assign_leader = last_created_leader
							set_location = {
								target = event_target:pirate_home
								distance = 10
								angle = random
							}
							set_fleet_stance = aggressive
							set_aggro_range_measure_from = self
							set_aggro_range = 800
							set_fleet_flag = nep_gpc_captain_swift_fleet
						}
					}
					create_fleet = {
						name = "NAME_Pirate_Station"
						effect = {
							set_owner = event_target:pirate_band
							create_ship = {
								name = random
								design = "NAME_Pirate_Nest"
								graphical_culture = "pirate_01"
							}
							set_location = event_target:pirate_home
						}
					}
				}
				event_target:pirate_band = {
					randomize_flag_symbol = "pirate"
					every_country = {
						establish_communications_no_message = prev
					}
					set_country_flag = nep_gpc_captain_swift
				}
			}
		}
	}
}


country_event = {
	id = nep_gpc.40034
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		random_system = {
			limit = { has_star_flag = nep_gpc_cyrca }
			random_system_planet = {
				save_event_target_as = pirate_home
				create_species = {
					name = random
					class = random_non_machine
					portrait = random
					traits = {
						trait = trait_very_strong
						trait = trait_nomadic
					}
				}
				last_created_species = {
					save_event_target_as = nep_gpc_species_2			
				}
				create_country = {
					name = "NAME_nep_Cyrca"
					type = pirate
					species = event_target:nep_gpc_species_2
					name_list = "PRT1"
					flag = {
						background = {
							category = "backgrounds"
							file = "00_solid.dds"
						}
						colors ={
							"black"
							"black"
							"null"
							"null"
						}
					}
					effect = {
						save_event_target_as = pirate_band
					}
				}
				last_created_country = {
					create_leader = {
						class = admiral
						species = owner_main_species
						name = "NAME_nep_Cyrca"
						skill = 3
						randomize_traits = yes
					}
					create_fleet = {
						name = "NAME_nep_Cyrca"
						effect = {
							set_owner = event_target:pirate_band
							create_ship_design = {
								design = "NAME_Pirate_Galleon"
							}
							while = {
								count = 1
								create_ship = {
									name = random
									design = last_created_design
									graphical_culture = "pirate_01"
								}
							}
							create_ship_design = {
								design = "NAME_Skull"
							}
							while = {
								count = 50
								create_ship = {
									name = random
									design = last_created_design
									graphical_culture = "pirate_01"
								}
							}
							create_ship_design = {
								design = "NAME_Brigand"
							}
							while = {
								count = 50
								create_ship = {
									name = random
									design = last_created_design
									graphical_culture = "pirate_01"
								}
							}
							assign_leader = last_created_leader
							set_location = {
								target = event_target:pirate_home
								distance = 10
								angle = random
							}
							set_fleet_stance = aggressive
							set_aggro_range_measure_from = self
							set_aggro_range = 800
							set_fleet_flag = nep_gpc_cyrca_fleet
						}
					}
					create_fleet = {
						name = "NAME_Pirate_Station"
						effect = {
							set_owner = event_target:pirate_band
							create_ship = {
								name = random
								design = "NAME_Pirate_Nest"
								graphical_culture = "pirate_01"
							}
							set_location = event_target:pirate_home
						}
					}
				}
				event_target:pirate_band = {
					randomize_flag_symbol = "pirate"
					every_country = {
						establish_communications_no_message = prev
					}
					set_country_flag = nep_gpc_cyrca
				}
			}
		}
	}
}

country_event = {
	id = nep_gpc.40035
	title = nep_gpc.40035.name
	desc = nep_gpc.40035.desc
	picture = GFX_evt_pirate_armada
		
	is_triggered_only = yes
	
	immediate = {
		random_system = {
			limit = { has_star_flag = nep_gpc_tawni_balfour }
			random_system_planet = {
				limit = { is_star = yes }
				save_event_target_as = nep_gpc_tawni_balfour_system
			}
		}
		random_system = {
			limit = { has_star_flag = nep_gpc_pete_girly }
			random_system_planet = {
				limit = { is_star = yes }
				save_event_target_as = nep_gpc_pete_girly_system
			}
		}
		random_system = {
			limit = { has_star_flag = nep_gpc_captain_swift }
			random_system_planet = {
				limit = { is_star = yes }
				save_event_target_as = nep_gpc_captain_swift_system
			}
		}
		random_system = {
			limit = { has_star_flag = nep_gpc_cyrca }
			random_system_planet = {
				limit = { is_star = yes }
				save_event_target_as = nep_gpc_cyrca_system
			}
		}
	}
	
	option = {
		name = nep_gpc.40035.a
		begin_event_chain = { event_chain = nep_gpc_chain target = root }		
		create_point_of_interest = {
			id = nep_gpc_poi.1
			name = "nep_gpc_tawni_balfour_poi_name"
			desc = "nep_gpc_tawni_balfour_poi_desc"
			event_chain = nep_gpc_chain
			location = event_target:nep_gpc_tawni_balfour_system
		}
		create_point_of_interest = {
			id = nep_gpc_poi.2
			name = "nep_gpc_pete_girly_poi_name"
			desc = "nep_gpc_pete_girly_poi_desc"
			event_chain = nep_gpc_chain
			location = event_target:nep_gpc_pete_girly_system
		}
		create_point_of_interest = {
			id = nep_gpc_poi.3
			name = "nep_gpc_captain_swift_poi_name"
			desc = "nep_gpc_captain_swift_poi_desc"
			event_chain = nep_gpc_chain
			location = event_target:nep_gpc_captain_swift_system
		}
		create_point_of_interest = {
			id = nep_gpc_poi.4
			name = "nep_gpc_cyrca_poi_name"
			desc = "nep_gpc_cyrca_poi_desc"
			event_chain = nep_gpc_chain
			location = event_target:nep_gpc_cyrca_system
		}
	}
}

#on_entering_system
ship_event = {
	id = nep_gpc.4004
	title = nep_gpc.4004.name
	desc = {
		trigger = { 
			from = { 
				has_star_flag = nep_gpc_tawni_balfour
				any_fleet_in_system = {
					has_fleet_flag = nep_gpc_tawni_balfour_fleet
				}
			} 
		}
		text = nep_gpc.4004.desc.a
	}
	desc = {
		trigger = { 
			from = { 
				has_star_flag = nep_gpc_tawni_balfour
				NOT = {
					any_fleet_in_system = {
						has_fleet_flag = nep_gpc_tawni_balfour_fleet
					}
				}
			} 
		}
		text = nep_gpc.4004.desc.a2
	}
	desc = {
		trigger = { 
			from = { 
				has_star_flag = nep_gpc_pete_girly
				any_fleet_in_system = {
					has_fleet_flag = nep_gpc_pete_girly_fleet
				}
			} 
		}
		text = nep_gpc.4004.desc.b
	}
	desc = {
		trigger = { 
			from = { 
				has_star_flag = nep_gpc_pete_girly
				NOT = {
					any_fleet_in_system = {
						has_fleet_flag = nep_gpc_pete_girly_fleet
					}
				}
			} 
		}
		text = nep_gpc.4004.desc.b2
	}
	desc = {
		trigger = { 
			from = { 
				has_star_flag = nep_gpc_captain_swift 
				any_fleet_in_system = {
					has_fleet_flag = nep_gpc_captain_swift_fleet
				}
			}				
		}
		text = nep_gpc.4004.desc.c
	}
	desc = {
		trigger = { 
			from = { 
				has_star_flag = nep_gpc_captain_swift 
				NOT = {
					any_fleet_in_system = {
						has_fleet_flag = nep_gpc_captain_swift_fleet
					}
				}
			}
		}
		text = nep_gpc.4004.desc.c2
	}
	desc = {
		trigger = { 
			from = { 
				has_star_flag = nep_gpc_cyrca 
				any_fleet_in_system = {
					has_fleet_flag = nep_gpc_cyrca_fleet
				}				
			} 
		}
		text = nep_gpc.4004.desc.d
	}
	desc = {
		trigger = { 
			from = { 
				has_star_flag = nep_gpc_cyrca 
				NOT = {
					any_fleet_in_system = {
						has_fleet_flag = nep_gpc_cyrca_fleet
					}
				}
			} 
		}
		text = nep_gpc.4004.desc.d2
	}
	picture = GFX_evt_pirate_armada
		
	is_triggered_only = yes
	
	trigger = {
		fromfrom = { is_ai = no }
		has_global_flag = nep_gpc_pirate_waves
		from = {
			OR = {
				has_star_flag = nep_gpc_tawni_balfour
				has_star_flag = nep_gpc_pete_girly
				has_star_flag = nep_gpc_captain_swift
				has_star_flag = nep_gpc_cyrca
			}
		}
		fromfrom = {
			NOR = {
				has_country_flag = nep_gpc_tawni_balfour_met
				has_country_flag = nep_gpc_pete_girly_met
				has_country_flag = nep_gpc_captain_swift_met
				has_country_flag = nep_gpc_cyrca_met
			}
		}
	}
	
	immediate = {
		if = {
			limit = { from = { has_star_flag = nep_gpc_tawni_balfour } }
			fromfrom = { set_country_flag = nep_gpc_tawni_balfour_met }
		}
		if = {
			limit = { from = { has_star_flag = nep_gpc_pete_girly } }
			fromfrom = { set_country_flag = nep_gpc_pete_girly_met }
		}
		if = {
			limit = { from = { has_star_flag = nep_gpc_captain_swift } }
			fromfrom = { set_country_flag = nep_gpc_captain_swift_met }
		}
		if = {
			limit = { from = { has_star_flag = nep_gpc_cyrca } }
			fromfrom = { set_country_flag = nep_gpc_cyrca_met }
		}
	}
	
	option = {
		name = nep_gpc.4004.a
	}
}

#on_fleet_destroyed_perp
country_event = {
	id = nep_gpc.4005
	title = nep_gpc.4005.name
	desc = {
		trigger = { from = { has_country_flag = nep_gpc_tawni_balfour } }
		text = nep_gpc.4005.desc.a
	}
	desc = {
		trigger = { from = { has_country_flag = nep_gpc_pete_girly } }
		text = nep_gpc.4005.desc.b
	}
	desc = {
		trigger = { from = { has_country_flag = nep_gpc_captain_swift } }
		text = nep_gpc.4005.desc.c
	}
	desc = {
		trigger = { from = { has_country_flag = nep_gpc_cyrca } }
		text = nep_gpc.4005.desc.d
	}
	picture = GFX_evt_large_explosion
		
	is_triggered_only = yes
	
	trigger = {
		has_global_flag = nep_gpc_pirate_waves
		from = {
			OR = {
				has_country_flag = nep_gpc_tawni_balfour
				has_country_flag = nep_gpc_pete_girly
				has_country_flag = nep_gpc_captain_swift
				has_country_flag = nep_gpc_cyrca
			}
		}
		fromfromfrom = {
			NOT = { is_ship_size = pirate_station }
		}
	}
	
	immediate = {
		if = {
			limit = { from = { has_country_flag = nep_gpc_tawni_balfour } }
			root = { set_country_flag = nep_gpc_tawni_balfour_clue_get }
		}
		if = {
			limit = { from = { has_country_flag = nep_gpc_pete_girly } }
			root = { set_country_flag = nep_gpc_pete_girly_clue_get }
		}
		if = {
			limit = { from = { has_country_flag = nep_gpc_captain_swift } }
			root = { set_country_flag = nep_gpc_captain_swift_clue_get }
		}
		if = {
			limit = { from = { has_country_flag = nep_gpc_cyrca } }
			root = { set_country_flag = nep_gpc_cyrca_clue_get }
		}
	}
	
	option = {
		name = nep_gpc.4005.a
		add_event_chain_counter = {
			event_chain = "nep_gpc_chain"
			counter = "nep_gpc_clues"
			amount = 1			
		}
		hidden_effect = {
			if = {
				limit = {
					has_country_flag = nep_gpc_tawni_balfour_clue_get
				}
				remove_point_of_interest = nep_gpc_poi.1
			}
			if = {
				limit = {
					has_country_flag = nep_gpc_pete_girly_clue_get
				}
				remove_point_of_interest = nep_gpc_poi.2
			}
			if = {
				limit = {
					has_country_flag = nep_gpc_captain_swift_clue_get
				}
				remove_point_of_interest = nep_gpc_poi.3
			}
			if = {
				limit = {
					has_country_flag = nep_gpc_cyrca_clue_get
				}
				remove_point_of_interest = nep_gpc_poi.4
			}
			if = {
				limit = {
					has_country_flag = nep_gpc_tawni_balfour_clue_get
					has_country_flag = nep_gpc_pete_girly_clue_get
					has_country_flag = nep_gpc_captain_swift_clue_get
					has_country_flag = nep_gpc_cyrca_clue_get
				}
				country_event = { id = nep_gpc.5 }
			}
		}
	}
}


fleet_event = {
	id = nep_gpc.40051
	hide_window = yes
	
	is_triggered_only = yes
	
	trigger = {
		has_global_flag = nep_gpc_pirate_waves
		OR = {
			AND = {
				from = { has_star_flag = nep_gpc_tawni_balfour }
				any_country = { has_country_flag = nep_gpc_tawni_balfour_clue_get }
				owner = { NOT = { has_country_flag = nep_gpc_tawni_balfour_clue_get } }
			}
			AND = {
				from = { has_star_flag = nep_gpc_pete_girly }
				any_country = { has_country_flag = nep_gpc_pete_girly_clue_get }
				owner = { NOT = { has_country_flag = nep_gpc_pete_girly_clue_get } }
			}
			AND = {
				from = { has_star_flag = nep_gpc_captain_swift }
				any_country = { has_country_flag = nep_gpc_captain_swift_clue_get }
				owner = { NOT = { has_country_flag = nep_gpc_captain_swift_clue_get } }
			}
			AND = {
				from = { has_star_flag = nep_gpc_cyrca }
				any_country = { has_country_flag = nep_gpc_cyrca_clue_get }
				owner = { NOT = { has_country_flag = nep_gpc_cyrca_clue_get } }
			}
		}
	}
	
	immediate = {
		owner = { country_event = { id = nep_gpc.40052 days = 40 } }
	}
}

country_event = {
	id = nep_gpc.40052
	title = nep_gpc.40052.name
	desc = {
		trigger = { fromfrom = { has_star_flag = nep_gpc_tawni_balfour } }
		text = nep_gpc.40052.desc.a
	}
	desc = {
		trigger = { fromfrom = { has_star_flag = nep_gpc_pete_girly } }
		text = nep_gpc.40052.desc.b
	}
	desc = {
		trigger = { fromfrom = { has_star_flag = nep_gpc_captain_swift } }
		text = nep_gpc.40052.desc.c
	}
	desc = {
		trigger = { fromfrom = { has_star_flag = nep_gpc_cyrca } }
		text = nep_gpc.40052.desc.d
	}
	picture = GFX_evt_ancient_records
	
	is_triggered_only = yes
	
	trigger = {
		has_global_flag = nep_gpc_pirate_waves
		from = {
			exists = solar_system
			solar_system = {
				is_same_value = root.fromfrom
			}
		}
	}
	
	immediate = {
		if = {
			limit = { fromfrom = { has_star_flag = nep_gpc_tawni_balfour } }
			root = { set_country_flag = nep_gpc_tawni_balfour_clue_get }
		}
		if = {
			limit = { fromfrom = { has_star_flag = nep_gpc_pete_girly } }
			root = { set_country_flag = nep_gpc_pete_girly_clue_get }
		}
		if = {
			limit = { fromfrom = { has_star_flag = nep_gpc_captain_swift } }
			root = { set_country_flag = nep_gpc_captain_swift_clue_get }
		}
		if = {
			limit = { fromfrom = { has_star_flag = nep_gpc_cyrca } }
			root = { set_country_flag = nep_gpc_cyrca_clue_get }
		}
		
	}
	
	option = {
		name = nep_gpc.40052.a
		add_event_chain_counter = {
			event_chain = "nep_gpc_chain"
			counter = "nep_gpc_clues"
			amount = 1
		}
		hidden_effect = {
			if = {
				limit = {
					has_country_flag = nep_gpc_tawni_balfour_clue_get
				}
				remove_point_of_interest = nep_gpc_poi.1
			}
			if = {
				limit = {
					has_country_flag = nep_gpc_pete_girly_clue_get
				}
				remove_point_of_interest = nep_gpc_poi.2
			}
			if = {
				limit = {
					has_country_flag = nep_gpc_captain_swift_clue_get
				}
				remove_point_of_interest = nep_gpc_poi.3
			}
			if = {
				limit = {
					has_country_flag = nep_gpc_cyrca_clue_get
				}
				remove_point_of_interest = nep_gpc_poi.4
			}
			if = {
				limit = {
					has_country_flag = nep_gpc_tawni_balfour_clue_get
					has_country_flag = nep_gpc_pete_girly_clue_get
					has_country_flag = nep_gpc_captain_swift_clue_get
					has_country_flag = nep_gpc_cyrca_clue_get
				}
				country_event = { id = nep_gpc.5 }
			}
		}
	}
}

country_event = {
	id = nep_gpc.4010
	hide_window = yes
	
	is_triggered_only = yes
	
	trigger = {
		has_global_flag = nep_gpc_pirate_waves		
	}
	
	immediate = {
		random_system = {
			limit = { NOT = { exists = space_owner } }
			closest_system = {
				limit = { exists = space_owner }
				space_owner = {
					species = {
						save_event_target_as = nep_4010_temp
					}
				}
			}
			random_system_planet = {
				save_event_target_as = pirate_home
				create_country = {
					name = "NAME_Pirates"
					type = pirate
					species = event_target:nep_4010_temp
					name_list = "PRT1"
					flag = {
						background = {
							category = "backgrounds"
							file = "00_solid.dds"
						}
						colors ={
							"black"
							"black"
							"null"
							"null"
						}
					}
					effect = {
						save_event_target_as = pirate_band
					}
				}
				last_created_country = {
					create_leader = {
						class = admiral
						species = owner_main_species
						name = random
						skill = 1
						randomize_traits = yes
					}
					random_list = {
						1 = {
							create_fleet = {
								name = "NAME_Young_Blood"
								effect = {
									set_owner = event_target:pirate_band
									create_ship_design = {
										design = "NAME_Reaver"
									}
									while = {
										count = 12
										create_ship = {
											name = random
											design = last_created_design
											graphical_culture = "pirate_01"
										}
									}
									set_location = {
										target = event_target:pirate_home
										distance = 90
										angle = 200
									}									
									assign_leader = last_created_leader
									set_fleet_stance = aggressive
									set_aggro_range_measure_from = self
									set_aggro_range = 150
								}
							}
						}
						1 = {
							create_fleet = {
								name = "NAME_Scarred_Veterans"
								effect = {
									set_owner = event_target:pirate_band
									while = {
										count = 6
										create_ship = {
											name = random
											design = "NAME_Corsair"
											graphical_culture = "pirate_01"
										}
									}
									while = {
										count = 10
										create_ship = {
											name = random
											design = "NAME_Marauder"
											graphical_culture = "pirate_01"
										}
									}
									while = {
										count = 20
										create_ship = {
											name = random
											design = "NAME_Black_Earl"
											graphical_culture = "pirate_01"
										}
									}
									while = {
										count = 4
										create_ship = {
											name = random
											design = "NAME_Skull"
											graphical_culture = "pirate_01"
										}
									}
									assign_leader = last_created_leader
									set_formation_scale = 2
									set_fleet_stance = aggressive
									set_aggro_range_measure_from = self
									set_aggro_range = 250
									set_location = {
										target = event_target:pirate_home
										distance = 90
										angle = 120
									}
								}
							}
						}
						1 = {
							create_fleet = {
								name = "NAME_Old_Guard"
								effect = {
									set_owner = event_target:pirate_band
									while = {
										count = 1
										create_ship = {
											name = random
											design = "NAME_Pirate_Galleon"
											graphical_culture = "pirate_01"
										}
									}
									assign_leader = last_created_leader
									set_fleet_stance = aggressive
									set_aggro_range_measure_from = self
									set_aggro_range = 250
									set_location = {
										target = event_target:pirate_home
										distance = 90
										angle = 330
									}
								}
							}
						}
					}
					create_fleet = {
						name = "NAME_Pirate_Station"
						effect = {
							set_owner = event_target:pirate_band
							create_ship = {
								name = random
								design = "NAME_Pirate_Nest"
								graphical_culture = "pirate_01"
							}
							set_location = event_target:pirate_home
						}
					}
				}
				event_target:pirate_band = {
					set_name = random
					randomize_flag_symbol = "pirate"
					every_country = {
						establish_communications_no_message = prev
					}
				}
			}
		}
	}
}

country_event = {
	id = nep_gpc.4099
	hide_window = yes
	
	is_triggered_only = yes
	
	trigger = {
		has_global_flag = nep_gpc_pirate_waves
	}
	
	immediate = {
		remove_global_flag = nep_gpc_pirate_waves
		every_playable_country = {
			country_event = { id = nep_gpc.40990 }
		}
	}
}

country_event = {
	id = nep_gpc.40990
	title = nep_gpc.40990.name
	desc = nep_gpc.40990.desc
	picture = GFX_evt_pirate_armada
		
	is_triggered_only = yes
	
	immediate = {
	}
	
	option = {
		name = nep_gpc.40990.a
		remove_modifier = nep_gpc_piracy
		add_monthly_resource_mult = {
			resource = unity
			value = 10
			min = 200
			max = 9999
		}
	}
}

country_event = {
	id = nep_gpc.5
	title = nep_gpc.5.name
	desc = nep_gpc.5.desc
	picture = GFX_evt_pirate_armada
	
	is_triggered_only = yes
	
	immediate = {
		random_rim_system = {
			random_system_planet = {
				save_event_target_as = nep_gpc_target
			}
		}
	}
	
	option = {
		name = nep_gpc.5.a
		enable_special_project = {
			name = "nep_gpc_project"
			location = event_target:nep_gpc_target
			owner = root
		}
	}
}

ship_event = {
	id = nep_gpc.6000
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		solar_system = {		
			spawn_system = {
				min_distance >= 20
				max_distance <= 40
				hyperlane = no
				initializer = "nep_gpc_init_03"
			}
			random_system = {
				limit = { has_star_flag = nep_gpc_system_3 }
				save_event_target_as = nep_gpc_6000_temp
			}
			add_hyperlane = { from = event_target:nep_gpc_6000_temp to = this }
		}
	}
}

country_event = {
	id = nep_gpc.6
	title = nep_gpc.6.name
	desc = nep_gpc.6.desc
	picture = GFX_evt_pirate_armada
	
	is_triggered_only = yes
	
	immediate = {
		every_playable_country = {
			limit = { has_event_chain = nep_gpc_chain }
			end_event_chain = nep_gpc_chain			
		}
	}
	
	option = {
		name = nep_gpc.6.a
	}
}

#on_fleet_destroyed_perp
country_event = {
	id = nep_gpc.6001
	title = nep_gpc.6001.name
	desc = nep_gpc.6001.desc
	picture = GFX_evt_exploding_ship
	
	is_triggered_only = yes
	
	fire_only_once = yes
	
	trigger = {
		fromfromfrom = {
			has_fleet_flag = nep_gpc_machine_gun_fort
		}
	}
	
	immediate = {
		
	}
	
	option = {
		name = nep_gpc.6001.a
		random_galaxy_planet = {
			limit = { has_planet_flag = nep_gpc_base }
			create_archaeological_site = nep_gpc_site
		}
	}
}

fleet_event = {
	id = nep_gpc.6002
	title = "nep_gpc.6002.name"
	desc = "nep_gpc.6002.desc"
	picture = GFX_evt_cold_barren
	show_sound = event_scanner
	
	archaeology = yes
	is_triggered_only = yes
	
	immediate = {
		from = { set_site_progress_locked = yes }
	}

	after = { 
		from = { set_site_progress_locked = no } 
	}
	
	option = {
		name = DIG
		owner = {
			add_resource = {
				alloys = 50
			}
		}
	}
}


fleet_event = {
	id = nep_gpc.6003
	title = "nep_gpc.6002.name"
	desc = "nep_gpc.6003.desc"
	picture = GFX_evt_discovered_hidden_door
	show_sound = event_door_opening
	
	archaeology = yes
	is_triggered_only = yes
	
	immediate = {
		from = { set_site_progress_locked = yes }
	}

	after = { 
		from = { set_site_progress_locked = no } 
	}
	
	option = {
		name = nep_gpc.6003.a #open the door
		owner = {
			add_resource = {
				energy = -500
			}
		}
	}
}


fleet_event = {
	id = nep_gpc.7
	title = "nep_gpc.7.name"
	desc = "nep_gpc.7.desc"
	picture = GFX_evt_generator_powerup
	show_sound = event_door_opening
	archaeology = yes
	is_triggered_only = yes
	
	immediate = {
		from = { set_site_progress_locked = yes }
	}

	after = { 
		from = { set_site_progress_locked = no } 
	}
	
	option = {
		name = nep_gpc.7.a
		owner = { 
			add_relic = r_nep_alchemist_box
			large_artifact_reward = yes
			remove_modifier = nep_gpc_piracy
		}
		hidden_effect = {
			remove_global_flag = nep_gpc_pirate_waves
			every_playable_country = {
				limit = { NOT = { is_same_value = root.owner } }
				country_event = { id = nep_gpc.7000 }
			}
			set_global_flag = nep_gpc_end
		}
	}
}

country_event = {
	id = nep_gpc.7000
	title = nep_gpc.7000.name
	desc = nep_gpc.7000.desc
	picture = GFX_evt_news_room
		
	is_triggered_only = yes
	
	immediate = { }
	
	option = {
		name = nep_gpc.7000.a
		remove_modifier = nep_gpc_piracy
	}
}

###############################################
# Bounty Office
###############################################
namespace = nep_bo
country_event = {
	id = nep_bo.0
	hide_window = yes
	
	is_triggered_only = yes
	
	fire_only_once = yes
	
	trigger = {
		is_multiplayer = no
		is_ai = no
		any_system = {
			has_star_flag = caravaneer_home
		}
	}
	
	immediate = {
		random_system = {
			limit = { 
				has_star_flag = caravaneer_home
			}
			spawn_megastructure = {
				type = "nep_caravaneer_gate_mega"
				random_pos = yes
				orbit_angle = 360		# range of the randomization
			}
		}
		#country_event = { id = nep_bo.1 days = 5 }
		country_event = { id = nep_ar.1 days = 5 }
	}
}

country_event = {
	id = nep_bo.1
	hide_window = yes
	
	is_triggered_only = yes
	
	fire_only_once = yes
	
	immediate = {
		no_scope = {
			spawn_system = {
				min_distance >= 482
				max_distance <= 494
				min_orientation_angle = 210
				max_orientation_angle = 280
				hyperlane = no
				initializer = nep_bounty_office_init
			}
		}
		random_system = {
			limit = { 
				has_star_flag = nep_bounty_office_system
			}
			spawn_megastructure = {
				type = "nep_caravaneer_gate_mega"
				random_pos = yes
				orbit_angle = 360		# range of the randomization
			}
		}
	}
}

country_event = {
	id = nep_bo.1000
	hide_window = yes
	
	is_triggered_only = yes
	
	trigger = {
		OR = {
			has_country_flag = caravaneer_home_country
			from = { has_country_flag = caravaneer_home_country }
		}
	}
	
	immediate = {		
		establish_communications_no_message = event_target:nep_bounty_office_country
		from = { establish_communications_no_message = event_target:nep_bounty_office_country }
	}
}

country_event = {
	id = nep_bo.2
	hide_window = yes
	
	is_triggered_only = yes
	
}
###############################################
# Arena
###############################################
namespace = nep_ar
country_event = {
	id = nep_ar.1
	hide_window = yes
	
	is_triggered_only = yes
	
	fire_only_once = yes
	
	immediate = {
		no_scope = {
			spawn_system = {
				min_distance >= 491
				max_distance <= 491
				min_orientation_angle = 140
				max_orientation_angle = 140
				hyperlane = no
				initializer = nep_arena_office_init
			}
		}
		no_scope = {
			spawn_system = {
				min_distance >= 491
				max_distance <= 491
				min_orientation_angle = 135
				max_orientation_angle = 135
				hyperlane = no
				initializer = nep_arena_init
			}
		}
		random_system = {
			limit = { 
				has_star_flag = nep_arena_office_system
			}
			spawn_megastructure = {
				type = "nep_caravaneer_gate_mega"
				random_pos = yes
				orbit_angle = 360		# range of the randomization
			}
			spawn_megastructure = {
				type = "nep_arena_gate_mega"
				planet = star
				#coords_from = planet
				orbit_distance = 38
				orbit_angle = 182
			}
		}
		random_system = {
			limit = { 
				has_star_flag = nep_arena
			}
			spawn_megastructure = {
				type = "nep_arena_gate_mega"
				planet = star
				#coords_from = planet
				orbit_distance = 125
				orbit_angle = 180
			}
		}
	}
}

country_event = {
	id = nep_ar.1000
	hide_window = yes
	
	is_triggered_only = yes
	
	trigger = {
		OR = {
			has_country_flag = caravaneer_home_country
			from = { has_country_flag = caravaneer_home_country }
		}
	}
	
	immediate = {		
		establish_communications_no_message = event_target:nep_arena_office_country
		from = { establish_communications_no_message = event_target:nep_arena_office_country }
		if = {
			limit = { exists = event_target:nep_arena_hologram }
			establish_communications_no_message = event_target:nep_arena_hologram
			from = { establish_communications_no_message = event_target:nep_arena_hologram }
		}
	}
}

event = {
	id = nep_ar.1001
	hide_window = yes
	
	is_triggered_only = yes
	
	trigger = {
		exists = event_target:caravaneer_home_country
		exists = event_target:nep_arena_office_country
	}
	
	immediate = {
		random_system = {
			limit = { has_star_flag = nep_arena }			
			if = { 
				limit = { 
					any_fleet_in_system = { 
						NOR = {
							has_fleet_flag = nep_arena_target_1
							has_fleet_flag = nep_arena_target_2
							has_fleet_flag = nep_arena_target_3
							has_fleet_flag = nep_arena_target_4
						}
					}
				}
				event_target:caravaneer_home_country = { country_event = { id = nep_ar.1002 days = 180 } }
			}
			else = {
				if = {
					limit = { NOT = { exists = event_target:nep_arena_hologram } }
					create_country = {
						name = "NAME_nep_arena_hologram"
						type = nep_arena_hologram
						effect = {
							save_global_event_target_as = nep_arena_hologram
							every_country = {
								limit = { has_communications = event_target:caravaneer_home_country }
								establish_communications_no_message = event_target:caravaneer_home_country
							}
						}
					}
				}
				if = { 
					limit = { exists = event_target:nep_arena_target_1 }
					delete_fleet = { target = event_target:nep_arena_target_1 destroy_template = yes }
				}
				if = { 
					limit = { exists = event_target:nep_arena_target_2 }
					delete_fleet = { target = event_target:nep_arena_target_2 destroy_template = yes }
				}
				if = { 
					limit = { exists = event_target:nep_arena_target_3 }
					delete_fleet = { target = event_target:nep_arena_target_3 destroy_template = yes }
				}
				if = { 
					limit = { exists = event_target:nep_arena_target_4 }
					delete_fleet = { target = event_target:nep_arena_target_4 destroy_template = yes }
				}
				system_event = { id = nep_ar.4001 } #nep_create_enemy_1 = yes
				system_event = { id = nep_ar.4002 } #nep_create_enemy_2 = yes
				system_event = { id = nep_ar.4003 } #nep_create_enemy_3 = yes
				system_event = { id = nep_ar.4004 } #nep_create_enemy_4 = yes
				every_country = {
					limit = { has_country_flag = nep_arena_registered }
					country_event = { id = nep_ar.1003 } 
				}
				every_country = {
					limit = { has_country_flag = nep_arena_challenged }
					country_event = { id = nep_ar.1004 } 
				}
			}
		}
	}
}

country_event = {
	id = nep_ar.1002
	hide_window = yes
	
	is_triggered_only = yes
	
	trigger = {
		exists = event_target:caravaneer_home_country
		exists = event_target:nep_arena_office_country
	}
	
	immediate = {
		random_system = {
			limit = { has_star_flag = nep_arena }			
			if = { 
				limit = { 
					any_fleet_in_system = { 
						NOR = {
							has_fleet_flag = nep_arena_target_1
							has_fleet_flag = nep_arena_target_2
							has_fleet_flag = nep_arena_target_3
							has_fleet_flag = nep_arena_target_4
						}
					}
				}
				event_target:caravaneer_home_country = { country_event = { id = nep_ar.1002 days = 180 } }
			}
			else = {
				if = {
					limit = { NOT = { exists = event_target:nep_arena_hologram } }
					create_country = {
						name = "NAME_nep_arena_hologram"
						type = nep_arena_hologram
						effect = {
							save_global_event_target_as = nep_arena_hologram
							every_country = {
								limit = { has_communications = event_target:caravaneer_home_country }
								establish_communications_no_message = event_target:caravaneer_home_country
							}
						}
					}
				}
				if = { 
					limit = { exists = event_target:nep_arena_target_1 }
					delete_fleet = { target = event_target:nep_arena_target_1 destroy_template = yes }
				}
				if = { 
					limit = { exists = event_target:nep_arena_target_2 }
					delete_fleet = { target = event_target:nep_arena_target_2 destroy_template = yes }
				}
				if = { 
					limit = { exists = event_target:nep_arena_target_3 }
					delete_fleet = { target = event_target:nep_arena_target_3 destroy_template = yes }
				}
				if = { 
					limit = { exists = event_target:nep_arena_target_4 }
					delete_fleet = { target = event_target:nep_arena_target_4 destroy_template = yes }
				}
				system_event = { id = nep_ar.4001 } #nep_create_enemy_1 = yes
				system_event = { id = nep_ar.4002 } #nep_create_enemy_2 = yes
				system_event = { id = nep_ar.4003 } #nep_create_enemy_3 = yes
				system_event = { id = nep_ar.4004 } #nep_create_enemy_4 = yes
				every_country = {
					limit = { has_country_flag = nep_arena_registered }
					country_event = { id = nep_ar.1003 } 
				}
				every_country = {
					limit = { has_country_flag = nep_arena_challenged }
					country_event = { id = nep_ar.1004 } 
				}
			}
		}
	}
}

country_event = {
	id = nep_ar.1003
	title = cara_nep_arena_office.title
	custom_gui = "enclave_caravaneer_window"
	desc = nep_ar.1003.desc
	
	picture_event_data = {
		portrait = event_target:caravaneer_home_country
		room = caravaneer_home_room
		planet_background = pc_city
	}
	
	diplomatic = yes
	is_triggered_only = yes
	
	immediate = { remove_country_flag = nep_arena_registered }
	
	option = {
		name = OK
	}
}

country_event = {
	id = nep_ar.1004
	title = cara_nep_arena_office.title
	custom_gui = "enclave_caravaneer_window"
	desc = nep_ar.1004.desc
	
	picture_event_data = {
		portrait = event_target:caravaneer_home_country
		room = caravaneer_home_room
		planet_background = pc_city
	}
	
	diplomatic = yes
	is_triggered_only = yes
	
	immediate = { remove_country_flag = nep_arena_challenged }
	
	option = {
		name = OK
	}
}

country_event = {
	id = nep_ar.2
	title = cara_nep_arena_office.title
	custom_gui = "enclave_caravaneer_window"
	desc = {
		trigger = { has_global_flag = nep_arena_battleing }
		text = nep_ar.2.desc.a
	}
	desc = {
		trigger = { NOT = { has_global_flag = nep_arena_battleing } }
		text = nep_ar.2.desc.b
	}
	
	picture_event_data = {
		portrait = event_target:caravaneer_home_country
		room = caravaneer_home_room
		planet_background = pc_city
	}
	
	diplomatic = yes
	is_triggered_only = yes
	
	trigger = {
		is_ai = no
		exists = event_target:nep_arena_office_country
		from = { is_same_value = event_target:nep_arena_office_country }
		has_communications = event_target:caravaneer_home_country
		exists = event_target:caravaneer_home_country
	}
	
	picture_event_data = {
		portrait = event_target:caravaneer_home_country
		room = caravaneer_home_room
		planet_background = pc_city
	}
	
	option = {
		name = nep_ar.2.1
		trigger = { 
			NOT = { has_global_flag = nep_arena_battleing } 
			exists = event_target:nep_arena_target_1 
		}		
		hidden_effect = {
			event_target:nep_arena_target_1 = { nep_fleet_rating_arena = yes }
			country_event = { id = nep_ar.2001 }
		}
	}
	option = {
		name = nep_ar.2.2
		trigger = { 
			NOT = { has_global_flag = nep_arena_battleing } 
			exists = event_target:nep_arena_target_2 
		}		
		hidden_effect = {
			event_target:nep_arena_target_2 = { nep_fleet_rating_arena = yes }
			country_event = { id = nep_ar.2002 }
		}
	}
	option = {
		name = nep_ar.2.3
		trigger = { 
			NOT = { has_global_flag = nep_arena_battleing } 
			exists = event_target:nep_arena_target_3 
		} 	
		hidden_effect = {
			event_target:nep_arena_target_3 = { nep_fleet_rating_arena = yes }
			country_event = { id = nep_ar.2003 }
		}
	}
	option = {
		name = nep_ar.2.4
		trigger = { 
			NOT = { has_global_flag = nep_arena_battleing } 
			exists = event_target:nep_arena_target_4 
		}	
		hidden_effect = {
			event_target:nep_arena_target_4 = { nep_fleet_rating_arena = yes }
			country_event = { id = nep_ar.2004 }
		}
	}
	
	option = {
		name = nep_ar.2.5
		trigger = { has_global_flag = nep_arena_battleing }
		response_text = nep_ar.2.5.response
		is_dialog_only = yes
	}
	
	option = {
		name = fedel.501.e
		default_hide_option = yes
	}
}

country_event = {
	id = nep_ar.2001
	title = cara_nep_arena_office.title
	custom_gui = "enclave_caravaneer_window"
	desc = {
		trigger = {
			event_target:nep_arena_target_1 = { has_fleet_flag = nep_rank_G }
		}
		text = nep_ar.2001.desc.g
	}
	desc = {
		trigger = {
			event_target:nep_arena_target_1 = { has_fleet_flag = nep_rank_F }
		}
		text = nep_ar.2001.desc.f
	}
	desc = {
		trigger = {
			event_target:nep_arena_target_1 = { has_fleet_flag = nep_rank_E }
		}
		text = nep_ar.2001.desc.e
	}
	desc = {
		trigger = {
			event_target:nep_arena_target_1 = { has_fleet_flag = nep_rank_D }
		}
		text = nep_ar.2001.desc.d
	}
	desc = {
		trigger = {
			event_target:nep_arena_target_1 = { has_fleet_flag = nep_rank_C }
		}
		text = nep_ar.2001.desc.c
	}
	desc = {
		trigger = {
			event_target:nep_arena_target_1 = { has_fleet_flag = nep_rank_B }
		}
		text = nep_ar.2001.desc.b
	}
	desc = {
		trigger = {
			event_target:nep_arena_target_1 = { has_fleet_flag = nep_rank_A }
		}
		text = nep_ar.2001.desc.a
	}
	desc = {
		trigger = {
			event_target:nep_arena_target_1 = { has_fleet_flag = nep_rank_S }
		}
		text = nep_ar.2001.desc.s
	}	
	
	picture_event_data = {
		portrait = event_target:caravaneer_home_country
		room = caravaneer_home_room
		planet_background = pc_city
	}
	
	diplomatic = yes
	is_triggered_only = yes

	option = {
		name = nep_ar.2.a
		hidden_effect = {
			set_country_flag = nep_arena_registered
			set_visited = event_target:nep_arena_system
			if = {
				limit = { exists = event_target:nep_arena_target_2 }
				delete_fleet = { target = event_target:nep_arena_target_2 destroy_template = yes }
			}
			if = {
				limit = { exists = event_target:nep_arena_target_3 }
				delete_fleet = { target = event_target:nep_arena_target_3 destroy_template = yes }
			}
			if = {
				limit = { exists = event_target:nep_arena_target_4 }
				delete_fleet = { target = event_target:nep_arena_target_4 destroy_template = yes }
			}
		}
	}
	
	option = {
		name = fedel.501.e
		default_hide_option = yes
	}
}

country_event = {
	id = nep_ar.2002
	title = cara_nep_arena_office.title
	custom_gui = "enclave_caravaneer_window"
	desc = {
		trigger = {
			event_target:nep_arena_target_2 = { has_fleet_flag = nep_rank_G }
		}
		text = nep_ar.2002.desc.g
	}
	desc = {
		trigger = {
			event_target:nep_arena_target_2 = { has_fleet_flag = nep_rank_F }
		}
		text = nep_ar.2002.desc.f
	}
	desc = {
		trigger = {
			event_target:nep_arena_target_2 = { has_fleet_flag = nep_rank_E }
		}
		text = nep_ar.2002.desc.e
	}
	desc = {
		trigger = {
			event_target:nep_arena_target_2 = { has_fleet_flag = nep_rank_D }
		}
		text = nep_ar.2002.desc.d
	}
	desc = {
		trigger = {
			event_target:nep_arena_target_2 = { has_fleet_flag = nep_rank_C }
		}
		text = nep_ar.2002.desc.c
	}
	desc = {
		trigger = {
			event_target:nep_arena_target_2 = { has_fleet_flag = nep_rank_B }
		}
		text = nep_ar.2002.desc.b
	}
	desc = {
		trigger = {
			event_target:nep_arena_target_2 = { has_fleet_flag = nep_rank_A }
		}
		text = nep_ar.2002.desc.a
	}
	desc = {
		trigger = {
			event_target:nep_arena_target_2 = { has_fleet_flag = nep_rank_S }
		}
		text = nep_ar.2002.desc.s
	}
	
	picture_event_data = {
		portrait = event_target:caravaneer_home_country
		room = caravaneer_home_room
		planet_background = pc_city
	}
	
	diplomatic = yes
	is_triggered_only = yes

	option = {
		name = nep_ar.2.a
		hidden_effect = {
			set_country_flag = nep_arena_registered
			set_visited = event_target:nep_arena_system
			if = {
				limit = { exists = event_target:nep_arena_target_1 }
				delete_fleet = { target = event_target:nep_arena_target_1 destroy_template = yes }
			}
			if = {
				limit = { exists = event_target:nep_arena_target_3 }
				delete_fleet = { target = event_target:nep_arena_target_3 destroy_template = yes }
			}
			if = {
				limit = { exists = event_target:nep_arena_target_4 }
				delete_fleet = { target = event_target:nep_arena_target_4 destroy_template = yes }
			}
		}
	}
	
	option = {
		name = fedel.501.e
		default_hide_option = yes
	}
}

country_event = {
	id = nep_ar.2003
	title = cara_nep_arena_office.title
	custom_gui = "enclave_caravaneer_window"
	desc = {
		trigger = {
			event_target:nep_arena_target_3 = { has_fleet_flag = nep_rank_G }
		}
		text = nep_ar.2003.desc.g
	}
	desc = {
		trigger = {
			event_target:nep_arena_target_3 = { has_fleet_flag = nep_rank_F }
		}
		text = nep_ar.2003.desc.f
	}
	desc = {
		trigger = {
			event_target:nep_arena_target_3 = { has_fleet_flag = nep_rank_E }
		}
		text = nep_ar.2003.desc.e
	}
	desc = {
		trigger = {
			event_target:nep_arena_target_3 = { has_fleet_flag = nep_rank_D }
		}
		text = nep_ar.2003.desc.d
	}
	desc = {
		trigger = {
			event_target:nep_arena_target_3 = { has_fleet_flag = nep_rank_C }
		}
		text = nep_ar.2003.desc.c
	}
	desc = {
		trigger = {
			event_target:nep_arena_target_3 = { has_fleet_flag = nep_rank_B }
		}
		text = nep_ar.2003.desc.b
	}
	desc = {
		trigger = {
			event_target:nep_arena_target_3 = { has_fleet_flag = nep_rank_A }
		}
		text = nep_ar.2003.desc.a
	}
	desc = {
		trigger = {
			event_target:nep_arena_target_3 = { has_fleet_flag = nep_rank_S }
		}
		text = nep_ar.2003.desc.s
	}
	
	picture_event_data = {
		portrait = event_target:caravaneer_home_country
		room = caravaneer_home_room
		planet_background = pc_city
	}
	
	diplomatic = yes
	is_triggered_only = yes

	option = {
		name = nep_ar.2.a
		hidden_effect = {
			set_country_flag = nep_arena_registered
			set_visited = event_target:nep_arena_system
			if = {
				limit = { exists = event_target:nep_arena_target_1 }
				delete_fleet = { target = event_target:nep_arena_target_1 destroy_template = yes }
			}
			if = {
				limit = { exists = event_target:nep_arena_target_2 }
				delete_fleet = { target = event_target:nep_arena_target_2 destroy_template = yes }
			}
			if = {
				limit = { exists = event_target:nep_arena_target_4 }
				delete_fleet = { target = event_target:nep_arena_target_4 destroy_template = yes }
			}
		}
	}
	
	option = {
		name = fedel.501.e
		default_hide_option = yes
	}
}

country_event = {
	id = nep_ar.2004
	title = cara_nep_arena_office.title
	custom_gui = "enclave_caravaneer_window"
	desc = {
		trigger = {
			event_target:nep_arena_target_4 = { has_fleet_flag = nep_rank_G }
		}
		text = nep_ar.2004.desc.g
	}
	desc = {
		trigger = {
			event_target:nep_arena_target_4 = { has_fleet_flag = nep_rank_F }
		}
		text = nep_ar.2004.desc.f
	}
	desc = {
		trigger = {
			event_target:nep_arena_target_4 = { has_fleet_flag = nep_rank_E }
		}
		text = nep_ar.2004.desc.e
	}
	desc = {
		trigger = {
			event_target:nep_arena_target_4 = { has_fleet_flag = nep_rank_D }
		}
		text = nep_ar.2004.desc.d
	}
	desc = {
		trigger = {
			event_target:nep_arena_target_4 = { has_fleet_flag = nep_rank_C }
		}
		text = nep_ar.2004.desc.c
	}
	desc = {
		trigger = {
			event_target:nep_arena_target_4 = { has_fleet_flag = nep_rank_B }
		}
		text = nep_ar.2004.desc.b
	}
	desc = {
		trigger = {
			event_target:nep_arena_target_4 = { has_fleet_flag = nep_rank_A }
		}
		text = nep_ar.2004.desc.a
	}
	desc = {
		trigger = {
			event_target:nep_arena_target_4 = { has_fleet_flag = nep_rank_S }
		}
		text = nep_ar.2004.desc.s
	}
	
	picture_event_data = {
		portrait = event_target:caravaneer_home_country
		room = caravaneer_home_room
		planet_background = pc_city
	}
	
	diplomatic = yes
	is_triggered_only = yes

	option = {
		name = nep_ar.2.a
		hidden_effect = {			
			set_country_flag = nep_arena_registered
			set_visited = event_target:nep_arena_system
			if = {
				limit = { exists = event_target:nep_arena_target_1 }
				delete_fleet = { target = event_target:nep_arena_target_1 destroy_template = yes }
			}
			if = {
				limit = { exists = event_target:nep_arena_target_2 }
				delete_fleet = { target = event_target:nep_arena_target_2 destroy_template = yes }
			}
			if = {
				limit = { exists = event_target:nep_arena_target_3 }
				delete_fleet = { target = event_target:nep_arena_target_3 destroy_template = yes }
			}
		}
	}
	
	option = {
		name = fedel.501.e
		default_hide_option = yes
	}
}

fleet_event = {
	id = nep_ar.3
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		owner = { 
			remove_country_flag = nep_arena_registered
			set_country_flag = nep_arena_challenged
			save_event_target_as = nep_ar_3_temp
			set_country_flag = nep_arena_entered
		}
		create_country = {
			name = "NAME_nep_arena_challenger"
			type = nep_arena_challenger
			effect = {
				root = { 
					set_owner = prev 
					save_global_event_target_as = nep_arena_challenger_fleet
					set_variable = { which = nep_challenger_fleet_power value = trigger:fleet_power }
				}
				every_playable_country = {
					establish_communications_no_message = prev
				}
			}
		}
		random_galaxy_fleet = {
			limit = { owner = { is_country_type = nep_arena_hologram } }
			create_fleet = {
				name = "NAME_nep_your_eyes"
				effect = {
					set_owner = event_target:nep_ar_3_temp
					create_ship = {
						name = "NAME_nep_your_eyes"
						random_existing_design = science
						graphical_culture = event_target:caravaneer_home_country
					}
					save_global_event_target_as = nep_your_eyes
					set_location = event_target:nep_arena_target_pos_1
					set_event_locked = yes
				}
			}
			create_country = {
				name = "NAME_nep_arena_target"
				type = nep_arena_target
				effect = {
					prev = { 
						set_owner = prev 
						save_global_event_target_as = nep_arena_target_fleet
						set_variable = { which = nep_target_fleet_power value = trigger:fleet_power }
					}					
					every_playable_country = {
						establish_communications_no_message = prev
					}
				}
			}
		}
		set_global_flag = nep_arena_battleing
		if = { 
			limit = { exists = leader }
			leader = { save_global_event_target_as = nep_arena_leader }
		}
		fleet_event = { id = nep_ar.30 days = 5 }
		event_target:nep_arena_target_fleet = {
			switch = {
				trigger = has_fleet_flag
				nep_rank_G = {
					event_target:nep_ar_3_temp = { set_country_flag = nep_rank_G }					
				}
				nep_rank_F = {
					event_target:nep_ar_3_temp = { set_country_flag = nep_rank_F }					
				}
				nep_rank_E = {
					event_target:nep_ar_3_temp = { set_country_flag = nep_rank_E }					
				}
				nep_rank_D = {
					event_target:nep_ar_3_temp = { set_country_flag = nep_rank_D }					
				}
				nep_rank_C = {
					event_target:nep_ar_3_temp = { set_country_flag = nep_rank_C }					
				}
				nep_rank_B = {
					event_target:nep_ar_3_temp = { set_country_flag = nep_rank_B }					
				}
				nep_rank_A = {
					event_target:nep_ar_3_temp = { set_country_flag = nep_rank_A }					
				}
				nep_rank_S = {
					event_target:nep_ar_3_temp = { set_country_flag = nep_rank_S }					
				}
			}
		}
		event_target:nep_ar_3_temp = { country_event = { id = nep_ar.300 } }
		fleet_event = { id = nep_ar.3001 days = 90 }
	}
}

fleet_event = {
	id = nep_ar.30
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		event_target:nep_arena_challenger_fleet = {
			auto_follow_fleet = {
				target = event_target:nep_arena_target_fleet
				attack_fleet = yes
			}
		}
		event_target:nep_arena_target_fleet = {
			auto_follow_fleet = {
				target = event_target:nep_arena_challenger_fleet
				attack_fleet = yes
			}
		}
	}
}

country_event = {
	id = nep_ar.300
	title = cara_nep_arena_office.title
	custom_gui = "enclave_caravaneer_window"
	desc = nep_ar.300.desc
	location = event_target:nep_arena_system
	
	picture_event_data = {
		portrait = event_target:caravaneer_home_country
		room = caravaneer_home_room
		planet_background = pc_city
	}
	
	diplomatic = yes
	is_triggered_only = yes
	
	option = { name = nep_ar.300.a }
}

country_event = {
	id = nep_ar.3000
	hide_window = yes
	
	is_triggered_only = yes
	
	trigger = { 
		has_global_flag = nep_arena_battleing 
		OR = {
			is_country_type = nep_arena_challenger
			is_country_type = nep_arena_target
		}
	}

	immediate = {
		if = {
			limit = { any_country = { is_country_type = nep_arena_challenger } }
			random_country = {
				limit = { has_country_flag = nep_arena_entered }
				country_event = { id = nep_ar.3002 }
			}
		}
		if = {
			limit = { any_country = { is_country_type = nep_arena_target } }
			random_country = {
				limit = { has_country_flag = nep_arena_entered }
				country_event = { id = nep_ar.3003 }
			}
		}
	}
}

fleet_event = {
	id = nep_ar.3001
	hide_window = yes
	
	is_triggered_only = yes
	
	trigger = { 
		has_global_flag = nep_arena_battleing
	}
	
	immediate = {
		event_target:nep_arena_challenger_fleet = {
			subtract_variable = { which = nep_challenger_fleet_power value = trigger:fleet_power }
		}
		event_target:nep_arena_target_fleet = {
			subtract_variable = { which = nep_target_fleet_power value = trigger:fleet_power }
		}
		if = {
			limit = {
				check_variable = { which = nep_challenger_fleet_power value >= event_target:nep_arena_target_fleet.nep_target_fleet_power }
			}
			random_country = {
				limit = { has_country_flag = nep_arena_entered } 
				country_event = { id = nep_ar.3002 }
			}
		}
		else = {			
			random_country = {
				limit = { has_country_flag = nep_arena_entered } 
				country_event = { id = nep_ar.3003 }
			}
		}
	}
}

country_event = {
	id = nep_ar.3002
	title = cara_nep_arena_office.title
	custom_gui = "enclave_caravaneer_window"
	desc =  {
		trigger = { 
			hidden:from = {
				switch = {
					trigger = is_scope_type
					country = { text = nep_ar.3002.desc.a }
					fleet = { text = nep_ar.3002.desc.b }
				}
			}
		}
	}
	
	picture_event_data = {
		portrait = event_target:caravaneer_home_country
		room = caravaneer_home_room
		planet_background = pc_city
	}
	
	diplomatic = yes
	is_triggered_only = yes
	
	immediate = { 
		remove_global_flag = nep_arena_battleing 
		remove_country_flag = nep_arena_entered
		if = {
			limit = { exists = event_target:nep_arena_challenger_fleet }
			event_target:nep_arena_challenger_fleet = { 
				set_owner = root
				set_location = event_target:nep_arena_office_station				
				if = { 
					limit = { 
						not = { exists = leader }
						exists = event_target:nep_arena_leader
					}
					assign_leader = event_target:nep_arena_leader
					clear_global_event_target = nep_arena_leader
				}
			}
		}
		if = {
			limit = { exists = event_target:nep_arena_target_fleet }
			event_target:nep_arena_target_fleet = { delete_fleet = { target = this destroy_template = yes } }
		}
		if = {
			limit = { exists = event_target:nep_your_eyes }
			event_target:nep_your_eyes = { delete_fleet = { target = this destroy_template = yes } }
		}
	}

	option = {
		name = OK
		trigger = { has_country_flag = nep_rank_G }
		add_resource = {
			energy = 1000
			influence = 5
			unity = 1000
		}
		hidden_effect = {
			remove_country_flag = nep_rank_G
		}
	}
	
	option = {
		name = OK
		trigger = { has_country_flag = nep_rank_F }
		add_resource = {
			energy = 2000
			influence = 10
			unity = 2000
		}
		hidden_effect = {
			remove_country_flag = nep_rank_F
		}
	}
	
	option = {
		name = OK
		trigger = { has_country_flag = nep_rank_E }
		add_resource = {
			energy = 3000
			influence = 20
			unity = 4000
		}
		hidden_effect = {
			remove_country_flag = nep_rank_E
		}
	}
	
	option = {
		name = OK
		trigger = { has_country_flag = nep_rank_D }
		add_resource = {
			energy = 4000
			influence = 30
			unity = 8000
		}
		hidden_effect = {
			remove_country_flag = nep_rank_D
		}
	}
	
	option = {
		name = OK
		trigger = { has_country_flag = nep_rank_C }
		add_resource = {
			energy = 5000
			influence = 50
			unity = 16000
		}
		hidden_effect = {
			remove_country_flag = nep_rank_C
		}
	}
	
	option = {
		name = OK
		trigger = { has_country_flag = nep_rank_B }
		add_resource = {
			energy = 6000
			influence = 80
			unity = 32000
		}
		hidden_effect = {
			remove_country_flag = nep_rank_B
		}
	}
	
	option = {
		name = OK
		trigger = { has_country_flag = nep_rank_A }
		add_resource = {
			energy = 7000
			influence = 130
			unity = 64000
		}
		hidden_effect = {
			remove_country_flag = nep_rank_A
		}
	}
	
	option = {
		name = OK
		trigger = { has_country_flag = nep_rank_S }
		add_resource = {
			energy = 10000
			influence = 210
			unity = 99999
		}
		hidden_effect = {
			remove_country_flag = nep_rank_S
		}
	}
}

country_event = {
	id = nep_ar.3003
	title = cara_nep_arena_office.title
	custom_gui = "enclave_caravaneer_window"
	desc = {
		trigger = { 
			hidden:from = {
				switch = {
					trigger = is_scope_type
					country = { text = nep_ar.3003.desc.a }
					fleet = { text = nep_ar.3003.desc.b }
				}
			}
		}
	}
	
	picture_event_data = {
		portrait = event_target:caravaneer_home_country
		room = caravaneer_home_room
		planet_background = pc_city
	}
	
	diplomatic = yes
	is_triggered_only = yes
	
	immediate = {
		remove_global_flag = nep_arena_battleing 
		remove_country_flag = nep_arena_entered
		if = {
			limit = { exists = event_target:nep_arena_challenger_fleet }
			event_target:nep_arena_challenger_fleet = { 
				set_owner = root 
				set_location = event_target:nep_arena_office_station
			}
		}
		if = {
			limit = { exists = event_target:nep_arena_target_fleet }
			event_target:nep_arena_target_fleet = { delete_fleet = { target = this destroy_template = yes } }
		}
		if = {
			limit = { exists = event_target:nep_your_eyes }
			event_target:nep_your_eyes = { delete_fleet = { target = this destroy_template = yes } }
		}
	}
	
	option = {
		name = OK
		hidden_effect = {
			remove_country_flag = nep_rank_S
			remove_country_flag = nep_rank_A
			remove_country_flag = nep_rank_B
			remove_country_flag = nep_rank_C
			remove_country_flag = nep_rank_D
			remove_country_flag = nep_rank_E
			remove_country_flag = nep_rank_F
			remove_country_flag = nep_rank_G
		}
	}
}

#Fxxk you scripted effect,move enemy create effect to events
system_event = {
	id = nep_ar.4001 #nep_create_enemy_1
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		# print_scope_effect = yes
		random_list = {
			4 = { #delete some ship
				if = {
					limit = {
						any_country = {
							fleet_power > 1 
							count_owned_fleet = { limit = { is_ship_class = shipclass_military } count > 3 }
						}
					}
					random_country = {
						limit = { 
							fleet_power > 1 
							count_owned_fleet = { limit = { is_ship_class = shipclass_military } count > 3 }
						}
						ordered_controlled_fleet = {
							limit = {
								is_ship_class = shipclass_military
							}
							position = 3
							order_by = trigger:fleet_power
							fleet_event = { id = nep_ar.4011 } #nep_copy_fleet = yes
							if = { 
								limit = { 
									NOT = { has_global_flag = nep_copy_fleet_failed } 
									exists = event_target:nep_copy_fleet_temp_fleet
								}
								event_target:nep_copy_fleet_temp_fleet = {
									set_owner = event_target:nep_arena_hologram
									set_location = event_target:nep_arena_target_pos_1
									if = {
										limit = {
											num_ships > 1
										}
										every_owned_ship = {
											random_list = {
												10 = { delete_ship = this }
												35 = { }
											}
										}
									}
								}
							}
							else = { root = { system_event = { id = nep_ar.40012 } } }
						}
					}
				}
				else = { root = { system_event = { id = nep_ar.40012 } } }
			}
			3 = {  #not delete
				if = {
					limit = { 
						any_country = {
							fleet_power > 1 
							count_owned_fleet = { limit = { is_ship_class = shipclass_military } count > 3 }
						}
					}
					random_country = {
						limit = { 
							fleet_power > 1 
							count_owned_fleet = { limit = { is_ship_class = shipclass_military } count > 3 }
						}
						ordered_controlled_fleet = {
							limit = {
								is_ship_class = shipclass_military
							}
							position = 3
							order_by = trigger:fleet_power
							fleet_event = { id = nep_ar.4011 } #nep_copy_fleet = yes
							if = { 
								limit = { 
									NOT = { has_global_flag = nep_copy_fleet_failed }									
									exists = event_target:nep_copy_fleet_temp_fleet
								}
								event_target:nep_copy_fleet_temp_fleet = {
									set_owner = event_target:nep_arena_hologram
									set_location = event_target:nep_arena_target_pos_1
								}
							}
							else = { root = { system_event = { id = nep_ar.40012 } } }
						}
					}
				}
				else = { root = { system_event = { id = nep_ar.40012 } } }
			}
			2 = { #double and delete some ship
				if = {
					limit = { 
						any_country = {
							fleet_power > 1 
							count_owned_fleet = { limit = { is_ship_class = shipclass_military } count > 3 }
						}
					}
					random_country = {
						limit = { 
							fleet_power > 1 
							count_owned_fleet = { limit = { is_ship_class = shipclass_military } count > 3 }
						}
						ordered_controlled_fleet = {
							limit = {
								is_ship_class = shipclass_military
							}
							position = 3
							order_by = trigger:fleet_power
							fleet_event = { id = nep_ar.4012 } #nep_copy_fleet_2 = yes
							if = { 
								limit = { 
									NOT = { has_global_flag = nep_copy_fleet_failed } 									
									exists = event_target:nep_copy_fleet_temp_fleet
								}
								event_target:nep_copy_fleet_temp_fleet = {
									set_owner = event_target:nep_arena_hologram
									set_location = event_target:nep_arena_target_pos_1
									if = {
										limit = {
											num_ships > 1
										}
										every_owned_ship = {
											random_list = {
												10 = { delete_ship = this }
												35 = { }
											}
										}
									}
								}
							}
							else = { root = { system_event = { id = nep_ar.40012 } } }
						}
					}
				}
				else = { root = { system_event = { id = nep_ar.40012 } } }
			} 
			1 = {#double and not delete some ship
				if = {
					limit = {
						any_country = {
							fleet_power > 1 
							count_owned_fleet = { limit = { is_ship_class = shipclass_military } count > 3 }
						}
					}
					random_country = {
						limit = { 
							fleet_power > 1 
							count_owned_fleet = { limit = { is_ship_class = shipclass_military } count > 3 }
						}
						ordered_controlled_fleet = {
							limit = {
								is_ship_class = shipclass_military
							}
							position = 3
							order_by = trigger:fleet_power
							fleet_event = { id = nep_ar.4012 } #nep_copy_fleet_2 = yes
							if = { 
								limit = { 
									NOT = { has_global_flag = nep_copy_fleet_failed } 
									exists = event_target:nep_copy_fleet_temp_fleet
								}
								event_target:nep_copy_fleet_temp_fleet = {
									set_owner = event_target:nep_arena_hologram
									set_location = event_target:nep_arena_target_pos_1
								}
							}
							else = { root = { system_event = { id = nep_ar.40012 } } }
						}
					}
				}
				else = { root = { system_event = { id = nep_ar.40012 } } }
			}
		}
		if = { 
			limit = { NOT = { has_global_flag = nep_copy_fleet_failed } }
			event_target:nep_copy_fleet_temp_fleet = {
				if = {
					limit = { fleet_power < 200 }
					destroy_fleet = this
				}
				else_if = {
					limit = { exists = this }
					set_fleet_flag = nep_arena_target_1
					save_global_event_target_as = nep_arena_target_1 
				}
			}
		}
	}
}

system_event = {
	id = nep_ar.40012 #nep_create_enemy_1
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		# print_scope_effect = yes
		random_list = {
			4 = { #delete some ship
				if = {
					limit = {
						any_country = {
							fleet_power > 1 
							count_owned_fleet = { limit = { is_ship_class = shipclass_military } count > 2 }
						}
					}
					random_country = {
						limit = { 
							fleet_power > 1 
							count_owned_fleet = { limit = { is_ship_class = shipclass_military } count > 2 }
						}
						ordered_controlled_fleet = {
							limit = {
								is_ship_class = shipclass_military
							}
							position = 3
							order_by = trigger:fleet_power
							fleet_event = { id = nep_ar.4011 } #nep_copy_fleet = yes
							if = { 
								limit = { 
									NOT = { has_global_flag = nep_copy_fleet_failed } 
									exists = event_target:nep_copy_fleet_temp_fleet
								}
								event_target:nep_copy_fleet_temp_fleet = {
									set_owner = event_target:nep_arena_hologram
									set_location = event_target:nep_arena_target_pos_1
									if = {
										limit = {
											num_ships > 1
										}
										every_owned_ship = {
											random_list = {
												10 = { delete_ship = this }
												35 = { }
											}
										}
									}
								}
							}
							else = { root = { system_event = { id = nep_ar.40013 } } }
						}
					}
				}
				else = { root = { system_event = { id = nep_ar.40013 } } }
			}
			3 = {  #not delete
				if = {
					limit = { 
						any_country = {
							fleet_power > 1 
							count_owned_fleet = { limit = { is_ship_class = shipclass_military } count > 2 }
						}
					}
					random_country = {
						limit = { 
							fleet_power > 1 
							count_owned_fleet = { limit = { is_ship_class = shipclass_military } count > 2 }
						}
						ordered_controlled_fleet = {
							limit = {
								is_ship_class = shipclass_military
							}
							position = 3
							order_by = trigger:fleet_power
							fleet_event = { id = nep_ar.4011 } #nep_copy_fleet = yes
							if = { 
								limit = { 
									NOT = { has_global_flag = nep_copy_fleet_failed }									
									exists = event_target:nep_copy_fleet_temp_fleet
								}
								event_target:nep_copy_fleet_temp_fleet = {
									set_owner = event_target:nep_arena_hologram
									set_location = event_target:nep_arena_target_pos_1
								}
							}
							else = { root = { system_event = { id = nep_ar.40013 } } }
						}
					}
				}
				else = { root = { system_event = { id = nep_ar.40013 } } }
			}
			2 = { #double and delete some ship
				if = {
					limit = { 
						any_country = {
							fleet_power > 1 
							count_owned_fleet = { limit = { is_ship_class = shipclass_military } count > 2 }
						}
					}
					random_country = {
						limit = { 
							fleet_power > 1 
							count_owned_fleet = { limit = { is_ship_class = shipclass_military } count > 2 }
						}
						ordered_controlled_fleet = {
							limit = {
								is_ship_class = shipclass_military
							}
							position = 3
							order_by = trigger:fleet_power
							fleet_event = { id = nep_ar.4012 } #nep_copy_fleet_2 = yes
							if = { 
								limit = { 
									NOT = { has_global_flag = nep_copy_fleet_failed } 									
									exists = event_target:nep_copy_fleet_temp_fleet
								}
								event_target:nep_copy_fleet_temp_fleet = {
									set_owner = event_target:nep_arena_hologram
									set_location = event_target:nep_arena_target_pos_1
									if = {
										limit = {
											num_ships > 1
										}
										every_owned_ship = {
											random_list = {
												10 = { delete_ship = this }
												35 = { }
											}
										}
									}
								}
							}
							else = { root = { system_event = { id = nep_ar.40013 } } }
						}
					}
				}
				else = { root = { system_event = { id = nep_ar.40013 } } }
			} 
			1 = {#double and not delete some ship
				if = {
					limit = {
						any_country = {
							fleet_power > 1 
							count_owned_fleet = { limit = { is_ship_class = shipclass_military } count > 2 }
						}
					}
					random_country = {
						limit = { 
							fleet_power > 1 
							count_owned_fleet = { limit = { is_ship_class = shipclass_military } count > 2 }
						}
						ordered_controlled_fleet = {
							limit = {
								is_ship_class = shipclass_military
							}
							position = 3
							order_by = trigger:fleet_power
							fleet_event = { id = nep_ar.4012 } #nep_copy_fleet_2 = yes
							if = { 
								limit = { 
									NOT = { has_global_flag = nep_copy_fleet_failed } 
									exists = event_target:nep_copy_fleet_temp_fleet
								}
								event_target:nep_copy_fleet_temp_fleet = {
									set_owner = event_target:nep_arena_hologram
									set_location = event_target:nep_arena_target_pos_1
								}
							}
							else = { root = { system_event = { id = nep_ar.40013 } } }
						}
					}
				}
				else = { root = { system_event = { id = nep_ar.40013 } } }
			}
		}
		if = { 
			limit = { NOT = { has_global_flag = nep_copy_fleet_failed } }
			event_target:nep_copy_fleet_temp_fleet = { 
				if = {
					limit = { fleet_power < 200 }
					destroy_fleet = this
				}
				else_if = {
					limit = { exists = this }
					set_fleet_flag = nep_arena_target_1
					save_global_event_target_as = nep_arena_target_1 
				}
			}
		}
	}
}

system_event = {
	id = nep_ar.40013 #nep_create_enemy_1
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		# print_scope_effect = yes
		random_list = {
			4 = { #delete some ship
				if = {
					limit = {
						any_country = {
							fleet_power > 1 
							count_owned_fleet = { limit = { is_ship_class = shipclass_military } count > 1 }
						}
					}
					random_country = {
						limit = { 
							fleet_power > 1 
							count_owned_fleet = { limit = { is_ship_class = shipclass_military } count > 1 }
						}
						ordered_controlled_fleet = {
							limit = {
								is_ship_class = shipclass_military
							}
							position = 3
							order_by = trigger:fleet_power
							fleet_event = { id = nep_ar.4011 } #nep_copy_fleet = yes
							if = { 
								limit = { 
									NOT = { has_global_flag = nep_copy_fleet_failed } 
									exists = event_target:nep_copy_fleet_temp_fleet
								}
								event_target:nep_copy_fleet_temp_fleet = {
									set_owner = event_target:nep_arena_hologram
									set_location = event_target:nep_arena_target_pos_1
									if = {
										limit = {
											num_ships > 1
										}
										every_owned_ship = {
											random_list = {
												10 = { delete_ship = this }
												35 = { }
											}
										}
									}
								}
							}
							else = { root = { system_event = { id = nep_ar.40014 } } }
						}
					}
				}
				else = { root = { system_event = { id = nep_ar.40014 } } }
			}
			3 = {  #not delete
				if = {
					limit = { 
						any_country = {
							fleet_power > 1 
							count_owned_fleet = { limit = { is_ship_class = shipclass_military } count > 1 }
						}
					}
					random_country = {
						limit = { 
							fleet_power > 1 
							count_owned_fleet = { limit = { is_ship_class = shipclass_military } count > 1 }
						}
						ordered_controlled_fleet = {
							limit = {
								is_ship_class = shipclass_military
							}
							position = 3
							order_by = trigger:fleet_power
							fleet_event = { id = nep_ar.4011 } #nep_copy_fleet = yes
							if = { 
								limit = { 
									NOT = { has_global_flag = nep_copy_fleet_failed }									
									exists = event_target:nep_copy_fleet_temp_fleet
								}
								event_target:nep_copy_fleet_temp_fleet = {
									set_owner = event_target:nep_arena_hologram
									set_location = event_target:nep_arena_target_pos_1
								}
							}
							else = { root = { system_event = { id = nep_ar.40014 } } }
						}
					}
				}
				else = { root = { system_event = { id = nep_ar.40014 } } }
			}
			2 = { #double and delete some ship
				if = {
					limit = { 
						any_country = {
							fleet_power > 1 
							count_owned_fleet = { limit = { is_ship_class = shipclass_military } count > 1 }
						}
					}
					random_country = {
						limit = { 
							fleet_power > 1 
							count_owned_fleet = { limit = { is_ship_class = shipclass_military } count > 1 }
						}
						ordered_controlled_fleet = {
							limit = {
								is_ship_class = shipclass_military
							}
							position = 3
							order_by = trigger:fleet_power
							fleet_event = { id = nep_ar.4012 } #nep_copy_fleet_2 = yes
							if = { 
								limit = { 
									NOT = { has_global_flag = nep_copy_fleet_failed } 									
									exists = event_target:nep_copy_fleet_temp_fleet
								}
								event_target:nep_copy_fleet_temp_fleet = {
									set_owner = event_target:nep_arena_hologram
									set_location = event_target:nep_arena_target_pos_1
									if = {
										limit = {
											num_ships > 1
										}
										every_owned_ship = {
											random_list = {
												10 = { delete_ship = this }
												35 = { }
											}
										}
									}
								}
							}
							else = { root = { system_event = { id = nep_ar.40014 } } }
						}
					}
				}
				else = { root = { system_event = { id = nep_ar.40014 } } }
			} 
			1 = {#double and not delete some ship
				if = {
					limit = {
						any_country = {
							fleet_power > 1 
							count_owned_fleet = { limit = { is_ship_class = shipclass_military } count > 1 }
						}
					}
					random_country = {
						limit = { 
							fleet_power > 1 
							count_owned_fleet = { limit = { is_ship_class = shipclass_military } count > 1 }
						}
						ordered_controlled_fleet = {
							limit = {
								is_ship_class = shipclass_military
							}
							position = 3
							order_by = trigger:fleet_power
							fleet_event = { id = nep_ar.4012 } #nep_copy_fleet_2 = yes
							if = { 
								limit = { 
									NOT = { has_global_flag = nep_copy_fleet_failed } 
									exists = event_target:nep_copy_fleet_temp_fleet
								}
								event_target:nep_copy_fleet_temp_fleet = {
									set_owner = event_target:nep_arena_hologram
									set_location = event_target:nep_arena_target_pos_1
								}
							}
							else = { root = { system_event = { id = nep_ar.40014 } } }
						}
					}
				}
				else = { root = { system_event = { id = nep_ar.40014 } } }
			}
		}
		if = { 
			limit = { NOT = { has_global_flag = nep_copy_fleet_failed } }
			event_target:nep_copy_fleet_temp_fleet = { 
				if = {
					limit = { fleet_power < 200 }
					destroy_fleet = this
				}
				else_if = {
					limit = { exists = this }
					set_fleet_flag = nep_arena_target_1
					save_global_event_target_as = nep_arena_target_1 
				}
			}
		}
	}
}

system_event = {
	id = nep_ar.40014 #nep_create_enemy_4
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		# print_scope_effect = yes
		random_list = {
			4 = { #delete some ship
				random_country = {
					limit = { 
						fleet_power > 1 
					}
					ordered_controlled_fleet = {
						limit = {
							is_ship_class = shipclass_military
						}
						position = 0
						order_by = trigger:fleet_power
						fleet_event = { id = nep_ar.4011 } #nep_copy_fleet = yes
						if = { 
							limit = { 
								NOT = { has_global_flag = nep_copy_fleet_failed } 									
								exists = event_target:nep_copy_fleet_temp_fleet
							}
							event_target:nep_copy_fleet_temp_fleet = {
								set_owner = event_target:nep_arena_hologram
								set_location = event_target:nep_arena_target_pos_1
								if = {
									limit = {
										num_ships > 1
									}
									every_owned_ship = {
										random_list = {
											10 = { delete_ship = this }
											35 = { }
										}
									}
								}
							}
						}
						else = { root = { system_event = { id = nep_ar.40014 } } }
					}
				}
			}
			3 = {  #not delete
				random_country = {
					limit = { 
						fleet_power > 1 
					}
					ordered_controlled_fleet = {
						limit = {
							is_ship_class = shipclass_military
						}
						position = 0
						order_by = trigger:fleet_power
						fleet_event = { id = nep_ar.4011 } #nep_copy_fleet = yes
						if = { 
							limit = { 
								NOT = { has_global_flag = nep_copy_fleet_failed } 									
								exists = event_target:nep_copy_fleet_temp_fleet
							}
							event_target:nep_copy_fleet_temp_fleet = {
								set_owner = event_target:nep_arena_hologram
								set_location = event_target:nep_arena_target_pos_1
							}
						}
						else = { root = { system_event = { id = nep_ar.40014 } } }
					}
				}
			}
			2 = { #double and delete some ship
				random_country = {
					limit = { 
						fleet_power > 1
					}
					ordered_controlled_fleet = {
						limit = {
							is_ship_class = shipclass_military
						}
						position = 0
						order_by = trigger:fleet_power
						fleet_event = { id = nep_ar.4012 } #nep_copy_fleet_2 = yes
						if = { 
							limit = { 
								NOT = { has_global_flag = nep_copy_fleet_failed } 									
								exists = event_target:nep_copy_fleet_temp_fleet
							}
							event_target:nep_copy_fleet_temp_fleet = {
								set_owner = event_target:nep_arena_hologram
								set_location = event_target:nep_arena_target_pos_1
								if = {
									limit = {
										num_ships > 1
									}
									every_owned_ship = {
										random_list = {
											10 = { delete_ship = this }
											35 = { }
										}
									}
								}
							}
						}
						else = { root = { system_event = { id = nep_ar.40014 } } }
					}
				}
			} 
			1 = {#double and not delete some ship
				random_country = {
					limit = { 
						fleet_power > 1
					}
					ordered_controlled_fleet = {
						limit = {
							is_ship_class = shipclass_military
						}
						position = 0
						order_by = trigger:fleet_power
						fleet_event = { id = nep_ar.4012 } #nep_copy_fleet_2 = yes					
						if = { 
							limit = { 
								NOT = { has_global_flag = nep_copy_fleet_failed } 									
								exists = event_target:nep_copy_fleet_temp_fleet
							}
							event_target:nep_copy_fleet_temp_fleet = {
								set_owner = event_target:nep_arena_hologram
								set_location = event_target:nep_arena_target_pos_1
							}
						}
						else = { root = { system_event = { id = nep_ar.40014 } } }
					}
				}
			}
		}
		if = { 
			limit = { NOT = { has_global_flag = nep_copy_fleet_failed } }
			event_target:nep_copy_fleet_temp_fleet = { 
				if = {
					limit = { fleet_power < 200 }
					destroy_fleet = this
				}
				else_if = {
					limit = { exists = this }
					set_fleet_flag = nep_arena_target_1
					save_global_event_target_as = nep_arena_target_1
				}
			}
		}
	}
}

system_event = {
	id = nep_ar.4002 #nep_create_enemy_2
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		# print_scope_effect = yes
		random_list = {
			4 = { #delete some ship
				if = {
					limit = { 
						any_country = {
							fleet_power > 1 
							count_owned_fleet = { limit = { is_ship_class = shipclass_military } count > 2 }
						}
					}
					random_country = {
						limit = { 
							fleet_power > 1 
							count_owned_fleet = { limit = { is_ship_class = shipclass_military } count > 2 }
						}
						ordered_controlled_fleet = {
							limit = {
								is_ship_class = shipclass_military
							}
							position = 2
							order_by = trigger:fleet_power
							fleet_event = { id = nep_ar.4011 } #nep_copy_fleet = yes
							if = { 
								limit = { 
									NOT = { has_global_flag = nep_copy_fleet_failed } 									
									exists = event_target:nep_copy_fleet_temp_fleet
								}
								event_target:nep_copy_fleet_temp_fleet = {
									set_owner = event_target:nep_arena_hologram
									set_location = event_target:nep_arena_target_pos_2
									if = {
										limit = {
											num_ships > 1
										}
										every_owned_ship = {
											random_list = {
												10 = { delete_ship = this }
												35 = { }
											}
										}
									}
								}
							}
							else = { root = { system_event = { id = nep_ar.40023 } } }
						}
					}
				}
				else = { root = { system_event = { id = nep_ar.40023 } } }
			}
			3 = {  #not delete
				if = {
					limit = { 
						any_country = {
							fleet_power > 1 
							count_owned_fleet = { limit = { is_ship_class = shipclass_military } count > 2 }
						}
					}
					random_country = {
						limit = { 
							fleet_power > 1 
							count_owned_fleet = { limit = { is_ship_class = shipclass_military } count > 2 }
						}
						ordered_controlled_fleet = {
							limit = {
								is_ship_class = shipclass_military
							}
							position = 2
							order_by = trigger:fleet_power
							fleet_event = { id = nep_ar.4011 } #nep_copy_fleet = yes
							if = { 
								limit = { 
									NOT = { has_global_flag = nep_copy_fleet_failed } 									
									exists = event_target:nep_copy_fleet_temp_fleet
								}
								event_target:nep_copy_fleet_temp_fleet = {
									set_owner = event_target:nep_arena_hologram
									set_location = event_target:nep_arena_target_pos_2
								}
							}
							else = { root = { system_event = { id = nep_ar.40023 } } }
						}
					}
				}
				else = { root = { system_event = { id = nep_ar.40023 } } }
			}
			2 = { #double and delete some ship
				if = {
					limit = { 
						any_country = {
							fleet_power > 1 
							count_owned_fleet = { limit = { is_ship_class = shipclass_military } count > 2 }
						}
					}
					random_country = {
						limit = { 
							fleet_power > 1 
							count_owned_fleet = { limit = { is_ship_class = shipclass_military } count > 2 }
						}
						ordered_controlled_fleet = {
							limit = {
								is_ship_class = shipclass_military
							}
							position = 2
							order_by = trigger:fleet_power
							fleet_event = { id = nep_ar.4012 } #nep_copy_fleet_2 = yes
							if = { 
								limit = { 
									NOT = { has_global_flag = nep_copy_fleet_failed } 									
									exists = event_target:nep_copy_fleet_temp_fleet
								}
								event_target:nep_copy_fleet_temp_fleet = {
									set_owner = event_target:nep_arena_hologram
									set_location = event_target:nep_arena_target_pos_2
									if = {
										limit = {
											num_ships > 1
										}
										every_owned_ship = {
											random_list = {
												10 = { delete_ship = this }
												35 = { }
											}
										}
									}
								}
							}
							else = { root = { system_event = { id = nep_ar.40023 } } }
						}
					}
				}
				else = { root = { system_event = { id = nep_ar.40023 } } }
			} 
			1 = {#double and not delete some ship
				if = {
					limit = { 
						any_country = {
							fleet_power > 1 
							count_owned_fleet = { limit = { is_ship_class = shipclass_military } count > 2 }
						}
					}
					random_country = {
						limit = { 
							fleet_power > 1 
							count_owned_fleet = { limit = { is_ship_class = shipclass_military } count > 2 }
						}
						ordered_controlled_fleet = {
							limit = {
								is_ship_class = shipclass_military
							}
							position = 2
							order_by = trigger:fleet_power
							fleet_event = { id = nep_ar.4012 } #nep_copy_fleet_2 = yes
							if = { 
								limit = { 
									NOT = { has_global_flag = nep_copy_fleet_failed } 									
									exists = event_target:nep_copy_fleet_temp_fleet
								}
								event_target:nep_copy_fleet_temp_fleet = {
									set_owner = event_target:nep_arena_hologram
									set_location = event_target:nep_arena_target_pos_2
								}
							}
							else = { root = { system_event = { id = nep_ar.40023 } } }
						}
					}
				}
				else = { root = { system_event = { id = nep_ar.40023 } } }
			} 
		}
		if = { 
			limit = { NOT = { has_global_flag = nep_copy_fleet_failed } }
			event_target:nep_copy_fleet_temp_fleet = { 
				if = {
					limit = { fleet_power < 200 }
					destroy_fleet = this
				}
				else_if = {
					limit = { exists = this }
					set_fleet_flag = nep_arena_target_2
					save_global_event_target_as = nep_arena_target_2
				}
			}
		}
	}
}

system_event = {
	id = nep_ar.40023 #nep_create_enemy_3
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		# print_scope_effect = yes
		random_list = {
			4 = { #delete some ship
				if = {
					limit = { 
						any_country = {
							fleet_power > 1 
							count_owned_fleet = { limit = { is_ship_class = shipclass_military } count > 1 }
						}
					}
					random_country = {
						limit = { 
							fleet_power > 1 
							count_owned_fleet = { limit = { is_ship_class = shipclass_military } count > 1 }
						}
						ordered_controlled_fleet = {
							limit = {
								is_ship_class = shipclass_military
							}
							position = 1
							order_by = trigger:fleet_power
							fleet_event = { id = nep_ar.4011 } #nep_copy_fleet = yes
							if = { 
								limit = { 
									NOT = { has_global_flag = nep_copy_fleet_failed } 									
									exists = event_target:nep_copy_fleet_temp_fleet
								}
								event_target:nep_copy_fleet_temp_fleet = {
									set_owner = event_target:nep_arena_hologram
									set_location = event_target:nep_arena_target_pos_2
									if = {
										limit = {
											num_ships > 1
										}
										every_owned_ship = {
											random_list = {
												10 = { delete_ship = this }
												35 = { }
											}
										}
									}
								}
							}
							else = { root = { system_event = { id = nep_ar.40024 } } }
						}
					}
				}
				else = { root = { system_event = { id = nep_ar.40024 } } }
			}
			3 = {  #not delete
				if = {
					limit = { 
						any_country = {
							fleet_power > 1 
							count_owned_fleet = { limit = { is_ship_class = shipclass_military } count > 1 }
						}
					}
					random_country = {
						limit = { 
							fleet_power > 1 
							count_owned_fleet = { limit = { is_ship_class = shipclass_military } count > 2 }
						}
						ordered_controlled_fleet = {
							limit = {
								is_ship_class = shipclass_military
							}
							position = 1
							order_by = trigger:fleet_power
							fleet_event = { id = nep_ar.4011 } #nep_copy_fleet = yes
							if = { 
								limit = { 
									NOT = { has_global_flag = nep_copy_fleet_failed } 									
									exists = event_target:nep_copy_fleet_temp_fleet
								}
								event_target:nep_copy_fleet_temp_fleet = {
									set_owner = event_target:nep_arena_hologram
									set_location = event_target:nep_arena_target_pos_2
								}
							}
							else = { root = { system_event = { id = nep_ar.40024 } } }
						}
					}
				}
				else = { root = { system_event = { id = nep_ar.40024 } } }
			}
			2 = { #double and delete some ship
				if = {
					limit = { 
						any_country = {
							fleet_power > 1 
							count_owned_fleet = { limit = { is_ship_class = shipclass_military } count > 1 }
						}
					}
					random_country = {
						limit = { 
							fleet_power > 1 
							count_owned_fleet = { limit = { is_ship_class = shipclass_military } count > 2 }
						}
						ordered_controlled_fleet = {
							limit = {
								is_ship_class = shipclass_military
							}
							position = 1
							order_by = trigger:fleet_power
							fleet_event = { id = nep_ar.4012 } #nep_copy_fleet_2 = yes
							if = { 
								limit = { 
									NOT = { has_global_flag = nep_copy_fleet_failed } 									
									exists = event_target:nep_copy_fleet_temp_fleet
								}
								event_target:nep_copy_fleet_temp_fleet = {
									set_owner = event_target:nep_arena_hologram
									set_location = event_target:nep_arena_target_pos_2
									if = {
										limit = {
											num_ships > 1
										}
										every_owned_ship = {
											random_list = {
												10 = { delete_ship = this }
												35 = { }
											}
										}
									}
									else = { root = { system_event = { id = nep_ar.40024 } } }
								}
							}
						}
					}
				}
				else = { root = { system_event = { id = nep_ar.40024 } } }
			}
			1 = {#double and not delete some ship
				if = {
					limit = { 
						any_country = {
							fleet_power > 1 
							count_owned_fleet = { limit = { is_ship_class = shipclass_military } count > 1 }
						}
					}
					random_country = {
						limit = { 
							fleet_power > 1 
							count_owned_fleet = { limit = { is_ship_class = shipclass_military } count > 2 }
						}
						ordered_controlled_fleet = {
							limit = {
								is_ship_class = shipclass_military
							}
							position = 1
							order_by = trigger:fleet_power
							fleet_event = { id = nep_ar.4012 } #nep_copy_fleet_2 = yes
							if = { 
								limit = { 
									NOT = { has_global_flag = nep_copy_fleet_failed } 									
									exists = event_target:nep_copy_fleet_temp_fleet
								}
								event_target:nep_copy_fleet_temp_fleet = {
									set_owner = event_target:nep_arena_hologram
									set_location = event_target:nep_arena_target_pos_2
								}
							}
							else = { root = { system_event = { id = nep_ar.40024 } }  }
						}
					}
				}
				else = { root = { system_event = { id = nep_ar.40024 } }  }
			} 
		}
		if = {
			limit = { NOT = { has_global_flag = nep_copy_fleet_failed } }
			event_target:nep_copy_fleet_temp_fleet = { 
				if = {
					limit = { fleet_power < 200 }
					destroy_fleet = this
				}
				else_if = {
					limit = { exists = this }
					set_fleet_flag = nep_arena_target_2
					save_global_event_target_as = nep_arena_target_2
				}
			}
		}
	}
}

system_event = {
	id = nep_ar.40024 #nep_create_enemy_4
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		# print_scope_effect = yes
		random_list = {
			4 = { #delete some ship
				random_country = {
					limit = { 
						fleet_power > 1 
					}
					ordered_controlled_fleet = {
						limit = {
							is_ship_class = shipclass_military
						}
						position = 0
						order_by = trigger:fleet_power
						fleet_event = { id = nep_ar.4011 } #nep_copy_fleet = yes
						if = { 
							limit = { 
								NOT = { has_global_flag = nep_copy_fleet_failed } 									
								exists = event_target:nep_copy_fleet_temp_fleet
							}
							event_target:nep_copy_fleet_temp_fleet = {
								set_owner = event_target:nep_arena_hologram
								set_location = event_target:nep_arena_target_pos_2
								if = {
									limit = {
										num_ships > 1
									}
									every_owned_ship = {
										random_list = {
											10 = { delete_ship = this }
											35 = { }
										}
									}
								}
							}
						}
						else = { root = { system_event = { id = nep_ar.40024 } } }
					}
				}
			}
			3 = {  #not delete
				random_country = {
					limit = { 
						fleet_power > 1 
					}
					ordered_controlled_fleet = {
						limit = {
							is_ship_class = shipclass_military
						}
						position = 0
						order_by = trigger:fleet_power
						fleet_event = { id = nep_ar.4011 } #nep_copy_fleet = yes
						if = { 
							limit = { 
								NOT = { has_global_flag = nep_copy_fleet_failed } 									
								exists = event_target:nep_copy_fleet_temp_fleet
							}
							event_target:nep_copy_fleet_temp_fleet = {
								set_owner = event_target:nep_arena_hologram
								set_location = event_target:nep_arena_target_pos_2
							}
						}
						else = { root = { system_event = { id = nep_ar.40024 } } }
					}
				}
			}
			2 = { #double and delete some ship
				random_country = {
					limit = { 
						fleet_power > 1
					}
					ordered_controlled_fleet = {
						limit = {
							is_ship_class = shipclass_military
						}
						position = 0
						order_by = trigger:fleet_power
						fleet_event = { id = nep_ar.4012 } #nep_copy_fleet_2 = yes
						if = { 
							limit = { 
								NOT = { has_global_flag = nep_copy_fleet_failed } 									
								exists = event_target:nep_copy_fleet_temp_fleet
							}
							event_target:nep_copy_fleet_temp_fleet = {
								set_owner = event_target:nep_arena_hologram
								set_location = event_target:nep_arena_target_pos_2
								if = {
									limit = {
										num_ships > 1
									}
									every_owned_ship = {
										random_list = {
											10 = { delete_ship = this }
											35 = { }
										}
									}
								}
							}
						}
						else = { root = { system_event = { id = nep_ar.40024 } } }
					}
				}
			} 
			1 = {#double and not delete some ship
				random_country = {
					limit = { 
						fleet_power > 1
					}
					ordered_controlled_fleet = {
						limit = {
							is_ship_class = shipclass_military
						}
						position = 0
						order_by = trigger:fleet_power
						fleet_event = { id = nep_ar.4012 } #nep_copy_fleet_2 = yes					
						if = { 
							limit = { 
								NOT = { has_global_flag = nep_copy_fleet_failed } 									
								exists = event_target:nep_copy_fleet_temp_fleet
							}
							event_target:nep_copy_fleet_temp_fleet = {
								set_owner = event_target:nep_arena_hologram
								set_location = event_target:nep_arena_target_pos_2
							}
						}
						else = { root = { system_event = { id = nep_ar.40024 } } }
					}
				}
			}
		}
		if = { 
			limit = { NOT = { has_global_flag = nep_copy_fleet_failed } }
			event_target:nep_copy_fleet_temp_fleet = { 
				if = {
					limit = { fleet_power < 200 }
					destroy_fleet = this
				}
				else_if = {
					limit = { exists = this }
					set_fleet_flag = nep_arena_target_2
					save_global_event_target_as = nep_arena_target_2
				}
			}
		}
	}
}

system_event = {
	id = nep_ar.4003 #nep_create_enemy_3
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		# print_scope_effect = yes
		random_list = {
			4 = { #delete some ship
				if = {
					limit = { 
						any_country = {
							fleet_power > 1 
							count_owned_fleet = { limit = { is_ship_class = shipclass_military } count > 1 }
						}
					}
					random_country = {
						limit = { 
							fleet_power > 1 
							count_owned_fleet = { limit = { is_ship_class = shipclass_military } count > 1 }
						}
						ordered_controlled_fleet = {
							limit = {
								is_ship_class = shipclass_military
							}
							position = 1
							order_by = trigger:fleet_power
							fleet_event = { id = nep_ar.4011 } #nep_copy_fleet = yes
							if = { 
								limit = { 
									NOT = { has_global_flag = nep_copy_fleet_failed } 									
									exists = event_target:nep_copy_fleet_temp_fleet
								}
								event_target:nep_copy_fleet_temp_fleet = {
									set_owner = event_target:nep_arena_hologram
									set_location = event_target:nep_arena_target_pos_3
									if = {
										limit = {
											num_ships > 1
										}
										every_owned_ship = {
											random_list = {
												10 = { delete_ship = this }
												35 = { }
											}
										}
									}
								}
							}
							else = { root = { system_event = { id = nep_ar.40034 } } }
						}
					}
				}
				else = { root = { system_event = { id = nep_ar.40034 } } }
			}
			3 = {  #not delete
				if = {
					limit = { 
						any_country = {
							fleet_power > 1 
							count_owned_fleet = { limit = { is_ship_class = shipclass_military } count > 1 }
						}
					}
					random_country = {
						limit = { 
							fleet_power > 1 
							count_owned_fleet = { limit = { is_ship_class = shipclass_military } count > 2 }
						}
						ordered_controlled_fleet = {
							limit = {
								is_ship_class = shipclass_military
							}
							position = 1
							order_by = trigger:fleet_power
							fleet_event = { id = nep_ar.4011 } #nep_copy_fleet = yes
							if = { 
								limit = { 
									NOT = { has_global_flag = nep_copy_fleet_failed } 									
									exists = event_target:nep_copy_fleet_temp_fleet
								}
								event_target:nep_copy_fleet_temp_fleet = {
									set_owner = event_target:nep_arena_hologram
									set_location = event_target:nep_arena_target_pos_3
								}
							}
							else = { root = { system_event = { id = nep_ar.40034 } } }
						}
					}
				}
				else = { root = { system_event = { id = nep_ar.40034 } } }
			}
			2 = { #double and delete some ship
				if = {
					limit = { 
						any_country = {
							fleet_power > 1 
							count_owned_fleet = { limit = { is_ship_class = shipclass_military } count > 1 }
						}
					}
					random_country = {
						limit = { 
							fleet_power > 1 
							count_owned_fleet = { limit = { is_ship_class = shipclass_military } count > 2 }
						}
						ordered_controlled_fleet = {
							limit = {
								is_ship_class = shipclass_military
							}
							position = 1
							order_by = trigger:fleet_power
							fleet_event = { id = nep_ar.4012 } #nep_copy_fleet_2 = yes
							if = { 
								limit = { 
									NOT = { has_global_flag = nep_copy_fleet_failed } 									
									exists = event_target:nep_copy_fleet_temp_fleet
								}
								event_target:nep_copy_fleet_temp_fleet = {
									set_owner = event_target:nep_arena_hologram
									set_location = event_target:nep_arena_target_pos_3
									if = {
										limit = {
											num_ships > 1
										}
										every_owned_ship = {
											random_list = {
												10 = { delete_ship = this }
												35 = { }
											}
										}
									}
									else = { root = { system_event = { id = nep_ar.40034 } } }
								}
							}
						}
					}
				}
				else = { root = { system_event = { id = nep_ar.40034 } } }
			}
			1 = {#double and not delete some ship
				if = {
					limit = { 
						any_country = {
							fleet_power > 1 
							count_owned_fleet = { limit = { is_ship_class = shipclass_military } count > 1 }
						}
					}
					random_country = {
						limit = { 
							fleet_power > 1 
							count_owned_fleet = { limit = { is_ship_class = shipclass_military } count > 2 }
						}
						ordered_controlled_fleet = {
							limit = {
								is_ship_class = shipclass_military
							}
							position = 1
							order_by = trigger:fleet_power
							fleet_event = { id = nep_ar.4012 } #nep_copy_fleet_2 = yes
							if = { 
								limit = { 
									NOT = { has_global_flag = nep_copy_fleet_failed } 									
									exists = event_target:nep_copy_fleet_temp_fleet
								}
								event_target:nep_copy_fleet_temp_fleet = {
									set_owner = event_target:nep_arena_hologram
									set_location = event_target:nep_arena_target_pos_3
								}
							}
							else = { root = { system_event = { id = nep_ar.40034 } }  }
						}
					}
				}
				else = { root = { system_event = { id = nep_ar.40034 } }  }
			} 
		}
		if = {
			limit = { NOT = { has_global_flag = nep_copy_fleet_failed } }
			event_target:nep_copy_fleet_temp_fleet = { 
				if = {
					limit = { fleet_power < 200 }
					destroy_fleet = this
				}
				else_if = {
					limit = { exists = this }
					set_fleet_flag = nep_arena_target_3
					save_global_event_target_as = nep_arena_target_3
				}
			}
		}
	}
}

system_event = {
	id = nep_ar.40034 #nep_create_enemy_4
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		# print_scope_effect = yes
		random_list = {
			4 = { #delete some ship
				random_country = {
					limit = { 
						fleet_power > 1 
					}
					ordered_controlled_fleet = {
						limit = {
							is_ship_class = shipclass_military
						}
						position = 0
						order_by = trigger:fleet_power
						fleet_event = { id = nep_ar.4011 } #nep_copy_fleet = yes
						if = { 
							limit = { 
								NOT = { has_global_flag = nep_copy_fleet_failed } 									
								exists = event_target:nep_copy_fleet_temp_fleet
							}
							event_target:nep_copy_fleet_temp_fleet = {
								set_owner = event_target:nep_arena_hologram
								set_location = event_target:nep_arena_target_pos_3
								if = {
									limit = {
										num_ships > 1
									}
									every_owned_ship = {
										random_list = {
											10 = { delete_ship = this }
											35 = { }
										}
									}
								}
							}
						}
						else = { root = { system_event = { id = nep_ar.40034 } } }
					}
				}
			}
			3 = {  #not delete
				random_country = {
					limit = { 
						fleet_power > 1 
					}
					ordered_controlled_fleet = {
						limit = {
							is_ship_class = shipclass_military
						}
						position = 0
						order_by = trigger:fleet_power
						fleet_event = { id = nep_ar.4011 } #nep_copy_fleet = yes
						if = { 
							limit = { 
								NOT = { has_global_flag = nep_copy_fleet_failed } 									
								exists = event_target:nep_copy_fleet_temp_fleet
							}
							event_target:nep_copy_fleet_temp_fleet = {
								set_owner = event_target:nep_arena_hologram
								set_location = event_target:nep_arena_target_pos_3
							}
						}
						else = { root = { system_event = { id = nep_ar.40034 } } }
					}
				}
			}
			2 = { #double and delete some ship
				random_country = {
					limit = { 
						fleet_power > 1
					}
					ordered_controlled_fleet = {
						limit = {
							is_ship_class = shipclass_military
						}
						position = 0
						order_by = trigger:fleet_power
						fleet_event = { id = nep_ar.4012 } #nep_copy_fleet_2 = yes
						if = { 
							limit = { 
								NOT = { has_global_flag = nep_copy_fleet_failed } 									
								exists = event_target:nep_copy_fleet_temp_fleet
							}
							event_target:nep_copy_fleet_temp_fleet = {
								set_owner = event_target:nep_arena_hologram
								set_location = event_target:nep_arena_target_pos_3
								if = {
									limit = {
										num_ships > 1
									}
									every_owned_ship = {
										random_list = {
											10 = { delete_ship = this }
											35 = { }
										}
									}
								}
							}
						}
						else = { root = { system_event = { id = nep_ar.40034 } } }
					}
				}
			} 
			1 = {#double and not delete some ship
				random_country = {
					limit = { 
						fleet_power > 1
					}
					ordered_controlled_fleet = {
						limit = {
							is_ship_class = shipclass_military
						}
						position = 0
						order_by = trigger:fleet_power
						fleet_event = { id = nep_ar.4012 } #nep_copy_fleet_2 = yes					
						if = { 
							limit = { 
								NOT = { has_global_flag = nep_copy_fleet_failed } 									
								exists = event_target:nep_copy_fleet_temp_fleet
							}
							event_target:nep_copy_fleet_temp_fleet = {
								set_owner = event_target:nep_arena_hologram
								set_location = event_target:nep_arena_target_pos_3
							}
						}
						else = { root = { system_event = { id = nep_ar.40034 } } }
					}
				}
			}
		}
		if = { 
			limit = { NOT = { has_global_flag = nep_copy_fleet_failed } }
			event_target:nep_copy_fleet_temp_fleet = { 
				if = {
					limit = { fleet_power < 200 }
					destroy_fleet = this
				}
				else_if = {
					limit = { exists = this }
					set_fleet_flag = nep_arena_target_3
					save_global_event_target_as = nep_arena_target_3
				}
			}
		}
	}
}

system_event = {
	id = nep_ar.4004 #nep_create_enemy_4
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		# print_scope_effect = yes
		random_list = {
			4 = { #delete some ship
				random_country = {
					limit = { 
						fleet_power > 1 
					}
					ordered_controlled_fleet = {
						limit = {
							is_ship_class = shipclass_military
						}
						position = 0
						order_by = trigger:fleet_power
						fleet_event = { id = nep_ar.4011 } #nep_copy_fleet = yes
						if = { 
							limit = { 
								NOT = { has_global_flag = nep_copy_fleet_failed } 									
								exists = event_target:nep_copy_fleet_temp_fleet
							}
							event_target:nep_copy_fleet_temp_fleet = {
								set_owner = event_target:nep_arena_hologram
								set_location = event_target:nep_arena_target_pos_4
								if = {
									limit = {
										num_ships > 1
									}
									every_owned_ship = {
										random_list = {
											10 = { delete_ship = this }
											35 = { }
										}
									}
								}
							}
						}
						else = { root = { system_event = { id = nep_ar.4004 } } }
					}
				}
			}
			3 = {  #not delete
				random_country = {
					limit = { 
						fleet_power > 1 
					}
					ordered_controlled_fleet = {
						limit = {
							is_ship_class = shipclass_military
						}
						position = 0
						order_by = trigger:fleet_power
						fleet_event = { id = nep_ar.4011 } #nep_copy_fleet = yes
						if = { 
							limit = { 
								NOT = { has_global_flag = nep_copy_fleet_failed } 									
								exists = event_target:nep_copy_fleet_temp_fleet
							}
							event_target:nep_copy_fleet_temp_fleet = {
								set_owner = event_target:nep_arena_hologram
								set_location = event_target:nep_arena_target_pos_4
							}
						}
						else = { root = { system_event = { id = nep_ar.4004 } } }
					}
				}
			}
			2 = { #double and delete some ship
				random_country = {
					limit = { 
						fleet_power > 1
					}
					ordered_controlled_fleet = {
						limit = {
							is_ship_class = shipclass_military
						}
						position = 0
						order_by = trigger:fleet_power
						fleet_event = { id = nep_ar.4012 } #nep_copy_fleet_2 = yes
						if = { 
							limit = { 
								NOT = { has_global_flag = nep_copy_fleet_failed } 									
								exists = event_target:nep_copy_fleet_temp_fleet
							}
							event_target:nep_copy_fleet_temp_fleet = {
								set_owner = event_target:nep_arena_hologram
								set_location = event_target:nep_arena_target_pos_4
								if = {
									limit = {
										num_ships > 1
									}
									every_owned_ship = {
										random_list = {
											10 = { delete_ship = this }
											35 = { }
										}
									}
								}
							}
						}
						else = { root = { system_event = { id = nep_ar.4004 } } }
					}
				}
			} 
			1 = {#double and not delete some ship
				random_country = {
					limit = { 
						fleet_power > 1
					}
					ordered_controlled_fleet = {
						limit = {
							is_ship_class = shipclass_military
						}
						position = 0
						order_by = trigger:fleet_power
						fleet_event = { id = nep_ar.4012 } #nep_copy_fleet_2 = yes					
						if = { 
							limit = { 
								NOT = { has_global_flag = nep_copy_fleet_failed } 									
								exists = event_target:nep_copy_fleet_temp_fleet
							}
							event_target:nep_copy_fleet_temp_fleet = {
								set_owner = event_target:nep_arena_hologram
								set_location = event_target:nep_arena_target_pos_4
							}
						}
						else = { root = { system_event = { id = nep_ar.4004 } } }
					}
				}
			}
		}
		if = { 
			limit = { NOT = { has_global_flag = nep_copy_fleet_failed } }
			event_target:nep_copy_fleet_temp_fleet = { 
				if = {
					limit = { fleet_power < 200 }
					destroy_fleet = this
				}
				else_if = {
					limit = { exists = this }
					set_fleet_flag = nep_arena_target_4
					save_global_event_target_as = nep_arena_target_4
				}
			}
		}
	}
}

fleet_event = {
	id = nep_ar.4011 #nep_copy_fleet
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		# print_scope_effect = yes	
		if = { 
			limit = { has_global_flag = nep_copy_fleet_failed }
			remove_global_flag = nep_copy_fleet_failed
		}
		if = {
			limit = {		
				exists = root
				is_scope_valid = yes
			}
			create_fleet = {
				settings = {
					can_upgrade = no
					can_change_composition = no
					can_change_leader = no
					uses_naval_capacity = no
					spawn_debris = no
				}
				effect = {
					set_owner = root.owner
					prev = {
						every_owned_ship = {
							save_event_target_as = nep_copy_fleet_temp
							prevprev = {					
								create_ship = {
									name = random
									design = event_target:nep_copy_fleet_temp
								}
							}
						}
					}
					save_event_target_as = nep_copy_fleet_temp_fleet
				}
			}
			if = {
				limit = {
					NOT = { exists = event_target:nep_copy_fleet_temp_fleet }
				}
				set_global_flag = nep_copy_fleet_failed
			}
		}
		else = { set_global_flag = nep_copy_fleet_failed }
	}
}

fleet_event = {
	id = nep_ar.4012 #nep_copy_fleet_2
	hide_window = yes
	
	is_triggered_only = yes
	
	immediate = {
		# print_scope_effect = yes
		if = { 
			limit = { has_global_flag = nep_copy_fleet_failed }
			remove_global_flag = nep_copy_fleet_failed
		}
		if = {
			limit = {		
				exists = root
				is_scope_valid = yes
			}
			create_fleet = {
				settings = {
					can_upgrade = no
					can_change_composition = no
					can_change_leader = no
					uses_naval_capacity = no
					spawn_debris = no
				}
				effect = {
					set_owner = root.owner
					prev = {
						every_owned_ship = {
							save_event_target_as = nep_copy_fleet_temp
							prevprev = {
								create_ship = {
									name = random
									design = event_target:nep_copy_fleet_temp
								}
								create_ship = {
									name = random
									design = event_target:nep_copy_fleet_temp
								}
							}
						}
					}			
					save_event_target_as = nep_copy_fleet_temp_fleet
				}
			}
			if = {
				limit = {
					NOT = { exists = event_target:nep_copy_fleet_temp_fleet }
				}
				set_global_flag = nep_copy_fleet_failed
			}
		}
		else = { set_global_flag = nep_copy_fleet_failed }
	}
}

# Tradestation destroyed and Caravan asks to establish a new one, cara.900
country_event = {
	id = nep_ar.5 #aka.nep_bo.5
	hide_window = yes
	is_triggered_only = yes
	
	trigger = {
		is_multiplayer = no
		is_country_type = caravaneer_home
		fromfrom = { has_ship_flag = cara_home_tradestation }
	}
	
	immediate = {
		random_megastructure = {
			limit = { 
				is_megastructure_type = nep_caravaneer_gate_mega 
				solar_system = {
					NOR = {
						has_star_flag = nep_bounty_office_system
						has_star_flag = nep_arena_office_system
					}
				}
			}
			remove_megastructure = this
		}
		country_event = { id = nep_ar.51 days = 62 } #2 days after cara.930
	}
}

country_event = {
	id = nep_ar.51 #aka.nep_bo.5
	hide_window = yes
	is_triggered_only = yes
	immediate = {
		if = {
			limit = { exists = event_target:caravaneer_home_system }
			event_target:caravaneer_home_system = {
				spawn_megastructure = {
					type = "nep_caravaneer_gate_mega"
					random_pos = yes
					orbit_angle = 360		# range of the randomization
				}
			}
		}
		else = {		
			country_event = { id = nep_ar.51 days = 20 } #2 days after cara.930
		}
	}
}