namespace = stateoflies

planet_event = {
	id = stateoflies.1
	hide_window = yes
	is_triggered_only = yes
 
	immediate = {
		FromFrom = {
			random_list = {
				10 = {
					set_timed_pop_flag = {
						flag = pf_inexperienced
						days = 360
					}
					add_modifier = {
						modifier = pop_inexperienced
						days = 360
					}
				}
				70 = {
					set_timed_pop_flag = {
						flag = pf_inexperienced
						days = 180
					}
					add_modifier = {
						modifier = pop_inexperienced
						days = 180
					}
				}
				20 = {
					set_timed_pop_flag = {
						flag = pf_inexperienced
						days = 90
					}
					add_modifier = {
						modifier = pop_inexperienced
						days = 90
					}
				}
			}
			
			if = {
				limit = { 
					root = { has_modifier = planet_cloning_boost }
					not = { has_trait = trait_mechanical }	
				}
				random_list = {
					5 = {
						add_modifier = {
							modifier = pop_aberrant
							days = -1
						}
						remove_modifier = pop_inexperienced
					}
					5 = {
						add_modifier = {
							modifier = pop_deviant
							days = -1
						}
						remove_modifier = pop_inexperienced
					}
					5 = {
						add_modifier = {
							modifier = pop_tribal
							days = -1
						}
						remove_modifier = pop_inexperienced
					}
					85 = {}
				}
			}
			
			if = {
				limit = { exists = owner }
				if = {
					limit = { owner = { has_policy_flag = state_education_transcendent }}
					random_list = {
						33 = {
							add_modifier = {
								modifier = pop_transcendent
								days = -1
							}
							remove_modifier = pop_inexperienced
						}
						5 = {
							set_timed_pop_flag = {
								flag = pf_uneducated
								days = 360
							}
						}
						25 = {
							remove_modifier = pop_inexperienced
							add_modifier = {
								modifier = pop_qualified
								days = -1
							}						
						}
						37 = {}
					}
					if = {
						limit = { root = { has_modifier = education_programs }}
						random_list = {
							50 = {
								root = {
									random_pop = {
										limit = {
											not = { has_modifier = pop_transcendent }
											not = { has_trait = trait_mechanical }
											is_enslaved = no
										}
										add_modifier = {
											modifier = pop_transcendent
											days = -1
										}
										remove_modifier = pop_inexperienced
										remove_modifier = pop_qualified
									}
								}
							}
							50 = {}
						}
					}
				}
				
				if = {
					limit = { owner = { has_policy_flag = state_education_postadult }}
					random_list = {
						20 = {
							set_timed_pop_flag = {
								flag = pf_uneducated
								days = 720
							}
						}
						30 = {
							set_timed_pop_flag = {
								flag = pf_uneducated
								days = 360
							}
						}
						20 = {
							remove_modifier = pop_inexperienced
							add_modifier = {
								modifier = pop_qualified
								days = -1
							}						
						}
						45 = {}
					}
					if = {
						limit = { root = { has_modifier = education_programs }}
						random_list = {
							50 = {
								root = {
									random_pop = {
										limit = {
											not = { has_modifier = pop_qualified }
											not = { has_modifier = pop_transcendent }
											not = { has_trait = trait_mechanical }
											is_enslaved = no
										}
										add_modifier = {
											modifier = pop_qualified
											days = -1
										}
										remove_modifier = pop_inexperienced
									}
								}
							}
							50 = {}
						}
					}
				}
				
				if = {
					limit = { owner = { has_policy_flag = state_education_preadult }}
					random_list = {
						15 = {
							set_timed_pop_flag = {
								flag = pf_uneducated
								days = 720
							}
						}
						30 = {
							set_timed_pop_flag = {
								flag = pf_uneducated
								days = 360
							}
						}
						10 = {
							remove_modifier = pop_inexperienced
							add_modifier = {
								modifier = pop_qualified
								days = -1
							}						
						}
						45 = {}
					}
					if = {
						limit = { root = { has_modifier = education_programs }}
						random_list = {
							25 = {
								root = {
									random_pop = {
										limit = {
											not = { has_modifier = pop_qualified }
											not = { has_modifier = pop_transcendent }
											not = { has_trait = trait_mechanical }
											is_enslaved = no
										}
										add_modifier = {
											modifier = pop_qualified
											days = -1
										}
										remove_modifier = pop_inexperienced
									}
								}
							}
							75 = {}
						}
					}
				}
				
				if = {
					limit = { owner = { has_policy_flag = state_education_grants }}
					random_list = {
						15 = {
							set_timed_pop_flag = {
								flag = pf_uneducated
								days = 720
							}
						}
						60 = {
							set_timed_pop_flag = {
								flag = pf_uneducated
								days = 360
							}
						}
						5 = {
							remove_modifier = pop_inexperienced
							add_modifier = {
								modifier = pop_qualified
								days = -1
							}						
						}
						20 = {}
					}
					if = {
						limit = { root = { has_modifier = education_programs }}
						random_list = {
							10 = {
								root = {
									random_pop = {
										limit = {
											not = { has_modifier = pop_qualified }
											not = { has_modifier = pop_transcendent }
											not = { has_trait = trait_mechanical }
											is_enslaved = no
										}
										add_modifier = {
											modifier = pop_qualified
											days = -1
										}
										remove_modifier = pop_inexperienced
									}
								}
							}
							90 = {}
						}
					}
				}
				
				if = {
					limit = { owner = { has_policy_flag = state_education_none }}
					random_list = {
						10 = {
							set_pop_flag = pf_uneducated
						}
						50 = {
							set_timed_pop_flag = {
								flag = pf_uneducated
								days = 7200
							}
						}
						35 = {
							set_timed_pop_flag = {
								flag = pf_uneducated
								days = 3600
							}
						}
						5 = {
							set_timed_pop_flag = {
								flag = pf_uneducated
								days = 720
							}
						}
					}			
				}
				
				if = {
					limit = { owner = { has_valid_civic = civic_natural_harmony }}
					random_list = {
						75 = {}
						25 = {
							remove_modifier = pop_qualified
							remove_modifier = pop_transcendent
							add_modifier = {
								modifier = pop_nomadic
								days = -1
							}
						}
					}					
				}
				
				if = {
					limit = { 
						owner = {
							or = {
								has_valid_civic = civic_fury_road
								has_valid_civic = civic_stellartisan
							}
						}
					}
					random_list = {
						75 = {}
						25 = {
							remove_modifier = pop_qualified
							remove_modifier = pop_transcendent
							remove_modifier = pop_nomadic
							add_modifier = {
								modifier = pop_tribal
								days = -1
							}
						}
					}					
				}
				
				if = {
					limit = { owner = { has_valid_civic = civic_communes }}
					random_list = {
						66 = {}
						34 = {
							remove_modifier = pop_qualified
							remove_modifier = pop_transcendent
							remove_modifier = pop_nomadic
							remove_modifier = pop_tribal
							add_modifier = {
								modifier = pop_communal
								days = -1
							}
						}
					}					
				}
				
				if = {
					limit = { owner = { has_valid_civic = civic_genetic_welfare }}
					random_list = {
						65 = {}
						33 = {
							remove_modifier = pop_tribal
							add_modifier = {
								modifier = pop_healthy
								days = -1
							}
						}
						1 = {
							remove_modifier = pop_qualified
							remove_modifier = pop_transcendent
							remove_modifier = pop_nomadic
							remove_modifier = pop_tribal
							remove_modifier = pop_communal
							add_modifier = {
								modifier = pop_aberrant
								days = -1
							}						
						}
						1 = {
							remove_modifier = pop_qualified
							remove_modifier = pop_transcendent
							remove_modifier = pop_nomadic
							remove_modifier = pop_tribal
							remove_modifier = pop_communal
							add_modifier = {
								modifier = pop_deviant
								days = -1
							}						
						}
					}					
				}
				
				if = {
					limit = { owner = { has_valid_civic = civic_genetic_inheritance }}
					random_list = {
						46 = {}
						50 = {
							if = {
								limit = {
									not = { has_modifier = pop_transcendent }
								}
								remove_modifier = pop_qualified
								remove_modifier = pop_nomadic
								remove_modifier = pop_tribal
								remove_modifier = pop_communal
								add_modifier = {
									modifier = pop_qualified
									days = -1
								}
							}
						}
						2 = {
							remove_modifier = pop_qualified
							remove_modifier = pop_transcendent
							remove_modifier = pop_nomadic
							remove_modifier = pop_tribal
							remove_modifier = pop_communal
							remove_modifier = pop_healthy
							remove_modifier = pop_aberrant
							add_modifier = {
								modifier = pop_aberrant
								days = -1
							}						
						}
						2 = {
							remove_modifier = pop_qualified
							remove_modifier = pop_transcendent
							remove_modifier = pop_nomadic
							remove_modifier = pop_tribal
							remove_modifier = pop_communal
							remove_modifier = pop_healthy
							remove_modifier = pop_deviant
							add_modifier = {
								modifier = pop_deviant
								days = -1
							}						
						}
					}					
				}
				if = {
					limit = {
						owner = {
							or = {
								has_ethic = ethic_authoritarian
								has_ethic = ethic_fanatic_authoritarian
								has_ethic = ethic_xenophobe
								has_ethic = ethic_fanatic_xenophobe
							}
						}
					}
					random_list = {
						5 = {
							remove_modifier = pop_nomadic
							remove_modifier = pop_tribal
							remove_modifier = pop_aberrant
							remove_modifier = pop_deviant
							remove_modifier = pop_loyalist
							add_modifier = {
								modifier = pop_loyalist
								days = -1
							}
						}
						95 = {}
					}					
				}
				if = {
					limit = { owner = { has_ethic = ethic_fanatic_authoritarian }}
					random_list = {
						5 = {
							remove_modifier = pop_nomadic
							remove_modifier = pop_tribal
							remove_modifier = pop_aberrant
							remove_modifier = pop_deviant
							remove_modifier = pop_loyalist
							add_modifier = {
								modifier = pop_loyalist
								days = -1
							}
						}
						95 = {}
					}					
				}
				if = {
					limit = {
						owner = {
							or = {
								has_ethic = ethic_xenophobe
								has_ethic = ethic_fanatic_xenophobe
								has_valid_civic = civic_police_state
							}
						}
					}
					random_list = {
						5 = {
							remove_modifier = pop_nomadic
							remove_modifier = pop_tribal
							remove_modifier = pop_aberrant
							remove_modifier = pop_deviant
							remove_modifier = pop_vigilant
							add_modifier = {
								modifier = pop_vigilant
								days = -1
							}
						}
						95 = {}
					}					
				}
				if = {
					limit = { 
						owner = { has_ethic = ethic_fanatic_xenophobe }
					}
					random_list = {
						5 = {
							remove_modifier = pop_nomadic
							remove_modifier = pop_tribal
							remove_modifier = pop_aberrant
							remove_modifier = pop_deviant
							remove_modifier = pop_vigilant
							add_modifier = {
								modifier = pop_vigilant
								days = -1
							}
						}
						95 = {}
					}					
				}
				
				if = {
					limit = { root = { num_pops < 5 }}
					remove_modifier = pop_inexperienced
					remove_modifier = pop_aberrant
					remove_modifier = pop_deviant
					remove_modifier = pop_tribal
					remove_modifier = pop_nomadic
				}
			}
		}

		remove_modifier = luxury_benefits_low
		remove_modifier = luxury_benefits_medium
		remove_modifier = luxury_benefits_high
		if = {
			limit = {
				num_pops > 80
				free_amenities > 150
				free_amenities < 200
			}
			add_modifier = {
				modifier = luxury_benefits_low
				days = -1
			}
		}
		if = {
			limit = {
				num_pops > 80
				free_amenities >= 200
				free_amenities < 250
			}
			add_modifier = {
				modifier = luxury_benefits_medium
				days = -1
			}
		}
		if = {
			limit = {
				num_pops > 80
				free_amenities >= 250
			}
			add_modifier = {
				modifier = luxury_benefits_high
				days = -1
			}
		}
		
		remove_modifier = destitute_some
		remove_modifier = destitute_many
		remove_modifier = destitute_lots
		if = {
			limit = {
				num_pops > 80
				free_amenities > 100
				count_owned_pops = { 
					limit = { 
						is_unemployed = yes 
					}
					count > 6
				}
			}
			add_modifier = {
				modifier = destitute_lots
				days = -1
			}
		}
		else_if = {
			limit = {
				num_pops > 75
				free_amenities > 125
				count_owned_pops = { 
					limit = { 
						is_unemployed = yes 
					}
					count > 4
				}
			}
			add_modifier = {
				modifier = destitute_many
				days = -1
			}
		}
		else_if = {
			limit = {
				num_pops > 70
				free_amenities > 150
				count_owned_pops = { 
					limit = { 
						is_unemployed = yes 
					}
					count > 2
				}
			}
			add_modifier = {
				modifier = destitute_some
				days = -1
			}
		}
	}
}