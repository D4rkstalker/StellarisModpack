namespace = pmhm

#test event
country_event = {
	id = pmhm.1000
	is_triggered_only = yes
	hide_window = yes

	immediate = {
		change_variable = { which = high_planet_mining value = 1 }
	}
}

country_event = {
	id = pmhm.1001
	is_triggered_only = yes
	hide_window = yes

	immediate = {
		change_variable = { which = high_planet_mining value = 1 }
		change_variable = { which = high_planet_energy value = 1 }
		change_variable = { which = high_planet_farming value = 1 }
		change_variable = { which = high_planet_trade value = 1 }
		change_variable = { which = high_planet_training value = 1 }
		change_variable = { which = high_planet_eco value = 1 }
		change_variable = { which = high_planet_city value = 1 }
	}
}

country_event = {
	id = pmhm.1002
	is_triggered_only = yes
	hide_window = yes

	immediate = {
		change_variable = { which = high_planet_mining value = -1 }
		change_variable = { which = high_planet_energy value = -1 }
		change_variable = { which = high_planet_farming value = -1 }
		change_variable = { which = high_planet_trade value = -1 }
		change_variable = { which = high_planet_training value = -1 }
		change_variable = { which = high_planet_eco value = -1 }
		change_variable = { which = high_planet_city value = -1 }
	}
}

country_event = {
	id = pmhm.1003
	is_triggered_only = yes
	hide_window = yes

	immediate = {
		change_variable = { which = high_planet value = 1 }
	}
}

country_event = {
	id = pmhm.1004
	is_triggered_only = yes
	hide_window = yes

	immediate = {
		change_variable = { which = high_planet value = -1 }
	}
}

planet_event = {
	id = pmhm.1005
	is_triggered_only = yes
	hide_window = yes

	immediate = {
		add_modifier = {
			modifier = "connected_hm"
			days = -1
		}
	}
}

planet_event = {
	id = pmhm.1006
	is_triggered_only = yes
	hide_window = yes

	immediate = {
		add_modifier = {
			modifier = "high_planet_bad"
			days = -1
		}
	}
}

country_event = {
	id = pmhm.1010
	is_triggered_only = yes
	hide_window = yes

	immediate = {
		every_owned_planet = {
			limit = {
				has_modifier = "connected_hm"
			}
			if = {
				limit = { 
					owner = { check_variable = { which = high_planet value = 4 } }
				}
				remove_deposit = d_hm_energy_60
				add_deposit = d_hm_energy_55
			}
			if = {
				limit = { 
					owner = { check_variable = { which = high_planet value = 7 } }
				}
				remove_deposit = d_hm_energy_55
				add_deposit = d_hm_energy_50
			}
			if = {
				limit = {
					owner = { check_variable = { which = high_planet value = 10 } }
				}
				remove_deposit = d_hm_energy_50
				add_deposit = d_hm_energy_40
			}
		}
	}
}

planet_event = {
	id = pmhm.1011
	title = "pmhm.2.name"
	desc = {
		trigger = {
			#text = "pmhm.1011.desc"
			success_text = { 
				text = "pmhm.1011.hp.low" 
				owner = { check_variable = { which = high_planet value < 4 } }
			}
			success_text = { 
				text = "pmhm.1011.hp.middle" 
				AND = {
					owner = { check_variable = { which = high_planet value > 3 } }
					owner = { check_variable = { which = high_planet value < 7 } }
				}
			}
			success_text = { 
				text = "pmhm.1011.hp.high" 
				AND = {
					owner = { check_variable = { which = high_planet value > 6 } }
					owner = { check_variable = { which = high_planet value < 10 } }
				}
			}
			success_text = { 
				text = "pmhm.1011.hp.veryhigh" 
				owner = { check_variable = { which = high_planet value > 9 } }
			}
			#text = "pmhm.1011.desc.next"
			text = newline
			text = "pmhm.1011.desc.warning"
		}
	}
	diplomatic = yes
	force_open = yes	
	picture_event_data = { room = high_planet_room }	
	is_triggered_only = yes
	location = root

	option = {
		name = "pmhm.1011"
		custom_tooltip = pmhm.1011.tooltip
		hidden_effect = {
			owner = {
				country_event = { id = pmhm.1012 days = 3600 } #days 3600
				set_timed_country_flag = { flag = high_planet_shutdown days = 7200 }
				set_timed_country_flag = { flag = high_planet_shutdown_waiting days = 3600 } #days 3600
				every_owned_planet = {
					limit = {
						has_modifier = "connected_hm"
					}
					remove_deposit = d_hm_energy_60
					remove_deposit = d_hm_energy_55
					remove_deposit = d_hm_energy_50
					remove_deposit = d_hm_energy_40
					add_deposit = d_hm_energy_5
				}
			}
		}
	}
	option = {
		name = "pmhm.1.back"
		hidden_effect = {
			planet_event = { id = pmhm.1 }
		}
	}
	option = { name = "pmhm.1.exit" default_hide_option = yes }
}

country_event = {
	id = pmhm.1012
	title = "pmhm.1.name"
	desc = {
		trigger = {
			#text = "pmhm.1012.desc"
			success_text = { 
				text = "pmhm.1012.hp.low" 
				owner = { check_variable = { which = high_planet value < 4 } }
			}
			success_text = { 
				text = "pmhm.1012.hp.middle" 
				AND = {
					owner = { check_variable = { which = high_planet value > 3 } }
					owner = { check_variable = { which = high_planet value < 7 } }
				}
			}
			success_text = { 
				text = "pmhm.1012.hp.high" 
				AND = {
					owner = { check_variable = { which = high_planet value > 6 } }
					owner = { check_variable = { which = high_planet value < 10 } }
				}
			}
			success_text = { 
				text = "pmhm.1012.hp.veryhigh" 
				owner = { check_variable = { which = high_planet value > 9 } }
			}
			#text = "pmhm.1012.desc.next"
		}
	}
	diplomatic = yes
	force_open = yes	
	picture_event_data = { room = high_planet_room }	
	is_triggered_only = yes
	location = root

	option = {
		name = "pmhm.1.exit"
		custom_tooltip = pmhm.1012.tooltip
		hidden_effect = {
			every_owned_planet = {
				limit = {
					has_modifier = "connected_hm"
				}
				if = {
					limit = { 
						owner = { check_variable = { which = high_planet value < 4 } }
					}
					remove_deposit = d_hm_energy_5
					add_deposit = d_hm_energy_60
				}
				if = {
					limit = { 
						AND = {
							owner = { check_variable = { which = high_planet value > 3 } }
							owner = { check_variable = { which = high_planet value < 7 } }
						}
					}
					remove_deposit = d_hm_energy_5
					add_deposit = d_hm_energy_55
				}
				if = {
					limit = {
						AND = {
							owner = { check_variable = { which = high_planet value > 6 } }
							owner = { check_variable = { which = high_planet value < 10 } }
						}
					}
					remove_deposit = d_hm_energy_5
					add_deposit = d_hm_energy_50
				}
				if = {
					limit = {
						owner = { check_variable = { which = high_planet value > 9 } }
					}
					remove_deposit = d_hm_energy_5
					add_deposit = d_hm_energy_40
				}
			}
		}
	}
}

country_event = {
	id = pmhm.1013
	is_triggered_only = yes
	hide_window = yes

	immediate = {
		remove_country_flag = high_planet_shutdown
	}
}

country_event = {
	id = pmhm.1014
	is_triggered_only = yes
	hide_window = yes

	immediate = {
		remove_country_flag = high_planet_shutdown_waiting
	}
}

planet_event = {
	id = pmhm.1015
	is_triggered_only = yes
	hide_window = yes

	immediate = {
		change_variable = { which = mop_entering_bm value = 10 }
	}
}

planet_event = {
	id = pmhm.1016
	is_triggered_only = yes
	hide_window = yes

	immediate = {
		remove_planet_flag = mop_makingnewspecies_waiting
	}
}

#main event
planet_event = {
	id = pmhm.1
	show_sound = event_cityscape
	title = "pmhm.1.name"
	desc = {
		trigger = {
			text = "pmhm.1.desc"
			text = newline	
			success_text = { text = "pmhm.1.mining" owner = { check_variable = { which = high_planet_mining value > 0 } } }
			success_text = { text = "pmhm.1.mining.none" owner = { check_variable = { which = high_planet_mining value = 0 } } }
			success_text = { text = "pmhm.1.energy" owner = { check_variable = { which = high_planet_energy value > 0 } } }
			success_text = { text = "pmhm.1.energy.none" owner = { check_variable = { which = high_planet_energy value = 0 } } }
			success_text = { text = "pmhm.1.farming" owner = { check_variable = { which = high_planet_farming value > 0 } } }
			success_text = { text = "pmhm.1.farming.none" owner = { check_variable = { which = high_planet_farming value = 0 } } }
			success_text = { text = "pmhm.1.trade" owner = { check_variable = { which = high_planet_trade value > 0 } } }
			success_text = { text = "pmhm.1.trade.none" owner = { check_variable = { which = high_planet_trade value = 0 } } }
			success_text = { text = "pmhm.1.training" owner = { check_variable = { which = high_planet_training value > 0 } } }
			success_text = { text = "pmhm.1.training.none" owner = { check_variable = { which = high_planet_training value = 0 } } }
			success_text = { text = "pmhm.1.eco" owner = { check_variable = { which = high_planet_eco value > 0 } } }
			success_text = { text = "pmhm.1.eco.none" owner = { check_variable = { which = high_planet_eco value = 0 } } }
			success_text = { text = "pmhm.1.city" owner = { check_variable = { which = high_planet_city value > 0 } } }
			success_text = { text = "pmhm.1.city.none" owner = { check_variable = { which = high_planet_city value = 0 } } }
			text = newline	
		}
	}
	diplomatic = yes
	force_open = yes	
	picture_event_data = { room = high_planet_room }	
	is_triggered_only = yes
	location = root
	option = {
		name = "pmhm.1.planet.mining"
		allow = {
			custom_tooltip = {
				fail_text = need_connecting
				has_modifier = connected_hm
			}
			custom_tooltip = {
				fail_text = need_shutdown_waiting_2
				NOT = { 
					owner = {
						has_country_flag = high_planet_shutdown_waiting 
					}
				}
			}
		}
		trigger = {
			is_planet_class = pc_mining
		}
		hidden_effect = {
			planet_event = { id = pmhm.100 }
		}
	}
	option = {
		name = "pmhm.1.planet.energy"
		allow = {
			custom_tooltip = {
				fail_text = need_connecting
				has_modifier = connected_hm
			}
			custom_tooltip = {
				fail_text = need_shutdown_waiting_2
				NOT = { 
					owner = {
						has_country_flag = high_planet_shutdown_waiting 
					}
				}
			}
		}
		trigger = {
			is_planet_class = pc_energy
		}
		hidden_effect = {
			planet_event = { id = pmhm.110 }
		}
	}
	option = {
		name = "pmhm.1.planet.farming"
		allow = {
			custom_tooltip = {
				fail_text = need_connecting
				has_modifier = connected_hm
			}
			custom_tooltip = {
				fail_text = need_shutdown_waiting_2
				NOT = { 
					owner = {
						has_country_flag = high_planet_shutdown_waiting 
					}
				}
			}
		}
		trigger = {
			is_planet_class = pc_farming
		}
		hidden_effect = {
			planet_event = { id = pmhm.120 }
		}
	}
	option = {
		name = "pmhm.1.planet.trade"
		allow = {
			custom_tooltip = {
				fail_text = need_connecting
				has_modifier = connected_hm
			}
			custom_tooltip = {
				fail_text = need_shutdown_waiting_2
				NOT = { 
					owner = {
						has_country_flag = high_planet_shutdown_waiting 
					}
				}
			}
		}
		trigger = {
			is_planet_class = pc_trade
		}
		hidden_effect = {
			planet_event = { id = pmhm.130 }
		}
	}
	option = {
		name = "pmhm.1.planet.training"
		allow = {
			custom_tooltip = {
				fail_text = need_connecting
				has_modifier = connected_hm
			}
			custom_tooltip = {
				fail_text = need_shutdown_waiting_2
				NOT = { 
					owner = {
						has_country_flag = high_planet_shutdown_waiting 
					}
				}
			}
		}
		trigger = {
			is_training_planet = yes
		}
		hidden_effect = {
			planet_event = { id = pmhm.140 }
		}
	}
	option = {
		name = "pmhm.1.planet.eco"
		allow = {
			custom_tooltip = {
				fail_text = need_connecting
				has_modifier = connected_hm
			}
			custom_tooltip = {
				fail_text = need_shutdown_waiting_2
				NOT = { 
					owner = {
						has_country_flag = high_planet_shutdown_waiting 
					}
				}
			}
		}
		trigger = {
			is_planet_class = pc_eco
		}
		hidden_effect = {
			planet_event = { id = pmhm.150 }
		}
	}
	option = {
		name = "pmhm.1.planet.city"
		allow = {
			custom_tooltip = {
				fail_text = need_connecting
				has_modifier = connected_hm
			}
			custom_tooltip = {
				fail_text = need_shutdown_waiting_2
				NOT = { 
					owner = {
						has_country_flag = high_planet_shutdown_waiting 
					}
				}
			}
		}
		trigger = {
			is_planet_class = pc_city
		}
		hidden_effect = {
			planet_event = { id = pmhm.160 }
		}
	}
	option = {
		name = "pmhm.1.high"
		allow = {
			custom_tooltip = {
				fail_text = need_connecting
				has_modifier = connected_hm
			}
			custom_tooltip = {
				fail_text = need_shutdown_waiting_2
				NOT = { 
					owner = {
						has_country_flag = high_planet_shutdown_waiting 
					}
				}
			}
		}
		hidden_effect = {
			planet_event = { id = pmhm.4 }
		}
	}
	option = {
		name = "pmhm.1.hp.zero"
		trigger = {
			owner = { check_variable = { which = high_planet value = 0 } }
		}
		hidden_effect = {
			if = {
				limit = { NOT = { has_modifier = connected_hm } }
				planet_event = { id = pmhm.2 }
			}
			else = { planet_event = { id = pmhm.3 } }
		}
	}
	option = {
		name = "pmhm.1.hp.low"
		trigger = {
			AND = {
				owner = { check_variable = { which = high_planet value < 4 } }
				owner = { check_variable = { which = high_planet value > 0 } }
			}
		}
		hidden_effect = {
			if = {
				limit = { NOT = { has_modifier = connected_hm } }
				planet_event = { id = pmhm.2 }
			}
			else = { planet_event = { id = pmhm.3 } }
		}
	}
	option = {
		name = "pmhm.1.hp.middle"
		trigger = {
			AND = {
				owner = { check_variable = { which = high_planet value > 3 } }
				owner = { check_variable = { which = high_planet value < 7 } }
			}
		}
		hidden_effect = {
			if = {
				limit = { NOT = { has_modifier = connected_hm } }
				planet_event = { id = pmhm.2 }
			}
			else = { planet_event = { id = pmhm.3 } }
		}
	}
	option = {
		name = "pmhm.1.hp.high"
		trigger = {
			AND = {
				owner = { check_variable = { which = high_planet value > 6 } }
				owner = { check_variable = { which = high_planet value < 10 } }
			}
		}
		hidden_effect = {
			if = {
				limit = { NOT = { has_modifier = connected_hm } }
				planet_event = { id = pmhm.2 }
			}
			else = { planet_event = { id = pmhm.3 } }
		}
	}
	option = {
		name = "pmhm.1.hp.veryhigh"
		trigger = {
			owner = { check_variable = { which = high_planet value > 9 } }
		}
		hidden_effect = {
			if = {
				limit = { NOT = { has_modifier = connected_hm } }
				planet_event = { id = pmhm.2 }
			}
			else = { planet_event = { id = pmhm.3 } }
		}
	}
	option = { name = "pmhm.1.exit" default_hide_option = yes }
}

#Connecting to main computer
planet_event = {
	id = pmhm.2
	title = "pmhm.2.name"
	desc = {
		trigger = {
			success_text = { 
				text = "pmhm.1.hp.zero" 
				owner = { check_variable = { which = high_planet value = 0 } }
			}
			success_text = { 
				text = "pmhm.1.hp.low" 
				AND = {
					owner = { check_variable = { which = high_planet value < 4 } }
					owner = { check_variable = { which = high_planet value > 0 } }
				}
			}
			success_text = { 
				text = "pmhm.1.hp.middle" 
				AND = {
					owner = { check_variable = { which = high_planet value > 3 } }
					owner = { check_variable = { which = high_planet value < 7 } }
				}
			}
			success_text = { 
				text = "pmhm.1.hp.high" 
				AND = {
					owner = { check_variable = { which = high_planet value > 6 } }
					owner = { check_variable = { which = high_planet value < 10 } }
				}
			}
			success_text = { 
				text = "pmhm.1.hp.veryhigh" 
				owner = { check_variable = { which = high_planet value > 9 } }
			}
			text = newline	
			text = "pmhm.2.desc"
			text = newline	
			success_text = { 
				text = "pmhm.2.hp.low" 
				owner = { check_variable = { which = high_planet value < 3 } }
			}
			success_text = { 
				text = "pmhm.2.hp.middle" 
				AND = {
					owner = { check_variable = { which = high_planet value > 2 } }
					owner = { check_variable = { which = high_planet value < 6 } }
				}
			}
			success_text = { 
				text = "pmhm.2.hp.high" 
				AND = {
					owner = { check_variable = { which = high_planet value > 5 } }
					owner = { check_variable = { which = high_planet value < 9 } }
				}
			}
			success_text = { 
				text = "pmhm.2.hp.veryhigh" 
				owner = { check_variable = { which = high_planet value > 8 } }
			}
			text = newline
			text = "pmhm.2.desc.warning"
		}
	}
	diplomatic = yes
	force_open = yes	
	picture_event_data = { room = high_planet_room }	
	is_triggered_only = yes
	location = root
	
	option = {
		name = "pmhm.2.connecting"
		allow = {
			custom_tooltip = {
				fail_text = need_shutdown_waiting_2
				NOT = {
					owner = {
						has_country_flag = high_planet_shutdown_waiting 
					}
				}
			}
		}
		add_modifier = {
			modifier = "connected_hm"
			days = -1
		}
		hidden_effect = {
			if = {
				limit = { owner = { check_variable = { which = high_planet value < 4 } } }
				add_deposit = d_hm_energy_60
			}
			else_if = {
				limit = { 
					AND = {
						owner = { check_variable = { which = high_planet value > 3 } }
						owner = { check_variable = { which = high_planet value < 7 } }
					}
				}
				add_deposit = d_hm_energy_55
			}
			else_if = {
				limit = { 
					AND = {
						owner = { check_variable = { which = high_planet value > 6 } }
						owner = { check_variable = { which = high_planet value < 10 } }
					}
				}
				add_deposit = d_hm_energy_50
			}
			else = {
				add_deposit = d_hm_energy_40
			}
			owner = {
				change_variable = { which = high_planet value = 1 }
				change_variable = { which = high_planet_60 value = 60 }
				change_variable = { which = high_planet_55 value = 55 }
				change_variable = { which = high_planet_50 value = 50 }
				change_variable = { which = high_planet_40 value = 40 }
				change_variable = { which = high_planet_5 value = 5 }
				country_event = { id = pmhm.1010 }
			}
			if = {
				limit = {
					exists = owner
					owner = { 
						has_country_flag = high_planet_a
						NOT = { has_country_flag = high_planet_b }
						NOT = { has_country_flag = high_planet_c }
					}
				}
				remove_modifier = "high_planet_bad"
				remove_modifier = "high_planet_normal"
				remove_modifier = "high_planet_p_upgraded"
				remove_modifier = "high_planet_upgraded"
				add_modifier = {
					modifier = "high_planet_normal"
					days = -1
				}
			}
			if = {
				limit = {
					exists = owner
					owner = { 
						has_country_flag = high_planet_a
						has_country_flag = high_planet_b
						NOT = { has_country_flag = high_planet_c }
					}
				}
				remove_modifier = "high_planet_bad"
				remove_modifier = "high_planet_normal"
				remove_modifier = "high_planet_p_upgraded"
				remove_modifier = "high_planet_upgraded"
				add_modifier = {
					modifier = "high_planet_p_upgraded"
					days = -1
				}
			}
			if = {
				limit = {
					exists = owner
					owner = { 
						has_country_flag = high_planet_a
						has_country_flag = high_planet_b
						has_country_flag = high_planet_c
					}
				}
				remove_modifier = "high_planet_bad"
				remove_modifier = "high_planet_normal"
				remove_modifier = "high_planet_p_upgraded"
				remove_modifier = "high_planet_upgraded"
				add_modifier = {
					modifier = "high_planet_upgraded"
					days = -1
				}
			}
		}
	}
	option = {
		name = "pmhm.1.back"
		hidden_effect = {
			planet_event = { id = pmhm.1 }
		}
	}
	option = { name = "pmhm.1.exit" default_hide_option = yes }
}

planet_event = {
	id = pmhm.3
	title = "pmhm.2.name"
	desc = {
		trigger = {
			success_text = { 
				text = "pmhm.1.hp.zero" 
				owner = { check_variable = { which = high_planet value = 0 } }
			}
			success_text = { 
				text = "pmhm.1.hp.low" 
				AND = {
					owner = { check_variable = { which = high_planet value < 4 } }
					owner = { check_variable = { which = high_planet value > 0 } }
				}
			}
			success_text = { 
				text = "pmhm.1.hp.middle" 
				AND = {
					owner = { check_variable = { which = high_planet value > 3 } }
					owner = { check_variable = { which = high_planet value < 7 } }
				}
			}
			success_text = { 
				text = "pmhm.1.hp.high" 
				AND = {
					owner = { check_variable = { which = high_planet value > 6 } }
					owner = { check_variable = { which = high_planet value < 10 } }
				}
			}
			success_text = { 
				text = "pmhm.1.hp.veryhigh" 
				owner = { check_variable = { which = high_planet value > 9 } }
			}
			text = newline	
			text = "pmhm.3.desc"
			text = newline	
			success_text = { 
				text = "pmhm.3.hp.low" 
				owner = { check_variable = { which = high_planet value < 4 } }
			}
			success_text = { 
				text = "pmhm.3.hp.middle" 
				AND = {
					owner = { check_variable = { which = high_planet value > 3 } }
					owner = { check_variable = { which = high_planet value < 7 } }
				}
			}
			success_text = { 
				text = "pmhm.3.hp.high" 
				AND = {
					owner = { check_variable = { which = high_planet value > 6 } }
					owner = { check_variable = { which = high_planet value < 10 } }
				}
			}
			success_text = { 
				text = "pmhm.3.hp.veryhigh" 
				owner = { check_variable = { which = high_planet value > 9 } }
			}
			text = newline
			success_text = { 
				text = "pmhm.3.hp.all.low" 
				AND = {
					NOT = { 
						owner = {
							has_country_flag = high_planet_shutdown_waiting 
						}
					}
					owner = { check_variable = { which = high_planet value < 4 } }
				}
			}
			success_text = { 
				text = "pmhm.3.hp.all.middle" 
				AND = {
					NOT = { 
						owner = {
							has_country_flag = high_planet_shutdown_waiting 
						}
					}
					owner = { check_variable = { which = high_planet value > 3 } }
					owner = { check_variable = { which = high_planet value < 7 } }
					
				}
			}
			success_text = { 
				text = "pmhm.3.hp.all.high" 
				AND = {
					NOT = { 
						owner = {
							has_country_flag = high_planet_shutdown_waiting 
						}
					}
					owner = { check_variable = { which = high_planet value > 6 } }
					owner = { check_variable = { which = high_planet value < 10 } }
				}
			}
			success_text = { 
				text = "pmhm.3.hp.all.veryhigh" 
				AND = {
					NOT = { 
						owner = {
							has_country_flag = high_planet_shutdown_waiting 
						}
					}
					owner = { check_variable = { which = high_planet value > 9 } }
				}
			}
			success_text = { 
				text = "pmhm.3.hp.all.shutdown" 
				owner = {
					has_country_flag = high_planet_shutdown_waiting 
				}
			}
		}
	}
	diplomatic = yes
	force_open = yes	
	picture_event_data = { room = high_planet_room }	
	is_triggered_only = yes
	location = root
	
	option = {
		name = "pmhm.3.plz"
		allow = {
			custom_tooltip = {
				fail_text = need_shutdown_waiting
				NOT = {
					owner = {
						has_country_flag = high_planet_shutdown
					}
				}
			}
		}
		hidden_effect = {
			planet_event = { id = pmhm.1011 }
		}
	}
	option = {
		name = "pmhm.1.back"
		hidden_effect = {
			planet_event = { id = pmhm.1 }
		}
	}
	option = { name = "pmhm.1.exit" default_hide_option = yes }
}

planet_event = {
	id = pmhm.4
	title = "pmhm.4.name"
	desc = {
		trigger = {
			text = "pmhm.4.desc"
			text = newline	
			success_text = { text = "pmhm.4.desc.a" owner = { check_variable = { which = high_planet_modifier value = 0 } } }
			success_text = { text = "pmhm.4.desc.b" owner = { check_variable = { which = high_planet_modifier value = 1 } } }
			success_text = { text = "pmhm.4.desc.c" owner = { check_variable = { which = high_planet_modifier value = 2 } } }
			success_text = { text = "pmhm.4.desc.d" owner = { check_variable = { which = high_planet_modifier value = 3 } } }
		}
	}
	diplomatic = yes
	force_open = yes	
	picture_event_data = { room = high_planet_room }	
	is_triggered_only = yes
	location = root
	
	option = {
		name = "pmhm.4.a"
		custom_tooltip = pmhm.4.a.tooltip
		allow = {
			owner = {
				AND = {
					resource_stockpile_compare = { resource = energy value >= 10000 }
					resource_stockpile_compare = { resource = influence value >= 150 }
				}
			}
			custom_tooltip = {
				fail_text = high_planet_2_desc
				NOT = {
					owner = {
						has_country_flag = high_planet_a
					}
				}
			}
		}
		owner = {
			add_resource = { energy = -10000 }
			add_resource = { influence = -150 }
		}
		hidden_effect = {
			owner = {
				set_country_flag = high_planet_a
				change_variable = { which = high_planet_modifier value = 1 }
				every_planet_within_border = {
					limit = {
						has_modifier = "connected_hm"
					}
					remove_modifier = "high_planet_bad"
					remove_modifier = "high_planet_normal"
					remove_modifier = "high_planet_p_upgraded"
					remove_modifier = "high_planet_upgraded"
					add_modifier = {
						modifier = high_planet_normal
						days = -1
					}
				}
			}
		}
	}
	option = {
		name = "pmhm.4.b"
		custom_tooltip = pmhm.4.b.tooltip
		allow = {
			owner = {
				AND = {
					resource_stockpile_compare = { resource = energy value >= 20000 }
					resource_stockpile_compare = { resource = influence value >= 300 }
				}
			}
			custom_tooltip = {
				fail_text = high_planet_1_desc
				owner = {
					has_country_flag = high_planet_a
				}
			}
			custom_tooltip = {
				fail_text = high_planet_2_desc
				NOT = {
					owner = {
						has_country_flag = high_planet_b
					}
				}
			}
		}
		owner = {
			add_resource = { energy = -20000 }
			add_resource = { influence = -300 }
		}
		hidden_effect = {
			owner = {
				set_country_flag = high_planet_b
				change_variable = { which = high_planet_modifier value = 1 }
				every_planet_within_border = {
					limit = {
						has_modifier = "connected_hm"
					}
					remove_modifier = "high_planet_bad"
					remove_modifier = "high_planet_normal"
					remove_modifier = "high_planet_p_upgraded"
					remove_modifier = "high_planet_upgraded"
					add_modifier = {
						modifier = high_planet_p_upgraded
						days = -1
					}
				}
			}
		}
	}
	option = {
		name = "pmhm.4.c"
		custom_tooltip = pmhm.4.c.tooltip
		allow = {
			owner = {
				AND = {
					resource_stockpile_compare = { resource = energy value >= 30000 }
					resource_stockpile_compare = { resource = influence value >= 450 }
				}
			}
			custom_tooltip = {
				fail_text = high_planet_1_desc
				owner = {
					has_country_flag = high_planet_b
				}
			}
			custom_tooltip = {
				fail_text = high_planet_2_desc
				NOT = {
					owner = {
						has_country_flag = high_planet_c
					}
				}
			}
			custom_tooltip = {
				fail_text = high_planet_3_desc
				owner = { 
					has_technology = tech_s_district
					has_country_flag = district_project
				}
			}
		}
		owner = {
			add_resource = { energy = -30000 }
			add_resource = { influence = -450 }
		}
		hidden_effect = {
			owner = {
				set_country_flag = high_planet_c
				change_variable = { which = high_planet_modifier value = 1 }
				every_planet_within_border = {
					limit = {
						has_modifier = "connected_hm"
					}
					remove_modifier = "high_planet_bad"
					remove_modifier = "high_planet_normal"
					remove_modifier = "high_planet_p_upgraded"
					remove_modifier = "high_planet_upgraded"
					add_modifier = {
						modifier = high_planet_upgraded
						days = -1
					}
				}
			}
		}
	}
	option = {
		name = "pmhm.4.d"
		custom_tooltip = pmhm.4.d.tooltip
		hidden_effect = {
			owner = {
				every_planet_within_border = {
					limit = {
						exists = owner
						has_modifier = "connected_hm"
						owner = { 
							has_country_flag = high_planet_a
							NOT = { has_country_flag = high_planet_b }
							NOT = { has_country_flag = high_planet_c }
						}
					}
					remove_modifier = "high_planet_bad"
					remove_modifier = "high_planet_normal"
					remove_modifier = "high_planet_p_upgraded"
					remove_modifier = "high_planet_upgraded"
					add_modifier = {
						modifier = "high_planet_normal"
						days = -1
					}
				}
				every_planet_within_border = {
					limit = {
						exists = owner
						has_modifier = "connected_hm"
						owner = { 
							has_country_flag = high_planet_a
							has_country_flag = high_planet_b
							NOT = { has_country_flag = high_planet_c }
						}
					}
					remove_modifier = "high_planet_bad"
					remove_modifier = "high_planet_normal"
					remove_modifier = "high_planet_p_upgraded"
					remove_modifier = "high_planet_upgraded"
					add_modifier = {
						modifier = "high_planet_p_upgraded"
						days = -1
					}
				}
				every_planet_within_border = {
					limit = {
						exists = owner
						has_modifier = "connected_hm"
						owner = { 
							has_country_flag = high_planet_a
							has_country_flag = high_planet_b
							has_country_flag = high_planet_c
						}
					}
					remove_modifier = "high_planet_bad"
					remove_modifier = "high_planet_normal"
					remove_modifier = "high_planet_p_upgraded"
					remove_modifier = "high_planet_upgraded"
					add_modifier = {
						modifier = "high_planet_upgraded"
						days = -1
					}
				}
			}
		}
	}
	option = {
		name = "pmhm.1.back"
		hidden_effect = {
			planet_event = { id = pmhm.1 }
		}
	}
	option = { name = "pmhm.1.exit" default_hide_option = yes }
}

#mining
planet_event = {
	id = pmhm.100
	title = "pmhm.100.name"
	desc = {
		trigger = {
			text = "pmhm.100.desc"
		}
	}
	diplomatic = yes
	force_open = yes	
	picture_event_data = { room = high_planet_room }	
	is_triggered_only = yes
	location = root
	
	option = {
		name = "pmhm.100.a"
		
	}
	option = {
		name = "pmhm.1.back"
		hidden_effect = {
			planet_event = { id = pmhm.1 }
		}
	}
	option = { name = "pmhm.1.exit" default_hide_option = yes }
}

#energy
planet_event = {
	id = pmhm.110
	title = "pmhm.100.name"
	desc = {
		trigger = {
			text = "pmhm.110.desc"
		}
	}
	diplomatic = yes
	force_open = yes	
	picture_event_data = { room = high_planet_room }	
	is_triggered_only = yes
	location = root
	
	option = {
		name = "pmhm.110.a"
		
	}
	option = {
		name = "pmhm.1.back"
		hidden_effect = {
			planet_event = { id = pmhm.1 }
		}
	}
	option = { name = "pmhm.1.exit" default_hide_option = yes }
}

#farming
planet_event = {
	id = pmhm.120
	title = "pmhm.100.name"
	desc = {
		trigger = {
			text = "pmhm.120.desc"
		}
	}
	diplomatic = yes
	force_open = yes	
	picture_event_data = { room = high_planet_room }	
	is_triggered_only = yes
	location = root
	
	option = {
		name = "pmhm.120.a"
		
	}
	option = {
		name = "pmhm.1.back"
		hidden_effect = {
			planet_event = { id = pmhm.1 }
		}
	}
	option = { name = "pmhm.1.exit" default_hide_option = yes }
}

#trade
planet_event = {
	id = pmhm.130
	title = "pmhm.100.name"
	desc = {
		trigger = {
			text = "pmhm.130.desc"
			text = newline
			success_text = { 
				text = "pmhm.130.desc.zero" 
				AND = {
					check_variable = { which = mop_blackcoin_p value = 0 }
					check_variable = { which = mop_blackcoin value = 0 }
				}
			}
			success_text = { 
				text = "pmhm.130.desc.a" 
				AND = {
					check_variable = { which = mop_blackcoin_p value = 0 }
					check_variable = { which = mop_blackcoin value > 0 }
				}
			}
			success_text = { 
				text = "pmhm.130.desc.b" 
				check_variable = { which = mop_blackcoin_p value > 0 }
			}
			text = newline
			success_text = { 
				text = "pmhm.130.desc.c" 
				check_variable = { which = mop_entering_bm value = 0 }
			}
			success_text = { 
				text = "pmhm.130.desc.d" 
				check_variable = { which = mop_entering_bm value > 0 }
			}
		}
	}
	diplomatic = yes
	force_open = yes	
	picture_event_data = { room = high_planet_room }	
	is_triggered_only = yes
	location = root
	
	option = {
		name = "pmhm.130.a"
		allow = {
			custom_tooltip = {
				fail_text = no_blackcoin
				OR = {
					has_deposit = d_black_market
					has_deposit = d_black_market_p
				}
			}
			custom_tooltip = {
				fail_text = no_blackmarket
				NOT = { has_planet_flag = blackmarket_shutdown }
			}
		}
		hidden_effect = {
			change_variable = { which = mop_entering_bm value = 1 }
			planet_event = { id = pmhm.132 }
		}
	}
	option = {
		name = "pmhm.130.b"
		hidden_effect = {
			planet_event = { id = pmhm.131 }
		}
	}
	option = {
		name = "pmhm.1.back"
		hidden_effect = {
			planet_event = { id = pmhm.1 }
		}
	}
	option = { name = "pmhm.1.exit" default_hide_option = yes }
}

planet_event = {
	id = pmhm.131
	title = "pmhm.100.name"
	desc = {
		trigger = {
			text = "pmhm.131.desc"
			text = newline
			success_text = { 
				text = "pmhm.130.desc.zero" 
				AND = {
					check_variable = { which = mop_blackcoin_p value = 0 }
					check_variable = { which = mop_blackcoin value = 0 }
				}
			}
			success_text = { 
				text = "pmhm.130.desc.a" 
				AND = {
					check_variable = { which = mop_blackcoin_p value = 0 }
					check_variable = { which = mop_blackcoin value > 0 }
				}
			}
			success_text = { 
				text = "pmhm.130.desc.b" 
				check_variable = { which = mop_blackcoin_p value > 0 }
			}
		}
	}
	diplomatic = yes
	force_open = yes	
	picture_event_data = { room = black_market_room }	
	show_sound = event_criminal_activity
	is_triggered_only = yes
	location = root
	
	option = {
		name = "pmhm.131.a"
		allow = {
			owner = {
				AND = {
					resource_stockpile_compare = { resource = energy value >= 500 }
				}
			}
			custom_tooltip = {
				fail_text = permanent_blackcoin
				NOT = {
					has_deposit = d_black_market_p
				}
			}
		}
		owner = {
			add_resource = { energy = -500 }
		}
		hidden_effect = {
			change_variable = { which = mop_blackcoin value = 1 }
			add_deposit = d_black_market
			planet_event = { id = pmhm.131 }
		}
	}
	option = {
		name = "pmhm.131.b"
		allow = {
			owner = {
				AND = {
					resource_stockpile_compare = { resource = energy value >= 1800 }
				}
			}
			custom_tooltip = {
				fail_text = permanent_blackcoin
				NOT = {
					has_deposit = d_black_market_p
				}
			}
		}
		owner = {
			add_resource = { energy = -1800 }
		}
		hidden_effect = {
			change_variable = { which = mop_blackcoin value = 4 }
			add_deposit = d_black_market
			add_deposit = d_black_market
			add_deposit = d_black_market
			add_deposit = d_black_market
			planet_event = { id = pmhm.131 }
		}
	}
	option = {
		name = "pmhm.131.c"
		allow = {
			owner = {
				AND = {
					resource_stockpile_compare = { resource = energy value >= 3000 }
				}
			}
			custom_tooltip = {
				fail_text = permanent_blackcoin
				NOT = {
					has_deposit = d_black_market_p
				}
			}
		}
		owner = {
			add_resource = { energy = -3000 }
		}
		hidden_effect = {
			change_variable = { which = mop_blackcoin value = 8 }
			add_deposit = d_black_market
			add_deposit = d_black_market
			add_deposit = d_black_market
			add_deposit = d_black_market
			add_deposit = d_black_market
			add_deposit = d_black_market
			add_deposit = d_black_market
			add_deposit = d_black_market
			planet_event = { id = pmhm.131 }
		}
	}
	option = {
		name = "pmhm.131.d"
		allow = {
			owner = {
				AND = {
					resource_stockpile_compare = { resource = energy value >= 10000 }
					resource_stockpile_compare = { resource = influence value >= 100 }
				}
			}
			custom_tooltip = {
				fail_text = permanent_blackcoin
				NOT = {
					has_deposit = d_black_market_p
				}
			}
			custom_tooltip = {
				fail_text = need_vip
				check_variable = { which = mop_entering_bm value >= 10 }
			}
		}
		owner = {
			add_resource = { energy = -10000 }
			add_resource = { influence = -100 }
		}
		hidden_effect = {
			change_variable = { which = mop_blackcoin_p value = 1 }
			while = {
				limit = {
					has_deposit = d_black_market
				}
				remove_deposit = d_black_market
			}
			add_deposit = d_black_market_p
			planet_event = { id = pmhm.131 }
		}
	}
	option = {
		name = "pmhm.back"
		hidden_effect = {
			planet_event = { id = pmhm.130 }
		}
	}
	option = { name = "pmhm.1.exit" default_hide_option = yes }
}

planet_event = {
	id = pmhm.132
	title = "pmhm.100.name"
	desc = {
		trigger = {
			text = "pmhm.132.desc"
			text = newline
			success_text = { 
				text = "pmhm.130.desc.zero" 
				AND = {
					check_variable = { which = mop_blackcoin_p value = 0 }
					check_variable = { which = mop_blackcoin value = 0 }
				}
			}
			success_text = { 
				text = "pmhm.130.desc.a" 
				AND = {
					check_variable = { which = mop_blackcoin_p value = 0 }
					check_variable = { which = mop_blackcoin value > 0 }
				}
			}
			success_text = { 
				text = "pmhm.130.desc.b" 
				check_variable = { which = mop_blackcoin_p value > 0 }
			}
		}
	}
	diplomatic = yes
	force_open = yes	
	picture_event_data = { room = black_market_room }	
	show_sound = event_criminal_activity
	is_triggered_only = yes
	location = root
	
	immediate = {
		set_timed_planet_flag = { flag = blackmarket_shutdown days = 1800 }
	}

	option = {
		name = "pmhm.basic"
		hidden_effect = {
			planet_event = { id = pmhm.133 }
		}
	}
	option = {
		name = "pmhm.advanced"
		hidden_effect = {
			planet_event = { id = pmhm.134 }
		}
	}
	option = {
		name = "pmhm.back"
		custom_tooltip = pmhm.trade.back
		hidden_effect = {
			planet_event = { id = pmhm.130 }
		}
	}
	option = { 
		name = "pmhm.1.exit" 
		custom_tooltip = pmhm.trade.back
		default_hide_option = yes 
	}
}

planet_event = {
	id = pmhm.133
	title = "pmhm.100.name"
	desc = {
		trigger = {
			text = "pmhm.133.desc"
			text = newline
			success_text = { 
				text = "pmhm.130.desc.zero" 
				AND = {
					check_variable = { which = mop_blackcoin_p value = 0 }
					check_variable = { which = mop_blackcoin value = 0 }
				}
			}
			success_text = { 
				text = "pmhm.130.desc.a" 
				AND = {
					check_variable = { which = mop_blackcoin_p value = 0 }
					check_variable = { which = mop_blackcoin value > 0 }
				}
			}
			success_text = { 
				text = "pmhm.130.desc.b" 
				check_variable = { which = mop_blackcoin_p value > 0 }
			}
		}
	}
	diplomatic = yes
	force_open = yes	
	picture_event_data = { room = black_market_room }
	is_triggered_only = yes
	location = root
	
	option = {
		name = "pmhm.mineral.sell"
		allow = {
			owner = {
				resource_stockpile_compare = { resource = energy value >= 1000 }
			}
			custom_tooltip = {
				fail_text = no_blackcoin
				OR = {
					has_deposit = d_black_market
					has_deposit = d_black_market_p
				}
			}
		}
		owner = {
			add_resource = { energy = -1000 }
			add_resource = { minerals = 900 }
		}
		hidden_effect = {
			remove_deposit = d_black_market
			change_variable = { which = mop_blackcoin value = -1 }
			planet_event = { id = pmhm.133 }
		}
	}
	option = {
		name = "pmhm.mineral.buy"
		allow = {
			owner = {
				resource_stockpile_compare = { resource = minerals value >= 1000 }
			}
			custom_tooltip = {
				fail_text = no_blackcoin
				OR = {
					has_deposit = d_black_market
					has_deposit = d_black_market_p
				}
			}
		}
		owner = {
			add_resource = { minerals = -1000 }
			add_resource = { energy = 900 }
		}
		hidden_effect = {
			remove_deposit = d_black_market
			change_variable = { which = mop_blackcoin value = -1 }
			planet_event = { id = pmhm.133 }
		}
	}
	option = {
		name = "pmhm.food.sell"
		allow = {
			owner = {
				resource_stockpile_compare = { resource = energy value >= 1000 }
			}
			custom_tooltip = {
				fail_text = no_blackcoin
				OR = {
					has_deposit = d_black_market
					has_deposit = d_black_market_p
				}
			}
		}
		owner = {
			add_resource = { energy = -1000 }
			add_resource = { food = 900 }
		}
		hidden_effect = {
			remove_deposit = d_black_market
			change_variable = { which = mop_blackcoin value = -1 }
			planet_event = { id = pmhm.133 }
		}
	}
	option = {
		name = "pmhm.food.buy"
		allow = {
			owner = {
				resource_stockpile_compare = { resource = food value >= 1000 }
			}
			custom_tooltip = {
				fail_text = no_blackcoin
				OR = {
					has_deposit = d_black_market
					has_deposit = d_black_market_p
				}
			}
		}
		owner = {
			add_resource = { food = -1000 }
			add_resource = { energy = 900 }
		}
		hidden_effect = {
			remove_deposit = d_black_market
			change_variable = { which = mop_blackcoin value = -1 }
			planet_event = { id = pmhm.133 }
		}
	}
	option = {
		name = "pmhm.alloys.sell"
		allow = {
			owner = {
				resource_stockpile_compare = { resource = energy value >= 1000 }
			}
			custom_tooltip = {
				fail_text = no_blackcoin
				OR = {
					has_deposit = d_black_market
					has_deposit = d_black_market_p
				}
			}
		}
		owner = {
			add_resource = { energy = -1000 }
			add_resource = { alloys = 225 }
		}
		hidden_effect = {
			remove_deposit = d_black_market
			change_variable = { which = mop_blackcoin value = -1 }
			planet_event = { id = pmhm.133 }
		}
	}
	option = {
		name = "pmhm.alloys.buy"
		allow = {
			owner = {
				resource_stockpile_compare = { resource = alloys value >= 250 }
			}
			custom_tooltip = {
				fail_text = no_blackcoin
				OR = {
					has_deposit = d_black_market
					has_deposit = d_black_market_p
				}
			}
		}
		owner = {
			add_resource = { alloys = -250 }
			add_resource = { energy = 900 }
		}
		hidden_effect = {
			remove_deposit = d_black_market
			change_variable = { which = mop_blackcoin value = -1 }
			planet_event = { id = pmhm.133 }
		}
	}
	option = {
		name = "pmhm.consumergoods.sell"
		allow = {
			owner = {
				resource_stockpile_compare = { resource = energy value >= 1000 }
			}
			custom_tooltip = {
				fail_text = no_blackcoin
				OR = {
					has_deposit = d_black_market
					has_deposit = d_black_market_p
				}
			}
		}
		owner = {
			add_resource = { energy = -1000 }
			add_resource = { consumer_goods = 450 }
		}
		hidden_effect = {
			remove_deposit = d_black_market
			change_variable = { which = mop_blackcoin value = -1 }
			planet_event = { id = pmhm.133 }
		}
	}
	option = {
		name = "pmhm.consumergoods.buy"
		allow = {
			owner = {
				resource_stockpile_compare = { resource = consumer_goods value >= 500 }
			}
			custom_tooltip = {
				fail_text = no_blackcoin
				OR = {
					has_deposit = d_black_market
					has_deposit = d_black_market_p
				}
			}
		}
		owner = {
			add_resource = { consumer_goods = -500 }
			add_resource = { energy = 900 }
		}
		hidden_effect = {
			remove_deposit = d_black_market
			change_variable = { which = mop_blackcoin value = -1 }
			planet_event = { id = pmhm.133 }
		}
	}
	option = {
		name = "pmhm.trade.a.back"
		hidden_effect = {
			planet_event = { id = pmhm.132 }
		}
	}
	option = { 
		name = "pmhm.1.exit" 
		custom_tooltip = pmhm.trade.back
		default_hide_option = yes 
	}
}

planet_event = {
	id = pmhm.134
	title = "pmhm.100.name"
	desc = {
		trigger = {
			text = "pmhm.134.desc"
			text = newline
			success_text = { 
				text = "pmhm.130.desc.zero" 
				AND = {
					check_variable = { which = mop_blackcoin_p value = 0 }
					check_variable = { which = mop_blackcoin value = 0 }
				}
			}
			success_text = { 
				text = "pmhm.130.desc.a" 
				AND = {
					check_variable = { which = mop_blackcoin_p value = 0 }
					check_variable = { which = mop_blackcoin value > 0 }
				}
			}
			success_text = { 
				text = "pmhm.130.desc.b" 
				check_variable = { which = mop_blackcoin_p value > 0 }
			}
		}
	}
	diplomatic = yes
	force_open = yes	
	picture_event_data = { room = black_market_room }
	is_triggered_only = yes
	location = root
	
	option = {
		name = "pmhm.volatile_motes.sell"
		allow = {
			owner = {
				resource_stockpile_compare = { resource = energy value >= 1000 }
			}
			custom_tooltip = {
				fail_text = no_blackcoin
				OR = {
					has_deposit = d_black_market
					has_deposit = d_black_market_p
				}
			}
		}
		owner = {
			add_resource = { energy = -1000 }
			add_resource = { volatile_motes = 90 }
		}
		hidden_effect = {
			remove_deposit = d_black_market
			change_variable = { which = mop_blackcoin value = -1 }
			planet_event = { id = pmhm.134 }
		}
	}
	option = {
		name = "pmhm.volatile_motes.buy"
		allow = {
			owner = {
				resource_stockpile_compare = { resource = volatile_motes value >= 100 }
			}
			custom_tooltip = {
				fail_text = no_blackcoin
				OR = {
					has_deposit = d_black_market
					has_deposit = d_black_market_p
				}
			}
		}
		owner = {
			add_resource = { volatile_motes = -100 }
			add_resource = { energy = 900 }
		}
		hidden_effect = {
			remove_deposit = d_black_market
			change_variable = { which = mop_blackcoin value = -1 }
			planet_event = { id = pmhm.134 }
		}
	}
	option = {
		name = "pmhm.exotic_gases.sell"
		allow = {
			owner = {
				resource_stockpile_compare = { resource = energy value >= 1000 }
			}
			custom_tooltip = {
				fail_text = no_blackcoin
				OR = {
					has_deposit = d_black_market
					has_deposit = d_black_market_p
				}
			}
		}
		owner = {
			add_resource = { energy = -1000 }
			add_resource = { exotic_gases = 90 }
		}
		hidden_effect = {
			remove_deposit = d_black_market
			change_variable = { which = mop_blackcoin value = -1 }
			planet_event = { id = pmhm.134 }
		}
	}
	option = {
		name = "pmhm.exotic_gases.buy"
		allow = {
			owner = {
				resource_stockpile_compare = { resource = exotic_gases value >= 100 }
			}
			custom_tooltip = {
				fail_text = no_blackcoin
				OR = {
					has_deposit = d_black_market
					has_deposit = d_black_market_p
				}
			}
		}
		owner = {
			add_resource = { exotic_gases = -100 }
			add_resource = { energy = 900 }
		}
		hidden_effect = {
			remove_deposit = d_black_market
			change_variable = { which = mop_blackcoin value = -1 }
			planet_event = { id = pmhm.134 }
		}
	}
	option = {
		name = "pmhm.rare_crystals.sell"
		allow = {
			owner = {
				resource_stockpile_compare = { resource = energy value >= 1000 }
			}
			custom_tooltip = {
				fail_text = no_blackcoin
				OR = {
					has_deposit = d_black_market
					has_deposit = d_black_market_p
				}
			}
		}
		owner = {
			add_resource = { energy = -1000 }
			add_resource = { rare_crystals = 90 }
		}
		hidden_effect = {
			remove_deposit = d_black_market
			change_variable = { which = mop_blackcoin value = -1 }
			planet_event = { id = pmhm.134 }
		}
	}
	option = {
		name = "pmhm.rare_crystals.buy"
		allow = {
			owner = {
				resource_stockpile_compare = { resource = rare_crystals value >= 100 }
			}
			custom_tooltip = {
				fail_text = no_blackcoin
				OR = {
					has_deposit = d_black_market
					has_deposit = d_black_market_p
				}
			}
		}
		owner = {
			add_resource = { rare_crystals = -100 }
			add_resource = { energy = 900 }
		}
		hidden_effect = {
			remove_deposit = d_black_market
			change_variable = { which = mop_blackcoin value = -1 }
			planet_event = { id = pmhm.134 }
		}
	}
	option = {
		name = "pmhm.vip_advanced"
		allow = {
			custom_tooltip = {
				fail_text = need_1VIP
				has_deposit = d_black_market_p
			}
		}
		hidden_effect = {
			planet_event = { id = pmhm.135 }
		}
	}
	option = {
		name = "pmhm.trade.a.back"
		hidden_effect = {
			planet_event = { id = pmhm.132 }
		}
	}
	option = { 
		name = "pmhm.1.exit" 
		custom_tooltip = pmhm.trade.back
		default_hide_option = yes 
	}
}

planet_event = {
	id = pmhm.135
	title = "pmhm.100.name"
	desc = {
		trigger = {
			text = "pmhm.135.desc"
			text = newline
			success_text = { 
				text = "pmhm.130.desc.zero" 
				AND = {
					check_variable = { which = mop_blackcoin_p value = 0 }
					check_variable = { which = mop_blackcoin value = 0 }
				}
			}
			success_text = { 
				text = "pmhm.130.desc.a" 
				AND = {
					check_variable = { which = mop_blackcoin_p value = 0 }
					check_variable = { which = mop_blackcoin value > 0 }
				}
			}
			success_text = { 
				text = "pmhm.130.desc.b" 
				check_variable = { which = mop_blackcoin_p value > 0 }
			}
		}
	}
	diplomatic = yes
	force_open = yes	
	picture_event_data = { room = black_market_room }
	is_triggered_only = yes
	location = root
	
	option = {
		name = "pmhm.sr_zro.sell"
		allow = {
			owner = {
				resource_stockpile_compare = { resource = energy value >= 1000 }
			}
			custom_tooltip = {
				fail_text = no_blackcoin
				OR = {
					has_deposit = d_black_market
					has_deposit = d_black_market_p
				}
			}
		}
		owner = {
			add_resource = { energy = -1000 }
			add_resource = { sr_zro = 45 }
		}
		hidden_effect = {
			remove_deposit = d_black_market
			change_variable = { which = mop_blackcoin value = -1 }
			planet_event = { id = pmhm.135 }
		}
	}
	option = {
		name = "pmhm.sr_zro.buy"
		allow = {
			owner = {
				resource_stockpile_compare = { resource = sr_zro value >= 50 }
			}
			custom_tooltip = {
				fail_text = no_blackcoin
				OR = {
					has_deposit = d_black_market
					has_deposit = d_black_market_p
				}
			}
		}
		owner = {
			add_resource = { sr_zro = -50 }
			add_resource = { energy = 900 }
		}
		hidden_effect = {
			remove_deposit = d_black_market
			change_variable = { which = mop_blackcoin value = -1 }
			planet_event = { id = pmhm.135 }
		}
	}
	option = {
		name = "pmhm.sr_dark_matter.sell"
		allow = {
			owner = {
				resource_stockpile_compare = { resource = energy value >= 1000 }
			}
			custom_tooltip = {
				fail_text = no_blackcoin
				OR = {
					has_deposit = d_black_market
					has_deposit = d_black_market_p
				}
			}
		}
		owner = {
			add_resource = { energy = -1000 }
			add_resource = { sr_dark_matter = 45 }
		}
		hidden_effect = {
			remove_deposit = d_black_market
			change_variable = { which = mop_blackcoin value = -1 }
			planet_event = { id = pmhm.135 }
		}
	}
	option = {
		name = "pmhm.sr_dark_matter.buy"
		allow = {
			owner = {
				resource_stockpile_compare = { resource = sr_dark_matter value >= 50 }
			}
			custom_tooltip = {
				fail_text = no_blackcoin
				OR = {
					has_deposit = d_black_market
					has_deposit = d_black_market_p
				}
			}
		}
		owner = {
			add_resource = { sr_dark_matter = -50 }
			add_resource = { energy = 900 }
		}
		hidden_effect = {
			remove_deposit = d_black_market
			change_variable = { which = mop_blackcoin value = -1 }
			planet_event = { id = pmhm.135 }
		}
	}
	option = {
		name = "pmhm.sr_living_metal.sell"
		allow = {
			owner = {
				resource_stockpile_compare = { resource = energy value >= 1000 }
			}
			custom_tooltip = {
				fail_text = no_blackcoin
				OR = {
					has_deposit = d_black_market
					has_deposit = d_black_market_p
				}
			}
		}
		owner = {
			add_resource = { energy = -1000 }
			add_resource = { sr_living_metal = 45 }
		}
		hidden_effect = {
			remove_deposit = d_black_market
			change_variable = { which = mop_blackcoin value = -1 }
			planet_event = { id = pmhm.135 }
		}
	}
	option = {
		name = "pmhm.sr_living_metal.buy"
		allow = {
			owner = {
				resource_stockpile_compare = { resource = sr_living_metal value >= 50 }
			}
			custom_tooltip = {
				fail_text = no_blackcoin
				OR = {
					has_deposit = d_black_market
					has_deposit = d_black_market_p
				}
			}
		}
		owner = {
			add_resource = { sr_living_metal = -50 }
			add_resource = { energy = 900 }
		}
		hidden_effect = {
			remove_deposit = d_black_market
			change_variable = { which = mop_blackcoin value = -1 }
			planet_event = { id = pmhm.135 }
		}
	}
	option = {
		name = "pmhm.nanites.sell"
		allow = {
			owner = {
				resource_stockpile_compare = { resource = energy value >= 1000 }
			}
			custom_tooltip = {
				fail_text = no_blackcoin
				OR = {
					has_deposit = d_black_market
					has_deposit = d_black_market_p
				}
			}
		}
		owner = {
			add_resource = { energy = -1000 }
			add_resource = { nanites = 45 }
		}
		hidden_effect = {
			remove_deposit = d_black_market
			change_variable = { which = mop_blackcoin value = -1 }
			planet_event = { id = pmhm.135 }
		}
	}
	option = {
		name = "pmhm.nanites.buy"
		allow = {
			owner = {
				resource_stockpile_compare = { resource = nanites value >= 50 }
			}
			custom_tooltip = {
				fail_text = no_blackcoin
				OR = {
					has_deposit = d_black_market
					has_deposit = d_black_market_p
				}
			}
		}
		owner = {
			add_resource = { nanites = -50 }
			add_resource = { energy = 900 }
		}
		hidden_effect = {
			remove_deposit = d_black_market
			change_variable = { which = mop_blackcoin value = -1 }
			planet_event = { id = pmhm.135 }
		}
	}
	option = {
		name = "pmhm.trade.a.back"
		hidden_effect = {
			planet_event = { id = pmhm.132 }
		}
	}
	option = { 
		name = "pmhm.1.exit" 
		custom_tooltip = pmhm.trade.back
		default_hide_option = yes 
	}
}

#training
planet_event = {
	id = pmhm.140
	title = "pmhm.100.name"
	desc = {
		trigger = {
			text = "pmhm.140.desc"
		}
	}
	diplomatic = yes
	force_open = yes	
	picture_event_data = { room = high_planet_room }	
	is_triggered_only = yes
	location = root
	
	option = {
		name = "pmhm.140.a"
		hidden_effect = {
			planet_event = { id = pmhm.141 }
		}
	}
	option = {
		name = "pmhm.140.b"
		hidden_effect = {
			planet_event = { id = pmhm.144 }
		}
	}
	option = {
		name = "pmhm.1.back"
		hidden_effect = {
			planet_event = { id = pmhm.1 }
		}
	}
	option = { name = "pmhm.1.exit" default_hide_option = yes }
}

planet_event = {
	id = pmhm.141
	title = "pmhm.100.name"
	desc = {
		trigger = {
			text = "pmhm.141.desc"
		}
	}
	diplomatic = yes
	force_open = yes	
	picture_event_data = { room = training_army }	
	is_triggered_only = yes
	location = root
	
	option = {
		name = "pmhm.141.a"
		allow = {
			num_pops > 1
			owner = {
				resource_stockpile_compare = { resource = influence value >= 20 }
			}
		}
		owner = { add_resource = { influence = -20 } }
		hidden_effect = {
			owner = {
				set_country_flag = training_fleet_hired_onepop

				create_leader = {
					class = admiral
					species = root
					name = random
					event_leader = yes
					skill = 3
					leader_age_min = 25
					leader_age_max = 45
					traits = {
						trait = leader_trait_mercenary_warrior
						trait = random_trait
					}
				}
				last_created_leader = {
					set_leader_flag = training_marauder_merc_leader
				}
				create_fleet = {
					name = "NAME_Training_onepops"
					effect = {
						set_owner = root
						save_event_target_as = hired_training_merc_fleet
						create_one_pop_mercenary = yes
						set_location = FROMFROM
						assign_leader = last_created_leader
						set_fleet_flag = training_onepop
						fleet_event = { id = pmhm.142 days = 3600 }
					}
					settings = { 
						can_upgrade = no 
						can_disband = no
						can_change_composition = no 
						can_change_leader = no 
						uses_naval_capacity = no
					}
				}
				country_event = { id = pmhm.143 }
			}
		}
	}
	option = {
		name = "pmhm.141.b"
		allow = {
			num_pops > 5
			owner = {
				resource_stockpile_compare = { resource = influence value >= 50 }
			}
		}
		owner = { add_resource = { influence = -50 } }
		hidden_effect = {
			owner = {
				set_country_flag = training_fleet_hired_fivepop

				create_leader = {
					class = admiral
					species = root
					name = random
					event_leader = yes
					skill = 6
					leader_age_min = 25
					leader_age_max = 45
					traits = {
						trait = leader_trait_mercenary_warrior
						trait = random_trait
					}
				}
				last_created_leader = {
					set_leader_flag = training_marauder_merc_leader
				}
				create_fleet = {
					name = "NAME_Training_fivepops"
					effect = {
						set_owner = root
						save_event_target_as = hired_training_merc_fleet
						create_five_pop_mercenary = yes
						set_location = FROMFROM
						assign_leader = last_created_leader
						set_fleet_flag = training_fivepop
						fleet_event = { id = pmhm.142 days = 3600 }
					}
					settings = { 
						can_upgrade = no 
						can_disband = no
						can_change_composition = no 
						can_change_leader = no 
						uses_naval_capacity = no
					}
				}
				country_event = { id = pmhm.143 }
			}
		}
	}
	option = {
		name = "pmhm.141.c"
		hidden_effect = {
			planet_event = { id = pmhm.142 }
		}
		allow = {
			num_pops > 25
			owner = {
				resource_stockpile_compare = { resource = influence value >= 100 }
			}
		}
		owner = { add_resource = { influence = -100 } }
		hidden_effect = {
			owner = {
				set_country_flag = training_fleet_hired_twentyfivepop

				create_leader = {
					class = admiral
					species = root
					name = random
					event_leader = yes
					skill = 10
					leader_age_min = 25
					leader_age_max = 45
					traits = {
						trait = leader_trait_great_khan
						trait = random_trait
					}
				}
				last_created_leader = {
					set_leader_flag = training_marauder_merc_leader
				}
				create_fleet = {
					name = "NAME_Training_twentyfivepops"
					effect = {
						set_owner = root
						save_event_target_as = hired_training_merc_fleet
						create_twentyfive_pop_mercenary = yes
						set_location = FROMFROM
						assign_leader = last_created_leader
						set_fleet_flag = training_twentyfivepop
						fleet_event = { id = pmhm.142 days = 3600 }
					}
					settings = { 
						can_upgrade = no 
						can_disband = no
						can_change_composition = no 
						can_change_leader = no 
						uses_naval_capacity = no
					}
				}
				country_event = { id = pmhm.143 }
			}
		}
	}
	option = {
		name = "pmhm.141.d"
		hidden_effect = {
			planet_event = { id = pmhm.142 }
		}
	}
	option = {
		name = "pmhm.back"
		hidden_effect = {
			planet_event = { id = pmhm.150 }
		}
	}
	option = { name = "pmhm.1.exit" default_hide_option = yes }
}

fleet_event = {
	id = pmhm.142
	title = "pmhm.142.name"
	desc = "pmhm.142.desc"
	picture = GFX_evt_pirate_armada
	show_sound = event_radio_chatter
	location = this

	is_triggered_only = yes

	option = { # Extend contract 1
		name = pmhm.142.a
		allow = { owner = { resource_stockpile_compare = { resource = influence value >= 20 } } }
		trigger = {
			OR = {
				has_fleet_flag = training_onepop
			}
		}
		owner = { add_resource = { influence = -20 } }
		hidden_effect = {
			fleet_event = { id = pmhm.142 days = 1800 }
		}
	}
	option = { # Extend contract 2
		name = pmhm.142.a
		allow = { owner = { resource_stockpile_compare = { resource = influence value >= 50 } } }
		trigger = {
			OR = {
				has_fleet_flag = training_fivepop
			}
		}
		owner = { add_resource = { influence = -50 } }
		hidden_effect = {
			fleet_event = { id = pmhm.142 days = 1800 }
		}
	}
	option = { # Extend contract 3
		name = pmhm.142.a
		allow = { owner = { resource_stockpile_compare = { resource = influence value >= 100 } } }
		trigger = {
			OR = {
				has_fleet_flag = training_twentyfivepop
			}
		}
		owner = { add_resource = { influence = -100 } }
		hidden_effect = {
			fleet_event = { id = pmhm.142 days = 1800 }
		}
	}
	option = { # Decline
		name = pmhm.142.b
		ai_chance = {
			factor = 100
		}
		hidden_effect = {
			# Marauder 1 fleets
			if = {
				limit = { has_fleet_flag = training_onepop }
				owner = {
					remove_country_flag = training_fleet_hired_onepop
				}
			}
			if = {
				limit = { has_fleet_flag = training_fivepop }
				owner = {
					remove_country_flag = training_fleet_hired_fivepop
				}
			}
			if = {
				limit = { has_fleet_flag = training_twentyfivepop }
				owner = {
					remove_country_flag = training_fleet_hired_twentyfivepop
				}
			}
			leader = { 
				remove_leader_flag = training_marauder_merc_leader
				kill_leader = { show_notification = no } 
			}
			delete_fleet = this
		}
	}
}

country_event = {
	id = pmhm.143
	title = "pmhm.142.name"
	
	desc = { 
		text = pmhm.142.desc
	}
	
	diplomatic = yes
	
	picture_event_data = { room = training_army }	
	
	is_triggered_only = yes
	
	option = {
		name = pmhm.143.b
		default_hide_option = yes
	}
}

#eco
planet_event = {
	id = pmhm.150
	title = "pmhm.100.name"
	desc = {
		trigger = {
			text = "pmhm.150.desc"
			text = newline
			success_text = { 
				text = "pmhm.150.desc.a.zero" 
				AND = {
					check_variable = { which = mop_makingnewspecies value = 0 }
				}
			}
			success_text = { 
				text = "pmhm.150.desc.a" 
				AND = {
					check_variable = { which = mop_makingnewspecies value > 0 }
				}
			}
			text = newline
			success_text = { 
				text = "pmhm.150.desc.b.zero" 
				AND = {
					check_variable = { which = mop_ecoinfluence value = 0 }
					check_variable = { which = mop_ecotradevalue value = 0 }
				}
			}
			success_text = { 
				text = "pmhm.150.desc.b" 
				OR = {
					check_variable = { which = mop_ecoinfluence value > 0 }
					check_variable = { which = mop_ecotradevalue value > 0 }
				}
			}
		}
	}
	diplomatic = yes
	force_open = yes	
	picture_event_data = { room = high_planet_room }	
	is_triggered_only = yes
	location = root
	
	option = {
		name = "pmhm.150.a"
		hidden_effect = {
			planet_event = { id = pmhm.151 }
		}
	}
	option = {
		name = "pmhm.150.b"
		hidden_effect = {
			planet_event = { id = pmhm.159 }
		}
	}
	option = {
		name = "pmhm.1.back"
		hidden_effect = {
			planet_event = { id = pmhm.1 }
		}
	}
	option = { name = "pmhm.1.exit" default_hide_option = yes }
}

planet_event = {
	id = pmhm.151
	title = "pmhm.100.name"
	desc = {
		trigger = {
			text = "pmhm.151.desc"
			text = newline
			success_text = { 
				text = "pmhm.150.desc.a.zero" 
				AND = {
					check_variable = { which = mop_makingnewspecies value = 0 }
				}
			}
			success_text = { 
				text = "pmhm.150.desc.a" 
				AND = {
					check_variable = { which = mop_makingnewspecies value > 0 }
				}
			}
		}
	}
	diplomatic = yes
	force_open = yes	
	picture_event_data = { room = eco_researcher_room }	
	is_triggered_only = yes
	location = root

	immediate = {
		every_owned_pop = {
			limit = {
				species = { has_species_flag = mop_recently_created_@root }
			}
			species = { save_event_target_as = mop_newspecies }
		}
	}
	
	option = {
		name = "pmhm.151.a"
		hidden_effect = {
			planet_event = { id = pmhm.152 }
		}
	}
	option = {
		name = "pmhm.151.b"
		allow = {
			custom_tooltip = {
				fail_text = no_mop_speices
				check_variable = { which = mop_makingnewspecies value > 0 }
			}
		}
		hidden_effect = {
			planet_event = { id = pmhm.153 }
		}
	}
	option = {
		name = "pmhm.back"
		hidden_effect = {
			planet_event = { id = pmhm.150 }
		}
	}
	option = { name = "pmhm.1.exit" default_hide_option = yes }
}

planet_event = {
	id = pmhm.152
	title = "pmhm.100.name"
	desc = {
		trigger = {
			text = "pmhm.152.desc"
			text = newline
			success_text = { 
				text = "pmhm.150.desc.a.zero" 
				AND = {
					check_variable = { which = mop_makingnewspecies value = 0 }
				}
			}
			success_text = { 
				text = "pmhm.150.desc.a" 
				AND = {
					check_variable = { which = mop_makingnewspecies value > 0 }
				}
			}
		}
	}
	diplomatic = yes
	force_open = yes	
	picture_event_data = { room = eco_researcher_room }	
	is_triggered_only = yes
	location = root
	
	option = {
		name = "pmhm.152.ran"
		allow = {
			custom_tooltip = {
				fail_text = no_makingnewspecies
				NOT = { has_planet_flag = mop_makingnewspecies_waiting }
			}
			owner = {
				resource_stockpile_compare = { resource = exotic_gases value >= 250 }
				resource_stockpile_compare = { resource = influence value >= 80 }
			}
		}
		owner = {
			add_resource = { exotic_gases = -250 }
			add_resource = { influence = -80 }
		}
		hidden_effect = {
			set_timed_planet_flag = { flag = mop_makingnewspecies_waiting days = 3600 }
			change_variable = { which = mop_makingnewspecies value = 1 }
			mop_create_ran = yes
			mop_creating = yes
			planet_event = { id = pmhm.152 }
		}
	}
	option = {
		name = "pmhm.152.h"
		allow = {
			custom_tooltip = {
				fail_text = no_makingnewspecies
				NOT = { has_planet_flag = mop_makingnewspecies_waiting }
			}
			owner = {
				resource_stockpile_compare = { resource = exotic_gases value >= 250 }
				resource_stockpile_compare = { resource = influence value >= 80 }
			}
			local_has_dlc = "Humanoids Species Pack"
		}
		owner = {
			add_resource = { exotic_gases = -250 }
			add_resource = { influence = -80 }
		}
		hidden_effect = {
			set_timed_planet_flag = { flag = mop_makingnewspecies_waiting days = 3600 }
			change_variable = { which = mop_makingnewspecies value = 1 }
			mop_create_h = yes
			mop_creating = yes
			planet_event = { id = pmhm.152 }
		}
	}
	option = {
		name = "pmhm.152.ma"
		allow = {
			custom_tooltip = {
				fail_text = no_makingnewspecies
				NOT = { has_planet_flag = mop_makingnewspecies_waiting }
			}
			owner = {
				resource_stockpile_compare = { resource = exotic_gases value >= 250 }
				resource_stockpile_compare = { resource = influence value >= 80 }
			}
		}
		owner = {
			add_resource = { exotic_gases = -250 }
			add_resource = { influence = -80 }
		}
		hidden_effect = {
			set_timed_planet_flag = { flag = mop_makingnewspecies_waiting days = 3600 }
			change_variable = { which = mop_makingnewspecies value = 1 }
			mop_create_ma = yes
			mop_creating = yes
			planet_event = { id = pmhm.152 }
		}
	}
	option = {
		name = "pmhm.152.r"
		allow = {
			custom_tooltip = {
				fail_text = no_makingnewspecies
				NOT = { has_planet_flag = mop_makingnewspecies_waiting }
			}
			owner = {
				resource_stockpile_compare = { resource = exotic_gases value >= 250 }
				resource_stockpile_compare = { resource = influence value >= 80 }
			}
		}
		owner = {
			add_resource = { exotic_gases = -250 }
			add_resource = { influence = -80 }
		}
		hidden_effect = {
			set_timed_planet_flag = { flag = mop_makingnewspecies_waiting days = 3600 }
			change_variable = { which = mop_makingnewspecies value = 1 }
			mop_create_r = yes
			mop_creating = yes
			planet_event = { id = pmhm.152 }
		}
	}
	option = {
		name = "pmhm.152.av"
		allow = {
			custom_tooltip = {
				fail_text = no_makingnewspecies
				NOT = { has_planet_flag = mop_makingnewspecies_waiting }
			}
			owner = {
				resource_stockpile_compare = { resource = exotic_gases value >= 250 }
				resource_stockpile_compare = { resource = influence value >= 80 }
			}
		}
		owner = {
			add_resource = { exotic_gases = -250 }
			add_resource = { influence = -80 }
		}
		hidden_effect = {
			set_timed_planet_flag = { flag = mop_makingnewspecies_waiting days = 3600 }
			change_variable = { which = mop_makingnewspecies value = 1 }
			mop_create_av = yes
			mop_creating = yes
			planet_event = { id = pmhm.152 }
		}
	}
	option = {
		name = "pmhm.152.ar"
		allow = {
			custom_tooltip = {
				fail_text = no_makingnewspecies
				NOT = { has_planet_flag = mop_makingnewspecies_waiting }
			}
			owner = {
				resource_stockpile_compare = { resource = exotic_gases value >= 250 }
				resource_stockpile_compare = { resource = influence value >= 80 }
			}
		}
		owner = {
			add_resource = { exotic_gases = -250 }
			add_resource = { influence = -80 }
		}
		hidden_effect = {
			set_timed_planet_flag = { flag = mop_makingnewspecies_waiting days = 3600 }
			change_variable = { which = mop_makingnewspecies value = 1 }
			mop_create_ar = yes
			mop_creating = yes
			planet_event = { id = pmhm.152 }
		}
	}
	option = {
		name = "pmhm.152.mo"
		allow = {
			custom_tooltip = {
				fail_text = no_makingnewspecies
				NOT = { has_planet_flag = mop_makingnewspecies_waiting }
			}
			owner = {
				resource_stockpile_compare = { resource = exotic_gases value >= 250 }
				resource_stockpile_compare = { resource = influence value >= 80 }
			}
		}
		owner = {
			add_resource = { exotic_gases = -250 }
			add_resource = { influence = -80 }
		}
		hidden_effect = {
			set_timed_planet_flag = { flag = mop_makingnewspecies_waiting days = 3600 }
			change_variable = { which = mop_makingnewspecies value = 1 }
			mop_create_mo = yes
			mop_creating = yes
			planet_event = { id = pmhm.152 }
		}
	}
	option = {
		name = "pmhm.152.f"
		allow = {
			custom_tooltip = {
				fail_text = no_makingnewspecies
				NOT = { has_planet_flag = mop_makingnewspecies_waiting }
			}
			owner = {
				resource_stockpile_compare = { resource = exotic_gases value >= 250 }
				resource_stockpile_compare = { resource = influence value >= 80 }
			}
		}
		owner = {
			add_resource = { exotic_gases = -250 }
			add_resource = { influence = -80 }
		}
		hidden_effect = {
			set_timed_planet_flag = { flag = mop_makingnewspecies_waiting days = 3600 }
			change_variable = { which = mop_makingnewspecies value = 1 }
			mop_create_f = yes
			mop_creating = yes
			planet_event = { id = pmhm.152 }
		}
	}
	option = {
		name = "pmhm.152.p"
		allow = {
			custom_tooltip = {
				fail_text = no_makingnewspecies
				NOT = { has_planet_flag = mop_makingnewspecies_waiting }
			}
			owner = {
				resource_stockpile_compare = { resource = exotic_gases value >= 250 }
				resource_stockpile_compare = { resource = influence value >= 80 }
			}
			local_has_dlc = "Plantoid"
		}
		owner = {
			add_resource = { exotic_gases = -250 }
			add_resource = { influence = -80 }
		}
		hidden_effect = {
			set_timed_planet_flag = { flag = mop_makingnewspecies_waiting days = 3600 }
			change_variable = { which = mop_makingnewspecies value = 1 }
			mop_create_p = yes
			mop_creating = yes
			planet_event = { id = pmhm.152 }
		}
	}
	option = {
		name = "pmhm.eco.back"
		hidden_effect = {
			planet_event = { id = pmhm.151 }
		}
	}
	option = { name = "pmhm.1.exit" default_hide_option = yes }
}

planet_event = {
	id = pmhm.153
	title = "pmhm.100.name"
	desc = {
		trigger = {
			text = "pmhm.153.desc"
			text = newline
			success_text = { 
				text = "pmhm.150.desc.a.zero" 
				AND = {
					check_variable = { which = mop_makingnewspecies value = 0 }
				}
			}
			success_text = { 
				text = "pmhm.150.desc.a" 
				AND = {
					check_variable = { which = mop_makingnewspecies value > 0 }
				}
			}
		}
	}
	diplomatic = yes
	force_open = yes	
	picture_event_data = { room = eco_researcher_room }	
	is_triggered_only = yes
	location = root

	immediate = {
		every_owned_pop = {
			limit = {
				species = { has_species_flag = mop_recently_created_@root }
			}
			species = { save_event_target_as = mop_newspecies }
		}
	}
	
	option = {
		name = "pmhm.153.a"
		allow = {
			custom_tooltip = {
				fail_text = mop_chaingingnewspecies_five
				check_variable = { which = mop_chaingingnewspecies value < 5 }
			}
			owner = {
				resource_stockpile_compare = { resource = exotic_gases value >= 500 }
				resource_stockpile_compare = { resource = influence value >= 40 }
			}
		}
		owner = {
			add_resource = { exotic_gases = -500 }
			add_resource = { influence = -40 }
		}
		hidden_effect = {
			every_owned_pop = {
				limit = { 
					is_same_species = event_target:mop_newspecies
				}
				mop_reset_traits = yes
			}
			planet_event = { id = pmhm.153 }
			change_variable = { which = mop_chaingingnewspecies value = 1 }
		}
	}
	option = {
		name = "pmhm.eco.back"
		hidden_effect = {
			planet_event = { id = pmhm.151 }
		}
	}
	option = { name = "pmhm.1.exit" default_hide_option = yes }
}

planet_event = {
	id = pmhm.159
	title = "pmhm.100.name"
	desc = {
		trigger = {
			text = "pmhm.159.desc"
			text = newline
			success_text = { 
				text = "pmhm.150.desc.b.zero" 
				AND = {
					check_variable = { which = mop_ecoinfluence value = 0 }
					check_variable = { which = mop_ecotradevalue value = 0 }
				}
			}
			success_text = { 
				text = "pmhm.150.desc.b" 
				OR = {
					check_variable = { which = mop_ecoinfluence value > 0 }
					check_variable = { which = mop_ecotradevalue value > 0 }
				}
			}
		}
	}
	diplomatic = yes
	force_open = yes	
	picture_event_data = { room = high_planet_room }	
	is_triggered_only = yes
	location = root
	
	option = {
		name = "pmhm.159.a"
		custom_tooltip = pmhm.159.aa
		allow = {
			owner = {
				resource_stockpile_compare = { resource = consumer_goods value >= 5000 }
				resource_stockpile_compare = { resource = exotic_gases value >= 250 }
				resource_stockpile_compare = { resource = influence value >= 50 }
			}
		}
		owner = {
			add_resource = { consumer_goods = -5000 }
			add_resource = { exotic_gases = -250 }
			add_resource = { influence = -50 }
		}
		hidden_effect = {
			change_variable = { which = mop_ecoinfluence value = 0.1 }
			change_variable = { which = mop_ecotradevalue value = 20 }
			planet_event = { id = pmhm.159 }
			add_deposit = d_eco_cleaning
		}
	}
	option = {
		name = "pmhm.159.b"
		custom_tooltip = pmhm.159.bb
		allow = {
			owner = {
				resource_stockpile_compare = { resource = minerals value >= 10000 }
				resource_stockpile_compare = { resource = rare_crystals value >= 250 }
				resource_stockpile_compare = { resource = influence value >= 50 }
			}
		}
		owner = {
			add_resource = { minerals = -10000 }
			add_resource = { rare_crystals = -250 }
			add_resource = { influence = -50 }
		}
		hidden_effect = {
			change_variable = { which = mop_ecoinfluence value = 0.2 }
			change_variable = { which = mop_ecotradevalue value = 10 }
			planet_event = { id = pmhm.159 }
			add_deposit = d_eco_changing
		}
	}
	option = {
		name = "pmhm.159.c"
		custom_tooltip = pmhm.159.cc
		allow = {
			owner = {
				resource_stockpile_compare = { resource = alloys value >= 3000 }
				resource_stockpile_compare = { resource = volatile_motes value >= 250 }
				resource_stockpile_compare = { resource = influence value >= 50 }
			}
		}
		owner = {
			add_resource = { alloys = -3000 }
			add_resource = { volatile_motes = -250 }
			add_resource = { influence = -50 }
		}
		hidden_effect = {
			change_variable = { which = mop_ecoinfluence value = 0.5 }
			change_variable = { which = mop_ecotradevalue value = 5 }
			planet_event = { id = pmhm.159 }
			add_deposit = d_eco_building
		}
	}
	option = {
		name = "pmhm.back"
		hidden_effect = {
			planet_event = { id = pmhm.150 }
		}
	}
	option = { name = "pmhm.1.exit" default_hide_option = yes }
}

#city
planet_event = {
	id = pmhm.160
	title = "pmhm.100.name"
	desc = {
		trigger = {
			text = "pmhm.160.desc"
		}
	}
	diplomatic = yes
	force_open = yes	
	picture_event_data = { room = high_planet_room }	
	is_triggered_only = yes
	location = root
	
	option = {
		name = "pmhm.160.a"
		
	}
	option = {
		name = "pmhm.1.back"
		hidden_effect = {
			planet_event = { id = pmhm.1 }
		}
	}
	option = { name = "pmhm.1.exit" default_hide_option = yes }
}