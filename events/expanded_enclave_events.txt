############################
#
# Expanded Leviathan Events
#
############################

namespace = leviathanexpanded

##################################
# Curator - Events and Anomalies
# Reserved 1 - 99
##################################

# Buy Clue from Curator
country_event = {
	id = leviathanexpanded.1
	title = leviathans.508.name
	desc = leviathanexpanded.1.desc
	
	is_triggered_only = yes
	diplomatic = yes
	custom_gui = "enclave_curator_window"

	picture_event_data = {
		portrait = event_target:curators
		room = enclave_curator_room
	}

	option = {
		name = leviathanexpanded.1.a
		custom_gui = "enclave_curator_option"
		allow = {
			resource_stockpile_compare = { resource = energy value >= 1000 }
			hidden_trigger = {
				NOR = {
					has_completed_event_chain_counter = {
						event_chain = "ancient_observer_chain" 
						counter = "observer_clues_found" 
					}
					has_country_flag = bought_observer_curator_clue
				}
			}
		}
		add_resource = { energy = -1000 }
		custom_tooltip = opinion10
		add_observer_clue = yes
		hidden_effect = {
			event_target:curators = {
				add_trust = {
					who = root
					amount = 10
				}
			}
			set_country_flag = bought_observer_curator_clue
		}
	}
	option = {
		name = leviathanexpanded.1.b
		response_text = leviathanexpanded.1.b.response
		is_dialog_only = yes
	}
	# Back to main menu
	option = {
		name = leviathans.506.d
		hidden_effect = {
			country_event = { id = leviathans.500 }
		}
	}
	# Goodbye
	option = {
		name = GOODBYE
		default_hide_option = yes
	}
}

# Hatchling
# Curator Guardians Menu
country_event = {
	id = leviathanexpanded.2
	title = leviathanexpanded.2.name
	desc = leviathanexpanded.2.desc

	is_triggered_only = yes
	diplomatic = yes
	custom_gui = "enclave_curator_window"

	picture_event_data = {
		portrait = event_target:curators
		room = enclave_curator_room
	}

	option = {
		name = leviathanexpanded.2.a
		response_text = leviathanexpanded.2.a.reply
		is_dialog_only = yes
		custom_gui = "enclave_curator_option"
	}
	option = {
		name = leviathanexpanded.2.b
		response_text = leviathanexpanded.2.b.reply
		trigger = {
			NOT = { has_modifier = curator_buff_hatchling_two }
		}
		custom_gui = "enclave_curator_option"
		allow = {
			resource_stockpile_compare = { resource = energy value >= 1000 }
		}
		add_resource = { energy = -1000 }
		add_modifier = {
			modifier = curator_buff_hatchling_two
			days = -1
		}
		custom_tooltip = opinion20
		hidden_effect = {
			event_target:curators = {
				add_trust = {
					who = root
					amount = 20
				}
			}
		}
	}
	option = { # Can we fight it? (No)
		name = leviathans.506.f
		trigger = { fleet_power < 5000	}
		custom_gui = "enclave_curator_option"
		response_text = leviathans.5106.f1.reply
	}
	option = { # Can we fight it? (Probably not)
		name = leviathans.506.f
		trigger = {
			fleet_power > 5000
			fleet_power < 15000
		}
		custom_gui = "enclave_curator_option"
		response_text = leviathans.5106.f2.reply
	}
	option = { # Can we fight it? (Maybe)
		name = leviathans.506.f
		trigger = {
			fleet_power > 15000
			fleet_power < 30000
		}
		custom_gui = "enclave_curator_option"
		response_text = leviathans.5106.f3.reply
	}
	option = { # Can we fight it? (Yes)
		name = leviathans.506.f
		trigger = { fleet_power > 30000 }
		custom_gui = "enclave_curator_option"
		response_text = leviathans.5106.f4.reply
	}
	# Back to main menu
	option = {
		name = leviathans.506.d
		hidden_effect = {
			country_event = { id = leviathans.500 }
		}
	}
	# Goodbye
	option = {
		name = GOODBYE
		default_hide_option = yes
	}
}

##################################
# Curator - Services
# Reserved 100 - 199
##################################

# Buying Precursor Insights
country_event = {
	id = leviathanexpanded.101
	title = leviathanexpanded.101.name
	desc = {
		trigger = { has_event_chain = "cybrex_chain" }
		text = leviathanexpanded.101.desc.a
	}
	desc = {
		trigger = { has_event_chain = "first_league_chain" }
		text = leviathanexpanded.101.desc.b
	}
	desc = {
		trigger = { has_event_chain = "irassian_chain" }
		text = leviathanexpanded.101.desc.c
	}
	desc = {
		trigger = { has_event_chain = "yuht_chain" }
		text = leviathanexpanded.101.desc.d
	}
	desc = {
		trigger = { has_event_chain = "vultaum_chain" }
		text = leviathanexpanded.101.desc.e
	}
	
	is_triggered_only = yes
	diplomatic = yes
	custom_gui = "enclave_curator_window"

	picture_event_data = {
		portrait = event_target:curator_enclave_country
		room = enclave_curator_room
	}

	option = {
		name = leviathans.600.a
		custom_gui = "enclave_curator_option"
		allow = {
			resource_stockpile_compare = { resource = energy value >= 5000 }
			hidden_trigger = { have_active_precursor_chain = yes }
		}
		add_resource = { energy = -5000 }
		custom_tooltip = leviathanexpanded.101.a.tooltip
		custom_tooltip = opinion20
		hidden_effect = {
			country_event = { id = leviathanexpanded.102 }
			event_target:curators = {
				add_trust = {
					who = root
					amount = 20
				}
			}
			random_list = {
				1 = {
					set_timed_country_flag = {
						flag = curator_precursor_purchased
						days = 9360 # 26 years
					}
				}
				1 = {
					set_timed_country_flag = {
						flag = curator_precursor_purchased
						days = 7200 # 20 years
					}
				}
				1 = {
					set_timed_country_flag = {
						flag = curator_precursor_purchased
						days = 5040 # 14 years
					}
				}
			}
		}
	}
	# Back to main menu
	option = {
		name = leviathans.506.d
		hidden_effect = {
			country_event = { id = leviathans.500 }
		}
	}
	# Goodbye
	option = {
		name = GOODBYE
		default_hide_option = yes
	}
}

country_event = {
	id = leviathanexpanded.102
	title = "precursor.301.name"
	desc = "leviathanexpanded.102.desc"
		
	picture = GFX_evt_archaeological_dig
	location = event_target:precursor_planet
	trackable = yes
	
	is_triggered_only = yes
	
	immediate = {
		if = {
			limit = {
				has_event_chain = "vultaum_chain"
				any_system_within_border = { 
					has_star_flag = precursor_1
				}
			}
			spawn_vultaum_anomaly = yes
			break = yes
		}
		if = {
			limit = {
				has_event_chain = "yuht_chain"
				any_system_within_border = { 
					has_star_flag = precursor_2
				}
			}
			spawn_yuht_anomaly = yes
			break = yes
		}
		if = {
			limit = {
				has_event_chain = "first_league_chain"
				any_system_within_border = { 
					has_star_flag = precursor_3
				}
			}
			spawn_league_anomaly = yes
			break = yes
		}
		if = {
			limit = {
				has_event_chain = "irassian_chain"
				any_system_within_border = { 
					has_star_flag = precursor_4
				}
			}
			spawn_irassian_anomaly = yes
			break = yes
		}
		if = {
			limit = {
				has_event_chain = "cybrex_chain"
				any_system_within_border = { 
					has_star_flag = precursor_5
				}
			}
			spawn_cybrex_anomaly = yes
			break = yes
		}
	}
	
	option = {
		name = precursor.301.a
		custom_tooltip = new_precursor_project
	}
}

##################################
# Shroudwalkers - Divinations
# Reserved 200 - 399
##################################

# Docile Wildlife
situation_event = {
	id = leviathanexpanded.200
	title = enclave.5150.name
	desc = enclave.5150.desc
	picture = GFX_evt_surreal_visions
	show_sound = event_mystic_reveal
	location = event_target:friendly_divination_planet
	situation = this
	is_triggered_only = yes

	trigger = {
		NOT = {
			has_situation_flag = divination_occurring
		}
		situation_progress >= 15
		owner = {
			NOT = {
				has_country_flag = friendly_divination_planet
			}
			any_planet_within_border = {
				habitable_planet = yes
				is_colony = no
				is_under_colonization = no
				NOR = {
					has_modifier = bleak_planet
					has_modifier = titanic_life
					#has_modifier = death_world
					has_modifier = young_world
				}
			}
		}
	}

	immediate = {
		set_situation_flag = divination_occurring
		save_event_target_as = friendly_situation
		owner = {
			set_country_flag = friendly_divination_planet
			random_planet_within_border = {
				limit = {
					habitable_planet = yes
					is_colony = no
					is_under_colonization = no
					NOR = {
						has_modifier = bleak_planet
						has_modifier = titanic_life
						#has_modifier = death_world
						has_modifier = young_world
					}
				}
				save_event_target_as = friendly_divination_planet
			}
		}
	}

	option = {
		name = UNDERSTOOD
		event_target:friendly_situation = {
			add_situation_progress = 20
		}
		event_target:friendly_divination_planet = {
			add_anomaly = {
				target = root.owner
				category = EXPANDED_FRIENDLY_ANIMALS_CAT
			}
		}
	}
}

# Unusual Sea Life
situation_event = {
	id = leviathanexpanded.201
	title = enclave.5150.name
	desc = enclave.5150.desc
	picture = GFX_evt_surreal_visions
	show_sound = event_mystic_reveal
	location = event_target:sea_divination_planet
	situation = this
	is_triggered_only = yes

	trigger = {
		NOT = {
			has_situation_flag = divination_occurring
		}
		situation_progress >= 15
		owner = {
			NOT = {
				has_country_flag = sea_divination_planet
			}
			any_planet_within_border = {
				is_ocean_world = yes
			}
		}
	}

	immediate = {
		set_situation_flag = divination_occurring
		save_event_target_as = sea_situation
		owner = {
			set_country_flag = sea_divination_planet
			random_planet_within_border = {
				limit = {
					is_ocean_world = yes
				}
				save_event_target_as = sea_divination_planet
			}
		}
	}

	option = {
		name = UNDERSTOOD
		event_target:sea_situation = {
			add_situation_progress = 20
		}
		event_target:sea_divination_planet = {
			add_anomaly = {
				target = root.owner
				category = SEALIFE_CAT
			}
		}
	}
}

# Dense Flotsam
situation_event = {
	id = leviathanexpanded.202
	title = enclave.5150.name
	desc = enclave.5150.desc
	picture = GFX_evt_surreal_visions
	show_sound = event_mystic_reveal
	location = event_target:flotsam_divination_planet
	situation = this
	is_triggered_only = yes

	trigger = {
		NOT = {
			has_situation_flag = divination_occurring
		}
		situation_progress >= 25
		owner = {
			NOT = {
				has_country_flag = flotsam_divination_planet
			}
			any_planet_within_border = {
				OR = {
					is_planet_class = pc_neutron_star
					is_planet_class = pc_pulsar
					is_planet_class = pc_magnetar
				}
			}
		}
	}

	immediate = {
		set_situation_flag = divination_occurring
		save_event_target_as = flotsam_situation
		owner = {
			set_country_flag = flotsam_divination_planet
			random_planet_within_border = {
				limit = {
					OR = {
						is_planet_class = pc_neutron_star
						is_planet_class = pc_pulsar
						is_planet_class = pc_magnetar
					}
				}
				save_event_target_as = flotsam_divination_planet
			}
		}
	}

	option = {
		name = UNDERSTOOD
		event_target:flotsam_situation = {
			add_situation_progress = 40
		}
		event_target:flotsam_divination_planet = {
			add_anomaly = {
				target = root.owner
				category = NEUTRONIUM_ARMOR_CAT
			}
		}
	}
}

# Unusual Composition
situation_event = {
	id = leviathanexpanded.203
	title = enclave.5150.name
	desc = enclave.5150.desc
	picture = GFX_evt_surreal_visions
	show_sound = event_mystic_reveal
	location = event_target:przybylski_divination_planet
	situation = this
	is_triggered_only = yes

	trigger = {
		NOT = {
			has_situation_flag = divination_occurring
		}
		situation_progress >= 25
		owner = {
			NOT = {
				has_country_flag = przybylski_divination_planet
			}
			any_planet_within_border = {
				is_planet_class = pc_a_star
			}
		}
	}

	immediate = {
		set_situation_flag = divination_occurring
		save_event_target_as = przybylski_situation
		owner = {
			set_country_flag = przybylski_divination_planet
			random_planet_within_border = {
				limit = {
					is_planet_class = pc_a_star
				}
				save_event_target_as = przybylski_divination_planet
			}
		}
	}

	option = {
		name = UNDERSTOOD
		event_target:przybylski_situation = {
			add_situation_progress = 40
		}
		event_target:przybylski_divination_planet = {
			add_anomaly = {
				target = root.owner
				category = EXPANDED_PRZYBYLSKI_STAR_CAT
			}
		}
	}
}

# A Glint in the Darkness
situation_event = {
	id = leviathanexpanded.204
	title = enclave.5150.name
	desc = enclave.5150.desc
	picture = GFX_evt_surreal_visions
	show_sound = event_mystic_reveal
	location = event_target:primitive_probe_divination_planet
	situation = this
	is_triggered_only = yes

	trigger = {
		NOT = {
			has_situation_flag = divination_occurring
		}
		situation_progress >= 25
		owner = {
			NOT = {
				has_country_flag = primitive_probe_divination_planet
			}
			any_system_within_border = {
				any_neighbor_system = {
					any_system_planet = {
						OR = {
							NOT = { exists = space_owner }
							AND = {
								exists = space_owner
								space_owner = { is_same_value = from.owner }
							}
						}
						OR = {
							AND = {
								is_planet_class = pc_nuked
								NOT = { exists = owner }
							}
							AND = {
								exists = owner
								owner = {
									is_primitive = yes
									has_country_flag = early_space_age
								}
							}
						}
					}
				}
			}
		}
	}

	immediate = {
		set_situation_flag = divination_occurring
		save_event_target_as = primitive_probe_situation
		owner = {
			set_country_flag = primitive_probe_divination_planet
			random_system_within_border = {
				limit = {
					any_neighbor_system = {
						any_system_planet = {
							OR = {
								NOT = { exists = space_owner }
								AND = {
									exists = space_owner
									space_owner = { is_same_value = from.owner }
								}
							}
							OR = {
								AND = {
									is_planet_class = pc_nuked
									NOT = { exists = owner }
								}
								AND = {
									exists = owner
									owner = {
										is_primitive = yes
										has_country_flag = early_space_age
									}
								}
							}
						}
					}
				}
				random_system_planet = {
					limit = { uninhabitable_regular_planet = yes }
					save_event_target_as = primitive_probe_divination_planet
				}
			}
		}
	}

	option = {
		name = UNDERSTOOD
		event_target:primitive_probe_situation = {
			add_situation_progress = 40
		}
		event_target:primitive_probe_divination_planet = {
			add_anomaly = {
				target = root.owner
				category = primitive_probe_anomaly
			}
		}
	}
}

# Stellar Elder
situation_event = {
	id = leviathanexpanded.205
	title = enclave.5150.name
	desc = enclave.5150.desc
	picture = GFX_evt_surreal_visions
	show_sound = event_mystic_reveal
	location = event_target:old_star_divination_planet
	situation = this
	is_triggered_only = yes

	trigger = {
		NOT = {
			has_situation_flag = divination_occurring
		}
		situation_progress >= 30
		owner = {
			NOT = {
				has_country_flag = old_star_divination_planet
			}
			any_planet_within_border = {
				is_planet_class = pc_m_star
			}
		}
	}

	immediate = {
		set_situation_flag = divination_occurring
		save_event_target_as = old_star_situation
		owner = {
			set_country_flag = old_star_divination_planet
			random_planet_within_border = {
				limit = {
					is_planet_class = pc_m_star
				}
				save_event_target_as = old_star_divination_planet
			}
		}
	}

	option = {
		name = UNDERSTOOD
		event_target:old_star_situation = {
			add_situation_progress = 40
		}
		event_target:old_star_divination_planet = {
			add_anomaly = {
				target = root.owner
				category = old_star
			}
		}
	}
}

# Unknown Origin
situation_event = {
	id = leviathanexpanded.206
	title = enclave.5150.name
	desc = enclave.5150.desc
	picture = GFX_evt_surreal_visions
	show_sound = event_mystic_reveal
	location = event_target:unknown_origin_divination_planet
	situation = this
	is_triggered_only = yes

	trigger = {
		NOT = {
			has_situation_flag = divination_occurring
		}
		situation_progress >= 15
		owner = {
			NOT = {
				has_country_flag = unknown_origin_divination_planet
			}
			any_planet_within_border = {
				is_asteroid = yes
			}
		}
	}

	immediate = {
		set_situation_flag = divination_occurring
		save_event_target_as = unknown_origin_situation
		owner = {
			set_country_flag = unknown_origin_divination_planet
			random_planet_within_border = {
				limit = {
					is_asteroid = yes
				}
				save_event_target_as = unknown_origin_divination_planet
			}
		}
	}

	option = {
		name = UNDERSTOOD
		event_target:unknown_origin_situation = {
			add_situation_progress = 20
		}
		event_target:unknown_origin_divination_planet = {
			add_anomaly = {
				target = root.owner
				category = origin_asteroid_category
			}
		}
	}
}

# Energy Emissions
situation_event = {
	id = leviathanexpanded.207
	title = enclave.5150.name
	desc = enclave.5150.desc
	picture = GFX_evt_surreal_visions
	show_sound = event_mystic_reveal
	location = event_target:emissions_asteroid_divination_planet
	situation = this
	is_triggered_only = yes

	trigger = {
		NOT = {
			has_situation_flag = divination_occurring
		}
		situation_progress >= 15
		owner = {
			NOT = {
				has_country_flag = emissions_asteroid_divination_planet
			}
			any_planet_within_border = {
				is_asteroid = yes
			}
		}
	}

	immediate = {
		set_situation_flag = divination_occurring
		save_event_target_as = emissions_asteroid_situation
		owner = {
			set_country_flag = emissions_asteroid_divination_planet
			random_planet_within_border = {
				limit = {
					is_asteroid = yes
				}
				save_event_target_as = emissions_asteroid_divination_planet
			}
		}
	}

	option = {
		name = UNDERSTOOD
		event_target:emissions_asteroid_situation = {
			add_situation_progress = 20
		}
		event_target:emissions_asteroid_divination_planet = {
			add_anomaly = {
				target = root.owner
				category = emissions_asteroid_category
			}
		}
	}
}

# Life Signs (Frozen)
situation_event = {
	id = leviathanexpanded.208
	title = enclave.5150.name
	desc = enclave.5150.desc
	picture = GFX_evt_surreal_visions
	show_sound = event_mystic_reveal
	location = event_target:life_frozen_divination_planet
	situation = this
	is_triggered_only = yes

	trigger = {
		NOT = {
			has_situation_flag = divination_occurring
		}
		situation_progress >= 15
		owner = {
			NOT = {
				has_country_flag = life_frozen_divination_planet
			}
			any_planet_within_border = {
				is_frozen_world = yes
				has_any_strategic_resource = no
			}
		}
	}

	immediate = {
		set_situation_flag = divination_occurring
		save_event_target_as = life_frozen_situation
		owner = {
			set_country_flag = life_frozen_divination_planet
			random_planet_within_border = {
				limit = {
					is_frozen_world = yes
					has_any_strategic_resource = no
				}
				save_event_target_as = life_frozen_divination_planet
			}
		}
	}

	option = {
		name = UNDERSTOOD
		event_target:life_frozen_situation = {
			add_situation_progress = 20
		}
		event_target:life_frozen_divination_planet = {
			add_anomaly = {
				target = root.owner
				category = life_frozen_category
			}
		}
	}
}

# Gas Giant Signal
situation_event = {
	id = leviathanexpanded.209
	title = enclave.5150.name
	desc = enclave.5150.desc
	picture = GFX_evt_surreal_visions
	show_sound = event_mystic_reveal
	location = event_target:tollok_rong_divination_planet
	situation = this
	is_triggered_only = yes

	trigger = {
		NOT = {
			has_situation_flag = divination_occurring
		}
		situation_progress >= 35
		owner = {
			NOT = {
				has_country_flag = tollok_rong_divination_planet
			}
		}
	}

	immediate = {
		set_situation_flag = divination_occurring
		save_event_target_as = tollok_rong_situation
		owner = {
			set_country_flag = tollok_rong_divination_planet
			random_planet_within_border = {
				limit = {
					is_planet_class = pc_gas_giant
				}
				save_event_target_as = tollok_rong_divination_planet
			}
		}
	}

	option = {
		name = UNDERSTOOD
		event_target:tollok_rong_situation = {
			add_situation_progress = 30
		}
		event_target:tollok_rong_divination_planet = {
			add_anomaly = {
				target = root.owner
				category = signal_gasgiant_category
			}
		}
	}
}

# Asteroid Waves
situation_event = {
	id = leviathanexpanded.210
	title = enclave.5150.name
	desc = enclave.5150.desc
	picture = GFX_evt_surreal_visions
	show_sound = event_mystic_reveal
	location = event_target:asteroid_waves_divination_planet
	situation = this
	is_triggered_only = yes

	trigger = {
		NOT = {
			has_situation_flag = divination_occurring
		}
		situation_progress >= 25
		owner = {
			NOT = {
				has_country_flag = asteroid_waves_divination_planet
			}
			any_planet_within_border = {
				is_asteroid = yes
			}
		}
	}

	immediate = {
		set_situation_flag = divination_occurring
		save_event_target_as = asteroid_waves_situation
		owner = {
			set_country_flag = asteroid_waves_divination_planet
			random_planet_within_border = {
				limit = {
					is_asteroid = yes
				}
				save_event_target_as = asteroid_waves_divination_planet
			}
		}
	}

	option = {
		name = UNDERSTOOD
		event_target:asteroid_waves_situation = {
			add_situation_progress = 30
		}
		event_target:asteroid_waves_divination_planet = {
			add_anomaly = {
				target = root.owner
				category = AST_WAVELENGTHS_1_CAT
			}
		}
	}
}

# Dimensional Disturbance
situation_event = {
	id = leviathanexpanded.211
	title = enclave.5150.name
	desc = enclave.5150.desc
	picture = GFX_evt_surreal_visions
	show_sound = event_mystic_reveal
	location = event_target:dimensional_pocket_divination_planet
	situation = this
	is_triggered_only = yes

	trigger = {
		NOT = {
			has_situation_flag = divination_occurring
		}
		situation_progress >= 25
		owner = {
			NOT = {
				has_country_flag = dimensional_pocketed
			}
			any_planet_within_border = {
				is_asteroid = yes
			}
		}
	}

	immediate = {
		set_situation_flag = divination_occurring
		save_event_target_as = dimensional_pocket_situation
		owner = {
			set_country_flag = dimensional_pocketed
			random_planet_within_border = {
				limit = {
					is_asteroid = yes
				}
				save_event_target_as = dimensional_pocket_divination_planet
			}
		}
	}

	option = {
		name = UNDERSTOOD
		event_target:dimensional_pocket_situation = {
			add_situation_progress = 30
		}
		event_target:dimensional_pocket_divination_planet = {
			add_anomaly = {
				target = root.owner
				category = DIMENSIONAL_POCKET_CAT
			}
		}
	}
}

# Seismic Disturbance
situation_event = {
	id = leviathanexpanded.212
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		NOT = {
			has_situation_flag = divination_occurring
		}
		situation_progress >= 10
		NOT = { has_global_flag = seismic_disturbance_global }
	}

	immediate = {
		set_situation_flag = divination_occurring
		owner = {
			random_owned_planet = {
				limit = {
					is_colony = yes
					is_under_colonization = no
					NOR = {
						has_planet_flag = colony_event
						is_planet_class = pc_nuked
						is_planet_class = pc_ringworld_habitable
						is_habitat = yes
						is_planet_class = pc_city
						is_planet_class = pc_relic
					}
				}
				save_event_target_as = seismic_divination_planet
			}
			event_target:seismic_divination_planet = {
				planet_event = {
					id = colony.50
				}
			}
		}
	}
}

# Helpful Drones
situation_event = {
	id = leviathanexpanded.213
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		NOT = {
			has_situation_flag = divination_occurring
		}
		situation_progress >= 10
		owner = {
			NOT = { has_country_flag = FLDrone_country }
			any_owned_planet = {
				is_colony = yes
				is_under_colonization = no
				is_homeworld = no
				NOR = {
					is_habitat = yes
					has_planet_flag = colony_event
					has_planet_flag = FLDrone_event
				}
				has_moon = yes
				any_moon = {
					habitable_planet = no
				}
			}
		}
	}

	immediate = {
		set_situation_flag = divination_occurring
		owner = {
			random_owned_planet = {
				limit = {
					is_colony = yes
					is_under_colonization = no
					is_homeworld = no
					NOR = {
						is_habitat = yes
						has_planet_flag = colony_event
						has_planet_flag = FLDrone_event
					}
					has_moon = yes
					any_moon = {
						habitable_planet = no
					}
				}
				save_event_target_as = helpful_drone_divination_planet
			}
			event_target:helpful_drone_divination_planet = {
				planet_event = {
					id = colony.1500
				}
			}
		}
	}
}

# Asteroid Sighted
situation_event = {
	id = leviathanexpanded.214
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		owner = { is_ai = no }
		NOT = {
			has_situation_flag = divination_occurring
		}
		situation_progress >= 15
		owner = { NOT = { has_country_flag = asteroid_sighted_country } }
	}

	immediate = {
		set_situation_flag = divination_occurring
		owner = {
			set_timed_country_flag = { flag = allow_asteroid_collision days = 30 }
			random_owned_planet = {
				limit = {
					is_colony = yes
					is_under_colonization = no
					is_homeworld = no
					NOR = {
						is_habitat = yes
						is_planet_class = pc_ringworld_habitable
						has_planet_flag = asteroid_sighted
						has_planet_flag = asteroid_collision
					}
				}
				save_event_target_as = asteroid_collision_divination_planet
			}
			event_target:asteroid_collision_divination_planet = {
				planet_event = {
					id = colony.180
				}
			}
		}
	}
}

# Underground Vault
situation_event = {
	id = leviathanexpanded.215
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		NOT = {
			has_situation_flag = divination_occurring
		}
		situation_progress >= 15
		owner = {
			NOT = { has_country_flag = underground_vault_country }
			any_owned_planet = {
				is_colony = yes
				is_under_colonization = no
				is_homeworld = no
				NOT = { has_planet_flag = armageddon_nuked }
				OR = {
					is_nuked_world = yes
					has_planet_flag = colonized_tomb_world
					has_modifier = recovered_tomb_world
				}
				NOR = {
					has_planet_flag = primitives_nuked_themselves
					solar_system = {
						any_system_planet = {
							is_capital = yes
						}
					}
				}
			}
		}
	}

	immediate = {
		set_situation_flag = divination_occurring
		owner = {
			random_owned_planet = {
				limit = {
					is_colony = yes
					is_under_colonization = no
					is_homeworld = no
					NOT = { has_planet_flag = armageddon_nuked }
					OR = {
						is_nuked_world = yes
						has_planet_flag = colonized_tomb_world
						has_modifier = recovered_tomb_world
					}
					NOR = {
						has_planet_flag = primitives_nuked_themselves
						solar_system = {
							any_system_planet = {
								is_capital = yes
							}
						}
					}
				}
				save_event_target_as = underground_vault_divination_planet
			}
			event_target:underground_vault_divination_planet = {
				planet_event = {
					id = colony.150
				}
			}
		}
	}
}

# POLLEN APHRODISIAC CHAIN
situation_event = {
	id = leviathanexpanded.216
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		NOT = {
			has_situation_flag = divination_occurring
		}
		situation_progress >= 20
		owner = {
			NOT = { has_country_flag = pheromone_country }
			NOT = { is_gestalt = yes }
			any_owned_planet = {
				is_colony = yes
				is_under_colonization = no
				is_homeworld = no
				has_planet_flag = colony_event
				has_planet_flag = pheromone_planet
				is_planet_class = pc_ringworld_habitable
				is_habitat = yes
				is_dry = yes
				is_planet_class = pc_city
				is_planet_class = pc_relic
			}
		}
	}

	immediate = {
		set_situation_flag = divination_occurring
		owner = {
			random_owned_planet = {
				limit = {
					is_colony = yes
					is_under_colonization = no
					is_homeworld = no
					has_planet_flag = colony_event
					has_planet_flag = pheromone_planet
					is_planet_class = pc_ringworld_habitable
					is_habitat = yes
					is_dry = yes
					is_planet_class = pc_city
					is_planet_class = pc_relic
				}
				save_event_target_as = pollen_divination_planet
			}
			event_target:pollen_divination_planet = {
				planet_event = {
					id = colony.1520
				}
			}
		}
	}
}

# Odd Factory
situation_event = {
	id = leviathanexpanded.217
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		NOT = {
			has_situation_flag = divination_occurring
		}
		situation_progress >= 15
		owner = {
			NOR = {
				is_ai = yes
				has_country_flag = colony_odd_factory
				is_machine_empire = yes
			}
		}
	}

	immediate = {
		set_situation_flag = divination_occurring
		owner = {
			random_owned_planet = {
				limit = {
					is_colony = yes
					is_under_colonization = no
					is_homeworld = no
					has_planet_flag = colony_event
					is_planet_class = pc_ringworld_habitable
					is_habitat = yes
				}
				save_event_target_as = odd_factor_divination_planet
			}
			event_target:odd_factor_divination_planet = {
				planet_event = {
					id = colony.1520
				}
			}
		}
	}
}

# It Was Aliens
situation_event = {
	id = leviathanexpanded.218
	title = expandedrelics.200.name
	desc = leviathanexpanded.218.desc
	picture = GFX_evt_tomb_world
	show_sound = event_mystic_reveal
	location = event_target:it_was_aliens_divination_planet
	situation = this
	is_triggered_only = yes

	trigger = {
		NOT = {
			has_situation_flag = divination_occurring
		}
		situation_progress >= 15
		has_ancrel = yes
		NOR = {
			has_global_flag = it_was_aliens_site_found
			any_system = {
				any_system_planet = {
					exists = archaeological_site
					archaeological_site = { is_site_type = it_was_aliens_site }
				}
			}
		}
		owner = {
			any_owned_planet = {
				is_colony = yes
				is_under_colonization = no
				is_homeworld = no
				is_planet_class = pc_nuked
				NOT = { exists = archaeological_site }
			}
		}
	}

	immediate = {
		set_situation_flag = divination_occurring
		set_global_flag = it_was_aliens_site_found
		owner = {
			random_owned_planet = {
				limit = {
					is_colony = yes
					is_under_colonization = no
					is_homeworld = no
					is_planet_class = pc_nuked
					NOT = { exists = archaeological_site }
				}
				save_event_target_as = it_was_aliens_divination_planet
			}
		}
	}
	
	 option = {
		name = ancrel.4000.a
		event_target:it_was_aliens_divination_planet = { create_archaeological_site = it_was_aliens_site }
	}
}

# City of Bone
situation_event = {
	id = leviathanexpanded.219
	title = expandedrelics.201.name
	desc = leviathanexpanded.219.desc
	picture = GFX_evt_arid
	show_sound = event_mystic_reveal
	location = event_target:bone_city_divination_planet
	situation = this
	is_triggered_only = yes

	trigger = {
		NOT = {
			has_situation_flag = divination_occurring
		}
		situation_progress >= 15
		has_ancrel = yes
		NOR = {
			has_global_flag = bone_city_found
			any_system = {
				any_system_planet = {
					exists = archaeological_site
					archaeological_site = { is_site_type = city_of_bones }
				}
			}
		}
		owner = {
			any_owned_planet = {
				is_colony = yes
				is_under_colonization = no
				is_homeworld = no
				is_dry = yes
				NOT = { exists = archaeological_site }
			}
		}
	}

	immediate = {
		set_situation_flag = divination_occurring
		set_global_flag = bone_city_found
		owner = {
			random_owned_planet = {
				limit = {
					is_colony = yes
					is_under_colonization = no
					is_homeworld = no
					is_dry = yes
					NOT = { exists = archaeological_site }
				}
				save_event_target_as = bone_city_divination_planet
			}
		}
	}
	
	 option = {
		name = ancrel.4000.a
		event_target:bone_city_divination_planet = { create_archaeological_site = city_of_bones }
	}
}

# Asteroid Blast Door
situation_event = {
	id = leviathanexpanded.220
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		NOT = {
			has_situation_flag = divination_occurring
		}
		situation_progress >= 15
		has_ancrel = yes
		NOR = {
			has_global_flag = command_center_found
			any_system = {
				any_system_planet = {
					exists = archaeological_site
					archaeological_site = { is_site_type = site_command_center }
				}
			}
		}
		owner = {
			any_planet_within_border = {
				is_planet_class = pc_asteroid
				NOT = { exists = archaeological_site }
				NOT = { has_planet_flag = suppress_archaeological_sites }
				has_deposit = no
				NOT = {
					solar_system = {
						any_system_planet = { is_colony = yes }
					}
				}
			}
		}
	}

	immediate = {
		set_situation_flag = divination_occurring
		owner = {
			random_planet_within_border = {
				limit = {
					is_planet_class = pc_asteroid
					NOT = { exists = archaeological_site }
					NOT = { has_planet_flag = suppress_archaeological_sites }
					has_deposit = no
					NOT = {
						solar_system = {
							any_system_planet = { is_colony = yes }
						}
					}
				}
				planet_event = { id = expandedrelics.205 }
			}
		}
	}
}

# Mutation Vats
situation_event = {
	id = leviathanexpanded.221
	title = expandedrelics.203.name
	desc = leviathanexpanded.221.desc
	picture = GFX_evt_tomb_world
	show_sound = event_mystic_reveal
	location = event_target:mutation_vats_divination_planet
	situation = this
	is_triggered_only = yes

	trigger = {
		NOT = {
			has_situation_flag = divination_occurring
		}
		situation_progress >= 15
		has_ancrel = yes
		NOR = {
			has_global_flag = mutation_vats_found
			any_system = {
				any_system_planet = {
					exists = archaeological_site
					archaeological_site = { is_site_type = mutation_vats }
				}
			}
		}
		owner = {
			any_owned_planet = {
				is_colony = yes
				is_under_colonization = no
				is_homeworld = no
				is_planet_class = pc_nuked
				NOT = { exists = archaeological_site }
			}
		}
	}

	immediate = {
		set_situation_flag = divination_occurring
		set_global_flag = mutation_vats_found
		owner = {
			random_owned_planet = {
				limit = {
					is_colony = yes
					is_under_colonization = no
					is_homeworld = no
					is_planet_class = pc_nuked
					NOT = { exists = archaeological_site }
				}
				save_event_target_as = mutation_vats_divination_planet
			}
		}
	}
	
	 option = {
		name = ancrel.4000.a
		event_target:mutation_vats_divination_planet = { create_archaeological_site = mutation_vats }
	}
}

# Atomic Clock
situation_event = {
	id = leviathanexpanded.222
	title = enclave.5150.name
	desc = enclave.5150.desc
	picture = GFX_evt_surreal_visions
	show_sound = event_mystic_reveal
	location = event_target:atomic_clock_divination_planet
	situation = this
	is_triggered_only = yes

	trigger = {
		NOT = {
			has_situation_flag = divination_occurring
		}
		situation_progress >= 10
		has_distar = yes
		owner = {
			NOT = {
				has_country_flag = atomic_clock_divination_planet
			}
			any_planet_within_border = {
				NOR = {
					has_deposit_for = shipclass_research_station
					has_deposit_for = shipclass_mining_station
				}
				solar_system = {
					any_system_planet = {
						OR = {
							AND = {
								exists = owner
								owner = { is_primitive = yes }
								NOT = { is_planet_class = pc_ringworld_habitable }
							}
							AND = {
								habitable_planet = yes
								is_colony = no
								is_under_colonization = no
							}
							# pulsars for wraith
							AND = {
								has_leviathans = yes
								OR = {
									is_planet_class = pc_pulsar
									is_planet_class = pc_neutron_star
									is_planet_class = pc_magnetar
								}
							}
						}
					}
				}
			}
		}
	}

	immediate = {
		set_situation_flag = divination_occurring
		save_event_target_as = atomic_clock_situation
		owner = {
			set_country_flag = atomic_clock_divination_planet
			random_planet_within_border = {
				limit = {
					NOR = {
						has_deposit_for = shipclass_research_station
						has_deposit_for = shipclass_mining_station
					}
					solar_system = {
						any_system_planet = {
							OR = {
								AND = {
									exists = owner
									owner = { is_primitive = yes }
									NOT = { is_planet_class = pc_ringworld_habitable }
								}
								AND = {
									habitable_planet = yes
									is_colony = no
									is_under_colonization = no
								}
								# pulsars for wraith
								AND = {
									has_leviathans = yes
									OR = {
										is_planet_class = pc_pulsar
										is_planet_class = pc_neutron_star
										is_planet_class = pc_magnetar
									}
								}
							}
						}
					}
				}
				save_event_target_as = atomic_clock_divination_planet
			}
		}
	}

	option = {
		name = UNDERSTOOD
		event_target:atomic_clock_situation = {
			add_situation_progress = 15
		}
		event_target:atomic_clock_divination_planet = {
			add_anomaly = {
				target = root.owner
				category = atomic_clock_cat
			}
		}
	}
}

# Signs of Battle
situation_event = {
	id = leviathanexpanded.223
	title = enclave.5150.name
	desc = enclave.5150.desc
	picture = GFX_evt_surreal_visions
	show_sound = event_mystic_reveal
	location = event_target:battle_uninhabitable_divination_planet
	situation = this
	is_triggered_only = yes

	trigger = {
		NOT = {
			has_situation_flag = divination_occurring
		}
		situation_progress >= 10
		owner = {
			NOT = {
				has_country_flag = battle_uninhabitable_divination_planet
			}
			any_planet_within_border = {
				is_gas_giant = yes
			}
		}
	}

	immediate = {
		set_situation_flag = divination_occurring
		save_event_target_as = battle_uninhabitable_situation
		owner = {
			set_country_flag = battle_uninhabitable_divination_planet
			random_planet_within_border = {
				limit = {
					is_gas_giant = yes
				}
				save_event_target_as = battle_uninhabitable_divination_planet
			}
		}
	}

	option = {
		name = UNDERSTOOD
		event_target:battle_uninhabitable_situation = {
			add_situation_progress = 15
		}
		event_target:battle_uninhabitable_divination_planet = {
			add_anomaly = {
				target = root.owner
				category = battle_uninhabitable_category
			}
		}
	}
}

# Old Gods
situation_event = {
	id = leviathanexpanded.224
	title = enclave.5150.name
	desc = enclave.5150.desc
	picture = GFX_evt_surreal_visions
	show_sound = event_mystic_reveal
	location = event_target:old_god_divination_planet
	situation = this
	is_triggered_only = yes

	trigger = {
		NOT = {
			has_situation_flag = divination_occurring
		}
		situation_progress >= 25
		owner = {
			NOT = {
				has_country_flag = old_god_divination_planet
			}
			any_planet_within_border = {
				is_asteroid = yes
			}
		}
	}

	immediate = {
		set_situation_flag = divination_occurring
		save_event_target_as = old_god_situation
		owner = {
			set_country_flag = old_god_divination_planet
			random_planet_within_border = {
				limit = {
					is_asteroid = yes
				}
				save_event_target_as = old_god_divination_planet
			}
		}
	}

	option = {
		name = UNDERSTOOD
		event_target:old_god_situation = {
			add_situation_progress = 25
		}
		event_target:old_god_divination_planet = {
			add_anomaly = {
				target = root.owner
				category = AST_SHRINE_1_CAT
			}
		}
	}
}

# Debris Field
situation_event = {
	id = leviathanexpanded.225
	title = enclave.5150.name
	desc = enclave.5150.desc
	picture = GFX_evt_surreal_visions
	show_sound = event_mystic_reveal
	location = event_target:debris_field_divination_planet
	situation = this
	is_triggered_only = yes

	trigger = {
		NOT = {
			has_situation_flag = divination_occurring
		}
		situation_progress >= 15
		owner = {
			NOT = {
				has_country_flag = debris_field_divination_planet
			}
			any_planet_within_border = {
				is_asteroid = yes
			}
		}
	}

	immediate = {
		set_situation_flag = divination_occurring
		save_event_target_as = debris_field_situation
		owner = {
			set_country_flag = debris_field_divination_planet
			random_planet_within_border = {
				limit = {
					is_asteroid = yes
				}
				save_event_target_as = debris_field_divination_planet
			}
		}
	}

	option = {
		name = UNDERSTOOD
		event_target:debris_field_situation = {
			add_situation_progress = 15
		}
		event_target:debris_field_divination_planet = {
			add_anomaly = {
				target = root.owner
				category = AST_DEBRIS_FIELD_1_CAT
			}
		}
	}
}

# Monoliths
situation_event = {
	id = leviathanexpanded.226
	title = leviathanexpanded.226.name
	desc = leviathanexpanded.226.desc
	picture = GFX_evt_surreal_visions
	show_sound = event_mystic_reveal
	location = event_target:monoliths_divination_planet
	situation = this
	is_triggered_only = yes

	trigger = {
		NOT = {
			has_situation_flag = divination_occurring
		}
		situation_progress >= 10
		owner = {
			NOT = {
				has_country_flag = monoliths_divination_planet
			}
		}
	}

	immediate = {
		set_situation_flag = divination_occurring
		save_event_target_as = monoliths_situation
		owner = {
			set_country_flag = monoliths_divination_planet
			random_planet_within_border = {
				limit = {
					is_asteroid = no
					is_star = no
					is_ringworld = no
					is_gas_giant = no
				}
				save_event_target_as = monoliths_divination_planet
			}
		}
	}

	option = {
		name = UNDERSTOOD
		event_target:monoliths_situation = {
			add_situation_progress = 10
		}
		event_target:monoliths_divination_planet = {
			add_anomaly = {
				target = root.owner
				category = UHB_ANCIENT_RUINS_1_CAT
			}
		}
	}
}

# Toxicity
situation_event = {
	id = leviathanexpanded.227
	title = leviathanexpanded.226.name
	desc = leviathanexpanded.226.desc
	picture = GFX_evt_surreal_visions
	show_sound = event_mystic_reveal
	location = event_target:toxicity_divination_planet
	situation = this
	is_triggered_only = yes

	trigger = {
		NOT = {
			has_situation_flag = divination_occurring
		}
		situation_progress >= 15
		owner = {
			NOT = {
				has_country_flag = edict_renewable_energy
			}
		}
	}

	immediate = {
		set_situation_flag = divination_occurring
		save_event_target_as = toxicity_situation
		owner = {
			random_planet_within_border = {
				limit = {
					is_toxic_world = yes
					has_any_strategic_resource = no
				}
				save_event_target_as = toxicity_divination_planet
			}
		}
	}

	option = {
		name = UNDERSTOOD
		event_target:toxicity_situation = {
			add_situation_progress = 15
		}
		event_target:toxicity_divination_planet = {
			add_anomaly = {
				target = root.owner
				category = TOX_PLANET_CAT
			}
		}
	}
}

# Looking Down
situation_event = {
	id = leviathanexpanded.228
	title = leviathanexpanded.226.name
	desc = leviathanexpanded.226.desc
	picture = GFX_evt_surreal_visions
	show_sound = event_mystic_reveal
	location = event_target:looking_down_divination_planet
	situation = this
	is_triggered_only = yes

	trigger = {
		NOT = {
			has_situation_flag = divination_occurring
		}
		situation_progress >= 10
		owner = {
			NOT = {
				has_country_flag = looking_down_divination_planet
			}
		}
	}

	immediate = {
		set_situation_flag = divination_occurring
		save_event_target_as = looking_down_situation
		owner = {
			set_country_flag = looking_down_divination_planet
			random_planet_within_border = {
				limit = {
					is_planet_class = pc_barren
				}
				save_event_target_as = looking_down_divination_planet
			}
		}
	}

	option = {
		name = UNDERSTOOD
		event_target:looking_down_situation = {
			add_situation_progress = 10
		}
		event_target:looking_down_divination_planet = {
			add_anomaly = {
				target = root.owner
				category = BAR_COLONY_CAT
			}
		}
	}
}

# Buried in the Sand
situation_event = {
	id = leviathanexpanded.229
	title = enclave.5150.name
	desc = enclave.5150.desc
	picture = GFX_evt_surreal_visions
	show_sound = event_mystic_reveal
	location = event_target:buried_in_the_sand_divination_planet
	situation = this
	is_triggered_only = yes

	trigger = {
		NOT = {
			has_situation_flag = divination_occurring
		}
		situation_progress >= 15
		owner = {
			NOT = {
				has_country_flag = masters_writings_politics_found
			}
			any_planet_within_border = {
				is_colony = no
				is_under_colonization = no
				is_desert_world = yes
			}
		}
	}

	immediate = {
		set_situation_flag = divination_occurring
		save_event_target_as = buried_in_the_sand_situation
		owner = {
			random_planet_within_border = {
				limit = {
					is_colony = no
					is_under_colonization = no
					is_desert_world = yes
				}
				save_event_target_as = buried_in_the_sand_divination_planet
			}
		}
	}

	option = {
		name = UNDERSTOOD
		event_target:buried_in_the_sand_situation = {
			add_situation_progress = 15
		}
		event_target:buried_in_the_sand_divination_planet = {
			add_anomaly = {
				target = root.owner
				category = DES_BURIED_CAT
			}
		}
	}
}

# A Feel for Steel
situation_event = {
	id = leviathanexpanded.230
	title = enclave.5150.name
	desc = enclave.5150.desc
	picture = GFX_evt_surreal_visions
	show_sound = event_mystic_reveal
	location = event_target:old_war_divination_planet
	situation = this
	is_triggered_only = yes

	trigger = {
		NOT = {
			has_situation_flag = divination_occurring
		}
		situation_progress >= 15
		owner = {
			NOT = {
				has_country_flag = masters_writings_war_found
			}
			any_planet_within_border = {
				is_colony = no
				is_under_colonization = no
				OR = {
					is_tundra_world = yes
					is_nuked_world = yes
					is_toxic_world = yes
				}
				NOT = { has_planet_flag = nuked_planet_anomalies_disabled }
			}
		}
	}

	immediate = {
		set_situation_flag = divination_occurring
		save_event_target_as = old_war_situation
		owner = {
			random_planet_within_border = {
				limit = {
					is_colony = no
					is_under_colonization = no
					OR = {
						is_tundra_world = yes
						is_nuked_world = yes
						is_toxic_world = yes
					}
					NOT = { has_planet_flag = nuked_planet_anomalies_disabled }
				}
				save_event_target_as = old_war_divination_planet
			}
		}
	}

	option = {
		name = UNDERSTOOD
		event_target:old_war_situation = {
			add_situation_progress = 15
		}
		event_target:old_war_divination_planet = {
			add_anomaly = {
				target = root.owner
				category = GEN_OLD_WAR_CAT
			}
		}
	}
}

# Winter of the Fallen
situation_event = {
	id = leviathanexpanded.231
	title = enclave.5150.name
	desc = enclave.5150.desc
	picture = GFX_evt_surreal_visions
	show_sound = event_mystic_reveal
	location = event_target:winter_of_the_fallen_divination_planet
	situation = this
	is_triggered_only = yes

	trigger = {
		NOT = {
			has_situation_flag = divination_occurring
		}
		situation_progress >= 25
		owner = {
			NOT = {
				has_country_flag = winter_of_the_fallen_divination_planet
			}
			any_planet_within_border = {
				is_colony = no
				is_under_colonization = no
				is_nuked_world = yes
				NOT = { has_planet_flag = nuked_planet_anomalies_disabled }
			}
		}
	}

	immediate = {
		set_situation_flag = divination_occurring
		save_event_target_as = winter_of_the_fallen_situation
		owner = {
			set_country_flag = winter_of_the_fallen_divination_planet
			random_planet_within_border = {
				limit = {
					is_colony = no
					is_under_colonization = no
					is_nuked_world = yes
					NOT = { has_planet_flag = nuked_planet_anomalies_disabled }
				}
				save_event_target_as = winter_of_the_fallen_divination_planet
			}
		}
	}

	option = {
		name = UNDERSTOOD
		event_target:winter_of_the_fallen_situation = {
			add_situation_progress = 25
		}
		event_target:winter_of_the_fallen_divination_planet = {
			add_anomaly = {
				target = root.owner
				category = NUKE_PLANET_CAT
			}
		}
	}
}

# Ship Fragments
situation_event = {
	id = leviathanexpanded.232
	title = enclave.5150.name
	desc = enclave.5150.desc
	picture = GFX_evt_surreal_visions
	show_sound = event_mystic_reveal
	location = event_target:ship_fragments_divination_planet
	situation = this
	is_triggered_only = yes

	trigger = {
		NOT = {
			has_situation_flag = divination_occurring
		}
		situation_progress >= 20
		NOR = {
			has_distar = no
			owner = {
				species_portrait = mol4
			}
		}
		owner = {
			NOT = {
				has_country_flag = ship_fragments_divination_planet
			}
			any_planet_within_border = {
				OR = {
					is_planet_class = pc_neutron_star
					is_planet_class = pc_pulsar
					is_planet_class = pc_magnetar
				}
			}
		}
	}

	immediate = {
		set_situation_flag = divination_occurring
		save_event_target_as = ship_fragments_situation
		owner = {
			set_country_flag = ship_fragments_divination_planet
			random_planet_within_border = {
				limit = {
					OR = {
						is_planet_class = pc_neutron_star
						is_planet_class = pc_pulsar
						is_planet_class = pc_magnetar
					}
				}
				save_event_target_as = ship_fragments_divination_planet
			}
		}
	}

	option = {
		name = UNDERSTOOD
		event_target:ship_fragments_situation = {
			add_situation_progress = 20
		}
		event_target:ship_fragments_divination_planet = {
			add_anomaly = {
				target = root.owner
				category = DISTAR_TIME_CAT
			}
		}
	}
}

# Abandoned Settlements
situation_event = {
	id = leviathanexpanded.233
	title = leviathanexpanded.226.name
	desc = leviathanexpanded.226.desc
	picture = GFX_evt_surreal_visions
	show_sound = event_mystic_reveal
	location = event_target:abandoned_settlements_divination_planet
	situation = this
	is_triggered_only = yes

	trigger = {
		NOT = {
			has_situation_flag = divination_occurring
		}
		situation_progress >= 15
		owner = {
			NOT = {
				has_country_flag = abandoned_settlements_divination_planet
			}
			any_planet_within_border = {
				is_colony = no
				is_under_colonization = no
				habitable_planet = yes
			}
		}
	}

	immediate = {
		set_situation_flag = divination_occurring
		save_event_target_as = abandoned_settlements_situation
		owner = {
			set_country_flag = abandoned_settlements_divination_planet
			random_planet_within_border = {
				limit = {
					is_colony = no
					is_under_colonization = no
					habitable_planet = yes
				}
				save_event_target_as = abandoned_settlements_divination_planet
			}
		}
	}

	option = {
		name = UNDERSTOOD
		event_target:abandoned_settlements_situation = {
			add_situation_progress = 15
		}
		event_target:abandoned_settlements_divination_planet = {
			add_anomaly = {
				target = root.owner
				category = ancient_colony_category
			}
		}
	}
}

# Horizon Signal
situation_event = {
	id = leviathanexpanded.234
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		NOT = {
			has_situation_flag = divination_occurring
		}
		situation_progress >= 60
		owner = {
			NOT = { has_global_flag = akx.9000.fired }
			is_ai = no
			NOT = { is_gestalt = yes }
			any_system_within_border = {
				is_star_class = sc_black_hole
				NOT = { has_star_flag = guardian }
			}
		}
	}

	immediate = {
		set_situation_flag = divination_occurring
		owner = {
			random_system_within_border = {
				limit = {
					is_star_class = sc_black_hole
				}
				save_event_target_as = horizonsignal_start_system
			}
			country_event = { id = countryexpanded.209 }
		}
	}
}

# Abandoned Terraforming
situation_event = {
	id = leviathanexpanded.235
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		NOT = {
			has_situation_flag = divination_occurring
		}
		situation_progress >= 20
		owner = {
			NOT = { has_country_flag = abandoned_terraforming_country }
			NOT = { is_machine_empire = yes }
			any_owned_planet = {
				is_colony = yes
				is_under_colonization = no
				has_planet_flag = abandoned_terraforming_planet
				has_planet_flag = colony_event
				is_planet_class = pc_nuked
				is_planet_class = pc_gaia
				is_planet_class = pc_relic
				is_ideal_planet_class = { who = prev status = yes }
			}
		}
	}

	immediate = {
		set_situation_flag = divination_occurring
		owner = {
			random_owned_planet = {
				limit = {
					is_colony = yes
					is_under_colonization = no
					has_planet_flag = abandoned_terraforming_planet
					has_planet_flag = colony_event
					is_planet_class = pc_nuked
					is_planet_class = pc_gaia
					is_planet_class = pc_relic
					is_ideal_planet_class = { who = prev status = yes }
				}
				save_event_target_as = abandoned_terraforming_divination_planet
			}
		}
		event_target:abandoned_terraforming_divination_planet = {
			planet_event = { id = colony.100 }
		}
	}
}

# Submerged Cruiser
situation_event = {
	id = leviathanexpanded.236
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		NOT = {
			has_situation_flag = divination_occurring
		}
		situation_progress >= 20
		owner = {
			has_technology = tech_destroyers
			NOT = { has_country_flag = colony_submerged_cruiser }
			any_owned_planet = {
				is_colony = yes
				is_under_colonization = no
				NOT = {
					has_planet_flag = colony_event
				}
				OR = {
					is_continental_world = yes
					is_tropical_world = yes
					is_gaia_world = yes
					is_ocean_world = yes
				}
			}
		}
	}

	immediate = {
		set_situation_flag = divination_occurring
		owner = {
			random_owned_planet = {
				limit = {
					is_colony = yes
					is_under_colonization = no
					NOT = {
						has_planet_flag = colony_event
					}
					OR = {
						is_continental_world = yes
						is_tropical_world = yes
						is_gaia_world = yes
						is_ocean_world = yes
					}
				}
				save_event_target_as = submerged_cruiser_divination_planet
			}
		}
		event_target:submerged_cruiser_divination_planet = {
			planet_event = { id = colony.2005 }
		}
	}
}

# Turtle World
situation_event = {
	id = leviathanexpanded.237
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		NOT = {
			has_situation_flag = divination_occurring
		}
		situation_progress >= 20
		owner = {
			is_ai = no
			NOT = { has_country_flag = turtle_world_spawned }
			any_owned_planet = {
				is_colony = yes
				is_under_colonization = no
				NOT = {
					has_planet_flag = colony_event
				}
				OR = {
					is_continental_world = yes
					is_ocean_world = yes
				}
			}
		}
	}

	immediate = {
		set_situation_flag = divination_occurring
		owner = {
			random_owned_planet = {
				limit = {
					is_colony = yes
					is_under_colonization = no
					NOT = {
						has_planet_flag = colony_event
					}
					OR = {
						is_continental_world = yes
						is_ocean_world = yes
					}
				}
				save_event_target_as = turtle_world_divination_planet
			}
		}
		event_target:turtle_world_divination_planet = {
			planet_event = { id = colony.9000 }
		}
	}
}

# Blade of the Huntress
situation_event = {
	id = leviathanexpanded.238
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		NOT = {
			has_situation_flag = divination_occurring
		}
		situation_progress >= 20
		has_ancrel = yes
		NOT = { has_global_flag = arc_hunting_grounds }
		owner = {
			is_ai = no
			any_owned_planet = {
				is_colony = yes
				is_under_colonization = no
				OR = {
					is_dry = yes
					is_wet = yes
					is_cold = yes
				}
				NOT = { exists = archaeological_site }
				NOR = {
					has_planet_flag = colony_event
					has_planet_flag = suppress_archaeological_sites
				}
			}
		}
	}

	immediate = {
		set_situation_flag = divination_occurring
		owner = {
			random_owned_planet = {
				limit = {
					OR = {
						is_dry = yes
						is_wet = yes
						is_cold = yes
					}
					NOT = { exists = archaeological_site }
					NOR = {
						has_planet_flag = colony_event
						has_planet_flag = suppress_archaeological_sites
					}
				}
				save_event_target_as = turtle_world_divination_planet
			}
		}
		event_target:turtle_world_divination_planet = {
			planet_event = { id = ancrel.6049 }
		}
	}
}

# Breathing Rift
situation_event = {
	id = leviathanexpanded.239
	title = enclave.5150.name
	desc = enclave.5150.desc
	picture = GFX_evt_surreal_visions
	show_sound = event_mystic_reveal
	location = event_target:breathing_rift_divination_planet
	situation = this
	is_triggered_only = yes

	trigger = {
		NOT = {
			has_situation_flag = divination_occurring
		}
		situation_progress >= 25
		has_distar = yes
		owner = {
			NOT = {
				has_country_flag = breathing_rift_divination_planet
			}
			any_planet_within_border = {
				OR = {
					is_planet_class = pc_neutron_star
					is_planet_class = pc_pulsar
					is_planet_class = pc_magnetar
					is_planet_class = pc_black_hole
				}
			}
		}
	}

	immediate = {
		set_situation_flag = divination_occurring
		save_event_target_as = breathing_rift_situation
		owner = {
			set_country_flag = breathing_rift_divination_planet
			random_planet_within_border = {
				limit = {
					OR = {
						is_planet_class = pc_neutron_star
						is_planet_class = pc_pulsar
						is_planet_class = pc_magnetar
						is_planet_class = pc_black_hole
					}
				}
				save_event_target_as = breathing_rift_divination_planet
			}
		}
	}

	option = {
		name = UNDERSTOOD
		event_target:breathing_rift_situation = {
			add_situation_progress = 15
		}
		event_target:breathing_rift_divination_planet = {
			add_anomaly = {
				target = root.owner
				category = disco_breathing_rift_cat
			}
		}
	}
}

# Déjà Vu Dig
situation_event = {
	id = leviathanexpanded.240
	title = leviathanexpanded.226.name
	desc = leviathanexpanded.226.desc
	picture = GFX_evt_surreal_visions
	show_sound = event_mystic_reveal
	location = event_target:monoliths_divination_planet
	situation = this
	is_triggered_only = yes

	trigger = {
		NOT = {
			has_situation_flag = divination_occurring
		}
		situation_progress >= 25
		has_ancrel = yes
		NOR = {
			has_global_flag = deja_vu_divination_planet
			any_system = {
				any_system_planet = {
					exists = archaeological_site
					archaeological_site = { is_site_type = site_deja_vu_dig }
				}
			}
		}
		owner = {
			any_owned_planet = {
				is_colony = yes
				is_under_colonization = no
				is_homeworld = no
				is_planet_class = pc_nuked
				NOT = { exists = archaeological_site }
			}
		}
	}

	immediate = {
		set_situation_flag = divination_occurring
		save_event_target_as = deja_vu_situation
		set_global_flag = deja_vu_divination_planet
		owner = {
			random_planet_within_border = {
				limit = {
					is_colony = yes
					is_under_colonization = no
					is_homeworld = no
					is_planet_class = pc_nuked
					NOT = { exists = archaeological_site }
				}
				save_event_target_as = deja_vu_divination_planet
			}
		}
	}

	option = {
		name = UNDERSTOOD
		event_target:deja_vu_situation = {
			add_situation_progress = 20
		}
		event_target:deja_vu_divination_planet = {
			create_archaeological_site = site_deja_vu_dig
		}
	}
}

# Precursor Artifact
situation_event = {
	id = leviathanexpanded.241
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		NOT = {
			has_situation_flag = divination_occurring
		}
		situation_progress >= 20
		has_ancrel = yes
		owner = {
			is_ai = no
			years_passed > 50
			NOR = {
				has_country_flag = new_precursor
				has_country_flag = ongoing_precursor_artifact
			}
			OR = {
				AND = {
					has_event_chain = "vultaum_chain"
					NOT = {
						has_completed_event_chain_counter = {
							event_chain = vultaum_chain
							counter = vultaum_artifacts
						}
					}
					any_system_within_border = {
						has_star_flag = precursor_1
						any_system_planet = {
							NOT = { has_planet_flag = precursor_world }
							uninhabitable_regular_planet = yes
							has_owner = no
							has_anomaly = no
							is_surveyed = {
								who = ROOT
								status = yes
							}
						}
					}
				}
				AND = {
					has_event_chain = "yuht_chain"
					NOT = {
						has_completed_event_chain_counter = {
							event_chain = yuht_chain
							counter = yuht_artifacts
						}
					}
					any_system_within_border = {
						has_star_flag = precursor_2
						any_system_planet = {
							uninhabitable_regular_planet = yes
							NOT = { has_planet_flag = precursor_world }
							has_owner = no
							has_anomaly = no
							is_surveyed = {
								who = ROOT
								status = yes
							}
						}
					}
				}
				AND = {
					has_event_chain = "first_league_chain"
					NOT = {
						has_completed_event_chain_counter = {
							event_chain = first_league_chain
							counter = first_league_artifacts
						}
					}
					any_system_within_border = {
						has_star_flag = precursor_3
						any_system_planet = {
							uninhabitable_regular_planet = yes
							NOT = { has_planet_flag = precursor_world }
							has_owner = no
							has_anomaly = no
							is_surveyed = {
								who = ROOT
								status = yes
							}
						}
					}
				}
				AND = {
					has_event_chain = "irassian_chain"
					NOT = {
						has_completed_event_chain_counter = {
							event_chain = irassian_chain
							counter = irassian_artifacts
						}
					}
					any_system_within_border = {
						has_star_flag = precursor_4
						any_system_planet = {
							uninhabitable_regular_planet = yes
							NOT = { has_planet_flag = precursor_world }
							has_owner = no
							has_anomaly = no
							is_surveyed = {
								who = ROOT
								status = yes
							}
						}
					}
				}
				AND = {
					has_event_chain = "cybrex_chain"
					NOT = {
						has_completed_event_chain_counter = {
							event_chain = cybrex_chain
							counter = cybrex_artifacts
						}
					}
					any_system_within_border = {
						has_star_flag = precursor_5
						any_system_planet = {
							uninhabitable_regular_planet = yes
							NOT = { has_planet_flag = precursor_world }
							has_owner = no
							has_anomaly = no
							is_surveyed = {
								who = ROOT
								status = yes
							}
						}
					}
				}
			}
		}
	}

	immediate = {
		set_situation_flag = divination_occurring
		owner = {
			country_event = { id = precursor.301 }
		}
	}
}

### Modded Added Events ###
# Ancient Robots
situation_event = {
	id = leviathanexpanded.350
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		has_global_flag = mem_more_events_mod
		NOT = { has_global_flag = mem_ancient_robots_fired }
		NOT = {
			has_situation_flag = divination_occurring
		}
		situation_progress >= 20
		owner = {
			is_ai = no
			NOT = { is_gestalt = yes }
			any_owned_planet = {
				is_colony = yes
				is_under_colonization = no
				planet_size > 14
				or = {
					has_deposit = d_mountain_range
					has_deposit = d_tempestous_mountain
					has_deposit = d_rich_mountain
				}
			}
		}
	}

	immediate = {
		set_situation_flag = divination_occurring
		owner = {
			random_owned_planet = {
				limit = {
					is_colony = yes
					is_under_colonization = no
					planet_size > 14
					or = {
						has_deposit = d_mountain_range
						has_deposit = d_tempestous_mountain
						has_deposit = d_rich_mountain
					}
				}
				save_event_target_as = ancient_robot_divination_planet
			}
		}
		event_target:ancient_robot_divination_planet = {
			planet_event = { id = mem_ancient_robots.201 }
		}
	}
}

# Blacksite
situation_event = {
	id = leviathanexpanded.351
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		has_global_flag = mem_more_events_mod
		NOT = { has_global_flag = mem_blacksite_happened }
		NOT = {
			has_situation_flag = divination_occurring
		}
		situation_progress >= 20
		owner = {
			is_ai = no
			NOT = { is_gestalt = yes }
			NOT = { has_country_flag = mem_blacksite_fallen_empire }
			is_at_war = no
			any_country = {
				has_established_contact = prev
				is_country_type = fallen_empire
				OR = {
					has_ethic = ethic_fanatic_materialist
					has_ethic = ethic_fanatic_spiritualist
					has_ethic = ethic_fanatic_xenophile
				}
			}
			any_planet_within_border = {
				OR = {
					is_planet_class = pc_barren
					is_planet_class = pc_barren_cold
					is_planet_class = pc_frozen
					is_planet_class = pc_toxic
				}
				has_owner = no
				has_anomaly = no
				has_deposit = no
				solar_system = {
					NOR = {
						is_bottleneck_system = yes
						any_system_planet = {
							OR = {
								has_owner = yes
								is_colonizable = yes
							}
						}
					}
				}
			}
		}
	}

	immediate = {
		set_situation_flag = divination_occurring
		owner = {
			random_planet_within_border = {
				limit = {
					OR = {
						is_planet_class = pc_barren
						is_planet_class = pc_barren_cold
						is_planet_class = pc_frozen
						is_planet_class = pc_toxic
					}
					has_owner = no
					has_anomaly = no
					has_deposit = no
					solar_system = {
						NOR = {
							is_bottleneck_system = yes
							any_system_planet = {
								OR = {
									has_owner = yes
									is_colonizable = yes
								}
							}
						}
					}
				}
				save_event_target_as = blacksite_planet
				set_planet_flag = mem_blacksite_planet
			}
			random_country = {
				limit = {
					has_established_contact = prev
					is_country_type = fallen_empire
					OR = {
						has_ethic = ethic_fanatic_materialist
						has_ethic = ethic_fanatic_spiritualist
						has_ethic = ethic_fanatic_xenophile
					}
				}
				save_event_target_as = blacksite_fallen_empire
				set_country_flag = mem_blacksite_fallen_empire
			}
			set_country_flag = mem_blacksite_country
			country_event = { id = mem_blacksite.2 }
		}
	}
}

# Charmak
situation_event = {
	id = leviathanexpanded.352
	title = leviathanexpanded.226.name
	desc = leviathanexpanded.226.desc
	picture = GFX_evt_surreal_visions
	show_sound = event_mystic_reveal
	location = event_target:monoliths_divination_planet
	situation = this
	is_triggered_only = yes

	trigger = {
		has_global_flag = mem_more_events_mod
		NOT = {
			has_situation_flag = divination_occurring
		}
		situation_progress >= 25
		has_ancrel = yes
		NOR = {
			has_global_flag = charmak_divination_planet
			any_system = {
				any_system_planet = {
					exists = archaeological_site
					archaeological_site = { is_site_type = mem_charmak_site }
				}
			}
		}
		owner = {
			any_planet_within_border = {
				is_planet_class = pc_gas_giant
				NOT = { exists = archaeological_site }
			}
		}
	}

	immediate = {
		set_situation_flag = divination_occurring
		save_event_target_as = charmak_situation
		set_global_flag = charmak_divination_planet
		owner = {
			random_planet_within_border = {
				limit = {
					is_planet_class = pc_gas_giant
					NOT = { exists = archaeological_site }
				}
				save_event_target_as = charmak_divination_planet
			}
		}
	}

	option = {
		name = UNDERSTOOD
		event_target:charmak_situation = {
			add_situation_progress = 20
		}
		event_target:charmak_divination_planet = {
			create_archaeological_site = mem_charmak_site
		}
	}
}

# Cold Comfort
situation_event = {
	id = leviathanexpanded.353
	title = leviathanexpanded.226.name
	desc = leviathanexpanded.226.desc
	picture = GFX_evt_surreal_visions
	show_sound = event_mystic_reveal
	location = event_target:cold_comfort_divination_planet
	situation = this
	is_triggered_only = yes

	trigger = {
		has_global_flag = mem_more_events_mod
		NOT = {
			has_situation_flag = divination_occurring
		}
		situation_progress >= 20
		has_ancrel = yes
		NOR = {
			has_global_flag = cold_comfort_divination_planet
			any_system = {
				any_system_planet = {
					exists = archaeological_site
					archaeological_site = { is_site_type = mem_cold_dig_site }
				}
			}
		}
		owner = {
			any_planet_within_border = {
				is_planet_class = pc_frozen
				NOT = { exists = archaeological_site }
			}
		}
	}

	immediate = {
		set_situation_flag = divination_occurring
		save_event_target_as = cold_comfort_situation
		set_global_flag = cold_comfort_divination_planet
		owner = {
			random_planet_within_border = {
				limit = {
					is_planet_class = pc_frozen
					NOT = { exists = archaeological_site }
				}
				save_event_target_as = cold_comfort_divination_planet
			}
		}
	}

	option = {
		name = UNDERSTOOD
		event_target:cold_comfort_situation = {
			add_situation_progress = 20
		}
		event_target:cold_comfort_divination_planet = {
			create_archaeological_site = mem_cold_dig_site
		}
	}
}

# Colony Ship
situation_event = {
	id = leviathanexpanded.354
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		has_global_flag = mem_more_events_mod
		NOT = { has_global_flag = mem_colony_ship_started }
		NOT = {
			has_situation_flag = divination_occurring
		}
		situation_progress >= 20
		owner = {
			is_ai = no
			NOT = { is_gestalt = yes }
			NOT = { has_country_flag = mem_colony_ship_rolled }
			is_at_war = no
			any_system_within_border = {
				NOT = {
					any_system_planet = { is_owned_by = root }
				}
				any_system_planet = {
					is_colonizable = yes
					OR = {
						is_planet_class = pc_arid
						is_planet_class = pc_desert
						is_planet_class = pc_savannah
						is_planet_class = pc_continental
						is_planet_class = pc_ocean
						is_planet_class = pc_tropical
						is_planet_class = pc_tundra
						is_planet_class = pc_arctic
						is_planet_class = pc_alpine
					}
					NOR = {
						exists = owner
						has_planet_flag = colony_event
					}
				}
			}
		}
	}

	immediate = {
		set_situation_flag = divination_occurring
		owner = {
			country_event = { id = mem_colony_ship.2 }
		}
	}
}

# Eager Merchants
situation_event = {
	id = leviathanexpanded.355
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		has_global_flag = mem_more_events_mod
		NOT = {
			has_situation_flag = divination_occurring
		}
		situation_progress >= 10
		owner = {
			is_ai = no
			NOT = { is_gestalt = yes }
			OR = {
				AND = {
					NOT = { has_country_flag = mem_eager_traders_happened1 }
					any_neighbor_country = {
						has_ai_personality = ruthless_capitalists
						NOT = { 
							has_country_flag = mem_ruthless_capitalist_met_player
						}
						has_communications = prev
					}
				}
				AND = {
					NOT = { has_country_flag = mem_eager_traders_happened2 }
					any_neighbor_country = {
						has_ai_personality = peaceful_traders
						NOT = {
							has_country_flag = mem_peaceful_traders_met_player
						} 
						has_communications = prev
					}
				}
			}
		}
	}

	immediate = {
		set_situation_flag = divination_occurring
		owner = {
			if = {
				limit = {
					NOT = { has_country_flag = mem_eager_traders_happened1 }
					any_neighbor_country = {
						has_ai_personality = ruthless_capitalists
						NOT = { 
							has_country_flag = mem_ruthless_capitalist_met_player
						}
						has_communications = prev
					}
				}
				random_list = {
					4 = { country_event = { id = mem_eager_traders.1 days = 10 random = 5 } }
					3 = { country_event = { id = mem_eager_traders.7 days = 10 random = 5 } }
				}					
			}
			
			else_if = {
				limit = {
					NOT = { has_country_flag = mem_eager_traders_happened2 }
					any_neighbor_country = {
						has_ai_personality = peaceful_traders
						NOT = {
							has_country_flag = mem_peaceful_traders_met_player
						} 
						has_communications = prev
					}
				}
				random_list = {
					4 = { country_event = { id = mem_eager_traders.5 days = 10 random = 5 } }
					3 = { country_event = { id = mem_eager_traders.8 days = 10 random = 5 } }
				}
			}
		}
	}
}

# Elusive Carcosa
situation_event = {
	id = leviathanexpanded.356
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		has_global_flag = mem_more_events_mod
		NOT = { has_global_flag = mem_elusive_carcosa }
		NOT = {
			has_situation_flag = divination_occurring
		}
		situation_progress >= 25
		owner = {
			is_ai = no
			NOR = {
				is_hive_empire = yes
				is_machine_empire = yes
			}
			num_owned_planets > 4
		}
	}

	immediate = {
		set_situation_flag = divination_occurring
		owner = {
			random_owned_planet = {
				limit = {
					is_colony = yes
					is_capital = no
				}
				save_global_event_target_as = mem_carcosa_colony
			}
			set_global_flag = mem_elusive_carcosa
			country_event = { id = mem_elusive_carcosa.11 days = 20 } 
		}
	}
}

# A Stellar Performance
situation_event = {
	id = leviathanexpanded.357
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		has_global_flag = mem_more_events_mod
		NOT = {
			has_situation_flag = divination_occurring
		}
		situation_progress >= 10
		owner = {
			NOT = {
				is_gestalt = yes
			}
			any_neighbor_country = {
				OR = {
					has_ethic = ethic_egalitarian
					has_ethic = ethic_fanatic_egalitarian
				}
				NOT = {
					has_country_flag = mem_sent_rockstar_to_player    #countries stop sending rockstars once they've sent one to a player
				}
				has_established_contact = root
			}
		}
	}

	immediate = {
		set_situation_flag = divination_occurring
		owner = {
			country_event = { id = mem_music_tour.7 }
		}
	}
}

# Extinct Abductors
situation_event = {
	id = leviathanexpanded.358
	title = leviathanexpanded.226.name
	desc = leviathanexpanded.226.desc
	picture = GFX_evt_surreal_visions
	show_sound = event_mystic_reveal
	location = event_target:ea_uplifter_divination_planet
	situation = this
	is_triggered_only = yes

	trigger = {
		has_global_flag = mem_more_events_mod
		NOT = { has_global_flag = mem_ea_uplifter_quest_started }
		NOT = { owner = { has_origin = origin_broken_shackles } }
		NOT = {
			has_situation_flag = divination_occurring
		}
		situation_progress >= 20
		owner = {
			NOT = { has_country_flag = mem_lotc_finder }
			any_planet_within_border = {
				or = {
					is_planet_class = pc_barren
					is_planet_class = pc_barren_cold
					is_planet_class = pc_frozen
				}
				exists = sector
				sector = {
					any_system_within_border = {
						is_capital_system = yes
					}
				}
			}
		}
	}

	immediate = {
		set_situation_flag = divination_occurring
		save_event_target_as = ea_uplifter_situation
		owner = {
			set_country_flag = ea_uplifter_divination_planet
			random_planet_within_border = {
				limit = {
					or = {
						is_planet_class = pc_barren
						is_planet_class = pc_barren_cold
						is_planet_class = pc_frozen
					}
					exists = sector
					sector = {
						any_system_within_border = {
							is_capital_system = yes
						}
					}
				}
				save_event_target_as = ea_uplifter_divination_planet
			}
		}
	}

	option = {
		name = UNDERSTOOD
		event_target:ea_uplifter_situation = {
			add_situation_progress = 20
		}
		event_target:ea_uplifter_divination_planet = {
			add_anomaly = {
				target = root.owner
				category = mem_extinct_abductors_category
			}
		}
	}
}

# Gaia Troubles
situation_event = {
	id = leviathanexpanded.359
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		has_global_flag = mem_more_events_mod
		NOT = { has_global_flag = gaia_troubles_global }
		NOT = {
			has_situation_flag = divination_occurring
		}
		situation_progress >= 10
		owner = {
			is_ai = no
			is_at_war = no
			NOT = { has_country_flag = gaia_troubles_country }
			NOT = { is_gestalt = yes }
			any_owned_planet = {
				is_colony = yes
				is_homeworld = no
				is_planet_class = pc_gaia
				colony_age > 120
				NOT = { has_planet_flag = colony_event }
				NOT = { has_planet_flag = gaia_troubles_planet }
				NOT = { has_global_flag = gaia_troubles_done }
			}
		}
	}

	immediate = {
		set_situation_flag = divination_occurring
		owner = {
			random_owned_planet = {
				limit = {
					is_colony = yes
					is_homeworld = no
					is_planet_class = pc_gaia
					colony_age > 120
					NOT = { has_planet_flag = colony_event }
					NOT = { has_planet_flag = gaia_troubles_planet }
					NOT = { has_global_flag = gaia_troubles_done }
				}
				planet_event = { id = mem_gaia_troubles.2 }
			}
		}
	}
}

# Strange Signal
situation_event = {
	id = leviathanexpanded.360
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		has_global_flag = mem_more_events_mod
		NOT = { has_global_flag = mem_hithere_happened }
		NOT = {
			has_situation_flag = divination_occurring
		}
		situation_progress >= 15
		owner = {
			is_ai = no
		}
	}

	immediate = {
		set_situation_flag = divination_occurring
		set_global_flag = mem_hithere_happened
		owner = {
			set_country_flag = mem_hithere_country
			random_owned_planet = {
				save_event_target_as = receiver
			}
			country_event = { id = mem_hithere.1 }
		}
	}
}

# Lunar Gate
situation_event = {
	id = leviathanexpanded.361
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		has_global_flag = mem_more_events_mod
		NOT = { has_global_flag = mem_lunar_gate_happened }
		NOT = {
			has_situation_flag = divination_occurring
		}
		situation_progress >= 20
		owner = {
			NOT = { is_gestalt = yes }
			NOT = {
				has_country_flag = mem_lunar_gate
			}
			any_owned_planet = {
				is_colony = yes
				NOR = {
					has_planet_flag = mem_lunar_gate_checked
					has_planet_flag = colony_event
					has_global_flag = mem_lunar_gate_happened
				}
				
				num_pops > 15
				is_homeworld = no
				is_moon = no
				has_moon = yes
				any_moon = {
					uninhabitable_regular_planet = yes
				}
			}
		}
	}

	immediate = {
		set_situation_flag = divination_occurring
		owner = {
			set_country_flag = mem_lunar_gate
			random_owned_planet = {
				limit = {
					is_colony = yes
					NOR = {
						has_planet_flag = mem_lunar_gate_checked
						has_planet_flag = colony_event
						has_global_flag = mem_lunar_gate_happened
					}
					
					num_pops > 15
					is_homeworld = no
					is_moon = no
					has_moon = yes
					any_moon = {
						uninhabitable_regular_planet = yes
					}
				}
				set_planet_flag = mem_lunar_gate_checked
				planet_event = { id = mem_lunar_gate.2 }
			}
		}
	}
}

# Outsiders
situation_event = {
	id = leviathanexpanded.362
	title = leviathanexpanded.226.name
	desc = leviathanexpanded.226.desc
	picture = GFX_evt_surreal_visions
	show_sound = event_mystic_reveal
	location = event_target:outsiders_divination_planet
	situation = this
	is_triggered_only = yes

	trigger = {
		has_global_flag = mem_more_events_mod
		NOT = {
			has_situation_flag = divination_occurring
		}
		situation_progress >= 20
		has_ancrel = yes
		NOR = {
			has_global_flag = outsiders_divination_planet
			any_system = {
				any_system_planet = {
					exists = archaeological_site
					archaeological_site = { is_site_type = mem_outsiders_dig_site }
				}
			}
		}
		owner = {
			any_owned_planet = {
				OR = {
					is_planet_class = pc_barren
					is_planet_class = pc_barren_cold
				}
				NOR = {
					has_deposit_for = shipclass_mining_station
					has_deposit_for = shipclass_research_station
				}
				NOT = { exists = archaeological_site }
			}
		}
	}

	immediate = {
		set_situation_flag = divination_occurring
		save_event_target_as = outsiders_situation
		set_global_flag = outsiders_divination_planet
		owner = {
			random_planet_within_border = {
				limit = {
					OR = {
						is_planet_class = pc_barren
						is_planet_class = pc_barren_cold
					}
					NOR = {
						has_deposit_for = shipclass_mining_station
						has_deposit_for = shipclass_research_station
					}
					NOT = { exists = archaeological_site }
				}
				save_event_target_as = outsiders_divination_planet
			}
		}
	}

	option = {
		name = UNDERSTOOD
		event_target:outsiders_situation = {
			add_situation_progress = 20
		}
		event_target:outsiders_divination_planet = {
			create_archaeological_site = mem_outsiders_dig_site
		}
	}
}

# Synthetic Sun
situation_event = {
	id = leviathanexpanded.363
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		has_global_flag = mem_more_events_mod
		NOT = { has_global_flag = mem_synthetic_sun }
		NOT = {
			has_situation_flag = divination_occurring
		}
		situation_progress >= 35
		owner = {
			is_ai = no
			any_owned_planet = {
				is_colony = yes
				NOT = { has_planet_flag = colony_event }
				is_capital = no
				has_moon = yes
				NOT = {
					any_moon = { has_owner = yes }
				}
				any_moon = {
					OR = {
						is_planet_class = pc_barren
						is_planet_class = pc_barren_cold
					}
				}
				OR = {
					is_wet = yes
					is_dry = yes
					is_cold = yes
				}
			}
		}
	}

	immediate = {
		set_situation_flag = divination_occurring
		set_global_flag = mem_synthetic_sun
		owner = {
			random_owned_planet = {
				limit = {
					is_colony = yes
					NOT = { has_planet_flag = colony_event }
					is_capital = no
					has_moon = yes
					NOT = {
						any_moon = { has_owner = yes }
					}
					any_moon = {
						OR = {
							is_planet_class = pc_barren
							is_planet_class = pc_barren_cold
						}
					}
					OR = {
						is_wet = yes
						is_dry = yes
						is_cold = yes
					}
				}
				set_planet_flag = colony_event
				planet_event = { id = mem_synthetic_sun.1 }
			}
		}
	}
}

# Shakespeare
situation_event = {
	id = leviathanexpanded.364
	title = enclave.5150.name
	desc = enclave.5150.desc
	picture = GFX_evt_surreal_visions
	show_sound = event_mystic_reveal
	location = event_target:strange_divination_planet
	situation = this
	is_triggered_only = yes

	trigger = {
		NOT = {
			has_situation_flag = divination_occurring
		}
		situation_progress >= 15
		owner = {
			NOT = { is_gestalt = yes }
			NOT = { years_passed = 300 } #year minus 600 must be pre-1900
			NOT = {
				has_country_flag = strange_divination_planet
			}
			any_planet_within_border = {
				OR = {
					is_planet_class = pc_barren
					is_planet_class = pc_barren_cold
				}
				has_any_strategic_resource = no
			}
		}
	}

	immediate = {
		set_situation_flag = divination_occurring
		save_event_target_as = friendly_situation
		owner = {
			set_country_flag = strange_divination_planet
			random_planet_within_border = {
				limit = {
					OR = {
						is_planet_class = pc_barren
						is_planet_class = pc_barren_cold
					}
					has_any_strategic_resource = no
				}
				save_event_target_as = strange_divination_planet
			}
		}
	}

	option = {
		name = UNDERSTOOD
		event_target:friendly_situation = {
			add_situation_progress = 20
		}
		event_target:strange_divination_planet = {
			add_anomaly = {
				target = root.owner
				category = strange_signal_category
			}
		}
	}
}

# Mask of Transformation
situation_event = {
	id = leviathanexpanded.365
	title = leviathanexpanded.226.name
	desc = leviathanexpanded.226.desc
	picture = GFX_evt_surreal_visions
	show_sound = event_mystic_reveal
	location = event_target:mask_divination_planet
	situation = this
	is_triggered_only = yes

	trigger = {
		NOT = {
			has_situation_flag = divination_occurring
		}
		situation_progress >= 30
		NOR = {
			has_global_flag = mask_divination_planet
			any_system = {
				any_system_planet = {
					exists = archaeological_site
					archaeological_site = { is_site_type = site_transformation_dig }
				}
			}
		}
		owner = {
			any_owned_planet = {
				is_planet_class = pc_tropical
				has_moon = yes
				NOT = { exists = archaeological_site }
			}
		}
	}

	immediate = {
		set_situation_flag = divination_occurring
		save_event_target_as = outsiders_situation
		set_global_flag = mask_divination_planet
		owner = {
			random_planet_within_border = {
				limit = {
					is_planet_class = pc_tropical
					has_moon = yes
					NOT = { exists = archaeological_site }
				}
				save_event_target_as = mask_divination_planet
			}
		}
	}

	option = {
		name = UNDERSTOOD
		event_target:outsiders_situation = {
			add_situation_progress = 30
		}
		event_target:mask_divination_planet = {
			create_archaeological_site = site_transformation_dig
		}
	}
}

# Under the Ice
situation_event = {
	id = leviathanexpanded.366
	title = leviathanexpanded.226.name
	desc = leviathanexpanded.226.desc
	picture = GFX_evt_surreal_visions
	show_sound = event_mystic_reveal
	location = event_target:ice_divination_planet
	situation = this
	is_triggered_only = yes

	trigger = {
		NOT = {
			has_situation_flag = divination_occurring
		}
		situation_progress >= 20
		NOR = {
			has_global_flag = ice_divination_planet
			any_system = {
				any_system_planet = {
					exists = archaeological_site
					archaeological_site = { is_site_type = site_ice_trauma }
				}
			}
		}
		owner = {
			any_owned_planet = {
				is_planet_class = pc_frozen
				NOT = { exists = archaeological_site }
			}
		}
	}

	immediate = {
		set_situation_flag = divination_occurring
		save_event_target_as = outsiders_situation
		set_global_flag = ice_divination_planet
		owner = {
			random_planet_within_border = {
				limit = {
					is_planet_class = pc_frozen
					NOT = { exists = archaeological_site }
				}
				save_event_target_as = ice_divination_planet
			}
		}
	}

	option = {
		name = UNDERSTOOD
		event_target:outsiders_situation = {
			add_situation_progress = 20
		}
		event_target:ice_divination_planet = {
			create_archaeological_site = site_ice_trauma
		}
	}
}

# Engineered Species
situation_event = {
	id = leviathanexpanded.367
	title = leviathanexpanded.226.name
	desc = leviathanexpanded.226.desc
	picture = GFX_evt_surreal_visions
	show_sound = event_mystic_reveal
	location = event_target:gene_divination_planet
	situation = this
	is_triggered_only = yes

	trigger = {
		NOT = {
			has_situation_flag = divination_occurring
		}
		situation_progress >= 20
		NOR = {
			has_global_flag = gene_divination_planet
			any_system = {
				any_system_planet = {
					exists = archaeological_site
					archaeological_site = { is_site_type = site_engineered_species }
				}
			}
		}
		owner = {
			any_owned_planet = {
				habitable_planet = yes
				NOT = { exists = archaeological_site }
			}
		}
	}

	immediate = {
		set_situation_flag = divination_occurring
		save_event_target_as = outsiders_situation
		set_global_flag = gene_divination_planet
		owner = {
			random_planet_within_border = {
				limit = {
					habitable_planet = yes
					NOT = { exists = archaeological_site }
				}
				save_event_target_as = gene_divination_planet
			}
		}
	}

	option = {
		name = UNDERSTOOD
		event_target:outsiders_situation = {
			add_situation_progress = 20
		}
		event_target:gene_divination_planet = {
			create_archaeological_site = site_engineered_species
		}
	}
}

#Hidden Event to make sure at least one Worm event is selected for per Divination
situation_event = {
	id = leviathanexpanded.399
	hide_window = yes

	is_triggered_only = yes

	trigger = {
		situation_progress >= 90
		NOT = {
			has_situation_flag = divination_occurring
		}
	}

	immediate = {
		fire_on_action = {
			on_action = on_shroudwalker_divination_worm_situation
		}
	}
}