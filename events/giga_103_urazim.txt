namespace = ehof_mega_trader

country_event = {
	id = ehof_mega_trader.100
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		if = {
			limit = { NOT = { exists = event_target:current_system_creator } }
			random_country = {
				limit = { ehof_default_country = yes }
				save_global_event_target_as = current_system_creator
			}
		}

		set_global_flag = ehof_spawning_qnm_traders
		set_global_flag = ehof_traders_spawned

		create_species = {
			name = "NAME_ehof_trader_species"
			class = random_non_machine
			immortal = yes
			portrait = random
			traits = random
			effect = { save_global_event_target_as = ehof_trader_species }
		}
		create_country = {
			name = "NAME_ehof_traders"
			type = ehof_traders
			species = event_target:ehof_trader_species
			authority = auth_corporate
			civics = { civic = civic_free_traders }
			ethos = {
				ethic = ethic_egalitarian
				ethic = ethic_pacifist
				ethic = ethic_xenophile
			}
			ignore_initial_colony_error = yes
			origin = "origin_default"
			flag = {
				icon = {
					category = "special"
					file = "caravaneer_03.dds"
				}
				background = {
					category = "backgrounds"
					file = "00_solid.dds"
				}
				colors = {
					"black"
					"beige"
					"null"
					"null"
				}
			}
			effect = { save_global_event_target_as = urmazin_country }
		}
		last_created_country = {
			create_leader = {
				class = ruler
				species = event_target:ehof_trader_species
				name = "NAME_ehof_trader_ruler"
				immortal = yes
				effect = { save_event_target_as = ehof_trader_ruler }
			}
			set_leader = event_target:ehof_trader_ruler
			set_graphical_culture = caravaneer_01
			set_country_flag = day_0
			set_country_flag = ehof_trader_empire
			create_ship_design = { design = "NAME_Caravaneer_Starbase" } add_ship_design = last_created_design
		}

		set_spawn_system_batch = begin
		if = {		limit = { galaxy_size = huge }   no_scope = { spawn_system = { min_distance >= 490 max_distance <= 500 hyperlane = no initializer = "urmazin_system_1" } } }
		else_if = {	limit = { galaxy_size = large }  no_scope = { spawn_system = { min_distance >= 465 max_distance <= 475 hyperlane = no initializer = "urmazin_system_1" } } }
		else_if = {	limit = { galaxy_size = medium } no_scope = { spawn_system = { min_distance >= 440 max_distance <= 450 hyperlane = no initializer = "urmazin_system_1" } } }
		else_if = {	limit = { galaxy_size = small }  no_scope = { spawn_system = { min_distance >= 340 max_distance <= 350 hyperlane = no initializer = "urmazin_system_1" } } }
		else_if = {	limit = { galaxy_size = tiny }   no_scope = { spawn_system = { min_distance >= 240 max_distance <= 250 hyperlane = no initializer = "urmazin_system_1" } } }
		else = {									 no_scope = { spawn_system = { min_distance >= 490 max_distance <= 500 hyperlane = no initializer = "urmazin_system_1" } } }
		last_created_system = {
			spawn_system = {
				hyperlane = no
				is_discovered = yes
				min_distance >= 5
				max_distance <= 30
				initializer = "urmazin_system_2"
			}
		}
		set_spawn_system_batch = end

		event_target:urmazin_system_01 = {
			spawn_megastructure = {
				type = "ehof_trader_wormhole_01"
				orbit_angle = 200
				orbit_distance = 250
				owner = event_target:urmazin_country
			}
		}

		event_target:urmazin_capital = {
			spawn_megastructure = {
				type = "ehof_trader_wormhole_01"
				orbit_angle = 56
				orbit_distance = 250
				owner = event_target:urmazin_country
			}

			while = {
				count = 5
				create_fleet = {
					name = "NAME_Hauler"
					settings = { spawn_debris = no }
					effect = {
						set_fleet_stance = passive
						set_formation_scale = 2.5
						set_owner = event_target:urmazin_country
						create_ship = {
							name = "NAME_Hauler"
							design = NAME_Schooner
						}
						set_location = {
							target = event_target:urmazin_capital.star
							angle = 90
							distance = 40
						}

						# Set location
						random_system = {
							limit = { urmazin_system = yes }
							random_system_planet = { save_event_target_as = ehof_hauler }
						}

						# Move to location
						auto_move_to_planet = {
							target = event_target:ehof_hauler
							clear_auto_move_on_arrival = no
							arrival_effect = urmazin_to_another_planet
						}
					}
				}
			}
		}

		every_system = {
			limit = { urmazin_system = yes }
			create_starbase = { size = "starbase_caravaneer" owner = event_target:urmazin_country }

			# Create mining stations
			every_system_planet = {
				limit = {
					has_deposit_for = shipclass_mining_station
					has_mining_station = no
				}
				if = {
					limit = {
						NOR = {
							AND = {
								is_planet_class = pc_black_hole
								solar_system = { has_megastructure = matter_decompressor_4 }
							}
							AND = {
								is_star = yes
								solar_system = { has_megastructure = dyson_sphere_5 }
							}
						}
					}
					create_mining_station = { owner = event_target:urmazin_country }
				}
			}

			# Create research stations
			every_system_planet = {
				limit = {
					has_deposit_for = shipclass_research_station
					has_research_station = no
				}
				if = {
					limit = {
						NOR = {
							AND = {
								is_planet_class = pc_black_hole
								solar_system = { has_megastructure = matter_decompressor_4 }
							}
							AND = {
								is_star = yes
								solar_system = { has_megastructure = dyson_sphere_5 }
							}
						}
					}
					create_research_station = { owner = event_target:urmazin_country }
				}
			}
		}

		every_country = {
			limit = { ehof_default_country = yes }
			establish_communications_no_message = event_target:urmazin_country
		}

		remove_global_flag = ehof_spawning_qnm_traders
	}
}

# Move haulers
fleet_event = {
	id = ehof_mega_trader.1001
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		# Set location
		random_system = {
			limit = { urmazin_system = yes }
			random_system_planet = { save_event_target_as = ehof_hauler }
		}

		# Move to location
		auto_move_to_planet = {
			target = event_target:ehof_hauler
			clear_auto_move_on_arrival = no
			arrival_effect = urmazin_to_another_planet
		}
	}
}

# Check if first time
fleet_event = {
	id = ehof_mega_trader.001
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		exists = solar_system
		solar_system = { urmazin_capital = yes }
		exists = event_target:urmazin_capital
		owner = { NOT = { has_country_flag = ehof_trader_already_triggered } }
	}

	immediate = {
		owner = { set_timed_country_flag = { flag = ehof_trader_already_triggered days = @ehof_short_cooldown } } # Dont trigger more than once (Multiple fleets)

		# First time
		if = {
			limit = { owner = { NOT = { has_country_flag = ehof_traders_first_time } } }
			owner = { set_country_flag = ehof_traders_first_time }
			fleet_event = { id = ehof_mega_trader.002 }
		}

		# Every other time
		else = { owner = { country_event = { id = ehof_mega_trader.006 } } }
	}
}

# Entering trader system first time [on_entering_system_fleet]
fleet_event = {
	id = ehof_mega_trader.002
	title = "ehof_mega_trader.002.name"
	desc = "ehof_mega_trader.002.desc"
	picture = GFX_evt_caravaneers
	show_sound = event_finding_loot
	location = from
	is_triggered_only = yes

	option = {
		default_hide_option = yes
		name = "ehof_mega_trader.002.a"
		hidden_effect = { fleet_event = { id = ehof_mega_trader.003 } }
	}
}

fleet_event = {
	id = ehof_mega_trader.003
	title = "ehof_mega_trader.002.name"
	desc = "ehof_mega_trader.003.desc"
	diplomatic = yes
	custom_gui = "enclave_ehof_trader_window"
	is_triggered_only = yes
	picture_event_data = {
		portrait = event_target:urmazin_country
		graphical_culture = event_target:urmazin_country
		room = "shroud2_room"
	}
	location = event_target:urmazin_capital

	option = {
		custom_gui = "enclave_ehof_trader_option"
		default_hide_option = yes
		name = "ehof_mega_trader.003.a"
		hidden_effect = { fleet_event = { id = ehof_mega_trader.004 } }
	}
}

fleet_event = {
	id = ehof_mega_trader.004
	title = "ehof_mega_trader.002.name"
	desc = "ehof_mega_trader.004.desc"
	diplomatic = yes
	custom_gui = "enclave_ehof_trader_window"
	is_triggered_only = yes
	picture_event_data = {
		portrait = event_target:urmazin_country
		graphical_culture = event_target:urmazin_country
		room = "shroud2_room"
	}
	location = event_target:urmazin_capital

	option = {
		custom_gui = "enclave_ehof_trader_option"
		default_hide_option = yes
		name = "ehof_mega_trader.004.a"
		hidden_effect = { fleet_event = { id = ehof_mega_trader.005 } }
	}
}

fleet_event = {
	id = ehof_mega_trader.005
	title = "ehof_mega_trader.002.name"
	desc = "ehof_mega_trader.005.desc"
	diplomatic = yes
	custom_gui = "enclave_ehof_trader_window"
	is_triggered_only = yes
	picture_event_data = {
		portrait = event_target:urmazin_country
		graphical_culture = event_target:urmazin_country
		room = "shroud2_room"
	}
	location = event_target:urmazin_capital

	option = {
		custom_gui = "enclave_ehof_trader_option"
		default_hide_option = yes
		name = "ehof_mega_trader.005.a"
		hidden_effect = { owner = { country_event = { id = ehof_mega_trader.006 } } }
	}
}

# Main Menu
country_event = {
	id = ehof_mega_trader.006
	title = "ehof_mega_trader.002.name"
	desc = "ehof_mega_trader.006.desc"
	diplomatic = yes
	custom_gui = "enclave_ehof_trader_window"
	is_triggered_only = yes
	picture_event_data = {
		portrait = event_target:urmazin_country
		graphical_culture = event_target:urmazin_country
		room = "shroud2_room"
	}
	location = event_target:urmazin_capital

	trigger = {
		NOR = {
			has_country_flag = ehof_trader_diplomacy
			has_global_flag = compound_invasion_ongoing
		}
		has_country_flag = ehof_traders_first_time
	}
	immediate = { set_country_flag = ehof_trader_diplomacy }

	option = {	# Trade
		custom_gui = "enclave_ehof_trader_option"
		name = "ehof_mega_trader.006.a"
		hidden_effect = {
			remove_country_flag = ehof_trader_diplomacy
			country_event = { id = ehof_mega_trader.101 }
		}
	}

	option = {	# Tell us more about you
		custom_gui = "enclave_ehof_trader_option"
		name = "ehof_mega_trader.006.b"
		hidden_effect = { country_event = { id = ehof_mega_trader.010 } }
	}

	option = {	# Why are these so many wormholes in this system?
		custom_gui = "enclave_ehof_trader_option"
		name = "ehof_mega_trader.006.c"
		is_dialog_only = yes
		response_text = "ehof_mega_trader.006.c.response"
	}

	option = {	# What do you know about Quasi-negative mass?
		custom_gui = "enclave_ehof_trader_option"
		name = "ehof_mega_trader.006.d"
		is_dialog_only = yes
		response_text = "ehof_mega_trader.006.d.response"
	}

	option = {	# Leave
		custom_gui = "enclave_ehof_trader_option"
		default_hide_option = yes
		name = "ehof_reply_endcomms"
		hidden_effect = { remove_country_flag = ehof_trader_diplomacy }
	}
}

# Custom Diplomacy
country_event = {
	id = ehof_mega_trader.007
	title = "ehof_mega_trader.002.name"
	desc = "ehof_mega_trader.006.desc"
	diplomatic = yes
	custom_gui = "enclave_ehof_trader_window"
	is_triggered_only = yes
	picture_event_data = {
		portrait = event_target:urmazin_country
		graphical_culture = event_target:urmazin_country
		room = "shroud2_room"
	}
	location = event_target:urmazin_capital

	trigger = {
		from = { is_country_type = ehof_traders }
		NOR = {
			has_country_flag = ehof_trader_diplomacy
			has_global_flag = compound_invasion_ongoing
		}
		has_country_flag = ehof_traders_first_time
	}
	immediate = { set_country_flag = ehof_trader_diplomacy }

	option = {	# Trade
		custom_gui = "enclave_ehof_trader_option"
		name = "ehof_mega_trader.006.a"
		hidden_effect = {
			remove_country_flag = ehof_trader_diplomacy
			country_event = { id = ehof_mega_trader.101 }
		}
	}

	option = {	# Tell us more about you
		custom_gui = "enclave_ehof_trader_option"
		name = "ehof_mega_trader.006.b"
		hidden_effect = { country_event = { id = ehof_mega_trader.010 } }
	}

	option = {	# Why are these so many wormholes in this system?
		custom_gui = "enclave_ehof_trader_option"
		name = "ehof_mega_trader.006.c"
		is_dialog_only = yes
		response_text = "ehof_mega_trader.006.c.response"
	}

	option = {	# What do you know about Quasi-negative mass?
		custom_gui = "enclave_ehof_trader_option"
		name = "ehof_mega_trader.006.d"
		is_dialog_only = yes
		response_text = "ehof_mega_trader.006.d.response"
	}

	option = {	# Leave
		custom_gui = "enclave_ehof_trader_option"
		default_hide_option = yes
		name = "ehof_reply_endcomms"
		hidden_effect = { remove_country_flag = ehof_trader_diplomacy }
	}
}

# Bit of history
country_event = {
	id = ehof_mega_trader.010
	title = "ehof_mega_trader.002.name"
	desc = "ehof_mega_trader.007.desc"
	diplomatic = yes
	custom_gui = "enclave_ehof_trader_window"
	is_triggered_only = yes
	picture_event_data = {
		portrait = event_target:urmazin_country
		graphical_culture = event_target:urmazin_country
		room = "shroud2_room"
	}
	location = event_target:urmazin_capital

	option = {	# Who are you?
		custom_gui = "enclave_ehof_trader_option"
		name = "ehof_mega_trader.007.a"
		is_dialog_only = yes
		response_text = "ehof_mega_trader.007.a.response"
	}

	option = {	# What is your history?
		custom_gui = "enclave_ehof_trader_option"
		name = "ehof_mega_trader.007.b"
		hidden_effect = { country_event = { id = ehof_mega_trader.011 } }
	}

	option = {	# What is the Dreamer and the Threshold?
		custom_gui = "enclave_ehof_trader_option"
		name = "ehof_mega_trader.007.c"
		is_dialog_only = yes
		response_text = "ehof_mega_trader.007.c.response"
	}

	option = {	# Go back
		custom_gui = "enclave_ehof_trader_option"
		default_hide_option = yes
		name = "ehof_goback"
		hidden_effect = {
			remove_country_flag = ehof_trader_diplomacy
			country_event = { id = ehof_mega_trader.006 }
		}
	}
}

# Continue chatting
country_event = {
	id = ehof_mega_trader.011
	title = "ehof_mega_trader.002.name"
	desc = "ehof_mega_trader.007.b.response"
	diplomatic = yes
	custom_gui = "enclave_ehof_trader_window"
	is_triggered_only = yes
	picture_event_data = {
		portrait = event_target:urmazin_country
		graphical_culture = event_target:urmazin_country
		room = "shroud2_room"
	}
	location = event_target:urmazin_capital

	option = {	# Continue
		custom_gui = "enclave_ehof_trader_option"
		name = "ehof_mega_trader.007.continue"
		is_dialog_only = yes
		response_text = "ehof_mega_trader.007.b.response.b"
	}

	option = {	# Go back
		custom_gui = "enclave_ehof_trader_option"
		default_hide_option = yes
		name = "ehof_goback"
		hidden_effect = { country_event = { id = ehof_mega_trader.010 } }
	}
}

# Notification, No military allowed
fleet_event = {
	id = ehof_mega_trader.008
	title = "ehof_mega_trader.002.name"
	desc = "ehof_mega_trader.008.desc"
	diplomatic = yes
	custom_gui = "enclave_ehof_trader_window"
	is_triggered_only = yes
	picture_event_data = {
		portrait = event_target:urmazin_country
		graphical_culture = event_target:urmazin_country
		room = "shroud2_room"
	}
	location = event_target:urmazin_capital

	trigger = { NOT = { owner = { has_country_flag = ehof_trader_no_military } } }
	immediate = { owner = { set_country_flag = ehof_trader_no_military } }

	option = {
		custom_gui = "enclave_ehof_trader_option"
		default_hide_option = yes
		name = OK
	}
}

# Stock Refreshed
country_event = {
	id = ehof_mega_trader.012
	title = "ehof_mega_trader.002.name"
	desc = "ehof_mega_trader.012.desc"
	diplomatic = yes
	custom_gui = "enclave_ehof_trader_window"
	is_triggered_only = yes
	picture_event_data = {
		portrait = event_target:urmazin_country
		graphical_culture = event_target:urmazin_country
		room = "shroud2_room"
	}
	location = event_target:urmazin_capital

	trigger = { NOT = { has_global_flag = compound_invasion_ongoing } }

	option = {	# Trade
		custom_gui = "enclave_ehof_trader_option"
		name = "ehof_mega_trader.006.a"
		hidden_effect = { country_event = { id = ehof_mega_trader.101 } }
	}

	option = {
		custom_gui = "enclave_ehof_trader_option"
		default_hide_option = yes
		name = "ehof_reply_endcomms"
	}
}

# The compound is here
country_event = {
	id = ehof_mega_trader.013
	title = "ehof_mega_trader.002.name"
	desc = "ehof_mega_trader.013.desc"
	diplomatic = yes
	custom_gui = "enclave_ehof_trader_window"
	is_triggered_only = yes
	picture_event_data = {
		portrait = event_target:urmazin_country
		graphical_culture = event_target:urmazin_country
		room = "shroud2_room"
	}
	location = event_target:urmazin_capital

	immediate = {
		random_system_within_border = {
			limit = { has_an_active_ehof = yes }
			star = { save_event_target_as = ehof_trader_evict_fleet }
		}
		every_owned_fleet = {
			limit = { solar_system = { urmazin_system = yes } }

			remove_auto_move_target = yes
			auto_move_to_planet = {
				target = event_target:ehof_trader_evict_fleet
				clear_auto_move_on_arrival = no
			}
		}
	}

	option = {
		custom_gui = "enclave_ehof_trader_option"
		default_hide_option = yes
		name = "ehof_mega_trader.013.response"
	}
}

# The compound are gone
country_event = {
	id = ehof_mega_trader.014
	title = "ehof_mega_trader.002.name"
	desc = "ehof_mega_trader.014.desc"
	diplomatic = yes
	custom_gui = "enclave_ehof_trader_window"
	is_triggered_only = yes
	picture_event_data = {
		portrait = event_target:urmazin_country
		graphical_culture = event_target:urmazin_country
		room = "shroud2_room"
	}
	location = event_target:urmazin_capital

	option = {
		custom_gui = "enclave_ehof_trader_option"
		default_hide_option = yes
		name = EXCELLENT
	}
}

country_event = {
	id = ehof_mega_trader.101
	title = "ehof_mega_trader.002.name"
	diplomatic = yes
	custom_gui = "enclave_ehof_trader_window"
	is_triggered_only = yes
	picture_event_data = {
		portrait = event_target:urmazin_country
		graphical_culture = event_target:urmazin_country
		room = "shroud2_room"
	}
	location = event_target:urmazin_capital
	desc = { trigger = { has_country_flag = ehof_just_bought_dragon_trophy }		text = "ehof_trader_bought_dragon_trophy" }
	desc = { trigger = { has_country_flag = ehof_just_bought_khans_throne }			text = "ehof_trader_bought_khans_throne" }
	desc = { trigger = { has_country_flag = ehof_just_bought_worm_scales }			text = "ehof_trader_bought_worm_scales" }
	desc = { trigger = { has_country_flag = ehof_just_bought_rubricator }			text = "ehof_trader_bought_rubricator" }
	desc = { trigger = { has_country_flag = ehof_just_bought_galaxy }				text = "ehof_trader_bought_galaxy" }
	desc = { trigger = { has_country_flag = ehof_just_bought_omnicodex }			text = "ehof_trader_bought_omnicodex" }
	desc = { trigger = { has_country_flag = ehof_just_bought_surveyor }				text = "ehof_trader_bought_surveyor" }
	desc = { trigger = { has_country_flag = ehof_just_bought_galatron }				text = "ehof_trader_bought_galatron" }
	desc = { trigger = { has_country_flag = ehof_just_bought_ancient_sword }		text = "ehof_trader_bought_ancient_sword" }
	desc = { trigger = { has_country_flag = ehof_just_bought_severed_head }			text = "ehof_trader_bought_severed_head" }
	desc = { trigger = { has_country_flag = ehof_just_bought_zro_crystal }			text = "ehof_trader_bought_zro_crystal" }
	desc = { trigger = { has_country_flag = ehof_just_bought_the_last_baol }		text = "ehof_trader_bought_the_last_baol" }
	desc = { trigger = { has_country_flag = ehof_just_bought_the_defragmentor }		text = "ehof_trader_bought_the_defragmentor" }
	desc = { trigger = { has_country_flag = ehof_just_bought_reality_perforator }	text = "ehof_trader_bought_reality_perforator" }
	desc = { trigger = { has_country_flag = ehof_just_bought_pox_sample }			text = "ehof_trader_bought_pox_sample" }
	desc = { trigger = { has_country_flag = ehof_just_bought_cryo_core }			text = "ehof_trader_bought_cryo_core" }
	desc = { trigger = { has_country_flag = ehof_just_bought_war_forge }			text = "ehof_trader_bought_war_forge" }
	desc = { trigger = { has_country_flag = ehof_just_bought_prethoryn_queen }		text = "ehof_trader_bought_prethoryn_queen" }
	desc = { trigger = { has_country_flag = ehof_just_bought_unbidden_warlock }		text = "ehof_trader_bought_unbidden_warlock" }
	desc = { trigger = { has_country_flag = ehof_just_bought_contingency_core }		text = "ehof_trader_bought_contingency_core" }
	desc = { trigger = { has_country_flag = ehof_just_bought_rare_system }			text = "ehof_trader_bought_rare_system" }
	desc = {
		trigger = {
			NOR = {
				has_country_flag = ehof_just_bought_dragon_trophy
				has_country_flag = ehof_just_bought_khans_throne
				has_country_flag = ehof_just_bought_worm_scales
				has_country_flag = ehof_just_bought_rubricator
				has_country_flag = ehof_just_bought_galaxy
				has_country_flag = ehof_just_bought_omnicodex
				has_country_flag = ehof_just_bought_surveyor
				has_country_flag = ehof_just_bought_galatron
				has_country_flag = ehof_just_bought_ancient_sword
				has_country_flag = ehof_just_bought_severed_head
				has_country_flag = ehof_just_bought_zro_crystal
				has_country_flag = ehof_just_bought_the_last_baol
				has_country_flag = ehof_just_bought_the_defragmentor
				has_country_flag = ehof_just_bought_reality_perforator
				has_country_flag = ehof_just_bought_pox_sample
				has_country_flag = ehof_just_bought_cryo_core
				has_country_flag = ehof_just_bought_war_forge
				has_country_flag = ehof_just_bought_prethoryn_queen
				has_country_flag = ehof_just_bought_unbidden_warlock
				has_country_flag = ehof_just_bought_contingency_core
				has_country_flag = ehof_just_bought_rare_system
			}
		}
		text = "ehof_mega_trader.101.desc"
	}

	trigger = { NOT = { has_country_flag = ehof_trader_diplomacy } }

	immediate = {
		set_country_flag = ehof_trader_diplomacy
		country_event = { id = ehof_mega_trader.102 } # Remove duplicate relics

		# New cycle
		if = {
			limit = { NOT = { has_country_flag = ehof_relic_chosen } }
			set_timed_country_flag = { flag = ehof_relic_chosen	days = 1800 }

			# Notify player that goods have been refreshed
			country_event = { id = ehof_mega_trader.012 days = 1801 }

			# Remove flags, so they can be bought again
			remove_country_flag = ehof_has_rare_system

			# Randomize relics (Excluded owned ones)
			random_list = {
				1 = { modifier = { factor = 0 OR = { has_relic = r_dragon_trophy		has_relic = r_ehof_dragon_trophy		check_variable = { which = ehof_trader_relic_02 value = 1 } check_variable = { which = ehof_trader_relic_03 value = 1 } } } set_variable = { which = ehof_trader_relic_01 value = 1 } }
				1 = { modifier = { factor = 0 OR = { has_relic = r_khans_throne			has_relic = r_ehof_khans_throne			check_variable = { which = ehof_trader_relic_02 value = 2 } check_variable = { which = ehof_trader_relic_03 value = 2 } } } set_variable = { which = ehof_trader_relic_01 value = 2 } }
				1 = { modifier = { factor = 0 OR = { has_relic = r_worm_scales			has_relic = r_ehof_worm_scales			check_variable = { which = ehof_trader_relic_02 value = 3 } check_variable = { which = ehof_trader_relic_03 value = 3 } } } set_variable = { which = ehof_trader_relic_01 value = 3 } }
				1 = { modifier = { factor = 0 OR = { has_relic = r_rubricator			has_relic = r_ehof_rubricator			check_variable = { which = ehof_trader_relic_02 value = 4 } check_variable = { which = ehof_trader_relic_03 value = 4 } } } set_variable = { which = ehof_trader_relic_01 value = 4 } }
				1 = { modifier = { factor = 0 OR = { has_relic = r_galaxy				has_relic = r_ehof_galaxy				check_variable = { which = ehof_trader_relic_02 value = 5 } check_variable = { which = ehof_trader_relic_03 value = 5 } } } set_variable = { which = ehof_trader_relic_01 value = 5 } }
				1 = { modifier = { factor = 0 OR = { has_relic = r_omnicodex			has_relic = r_ehof_omnicodex			check_variable = { which = ehof_trader_relic_02 value = 6 } check_variable = { which = ehof_trader_relic_03 value = 6 } } } set_variable = { which = ehof_trader_relic_01 value = 6 } }
				1 = { modifier = { factor = 0 OR = { has_relic = r_surveyor				has_relic = r_ehof_surveyor				check_variable = { which = ehof_trader_relic_02 value = 7 } check_variable = { which = ehof_trader_relic_03 value = 7 } } } set_variable = { which = ehof_trader_relic_01 value = 7 } }
				1 = { modifier = { factor = 0 OR = { has_relic = r_galatron				has_relic = r_ehof_galatron				check_variable = { which = ehof_trader_relic_02 value = 8 } check_variable = { which = ehof_trader_relic_03 value = 8 } } } set_variable = { which = ehof_trader_relic_01 value = 8 } }
				1 = { modifier = { factor = 0 OR = { has_relic = r_ancient_sword		has_relic = r_ehof_ancient_sword		check_variable = { which = ehof_trader_relic_02 value = 9 } check_variable = { which = ehof_trader_relic_03 value = 9 } } } set_variable = { which = ehof_trader_relic_01 value = 9 } }
				1 = { modifier = { factor = 0 OR = { has_relic = r_severed_head			has_relic = r_ehof_severed_head			check_variable = { which = ehof_trader_relic_02 value = 10 } check_variable = { which = ehof_trader_relic_03 value = 10 } } } set_variable = { which = ehof_trader_relic_01 value = 10 } }
				1 = { modifier = { factor = 0 OR = { has_relic = r_zro_crystal			has_relic = r_ehof_zro_crystal			check_variable = { which = ehof_trader_relic_02 value = 11 } check_variable = { which = ehof_trader_relic_03 value = 11 } } } set_variable = { which = ehof_trader_relic_01 value = 11 } }
				1 = { modifier = { factor = 0 OR = { has_relic = r_the_last_baol		has_relic = r_ehof_the_last_baol		check_variable = { which = ehof_trader_relic_02 value = 12 } check_variable = { which = ehof_trader_relic_03 value = 12 } } } set_variable = { which = ehof_trader_relic_01 value = 12 } }
				1 = { modifier = { factor = 0 OR = { has_relic = r_the_defragmentor		has_relic = r_ehof_the_defragmentor		check_variable = { which = ehof_trader_relic_02 value = 13 } check_variable = { which = ehof_trader_relic_03 value = 13 } } } set_variable = { which = ehof_trader_relic_01 value = 13 } }
				1 = { modifier = { factor = 0 OR = { has_relic = r_reality_perforator	has_relic = r_ehof_reality_perforator	check_variable = { which = ehof_trader_relic_02 value = 14 } check_variable = { which = ehof_trader_relic_03 value = 14 } } } set_variable = { which = ehof_trader_relic_01 value = 14 } }
				1 = { modifier = { factor = 0 OR = { has_relic = r_pox_sample			has_relic = r_ehof_pox_sample			check_variable = { which = ehof_trader_relic_02 value = 15 } check_variable = { which = ehof_trader_relic_03 value = 15 } } } set_variable = { which = ehof_trader_relic_01 value = 15 } }
				1 = { modifier = { factor = 0 OR = { has_relic = r_cryo_core			has_relic = r_ehof_cryo_core			check_variable = { which = ehof_trader_relic_02 value = 16 } check_variable = { which = ehof_trader_relic_03 value = 16 } } } set_variable = { which = ehof_trader_relic_01 value = 16 } }
				1 = { modifier = { factor = 0 OR = { has_relic = r_war_forge			has_relic = r_ehof_war_forge			check_variable = { which = ehof_trader_relic_02 value = 17 } check_variable = { which = ehof_trader_relic_03 value = 17 } } } set_variable = { which = ehof_trader_relic_01 value = 17 } }
				1 = { modifier = { factor = 0 OR = { has_relic = r_prethoryn_queen		has_relic = r_ehof_prethoryn_queen		check_variable = { which = ehof_trader_relic_02 value = 18 } check_variable = { which = ehof_trader_relic_03 value = 18 } } } set_variable = { which = ehof_trader_relic_01 value = 18 } }
				1 = { modifier = { factor = 0 OR = { has_relic = r_unbidden_warlock		has_relic = r_ehof_unbidden_warlock		check_variable = { which = ehof_trader_relic_02 value = 19 } check_variable = { which = ehof_trader_relic_03 value = 19 } } } set_variable = { which = ehof_trader_relic_01 value = 19 } }
				1 = { modifier = { factor = 0 OR = { has_relic = r_contingency_core		has_relic = r_ehof_contingency_core		check_variable = { which = ehof_trader_relic_02 value = 20 } check_variable = { which = ehof_trader_relic_03 value = 20 } } } set_variable = { which = ehof_trader_relic_01 value = 20 } }
			}
			random_list = {
				1 = { modifier = { factor = 0 OR = { has_relic = r_dragon_trophy		has_relic = r_ehof_dragon_trophy		check_variable = { which = ehof_trader_relic_01 value = 1 } check_variable = { which = ehof_trader_relic_03 value = 1 } } } set_variable = { which = ehof_trader_relic_02 value = 1 } }
				1 = { modifier = { factor = 0 OR = { has_relic = r_khans_throne			has_relic = r_ehof_khans_throne			check_variable = { which = ehof_trader_relic_01 value = 2 } check_variable = { which = ehof_trader_relic_03 value = 2 } } } set_variable = { which = ehof_trader_relic_02 value = 2 } }
				1 = { modifier = { factor = 0 OR = { has_relic = r_worm_scales			has_relic = r_ehof_worm_scales			check_variable = { which = ehof_trader_relic_01 value = 3 } check_variable = { which = ehof_trader_relic_03 value = 3 } } } set_variable = { which = ehof_trader_relic_02 value = 3 } }
				1 = { modifier = { factor = 0 OR = { has_relic = r_rubricator			has_relic = r_ehof_rubricator			check_variable = { which = ehof_trader_relic_01 value = 4 } check_variable = { which = ehof_trader_relic_03 value = 4 } } } set_variable = { which = ehof_trader_relic_02 value = 4 } }
				1 = { modifier = { factor = 0 OR = { has_relic = r_galaxy				has_relic = r_ehof_galaxy				check_variable = { which = ehof_trader_relic_01 value = 5 } check_variable = { which = ehof_trader_relic_03 value = 5 } } } set_variable = { which = ehof_trader_relic_02 value = 5 } }
				1 = { modifier = { factor = 0 OR = { has_relic = r_omnicodex			has_relic = r_ehof_omnicodex			check_variable = { which = ehof_trader_relic_01 value = 6 } check_variable = { which = ehof_trader_relic_03 value = 6 } } } set_variable = { which = ehof_trader_relic_02 value = 6 } }
				1 = { modifier = { factor = 0 OR = { has_relic = r_surveyor				has_relic = r_ehof_surveyor				check_variable = { which = ehof_trader_relic_01 value = 7 } check_variable = { which = ehof_trader_relic_03 value = 7 } } } set_variable = { which = ehof_trader_relic_02 value = 7 } }
				1 = { modifier = { factor = 0 OR = { has_relic = r_galatron				has_relic = r_ehof_galatron				check_variable = { which = ehof_trader_relic_01 value = 8 } check_variable = { which = ehof_trader_relic_03 value = 8 } } } set_variable = { which = ehof_trader_relic_02 value = 8 } }
				1 = { modifier = { factor = 0 OR = { has_relic = r_ancient_sword		has_relic = r_ehof_ancient_sword		check_variable = { which = ehof_trader_relic_01 value = 9 } check_variable = { which = ehof_trader_relic_03 value = 9 } } } set_variable = { which = ehof_trader_relic_02 value = 9 } }
				1 = { modifier = { factor = 0 OR = { has_relic = r_severed_head			has_relic = r_ehof_severed_head			check_variable = { which = ehof_trader_relic_01 value = 10 } check_variable = { which = ehof_trader_relic_03 value = 10 } } } set_variable = { which = ehof_trader_relic_02 value = 10 } }
				1 = { modifier = { factor = 0 OR = { has_relic = r_zro_crystal			has_relic = r_ehof_zro_crystal			check_variable = { which = ehof_trader_relic_01 value = 11 } check_variable = { which = ehof_trader_relic_03 value = 11 } } } set_variable = { which = ehof_trader_relic_02 value = 11 } }
				1 = { modifier = { factor = 0 OR = { has_relic = r_the_last_baol		has_relic = r_ehof_the_last_baol		check_variable = { which = ehof_trader_relic_01 value = 12 } check_variable = { which = ehof_trader_relic_03 value = 12 } } } set_variable = { which = ehof_trader_relic_02 value = 12 } }
				1 = { modifier = { factor = 0 OR = { has_relic = r_the_defragmentor		has_relic = r_ehof_the_defragmentor		check_variable = { which = ehof_trader_relic_01 value = 13 } check_variable = { which = ehof_trader_relic_03 value = 13 } } } set_variable = { which = ehof_trader_relic_02 value = 13 } }
				1 = { modifier = { factor = 0 OR = { has_relic = r_reality_perforator	has_relic = r_ehof_reality_perforator	check_variable = { which = ehof_trader_relic_01 value = 14 } check_variable = { which = ehof_trader_relic_03 value = 14 } } } set_variable = { which = ehof_trader_relic_02 value = 14 } }
				1 = { modifier = { factor = 0 OR = { has_relic = r_pox_sample			has_relic = r_ehof_pox_sample			check_variable = { which = ehof_trader_relic_01 value = 15 } check_variable = { which = ehof_trader_relic_03 value = 15 } } } set_variable = { which = ehof_trader_relic_02 value = 15 } }
				1 = { modifier = { factor = 0 OR = { has_relic = r_cryo_core			has_relic = r_ehof_cryo_core			check_variable = { which = ehof_trader_relic_01 value = 16 } check_variable = { which = ehof_trader_relic_03 value = 16 } } } set_variable = { which = ehof_trader_relic_02 value = 16 } }
				1 = { modifier = { factor = 0 OR = { has_relic = r_war_forge			has_relic = r_ehof_war_forge			check_variable = { which = ehof_trader_relic_01 value = 17 } check_variable = { which = ehof_trader_relic_03 value = 17 } } } set_variable = { which = ehof_trader_relic_02 value = 17 } }
				1 = { modifier = { factor = 0 OR = { has_relic = r_prethoryn_queen		has_relic = r_ehof_prethoryn_queen		check_variable = { which = ehof_trader_relic_01 value = 18 } check_variable = { which = ehof_trader_relic_03 value = 18 } } } set_variable = { which = ehof_trader_relic_02 value = 18 } }
				1 = { modifier = { factor = 0 OR = { has_relic = r_unbidden_warlock		has_relic = r_ehof_unbidden_warlock		check_variable = { which = ehof_trader_relic_01 value = 19 } check_variable = { which = ehof_trader_relic_03 value = 19 } } } set_variable = { which = ehof_trader_relic_02 value = 19 } }
				1 = { modifier = { factor = 0 OR = { has_relic = r_contingency_core		has_relic = r_ehof_contingency_core		check_variable = { which = ehof_trader_relic_01 value = 20 } check_variable = { which = ehof_trader_relic_03 value = 20 } } } set_variable = { which = ehof_trader_relic_02 value = 20 } }
			}
			random_list = {
				1 = { modifier = { factor = 0 OR = { has_relic = r_dragon_trophy		has_relic = r_ehof_dragon_trophy		check_variable = { which = ehof_trader_relic_02 value = 1 } check_variable = { which = ehof_trader_relic_01 value = 1 } } } set_variable = { which = ehof_trader_relic_03 value = 1 } }
				1 = { modifier = { factor = 0 OR = { has_relic = r_khans_throne			has_relic = r_ehof_khans_throne			check_variable = { which = ehof_trader_relic_02 value = 2 } check_variable = { which = ehof_trader_relic_01 value = 2 } } } set_variable = { which = ehof_trader_relic_03 value = 2 } }
				1 = { modifier = { factor = 0 OR = { has_relic = r_worm_scales			has_relic = r_ehof_worm_scales			check_variable = { which = ehof_trader_relic_02 value = 3 } check_variable = { which = ehof_trader_relic_01 value = 3 } } } set_variable = { which = ehof_trader_relic_03 value = 3 } }
				1 = { modifier = { factor = 0 OR = { has_relic = r_rubricator			has_relic = r_ehof_rubricator			check_variable = { which = ehof_trader_relic_02 value = 4 } check_variable = { which = ehof_trader_relic_01 value = 4 } } } set_variable = { which = ehof_trader_relic_03 value = 4 } }
				1 = { modifier = { factor = 0 OR = { has_relic = r_galaxy				has_relic = r_ehof_galaxy				check_variable = { which = ehof_trader_relic_02 value = 5 } check_variable = { which = ehof_trader_relic_01 value = 5 } } } set_variable = { which = ehof_trader_relic_03 value = 5 } }
				1 = { modifier = { factor = 0 OR = { has_relic = r_omnicodex			has_relic = r_ehof_omnicodex			check_variable = { which = ehof_trader_relic_02 value = 6 } check_variable = { which = ehof_trader_relic_01 value = 6 } } } set_variable = { which = ehof_trader_relic_03 value = 6 } }
				1 = { modifier = { factor = 0 OR = { has_relic = r_surveyor				has_relic = r_ehof_surveyor				check_variable = { which = ehof_trader_relic_02 value = 7 } check_variable = { which = ehof_trader_relic_01 value = 7 } } } set_variable = { which = ehof_trader_relic_03 value = 7 } }
				1 = { modifier = { factor = 0 OR = { has_relic = r_galatron				has_relic = r_ehof_galatron				check_variable = { which = ehof_trader_relic_02 value = 8 } check_variable = { which = ehof_trader_relic_01 value = 8 } } } set_variable = { which = ehof_trader_relic_03 value = 8 } }
				1 = { modifier = { factor = 0 OR = { has_relic = r_ancient_sword		has_relic = r_ehof_ancient_sword		check_variable = { which = ehof_trader_relic_02 value = 9 } check_variable = { which = ehof_trader_relic_01 value = 9 } } } set_variable = { which = ehof_trader_relic_03 value = 9 } }
				1 = { modifier = { factor = 0 OR = { has_relic = r_severed_head			has_relic = r_ehof_severed_head			check_variable = { which = ehof_trader_relic_02 value = 10 } check_variable = { which = ehof_trader_relic_01 value = 10 } } } set_variable = { which = ehof_trader_relic_03 value = 10 } }
				1 = { modifier = { factor = 0 OR = { has_relic = r_zro_crystal			has_relic = r_ehof_zro_crystal			check_variable = { which = ehof_trader_relic_02 value = 11 } check_variable = { which = ehof_trader_relic_01 value = 11 } } } set_variable = { which = ehof_trader_relic_03 value = 11 } }
				1 = { modifier = { factor = 0 OR = { has_relic = r_the_last_baol		has_relic = r_ehof_the_last_baol		check_variable = { which = ehof_trader_relic_02 value = 12 } check_variable = { which = ehof_trader_relic_01 value = 12 } } } set_variable = { which = ehof_trader_relic_03 value = 12 } }
				1 = { modifier = { factor = 0 OR = { has_relic = r_the_defragmentor		has_relic = r_ehof_the_defragmentor		check_variable = { which = ehof_trader_relic_02 value = 13 } check_variable = { which = ehof_trader_relic_01 value = 13 } } } set_variable = { which = ehof_trader_relic_03 value = 13 } }
				1 = { modifier = { factor = 0 OR = { has_relic = r_reality_perforator	has_relic = r_ehof_reality_perforator	check_variable = { which = ehof_trader_relic_02 value = 14 } check_variable = { which = ehof_trader_relic_01 value = 14 } } } set_variable = { which = ehof_trader_relic_03 value = 14 } }
				1 = { modifier = { factor = 0 OR = { has_relic = r_pox_sample			has_relic = r_ehof_pox_sample			check_variable = { which = ehof_trader_relic_02 value = 15 } check_variable = { which = ehof_trader_relic_01 value = 15 } } } set_variable = { which = ehof_trader_relic_03 value = 15 } }
				1 = { modifier = { factor = 0 OR = { has_relic = r_cryo_core			has_relic = r_ehof_cryo_core			check_variable = { which = ehof_trader_relic_02 value = 16 } check_variable = { which = ehof_trader_relic_01 value = 16 } } } set_variable = { which = ehof_trader_relic_03 value = 16 } }
				1 = { modifier = { factor = 0 OR = { has_relic = r_war_forge			has_relic = r_ehof_war_forge			check_variable = { which = ehof_trader_relic_02 value = 17 } check_variable = { which = ehof_trader_relic_01 value = 17 } } } set_variable = { which = ehof_trader_relic_03 value = 17 } }
				1 = { modifier = { factor = 0 OR = { has_relic = r_prethoryn_queen		has_relic = r_ehof_prethoryn_queen		check_variable = { which = ehof_trader_relic_02 value = 18 } check_variable = { which = ehof_trader_relic_01 value = 18 } } } set_variable = { which = ehof_trader_relic_03 value = 18 } }
				1 = { modifier = { factor = 0 OR = { has_relic = r_unbidden_warlock		has_relic = r_ehof_unbidden_warlock		check_variable = { which = ehof_trader_relic_02 value = 19 } check_variable = { which = ehof_trader_relic_01 value = 19 } } } set_variable = { which = ehof_trader_relic_03 value = 19 } }
				1 = { modifier = { factor = 0 OR = { has_relic = r_contingency_core		has_relic = r_ehof_contingency_core		check_variable = { which = ehof_trader_relic_02 value = 20 } check_variable = { which = ehof_trader_relic_01 value = 20 } } } set_variable = { which = ehof_trader_relic_03 value = 20 } }
			}
		}
	}

	# dragon_trophy
	option = {
		custom_gui = "enclave_ehof_trader_option"
		trigger = {
			has_ancrel = yes
			OR = {
				check_variable = { which = ehof_trader_relic_01 value = 1 }
				check_variable = { which = ehof_trader_relic_02 value = 1 }
				check_variable = { which = ehof_trader_relic_03 value = 1 }
			}
			NOT = { has_country_flag = ehof_has_dragon_trophy }
		}
		allow = { resource_stockpile_compare = { resource = ehof_sr_negative_mass value >= @ehof_trader_dragon_trophy } }
		name = "ehof_mega_trader_dragon_trophy"
		custom_tooltip = "ehof_mega_trader_dragon_trophy_tooltip"
		add_relic = r_ehof_dragon_trophy
		add_resource = { ehof_sr_negative_mass = @ehof_trader_dragon_trophy_deduct }
		hidden_effect = {
			remove_just_bought_flags = yes
			set_country_flag = ehof_has_dragon_trophy
			set_country_flag = ehof_just_bought_dragon_trophy

			# Refresh List
			remove_country_flag = ehof_trader_diplomacy
			country_event = { id = ehof_mega_trader.101 }
		}
	}

	# khans_throne
	option = {
		custom_gui = "enclave_ehof_trader_option"
		trigger = {
			has_ancrel = yes
			OR = {
				check_variable = { which = ehof_trader_relic_01 value = 2 }
				check_variable = { which = ehof_trader_relic_02 value = 2 }
				check_variable = { which = ehof_trader_relic_03 value = 2 }
			}
			NOT = { has_country_flag = ehof_has_khans_throne }
		}
		allow = { resource_stockpile_compare = { resource = ehof_sr_negative_mass value >= @ehof_trader_khans_throne } }
		name = "ehof_mega_trader_khans_throne"
		custom_tooltip = "ehof_mega_trader_khans_throne_tooltip"
		add_relic = r_ehof_khans_throne
		add_resource = { ehof_sr_negative_mass = @ehof_trader_khans_throne_deduct }
		hidden_effect = {
			remove_just_bought_flags = yes
			set_country_flag = ehof_has_khans_throne
			set_country_flag = ehof_just_bought_khans_throne

			# Refresh List
			remove_country_flag = ehof_trader_diplomacy
			country_event = { id = ehof_mega_trader.101 }
		}
	}

	# worm_scales
	option = {
		custom_gui = "enclave_ehof_trader_option"
		trigger = {
			has_ancrel = yes
			OR = {
				check_variable = { which = ehof_trader_relic_01 value = 3 }
				check_variable = { which = ehof_trader_relic_02 value = 3 }
				check_variable = { which = ehof_trader_relic_03 value = 3 }
			}
			NOT = { has_country_flag = ehof_has_worm_scales }
		}
		allow = { resource_stockpile_compare = { resource = ehof_sr_negative_mass value >= @ehof_trader_worm_scales } }
		name = "ehof_mega_trader_worm_scales"
		custom_tooltip = "ehof_mega_trader_worm_scales_tooltip"
		add_relic = r_ehof_worm_scales
		add_resource = { ehof_sr_negative_mass = @ehof_trader_worm_scales_deduct }
		hidden_effect = {
			remove_just_bought_flags = yes
			set_country_flag = ehof_has_worm_scales
			set_country_flag = ehof_just_bought_worm_scales

			# Refresh List
			remove_country_flag = ehof_trader_diplomacy
			country_event = { id = ehof_mega_trader.101 }
		}
	}

	# rubricator
	option = {
		custom_gui = "enclave_ehof_trader_option"
		trigger = {
			has_ancrel = yes
			OR = {
				check_variable = { which = ehof_trader_relic_01 value = 4 }
				check_variable = { which = ehof_trader_relic_02 value = 4 }
				check_variable = { which = ehof_trader_relic_03 value = 4 }
			}
			NOT = { has_country_flag = ehof_has_rubricator }
		}
		allow = { resource_stockpile_compare = { resource = ehof_sr_negative_mass value >= @ehof_trader_rubricator } }
		name = "ehof_mega_trader_rubricator"
		custom_tooltip = "ehof_mega_trader_rubricator_tooltip"
		add_relic = r_ehof_rubricator
		add_resource = { ehof_sr_negative_mass = @ehof_trader_rubricator_deduct }
		hidden_effect = {
			remove_just_bought_flags = yes
			set_country_flag = ehof_has_rubricator
			set_country_flag = ehof_just_bought_rubricator

			# Refresh List
			remove_country_flag = ehof_trader_diplomacy
			country_event = { id = ehof_mega_trader.101 }
		}
	}

	# galaxy
	option = {
		custom_gui = "enclave_ehof_trader_option"
		trigger = {
			has_ancrel = yes
			OR = {
				check_variable = { which = ehof_trader_relic_01 value = 5 }
				check_variable = { which = ehof_trader_relic_02 value = 5 }
				check_variable = { which = ehof_trader_relic_03 value = 5 }
			}
			NOT = { has_country_flag = ehof_has_galaxy }
		}
		allow = { resource_stockpile_compare = { resource = ehof_sr_negative_mass value >= @ehof_trader_galaxy } }
		name = "ehof_mega_trader_galaxy"
		custom_tooltip = "ehof_mega_trader_galaxy_tooltip"
		add_relic = r_ehof_galaxy
		add_resource = { ehof_sr_negative_mass = @ehof_trader_galaxy_deduct }
		hidden_effect = {
			remove_just_bought_flags = yes
			set_country_flag = ehof_has_galaxy
			set_country_flag = ehof_just_bought_galaxy

			# Refresh List
			remove_country_flag = ehof_trader_diplomacy
			country_event = { id = ehof_mega_trader.101 }
		}
	}

	# omnicodex
	option = {
		custom_gui = "enclave_ehof_trader_option"
		trigger = {
			has_ancrel = yes
			OR = {
				check_variable = { which = ehof_trader_relic_01 value = 6 }
				check_variable = { which = ehof_trader_relic_02 value = 6 }
				check_variable = { which = ehof_trader_relic_03 value = 6 }
			}
			NOT = { has_country_flag = ehof_has_omnicodex }
		}
		allow = { resource_stockpile_compare = { resource = ehof_sr_negative_mass value >= @ehof_trader_omnicodex } }
		name = "ehof_mega_trader_omnicodex"
		custom_tooltip = "ehof_mega_trader_omnicodex_tooltip"
		add_relic = r_ehof_omnicodex
		add_resource = { ehof_sr_negative_mass = @ehof_trader_omnicodex_deduct }
		hidden_effect = {
			remove_just_bought_flags = yes
			set_country_flag = ehof_has_omnicodex
			set_country_flag = ehof_just_bought_omnicodex

			# Refresh List
			remove_country_flag = ehof_trader_diplomacy
			country_event = { id = ehof_mega_trader.101 }
		}
	}

	# surveyor
	option = {
		custom_gui = "enclave_ehof_trader_option"
		trigger = {
			has_ancrel = yes
			OR = {
				check_variable = { which = ehof_trader_relic_01 value = 7 }
				check_variable = { which = ehof_trader_relic_02 value = 7 }
				check_variable = { which = ehof_trader_relic_03 value = 7 }
			}
			NOT = { has_country_flag = ehof_has_surveyor }
		}
		allow = { resource_stockpile_compare = { resource = ehof_sr_negative_mass value >= @ehof_trader_surveyor } }
		name = "ehof_mega_trader_surveyor"
		custom_tooltip = "ehof_mega_trader_surveyor_tooltip"
		add_relic = r_ehof_surveyor
		add_resource = { ehof_sr_negative_mass = @ehof_trader_surveyor_deduct }
		hidden_effect = {
			remove_just_bought_flags = yes
			set_country_flag = ehof_has_surveyor
			set_country_flag = ehof_just_bought_surveyor

			# Refresh List
			remove_country_flag = ehof_trader_diplomacy
			country_event = { id = ehof_mega_trader.101 }
		}
	}

	# galatron
	option = {
		custom_gui = "enclave_ehof_trader_option"
		trigger = {
			has_ancrel = yes
			OR = {
				check_variable = { which = ehof_trader_relic_01 value = 8 }
				check_variable = { which = ehof_trader_relic_02 value = 8 }
				check_variable = { which = ehof_trader_relic_03 value = 8 }
			}
			NOT = { has_country_flag = ehof_has_galatron }
		}
		allow = { resource_stockpile_compare = { resource = ehof_sr_negative_mass value >= @ehof_trader_galatron } }
		name = "ehof_mega_trader_galatron"
		custom_tooltip = "ehof_mega_trader_galatron_tooltip"
		add_relic = r_ehof_galatron
		add_resource = { ehof_sr_negative_mass = @ehof_trader_galatron_deduct }
		hidden_effect = {
			remove_just_bought_flags = yes
			set_country_flag = ehof_has_galatron
			set_country_flag = ehof_just_bought_galatron

			# Refresh List
			remove_country_flag = ehof_trader_diplomacy
			country_event = { id = ehof_mega_trader.101 }
		}
	}

	# ancient_sword
	option = {
		custom_gui = "enclave_ehof_trader_option"
		trigger = {
			has_ancrel = yes
			OR = {
				check_variable = { which = ehof_trader_relic_01 value = 9 }
				check_variable = { which = ehof_trader_relic_02 value = 9 }
				check_variable = { which = ehof_trader_relic_03 value = 9 }
			}
			NOT = { has_country_flag = ehof_has_ancient_sword }
		}
		allow = { resource_stockpile_compare = { resource = ehof_sr_negative_mass value >= @ehof_trader_ancient_sword } }
		name = "ehof_mega_trader_ancient_sword"
		custom_tooltip = "ehof_mega_trader_ancient_sword_tooltip"
		add_relic = r_ehof_ancient_sword
		add_resource = { ehof_sr_negative_mass = @ehof_trader_ancient_sword_deduct }
		hidden_effect = {
			remove_just_bought_flags = yes
			set_country_flag = ehof_has_ancient_sword
			set_country_flag = ehof_just_bought_ancient_sword

			# Refresh List
			remove_country_flag = ehof_trader_diplomacy
			country_event = { id = ehof_mega_trader.101 }
		}
	}

	# severed_head
	option = {
		custom_gui = "enclave_ehof_trader_option"
		trigger = {
			has_ancrel = yes
			OR = {
				check_variable = { which = ehof_trader_relic_01 value = 10 }
				check_variable = { which = ehof_trader_relic_02 value = 10 }
				check_variable = { which = ehof_trader_relic_03 value = 10 }
			}
			NOT = { has_country_flag = ehof_has_severed_head }
		}
		allow = { resource_stockpile_compare = { resource = ehof_sr_negative_mass value >= @ehof_trader_severed_head } }
		name = "ehof_mega_trader_severed_head"
		custom_tooltip = "ehof_mega_trader_severed_head_tooltip"
		add_relic = r_ehof_severed_head
		add_resource = { ehof_sr_negative_mass = @ehof_trader_severed_head_deduct }
		hidden_effect = {
			remove_just_bought_flags = yes
			set_country_flag = ehof_has_severed_head
			set_country_flag = ehof_just_bought_severed_head

			# Refresh List
			remove_country_flag = ehof_trader_diplomacy
			country_event = { id = ehof_mega_trader.101 }
		}
	}

	# zro_crystal
	option = {
		custom_gui = "enclave_ehof_trader_option"
		trigger = {
			has_ancrel = yes
			OR = {
				check_variable = { which = ehof_trader_relic_01 value = 11 }
				check_variable = { which = ehof_trader_relic_02 value = 11 }
				check_variable = { which = ehof_trader_relic_03 value = 11 }
			}
			NOT = { has_country_flag = ehof_has_zro_crystal }
		}
		allow = { resource_stockpile_compare = { resource = ehof_sr_negative_mass value >= @ehof_trader_zro_crystal } }
		name = "ehof_mega_trader_zro_crystal"
		custom_tooltip = "ehof_mega_trader_zro_crystal_tooltip"
		add_relic = r_ehof_zro_crystal
		add_resource = { ehof_sr_negative_mass = @ehof_trader_zro_crystal_deduct }
		hidden_effect = {
			remove_just_bought_flags = yes
			set_country_flag = ehof_has_zro_crystal
			set_country_flag = ehof_just_bought_zro_crystal

			# Refresh List
			remove_country_flag = ehof_trader_diplomacy
			country_event = { id = ehof_mega_trader.101 }
		}
	}

	# the_last_baol
	option = {
		custom_gui = "enclave_ehof_trader_option"
		trigger = {
			has_ancrel = yes
			OR = {
				check_variable = { which = ehof_trader_relic_01 value = 12 }
				check_variable = { which = ehof_trader_relic_02 value = 12 }
				check_variable = { which = ehof_trader_relic_03 value = 12 }
			}
			NOT = { has_country_flag = ehof_has_the_last_baol }
		}
		allow = { resource_stockpile_compare = { resource = ehof_sr_negative_mass value >= @ehof_trader_the_last_baol } }
		name = "ehof_mega_trader_the_last_baol"
		custom_tooltip = "ehof_mega_trader_the_last_baol_tooltip"
		add_relic = r_ehof_the_last_baol
		add_resource = { ehof_sr_negative_mass = @ehof_trader_the_last_baol_deduct }
		hidden_effect = {
			remove_just_bought_flags = yes
			set_country_flag = ehof_has_the_last_baol
			set_country_flag = ehof_just_bought_the_last_baol

			# Refresh List
			remove_country_flag = ehof_trader_diplomacy
			country_event = { id = ehof_mega_trader.101 }
		}
	}

	# the_defragmentor
	option = {
		custom_gui = "enclave_ehof_trader_option"
		trigger = {
			has_ancrel = yes
			OR = {
				check_variable = { which = ehof_trader_relic_01 value = 13 }
				check_variable = { which = ehof_trader_relic_02 value = 13 }
				check_variable = { which = ehof_trader_relic_03 value = 13 }
			}
			NOT = { has_country_flag = ehof_has_the_defragmentor }
		}
		allow = { resource_stockpile_compare = { resource = ehof_sr_negative_mass value >= @ehof_trader_the_defragmentor } }
		name = "ehof_mega_trader_the_defragmentor"
		custom_tooltip = "ehof_mega_trader_the_defragmentor_tooltip"
		add_relic = r_ehof_the_defragmentor
		add_resource = { ehof_sr_negative_mass = @ehof_trader_the_defragmentor_deduct }
		hidden_effect = {
			remove_just_bought_flags = yes
			set_country_flag = ehof_has_the_defragmentor
			set_country_flag = ehof_just_bought_the_defragmentor

			# Refresh List
			remove_country_flag = ehof_trader_diplomacy
			country_event = { id = ehof_mega_trader.101 }
		}
	}

	# reality_perforator
	option = {
		custom_gui = "enclave_ehof_trader_option"
		trigger = {
			has_ancrel = yes
			OR = {
				check_variable = { which = ehof_trader_relic_01 value = 14 }
				check_variable = { which = ehof_trader_relic_02 value = 14 }
				check_variable = { which = ehof_trader_relic_03 value = 14 }
			}
			NOT = { has_country_flag = ehof_has_reality_perforator }
		}
		allow = { resource_stockpile_compare = { resource = ehof_sr_negative_mass value >= @ehof_trader_reality_perforator } }
		name = "ehof_mega_trader_reality_perforator"
		custom_tooltip = "ehof_mega_trader_reality_perforator_tooltip"
		add_relic = r_ehof_reality_perforator
		add_resource = { ehof_sr_negative_mass = @ehof_trader_reality_perforator_deduct }
		hidden_effect = {
			remove_just_bought_flags = yes
			set_country_flag = ehof_has_reality_perforator
			set_country_flag = ehof_just_bought_reality_perforator

			# Refresh List
			remove_country_flag = ehof_trader_diplomacy
			country_event = { id = ehof_mega_trader.101 }
		}
	}

	# pox_sample
	option = {
		custom_gui = "enclave_ehof_trader_option"
		trigger = {
			has_ancrel = yes
			OR = {
				check_variable = { which = ehof_trader_relic_01 value = 15 }
				check_variable = { which = ehof_trader_relic_02 value = 15 }
				check_variable = { which = ehof_trader_relic_03 value = 15 }
			}
			NOT = { has_country_flag = ehof_has_pox_sample }
		}
		allow = { resource_stockpile_compare = { resource = ehof_sr_negative_mass value >= @ehof_trader_pox_sample } }
		name = "ehof_mega_trader_pox_sample"
		custom_tooltip = "ehof_mega_trader_pox_sample_tooltip"
		add_relic = r_ehof_pox_sample
		add_resource = { ehof_sr_negative_mass = @ehof_trader_pox_sample_deduct }
		hidden_effect = {
			remove_just_bought_flags = yes
			set_country_flag = ehof_has_pox_sample
			set_country_flag = ehof_just_bought_pox_sample

			# Refresh List
			remove_country_flag = ehof_trader_diplomacy
			country_event = { id = ehof_mega_trader.101 }
		}
	}

	# cryo_core
	option = {
		custom_gui = "enclave_ehof_trader_option"
		trigger = {
			has_ancrel = yes
			OR = {
				check_variable = { which = ehof_trader_relic_01 value = 16 }
				check_variable = { which = ehof_trader_relic_02 value = 16 }
				check_variable = { which = ehof_trader_relic_03 value = 16 }
			}
			NOT = { has_country_flag = ehof_has_cryo_core }
		}
		allow = { resource_stockpile_compare = { resource = ehof_sr_negative_mass value >= @ehof_trader_cryo_core } }
		name = "ehof_mega_trader_cryo_core"
		custom_tooltip = "ehof_mega_trader_cryo_core_tooltip"
		add_relic = r_ehof_cryo_core
		add_resource = { ehof_sr_negative_mass = @ehof_trader_cryo_core_deduct }
		hidden_effect = {
			remove_just_bought_flags = yes
			set_country_flag = ehof_has_cryo_core
			set_country_flag = ehof_just_bought_cryo_core

			# Refresh List
			remove_country_flag = ehof_trader_diplomacy
			country_event = { id = ehof_mega_trader.101 }
		}
	}

	# war_forge
	option = {
		custom_gui = "enclave_ehof_trader_option"
		trigger = {
			has_ancrel = yes
			OR = {
				check_variable = { which = ehof_trader_relic_01 value = 17 }
				check_variable = { which = ehof_trader_relic_02 value = 17 }
				check_variable = { which = ehof_trader_relic_03 value = 17 }
			}
			NOT = { has_country_flag = ehof_has_war_forge }
		}
		allow = { resource_stockpile_compare = { resource = ehof_sr_negative_mass value >= @ehof_trader_war_forge } }
		name = "ehof_mega_trader_war_forge"
		custom_tooltip = "ehof_mega_trader_war_forge_tooltip"
		add_relic = r_ehof_war_forge
		add_resource = { ehof_sr_negative_mass = @ehof_trader_war_forge_deduct }
		hidden_effect = {
			remove_just_bought_flags = yes
			set_country_flag = ehof_has_war_forge
			set_country_flag = ehof_just_bought_war_forge

			# Refresh List
			remove_country_flag = ehof_trader_diplomacy
			country_event = { id = ehof_mega_trader.101 }
		}
	}

	# prethoryn_queen
	option = {
		custom_gui = "enclave_ehof_trader_option"
		trigger = {
			has_ancrel = yes
			OR = {
				check_variable = { which = ehof_trader_relic_01 value = 18 }
				check_variable = { which = ehof_trader_relic_02 value = 18 }
				check_variable = { which = ehof_trader_relic_03 value = 18 }
			}
			NOT = { has_country_flag = ehof_has_prethoryn_queen }
		}
		allow = { resource_stockpile_compare = { resource = ehof_sr_negative_mass value >= @ehof_trader_prethoryn_queen } }
		name = "ehof_mega_trader_prethoryn_queen"
		custom_tooltip = "ehof_mega_trader_prethoryn_queen_tooltip"
		add_relic = r_ehof_prethoryn_queen
		add_resource = { ehof_sr_negative_mass = @ehof_trader_prethoryn_queen_deduct }
		hidden_effect = {
			remove_just_bought_flags = yes
			set_country_flag = ehof_has_prethoryn_queen
			set_country_flag = ehof_just_bought_prethoryn_queen

			# Refresh List
			remove_country_flag = ehof_trader_diplomacy
			country_event = { id = ehof_mega_trader.101 }
		}
	}

	# unbidden_warlock
	option = {
		custom_gui = "enclave_ehof_trader_option"
		trigger = {
			has_ancrel = yes
			OR = {
				check_variable = { which = ehof_trader_relic_01 value = 19 }
				check_variable = { which = ehof_trader_relic_02 value = 19 }
				check_variable = { which = ehof_trader_relic_03 value = 19 }
			}
			NOT = { has_country_flag = ehof_has_unbidden_warlock }
		}
		allow = { resource_stockpile_compare = { resource = ehof_sr_negative_mass value >= @ehof_trader_unbidden_warlock } }
		name = "ehof_mega_trader_unbidden_warlock"
		custom_tooltip = "ehof_mega_trader_unbidden_warlock_tooltip"
		add_relic = r_ehof_unbidden_warlock
		add_resource = { ehof_sr_negative_mass = @ehof_trader_unbidden_warlock_deduct }
		hidden_effect = {
			remove_just_bought_flags = yes
			set_country_flag = ehof_has_unbidden_warlock
			set_country_flag = ehof_just_bought_unbidden_warlock

			# Refresh List
			remove_country_flag = ehof_trader_diplomacy
			country_event = { id = ehof_mega_trader.101 }
		}
	}

	# contingency_core
	option = {
		custom_gui = "enclave_ehof_trader_option"
		trigger = {
			has_ancrel = yes
			OR = {
				check_variable = { which = ehof_trader_relic_01 value = 20 }
				check_variable = { which = ehof_trader_relic_02 value = 20 }
				check_variable = { which = ehof_trader_relic_03 value = 20 }
			}
			NOT = { has_country_flag = ehof_has_contingency_core }
		}
		allow = { resource_stockpile_compare = { resource = ehof_sr_negative_mass value >= @ehof_trader_contingency_core } }
		name = "ehof_mega_trader_contingency_core"
		custom_tooltip = "ehof_mega_trader_contingency_core_tooltip"
		add_relic = r_ehof_contingency_core
		add_resource = { ehof_sr_negative_mass = @ehof_trader_contingency_core_deduct }
		hidden_effect = {
			remove_just_bought_flags = yes
			set_country_flag = ehof_has_contingency_core
			set_country_flag = ehof_just_bought_contingency_core

			# Refresh List
			remove_country_flag = ehof_trader_diplomacy
			country_event = { id = ehof_mega_trader.101 }
		}
	}

	# rare_system
	option = {
		custom_gui = "enclave_ehof_trader_option"
		trigger = { NOT = { has_country_flag = ehof_has_rare_system } }
		allow = { resource_stockpile_compare = { resource = ehof_sr_negative_mass value >= @ehof_trader_rare_system } }
		name = "ehof_mega_trader_rare_system"
		custom_tooltip = "ehof_mega_trader_rare_system_tooltip"
		add_resource = { ehof_sr_negative_mass = @ehof_trader_rare_system_deduct }
		hidden_effect = {
			remove_just_bought_flags = yes
			set_country_flag = ehof_has_rare_system
			set_country_flag = ehof_just_bought_rare_system
			set_country_flag = ehof_next_system_rare

			# Refresh List
			remove_country_flag = ehof_trader_diplomacy
			country_event = { id = ehof_mega_trader.101 }
		}
	}

	option = {	# I'm looking for something else
		custom_gui = "enclave_ehof_trader_option"
		name = "ehof_mega_trader_something_else"
		custom_tooltip = "ehof_mega_trader_something_else_tooltip"
		hidden_effect = {
			remove_just_bought_flags = yes
			remove_country_flag = ehof_trader_diplomacy
			country_event = { id = ehof_mega_trader.111 }
		}
	}

	option = {	# Go back
		custom_gui = "enclave_ehof_trader_option"
		name = "ehof_goback"
		default_hide_option = yes
		hidden_effect = {
			remove_just_bought_flags = yes
			remove_country_flag = ehof_trader_diplomacy
			country_event = { id = ehof_mega_trader.006 }
		}
	}
}




# Looking for something else
country_event = {
	id = ehof_mega_trader.111
	title = "ehof_mega_trader.002.name"
	diplomatic = yes
	custom_gui = "enclave_ehof_trader_window"
	desc = { trigger = { NOT = { has_country_flag = ehof_trader_already_finding } } text = "ehof_mega_trader.111.desc_01" }
	desc = { trigger = { has_country_flag = ehof_trader_already_finding }			text = "ehof_mega_trader.111.desc_02" }
	is_triggered_only = yes
	picture_event_data = {
		portrait = event_target:urmazin_country
		graphical_culture = event_target:urmazin_country
		room = "shroud2_room"
	}
	location = event_target:urmazin_capital
	trigger = { NOT = { has_country_flag = ehof_trader_diplomacy } }
	immediate = { set_country_flag = ehof_trader_diplomacy }

	# dragon_trophy
	option = {
		custom_gui = "enclave_ehof_trader_option"
		trigger = {
			has_ancrel = yes
			NOR = {
				has_country_flag = ehof_trader_already_finding
				has_country_flag = ehof_has_dragon_trophy
				has_relic = r_dragon_trophy
				has_relic = r_ehof_dragon_trophy
			}
		}
		allow = {
			resource_stockpile_compare = {
				resource = ehof_sr_negative_mass
				value >= @ehof_trader_dragon_trophy_finders
			}
		}
		name = "ehof_mega_trader_dragon_trophy"
		custom_tooltip = "ehof_mega_trader_dragon_trophy_tooltip"
		set_country_flag = ehof_trader_find_dragon_trophy
		add_resource = { ehof_sr_negative_mass = @ehof_trader_dragon_trophy_finders_deduct }
		hidden_effect = {
			set_timed_country_flag = { flag = ehof_trader_already_finding years = 10 }
			remove_country_flag = ehof_trader_diplomacy
			country_event = { id = ehof_mega_trader.112 }
		}
	}

	# khans_throne
	option = {
		custom_gui = "enclave_ehof_trader_option"
		trigger = {
			has_ancrel = yes
			NOR = {
				has_country_flag = ehof_trader_already_finding
				has_country_flag = ehof_has_khans_throne
				has_relic = r_khans_throne
				has_relic = r_ehof_khans_throne
			}
		}
		allow = {
			resource_stockpile_compare = {
				resource = ehof_sr_negative_mass
				value >= @ehof_trader_khans_throne_finders
			}
		}
		name = "ehof_mega_trader_khans_throne"
		custom_tooltip = "ehof_mega_trader_khans_throne_tooltip"
		set_country_flag = ehof_trader_find_khans_throne
		add_resource = { ehof_sr_negative_mass = @ehof_trader_khans_throne_finders_deduct }
		hidden_effect = {
			set_timed_country_flag = { flag = ehof_trader_already_finding years = 10 }
			remove_country_flag = ehof_trader_diplomacy
			country_event = { id = ehof_mega_trader.112 }
		}
	}

	# worm_scales
	option = {
		custom_gui = "enclave_ehof_trader_option"
		trigger = {
			has_ancrel = yes
			NOR = {
				has_country_flag = ehof_trader_already_finding
				has_country_flag = ehof_has_worm_scales
				has_relic = r_worm_scales
				has_relic = r_ehof_worm_scales
			}
		}
		allow = {
			resource_stockpile_compare = {
				resource = ehof_sr_negative_mass
				value >= @ehof_trader_worm_scales_finders
			}
		}
		name = "ehof_mega_trader_worm_scales"
		custom_tooltip = "ehof_mega_trader_worm_scales_tooltip"
		set_country_flag = ehof_trader_find_worm_scales
		add_resource = { ehof_sr_negative_mass = @ehof_trader_worm_scales_finders_deduct }
		hidden_effect = {
			set_timed_country_flag = { flag = ehof_trader_already_finding years = 10 }
			remove_country_flag = ehof_trader_diplomacy
			country_event = { id = ehof_mega_trader.112 }
		}
	}

	# rubricator
	option = {
		custom_gui = "enclave_ehof_trader_option"
		trigger = {
			has_ancrel = yes
			NOR = {
				has_country_flag = ehof_trader_already_finding
				has_country_flag = ehof_has_rubricator
				has_relic = r_rubricator
				has_relic = r_ehof_rubricator
			}
		}
		allow = {
			resource_stockpile_compare = {
				resource = ehof_sr_negative_mass
				value >= @ehof_trader_rubricator_finders
			}
		}
		name = "ehof_mega_trader_rubricator"
		custom_tooltip = "ehof_mega_trader_rubricator_tooltip"
		set_country_flag = ehof_trader_find_rubricator
		add_resource = { ehof_sr_negative_mass = @ehof_trader_rubricator_finders_deduct }
		hidden_effect = {
			set_timed_country_flag = { flag = ehof_trader_already_finding years = 10 }
			remove_country_flag = ehof_trader_diplomacy
			country_event = { id = ehof_mega_trader.112 }
		}
	}

	# galaxy
	option = {
		custom_gui = "enclave_ehof_trader_option"
		trigger = {
			has_ancrel = yes
			NOR = {
				has_country_flag = ehof_trader_already_finding
				has_country_flag = ehof_has_galaxy
				has_relic = r_galaxy
				has_relic = r_ehof_galaxy
			}
		}
		allow = {
			resource_stockpile_compare = {
				resource = ehof_sr_negative_mass
				value >= @ehof_trader_galaxy_finders
			}
		}
		name = "ehof_mega_trader_galaxy"
		custom_tooltip = "ehof_mega_trader_galaxy_tooltip"
		set_country_flag = ehof_trader_find_galaxy
		add_resource = { ehof_sr_negative_mass = @ehof_trader_galaxy_finders_deduct }
		hidden_effect = {
			set_timed_country_flag = { flag = ehof_trader_already_finding years = 10 }
			remove_country_flag = ehof_trader_diplomacy
			country_event = { id = ehof_mega_trader.112 }
		}
	}

	# omnicodex
	option = {
		custom_gui = "enclave_ehof_trader_option"
		trigger = {
			has_ancrel = yes
			NOR = {
				has_country_flag = ehof_trader_already_finding
				has_country_flag = ehof_has_omnicodex
				has_relic = r_omnicodex
				has_relic = r_ehof_omnicodex
			}
		}
		allow = {
			resource_stockpile_compare = {
				resource = ehof_sr_negative_mass
				value >= @ehof_trader_omnicodex_finders
			}
		}
		name = "ehof_mega_trader_omnicodex"
		custom_tooltip = "ehof_mega_trader_omnicodex_tooltip"
		set_country_flag = ehof_trader_find_omnicodex
		add_resource = { ehof_sr_negative_mass = @ehof_trader_omnicodex_finders_deduct }
		hidden_effect = {
			set_timed_country_flag = { flag = ehof_trader_already_finding years = 10 }
			remove_country_flag = ehof_trader_diplomacy
			country_event = { id = ehof_mega_trader.112 }
		}
	}

	# surveyor
	option = {
		custom_gui = "enclave_ehof_trader_option"
		trigger = {
			has_ancrel = yes
			NOR = {
				has_country_flag = ehof_trader_already_finding
				has_country_flag = ehof_has_surveyor
				has_relic = r_surveyor
				has_relic = r_ehof_surveyor
			}
		}
		allow = {
			resource_stockpile_compare = {
				resource = ehof_sr_negative_mass
				value >= @ehof_trader_surveyor_finders
			}
		}
		name = "ehof_mega_trader_surveyor"
		custom_tooltip = "ehof_mega_trader_surveyor_tooltip"
		set_country_flag = ehof_trader_find_surveyor
		add_resource = { ehof_sr_negative_mass = @ehof_trader_surveyor_finders_deduct }
		hidden_effect = {
			set_timed_country_flag = { flag = ehof_trader_already_finding years = 10 }
			remove_country_flag = ehof_trader_diplomacy
			country_event = { id = ehof_mega_trader.112 }
		}
	}

	# galatron
	option = {
		custom_gui = "enclave_ehof_trader_option"
		trigger = {
			has_ancrel = yes
			NOR = {
				has_country_flag = ehof_trader_already_finding
				has_country_flag = ehof_has_galatron
				has_relic = r_galatron
				has_relic = r_ehof_galatron
			}
		}
		allow = {
			resource_stockpile_compare = {
				resource = ehof_sr_negative_mass
				value >= @ehof_trader_galatron_finders
			}
		}
		name = "ehof_mega_trader_galatron"
		custom_tooltip = "ehof_mega_trader_galatron_tooltip"
		set_country_flag = ehof_trader_find_galatron
		add_resource = { ehof_sr_negative_mass = @ehof_trader_galatron_finders_deduct }
		hidden_effect = {
			set_timed_country_flag = { flag = ehof_trader_already_finding years = 10 }
			remove_country_flag = ehof_trader_diplomacy
			country_event = { id = ehof_mega_trader.112 }
		}
	}

	# ancient_sword
	option = {
		custom_gui = "enclave_ehof_trader_option"
		trigger = {
			has_ancrel = yes
			NOR = {
				has_country_flag = ehof_trader_already_finding
				has_country_flag = ehof_has_ancient_sword
				has_relic = r_ancient_sword
				has_relic = r_ehof_ancient_sword
			}
		}
		allow = {
			resource_stockpile_compare = {
				resource = ehof_sr_negative_mass
				value >= @ehof_trader_ancient_sword_finders
			}
		}
		name = "ehof_mega_trader_ancient_sword"
		custom_tooltip = "ehof_mega_trader_ancient_sword_tooltip"
		set_country_flag = ehof_trader_find_ancient_sword
		add_resource = { ehof_sr_negative_mass = @ehof_trader_ancient_sword_finders_deduct }
		hidden_effect = {
			set_timed_country_flag = { flag = ehof_trader_already_finding years = 10 }
			remove_country_flag = ehof_trader_diplomacy
			country_event = { id = ehof_mega_trader.112 }
		}
	}

	# severed_head
	option = {
		custom_gui = "enclave_ehof_trader_option"
		trigger = {
			has_ancrel = yes
			NOR = {
				has_country_flag = ehof_trader_already_finding
				has_country_flag = ehof_has_severed_head
				has_relic = r_severed_head
				has_relic = r_ehof_severed_head
			}
		}
		allow = {
			resource_stockpile_compare = {
				resource = ehof_sr_negative_mass
				value >= @ehof_trader_severed_head_finders
			}
		}
		name = "ehof_mega_trader_severed_head"
		custom_tooltip = "ehof_mega_trader_severed_head_tooltip"
		set_country_flag = ehof_trader_find_severed_head
		add_resource = { ehof_sr_negative_mass = @ehof_trader_severed_head_finders_deduct }
		hidden_effect = {
			set_timed_country_flag = { flag = ehof_trader_already_finding years = 10 }
			remove_country_flag = ehof_trader_diplomacy
			country_event = { id = ehof_mega_trader.112 }
		}
	}

	# prethoryn_queen
	option = {
		custom_gui = "enclave_ehof_trader_option"
		trigger = {
			has_ancrel = yes
			NOR = {
				has_country_flag = ehof_trader_already_finding
				has_country_flag = ehof_has_prethoryn_queen
				has_relic = r_prethoryn_queen
				has_relic = r_ehof_prethoryn_queen
			}
		}
		allow = {
			resource_stockpile_compare = {
				resource = ehof_sr_negative_mass
				value >= @ehof_trader_prethoryn_queen_finders
			}
		}
		name = "ehof_mega_trader_prethoryn_queen"
		custom_tooltip = "ehof_mega_trader_prethoryn_queen_tooltip"
		set_country_flag = ehof_trader_find_prethoryn_queen
		add_resource = { ehof_sr_negative_mass = @ehof_trader_prethoryn_queen_finders_deduct }
		hidden_effect = {
			set_timed_country_flag = { flag = ehof_trader_already_finding years = 10 }
			remove_country_flag = ehof_trader_diplomacy
			country_event = { id = ehof_mega_trader.112 }
		}
	}

	# unbidden_warlock
	option = {
		custom_gui = "enclave_ehof_trader_option"
		trigger = {
			has_ancrel = yes
			NOR = {
				has_country_flag = ehof_trader_already_finding
				has_country_flag = ehof_has_unbidden_warlock
				has_relic = r_unbidden_warlock
				has_relic = r_ehof_unbidden_warlock
			}
		}
		allow = {
			resource_stockpile_compare = {
				resource = ehof_sr_negative_mass
				value >= @ehof_trader_unbidden_warlock_finders
			}
		}
		name = "ehof_mega_trader_unbidden_warlock"
		custom_tooltip = "ehof_mega_trader_unbidden_warlock_tooltip"
		set_country_flag = ehof_trader_find_unbidden_warlock
		add_resource = { ehof_sr_negative_mass = @ehof_trader_unbidden_warlock_finders_deduct }
		hidden_effect = {
			set_timed_country_flag = { flag = ehof_trader_already_finding years = 10 }
			remove_country_flag = ehof_trader_diplomacy
			country_event = { id = ehof_mega_trader.112 }
		}
	}

	# contingency_core
	option = {
		custom_gui = "enclave_ehof_trader_option"
		trigger = {
			has_ancrel = yes
			NOR = {
				has_country_flag = ehof_trader_already_finding
				has_country_flag = ehof_has_contingency_core
				has_relic = r_contingency_core
				has_relic = r_ehof_contingency_core
			}
		}
		allow = {
			resource_stockpile_compare = {
				resource = ehof_sr_negative_mass
				value >= @ehof_trader_contingency_core_finders
			}
		}
		name = "ehof_mega_trader_contingency_core"
		custom_tooltip = "ehof_mega_trader_contingency_core_tooltip"
		set_country_flag = ehof_trader_find_contingency_core
		add_resource = { ehof_sr_negative_mass = @ehof_trader_contingency_core_finders_deduct }
		hidden_effect = {
			set_timed_country_flag = { flag = ehof_trader_already_finding years = 10 }
			remove_country_flag = ehof_trader_diplomacy
			country_event = { id = ehof_mega_trader.112 }
		}
	}

	# zro_crystal
	option = {
		custom_gui = "enclave_ehof_trader_option"
		trigger = {
			has_ancrel = yes
			NOR = {
				has_country_flag = ehof_trader_already_finding
				has_country_flag = ehof_has_zro_crystal
				has_relic = r_zro_crystal
				has_relic = r_ehof_zro_crystal
			}
		}
		allow = {
			resource_stockpile_compare = {
				resource = ehof_sr_negative_mass
				value >= @ehof_trader_zro_crystal_finders
			}
		}
		name = "ehof_mega_trader_zro_crystal"
		custom_tooltip = "ehof_mega_trader_zro_crystal_tooltip"
		set_country_flag = ehof_trader_find_zro_crystal
		add_resource = { ehof_sr_negative_mass = @ehof_trader_zro_crystal_finders_deduct }
		hidden_effect = {
			set_timed_country_flag = { flag = ehof_trader_already_finding years = 10 }
			remove_country_flag = ehof_trader_diplomacy
			country_event = { id = ehof_mega_trader.112 }
		}
	}

	# the_last_baol
	option = {
		custom_gui = "enclave_ehof_trader_option"
		trigger = {
			has_ancrel = yes
			NOR = {
				has_country_flag = ehof_trader_already_finding
				has_country_flag = ehof_has_the_last_baol
				has_relic = r_the_last_baol
				has_relic = r_ehof_the_last_baol
			}
		}
		allow = {
			resource_stockpile_compare = {
				resource = ehof_sr_negative_mass
				value >= @ehof_trader_the_last_baol_finders
			}
		}
		name = "ehof_mega_trader_the_last_baol"
		custom_tooltip = "ehof_mega_trader_the_last_baol_tooltip"
		set_country_flag = ehof_trader_find_the_last_baol
		add_resource = { ehof_sr_negative_mass = @ehof_trader_the_last_baol_finders_deduct }
		hidden_effect = {
			set_timed_country_flag = { flag = ehof_trader_already_finding years = 10 }
			remove_country_flag = ehof_trader_diplomacy
			country_event = { id = ehof_mega_trader.112 }
		}
	}

	# the_defragmentor
	option = {
		custom_gui = "enclave_ehof_trader_option"
		trigger = {
			has_ancrel = yes
			NOR = {
				has_country_flag = ehof_trader_already_finding
				has_country_flag = ehof_has_the_defragmentor
				has_relic = r_the_defragmentor
				has_relic = r_ehof_the_defragmentor
			}
		}
		allow = {
			resource_stockpile_compare = {
				resource = ehof_sr_negative_mass
				value >= @ehof_trader_the_defragmentor_finders
			}
		}
		name = "ehof_mega_trader_the_defragmentor"
		custom_tooltip = "ehof_mega_trader_the_defragmentor_tooltip"
		set_country_flag = ehof_trader_find_the_defragmentor
		add_resource = { ehof_sr_negative_mass = @ehof_trader_the_defragmentor_finders_deduct }
		hidden_effect = {
			set_timed_country_flag = { flag = ehof_trader_already_finding years = 10 }
			remove_country_flag = ehof_trader_diplomacy
			country_event = { id = ehof_mega_trader.112 }
		}
	}

	# reality_perforator
	option = {
		custom_gui = "enclave_ehof_trader_option"
		trigger = {
			has_ancrel = yes
			NOR = {
				has_country_flag = ehof_trader_already_finding
				has_country_flag = ehof_has_reality_perforator
				has_relic = r_reality_perforator
				has_relic = r_ehof_reality_perforator
			}
		}
		allow = {
			resource_stockpile_compare = {
				resource = ehof_sr_negative_mass
				value >= @ehof_trader_reality_perforator_finders
			}
		}
		name = "ehof_mega_trader_reality_perforator"
		custom_tooltip = "ehof_mega_trader_reality_perforator_tooltip"
		set_country_flag = ehof_trader_find_reality_perforator
		add_resource = { ehof_sr_negative_mass = @ehof_trader_reality_perforator_finders_deduct }
		hidden_effect = {
			set_timed_country_flag = { flag = ehof_trader_already_finding years = 10 }
			remove_country_flag = ehof_trader_diplomacy
			country_event = { id = ehof_mega_trader.112 }
		}
	}

	# pox_sample
	option = {
		custom_gui = "enclave_ehof_trader_option"
		trigger = {
			has_ancrel = yes
			NOR = {
				has_country_flag = ehof_trader_already_finding
				has_country_flag = ehof_has_pox_sample
				has_relic = r_pox_sample
				has_relic = r_ehof_pox_sample
			}
		}
		allow = {
			resource_stockpile_compare = {
				resource = ehof_sr_negative_mass
				value >= @ehof_trader_pox_sample_finders
			}
		}
		name = "ehof_mega_trader_pox_sample"
		custom_tooltip = "ehof_mega_trader_pox_sample_tooltip"
		set_country_flag = ehof_trader_find_pox_sample
		add_resource = { ehof_sr_negative_mass = @ehof_trader_pox_sample_finders_deduct }
		hidden_effect = {
			set_timed_country_flag = { flag = ehof_trader_already_finding years = 10 }
			remove_country_flag = ehof_trader_diplomacy
			country_event = { id = ehof_mega_trader.112 }
		}
	}

	# cryo_core
	option = {
		custom_gui = "enclave_ehof_trader_option"
		trigger = {
			has_ancrel = yes
			NOR = {
				has_country_flag = ehof_trader_already_finding
				has_country_flag = ehof_has_cryo_core
				has_relic = r_cryo_core
				has_relic = r_ehof_cryo_core
			}
		}
		allow = {
			resource_stockpile_compare = {
				resource = ehof_sr_negative_mass
				value >= @ehof_trader_cryo_core_finders
			}
		}
		name = "ehof_mega_trader_cryo_core"
		custom_tooltip = "ehof_mega_trader_cryo_core_tooltip"
		set_country_flag = ehof_trader_find_cryo_core
		add_resource = { ehof_sr_negative_mass = @ehof_trader_cryo_core_finders_deduct }
		hidden_effect = {
			set_timed_country_flag = { flag = ehof_trader_already_finding years = 10 }
			remove_country_flag = ehof_trader_diplomacy
			country_event = { id = ehof_mega_trader.112 }
		}
	}

	# war_forge
	option = {
		custom_gui = "enclave_ehof_trader_option"
		trigger = {
			has_ancrel = yes
			NOR = {
				has_country_flag = ehof_trader_already_finding
				has_country_flag = ehof_has_war_forge
				has_relic = r_war_forge
				has_relic = r_ehof_war_forge
			}
		}
		allow = {
			resource_stockpile_compare = {
				resource = ehof_sr_negative_mass
				value >= @ehof_trader_war_forge_finders
			}
		}
		name = "ehof_mega_trader_war_forge"
		custom_tooltip = "ehof_mega_trader_war_forge_tooltip"
		set_country_flag = ehof_trader_find_war_forge
		add_resource = { ehof_sr_negative_mass = @ehof_trader_war_forge_finders_deduct }
		hidden_effect = {
			set_timed_country_flag = { flag = ehof_trader_already_finding years = 10 }
			remove_country_flag = ehof_trader_diplomacy
			country_event = { id = ehof_mega_trader.112 }
		}
	}

	option = {	# Go back
		custom_gui = "enclave_ehof_trader_option"
		name = "ehof_goback"
		hidden_effect = {
			remove_country_flag = ehof_trader_diplomacy
			country_event = { id = ehof_mega_trader.101 }
		}
	}
}

# We'll find it
country_event = {
	id = ehof_mega_trader.112
	title = "ehof_mega_trader.002.name"
	diplomatic = yes
	custom_gui = "enclave_ehof_trader_window"
	is_triggered_only = yes
	picture_event_data = {
		portrait = event_target:urmazin_country
		graphical_culture = event_target:urmazin_country
		room = "shroud2_room"
	}
	location = event_target:urmazin_capital
	desc = { trigger = { has_country_flag = ehof_trader_find_dragon_trophy }		text = "ehof_mega_trader.112.desc_01" }
	desc = { trigger = { has_country_flag = ehof_trader_find_khans_throne }			text = "ehof_mega_trader.112.desc_02" }
	desc = { trigger = { has_country_flag = ehof_trader_find_worm_scales }			text = "ehof_mega_trader.112.desc_03" }
	desc = { trigger = { has_country_flag = ehof_trader_find_rubricator }			text = "ehof_mega_trader.112.desc_04" }
	desc = { trigger = { has_country_flag = ehof_trader_find_galaxy }				text = "ehof_mega_trader.112.desc_05" }
	desc = { trigger = { has_country_flag = ehof_trader_find_omnicodex }			text = "ehof_mega_trader.112.desc_06" }
	desc = { trigger = { has_country_flag = ehof_trader_find_surveyor }				text = "ehof_mega_trader.112.desc_07" }
	desc = { trigger = { has_country_flag = ehof_trader_find_galatron }				text = "ehof_mega_trader.112.desc_08" }
	desc = { trigger = { has_country_flag = ehof_trader_find_ancient_sword }		text = "ehof_mega_trader.112.desc_09" }
	desc = { trigger = { has_country_flag = ehof_trader_find_severed_head }			text = "ehof_mega_trader.112.desc_10" }
	desc = { trigger = { has_country_flag = ehof_trader_find_prethoryn_queen }		text = "ehof_mega_trader.112.desc_11" }
	desc = { trigger = { has_country_flag = ehof_trader_find_unbidden_warlock }		text = "ehof_mega_trader.112.desc_12" }
	desc = { trigger = { has_country_flag = ehof_trader_find_contingency_core }		text = "ehof_mega_trader.112.desc_13" }
	desc = { trigger = { has_country_flag = ehof_trader_find_zro_crystal }			text = "ehof_mega_trader.112.desc_14" }
	desc = { trigger = { has_country_flag = ehof_trader_find_the_last_baol }		text = "ehof_mega_trader.112.desc_15" }
	desc = { trigger = { has_country_flag = ehof_trader_find_the_defragmentor }		text = "ehof_mega_trader.112.desc_16" }
	desc = { trigger = { has_country_flag = ehof_trader_find_reality_perforator }	text = "ehof_mega_trader.112.desc_17" }
	desc = { trigger = { has_country_flag = ehof_trader_find_pox_sample }			text = "ehof_mega_trader.112.desc_18" }
	desc = { trigger = { has_country_flag = ehof_trader_find_cryo_core }			text = "ehof_mega_trader.112.desc_19" }
	desc = { trigger = { has_country_flag = ehof_trader_find_war_forge }			text = "ehof_mega_trader.112.desc_20" }

	immediate = { country_event = { id = ehof_mega_trader.113 days = 1800 random = 1800 } }
	option = {
		name = OK
		hidden_effect = {
			remove_country_flag = ehof_trader_diplomacy
			country_event = { id = ehof_mega_trader.101 }
		}
	}
}

# We found it
country_event = {
	id = ehof_mega_trader.113
	title = "ehof_mega_trader.002.name"
	diplomatic = yes
	custom_gui = "enclave_ehof_trader_window"
	is_triggered_only = yes
	picture_event_data = {
		portrait = event_target:urmazin_country
		graphical_culture = event_target:urmazin_country
		room = "shroud2_room"
	}
	location = event_target:urmazin_capital
	desc = { trigger = { has_country_flag = ehof_trader_find_dragon_trophy }		text = "ehof_mega_trader.113.desc_01" }
	desc = { trigger = { has_country_flag = ehof_trader_find_khans_throne }			text = "ehof_mega_trader.113.desc_02" }
	desc = { trigger = { has_country_flag = ehof_trader_find_worm_scales }			text = "ehof_mega_trader.113.desc_03" }
	desc = { trigger = { has_country_flag = ehof_trader_find_rubricator }			text = "ehof_mega_trader.113.desc_04" }
	desc = { trigger = { has_country_flag = ehof_trader_find_galaxy }				text = "ehof_mega_trader.113.desc_05" }
	desc = { trigger = { has_country_flag = ehof_trader_find_omnicodex }			text = "ehof_mega_trader.113.desc_06" }
	desc = { trigger = { has_country_flag = ehof_trader_find_surveyor }				text = "ehof_mega_trader.113.desc_07" }
	desc = { trigger = { has_country_flag = ehof_trader_find_galatron }				text = "ehof_mega_trader.113.desc_08" }
	desc = { trigger = { has_country_flag = ehof_trader_find_ancient_sword }		text = "ehof_mega_trader.113.desc_09" }
	desc = { trigger = { has_country_flag = ehof_trader_find_severed_head }			text = "ehof_mega_trader.113.desc_10" }
	desc = { trigger = { has_country_flag = ehof_trader_find_prethoryn_queen }		text = "ehof_mega_trader.113.desc_11" }
	desc = { trigger = { has_country_flag = ehof_trader_find_unbidden_warlock }		text = "ehof_mega_trader.113.desc_12" }
	desc = { trigger = { has_country_flag = ehof_trader_find_contingency_core }		text = "ehof_mega_trader.113.desc_13" }
	desc = { trigger = { has_country_flag = ehof_trader_find_zro_crystal }			text = "ehof_mega_trader.113.desc_14" }
	desc = { trigger = { has_country_flag = ehof_trader_find_the_last_baol }		text = "ehof_mega_trader.113.desc_15" }
	desc = { trigger = { has_country_flag = ehof_trader_find_the_defragmentor }		text = "ehof_mega_trader.113.desc_16" }
	desc = { trigger = { has_country_flag = ehof_trader_find_reality_perforator }	text = "ehof_mega_trader.113.desc_17" }
	desc = { trigger = { has_country_flag = ehof_trader_find_pox_sample }			text = "ehof_mega_trader.113.desc_18" }
	desc = { trigger = { has_country_flag = ehof_trader_find_cryo_core }			text = "ehof_mega_trader.113.desc_19" }
	desc = { trigger = { has_country_flag = ehof_trader_find_war_forge }			text = "ehof_mega_trader.113.desc_20" }

	option = { trigger = { has_country_flag = ehof_trader_find_dragon_trophy }		hidden_effect = { remove_country_flag = ehof_trader_find_dragon_trophy			set_country_flag = ehof_has_dragon_trophy }			add_relic = r_ehof_dragon_trophy		name = EXCELLENT }
	option = { trigger = { has_country_flag = ehof_trader_find_khans_throne }		hidden_effect = { remove_country_flag = ehof_trader_find_khans_throne			set_country_flag = ehof_has_khans_throne }			add_relic = r_ehof_khans_throne			name = EXCELLENT }
	option = { trigger = { has_country_flag = ehof_trader_find_worm_scales }		hidden_effect = { remove_country_flag = ehof_trader_find_worm_scales			set_country_flag = ehof_has_worm_scales }			add_relic = r_ehof_worm_scales			name = EXCELLENT }
	option = { trigger = { has_country_flag = ehof_trader_find_rubricator }			hidden_effect = { remove_country_flag = ehof_trader_find_rubricator				set_country_flag = ehof_has_rubricator }			add_relic = r_ehof_rubricator			name = EXCELLENT }
	option = { trigger = { has_country_flag = ehof_trader_find_galaxy }				hidden_effect = { remove_country_flag = ehof_trader_find_galaxy					set_country_flag = ehof_has_galaxy }				add_relic = r_ehof_galaxy				name = EXCELLENT }
	option = { trigger = { has_country_flag = ehof_trader_find_omnicodex }			hidden_effect = { remove_country_flag = ehof_trader_find_omnicodex				set_country_flag = ehof_has_omnicodex }				add_relic = r_ehof_omnicodex			name = EXCELLENT }
	option = { trigger = { has_country_flag = ehof_trader_find_surveyor }			hidden_effect = { remove_country_flag = ehof_trader_find_surveyor				set_country_flag = ehof_has_surveyor }				add_relic = r_ehof_surveyor				name = EXCELLENT }
	option = { trigger = { has_country_flag = ehof_trader_find_galatron }			hidden_effect = { remove_country_flag = ehof_trader_find_galatron				set_country_flag = ehof_has_galatron }				add_relic = r_ehof_galatron				name = EXCELLENT }
	option = { trigger = { has_country_flag = ehof_trader_find_ancient_sword }		hidden_effect = { remove_country_flag = ehof_trader_find_ancient_sword			set_country_flag = ehof_has_ancient_sword }			add_relic = r_ehof_ancient_sword		name = EXCELLENT }
	option = { trigger = { has_country_flag = ehof_trader_find_severed_head }		hidden_effect = { remove_country_flag = ehof_trader_find_severed_head			set_country_flag = ehof_has_severed_head }			add_relic = r_ehof_severed_head			name = EXCELLENT }
	option = { trigger = { has_country_flag = ehof_trader_find_prethoryn_queen }	hidden_effect = { remove_country_flag = ehof_trader_find_prethoryn_queen		set_country_flag = ehof_has_prethoryn_queen }		add_relic = r_ehof_prethoryn_queen		name = EXCELLENT }
	option = { trigger = { has_country_flag = ehof_trader_find_unbidden_warlock }	hidden_effect = { remove_country_flag = ehof_trader_find_unbidden_warlock		set_country_flag = ehof_has_unbidden_warlock }		add_relic = r_ehof_unbidden_warlock		name = EXCELLENT }
	option = { trigger = { has_country_flag = ehof_trader_find_contingency_core }	hidden_effect = { remove_country_flag = ehof_trader_find_contingency_core		set_country_flag = ehof_has_contingency_core }		add_relic = r_ehof_contingency_core		name = EXCELLENT }
	option = { trigger = { has_country_flag = ehof_trader_find_zro_crystal }		hidden_effect = { remove_country_flag = ehof_trader_find_zro_crystal			set_country_flag = ehof_has_zro_crystal }			add_relic = r_ehof_zro_crystal			name = EXCELLENT }
	option = { trigger = { has_country_flag = ehof_trader_find_the_last_baol }		hidden_effect = { remove_country_flag = ehof_trader_find_the_last_baol			set_country_flag = ehof_has_the_last_baol }			add_relic = r_ehof_the_last_baol		name = EXCELLENT }
	option = { trigger = { has_country_flag = ehof_trader_find_the_defragmentor }	hidden_effect = { remove_country_flag = ehof_trader_find_the_defragmentor		set_country_flag = ehof_has_the_defragmentor }		add_relic = r_ehof_the_defragmentor		name = EXCELLENT }
	option = { trigger = { has_country_flag = ehof_trader_find_reality_perforator }	hidden_effect = { remove_country_flag = ehof_trader_find_reality_perforator		set_country_flag = ehof_has_reality_perforator }	add_relic = r_ehof_reality_perforator	name = EXCELLENT }
	option = { trigger = { has_country_flag = ehof_trader_find_pox_sample }			hidden_effect = { remove_country_flag = ehof_trader_find_pox_sample				set_country_flag = ehof_has_pox_sample }			add_relic = r_ehof_pox_sample			name = EXCELLENT }
	option = { trigger = { has_country_flag = ehof_trader_find_cryo_core }			hidden_effect = { remove_country_flag = ehof_trader_find_cryo_core				set_country_flag = ehof_has_cryo_core }				add_relic = r_ehof_cryo_core			name = EXCELLENT }
	option = { trigger = { has_country_flag = ehof_trader_find_war_forge }			hidden_effect = { remove_country_flag = ehof_trader_find_war_forge				set_country_flag = ehof_has_war_forge }				add_relic = r_ehof_war_forge			name = EXCELLENT }
}

# Remove temporary relic
country_event = {
	id = ehof_mega_trader.102
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		OR = {
			has_relic = r_ehof_contingency_core
			has_relic = r_ehof_unbidden_warlock
			has_relic = r_ehof_prethoryn_queen
			has_relic = r_ehof_war_forge
			has_relic = r_ehof_cryo_core
			has_relic = r_ehof_pox_sample
			has_relic = r_ehof_reality_perforator
			has_relic = r_ehof_the_defragmentor
			has_relic = r_ehof_the_last_baol
			has_relic = r_ehof_zro_crystal
			has_relic = r_ehof_severed_head
			has_relic = r_ehof_ancient_sword
			has_relic = r_ehof_galatron
			has_relic = r_ehof_surveyor
			has_relic = r_ehof_omnicodex
			has_relic = r_ehof_galaxy
			has_relic = r_ehof_rubricator
			has_relic = r_ehof_worm_scales
			has_relic = r_ehof_khans_throne
			has_relic = r_ehof_dragon_trophy
		}
	}

	immediate = {
		if = { limit = { has_relic = r_contingency_core		has_relic = r_ehof_contingency_core }	remove_relic = r_ehof_contingency_core }
		if = { limit = { has_relic = r_unbidden_warlock		has_relic = r_ehof_unbidden_warlock }	remove_relic = r_ehof_unbidden_warlock }
		if = { limit = { has_relic = r_prethoryn_queen		has_relic = r_ehof_prethoryn_queen }	remove_relic = r_ehof_prethoryn_queen }
		if = { limit = { has_relic = r_war_forge			has_relic = r_ehof_war_forge }			remove_relic = r_ehof_war_forge }
		if = { limit = { has_relic = r_cryo_core			has_relic = r_ehof_cryo_core }			remove_relic = r_ehof_cryo_core }
		if = { limit = { has_relic = r_pox_sample			has_relic = r_ehof_pox_sample }			remove_relic = r_ehof_pox_sample }
		if = { limit = { has_relic = r_reality_perforator	has_relic = r_ehof_reality_perforator }	remove_relic = r_ehof_reality_perforator }
		if = { limit = { has_relic = r_the_defragmentor		has_relic = r_ehof_the_defragmentor }	remove_relic = r_ehof_the_defragmentor }
		if = { limit = { has_relic = r_the_last_baol		has_relic = r_ehof_the_last_baol }		remove_relic = r_ehof_the_last_baol }
		if = { limit = { has_relic = r_zro_crystal			has_relic = r_ehof_zro_crystal }		remove_relic = r_ehof_zro_crystal }
		if = { limit = { has_relic = r_severed_head			has_relic = r_ehof_severed_head }		remove_relic = r_ehof_severed_head }
		if = { limit = { has_relic = r_ancient_sword		has_relic = r_ehof_ancient_sword }		remove_relic = r_ehof_ancient_sword }
		if = { limit = { has_relic = r_galatron				has_relic = r_ehof_galatron }			remove_relic = r_ehof_galatron }
		if = { limit = { has_relic = r_surveyor				has_relic = r_ehof_surveyor }			remove_relic = r_ehof_surveyor }
		if = { limit = { has_relic = r_omnicodex			has_relic = r_ehof_omnicodex }			remove_relic = r_ehof_omnicodex }
		if = { limit = { has_relic = r_galaxy				has_relic = r_ehof_galaxy }				remove_relic = r_ehof_galaxy }
		if = { limit = { has_relic = r_rubricator			has_relic = r_ehof_rubricator }			remove_relic = r_ehof_rubricator }
		if = { limit = { has_relic = r_worm_scales			has_relic = r_ehof_worm_scales }		remove_relic = r_ehof_worm_scales }
		if = { limit = { has_relic = r_khans_throne			has_relic = r_ehof_khans_throne }		remove_relic = r_ehof_khans_throne }
		if = { limit = { has_relic = r_dragon_trophy		has_relic = r_ehof_dragon_trophy }		remove_relic = r_ehof_dragon_trophy }
	}
}

# Remove wormholes
fleet_event = {
	id = ehof_mega_trader.103
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		remove_auto_move_target = yes
		clear_fleet_actions = this
		clear_orders = yes
		if = {
			limit = { owner = { NOT = { any_owned_fleet = { exists = solar_system solar_system = { urmazin_system = yes } } } } }
			from = {
				remove_star_flag = ehof_trader_wormhole_active_@root.owner
				save_event_target_as = ehof_remove_wormhole_one
			}
			fromfrom = { save_event_target_as = ehof_remove_wormhole_two }
			owner = { country_event = { id = ehof_mega_trader.108 days = 2 } }
		}
	}
}

country_event = {
	id = ehof_mega_trader.108
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		event_target:ehof_remove_wormhole_one = {
			every_system_megastructure = {
				limit = {
					is_megastructure_type = ehof_trader_wormhole_external
					has_megastructure_flag = ehof_trader_wormhole_for_@root
				}
				delete_megastructure = this
			}
		}
		event_target:ehof_remove_wormhole_two = {
			every_system_megastructure = {
				limit = {
					is_megastructure_type = ehof_trader_wormhole_external
					has_megastructure_flag = ehof_trader_wormhole_for_@root
				}
				delete_megastructure = this
			}
		}
	}
}

country_event = {
	id = ehof_mega_trader.109
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		exists = event_target:urmazin_capital
		NOT = {
			any_owned_fleet = {
				exists = solar_system
				solar_system = { urmazin_system = yes }
			}
		}
		any_system_within_border = {
			any_system_megastructure = { has_megastructure_flag = ehof_trader_wormhole_for_@root }
		}
	}

	immediate = {
		random_system_within_border = {
			limit = { has_an_active_ehof = yes }
			remove_star_flag = ehof_trader_wormhole_active_@root.owner
			save_event_target_as = ehof_remove_wormhole_one
		}
		event_target:urmazin_capital = { save_event_target_as = ehof_remove_wormhole_two }
		country_event = { id = ehof_mega_trader.108 days = 2 }
	}
}

# Kick military fleets out
fleet_event = {
	id = ehof_mega_trader.104
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		owner = { NOT = { is_country_type = ehof_traders } }
		exists = solar_system
		solar_system = { urmazin_capital = yes }
	}
	immediate = {

		# Spawn trader wormholes
		event_target:urmazin_capital = {
			if = {
				limit = {
					NOT = {
						any_system_megastructure = {
							has_megastructure_flag = ehof_trader_external_nexus
							has_megastructure_flag = ehof_trader_wormhole_for_@root.owner
						}
					}
				}
				spawn_megastructure = {
					type = "ehof_trader_wormhole_external"
					orbit_angle = @ehof_wormhole_angle
					orbit_distance = @ehof_wormhole_distance
					owner = event_target:urmazin_country
					init_effect = {
						set_megastructure_flag = ehof_trader_external_nexus
						set_megastructure_flag = ehof_trader_wormhole_for_@root.owner
					}
				}
			}
		}
		owner = {
			random_system_within_border = {
				limit = { has_an_active_ehof = yes }
				set_star_flag = ehof_trader_wormhole_active_@root.owner
				if = {
					limit = {
						NOT = {
							any_system_megastructure = {
								has_megastructure_flag = ehof_trader_external_node
								has_megastructure_flag = ehof_trader_wormhole_for_@root.owner
							}
						}
					}
					spawn_megastructure = {
						type = "ehof_trader_wormhole_external"
						orbit_distance = @ehof_wormhole_distance
						owner = event_target:urmazin_country
						init_effect = {
							set_megastructure_flag = ehof_trader_external_node
							set_megastructure_flag = ehof_trader_wormhole_for_@root.owner
						}
					}
				}
			}
		}

		if = {
			limit = {
				OR = {
					is_ship_class = shipclass_transport
					is_ship_class = shipclass_military
					is_ship_class = shipclass_military_special
					AND = {
						is_ship_class = shipclass_starbase
						NOT = { is_ship_size = starbase_caravaneer }
					}
				}
			}
			# Send fleet home
			remove_auto_move_target = yes
			clear_fleet_actions = this
			clear_orders = yes
			root.owner = {
				random_system_within_border = {
					limit = { has_an_active_ehof = yes }
					star = { save_event_target_as = ehof_trader_evict_fleet }
				}
			}
			auto_move_to_planet = {
				target = event_target:ehof_trader_evict_fleet
				clear_auto_move_on_arrival = no
			}
			fleet_event = { id = ehof_mega_trader.008 } # Notify player, no military vessels are allowed here
		}
	}
}

# remove country flag if you disband instead of taking wormhole
country_event = {
	id = ehof_mega_trader.106
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		exists = event_target:urmazin_capital
		NOR = {
			is_country_type = compound_empire
			any_owned_fleet = {
				exists = solar_system
				solar_system = { urmazin_system = yes }
				NOT = { is_same_value = root.from }
			}
		}
	}

	immediate = {
		random_system_within_border = {
			limit = { has_an_active_ehof = yes }
			remove_star_flag = ehof_trader_wormhole_active_@root
			every_system_megastructure = {
				limit = {
					is_megastructure_type = ehof_trader_wormhole_external
					has_megastructure_flag = ehof_trader_wormhole_for_@root
				}
				delete_megastructure = this
			}
		}
		event_target:urmazin_capital = {
			every_system_megastructure = {
				limit = {
					is_megastructure_type = ehof_trader_wormhole_external
					has_megastructure_flag = ehof_trader_wormhole_for_@root
				}
				delete_megastructure = this
			}
		}
	}
}