#####################################
### Here, There Be Dragons Events ###
### by Gogabor			  ###
#####################################
#
# These events help AI to communicate with dragons like player does
#

namespace = htbd_ai

# alternative dragon incubation
country_event = {
	id = htbd_ai.92
	hide_window = yes

	is_triggered_only = yes

	trigger = {
		is_ai = yes
		has_country_flag = htbd_dragonborn_done
		has_technology = tech_society_2
		has_technology = tech_mining_2
		check_variable = {
			which = htbd_num_eggs
			value > 0
		}
		any_planet_within_border = {
			OR = {
				is_planet_class = pc_molten
				is_planet_class = pc_shattered
			}
			is_colony = no
			NOT = { has_planet_flag = egg_incubated	}
		}
	}

	immediate = {
		if = {
			limit = { htbd_debug_egg = yes }
			log = "[This.GetName] forced to incube dragon!"
		}
		# need planet
		random_planet_within_border = {
			limit = {
				OR = {
					is_planet_class = pc_molten
					is_planet_class = pc_shattered
				}
				is_colony = no
				NOT = { has_planet_flag = egg_incubated	}
			}
			prev = { subtract_variable = { which = htbd_num_eggs value = 1 } }
			enable_special_project = {
				name = "HTBD_DRAGON_AI_INCUBATION"
				location = this
				owner = prev
			}
		}
	}
}

event = {
	id = htbd_ai.1
	hide_window = yes

	is_triggered_only = yes

	immediate = {
		every_country = {
			limit = {
				is_ai = yes
				is_country_type = default
				has_country_flag = htbd_dragonborn_done
				check_variable = {
					which = htbd_num_eggs
					value > 0
				}
			}
			country_event = { id = htbd_ai.92 }
		}
	}
}
