############################
#
# Star Events
#
# Written by Annatar
#
############################

namespace = newfrontiers_star_event

#### Catastroph Regular Star ####

# Regular Star 1
planet_event = {
	id = newfrontiers_star_event.1
	hide_window = yes
	
	trigger = {
		#has_planet_flag = test_anomaly
		OR = {
			is_planet_class = pc_k_star
			is_planet_class = pc_g_star
			is_planet_class = pc_f_star
		}
		NOR = {
			has_global_flag = catastroph_regular_star
			has_planet_flag = evolved_star_5
			has_planet_flag = evolved_star_10
			has_planet_flag = evolved_star_30
			has_planet_flag = evolved_star_50
			has_planet_flag = evolved_star_100
		}
		solar_system = {
			NOR = { 
				has_star_flag = dyson_sphere_built
				has_star_flag = AI_hub
				has_star_flag = cybrex_beta
				has_star_flag = guardian
				has_star_flag = guardians_of_zanaam
				has_star_flag = sanctuary_system
				has_star_flag = hyacinth_system
				has_star_flag = ai_system
				has_star_flag = sentinel_system
				has_star_flag = vultaumar
				has_star_flag = yuhtaan
				has_star_flag = fen_habbanis
				has_star_flag = irass 
				has_star_flag = cybrex
				has_star_flag = ruined_dyson_system
				AND = {
					has_star_flag = ruined_ring_system
					any_system_megastructure = { is_megastructure_type = ring_world_ruined }
				}
			}
		}
	}
	
	is_triggered_only = yes
	
	immediate = {
		set_global_flag = catastroph_regular_star
		save_event_target_as = evolved_regular_star
		random_list = {
			25 = { 
				planet_event = { id = newfrontiers_star_event.2 days = 1825 } # 5 Years
				set_planet_flag = evolved_star_5
			}
			25 = {
				planet_event = { id = newfrontiers_star_event.2 days = 3650 } # 10 Years
				set_planet_flag = evolved_star_10
			}
			25 = {
				planet_event = { id = newfrontiers_star_event.2 days = 10950 } # 30 Years
				set_planet_flag = evolved_star_30
			}
			25 = {
				planet_event = { id = newfrontiers_star_event.2 days = 18250 } # 50 Years
				set_planet_flag = evolved_star_50
			}
			25 = {
				planet_event = { id = newfrontiers_star_event.2 days = 36500 } # 100 Years
				set_planet_flag = evolved_star_100
			}
		}
		if = {
			limit = { exists = space_owner }
			space_owner = {
				country_event = { id = newfrontiers_star_event.3}
			}
		}
	}
}

# Regular Star 2
planet_event = {
	id = newfrontiers_star_event.2
	hide_window = yes
	
	trigger = {
		solar_system = {
			NOT = { has_star_flag = dyson_sphere_built }
		}
	}
	
	is_triggered_only = yes
	
	immediate = {
		switch = {
			trigger = is_planet_class
			pc_k_star = { 
				change_pc = pc_k_giant_star 
			}
			pc_g_star = { 
				change_pc = pc_g_giant_star 
			}
			pc_f_star = { 
				change_pc = pc_g_giant_star 
			}
		}
		reset_planet = yes
		
		solar_system = {
			every_system_planet = {
				limit = { has_planet_flag = hot_zone }
				switch = {
					trigger = is_planet_class
					pc_gas_giant = { 
						change_pc = pc_molten
						reset_planet = yes
						add_modifier = {
							modifier = "chthonian_planet"
							days = -1
						}
					}
					pc_barren = { 
						change_pc = pc_molten 
						reset_planet = yes
					}
					pc_barren_cold = { 
						change_pc = pc_barren 
						reset_planet = yes
					}
					pc_toxic = { 
						change_pc = pc_molten 
						reset_planet = yes
					}
				}
				if = {
					limit = { has_owner = yes }
					planet_event = { id = newfrontiers_star_event.4 days = 3}
				}
				if = {
					limit = { 
						is_colonizable = yes
						has_owner = no
					}
					change_pc = pc_molten
					reset_planet = yes
				}
			}
			every_system_planet = {
				limit = {
					is_ringworld = no
					NOT = {	is_planet_class = pc_habitat }
					has_owner = yes 
				}
				planet_event = { id = newfrontiers_star_event.5 days = 3}
			}
			every_system_planet = {
				limit = {
					is_colonizable = yes
					is_ringworld = no
					NOT = {	is_planet_class = pc_habitat }
					has_owner = no 
				}
				random_list = {
					50 = {
						change_pc = pc_arid
						reset_planet = yes
					}
					50 = {
						change_pc = pc_desert
						reset_planet = yes
					}
				}
			}
			every_system_planet = {
				limit = { is_planet_class = pc_ringworld_habitable }
				change_pc = pc_ringworld_habitable_damaged
				reset_planet = yes
				add_modifier = {
					modifier = "lost_world"
					days = -1
				}
				space_owner = {
					country_event = { id = newfrontiers_star_event.12}
				}
			}
		}
		remove_global_flag = catastroph_regular_star
		if = {
			limit = { exists = space_owner }
			space_owner = {
				country_event = { id = newfrontiers_star_event.11}
			}
		}
	}
}

# Evolved Star Message
country_event = {
	id = newfrontiers_star_event.3
	title = "newfrontiers_star_event.3.name"
	desc = "newfrontiers_star_event.3.desc"
	picture = GFX_evt_star_yellow
	show_sound = event_mystic_reveal
	location = event_target:evolved_regular_star

	is_triggered_only = yes
	
	trigger = {
		has_global_flag = catastroph_regular_star
		NOT = { has_country_flag = catastrophic_regular_star }
	}
	
	immediate = {
		set_country_flag = catastrophic_regular_star
	}

	option = {
		name = INTERESTING
		event_target:evolved_regular_star = {
			enable_special_project = {
				name = "EVOLVED_REGULAR_STAR_PROJECT"
				location = this
				owner = root
			}
		}
	}
}

# Regular Star 3 (In Colony)
planet_event = {
	id = newfrontiers_star_event.4
	title = "newfrontiers_star_event.4.name"
	desc = "newfrontiers_star_event.4.desc"
	picture = GFX_evt_molten
	show_sound = event_air_raid_siren
	location = ROOT
	
	is_triggered_only = yes
	
	immediate = {
		change_pc = pc_molten
		destroy_colony = yes
		reset_planet = yes
	}
	
	option = {
		name = TERRIBLE
		custom_tooltip = newfrontiers_star_event.destroy_colony.tooltip
		add_modifier = {
			modifier = "lost_world"
			days = -1
		}
		add_deposit = d_society_5
	}
}

# Regular Star 4 (In Colony)
planet_event = {
	id = newfrontiers_star_event.5
	title = "newfrontiers_star_event.5.name"
	desc = "newfrontiers_star_event.5.desc"
	picture = GFX_evt_colony_settlement
	show_sound = event_air_raid_siren
	location = ROOT
	
	is_triggered_only = yes
	
	option = {
		name = TERRIBLE
		hidden_effect = {
			random_list = {
					50 = {
						change_pc = pc_arid
						reset_planet = yes
					}
					50 = {
						change_pc = pc_desert
						reset_planet = yes
					}
			}
			random_list = {
				50 = {
					if = {
						limit = { NOT = { has_planet_modifier = "pm_prolonged_drought" } }
						add_modifier = {
							modifier = "prolonged_drought"
							days = -1
						}
						custom_tooltip = newfrontiers_star_event.5.b.tooltip
					}
				}
				50 = {
					if = {
						limit = { NOT = { has_planet_modifier = "pm_heavy_sandstorms" } }
						add_modifier = {
							modifier = "heavy_sandstorms"
							days = -1
						}
						custom_tooltip = newfrontiers_star_event.5.c.tooltip
					}
				}
			}
		}
	}
}

# Special Project Completed 1
country_event = {
	id = newfrontiers_star_event.6
	title = "PROJECT_COMPLETE"
	desc = "newfrontiers_star_event.6.desc"
	picture = GFX_evt_star_yellow
	show_sound = event_mystic_reveal

	is_triggered_only = yes
	
	trigger = {
		has_global_flag = catastroph_regular_star
	}
	
	immediate = {
		set_country_flag = catastrophic_regular_star
	}

	option = {
		name = "newfrontiers_star_event.warn_settlements"
		from = {
			solar_system = {
				every_system_planet = {
					limit = { has_owner = yes }
					if = {
						limit = {
							OR = {
								has_planet_flag = hot_zone
								is_planet_class = pc_ringworld_habitable
							}
						}
						add_modifier = {
							modifier = "apocalypse"
							days = 1825
						}
					}
					else = {
						if = {
							limit = { NOT = { is_planet_class = pc_habitat } }
							add_modifier = {
								modifier = "catastrophe_approach"
								days = 1825
							}
						}
					}
				}
			}
		}
	}
	
	option = {
		name = "newfrontiers_star_event.keep_secret"
	}
}

# Special Project Completed 2
country_event = {
	id = newfrontiers_star_event.7
	title = "PROJECT_COMPLETE"
	desc = "newfrontiers_star_event.7.desc"
	picture = GFX_evt_star_yellow
	show_sound = event_mystic_reveal

	is_triggered_only = yes
	
	trigger = {
		has_global_flag = catastroph_regular_star
	}
	
	immediate = {
		set_country_flag = catastrophic_regular_star
	}

	option = {
		name = "newfrontiers_star_event.warn_settlements"
		from = {
			solar_system = {
				every_system_planet = {
					limit = { has_owner = yes }
					if = {
						limit = {
							OR = {
								has_planet_flag = hot_zone
								is_planet_class = pc_ringworld_habitable
							}
						}
						add_modifier = {
							modifier = "apocalypse"
							days = 3650
						}
					}
					else = {
						if = {
							limit = { NOT = { is_planet_class = pc_habitat } }
							add_modifier = {
								modifier = "catastrophe_approach"
								days = 3650
							}
						}
					}
				}
			}
		}
	}
	
	option = {
		name = "newfrontiers_star_event.keep_secret"
	}
}

# Special Project Completed 3
country_event = {
	id = newfrontiers_star_event.8
	title = "PROJECT_COMPLETE"
	desc = "newfrontiers_star_event.8.desc"
	picture = GFX_evt_star_yellow
	show_sound = event_mystic_reveal

	is_triggered_only = yes
	
	trigger = {
		has_global_flag = catastroph_regular_star
	}
	
	immediate = {
		set_country_flag = catastrophic_regular_star
	}

	option = {
		name = "newfrontiers_star_event.warn_settlements"
		from = {
			solar_system = {
				every_system_planet = {
					limit = { has_owner = yes }
					if = {
						limit = {
							OR = {
								has_planet_flag = hot_zone
								is_planet_class = pc_ringworld_habitable
							}
						}
						add_modifier = {
							modifier = "apocalypse"
							days = 3650
						}
					}
					else = {
						if = {
							limit = { NOT = { is_planet_class = pc_habitat } }
							add_modifier = {
								modifier = "catastrophe_approach"
								days = 3650
							}
						}
					}
				}
			}
		}
	}
	
	option = {
		name = "newfrontiers_star_event.keep_secret"
	}
}

# Special Project Completed 4
country_event = {
	id = newfrontiers_star_event.9
	title = "PROJECT_COMPLETE"
	desc = "newfrontiers_star_event.9.desc"
	picture = GFX_evt_star_yellow
	show_sound = event_mystic_reveal

	is_triggered_only = yes
	
	trigger = {
		has_global_flag = catastroph_regular_star
	}
	
	immediate = {
		set_country_flag = catastrophic_regular_star
	}

	option = {
		name = "newfrontiers_star_event.warn_settlements"
		from = {
			solar_system = {
				every_system_planet = {
					limit = { has_owner = yes }
					if = {
						limit = {
							OR = {
								has_planet_flag = hot_zone
								is_planet_class = pc_ringworld_habitable
							}
						}
						add_modifier = {
							modifier = "apocalypse"
							days = 3650
						}
					}
					else = {
						if = {
							limit = { NOT = { is_planet_class = pc_habitat } }
							add_modifier = {
								modifier = "catastrophe_approach"
								days = 3650
							}
						}
					}
				}
			}
		}
	}
	
	option = {
		name = "newfrontiers_star_event.keep_secret"
	}
}

# Special Project Completed 5
country_event = {
	id = newfrontiers_star_event.10
	title = "PROJECT_COMPLETE"
	desc = "newfrontiers_star_event.10.desc"
	picture = GFX_evt_star_yellow
	show_sound = event_mystic_reveal

	is_triggered_only = yes
	
	trigger = {
		has_global_flag = catastroph_regular_star
	}
	
	immediate = {
		set_country_flag = catastrophic_regular_star
	}

	option = {
		name = "newfrontiers_star_event.warn_settlements"
		from = {
			solar_system = {
				every_system_planet = {
					limit = { has_owner = yes }
					if = {
						limit = {
							OR = {
								has_planet_flag = hot_zone
								is_planet_class = pc_ringworld_habitable
							}
						}
						add_modifier = {
							modifier = "apocalypse"
							days = 3650
						}
					}
					else = {
						if = {
							limit = { NOT = { is_planet_class = pc_habitat } }
							add_modifier = {
								modifier = "catastrophe_approach"
								days = 3650
							}
						}
					}
				}
			}
		}
	}
	
	option = {
		name = "newfrontiers_star_event.keep_secret"
	}
}

# Catastrophe Star Message
country_event = {
	id = newfrontiers_star_event.11
	title = "newfrontiers_star_event.11.name"
	desc = "newfrontiers_star_event.11.desc"
	picture = GFX_evt_star_yellow
	show_sound = event_air_raid_siren
	location = event_target:evolved_regular_star
	
	is_triggered_only = yes

	option = {
		name = UNFORTUNATE
	}
}

# Destruction Ring World Message
country_event = {
	id = newfrontiers_star_event.12
	title = "newfrontiers_star_event.12.name"
	desc = "newfrontiers_star_event.12.desc"
	picture = GFX_evt_star_yellow
	show_sound = event_air_raid_siren
	location = event_target:evolved_regular_star
	
	is_triggered_only = yes

	option = {
		name = TERRIBLE
	}
}

# Star surveyed
planet_event = {
	id = newfrontiers_star_event.13
	hide_window = yes

	is_triggered_only = yes
	
	trigger = {
		has_global_flag = catastrophic_event_on
		is_star = yes
		OR = {
			has_planet_flag = evolved_star_5
			has_planet_flag = evolved_star_10
			has_planet_flag = evolved_star_30
			has_planet_flag = evolved_star_50
			has_planet_flag = evolved_star_100
		}
		solar_system = {
			NOT = { has_star_flag = dyson_sphere_built }
		}
	}

	immediate = {
		if = {
			limit = { exists = space_owner }
			space_owner = {
				country_event = { id = newfrontiers_star_event.3}
			}
		}
	}
}

#### Catastroph Giant Star ####

# Giant Star 1
planet_event = {
	id = newfrontiers_star_event.14
	hide_window = yes
	
	trigger = {
		#has_planet_flag = test_anomaly
		OR = {
			is_planet_class = pc_m_giant_star
			is_planet_class = pc_k_giant_star
			is_planet_class = pc_g_giant_star
			is_planet_class = pc_a_star
			is_planet_class = pc_b_star
		}
		NOR = {
			has_global_flag = catastroph_giant_star
			has_planet_flag = evolved_giant_star_5
			has_planet_flag = evolved_giant_star_10
			has_planet_flag = evolved_giant_star_30
			has_planet_flag = evolved_giant_star_50
			has_planet_flag = evolved_giant_star_100
		}
		solar_system = {
			NOR = { 
				has_star_flag = dyson_sphere_built
				has_star_flag = AI_hub
				has_star_flag = cybrex_beta
				has_star_flag = guardian
				has_star_flag = guardians_of_zanaam
				has_star_flag = sanctuary_system
				has_star_flag = hyacinth_system
				has_star_flag = ai_system
				has_star_flag = sentinel_system
				has_star_flag = vultaumar
				has_star_flag = yuhtaan
				has_star_flag = fen_habbanis
				has_star_flag = irass 
				has_star_flag = cybrex
				has_star_flag = ruined_dyson_system
				AND = {
					has_star_flag = ruined_ring_system
					any_system_megastructure = { is_megastructure_type = ring_world_ruined }
				}
			}
		}
	}
	
	is_triggered_only = yes
	
	immediate = {
		set_global_flag = catastroph_giant_star
		save_event_target_as = evolved_giant_star
		random_list = {
			25 = { 
				planet_event = { id = newfrontiers_star_event.15 days = 1825 } # 5 Years
				set_planet_flag = evolved_giant_star_5
			}
			25 = {
				planet_event = { id = newfrontiers_star_event.15 days = 3650 } # 10 Years
				set_planet_flag = evolved_giant_star_10
			}
			25 = {
				planet_event = { id = newfrontiers_star_event.15 days = 10950 } # 30 Years
				set_planet_flag = evolved_giant_star_30
			}
			25 = {
				planet_event = { id = newfrontiers_star_event.15 days = 18250 } # 50 Years
				set_planet_flag = evolved_giant_star_50
			}
			25 = {
				planet_event = { id = newfrontiers_star_event.15 days = 36500 } # 100 Years
				set_planet_flag = evolved_giant_star_100
			}
		}
		if = {
			limit = { exists = space_owner }
			space_owner = {
				country_event = { id = newfrontiers_star_event.16}
			}
		}
	}
}

# Giant Star 2
planet_event = {
	id = newfrontiers_star_event.15
	hide_window = yes
	
	trigger = {
		solar_system = {
			NOT = { has_star_flag = dyson_sphere_built }
		}
	}
	
	is_triggered_only = yes
	
	immediate = {
		switch = {
			trigger = is_planet_class
			pc_m_giant_star = { 
				change_pc = pc_m_super_star 
			}
			pc_k_giant_star = { 
				change_pc = pc_m_super_star 
			}
			pc_g_giant_star = { 
				change_pc = pc_k_super_star 
			}
			pc_a_star = {
				random_list = {
					50 = { change_pc = pc_a_super_star  }
					50 = { change_pc = pc_f_super_star  }
				}
			}
			pc_b_star = { 
				random_list = {
					50 = { change_pc = pc_b_super_star  }
					50 = { change_pc = pc_a_super_star  }
				}
			}
		}
		reset_planet = yes
		
		solar_system = {
			every_system_planet = {
				limit = { 
					has_planet_flag = hot_zone 
					has_owner = no
				}
				remove_planet = yes
			}
			every_system_planet = {
				limit = { 
					has_planet_flag = hot_zone
					has_owner = yes
				}
				planet_event = { id = newfrontiers_star_event.17 days = 3}
			}
			every_system_planet = {
				switch = {
					trigger = is_planet_class
					pc_barren = { 
						change_pc = pc_molten
						reset_planet = yes
					}
					pc_barren_cold = { 
						change_pc = pc_barren 
						reset_planet = yes
					}
					pc_toxic = { 
						change_pc = pc_molten 
						reset_planet = yes
					}
				}
			}
			every_system_planet = {
				limit = {
					is_ringworld = no
					NOT = {	is_planet_class = pc_habitat }
					has_owner = yes 
				}
				planet_event = { id = newfrontiers_star_event.18 days = 3}
			}
			every_system_planet = {
				limit = {
					is_colonizable = yes
					is_ringworld = no
					NOT = {	is_planet_class = pc_habitat }
					has_owner = no 
				}
				random_list = {
					50 = {
						change_pc = pc_molten
						reset_planet = yes
					}
					50 = {
						change_pc = pc_barren
						reset_planet = yes
					}
				}
			}
			every_system_planet = {
				limit = { is_planet_class = pc_ringworld_habitable }
				change_pc = pc_ringworld_habitable_damaged
				reset_planet = yes
				add_modifier = {
					modifier = "lost_world"
					days = -1
				}
				space_owner = {
					country_event = { id = newfrontiers_star_event.25}
				}
			}
		}
		remove_global_flag = catastroph_giant_star
		if = {
			limit = { exists = space_owner }
			space_owner = {
				country_event = { id = newfrontiers_star_event.24}
			}
		}
	}
}

# Evolved Star Message
country_event = {
	id = newfrontiers_star_event.16
	title = "newfrontiers_star_event.16.name"
	desc = "newfrontiers_star_event.16.desc"
	picture = GFX_evt_star_yellow
	show_sound = event_mystic_reveal
	location = event_target:evolved_giant_star

	is_triggered_only = yes
	
	trigger = {
		has_global_flag = catastroph_giant_star
		NOT = { has_country_flag = catastrophic_giant_star }
	}
	
	immediate = {
		set_country_flag = catastrophic_giant_star
	}

	option = {
		name = INTERESTING
		event_target:evolved_giant_star = {
			enable_special_project = {
				name = "EVOLVED_GIANT_STAR_PROJECT"
				location = this
				owner = root
			}
		}
	}
}

# Giant Star 3 (In Colony)
planet_event = {
	id = newfrontiers_star_event.17
	title = "newfrontiers_star_event.17.name"
	desc = "newfrontiers_star_event.17.desc"
	picture = GFX_evt_star_yellow
	show_sound = event_air_raid_siren
	location = ROOT
	
	is_triggered_only = yes
	
	immediate = {
		remove_planet = yes
	}
	
	option = {
		name = TERRIBLE
		custom_tooltip = newfrontiers_star_event.destroy_planet.tooltip
	}
}

# Giant Star 4 (In Colony)
planet_event = {
	id = newfrontiers_star_event.18
	title = "newfrontiers_star_event.18.name"
	desc = "newfrontiers_star_event.18.desc"
	picture = GFX_evt_molten
	show_sound = event_air_raid_siren
	location = ROOT
	
	is_triggered_only = yes
	
	immediate = {
		remove_planet = yes
		destroy_colony = yes
		change_pc = pc_molten
		reset_planet = yes
	}
	
	option = {
		name = TERRIBLE
		custom_tooltip = newfrontiers_star_event.destroy_colony.tooltip
		add_modifier = {
			modifier = "lost_world"
			days = -1
		}
		add_deposit = d_society_5
	}
}

# Special Project Completed 1
country_event = {
	id = newfrontiers_star_event.19
	title = "PROJECT_COMPLETE"
	desc = "newfrontiers_star_event.19.desc"
	picture = GFX_evt_star_yellow
	show_sound = event_mystic_reveal

	is_triggered_only = yes
	
	trigger = {
		has_global_flag = catastroph_giant_star
	}
	
	immediate = {
		set_country_flag = catastrophic_giant_star
	}

	option = {
		name = "newfrontiers_star_event.warn_settlements"
		from = {
			solar_system = {
				every_system_planet = {
					limit = { 
						has_owner = yes 
						NOT = { is_planet_class = pc_habitat }
					}
					add_modifier = {
						modifier = "apocalypse"
						days = 1825
					}
				}
			}
		}
	}
	
	option = {
		name = "newfrontiers_star_event.keep_secret"
	}
}

# Special Project Completed 2
country_event = {
	id = newfrontiers_star_event.20
	title = "PROJECT_COMPLETE"
	desc = "newfrontiers_star_event.20.desc"
	picture = GFX_evt_star_yellow
	show_sound = event_mystic_reveal

	is_triggered_only = yes
	
	trigger = {
		has_global_flag = catastroph_regular_star
	}
	
	immediate = {
		set_country_flag = catastrophic_regular_star
	}

	option = {
		name = "newfrontiers_star_event.warn_settlements"
		from = {
			solar_system = {
				every_system_planet = {
					limit = { 
						has_owner = yes 
						NOT = { is_planet_class = pc_habitat }
					}
					add_modifier = {
						modifier = "apocalypse"
						days = 3650
					}
				}
			}
		}
	}
	
	option = {
		name = "newfrontiers_star_event.keep_secret"
	}
}

# Special Project Completed 3
country_event = {
	id = newfrontiers_star_event.21
	title = "PROJECT_COMPLETE"
	desc = "newfrontiers_star_event.21.desc"
	picture = GFX_evt_star_yellow
	show_sound = event_mystic_reveal

	is_triggered_only = yes
	
	trigger = {
		has_global_flag = catastroph_regular_star
	}
	
	immediate = {
		set_country_flag = catastrophic_regular_star
	}

	option = {
		name = "newfrontiers_star_event.warn_settlements"
		from = {
			solar_system = {
				every_system_planet = {
					limit = { 
						has_owner = yes 
						NOT = { is_planet_class = pc_habitat }
					}
					add_modifier = {
						modifier = "apocalypse"
						days = 3650
					}
				}
			}
		}
	}
	
	option = {
		name = "newfrontiers_star_event.keep_secret"
	}
}

# Special Project Completed 4
country_event = {
	id = newfrontiers_star_event.22
	title = "PROJECT_COMPLETE"
	desc = "newfrontiers_star_event.22.desc"
	picture = GFX_evt_star_yellow
	show_sound = event_mystic_reveal

	is_triggered_only = yes
	
	trigger = {
		has_global_flag = catastroph_regular_star
	}
	
	immediate = {
		set_country_flag = catastrophic_regular_star
	}

	option = {
		name = "newfrontiers_star_event.warn_settlements"
		from = {
			solar_system = {
				every_system_planet = {
					limit = { 
						has_owner = yes 
						NOT = { is_planet_class = pc_habitat }
					}
					add_modifier = {
						modifier = "apocalypse"
						days = 3650
					}
				}
			}
		}
	}
	
	option = {
		name = "newfrontiers_star_event.keep_secret"
	}
}

# Special Project Completed 5
country_event = {
	id = newfrontiers_star_event.23
	title = "PROJECT_COMPLETE"
	desc = "newfrontiers_star_event.23.desc"
	picture = GFX_evt_star_yellow
	show_sound = event_mystic_reveal

	is_triggered_only = yes
	
	trigger = {
		has_global_flag = catastroph_regular_star
	}
	
	immediate = {
		set_country_flag = catastrophic_regular_star
	}

	option = {
		name = "newfrontiers_star_event.warn_settlements"
		from = {
			solar_system = {
				every_system_planet = {
					limit = { 
						has_owner = yes 
						NOT = { is_planet_class = pc_habitat }
					}
					add_modifier = {
						modifier = "apocalypse"
						days = 3650
					}
				}
			}
		}
	}
	
	option = {
		name = "newfrontiers_star_event.keep_secret"
	}
}

# Catastrophe Star Message
country_event = {
	id = newfrontiers_star_event.24
	title = "newfrontiers_star_event.24.name"
	desc = "newfrontiers_star_event.24.desc"
	picture = GFX_evt_star_yellow
	show_sound = event_air_raid_siren
	location = event_target:evolved_giant_star
	
	is_triggered_only = yes

	option = {
		name = UNFORTUNATE
	}
}

# Destruction Ring World Message
country_event = {
	id = newfrontiers_star_event.25
	title = "newfrontiers_star_event.25.name"
	desc = "newfrontiers_star_event.25.desc"
	picture = GFX_evt_star_yellow
	show_sound = event_air_raid_siren
	location = event_target:evolved_giant_star
	
	is_triggered_only = yes

	option = {
		name = TERRIBLE
	}
}

# Star surveyed
planet_event = {
	id = newfrontiers_star_event.26
	hide_window = yes

	is_triggered_only = yes
	
	trigger = {
		has_global_flag = catastrophic_event_on
		is_star = yes
		OR = {
			has_planet_flag = evolved_giant_star_5
			has_planet_flag = evolved_giant_star_10
			has_planet_flag = evolved_giant_star_30
			has_planet_flag = evolved_giant_star_50
			has_planet_flag = evolved_giant_star_100
		}
		solar_system = {
			NOT = { has_star_flag = dyson_sphere_built }
		}
	}

	immediate = {
		if = {
			limit = { exists = space_owner }
			space_owner = {
				country_event = { id = newfrontiers_star_event.16}
			}
		}
	}
}


#### Supernova ####

# Supernova 1
planet_event = {
	id = newfrontiers_star_event.27
	hide_window = yes
	
	trigger = {
		#has_planet_flag = test_anomaly
		OR = {
			is_planet_class = pc_m_hyper_star
			is_planet_class = pc_o_hyper_star
		}
		NOR = {
			has_global_flag = catastroph_supernova
			has_planet_flag = evolved_supernova_5
			has_planet_flag = evolved_supernova_10
			has_planet_flag = evolved_supernova_30
			has_planet_flag = evolved_supernova_50
			has_planet_flag = evolved_supernova_100
		}
		solar_system = {
			NOR = { 
				has_star_flag = dyson_sphere_built
				has_star_flag = AI_hub
				has_star_flag = cybrex_beta
				has_star_flag = guardian
				has_star_flag = guardians_of_zanaam
				has_star_flag = sanctuary_system
				has_star_flag = hyacinth_system
				has_star_flag = ai_system
				has_star_flag = sentinel_system
				has_star_flag = vultaumar
				has_star_flag = yuhtaan
				has_star_flag = fen_habbanis
				has_star_flag = irass 
				has_star_flag = cybrex
				has_star_flag = ruined_dyson_system
				AND = {
					has_star_flag = ruined_ring_system
					any_system_megastructure = { is_megastructure_type = ring_world_ruined }
				}
			}
		}
	}
	
	is_triggered_only = yes
	
	immediate = {
		set_global_flag = catastroph_supernova
		save_event_target_as = supernova
		random_list = {
			25 = { 
				planet_event = { id = newfrontiers_star_event.28 days = 1825 } # 5 Years
				set_planet_flag = supernova_5
			}
			25 = {
				planet_event = { id = newfrontiers_star_event.28 days = 3650 } # 10 Years
				set_planet_flag = supernova_10
			}
			25 = {
				planet_event = { id = newfrontiers_star_event.28 days = 10950 } # 30 Years
				set_planet_flag = supernova_30
			}
			25 = {
				planet_event = { id = newfrontiers_star_event.28 days = 18250 } # 50 Years
				set_planet_flag = supernova_50
			}
			25 = {
				planet_event = { id = newfrontiers_star_event.28 days = 36500 } # 100 Years
				set_planet_flag = supernova_100
			}
		}
		if = {
			limit = { exists = space_owner }
			space_owner = {
				country_event = { id = newfrontiers_star_event.29 }
			}
		}
	}
}

# Supernova 2
planet_event = {
	id = newfrontiers_star_event.28
	hide_window = yes
	
	trigger = {
		solar_system = {
			NOT = { has_star_flag = dyson_sphere_built }
		}
	}
	
	is_triggered_only = yes
	
	immediate = {
		change_pc = pc_collapsar
		reset_planet = yes
		create_collapsar_space = yes

		if = {
			limit = { exists = space_owner }
			space_owner = {
				country_event = { id = newfrontiers_star_event.36}
			}
		}
		
		solar_system = {
			every_system_planet = {
				limit = { is_planet_class = pc_habitat }
				planet_event = { id = newfrontiers_star_event.30 days = 3}
			}
			every_system_planet = {
				switch = {
					trigger = is_planet_class
					pc_barren = {
						random_list = {
							50 = { change_pc = pc_molten  }
							50 = { change_pc = pc_broken  }
						}
						
					}
					pc_barren_cold = { 
						change_pc = pc_barren
					}
					pc_gas_giant = { 
						change_pc = pc_molten
						add_modifier = {
							modifier = "chthonian_planet"
							days = -1
						}
					}
					pc_toxic = { 
						change_pc = pc_molten
					}	
				}
				reset_planet = yes
			}
			every_fleet_in_system = { destroy_fleet = this }
		}
		remove_global_flag = catastroph_supernova
	}
}

# Evolved Star Message
country_event = {
	id = newfrontiers_star_event.29
	title = "newfrontiers_star_event.29.name"
	desc = "newfrontiers_star_event.29.desc"
	picture = GFX_evt_star_yellow
	show_sound = event_mystic_reveal
	location = event_target:supernova

	is_triggered_only = yes
	
	trigger = {
		has_global_flag = catastroph_supernova
		NOT = { has_country_flag = catastrophic_supernova }
	}
	
	immediate = {
		set_country_flag = catastrophic_supernova
	}

	option = {
		name = INTERESTING
		event_target:supernova = {
			enable_special_project = {
				name = "SUPERNOVA_PROJECT"
				location = this
				owner = root
			}
		}
	}
}

# Supernova 3 (In Colony)
planet_event = {
	id = newfrontiers_star_event.30
	title = "newfrontiers_star_event.30.name"
	desc = "newfrontiers_star_event.30.desc"
	picture = GFX_evt_star_yellow
	show_sound = event_air_raid_siren
	location = ROOT
	
	is_triggered_only = yes
	
	immediate = {
		remove_planet = yes
	}
	
	option = {
		name = TERRIBLE
		custom_tooltip = newfrontiers_star_event.destroy_planet.tooltip
	}
}

# Special Project Completed 1
country_event = {
	id = newfrontiers_star_event.31
	title = "PROJECT_COMPLETE"
	desc = "newfrontiers_star_event.31.desc"
	picture = GFX_evt_star_yellow
	show_sound = event_mystic_reveal

	is_triggered_only = yes
	
	trigger = {
		has_global_flag = catastroph_supernova
	}
	
	immediate = {
		set_country_flag = catastrophic_supernova
	}

	option = {
		name = "newfrontiers_star_event.warn_settlements"
		from = {
			solar_system = {
				every_system_planet = {
					limit = { 
						has_owner = yes 
						is_planet_class = pc_habitat
					}
					add_modifier = {
						modifier = "apocalypse"
						days = 1825
					}
				}
			}
		}
	}
	
	option = {
		name = "newfrontiers_star_event.keep_secret"
	}
}

# Special Project Completed 2
country_event = {
	id = newfrontiers_star_event.32
	title = "PROJECT_COMPLETE"
	desc = "newfrontiers_star_event.32.desc"
	picture = GFX_evt_star_yellow
	show_sound = event_mystic_reveal

	is_triggered_only = yes
	
	trigger = {
		has_global_flag = catastroph_supernova
	}
	
	immediate = {
		set_country_flag = catastrophic_supernova
	}

	option = {
		name = "newfrontiers_star_event.warn_settlements"
		from = {
			solar_system = {
				every_system_planet = {
					limit = { 
						has_owner = yes 
						is_planet_class = pc_habitat
					}
					add_modifier = {
						modifier = "apocalypse"
						days = 3600
					}
				}
			}
		}
	}
	
	option = {
		name = "newfrontiers_star_event.keep_secret"
	}
}

# Special Project Completed 3
country_event = {
	id = newfrontiers_star_event.33
	title = "PROJECT_COMPLETE"
	desc = "newfrontiers_star_event.33.desc"
	picture = GFX_evt_star_yellow
	show_sound = event_mystic_reveal

	is_triggered_only = yes
	
	trigger = {
		has_global_flag = catastroph_supernova
	}
	
	immediate = {
		set_country_flag = catastrophic_supernova
	}

	option = {
		name = "newfrontiers_star_event.warn_settlements"
		from = {
			solar_system = {
				every_system_planet = {
					limit = { 
						has_owner = yes 
						is_planet_class = pc_habitat
					}
					add_modifier = {
						modifier = "apocalypse"
						days = 3600
					}
				}
			}
		}
	}
	
	option = {
		name = "newfrontiers_star_event.keep_secret"
	}
}

# Special Project Completed 4
country_event = {
	id = newfrontiers_star_event.34
	title = "PROJECT_COMPLETE"
	desc = "newfrontiers_star_event.34.desc"
	picture = GFX_evt_star_yellow
	show_sound = event_mystic_reveal

	is_triggered_only = yes
	
	trigger = {
		has_global_flag = catastroph_supernova
	}
	
	immediate = {
		set_country_flag = catastrophic_supernova
	}

	option = {
		name = "newfrontiers_star_event.warn_settlements"
		from = {
			solar_system = {
				every_system_planet = {
					limit = { 
						has_owner = yes 
						is_planet_class = pc_habitat
					}
					add_modifier = {
						modifier = "apocalypse"
						days = 3600
					}
				}
			}
		}
	}
	
	option = {
		name = "newfrontiers_star_event.keep_secret"
	}
}

# Special Project Completed 5
country_event = {
	id = newfrontiers_star_event.35
	title = "PROJECT_COMPLETE"
	desc = "newfrontiers_star_event.35.desc"
	picture = GFX_evt_star_yellow
	show_sound = event_mystic_reveal

	is_triggered_only = yes
	
	trigger = {
		has_global_flag = catastroph_supernova
	}
	
	immediate = {
		set_country_flag = catastrophic_supernova
	}

	option = {
		name = "newfrontiers_star_event.warn_settlements"
		from = {
			solar_system = {
				every_system_planet = {
					limit = { 
						has_owner = yes 
						is_planet_class = pc_habitat
					}
					add_modifier = {
						modifier = "apocalypse"
						days = 3600
					}
				}
			}
		}
	}
	
	option = {
		name = "newfrontiers_star_event.keep_secret"
	}
}

# Catastrophe Star Message
country_event = {
	id = newfrontiers_star_event.36
	title = "newfrontiers_star_event.36.name"
	desc = "newfrontiers_star_event.36.desc"
	picture = GFX_evt_collapsar
	show_sound = event_air_raid_siren
	location = event_target:supernova
	
	is_triggered_only = yes

	option = {
		name = UNFORTUNATE
	}
}

# Star surveyed
planet_event = {
	id = newfrontiers_star_event.37
	hide_window = yes

	is_triggered_only = yes
	
	trigger = {
		has_global_flag = catastrophic_event_on
		is_star = yes
		OR = {
			has_planet_flag = supernova_5
			has_planet_flag = supernova_10
			has_planet_flag = supernova_30
			has_planet_flag = supernova_50
			has_planet_flag = supernova_100
		}
		solar_system = {
			NOT = { has_star_flag = dyson_sphere_built }
		}
	}

	immediate = {
		if = {
			limit = { exists = space_owner }
			space_owner = {
				country_event = { id = newfrontiers_star_event.29 }
			}
		}
	}
}

# Gatekeeper - Star Events
event = {
	id = newfrontiers_star_event.100
	hide_window = yes
	is_triggered_only = yes
	
	trigger = {
		has_global_flag = catastrophic_event_on
	}
	
	immediate = {
		random_list = {
			10 = { 
				#Catastroph Regular Star
				every_planet = {
					limit = { 
						OR = {
							is_planet_class = pc_k_star
							is_planet_class = pc_g_star
							is_planet_class = pc_f_star
						}
						NOT = {
							has_global_flag = catastroph_regular_star
							has_planet_flag = evolved_star_5
							has_planet_flag = evolved_star_10
							has_planet_flag = evolved_star_30
							has_planet_flag = evolved_star_50
							has_planet_flag = evolved_star_100
						}
						solar_system = {
							NOT = { 
								has_star_flag = dyson_sphere_built
								has_star_flag = AI_hub
								has_star_flag = cybrex_beta
								has_star_flag = guardian
								has_star_flag = guardians_of_zanaam
								has_star_flag = sanctuary_system
								has_star_flag = hyacinth_system
								has_star_flag = ai_system
								has_star_flag = sentinel_system
								has_star_flag = vultaumar
								has_star_flag = yuhtaan
								has_star_flag = fen_habbanis
								has_star_flag = irass 
								has_star_flag = cybrex
								has_star_flag = ruined_dyson_system
								AND = {
									has_star_flag = ruined_ring_system
									any_system_megastructure = { is_megastructure_type = ring_world_ruined }
								}
							}
						}
					}
					planet_event = { id = newfrontiers_star_event.1 days = 30 random = 90 }
				}
			}
			15 = {
				#Catastroph Giant Star
				every_planet = {
					limit = { 
						OR = {
							is_planet_class = pc_m_giant_star
							is_planet_class = pc_k_giant_star
							is_planet_class = pc_g_giant_star
							is_planet_class = pc_a_star
							is_planet_class = pc_b_star
						}
						NOT = {
							has_global_flag = catastroph_giant_star
							has_planet_flag = evolved_giant_star_5
							has_planet_flag = evolved_giant_star_10
							has_planet_flag = evolved_giant_star_30
							has_planet_flag = evolved_giant_star_50
							has_planet_flag = evolved_giant_star_100
						}
						solar_system = {
							NOT = { 
								has_star_flag = dyson_sphere_built
								has_star_flag = AI_hub
								has_star_flag = cybrex_beta
								has_star_flag = guardian
								has_star_flag = guardians_of_zanaam
								has_star_flag = sanctuary_system
								has_star_flag = hyacinth_system
								has_star_flag = ai_system
								has_star_flag = sentinel_system
								has_star_flag = vultaumar
								has_star_flag = yuhtaan
								has_star_flag = fen_habbanis
								has_star_flag = irass 
								has_star_flag = cybrex
								has_star_flag = ruined_dyson_system
								AND = {
									has_star_flag = ruined_ring_system
									any_system_megastructure = { is_megastructure_type = ring_world_ruined }
								}
							}
						}				
					}
					planet_event = { id = newfrontiers_star_event.14 days = 30 random = 90 }
				}
			}
			5 = {
				#Supernova
				every_planet = {
					limit = { 
						OR = {
							is_planet_class = pc_m_hyper_star
							is_planet_class = pc_o_hyper_star
						}
						NOT = {
							has_global_flag = catastroph_supernova
							has_planet_flag = evolved_supernova_5
							has_planet_flag = evolved_supernova_10
							has_planet_flag = evolved_supernova_30
							has_planet_flag = evolved_supernova_50
							has_planet_flag = evolved_supernova_100
						}
						solar_system = {
							NOT = { 
								has_star_flag = dyson_sphere_built
								has_star_flag = AI_hub
								has_star_flag = cybrex_beta
								has_star_flag = guardian
								has_star_flag = guardians_of_zanaam
								has_star_flag = sanctuary_system
								has_star_flag = hyacinth_system
								has_star_flag = ai_system
								has_star_flag = sentinel_system
								has_star_flag = vultaumar
								has_star_flag = yuhtaan
								has_star_flag = fen_habbanis
								has_star_flag = irass 
								has_star_flag = cybrex
								has_star_flag = ruined_dyson_system
								AND = {
									has_star_flag = ruined_ring_system
									any_system_megastructure = { is_megastructure_type = ring_world_ruined }
								}
							}
						}
					}
					planet_event = { id = newfrontiers_star_event.27 days = 30 random = 90 }
				}
			}
			70 = {
				#Null
			}
		}
	}
}
