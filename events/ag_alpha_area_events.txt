namespace = ag_alpha

# Hidden, Spawn the Alpha Area
country_event = {
    id = ag_alpha.1
    hide_window = yes
	is_triggered_only = yes
	
    immediate = {
		ag_spawn_ancient_system = { ag_system_to_spawn = "ag_ancient_alpha_init" }
		ag_spawned_system_effect = yes
		create_point_of_interest = {
			id = ag_alpha_area
			name = "ag_alpha_area"
			desc = "ag_alpha_area_desc"
			event_chain = ag_hidden_system_chain
			location = event_target:ag_ancient_alpha_star
		}
		random_system = {
			limit = { has_star_flag = ag_ancient_alpha_system }
			random_list = {
				33 = { }
				33 = { ag_add_extra_hyperlane = { ag_num = 1 } }
				33 = { ag_add_extra_hyperlane = { ag_num = 2 } }
			}
			reroll_random = yes
			ag_spawned_system_hyperlane_fixup = yes
		}
    }
	
	after = { hidden_effect = {
		every_country = {
			limit = { has_special_project = ag_located_alpha_area }
			abort_special_project = {
				type = "ag_located_alpha_area"
				location = capital_scope
			}
		}
	} }
}

# on_entering_system_fleet, Notification for entering the Alpha Area first time
fleet_event = {
	id = ag_alpha.2
	title = "ag_alpha.2.name"
	desc = "ag_alpha.2.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_ruined_system_room }
	show_sound = event_mystic_reveal_light
	location = root
	is_triggered_only = yes
	
	trigger = {
		from = { has_star_flag = ag_ancient_alpha_system }
		owner = {
			is_ai = no
			NOT = { has_country_flag = ag_alpha_area_entered }
		}
	}
	
	immediate = {
		owner = {
			set_country_flag = ag_alpha_area_entered
			ag_refresh_ancient_system_poi = { ag_system_id = ag_alpha_area }
		}
	}
	
	option = { name = "ag_alpha.2.a" }
	option = {
		name = "ag_alpha.2.b"
		custom_tooltip = "ag_alpha.2.b.tooltip"
		owner = { add_resource = { influence = @ag_end_event_influence_large } }
		hidden_effect = { owner = { set_country_flag = ag_alpha_event_stoped } }
	}
}

# on_survey, Notification, survey shrouded ringworld.
ship_event = {
	id = ag_alpha.3
	title = "ag_alpha.3.name"
	desc = "ag_alpha.3.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_shrouded_planet_room }
	show_sound = event_mystic_reveal
	location = root
	is_triggered_only = yes
	trigger = {
		from = {
			OR = {
				is_same_value = event_target:ag_ancient_alpha_shielded_world
				is_same_value = event_target:ag_ancient_alpha_shielded_world_2
			}
			is_planet_class = pc_ag_ringworld_shrouded
		}
		owner = {
			is_ai = no
			NOT = { has_country_flag = ag_alpha_3_fired }
		}
	}
	immediate = { owner = { set_country_flag = ag_alpha_3_fired } }
	option = { name = "ag_alpha.3.a" }
}

# on_survey, Notification, survey normal ringworld.
ship_event = {
	id = ag_alpha.4
	title = "ag_alpha.4.name"
	desc = "ag_alpha.4.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_arctic_planet_room }
	show_sound = event_primitive_civilization
	location = root
	is_triggered_only = yes
	trigger = {
		from = {
			OR = {
				is_same_value = event_target:ag_ancient_alpha_shielded_world
				is_same_value = event_target:ag_ancient_alpha_shielded_world_2
			}
			is_planet_class = pc_ag_ringworld_arctic
		}
		owner = {
			is_ai = no
			NOT = { has_country_flag = ag_alpha_3_fired }
		}
	}
	immediate = { owner = { set_country_flag = ag_alpha_3_fired } }
	option = { name = "ag_alpha.4.a" }
}

# Notification, shrouded ringworld in border swapped to normal.
country_event = {
	id = ag_alpha.5
	title = "ag_alpha.5.name"
	desc = {
		trigger = { from = { any_owned_pop = { species = { NOT = { has_species_flag = ag_special_species } } } } }
		text = "ag_alpha.5.a.desc"
	}
	desc = {
		trigger = { from = { NOT = { any_owned_pop = { species = { NOT = { has_species_flag = ag_special_species } } } } } }
		text = "ag_alpha.5.b.desc"
	}
	diplomatic = yes
	custom_gui = "ag_ancient_event_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_arctic_planet_room }
	show_sound = event_primitive_civilization
	location = root
	is_triggered_only = yes
	option = { name = "ag_alpha.5.a" }
}

# Notification, normal ringworld in border swapped to shrouded, uncolonize ringworld, has observation outpost.
country_event = {
	id = ag_alpha.6
	title = "ag_alpha.6.name"
	desc = "ag_alpha.6.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_m_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_shrouded_planet_room }
	show_sound = event_psionic
	location = root
	is_triggered_only = yes
	option = { name = "ag_alpha.6.a" }
}

# Notification, normal ringworld in border swapped to shrouded, uncolonize ringworld, no observation outpost.
country_event = {
	id = ag_alpha.7
	title = "ag_alpha.7.name"
	desc = "ag_alpha.7.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_m_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_shrouded_planet_room }
	show_sound = event_mystic_reveal
	location = root
	is_triggered_only = yes
	option = { name = "ag_alpha.7.a" }
}

# Notification, normal ringworld in border swapped to shrouded, owned ringworld.
country_event = {
	id = ag_alpha.8
	title = "ag_alpha.8.name"
	desc = "ag_alpha.8.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_shrouded_planet_room }
	show_sound = event_air_raid_siren
	location = root
	is_triggered_only = yes
	option = { name = "ag_alpha.8.a" }
	option = { name = "ag_alpha.8.b" }
}

# Ringworld swap cycle.
planet_event = {
	id = ag_alpha.10
	hide_window = yes
	is_triggered_only = yes
	trigger = { NOT = { has_planet_flag = ag_alpha_ringworld_phase_locked } }
	immediate = {
		if = {
			limit = { OR = { NOT = { has_global_flag = ag_zeta_crisis_stage_3 } has_global_flag = ag_zeta_crisis_ended NOT = { is_planet_class = pc_ag_ringworld_shrouded } } }
			if = {
				limit = { solar_system = { exists = space_owner space_owner = { is_ai = no } } }
				if = {
					limit = { is_planet_class = pc_ag_ringworld_shrouded }
					solar_system.space_owner = {
						if = {
							limit = { NOT = { has_country_flag = ag_alpha_5_fired } }
							set_country_flag = ag_alpha_5_fired
							country_event = { id = ag_alpha.5 days = 2 random = 2 }
						}
						if = {
							limit = { NOR = {
								has_country_flag = ag_alpha_event_stoped
								has_global_flag = ag_ancient_alpha_guardian_awaken
								has_country_flag = ag_alpha_14_locked
								has_special_project = "ag_alpha_ancient_shipwreck"
								is_same_value = event_target:ag_ancient_alpha_shielded_world.owner
								is_same_value = event_target:ag_ancient_alpha_shielded_world_2.owner
								exists = event_target:ag_event_alpha_titan
							} }
							reroll_random = yes
							random_list = { 50 = { } 50 = { set_country_flag = ag_alpha_14_locked country_event = { id = ag_alpha.14 days = 30 random = 30 } } }
						}
					}
				}
				else_if = {
					limit = { exists = owner owner = { is_ai = no } }
					owner = {
						set_country_flag = ag_alpha_6_fired
						country_event = { id = ag_alpha.8 days = 2 random = 2 }
					}
				}
				else_if = {
					limit = { has_observation_outpost = yes }
					observation_outpost_owner = { if = {
						limit = { NOT = { has_country_flag = ag_alpha_6_fired } }
						set_country_flag = ag_alpha_6_fired
						country_event = { id = ag_alpha.6 days = 2 random = 2 }
					} }
				}
				else_if = {
					limit = { always = yes }
					solar_system.space_owner = { if = {
						limit = { NOT = { has_country_flag = ag_alpha_6_fired } }
						set_country_flag = ag_alpha_6_fired
						country_event = { id = ag_alpha.7 days = 2 random = 2 }
					} }
				}
			}
			ag_alpha_ringworld_swap = yes
		}
		if = {
			limit = { has_planet_flag = ag_alpha_shrouded_ringworld_phase_2 }
			planet_event = { id = ag_alpha.10 days = @ag_alpha_ringworld_swap_days_alt2 random = @ag_alpha_ringworld_swap_random_alt2 }
		}
		else_if = {
			limit = { has_planet_flag = ag_alpha_shrouded_ringworld_phase_1 }
			planet_event = { id = ag_alpha.10 days = @ag_alpha_ringworld_swap_days_alt random = @ag_alpha_ringworld_swap_random_alt }
		}
		else_if = {
			limit = { always = yes }
			planet_event = { id = ag_alpha.10 days = @ag_alpha_ringworld_swap_days random = @ag_alpha_ringworld_swap_random }
		}
	}
}

# on_planet_attackers_win, Invaded ringworld, first time.
country_event = {
	id = ag_alpha.11
	hide_window = yes
	is_triggered_only = yes
	
	trigger = { from = {
		is_country_type = primitive
		has_country_flag = ag_alpha_ringworld_primitive
	} }
	
	immediate = {
		set_country_flag = ag_invaded_alpha_ringworld
		if = {
			limit = { NOR = {
				has_country_flag = ag_alpha_event_stoped
				has_global_flag = ag_ancient_alpha_guardian_awaken
				has_country_flag = ag_alpha_14_locked
				has_special_project = "ag_alpha_ancient_shipwreck"
				is_same_value = event_target:ag_ancient_alpha_shielded_world.owner
				is_same_value = event_target:ag_ancient_alpha_shielded_world_2.owner
				exists = event_target:ag_event_alpha_titan
			} }
			set_country_flag = ag_alpha_14_locked
			country_event = { id = ag_alpha.16 days = 2 random = 3 scopes = { from = root.from fromfrom = root.fromfrom } }
		}
		fromfrom = {
			set_owner = root
			remove_building = ag_ancient_structure_primitive_3
			add_building = ag_ancient_structure
			if = {
				limit = { has_building = ag_class_5_singularity }
				reroll_random = yes
				random_list = {
					50 = {
						modifier = { add = -25 root = { has_ethic = ethic_fanatic_xenophile } }
						modifier = { add = -10 root = { has_ethic = ethic_xenophile } }
						modifier = { add = 25 root = { has_ethic = ethic_fanatic_xenophobe } }
						modifier = { add = 10 root = { has_ethic = ethic_xenophobe } }
						modifier = { add = 20 root = { has_valid_civic = civic_fanatic_purifiers } }
						modifier = { add = 45 root = { OR = {
							has_valid_civic = civic_hive_devouring_swarm
							has_valid_civic = civic_machine_terminator
						} } }
						remove_building = ag_class_5_singularity
						add_deposit = ag_class_5_singularity_crater
						add_planet_devastation = 15
						root = { country_event = { id = ag_alpha.13 } }
					}
					50 = {
						modifier = { add = 25 root = { has_ethic = ethic_fanatic_xenophile } }
						modifier = { add = 10 root = { has_ethic = ethic_xenophile } }
						modifier = { add = -25 root = { has_ethic = ethic_fanatic_xenophobe } }
						modifier = { add = -10 root = { has_ethic = ethic_xenophobe } }
						modifier = { add = -20 root = { has_valid_civic = civic_fanatic_purifiers } }
						modifier = { add = -45 root = { OR = {
							has_valid_civic = civic_hive_devouring_swarm
							has_valid_civic = civic_machine_terminator
						} } }
					}
				}
			}
		}
	}
}

# Class 5 singularity explode if unlucky
country_event = {
	id = ag_alpha.13
	title = "ag_alpha.13.name"
	desc = "ag_alpha.13.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_s_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_nuclear_explosion_room }
	show_sound = event_super_explosion
	location = fromfromfrom
	is_triggered_only = yes
	option = { name = "ag_alpha.13.a" custom_tooltip = "ag_alpha.13.a.tooltip" }
}

# Found ancient ship wreck, observation station.
country_event = {
	id = ag_alpha.14
	title = "ag_alpha.14.name"
	desc = {
		trigger = { from = { exists = owner owner = { is_primitive = yes } } NOT = { has_country_flag = ag_alpha_22_fired } }
		text = "ag_alpha.14.a.desc"
	}
	desc = {
		trigger = { from = { exists = owner owner = { is_primitive = yes } } has_country_flag = ag_alpha_22_fired }
		text = "ag_alpha.14.b.desc"
	}
	desc = {
		trigger = { from = { NAND = { exists = owner owner = { is_primitive = yes } } } NOT = { has_country_flag = ag_alpha_22_fired } }
		text = "ag_alpha.14.c.desc"
	}
	desc = {
		trigger = { from = { NAND = { exists = owner owner = { is_primitive = yes } } } has_country_flag = ag_alpha_22_fired }
		text = "ag_alpha.14.d.desc"
	}
	diplomatic = yes
	custom_gui = "ag_ancient_event_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_frozen_shipwreck_room }
	show_sound = event_sensor_ping
	location = from
	is_triggered_only = yes
	trigger = { NOT = { has_country_flag = ag_alpha_event_stoped } }
	option = {
		name = "ag_alpha.14.a"
		enable_special_project = {
			name = "ag_alpha_ancient_shipwreck"
			location = from
			owner = root
		}
		hidden_effect = { remove_country_flag = ag_alpha_14_locked }
	}
	option = {
		name = "ag_alpha.14.b"
		custom_tooltip = "ag_alpha.2.b.tooltip"
		add_resource = { influence = @ag_end_event_influence_large }
		hidden_effect = { set_country_flag = ag_alpha_event_stoped }
	}
	option = {
		name = "ag_alpha.14.c"
		trigger = { hidden_trigger = { has_country_flag = ag_alpha_22_fired } }
		custom_tooltip = "ag_alpha.2.b.tooltip"
		enable_special_project = {
			name = "ag_alpha_destroy_ancient_shipwreck"
			location = from
			owner = root
		}
		hidden_effect = { set_country_flag = ag_alpha_event_stoped }
	}
}

# Gain ancient ship.
ship_event = {
	id = ag_alpha.15
	title = "ag_alpha.15.name"
	desc = {
		trigger = { owner = { NOT = { has_country_flag = ag_alpha_15_fired } } }
		text = "ag_alpha.15.a.desc"
	}
	desc = {
		trigger = { owner = { has_country_flag = ag_alpha_15_fired } }
		text = "ag_alpha.15.b.desc"
	}
	diplomatic = yes
	custom_gui = "ag_ancient_event_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_ship_in_orbit_room }
	show_sound = event_dyson_sphere_build_complete
	location = root
	is_triggered_only = yes
	after = { hidden_effect = { owner = { if = { limit = { NOT = { has_country_flag = ag_alpha_15_fired } } set_country_flag = ag_alpha_15_fired } } } }
	option = {
		name = "ag_alpha.15.a"
		custom_tooltip = "ag_alpha.15.a.tooltip"
		hidden_effect = { ag_create_event_alpha_titan_player = yes }
	}
	option = {
		name = "ag_alpha.15.b"
		trigger = { hidden_trigger = { owner = { has_country_flag = ag_alpha_15_fired } } }
		custom_tooltip = "ag_alpha.15.a.tooltip"
		hidden_effect = { ag_create_event_alpha_titan_player = yes }
	}
	option = {
		name = "ag_alpha.15.c"
		trigger = {
			hidden_trigger = { owner = { has_country_flag = ag_alpha_15_fired } }
			owner = { OR = { has_ethic = ethic_spiritualist has_ethic = ethic_fanatic_spiritualist } }
		}
		custom_tooltip = "ag_alpha.15.a.tooltip"
		hidden_effect = { ag_create_event_alpha_titan_player = yes }
	}
}

# Found ancient ship wreck, invaded planet.
country_event = {
	id = ag_alpha.16
	title = "ag_alpha.16.name"
	desc = {
		trigger = { NOT = { has_country_flag = ag_alpha_22_fired } }
		text = "ag_alpha.16.a.desc"
	}
	desc = {
		trigger = { has_country_flag = ag_alpha_22_fired }
		text = "ag_alpha.16.b.desc"
	}
	diplomatic = yes
	custom_gui = "ag_ancient_event_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_frozen_shipwreck_room }
	show_sound = event_sensor_ping
	location = fromfrom
	is_triggered_only = yes
	trigger = { NOR = {
		has_country_flag = ag_alpha_event_stoped
		has_global_flag = ag_ancient_alpha_guardian_awaken
		has_country_flag = ag_alpha_14_locked
		has_special_project = "ag_alpha_ancient_shipwreck"
		AND = { is_same_value = event_target:ag_ancient_alpha_shielded_world.owner event_target:ag_ancient_alpha_shielded_world = { OR = { has_building = ag_alpha_ancient_shipwreck_0 has_building = ag_alpha_ancient_shipwreck_1 } } }
		AND = { is_same_value = event_target:ag_ancient_alpha_shielded_world_2.owner event_target:ag_ancient_alpha_shielded_world_2 = { OR = { has_building = ag_alpha_ancient_shipwreck_0 has_building = ag_alpha_ancient_shipwreck_1 } } }
		exists = event_target:ag_event_alpha_titan
	} }
	immediate = { if = { limit = { has_special_project = "ag_alpha_ancient_shipwreck" } abort_special_project = { type = "ag_alpha_ancient_shipwreck" } } }
	option = {
		name = "ag_alpha.16.a"
		fromfrom = { add_building = ag_alpha_ancient_shipwreck_0 }
	}
	option = {
		name = "ag_alpha.16.b"
		add_resource = { influence = @ag_end_event_influence_large }
		hidden_effect = { set_country_flag = ag_alpha_event_stoped }
	}
	option = {
		name = "ag_alpha.16.c"
		trigger = { hidden_trigger = { has_country_flag = ag_alpha_22_fired } }
		custom_tooltip = "ag_alpha.2.b.tooltip"
		hidden_effect = { set_country_flag = ag_alpha_event_stoped country_event = { id = ag_alpha.19 days = 10 } }
	}
}

# on_building_upgraded, Gain ancient ship.
planet_event = {
	id = ag_alpha.17
	title = "ag_alpha.17.name"
	desc = {
		trigger = { owner = { NOT = { has_country_flag = ag_alpha_15_fired } } }
		text = "ag_alpha.17.a.desc"
	}
	desc = {
		trigger = { owner = { has_country_flag = ag_alpha_15_fired } }
		text = "ag_alpha.17.b.desc"
	}
	diplomatic = yes
	custom_gui = "ag_ancient_event_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_ship_in_orbit_room }
	show_sound = event_dyson_sphere_build_complete
	location = root
	is_triggered_only = yes
	trigger = { has_building = ag_alpha_ancient_shipwreck_1 }
	immediate = { remove_building = ag_alpha_ancient_shipwreck_1 }
	after = { hidden_effect = { owner = { if = { limit = { NOT = { has_country_flag = ag_alpha_15_fired } } set_country_flag = ag_alpha_15_fired } } } }
	option = {
		name = "ag_alpha.17.a"
		custom_tooltip = "ag_alpha.15.a.tooltip"
		hidden_effect = { ag_create_event_alpha_titan_player = yes }
	}
	option = {
		name = "ag_alpha.17.b"
		trigger = { hidden_trigger = { owner = { has_country_flag = ag_alpha_15_fired } } }
		custom_tooltip = "ag_alpha.15.a.tooltip"
		hidden_effect = { ag_create_event_alpha_titan_player = yes }
	}
	option = {
		name = "ag_alpha.17.c"
		trigger = {
			hidden_trigger = { owner = { has_country_flag = ag_alpha_15_fired } }
			owner = { OR = { has_ethic = ethic_spiritualist has_ethic = ethic_fanatic_spiritualist } }
		}
		custom_tooltip = "ag_alpha.15.a.tooltip"
		hidden_effect = { ag_create_event_alpha_titan_player = yes }
	}
}

# on_colonized, Found ancient ship wreck, colonized Alpha Area's ringworld, failsafe.
planet_event = {
	id = ag_alpha.18
	title = "ag_alpha.18.name"
	desc = {
		trigger = { owner = { NOT = { has_country_flag = ag_alpha_22_fired } } }
		text = "ag_alpha.18.a.desc"
	}
	desc = {
		trigger = { owner = { has_country_flag = ag_alpha_22_fired } }
		text = "ag_alpha.18.b.desc"
	}
	diplomatic = yes
	custom_gui = "ag_ancient_event_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_frozen_shipwreck_room }
	show_sound = event_sensor_ping
	location = root
	is_triggered_only = yes
	trigger = {
		OR = {
			is_same_value = event_target:ag_ancient_alpha_shielded_world
			is_same_value = event_target:ag_ancient_alpha_shielded_world_2
		}
		NOR = {
			has_country_flag = ag_alpha_event_stoped
			has_global_flag = ag_ancient_alpha_guardian_awaken
			# has_planet_flag = ag_alpha_ringworld_phase_locked
			has_country_flag = ag_alpha_14_locked
			has_special_project = "ag_alpha_ancient_shipwreck"
			has_building = ag_alpha_ancient_shipwreck_0
			has_building = ag_alpha_ancient_shipwreck_1
			exists = event_target:ag_event_alpha_titan
		}
	}
	immediate = { owner = { if = { limit = { has_special_project = "ag_alpha_ancient_shipwreck" } abort_special_project = { type = "ag_alpha_ancient_shipwreck" } } } }
	option = {
		name = "ag_alpha.18.a"
		add_building = ag_alpha_ancient_shipwreck_0
	}
	option = {
		name = "ag_alpha.18.b"
		owner = { add_resource = { influence = @ag_end_event_influence_large } }
		hidden_effect = { owner = { set_country_flag = ag_alpha_event_stoped } }
	}
	option = {
		name = "ag_alpha.18.c"
		trigger = { hidden_trigger = { owner = { has_country_flag = ag_alpha_22_fired } } }
		custom_tooltip = "ag_alpha.2.b.tooltip"
		hidden_effect = { owner = { set_country_flag = ag_alpha_event_stoped country_event = { id = ag_alpha.19 days = 10 } } }
	}
}

# Destroy ancient ship wreck
country_event = {
	id = ag_alpha.19
	title = "ag_alpha.19.name"
	desc = "ag_alpha.19.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_s_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_nuclear_explosion_room }
	show_sound = event_super_explosion
	is_triggered_only = yes
	option = { name = "ag_alpha.19.a" add_resource = { influence = @ag_end_event_influence_medium } }
	option = { name = "ag_alpha.19.b" add_resource = { influence = @ag_end_event_influence_medium } }
}

# on_ship_destroyed_victim, Ancient ship disappear if kill any ship/killed by other.
country_event = {
	id = ag_alpha.20
	hide_window = yes
	is_triggered_only = yes
	trigger = {
		NOR = {
			has_country_flag = ag_alpha_20_locked
			from = { has_country_flag = ag_alpha_20_locked }
		}
		OR = {
			fromfrom = { has_ship_flag = ag_event_alpha_titan }
			fromfromfrom = { has_ship_flag = ag_event_alpha_titan }
		}
	}
	immediate = {
		if = {
			limit = { fromfrom = { has_ship_flag = ag_event_alpha_titan } }
			set_timed_country_flag = { flag = ag_alpha_20_locked days = 2 }
			fromfrom = {
				owner = { country_event = { id = ag_alpha.22 } }
				fleet = { save_event_target_as = ag_target_fleet }
				delete_ship = this
			}
		}
		else_if = {
			limit = { fromfromfrom = { has_ship_flag = ag_event_alpha_titan } }
			set_timed_country_flag = { flag = ag_alpha_20_locked days = 2 }
			fromfromfrom = {
				owner = { country_event = { id = ag_alpha.22 } }
				fleet = { save_event_target_as = ag_target_fleet }
				delete_ship = this
			}
		}
	}
}
# Called on disabled.
ship_event = {
	id = ag_alpha.21
	hide_window = yes
	is_triggered_only = yes
	trigger = { exists = owner has_ship_flag = ag_event_alpha_titan owner = { NOR = { has_country_flag = ag_alpha_20_locked is_country_type = ag_ancient_alpha_guardian } } }
	immediate = {
		owner = {
			set_timed_country_flag = { flag = ag_alpha_20_locked days = 2 }
			country_event = { id = ag_alpha.22 }
		}
		fleet = { save_event_target_as = ag_target_fleet }
		delete_ship = this
	}
}
# Notification.
country_event = {
	id = ag_alpha.22
	title = "ag_alpha.22.name"
	desc = {
		trigger = { NOT = { has_country_flag = ag_alpha_22_fired } }
		text = "ag_alpha.22.a.desc"
	}
	desc = {
		trigger = { has_country_flag = ag_alpha_22_fired }
		text = "ag_alpha.22.b.desc"
	}
	diplomatic = yes
	custom_gui = "ag_ancient_event_m_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_ship_in_orbit_room }
	show_sound = event_yellow_alert
	location = event_target:ag_target_fleet
	is_triggered_only = yes
	after = { hidden_effect = {
		if = {
			limit = {
				exists = event_target:ag_ancient_alpha_star
				event_target:ag_ancient_alpha_star = {
					exists = solar_system
					solar_system = {
						exists = space_owner
						space_owner = { is_same_value = root }
						any_system_planet = { is_planet_class = pc_ag_ringworld_arctic }
					}
				}
			}
			if = {
				limit = { NOR = {
					has_country_flag = ag_alpha_event_stoped
					has_global_flag = ag_ancient_alpha_guardian_awaken
					has_country_flag = ag_alpha_14_locked
					has_special_project = "ag_alpha_ancient_shipwreck"
					AND = {
						exists = event_target:ag_ancient_alpha_shielded_world
						event_target:ag_ancient_alpha_shielded_world = {
							exists = owner owner = { is_same_value = root }
							OR = { has_building = ag_alpha_ancient_shipwreck_0 has_building = ag_alpha_ancient_shipwreck_1 }
						}
					}
					AND = {
						exists = event_target:ag_ancient_alpha_shielded_world_2
						event_target:ag_ancient_alpha_shielded_world_2 = {
							exists = owner owner = { is_same_value = root }
							OR = { has_building = ag_alpha_ancient_shipwreck_0 has_building = ag_alpha_ancient_shipwreck_1 }
						}
					}
				} }
				event_target:ag_ancient_alpha_star.solar_system = { random_system_planet = {
					limit = { is_planet_class = pc_ag_ringworld_arctic }
					root = {
						set_country_flag = ag_alpha_14_locked
						country_event = { id = ag_alpha.14 days = 32 random = 16 scopes = { from = prev } }
					}
				} }
			}
		}
		if = { limit = { NOT = { has_country_flag = ag_alpha_22_fired } } set_country_flag = ag_alpha_22_fired }
	} }
	option = {
		name = "ag_alpha.22.a"
		custom_tooltip = "ag_alpha.22.a.tooltip"
		custom_tooltip = "ag_alpha.22.first_fired.tooltip"
		trigger = { hidden_trigger = { NOT = { has_country_flag = ag_alpha_22_fired } } }
	}
	option = {
		name = "ag_alpha.22.b"
		custom_tooltip = "ag_alpha.22.a.tooltip"
		trigger = { hidden_trigger = { has_country_flag = ag_alpha_22_fired } }
	}
}

# Progress, found ship board database.
ship_event = {
	id = ag_alpha.23
	title = "ag_alpha.23.name"
	desc = "ag_alpha.23.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_ancient_AI_room }
	show_sound = event_mystic_reveal
	is_triggered_only = yes
	trigger = { owner = { NOT = { has_country_flag = ag_alpha_titan_action_available } } }
	immediate = { owner = { set_country_flag = ag_alpha_titan_action_available } }
	option = {
		name = "ag_alpha.23.a"
		custom_tooltip = "ag_alpha.23.a.tooltip"
		ag_give_psionic_theory = yes
	}
}

# Ancient record menu.
country_event = {
	id = ag_alpha.24
	title = "ag_alpha.24.name"
	desc = "ag_alpha.24.desc"
	diplomatic = yes
	custom_gui = "alpha_titan_record_window"
	custom_gui_option = "alpha_titan_record_option"
	picture_event_data = {
		room = ag_ancient_ai_red_room
		portrait = ag_ancient_ai_red
	}
	show_sound = event_mystic_reveal
	is_triggered_only = yes
	after = { hidden_effect = {
		if = {
			limit = { OR = {
				has_country_flag = ag_alpha_titan_record_3_flag
				has_country_flag = ag_alpha_titan_record_5_flag
				has_country_flag = ag_alpha_titan_record_6_flag
			} }
			if = {
				limit = {
					has_country_flag = ag_alpha_titan_record_3_flag
					has_country_flag = ag_alpha_titan_record_5_flag
					has_country_flag = ag_alpha_titan_record_6_flag
				}
				country_event = { id = ag_alpha.25 days = 30 random = 30 }
			}
			else = {
				reroll_random = yes
				random_list = { 25 = { } 75 = { country_event = { id = ag_alpha.26 days = 30 random = 30 } } }
			}
		}
		if = {
			limit = { OR = {
				has_country_flag = ag_alpha_titan_record_2_flag
				has_country_flag = ag_alpha_titan_record_4_flag
			} }
			if = {
				limit = {
					has_country_flag = ag_alpha_titan_record_2_flag
					has_country_flag = ag_alpha_titan_record_4_flag
				}
				country_event = { id = ag_alpha.26 days = 30 random = 30 }
			}
			else = {
				reroll_random = yes
				random_list = { 25 = { } 75 = { country_event = { id = ag_alpha.26 days = 30 random = 30 } } }
			}
		}
	} }
	option = {
		name = "ag_alpha.24.1.option"
		is_dialog_only = yes
		response_text = "ag_alpha.24.1.response"
		custom_tooltip = "ag_alpha.24.1.tooltip"
		trigger = { hidden_trigger = { has_country_flag = ag_alpha_titan_record_1 } }
		hidden_effect = { if = { limit = { NOT = { has_country_flag = ag_alpha_titan_record_1_flag } } set_country_flag = ag_alpha_titan_record_1_flag } }
	}
	option = {
		name = "ag_alpha.24.1.option_alt"
		is_dialog_only = yes
		response_text = "ag_alpha.24.unknown.response"
		custom_tooltip = "ag_alpha.24.unknown.tooltip"
		trigger = { hidden_trigger = { NOT = { has_country_flag = ag_alpha_titan_record_1 } } }
	}
	option = {
		name = "ag_alpha.24.2.option"
		is_dialog_only = yes
		response_text = "ag_alpha.24.2.response"
		custom_tooltip = "ag_alpha.24.2.tooltip"
		trigger = { hidden_trigger = { has_country_flag = ag_alpha_titan_record_2 } }
		hidden_effect = { if = { limit = { NOT = { has_country_flag = ag_alpha_titan_record_2_flag } } set_country_flag = ag_alpha_titan_record_2_flag } }
	}
	option = {
		name = "ag_alpha.24.2.option_alt"
		is_dialog_only = yes
		response_text = "ag_alpha.24.unknown.response"
		custom_tooltip = "ag_alpha.24.unknown.tooltip"
		trigger = { hidden_trigger = { NOT = { has_country_flag = ag_alpha_titan_record_2 } } }
	}
	option = {
		name = "ag_alpha.24.3.option"
		is_dialog_only = yes
		response_text = "ag_alpha.24.3.response"
		custom_tooltip = "ag_alpha.24.3.tooltip"
		trigger = { hidden_trigger = { has_country_flag = ag_alpha_titan_record_3 } }
		hidden_effect = { if = { limit = { NOT = { has_country_flag = ag_alpha_titan_record_3_flag } } set_country_flag = ag_alpha_titan_record_3_flag } }
	}
	option = {
		name = "ag_alpha.24.3.option_alt"
		is_dialog_only = yes
		response_text = "ag_alpha.24.unknown.response"
		custom_tooltip = "ag_alpha.24.unknown.tooltip"
		trigger = { hidden_trigger = { NOT = { has_country_flag = ag_alpha_titan_record_3 } } }
	}
	option = {
		name = "ag_alpha.24.4.option"
		is_dialog_only = yes
		response_text = "ag_alpha.24.4.response"
		custom_tooltip = "ag_alpha.24.4.tooltip"
		trigger = { hidden_trigger = { has_country_flag = ag_alpha_titan_record_4 } }
		hidden_effect = { if = { limit = { NOT = { has_country_flag = ag_alpha_titan_record_4_flag } } set_country_flag = ag_alpha_titan_record_4_flag } }
	}
	option = {
		name = "ag_alpha.24.4.option_alt"
		is_dialog_only = yes
		response_text = "ag_alpha.24.unknown.response"
		custom_tooltip = "ag_alpha.24.unknown.tooltip"
		trigger = { hidden_trigger = { NOT = { has_country_flag = ag_alpha_titan_record_4 } } }
	}
	option = {
		name = "ag_alpha.24.5.option"
		is_dialog_only = yes
		response_text = "ag_alpha.24.5.response"
		custom_tooltip = "ag_alpha.24.5.tooltip"
		trigger = { hidden_trigger = { has_country_flag = ag_alpha_titan_record_5 } }
		hidden_effect = { if = { limit = { NOT = { has_country_flag = ag_alpha_titan_record_5_flag } } set_country_flag = ag_alpha_titan_record_5_flag } }
	}
	option = {
		name = "ag_alpha.24.5.option_alt"
		is_dialog_only = yes
		response_text = "ag_alpha.24.unknown.response"
		custom_tooltip = "ag_alpha.24.unknown.tooltip"
		trigger = { hidden_trigger = { NOT = { has_country_flag = ag_alpha_titan_record_5 } } }
	}
	option = {
		name = "ag_alpha.24.6.option"
		is_dialog_only = yes
		response_text = "ag_alpha.24.6.response"
		custom_tooltip = "ag_alpha.24.6.tooltip"
		trigger = { hidden_trigger = { has_country_flag = ag_alpha_titan_record_6 } }
		hidden_effect = { if = { limit = { NOT = { has_country_flag = ag_alpha_titan_record_6_flag } } set_country_flag = ag_alpha_titan_record_6_flag } }
	}
	option = {
		name = "ag_alpha.24.6.option_alt"
		is_dialog_only = yes
		response_text = "ag_alpha.24.unknown.response"
		custom_tooltip = "ag_alpha.24.unknown.tooltip"
		trigger = { hidden_trigger = { NOT = { has_country_flag = ag_alpha_titan_record_6 } } }
	}
	option = {
		name = "ag_alpha.24.7.option"
		is_dialog_only = yes
		response_text = "ag_alpha.24.7.response"
		custom_tooltip = "ag_alpha.24.7.tooltip"
		trigger = { hidden_trigger = { has_country_flag = ag_alpha_titan_record_7 } }
		hidden_effect = { if = { limit = { NOT = { has_country_flag = ag_alpha_titan_record_7_flag } } set_country_flag = ag_alpha_titan_record_7_flag } }
	}
	option = {
		name = "ag_alpha.24.7.option_alt"
		is_dialog_only = yes
		response_text = "ag_alpha.24.unknown.response"
		custom_tooltip = "ag_alpha.24.unknown.tooltip"
		trigger = { hidden_trigger = { NOT = { has_country_flag = ag_alpha_titan_record_7 } } }
	}
	option = { name = "ag_alpha.24.exit" default_hide_option = yes }
}
# Noti: Psionic Star System.
country_event = {
	id = ag_alpha.25
	title = "ag_alpha.25.name"
	desc = "ag_alpha.25.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_ancient_AI_room }
	show_sound = event_mystic_reveal
	location = root
	is_triggered_only = yes
	trigger = { NOT = { has_country_flag = ag_alpha_25_fired } }
	immediate = {
		set_country_flag = ag_alpha_25_fired
		if = { limit = { has_country_flag = ag_alpha_26_fired } country_event = { id = ag_alpha.30 days = 60 random = 60 } }
		else = { reroll_random = yes random_list = { 50 = { } 50 = { country_event = { id = ag_alpha.30 days = 60 random = 60 } } } }
	}
	option = { name = "ag_alpha.25.a" }
	option = {
		name = "ag_alpha.25.b"
		trigger = { OR = {
			has_ethic = ethic_pacifist
			has_ethic = ethic_fanatic_pacifist
		} }
	}
	option = {
		name = "ag_alpha.25.c"
		trigger = { OR = {
			has_ethic = ethic_militarist
			has_ethic = ethic_fanatic_militarist
		} }
	}
}
# Noti: Psionic Conduit System.
country_event = {
	id = ag_alpha.26
	title = "ag_alpha.26.name"
	desc = "ag_alpha.26.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_ancient_AI_room }
	show_sound = event_mystic_reveal
	location = root
	is_triggered_only = yes
	trigger = { NOT = { has_country_flag = ag_alpha_26_fired } }
	immediate = {
		set_country_flag = ag_alpha_26_fired
		if = { limit = { has_country_flag = ag_alpha_25_fired } country_event = { id = ag_alpha.30 days = 60 random = 60 } }
		else = { reroll_random = yes random_list = { 50 = { } 50 = { country_event = { id = ag_alpha.30 days = 60 random = 60 } } } }
	}
	option = { name = "ag_alpha.26.a" }
	option = {
		name = "ag_alpha.26.b"
		trigger = { OR = {
			has_ethic = ethic_materialist
			has_ethic = ethic_fanatic_materialist
		} }
	}
	option = {
		name = "ag_alpha.26.c"
		trigger = { OR = {
			has_ethic = ethic_spiritualist
			has_ethic = ethic_fanatic_spiritualist
		} }
	}
}

# Noti for system locator available.
country_event = {
	id = ag_alpha.30
	title = "ag_alpha.30.name"
	desc = "ag_alpha.30.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_ancient_AI_room }
	show_sound = event_yellow_alert
	location = root
	is_triggered_only = yes
	trigger = { NOT = { has_country_flag = ag_alpha_30_fired } }
	immediate = { set_country_flag = ag_alpha_30_fired }
	option = {
		name = "ag_alpha.30.a"
		custom_tooltip = "ag_alpha.30.a.tooltip"
		locked_random_list = {
			10 = { ag_give_research_project = { ag_project_id = @ag_alpha_psionic_container_project_id ag_progress = 1.1 } }
			10 = { ag_give_research_project = { ag_project_id = @ag_alpha_psionic_container_project_id ag_progress = 2.3 } }
			10 = { ag_give_research_project = { ag_project_id = @ag_alpha_psionic_container_project_id ag_progress = 3.7 } }
			10 = { ag_give_research_project = { ag_project_id = @ag_alpha_psionic_container_project_id ag_progress = 4.1 } }
			10 = { ag_give_research_project = { ag_project_id = @ag_alpha_psionic_container_project_id ag_progress = 5.3 } }
		}
	}
}
# Research project completed.
country_event = {
	id = ag_alpha.31
	title = "ag_alpha.31.name"
	desc = "ag_alpha.31.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_s_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_ancient_AI_room }
	show_sound = event_mystic_reveal
	location = root
	is_triggered_only = yes
	option = {
		name = "ag_alpha.31.a"
		ag_add_research_option = { ag_tech = tech_ag_alpha_psionic_container }
	}
}

# System Locator UI
country_event = {
	id = ag_alpha.32
	title = "ag_alpha.32.name"
	desc = "ag_alpha.32.desc"
	diplomatic = yes
	custom_gui = "ag_alpha_system_locator_window"
	custom_gui_option = "ag_alpha_system_locator_option"
	picture_event_data = { room = crisis_room }
	show_sound = event_mystic_reveal
	is_triggered_only = yes
	trigger = { NOT = { has_country_flag = ag_alpha_system_locator_opened } }
	immediate = {
		set_country_flag = ag_alpha_system_locator_opened
		if = { limit = { NOT = { is_variable_set = ag_alpha_system_locator_l_value } } set_variable = { which = ag_alpha_system_locator_l_value value = 0 } }
		if = { limit = { NOT = { is_variable_set = ag_alpha_system_locator_r_value } } set_variable = { which = ag_alpha_system_locator_r_value value = 0 } }
		if = {
			limit = { NOT = { has_country_flag = ag_alpha_system_locked } }
			reroll_random = yes
			random_list = { 50 = { } 50 = { set_country_flag = ag_alpha_system_locator_invert } }
		}
	}
	after = { hidden_effect = { remove_country_flag = ag_alpha_system_locator_opened } }
	option = {
		name = "ag_alpha.32.a"
		is_dialog_only = yes
		response_text = "ag_alpha.32.desc"
		allow = { custom_tooltip = {
			fail_text = "ag_alpha.32.a.fail"
			OR = {
				AND = {
					exists = event_target:ag_ancient_alpha_shielded_world
					exists = event_target:ag_ancient_alpha_shielded_world_2
					event_target:ag_ancient_alpha_shielded_world = { has_planet_flag = ag_alpha_ringworld_phase_locked }
					event_target:ag_ancient_alpha_shielded_world_2 = { has_planet_flag = ag_alpha_ringworld_phase_locked }
				}
				NAND = {
					OR = {
						AND = {
							has_country_flag = ag_alpha_system_locked_value_l_0
							OR = {
								AND = { NOT = { has_country_flag = ag_alpha_system_locator_invert } check_variable = { which = ag_alpha_system_locator_l_value value = 0 } }
								AND = { has_country_flag = ag_alpha_system_locator_invert check_variable = { which = ag_alpha_system_locator_r_value value = 0 } }
							}
						}
						AND = {
							has_country_flag = ag_alpha_system_locked_value_l_1
							OR = {
								AND = { NOT = { has_country_flag = ag_alpha_system_locator_invert } check_variable = { which = ag_alpha_system_locator_l_value value = 1 } }
								AND = { has_country_flag = ag_alpha_system_locator_invert check_variable = { which = ag_alpha_system_locator_r_value value = 1 } }
							}
						}
						AND = {
							has_country_flag = ag_alpha_system_locked_value_l_2
							OR = {
								AND = { NOT = { has_country_flag = ag_alpha_system_locator_invert } check_variable = { which = ag_alpha_system_locator_l_value value = 2 } }
								AND = { has_country_flag = ag_alpha_system_locator_invert check_variable = { which = ag_alpha_system_locator_r_value value = 2 } }
							}
						}
					}
					OR = {
						AND = {
							has_country_flag = ag_alpha_system_locked_value_r_0
							OR = {
								AND = { NOT = { has_country_flag = ag_alpha_system_locator_invert } check_variable = { which = ag_alpha_system_locator_r_value value = 0 } }
								AND = { has_country_flag = ag_alpha_system_locator_invert check_variable = { which = ag_alpha_system_locator_l_value value = 0 } }
							}
						}
						AND = {
							has_country_flag = ag_alpha_system_locked_value_r_1
							OR = {
								AND = { NOT = { has_country_flag = ag_alpha_system_locator_invert } check_variable = { which = ag_alpha_system_locator_r_value value = 1 } }
								AND = { has_country_flag = ag_alpha_system_locator_invert check_variable = { which = ag_alpha_system_locator_l_value value = 1 } }
							}
						}
						AND = {
							has_country_flag = ag_alpha_system_locked_value_r_2
							OR = {
								AND = { NOT = { has_country_flag = ag_alpha_system_locator_invert } check_variable = { which = ag_alpha_system_locator_r_value value = 2 } }
								AND = { has_country_flag = ag_alpha_system_locator_invert check_variable = { which = ag_alpha_system_locator_l_value value = 2 } }
							}
						}
					}
				}
			}
		} }
		hidden_effect = { ag_alpha_system_locator_find_systems = yes }
	}
	option = { name = "ag_alpha.32.b" default_hide_option = yes }
}

# Noti: system reset.
country_event = {
	id = ag_alpha.33
	title = "ag_alpha.33.name"
	desc = "ag_alpha.33.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_s_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = crisis_room }
	show_sound = event_mystic_reveal
	is_triggered_only = yes
	option = { name = "ag_alpha.33.a" }
}

# on_tech_increased, Noti: Researched psi container.
country_event = {
	id = ag_alpha.34
	title = "ag_alpha.34.name"
	desc = "ag_alpha.34.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_scholarium_cache_society_room }
	show_sound = event_mystic_reveal
	is_triggered_only = yes
	trigger = { last_increased_tech = tech_ag_alpha_psionic_container }
	immediate = { set_country_flag = ag_alpha_titan_system_locator_available }
	option = { name = "ag_alpha.34.a" custom_tooltip = "ag_alpha.34.a.tooltip" }
	option = { name = "ag_alpha.34.b" custom_tooltip = "ag_alpha.34.a.tooltip" }
}

# Noti: Build psi container.
ship_event = {
	id = ag_alpha.35
	title = "ag_alpha.35.name"
	desc = "ag_alpha.35.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_m_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_ship_in_orbit_room }
	show_sound = event_mystic_reveal
	is_triggered_only = yes
	trigger = { is_ship_size = ag_alpha_psionic_container owner = { is_ai = no NOT = { has_country_flag = ag_alpha_35_fired } } }
	immediate = { owner = { set_country_flag = ag_alpha_35_fired } }
	option = { name = "ag_alpha.35.a" custom_tooltip = "ag_alpha.35.a.tooltip" }
}

# on_ship_destroyed_victim, Psionic Container breaks.
country_event = {
	id = ag_alpha.36
	hide_window = yes
	is_triggered_only = yes
	trigger = { fromfrom = { is_ship_size = ag_alpha_psionic_container_alt } }
	immediate = {
		fromfrom.solar_system = {
			every_system_planet = {
				if = {
					limit = { OR = { has_planet_flag = ag_ancient_alpha_shielded_world has_planet_flag = ag_ancient_alpha_shielded_world_2 } }
					if = {
						limit = { NAND = {
							has_planet_flag = ag_alpha_shrouded_ringworld_phase_1
							has_planet_flag = ag_alpha_shrouded_ringworld_phase_2
							has_planet_flag = ag_alpha_ringworld_phase_locked
						} }
						if = {
							limit = { NOT = { has_planet_flag = ag_alpha_shrouded_ringworld_phase_1 } }
							reroll_random = yes
							random_list = {
								50 = {
									modifier = { factor = 5 has_planet_flag = ag_alpha_ringworld_unlock_locked }
									modifier = { add = -25 OR = { ag_beta_psionic_effect_event_active = yes ag_zeta_crisis_event_active = yes } }
								}
								50 = {
									set_planet_flag = ag_alpha_shrouded_ringworld_phase_1
									set_timed_planet_flag = { flag = ag_alpha_ringworld_unlock_locked days = 5 }
									root = { country_event = { id = ag_alpha.37 days = 2 random = 3 scopes = { from = prev } } }
								}
							}
						}
						else_if = {
							limit = { NOT = { has_planet_flag = ag_alpha_shrouded_ringworld_phase_2 } }
							reroll_random = yes
							random_list = {
								60 = {
									modifier = { factor = 5 has_planet_flag = ag_alpha_ringworld_unlock_locked }
									modifier = { add = -20 OR = { ag_beta_psionic_effect_event_active = yes ag_zeta_crisis_event_active = yes } }
								}
								40 = {
									set_planet_flag = ag_alpha_shrouded_ringworld_phase_2
									set_timed_planet_flag = { flag = ag_alpha_ringworld_unlock_locked days = 5 }
									root = { country_event = { id = ag_alpha.38 days = 5 random = 3 scopes = { from = prev } } }
								}
							}
						}
						else_if = {
							limit = { NOT = { has_planet_flag = ag_alpha_ringworld_phase_locked } }
							reroll_random = yes
							random_list = {
								50 = {
									modifier = { factor = 5 has_planet_flag = ag_alpha_ringworld_unlock_locked }
									modifier = { add = -25 OR = { ag_beta_psionic_effect_event_active = yes ag_zeta_crisis_event_active = yes } }
								}
								50 = {
									set_planet_flag = ag_alpha_ringworld_phase_locked
									if = { limit = { NOT = { is_planet_class = pc_ag_ringworld_arctic } } ag_alpha_ringworld_swap = { ag_random_primitives = no } }
									else_if = { limit = { is_colony = yes exists = owner owner = { is_country_type = primitive } } destroy_colony = yes owner = { destroy_country = yes } }
									root = { country_event = { id = ag_alpha.39 days = 8 random = 3 scopes = { from = prev } } }
								}
							}
						}
					}
				}
				if = {
					limit = { exists = owner owner = { OR = { ag_is_common_country = yes is_country_type = primitive } } }
					reroll_random = yes
					random_list = {
						10 = { }
						10 = {
							ag_spawn_explosion_effect = { ag_scale = l ag_color = violet }
							reroll_random = yes
							random_list = {
								10 = { add_planet_devastation = 5 }
								10 = { add_planet_devastation = 10 }
								10 = { add_planet_devastation = 15 }
								10 = { add_planet_devastation = 20 }
								10 = { add_planet_devastation = 25 }
								10 = { add_planet_devastation = 30 }
								10 = { add_planet_devastation = 35 }
								10 = { add_planet_devastation = 40 }
								10 = { add_planet_devastation = 45 }
								10 = { add_planet_devastation = 50 }
							}
						}
						10 = {
							reroll_random = yes
							random_list = {
								10 = { ag_alpha_pop_gain_psionic_trait = yes }
								10 = { while = { count = 2 ag_alpha_pop_gain_psionic_trait = yes } }
								10 = { while = { count = 3 ag_alpha_pop_gain_psionic_trait = yes } }
								10 = { while = { count = 4 ag_alpha_pop_gain_psionic_trait = yes } }
								10 = { while = { count = 5 ag_alpha_pop_gain_psionic_trait = yes } }
							}
						}
						10 = {
							reroll_random = yes
							random_list = {
								10 = { ag_alpha_psionic_pop_side_effect = yes }
								10 = { while = { count = 2 ag_alpha_psionic_pop_side_effect = yes } }
								10 = { while = { count = 3 ag_alpha_psionic_pop_side_effect = yes } }
								10 = { while = { count = 4 ag_alpha_psionic_pop_side_effect = yes } }
								10 = { while = { count = 5 ag_alpha_psionic_pop_side_effect = yes } }
							}
						}
						10 = { if = {
							limit = { NOR = {
								has_modifier = "atmospheric_aphrodisiac"
								has_modifier = "ag_atmospheric_aphrodisiac_0"
								has_modifier = "ag_atmospheric_aphrodisiac_1"
								has_modifier = "ag_atmospheric_aphrodisiac_2"
								has_modifier = "ag_atmospheric_aphrodisiac_3"
							} }
							add_modifier = { modifier = "atmospheric_aphrodisiac" days = -1 }
						} }
						10 = { if = { limit = { NOT = { has_modifier = "natural_beauty" } } add_modifier = { modifier = "natural_beauty" days = -1 } } }
						10 = { if = { limit = { NOT = { has_modifier = "atmospheric_hallucinogen" } } add_modifier = { modifier = "atmospheric_hallucinogen" days = -1 } } }
						10 = { if = { limit = { NOT = { has_modifier = "lush_planet" } } add_modifier = { modifier = "lush_planet" days = -1 } } }
						10 = { if = { limit = { NOT = { has_modifier = "bleak_planet" } } add_modifier = { modifier = "bleak_planet" days = -1 } } }
						10 = { if = { limit = { NOT = { has_modifier = "irradiated_planet" } } add_modifier = { modifier = "irradiated_planet" days = -1 } } }
						10 = { if = { limit = { NOT = { has_modifier = "wild_storms" } } add_modifier = { modifier = "wild_storms" days = -1 } } }
						10 = {
							modifier = { factor = 0 OR = { NOT = { has_global_flag = ag_zeta_crisis_stage_2 } has_global_flag = ag_zeta_crisis_ended } }
							if = {
								limit = { has_global_flag = ag_zeta_crisis_stage_2 NOT = { has_global_flag = ag_zeta_crisis_ended } }
								reroll_random = yes
								random_list = {
									10 = { create_army = {
										name = "NAME_ag_zeta_crisis_avatar"
										owner = event_target:ag_zeta_crisis_country
										species = event_target:ag_zeta_crisis_country.owner_main_species
										type = "ag_zeta_crisis_assault_army"
									} }
									10 = { while = { count = 2 create_army = {
										name = "NAME_ag_zeta_crisis_avatar"
										owner = event_target:ag_zeta_crisis_country
										species = event_target:ag_zeta_crisis_country.owner_main_species
										type = "ag_zeta_crisis_assault_army"
									} } }
									10 = { while = { count = 3 create_army = {
										name = "NAME_ag_zeta_crisis_avatar"
										owner = event_target:ag_zeta_crisis_country
										species = event_target:ag_zeta_crisis_country.owner_main_species
										type = "ag_zeta_crisis_assault_army"
									} } }
								}
							}
						}
						10 = {
							modifier = { factor = 0 OR = { NOT = { has_global_flag = ag_zeta_crisis_stage_3 } has_global_flag = ag_zeta_crisis_ended } }
							if = {
								limit = { has_global_flag = ag_zeta_crisis_stage_3 NOT = { has_global_flag = ag_zeta_crisis_ended } }
								planet_event = { id = ag_zeta_psionics.51 days = 30 random = 30 }
							}
						}
					}
				}
			}
			if = {
				limit = { root = { is_same_value = root.from } any_ship_in_system = { has_ship_flag = ag_event_alpha_titan } }
				# ag_print_scope_all = yes
				root = {
					reroll_random = yes
					random_list = {
						80 = { }
						10 = {
							modifier = { factor = 0 OR = { NOT = { has_country_flag = ag_alpha_25_fired } has_country_flag = ag_alpha_51_fired } }
							if = {
								limit = { has_country_flag = ag_alpha_25_fired NOT = { has_country_flag = ag_alpha_51_fired } }
								set_country_flag = ag_alpha_51_fired
								country_event = { id = ag_alpha.51 days = 15 random = 15 }
							}
						}
						10 = {
							modifier = { factor = 0 OR = { NOT = { has_country_flag = ag_alpha_26_fired } has_country_flag = ag_alpha_52_fired } }
							if = {
								limit = { has_country_flag = ag_alpha_26_fired NOT = { has_country_flag = ag_alpha_52_fired } }
								set_country_flag = ag_alpha_52_fired
								country_event = { id = ag_alpha.52 days = 15 random = 15 }
							}
						}
					}
					change_variable = { which = ag_alpha_system_locator_charged value = 1 }
					if = {
						limit = { check_variable = { which = ag_alpha_system_locator_charged value > @ag_alpha_psi_container_max_var } }
						set_variable = { which = ag_alpha_system_locator_charged value = 0 }
						if = {
							limit = { has_country_flag = ag_alpha_25_fired NOT = { has_country_flag = ag_alpha_51_fired } }
							set_country_flag = ag_alpha_51_fired
							country_event = { id = ag_alpha.51 days = 15 random = 15 }
						}
						else_if = {
							limit = { has_country_flag = ag_alpha_26_fired NOT = { has_country_flag = ag_alpha_52_fired } }
							set_country_flag = ag_alpha_52_fired
							country_event = { id = ag_alpha.52 days = 15 random = 15 }
						}
					}
					else = {
						if = { limit = { NOT = { has_country_flag = ag_alpha_43_ban } } country_event = { id = ag_alpha.43 days = 2 random = 2 } }
						else = { create_message = {
							type = message_ag_alpha_system_locate_failed
							localization = message_ag_alpha_system_locate_failed_desc
							target = fromfrom.solar_system.star
							days = 30
						} }
					}
				}
			}
		}
		if = {
			limit = { root = { NOT = { is_same_value = from } } }
			if = { limit = { NOT = { has_country_flag = ag_alpha_40_fired } } set_country_flag = ag_alpha_40_fired country_event = { id = ag_alpha.40 } }
			from = { if = { limit = { NOT = { has_country_flag = ag_alpha_41_fired } } set_country_flag = ag_alpha_41_fired country_event = { id = ag_alpha.41 } } }
		}
		fromfrom = { ag_spawn_explosion_effect = { ag_scale = l ag_color = violet } delete_ship = this }
	}
}

# Noti: Ringworld unlock phase 1.
country_event = {
	id = ag_alpha.37
	title = "ag_alpha.37.name"
	desc = "ag_alpha.37.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_s_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_satellite_in_orbit_room }
	show_sound = event_sensor_ping
	location = from
	is_triggered_only = yes
	option = { name = "ag_alpha.37.a" custom_tooltip = "ag_alpha.37.a.tooltip" }
}
# Noti: Ringworld unlock phase 2.
country_event = {
	id = ag_alpha.38
	title = "ag_alpha.38.name"
	desc = "ag_alpha.38.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_s_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_clocks_room }
	show_sound = event_mystic_reveal
	location = from
	is_triggered_only = yes
	option = { name = "ag_alpha.38.a" custom_tooltip = "ag_alpha.38.a.tooltip" }
}
# Noti: Ringworld unlocked.
country_event = {
	id = ag_alpha.39
	title = "ag_alpha.39.name"
	desc = "ag_alpha.39.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_m_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_arctic_planet_room }
	show_sound = event_mystic_reveal
	location = from
	is_triggered_only = yes
	option = { name = "ag_alpha.39.a" custom_tooltip = "ag_alpha.39.a.tooltip" }
}

# Noti: Psionic Container breaks.
country_event = {
	id = ag_alpha.40
	title = "ag_alpha.40.name"
	desc = "ag_alpha.40.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_s_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_debris_room }
	show_sound = event_ship_explosion
	is_triggered_only = yes
	option = { name = "ag_alpha.40.a" }
	option = { name = "ag_alpha.40.b" }
}
country_event = {
	id = ag_alpha.41
	title = "ag_alpha.41.name"
	desc = "ag_alpha.41.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_s_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_debris_room }
	show_sound = event_yellow_alert
	is_triggered_only = yes
	option = { name = "ag_alpha.41.a" }
}

# Noti: Psionic Container destroyed, system locator wrong.
country_event = {
	id = ag_alpha.42
	title = "ag_alpha.42.name"
	desc = "ag_alpha.42.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_s_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_debris_room }
	show_sound = event_ship_explosion
	is_triggered_only = yes
	option = { name = "ag_alpha.42.a" }
}

# Noti: Didn't found system.
country_event = {
	id = ag_alpha.43
	title = "ag_alpha.43.name"
	desc = "ag_alpha.43.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_s_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_arguing_senate_room }
	show_sound = event_sensor_ping
	is_triggered_only = yes
	trigger = { NOT = { has_country_flag = ag_alpha_43_ban } }
	option = { name = "ag_alpha.43.a" }
	option = { name = "ag_alpha.43.b" hidden_effect = { set_country_flag = ag_alpha_43_ban } }
}

# Noti: Found Psionic Ringworld System.
country_event = {
	id = ag_alpha.51
	title = "ag_alpha.51.name"
	desc = "ag_alpha.51.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_m_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_wormhole_room }
	show_sound = event_mystic_reveal
	is_triggered_only = yes
	immediate = {
		save_event_target_as = ag_system_discover_country
		set_spawn_system_batch = begin
		event_target:ag_ancient_alpha_star.solar_system = { spawn_system = {
			min_distance >= 13
			max_distance <= 17
			initializer = ag_alpha_station_system_1
			hyperlane = no
		} }
		event_target:ag_alpha_station_system_1_star.solar_system = {
			isolate_system = yes
			add_hyperlane = { from = this to = event_target:ag_ancient_alpha_star.solar_system }
			if = { limit = { exists = event_target:ag_alpha_station_system_2_star } add_hyperlane = { from = this to = event_target:ag_alpha_station_system_2_star.solar_system } }
		}
		set_spawn_system_batch = end
		if = { limit = { NOT = { has_event_chain = "ag_hidden_system_chain" } } begin_event_chain = { event_chain = "ag_hidden_system_chain" target = root } }
		add_event_chain_counter = { event_chain = "ag_hidden_system_chain" counter = "ag_ancient_system" amount = 1 }
		country_event = { id = ag_spawn.1 }
		every_playable_country = { limit = { NOT = { is_same_value = event_target:ag_system_discover_country } } country_event = { id = ag_spawn.33 } }
		create_point_of_interest = {
			id = ag_alpha_station_system_1
			name = "ag_alpha_station_system_1"
			desc = "ag_alpha_station_system_1_desc"
			event_chain = ag_hidden_system_chain
			location = event_target:ag_alpha_station_system_1_star
		}
	}
	option = { name = "ag_alpha.51.a" }
}
# Noti: Found Psionic Conduit System.
country_event = {
	id = ag_alpha.52
	title = "ag_alpha.52.name"
	desc = "ag_alpha.52.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_m_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_wormhole_room }
	show_sound = event_mystic_reveal
	is_triggered_only = yes
	immediate = {
		save_event_target_as = ag_system_discover_country
		set_spawn_system_batch = begin
		event_target:ag_ancient_alpha_star.solar_system = { spawn_system = {
			min_distance >= 7
			max_distance <= 11
			initializer = ag_alpha_station_system_2
			hyperlane = no
		} }
		event_target:ag_alpha_station_system_2_star.solar_system = {
			isolate_system = yes
			add_hyperlane = { from = this to = event_target:ag_ancient_alpha_star.solar_system }
			if = { limit = { exists = event_target:ag_alpha_station_system_1_star } add_hyperlane = { from = this to = event_target:ag_alpha_station_system_1_star.solar_system } }
		}
		set_spawn_system_batch = end
		if = { limit = { NOT = { has_event_chain = "ag_hidden_system_chain" } } begin_event_chain = { event_chain = "ag_hidden_system_chain" target = root } }
		add_event_chain_counter = { event_chain = "ag_hidden_system_chain" counter = "ag_ancient_system" amount = 1 }
		country_event = { id = ag_spawn.1 }
		every_playable_country = { limit = { NOT = { is_same_value = event_target:ag_system_discover_country } } country_event = { id = ag_spawn.33 } }
		create_point_of_interest = {
			id = ag_alpha_station_system_2
			name = "ag_alpha_station_system_2"
			desc = "ag_alpha_station_system_2_desc"
			event_chain = ag_hidden_system_chain
			location = event_target:ag_alpha_station_system_2_star
		}
	}
	option = { name = "ag_alpha.52.a" }
}

# on_entering_system_fleet, Notification for entering the Psionic RIngworld Ssytem first time
fleet_event = {
	id = ag_alpha.60
	title = "ag_alpha.60.name"
	desc = "ag_alpha.60.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_ancient_alpha_psionic_star_room }
	show_sound = event_mystic_reveal_light
	location = root
	
	is_triggered_only = yes
	trigger = {
		from = { has_star_flag = ag_alpha_station_system_1 }
		owner = {
			is_ai = no
			NOT = { has_country_flag = ag_alpha_station_system_1_entered }
		}
	}
	
	immediate = {
		owner = {
			set_country_flag = ag_alpha_station_system_1_entered
			ag_refresh_ancient_system_poi = { ag_system_id = ag_alpha_station_system_1 }
		}
		from = {
			set_star_class = sc_ag_psionic_star
			star = {
				ag_change_pc = { ag_planet_class = pc_ag_psionic_star }
				set_planet_size = 8
				set_planet_entity = { entity = "ag_psionic_star_01_entity" }
				add_deposit = d_physics_1
				add_deposit = d_society_5
			}
			every_system_planet = {
				limit = { has_planet_flag =  ag_alpha_psionic_ringworld }
				ag_change_pc = { ag_planet_class = pc_ag_ringworld_tech_psionic }
				if = {
					limit = { OR = {
						has_planet_flag = ag_ring_struct_0
						has_planet_flag = ag_ring_struct_2
						has_planet_flag = ag_ring_struct_4
						has_planet_flag = ag_ring_struct_6
						has_planet_flag = ag_ring_struct_8
						has_planet_flag = ag_ring_struct_10
					} }
					ag_set_ancient_ringworld = { ag_color = psionic ag_type = seam }
				}
				else = { ag_set_ancient_ringworld = { ag_color = psionic ag_type = tech } }
				add_deposit = d_physics_1
				add_deposit = d_society_5
			}
		}
	}
	
	option = { name = "ag_alpha.60.a" }
}

# ag_on_yearly_pluse_country_random, Gain tech option after constructed research station.
country_event = {
	id = ag_alpha.61
	title = "ag_alpha.61.name"
	desc = "ag_alpha.61.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_physics_research_room }
	show_sound = event_sensor_ping
	is_triggered_only = yes
	trigger = {
		is_ai = no
		has_country_flag = ag_alpha_station_system_1_entered
		NOR = { has_technology = "tech_ag_adv_psionic_control" has_tech_option = "tech_ag_adv_psionic_control" }
		exists = event_target:ag_alpha_station_system_1_star event_target:ag_alpha_station_system_1_star = { has_research_station = yes }
		exists = event_target:ag_alpha_station_system_1_ring_0 event_target:ag_alpha_station_system_1_ring_0 = { has_research_station = yes }
		exists = event_target:ag_alpha_station_system_1_ring_1 event_target:ag_alpha_station_system_1_ring_1 = { has_research_station = yes }
		exists = event_target:ag_alpha_station_system_1_ring_2 event_target:ag_alpha_station_system_1_ring_2 = { has_research_station = yes }
		exists = event_target:ag_alpha_station_system_1_ring_3 event_target:ag_alpha_station_system_1_ring_3 = { has_research_station = yes }
		exists = event_target:ag_alpha_station_system_1_ring_4 event_target:ag_alpha_station_system_1_ring_4 = { has_research_station = yes }
		exists = event_target:ag_alpha_station_system_1_ring_5 event_target:ag_alpha_station_system_1_ring_5 = { has_research_station = yes }
		exists = event_target:ag_alpha_station_system_1_ring_6 event_target:ag_alpha_station_system_1_ring_6 = { has_research_station = yes }
		exists = event_target:ag_alpha_station_system_1_ring_7 event_target:ag_alpha_station_system_1_ring_7 = { has_research_station = yes }
		exists = event_target:ag_alpha_station_system_1_ring_8 event_target:ag_alpha_station_system_1_ring_8 = { has_research_station = yes }
		exists = event_target:ag_alpha_station_system_1_ring_9 event_target:ag_alpha_station_system_1_ring_9 = { has_research_station = yes }
		exists = event_target:ag_alpha_station_system_1_ring_10 event_target:ag_alpha_station_system_1_ring_10 = { has_research_station = yes }
		exists = event_target:ag_alpha_station_system_1_ring_11 event_target:ag_alpha_station_system_1_ring_11 = { has_research_station = yes }
	}
	option = {
		name = "ag_alpha.61.a"
		ag_add_research_option = { ag_tech = tech_ag_adv_psionic_control }
	}
}

# on_tech_increased, Researched psi control theory.
# country_event = {
	# id = ag_alpha.62
	# title = "ag_alpha.62.name"
	# desc = "ag_alpha.62.desc"
	# diplomatic = yes
	# custom_gui = "ag_ancient_event_window"
	# custom_gui_option = "ag_ancient_event_option"
	# picture_event_data = { room = ag_event_physics_research_room }
	# show_sound = event_laboratory_sound
	# is_triggered_only = yes
	# trigger = { last_increased_tech = tech_ag_adv_psionic_control }
	# option = {
		# name = "ag_alpha.62.a"
	# }
# }

# Know about ancient psionic weapon after alpha titan turn into hostile.
country_event = {
	id = ag_alpha.63
	title = "ag_alpha.63.name"
	desc = "ag_alpha.63.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_ancient_alpha_psionic_star_room }
	show_sound = event_mystic_reveal
	is_triggered_only = yes
	trigger = { NOT = { has_global_flag = ag_ancient_alpha_guardian_destroyed } }
	option = {
		name = "ag_alpha.63.a"
		custom_tooltip = "ag_alpha.63.a.tooltip"
		locked_random_list = {
			10 = { ag_give_research_project = { ag_project_id = @ag_alpha_psionic_star_project_id ag_progress = 1.1 } }
			10 = { ag_give_research_project = { ag_project_id = @ag_alpha_psionic_star_project_id ag_progress = 2.3 } }
			10 = { ag_give_research_project = { ag_project_id = @ag_alpha_psionic_star_project_id ag_progress = 3.7 } }
			10 = { ag_give_research_project = { ag_project_id = @ag_alpha_psionic_star_project_id ag_progress = 4.1 } }
			10 = { ag_give_research_project = { ag_project_id = @ag_alpha_psionic_star_project_id ag_progress = 5.3 } }
		}
	}
}

# Research project completed, gain technology.
country_event = {
	id = ag_alpha.64
	title = "ag_alpha.64.name"
	desc = "ag_alpha.64.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_physics_research_room }
	show_sound = event_laboratory_sound
	is_triggered_only = yes
	option = {
		name = "ag_alpha.64.a"
		ag_add_research_option = { ag_tech = tech_ag_alpha_psionic_star_weapon }
	}
}

# Research project completed, gain technology.
country_event = {
	id = ag_alpha.65
	title = "ag_alpha.65.name"
	desc = "ag_alpha.65.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_ancient_alpha_psionic_star_room }
	show_sound = event_mystic_reveal
	is_triggered_only = yes
	trigger = { last_increased_tech = tech_ag_alpha_psionic_star_weapon }
	option = {
		name = "ag_alpha.65.a"
		custom_tooltip = "ag_alpha.65.a1.tooltip"
		custom_tooltip = "ag_alpha.65.a2.tooltip"
	}
}

# on_tech_increased, Tech effect, colony ascension buff.
country_event = {
	id = ag_alpha.66
	hide_window = yes
	is_triggered_only = yes
	trigger = { last_increased_tech = tech_ag_adv_psionic_control }
	immediate = { every_owned_planet = { planet_event = { id = ag_alpha.67 } } }
}
# on_building_upgraded, on_planet_transfer.
planet_event = {
	id = ag_alpha.67
	hide_window = yes
	is_triggered_only = yes
	trigger = {
		OR = {
			AND = { exists = owner owner = { has_technology = tech_ag_adv_psionic_control } }
			AND = { exists = from from = { is_scope_type = country has_technology = tech_ag_adv_psionic_control } }
		}
		OR = {
			AND = { has_fully_upgraded_capital = yes has_planetary_ascension_tier < 3 }
			AND = { has_major_upgraded_capital = yes has_planetary_ascension_tier < 2 }
			AND = { has_upgraded_capital = yes has_planetary_ascension_tier < 1 }
		}
	}
	immediate = {
		if = {
			limit = { has_fully_upgraded_capital = yes has_planetary_ascension_tier < 3 }
			set_planetary_ascension_tier = 3
		}
		else_if = {
			limit = { has_major_upgraded_capital = yes has_planetary_ascension_tier < 2 }
			set_planetary_ascension_tier = 2
		}
		else_if = {
			limit = { has_upgraded_capital = yes has_planetary_ascension_tier < 1 }
			set_planetary_ascension_tier = 1
		}
	}
}

# on_entering_system_fleet, Notification for entering the Psionic Conduit System first time
fleet_event = {
	id = ag_alpha.70
	title = "ag_alpha.70.name"
	desc = "ag_alpha.70.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_ruined_system_room }
	show_sound = event_mystic_reveal_light
	location = root
	is_triggered_only = yes
	
	trigger = {
		from = { has_star_flag = ag_alpha_station_system_2 }
		owner = {
			is_ai = no
			NOT = { has_country_flag = ag_alpha_station_system_2 }
		}
	}
	
	immediate = {
		owner = {
			set_country_flag = ag_alpha_station_system_2
			ag_refresh_ancient_system_poi = { ag_system_id = ag_alpha_station_system_2 }
		}
		from = { random_system_ambient_object = {
			limit = { is_ambient_object_type = ag_alpha_megastructure_damaged_object }
			save_event_target_as = ag_target_ambient_object
		} }
	}
	
	option = {
		name = "ag_alpha.70.a"
		owner = { enable_special_project = {
			name = "ag_alpha_psionic_conduit_survey"
			owner = root.owner
			location = event_target:ag_target_ambient_object
		} }
	}
}

# Special project completed, spawn arc site.
ship_event = {
	id = ag_alpha.71
	title = "ag_alpha.71.name"
	desc = "ag_alpha.71.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_ruined_system_room }
	show_sound = event_mystic_reveal
	is_triggered_only = yes
	immediate = { owner = { set_country_flag = ag_alpha_psionic_conduit_site_discovered } }
	option = {
		name = "ag_alpha.71.a"
		solar_system.star = { create_archaeological_site = ag_alpha_psionic_conduit_site }
	}
}
# Stage 1
fleet_event = {
	id = ag_alpha.72
	title = "ag_alpha.72.name"
	desc = "ag_alpha.72.desc"
	picture = GFX_evt_space_station
	show_sound = event_dig_site
	archaeology = yes
	is_triggered_only = yes
	immediate = { from = { set_site_progress_locked = yes } }
	after = { from = { set_site_progress_locked = no } }
	option = { name = "ag_alpha.72.a" }
}
# Stage 2
fleet_event = {
	id = ag_alpha.73
	title = "ag_alpha.73.name"
	desc = "ag_alpha.73.desc"
	picture = GFX_evt_space_station
	show_sound = event_dig_site
	archaeology = yes
	is_triggered_only = yes
	immediate = { from = { set_site_progress_locked = yes } }
	after = { from = { set_site_progress_locked = no } }
	option = {
		name = "ag_alpha.73.a"
		small_artifact_reward = yes
	}
}
# Stage 3
fleet_event = {
	id = ag_alpha.74
	title = "ag_alpha.74.name"
	desc = "ag_alpha.74.desc"
	picture = GFX_evt_ancient_databank
	show_sound = event_finding_loot
	archaeology = yes
	is_triggered_only = yes
	immediate = { from = { set_site_progress_locked = yes } }
	after = { from = { set_site_progress_locked = no } }
	option = {
		name = "ag_alpha.74.a"
		small_artifact_reward = yes
	}
}
# Stage 4
fleet_event = {
	id = ag_alpha.75
	title = "ag_alpha.75.name"
	desc = "ag_alpha.75.desc"
	picture = GFX_evt_archaeological_dig
	show_sound = event_mystic_reveal
	archaeology = yes
	is_triggered_only = yes
	immediate = { from = { set_site_progress_locked = yes } }
	after = { from = { set_site_progress_locked = no } }
	option = {
		name = "ag_alpha.75.a"
		leader = { add_experience = 200 }
	}
}
# Stage 5
fleet_event = {
	id = ag_alpha.76
	title = "ag_alpha.76.name"
	desc = "ag_alpha.76.desc"
	picture = GFX_evt_society_cache
	show_sound = event_finding_loot
	archaeology = yes
	is_triggered_only = yes
	immediate = { from = { set_site_progress_locked = yes } }
	after = { from = { set_site_progress_locked = no } }
	option = {
		name = "ag_alpha.76.a"
		small_artifact_reward = yes
	}
}
# Stage 6
fleet_event = {
	id = ag_alpha.77
	title = "ag_alpha.77.name"
	desc = "ag_alpha.77.desc"
	picture = GFX_evt_archaeological_dig
	show_sound = event_mystic_reveal
	archaeology = yes
	is_triggered_only = yes
	immediate = {
		from = { set_site_progress_locked = yes }
		owner = { set_country_flag = ag_event_alpha_titan_contact_available }
	}
	after = { from = { set_site_progress_locked = no } }
	option = {
		name = "ag_alpha.77.a"
		medium_artifact_reward = yes
	}
}

# Contact Psionic Conduit, megastructure activated.
country_event = {
	id = ag_alpha.78
	title = "ag_alpha.78.name"
	desc = "ag_alpha.78.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_ancient_AI_room }
	show_sound = event_dyson_sphere_build_complete
	is_triggered_only = yes
	immediate = {
		set_global_flag = ag_ancient_alpha_guardian_awaken
		ag_create_ancient_guardian = {
			ag_country_name = "NAME_ag_ancient_alpha_guardian_alt"
			ag_country_type = ag_ancient_alpha_guardian
		}
		last_created_country = {
			save_global_event_target_as = ag_ancient_alpha_guardian_country
			set_country_flag = ag_ancient_alpha_guardian_country
			every_country = { limit = { NOR = { is_same_value = prev has_communications = prev } } establish_communications_no_message = prev }
			ag_ancient_country_friendly_to_each_other = yes
			set_faction_hostility = { target = root set_hostile = no set_neutral = no set_friendly = yes }
		}
		random_owned_ship = {
			limit = { has_ship_flag = ag_event_alpha_titan }
			fleet = {
				set_owner = event_target:ag_ancient_alpha_guardian_country
				save_event_target_as = ag_target_fleet
			}
		}
		event_target:ag_alpha_station_system_2_star.solar_system = {
			create_ambient_object = { type = "ag_alpha_megastructure_activated_object" }
			last_created_ambient_object = { set_location = { target = star distance = 0 angle = 0 } }
			random_system_ambient_object = { limit = { is_ambient_object_type = "ag_alpha_megastructure_damaged_object" } destroy_ambient_object = this }
		}
		country_event = { id = ag_alpha.79 days = 90 random = 90 }
		if = {
			limit = {
				exists = event_target:ag_ancient_alpha_shielded_world
				event_target:ag_ancient_alpha_shielded_world = {
					has_planet_flag = ag_alpha_ringworld_phase_locked
					exists = owner
					owner = { ag_is_common_country = yes }
				}
			}
			event_target:ag_ancient_alpha_shielded_world = { planet_event = { id = ag_alpha.98 days = 60 random = 30 } }
		}
		if = {
			limit = {
				exists = event_target:ag_ancient_alpha_shielded_world_2
				event_target:ag_ancient_alpha_shielded_world_2 = {
					has_planet_flag = ag_alpha_ringworld_phase_locked
					exists = owner
					owner = { ag_is_common_country = yes }
				}
			}
			event_target:ag_ancient_alpha_shielded_world_2 = { planet_event = { id = ag_alpha.98 days = 60 random = 30 } }
		}
		every_playable_country = {
			limit = { has_event_chain = "ag_alpha_locked_system_chain" }
			if = { limit = { has_point_of_interest = { poi = ag_alpha_locked_system_0_poi } } remove_point_of_interest = ag_alpha_locked_system_0_poi }
			if = { limit = { has_point_of_interest = { poi = ag_alpha_locked_system_1_poi } } remove_point_of_interest = ag_alpha_locked_system_1_poi }
			if = { limit = { has_point_of_interest = { poi = ag_alpha_locked_system_2_poi } } remove_point_of_interest = ag_alpha_locked_system_2_poi }
			if = { limit = { has_point_of_interest = { poi = ag_alpha_locked_system_3_poi } } remove_point_of_interest = ag_alpha_locked_system_3_poi }
			if = { limit = { has_point_of_interest = { poi = ag_alpha_locked_system_4_poi } } remove_point_of_interest = ag_alpha_locked_system_4_poi }
			end_event_chain = "ag_alpha_locked_system_chain"
		}
	}
	option = {
		name = "ag_alpha.78.a"
	}
	option = {
		name = "ag_alpha.78.b"
	}
}

# Discovered Ancient Titan & Megastructure abnormal activity.
country_event = {
	id = ag_alpha.79
	title = "ag_alpha.79.name"
	desc = "ag_alpha.79.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_glitchy_matrix_room }
	show_sound = event_yellow_alert
	is_triggered_only = yes
	immediate = {
		event_target:ag_ancient_alpha_guardian_country = { set_faction_hostility = { target = root set_hostile = no set_neutral = yes set_friendly = no } }
		country_event = { id = ag_alpha.80 days = 30 random = 30 }
	}
	option = {
		name = "ag_alpha.79.a"
		enable_special_project = {
			name = "ag_alpha_titan_berserk_project"
			owner = root
			location = event_target:ag_target_fleet
		}
	}
	option = {
		name = "ag_alpha.79.b"
		enable_special_project = {
			name = "ag_alpha_megastructure_berserk_project"
			owner = root
			location = event_target:ag_alpha_station_system_2_star
		}
	}
	option = {
		name = "ag_alpha.79.c"
		enable_special_project = {
			name = "ag_alpha_titan_berserk_project"
			owner = root
			location = event_target:ag_target_fleet
		}
		enable_special_project = {
			name = "ag_alpha_megastructure_berserk_project"
			owner = root
			location = event_target:ag_alpha_station_system_2_star
		}
	}
	option = { name = "ag_alpha.79.d" }
}

# Ancient Titan turn into hostile.
country_event = {
	id = ag_alpha.80
	title = "ag_alpha.80.name"
	desc = "ag_alpha.80.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_m_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_fleet_evil_room }
	show_sound = event_red_alert
	is_triggered_only = yes
	trigger = { exists = event_target:ag_ancient_alpha_guardian_country NOT = { is_hostile = event_target:ag_ancient_alpha_guardian_country } }
	immediate = {
		event_target:ag_ancient_alpha_guardian_country = {
			set_faction_hostility = { target = root set_hostile = yes set_neutral = no set_friendly = no }
			random_owned_ship = {
				limit = { has_ship_flag = ag_event_alpha_titan}
				fleet = {
					every_owned_ship = {
						limit = { NOR = {
							has_ship_flag = ag_event_alpha_titan
							is_ship_size = ag_alpha_titan_hostile
							is_ship_size = ag_alpha_psionic_corvette
							is_ship_size = ag_alpha_psionic_destroyer
							is_ship_size = ag_alpha_psionic_cruiser
						} }
						prev = { ag_alpha_psionic_ships_spawn = yes }
						delete_ship = this
					}
					while = { limit = { num_ships < 41 } ag_alpha_psionic_ships_spawn = yes }
				}
				solar_system = {
					ag_clear_ship_cloaking_effect = yes
					if = {
						limit = { exists = starbase }
						every_fleet_in_system = {
							limit = {
								any_controlled_ship = { OR = {
									is_ship_class = shipclass_mining_station
									is_ship_class = shipclass_research_station
									is_ship_class = shipclass_observation_station
								} }
							}
							destroy_fleet = { target = this kill_leader = yes destroy_template = yes }
						}
						starbase.fleet = { destroy_fleet = { target = this kill_leader = yes destroy_template = yes } }
					}
				}
			}
		}
		if = { limit = { has_special_project = "ag_alpha_titan_berserk_project" } abort_special_project = { type = "ag_alpha_titan_berserk_project" } }
		if = { limit = { has_special_project = "ag_alpha_megastructure_berserk_project" } abort_special_project = { type = "ag_alpha_megastructure_berserk_project" } }
	}
	option = { name = "ag_alpha.80.a" }
	option = { name = "ag_alpha.80.b" }
}

# Disable Alpha Titan, going into Phase 2.
ship_event = {
	id = ag_alpha.81
	hide_window = yes
	is_triggered_only = yes
	trigger = { exists = owner has_ship_flag = ag_event_alpha_titan owner = { is_country_type = ag_ancient_alpha_guardian } }
	immediate = {
		fleet = { save_event_target_as = ag_target_fleet }
		from.owner = {
			country_event = { id = ag_alpha.63 days = 120 random = 60 }
			country_event = { id = ag_alpha.83 }
		}
		ag_create_random_shielded_alpha_titan_hostile = yes
		delete_ship = this
	}
}
# Disable Alpha Titan, Phase 2.
ship_event = {
	id = ag_alpha.82
	hide_window = yes
	is_triggered_only = yes
	trigger = { exists = owner is_ship_size = ag_alpha_titan_hostile owner = { is_country_type = ag_ancient_alpha_guardian } }
	immediate = {
		from = {
			if = { limit = { exists = fleet fleet = { num_ships > 1 } ag_is_ancient_ship = no ag_is_ancient_ship_unlocked = no } }
			reroll_random = yes
			random_list = {
				90 = { }
				10 = {
					ag_spawn_buff_effect = { ag_type = 3 ag_scale = s ag_color = violet }
					if = {
						limit = { NOT = { has_modifier = "ag_alpha_titan_debuff_shield_damage" } }
						set_timed_ship_flag = { flag = ag_ship_shield_damage_mult_locked days = 3 }
						add_modifier = { modifier = ag_alpha_titan_debuff_shield_damage days = 2 multiplier = value:ag_no_weapon_damage_factor|ag_target|shield| }
					}
					if = {
						limit = { NOT = { has_modifier = "ag_alpha_titan_debuff_armor_damage" } }
						set_timed_ship_flag = { flag = ag_ship_armor_damage_mult_locked days = 3 }
						add_modifier = { modifier = ag_alpha_titan_debuff_armor_damage days = 2 multiplier = value:ag_no_weapon_damage_factor|ag_target|armor| }
					}
					if = {
						limit = { NOT = { has_modifier = "ag_alpha_titan_debuff_hull_damage" } }
						set_timed_ship_flag = { flag = ag_ship_hull_damage_mult_locked days = 3 }
						add_modifier = { modifier = ag_alpha_titan_debuff_hull_damage days = 2 multiplier = value:ag_no_weapon_damage_factor|ag_target|hull| }
					}
					if = {
						limit = { NOT = { has_modifier = "ag_alpha_titan_debuff_shield_regen_perc" } }
						set_timed_ship_flag = { flag = ag_ship_shield_regen_add_perc_locked days = 3 }
						add_modifier = { modifier = ag_alpha_titan_debuff_shield_regen_perc days = 2 multiplier = value:ag_negative_modifier|ag_which|ship_shield_regen_add_perc| }
					}
					if = {
						limit = { NOT = { has_modifier = "ag_alpha_titan_debuff_shield_regen_static" } }
						set_timed_ship_flag = { flag = ag_ship_shield_regen_add_static_locked days = 3 }
						add_modifier = { modifier = ag_alpha_titan_debuff_shield_regen_static days = 2 multiplier = value:ag_negative_modifier|ag_which|ship_shield_regen_add_static| }
					}
					if = {
						limit = { NOT = { has_modifier = "ag_alpha_titan_debuff_armor_regen_perc" } }
						set_timed_ship_flag = { flag = ag_ship_armor_regen_add_perc_locked days = 3 }
						add_modifier = { modifier = ag_alpha_titan_debuff_armor_regen_perc days = 2 multiplier = value:ag_negative_modifier|ag_which|ship_armor_regen_add_perc| }
					}
					if = {
						limit = { NOT = { has_modifier = "ag_alpha_titan_debuff_armor_regen_static" } }
						set_timed_ship_flag = { flag = ag_ship_armor_regen_add_static_locked days = 3 }
						add_modifier = { modifier = ag_alpha_titan_debuff_armor_regen_static days = 2 multiplier = value:ag_negative_modifier|ag_which|ship_armor_regen_add_static| }
					}
					if = {
						limit = { NOT = { has_modifier = "ag_alpha_titan_debuff_hull_regen_perc" } }
						set_timed_ship_flag = { flag = ag_ship_hull_regen_add_perc_locked days = 3 }
						add_modifier = { modifier = ag_alpha_titan_debuff_hull_regen_perc days = 2 multiplier = value:ag_negative_modifier|ag_which|ship_hull_regen_add_perc| }
					}
					if = {
						limit = { NOT = { has_modifier = "ag_alpha_titan_debuff_hull_regen_static" } }
						set_timed_ship_flag = { flag = ag_ship_hull_regen_add_static_locked days = 3 }
						add_modifier = { modifier = ag_alpha_titan_debuff_hull_regen_static days = 2 multiplier = value:ag_negative_modifier|ag_which|ship_hull_regen_add_static| }
					}
					reroll_random = yes
					random_list = {
						10 = { ag_reduce_hp = { ag_value = value:ag_subtract_trigger|ag_which|has_hp|ag_value|64| } }
						10 = { ag_reduce_hp = { ag_value = value:ag_subtract_trigger|ag_which|has_hp|ag_value|128| } }
						10 = { ag_reduce_hp = { ag_value = value:ag_subtract_trigger|ag_which|has_hp|ag_value|256| } }
						10 = { }
					}
				}
			}
		}
		if = {
			limit = { has_ship_flag = ag_alpha_titan_hostile_psi_shield_enabled }
			reroll_random = yes
			random_list = { 75 = { } 25 = { fleet = { while = { limit = { num_ships < 41 } ag_alpha_psionic_ships_spawn = yes } } } }
			if = {
				limit = { fleet = { OR = {
					check_variable = { which = ag_fleet_combat_days value <= 31 }
					NOT = { check_variable_arithmetic = { which = ag_fleet_combat_days modulo = 29 value = 0 } }
				} } }
				repair_ship = yes
				set_disabled = no
				ag_spawn_invincible_effect = yes
			}
			else = {
				reroll_random = yes
				random_list = {
					75 = {
						repair_ship = yes
						set_disabled = no
						ag_spawn_invincible_effect = yes
					}
					25 = {
						ag_spawn_explosion_effect = { ag_color = violet ag_scale = l }
						remove_ship_flag = ag_alpha_titan_hostile_psi_shield_enabled
						fleet = {
							clear_variable = ag_alpha_titan_hostile_color
							create_ship = {
								name = "NAME_ag_alpha_titan_ship"
								design = "NAME_ag_alpha_titan_hostile_alt"
								prefix = no
								effect = {
									reroll_random = yes
									random_list = {
										10 = { set_timed_ship_flag = { flag = ag_alpha_titan_hostile_shield_cooldown days = 1 } fleet_event = { id = ag_alpha.821 days = 1 } }
										10 = { set_timed_ship_flag = { flag = ag_alpha_titan_hostile_shield_cooldown days = 2 } fleet_event = { id = ag_alpha.821 days = 2 } }
										10 = { set_timed_ship_flag = { flag = ag_alpha_titan_hostile_shield_cooldown days = 3 } fleet_event = { id = ag_alpha.821 days = 3 } }
										10 = { set_timed_ship_flag = { flag = ag_alpha_titan_hostile_shield_cooldown days = 4 } fleet_event = { id = ag_alpha.821 days = 4 } }
										10 = { set_timed_ship_flag = { flag = ag_alpha_titan_hostile_shield_cooldown days = 5 } fleet_event = { id = ag_alpha.821 days = 5 } }
									}
									ag_difficulty_bonus = yes
									ag_set_disable_at_health = { ag_value = 0.10 ag_disable_type = event }
								}
							}
						}
						delete_ship = this
					}
				}
			}
		}
		else = {
			ag_spawn_explosion_effect = { ag_scale = xl ag_color = violet }
			fleet = { while = { limit = { num_ships < 41 } ag_alpha_psionic_ships_spawn = yes } }
			from.owner = { country_event = { id = ag_alpha.91 } }
			delete_ship = this
		}
	}
}
fleet_event = {
	id = ag_alpha.821
	hide_window = yes
	is_triggered_only = yes
	trigger = { exists = this any_owned_ship = { is_ship_size = ag_alpha_titan_hostile NOT = { has_ship_flag = ag_alpha_titan_hostile_psi_shield_enabled } } }
	immediate = {
		random_owned_ship = {
			limit = { is_ship_size = ag_alpha_titan_hostile NOT = { has_ship_flag = ag_alpha_titan_hostile_psi_shield_enabled } }
			prev = {
				reroll_random = yes
				random_list = {
					25 = {
						set_variable = { which = ag_alpha_titan_hostile_color value = 0 }
						create_ship = {
							name = "NAME_ag_alpha_titan_ship"
							design = "NAME_ag_alpha_titan_hostile_psi_violet"
							prefix = no
							effect = {
								set_ship_flag = ag_alpha_titan_hostile_psi_shield_enabled
								ag_difficulty_bonus = yes
								ag_set_disable_at_health = { ag_value = 0.10 ag_disable_type = event }
							}
						}
					}
					25 = {
						set_variable = { which = ag_alpha_titan_hostile_color value = 1 }
						create_ship = {
							name = "NAME_ag_alpha_titan_ship"
							design = "NAME_ag_alpha_titan_hostile_psi_red"
							prefix = no
							effect = {
								set_ship_flag = ag_alpha_titan_hostile_psi_shield_enabled
								ag_difficulty_bonus = yes
								ag_set_disable_at_health = { ag_value = 0.10 ag_disable_type = event }
							}
						}
					}
					25 = {
						set_variable = { which = ag_alpha_titan_hostile_color value = 2 }
						create_ship = {
							name = "NAME_ag_alpha_titan_ship"
							design = "NAME_ag_alpha_titan_hostile_psi_yellow"
							prefix = no
							effect = {
								set_ship_flag = ag_alpha_titan_hostile_psi_shield_enabled
								ag_difficulty_bonus = yes
								ag_set_disable_at_health = { ag_value = 0.10 ag_disable_type = event }
							}
						}
					}
					25 = {
						set_variable = { which = ag_alpha_titan_hostile_color value = 3 }
						create_ship = {
							name = "NAME_ag_alpha_titan_ship"
							design = "NAME_ag_alpha_titan_hostile_psi_teal"
							prefix = no
							effect = {
								set_ship_flag = ag_alpha_titan_hostile_psi_shield_enabled
								ag_difficulty_bonus = yes
								ag_set_disable_at_health = { ag_value = 0.10 ag_disable_type = event }
							}
						}
					}
				}
			}
			delete_ship = this
		}
	}
}

# Noti: Ancient Titan become invincible.
country_event = {
	id = ag_alpha.83
	title = "ag_alpha.83.name"
	desc = "ag_alpha.83.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_small_space_battle_room }
	show_sound = event_space_battle
	is_triggered_only = yes
	immediate = { from.solar_system = { random_neighbor_system = { save_event_target_as = ag_target_system } } }
	option = {
		name = "ag_alpha.83.a"
		custom_tooltip = "ag_alpha.83.a.tooltip"
		hidden_effect = {
			from.solar_system = { every_fleet_in_system = {
				limit = { exists = owner owner = { is_same_value = root } }
				set_location = event_target:ag_target_system.star
				clear_orders = yes
				clear_fleet_actions = this
			} }
		}
	}
	option = { name = "ag_alpha.83.b" }
}

# Fire Ancient Psi Weapon, alpha titan shielkd disabled, spawn psi fog in surrounding systems.
system_event = {
	id = ag_alpha.84
	hide_window = yes
	is_triggered_only = yes
	immediate = {
		star = { create_ambient_object = {
			type = ag_alpha_psi_weapon_windup_object
			location = this
			duration = -1
			use_3d_location = yes
			entity_offset = { min = 0.01 max = 0.01 }
			entity_offset_angle = { min = 0.01 max = 0.01 }
			entity_offset_height = { min = 0.01 max = 0.01 }
			entity_scale_to_size = no
			scale = 50.0
		} }
		system_event = { id = ag_alpha.85 days = @ag_alpha_psionic_weapon_fire_delay }
		if = { limit = { exists = space_owner } space_owner = { country_event = { id = ag_alpha.86 } } }
	}
}
system_event = {
	id = ag_alpha.85
	hide_window = yes
	is_triggered_only = yes
	immediate = {
		random_system_ambient_object = { limit = { is_ambient_object_type = ag_alpha_psi_weapon_windup_object } destroy_ambient_object = this }
		set_global_flag = ag_alpha_psionic_weapon_fired
		if = {
			limit = { exists = event_target:ag_alpha_titan_hostile_fleet }
			event_target:ag_alpha_titan_hostile_fleet = {
				random_owned_ship = {
					limit = { has_ship_flag = ag_alpha_titan_hostile_psi_shield_enabled }
					if = {
						limit = { prev = { OR = {
							AND = { check_variable = { which = ag_alpha_titan_hostile_color value = 0 } root.star = { check_variable = { which = ag_ancient_psi_star_weapon_charge_0 value > 0 } } }
							AND = { check_variable = { which = ag_alpha_titan_hostile_color value = 1 } root.star = { check_variable = { which = ag_ancient_psi_star_weapon_charge_1 value > 0 } } }
							AND = { check_variable = { which = ag_alpha_titan_hostile_color value = 2 } root.star = { check_variable = { which = ag_ancient_psi_star_weapon_charge_2 value > 0 } } }
							AND = { check_variable = { which = ag_alpha_titan_hostile_color value = 3 } root.star = { check_variable = { which = ag_ancient_psi_star_weapon_charge_3 value > 0 } } }
						} } }
						prev = { set_timed_fleet_flag = { flag = ag_event_alpha_titan_psi_shield_disable days = 2 } }
						ag_spawn_explosion_effect = { ag_scale = l ag_color = orange }
						delete_ship = this
					}
				}
				if = {
					limit = { has_fleet_flag = ag_event_alpha_titan_psi_shield_disable }
					clear_variable = ag_alpha_titan_hostile_color
					create_ship = {
						name = "NAME_ag_alpha_titan_ship"
						design = "NAME_ag_alpha_titan_hostile_alt"
						prefix = no
						effect = {
							ag_difficulty_bonus = yes
							ag_set_disable_at_health = { ag_value = 0.10 ag_disable_type = event }
						}
					}
				}
			}
		}
		every_system = {
			limit = {
				NOT = { has_star_flag = ag_alpha_station_system_1 }
				OR = {
					has_star_flag = ag_alpha_station_system_2
					distance = {
						source = root
						min_distance >= 0
						max_distance <= 80
						type = euclidean
						use_bypasses = no
						same_solar_system = no
					}
				}
			}
			create_ambient_object = { type = "ag_alpha_psi_weapon_effect_object" }
			last_created_ambient_object = { set_location = { target = prev.star distance = 0 angle = random } }
			add_modifier = { modifier = "ag_ancient_psi_weapon_effect" days = -1 }
		}
		star = { planet_event = { id = ag_alpha.89 days = 1 } }
		if = { limit = { exists = space_owner } space_owner = { country_event = { id = ag_alpha.87 } } }
	}
}

# Noti: psi weapon charging.
country_event = {
	id = ag_alpha.86
	title = "ag_alpha.86.name"
	desc = "ag_alpha.86.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_s_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_ancient_alpha_psionic_star_room }
	show_sound = event_mystic_reveal
	is_triggered_only = yes
	option = { name = "ag_alpha.86.a" }
}

# Noti: psi weapon fired succeed.
country_event = {
	id = ag_alpha.87
	title = "ag_alpha.87.name"
	desc = "ag_alpha.87.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_s_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_space_station_room }
	show_sound = event_mystic_reveal
	is_triggered_only = yes
	option = { name = "ag_alpha.87.a" }
}

# Noti: psi weapon fired failed.
country_event = {
	id = ag_alpha.88
	title = "ag_alpha.88.name"
	desc = "ag_alpha.88.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_s_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_ship_in_orbit_room }
	show_sound = event_yellow_alert
	is_triggered_only = yes
	option = { name = "ag_alpha.88.a" }
}

# Psi weapon after effect.
planet_event = {
	id = ag_alpha.89
	hide_window = yes
	is_triggered_only = yes
	immediate = {
		remove_global_flag = ag_alpha_psionic_weapon_fired
		remove_planet_flag = ag_alpha_psionic_firing
		subtract_variable = { which = ag_ancient_psi_star_weapon_charge_0 value = 1 }
		subtract_variable = { which = ag_ancient_psi_star_weapon_charge_1 value = 1 }
		subtract_variable = { which = ag_ancient_psi_star_weapon_charge_2 value = 1 }
		subtract_variable = { which = ag_ancient_psi_star_weapon_charge_3 value = 1 }
		if = { limit = { check_variable = { which = ag_ancient_psi_star_weapon_charge_0 value <= 0 } } clear_variable = ag_ancient_psi_star_weapon_charge_0 }
		if = { limit = { check_variable = { which = ag_ancient_psi_star_weapon_charge_1 value <= 1 } } clear_variable = ag_ancient_psi_star_weapon_charge_1 }
		if = { limit = { check_variable = { which = ag_ancient_psi_star_weapon_charge_2 value <= 2 } } clear_variable = ag_ancient_psi_star_weapon_charge_2 }
		if = { limit = { check_variable = { which = ag_ancient_psi_star_weapon_charge_3 value <= 3 } } clear_variable = ag_ancient_psi_star_weapon_charge_3 }
		if = {
			limit = { NOR = {
				is_variable_set = ag_ancient_psi_star_weapon_charge_0
				is_variable_set = ag_ancient_psi_star_weapon_charge_1
				is_variable_set = ag_ancient_psi_star_weapon_charge_2
				is_variable_set = ag_ancient_psi_star_weapon_charge_3
			} }
			every_system = {
				limit = { has_modifier = "ag_ancient_psi_weapon_effect" }
				remove_modifier = "ag_ancient_psi_weapon_effect"
				every_system_ambient_object = { limit = { is_ambient_object_type = ag_alpha_psi_weapon_effect_object } destroy_ambient_object = this }
			}
			if = {
				limit = { exists = event_target:ag_alpha_titan_hostile_fleet }
				event_target:ag_alpha_titan_hostile_fleet = {
					random_owned_ship = { limit = { is_ship_size = ag_alpha_titan_hostile NOT = { has_ship_flag = ag_alpha_titan_hostile_psi_shield_enabled } } delete_ship = this }
					reroll_random = yes
					random_list = {
						25 = {
							set_variable = { which = ag_alpha_titan_hostile_color value = 0 }
							create_ship = {
								name = "NAME_ag_alpha_titan_ship"
								design = "NAME_ag_alpha_titan_hostile_psi_violet"
								prefix = no
								effect = {
									set_ship_flag = ag_alpha_titan_hostile_psi_shield_enabled
									ag_difficulty_bonus = yes
									ag_set_disable_at_health = { ag_value = 0.10 ag_disable_type = event }
								}
							}
						}
						25 = {
							set_variable = { which = ag_alpha_titan_hostile_color value = 1 }
							create_ship = {
								name = "NAME_ag_alpha_titan_ship"
								design = "NAME_ag_alpha_titan_hostile_psi_red"
								prefix = no
								effect = {
									set_ship_flag = ag_alpha_titan_hostile_psi_shield_enabled
									ag_difficulty_bonus = yes
									ag_set_disable_at_health = { ag_value = 0.10 ag_disable_type = event }
								}
							}
						}
						25 = {
							set_variable = { which = ag_alpha_titan_hostile_color value = 2 }
							create_ship = {
								name = "NAME_ag_alpha_titan_ship"
								design = "NAME_ag_alpha_titan_hostile_psi_yellow"
								prefix = no
								effect = {
									set_ship_flag = ag_alpha_titan_hostile_psi_shield_enabled
									ag_difficulty_bonus = yes
									ag_set_disable_at_health = { ag_value = 0.10 ag_disable_type = event }
								}
							}
						}
						25 = {
							set_variable = { which = ag_alpha_titan_hostile_color value = 3 }
							create_ship = {
								name = "NAME_ag_alpha_titan_ship"
								design = "NAME_ag_alpha_titan_hostile_psi_teal"
								prefix = no
								effect = {
									set_ship_flag = ag_alpha_titan_hostile_psi_shield_enabled
									ag_difficulty_bonus = yes
									ag_set_disable_at_health = { ag_value = 0.10 ag_disable_type = event }
								}
							}
						}
					}
				}
			}
			if = { limit = { exists = space_owner } space_owner = { country_event = { id = ag_alpha.90 } } }
		}
		else = { planet_event = { id = ag_alpha.89 days = 1 } }
	}
}

# Noti: psi weapon effect disappeared.
country_event = {
	id = ag_alpha.90
	title = "ag_alpha.90.name"
	desc = "ag_alpha.90.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_s_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_ship_in_orbit_room }
	show_sound = event_default
	is_triggered_only = yes
	option = { name = "ag_alpha.90.a" }
}

# Noti: Ancient Titan destroyed.
country_event = {
	id = ag_alpha.91
	title = "ag_alpha.91.name"
	desc = "ag_alpha.91.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_m_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_small_space_battle_room }
	show_sound = event_space_battle
	is_triggered_only = yes
	option = { name = "ag_alpha.91.a" }
}

# on_ship_destroyed_perp, Destroy psionic ships, alpha event ended.
country_event = {
	id = ag_alpha.92
	title = "ag_alpha.92.name"
	desc = "ag_alpha.92.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_small_space_battle_room }
	show_sound = event_space_battle
	location = fromfrom

	is_triggered_only = yes
	fire_only_once = yes

	trigger = {
		from = {
			has_country_flag = ag_ancient_alpha_guardian_country
			count_controlled_ship = { count < 1 }
		}
		fromfromfrom = { NOT = { has_ship_flag = ag_set_disable_at_health } }
	}

	immediate = {
		set_global_flag = ag_ancient_alpha_guardian_destroyed
		save_event_target_as = ag_ancient_alpha_guardian_killer
		add_threat = { who = this amount = 50 }
		if = {
			limit = {
				exists = event_target:ag_ancient_alpha_shielded_world
				exists = event_target:ag_ancient_alpha_shielded_world_2
				event_target:ag_ancient_alpha_shielded_world = { NOT = { has_planet_flag = ag_alpha_ringworld_phase_locked } }
				event_target:ag_ancient_alpha_shielded_world_2 = { NOT = { has_planet_flag = ag_alpha_ringworld_phase_locked } }
			}
			country_event = { id = ag_alpha.97 days = 30 random = 30 }
		}
		if = {
			limit = {
				exists = event_target:ag_ancient_alpha_shielded_world
				event_target:ag_ancient_alpha_shielded_world = { exists = owner }
			}
		}
		every_country = {
			if = {
				limit = { has_modifier = ag_ancient_alpha_weakness }
				remove_modifier = "ag_ancient_alpha_weakness"
			}
			if = {
				limit = { has_country_flag = ag_has_ancient_alpha_guardian_weakness }
				remove_country_flag = ag_has_ancient_alpha_guardian_weakness
			}
			if = {
				limit = { has_special_project = ag_find_ancient_alpha_guardian_weakness }
				abort_special_project = { type = "ag_find_ancient_alpha_guardian_weakness" location = capital_scope }
			}
		}
		every_playable_country = {
			limit = { NOR = { is_same_value = root is_same_value = root.from } }
			country_event = { id = ag_alpha.96 }
		}
	}
	after = { from = { destroy_country = yes } }

	option = { name = "ag_alpha.92.a" }
}

# on_ship_destroyed_victim, Research weakness if lost too many ships, fallen empire defensive system.
country_event = {
	id = ag_alpha.93
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		from = { is_country_type = ag_ancient_alpha_guardian }
		is_ai = no
		NOR = {
			has_global_flag = ag_ancient_alpha_guardian_destroyed
			has_country_flag = ag_has_ancient_alpha_guardian_weakness
		}
	}

	immediate = {
		if = {
			limit = { check_variable = { which = ag_ancient_alpha_guardian_killcount value < 1 } }
			set_variable = { which = ag_ancient_alpha_guardian_killcount value = 1 }
		}
		fromfrom = { root = { ag_hostile_kill_counter = { ag_variable_name = ag_ancient_alpha_guardian_killcount } } }
		if = {
			limit = {
				check_variable = { which = ag_ancient_alpha_guardian_killcount value > 512 }
				NOR = {
					has_global_flag = ag_ancient_alpha_guardian_destroyed
					has_country_flag = ag_has_ancient_alpha_guardian_weakness
				}
			}
			set_variable = { which = ag_ancient_alpha_guardian_killcount value = 512 }
			random_list = {
				25 = {
					country_event = { id = ag_alpha.94 days = 30 random = 30 }
					set_country_flag = ag_has_ancient_alpha_guardian_weakness
				}
				75 = { }
			}
		}
	}
}
country_event = {
	id = ag_alpha.94
	title = "ag_alpha.94.name"
	desc = "ag_alpha.94.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_s_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_sabotaged_ship_room }
	show_sound = event_yellow_alert

	is_triggered_only = yes
	trigger = { NOT = { has_global_flag = ag_ancient_alpha_guardian_destroyed } }

	option = {
		name = "ag_alpha.94.a"
		enable_special_project = {
			name = "ag_find_ancient_alpha_guardian_weakness"
			location = capital_scope
			owner = root
		}
	}
	option = {
		name = "ag_alpha.94.b"
		add_resource = { influence = @ag_end_event_influence_large }
	}
}
country_event = {
	id = ag_alpha.95
	title = "ag_alpha.95.name"
	desc = "ag_alpha.95.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_s_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_physics_research_room }
	show_sound = event_laboratory_sound
	is_triggered_only = yes
	option = {
		name = "ag_alpha.95.a"
		if = {
			limit = { NOT = { has_modifier = ag_ancient_alpha_weakness } }
			add_modifier = { modifier = ag_ancient_alpha_weakness days = -1 }
		}
	}
}

# Notification: Ancient Ships, for others
country_event = {
	id = ag_alpha.96
	title = "ag_alpha.96.name"
	desc = "ag_alpha.96.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_s_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_throne_room }
	show_sound = event_mystic_reveal
	is_triggered_only = yes
	trigger = { NOT = { has_country_flag = ag_alpha_96_fired } }
	immediate = { set_country_flag = ag_alpha_96_fired }
	option = { name = "ag_alpha.96.a" }
}

# Noti: Unlock a ringworld if player didn't unlock any when event ended.
country_event = {
	id = ag_alpha.97
	title = "ag_alpha.97.name"
	desc = "ag_alpha.97.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_clocks_room }
	show_sound = event_mystic_reveal
	is_triggered_only = yes
	immediate = {
		reroll_random = yes
		random_list = {
			50 = { event_target:ag_ancient_alpha_shielded_world = {
				set_planet_flag = ag_alpha_ringworld_phase_locked
				if = { limit = { NOT = { is_planet_class = pc_ag_ringworld_arctic } } ag_alpha_ringworld_swap = { ag_random_primitives = no } }
				else_if = { limit = { is_colony = yes exists = owner owner = { is_country_type = primitive } } destroy_colony = yes owner = { destroy_country = yes } }
			} }
			50 = { event_target:ag_ancient_alpha_shielded_world_2 = {
				set_planet_flag = ag_alpha_ringworld_phase_locked
				if = { limit = { NOT = { is_planet_class = pc_ag_ringworld_arctic } } ag_alpha_ringworld_swap = { ag_random_primitives = no } }
				else_if = { limit = { is_colony = yes exists = owner owner = { is_country_type = primitive } } destroy_colony = yes owner = { destroy_country = yes } }
			} }
		}
	}
	option = { name = "ag_alpha.97.a" }
}

# Noti: Ringworld deposit turn into building when ancient titan turn into hostile.
planet_event = {
	id = ag_alpha.98
	title = "ag_alpha.98.name"
	desc = "ag_alpha.98.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_outpost_room }
	show_sound = event_mystic_reveal
	location = root
	is_triggered_only = yes
	option = {
		name = "ag_alpha.98.a"
		remove_deposit = ag_alpha_archive_deposit
		add_building = ag_ancient_alpha_archive_0
	}
	# option = {
		# name = "ag_alpha.98.b"
		# owner = { add_resource = { influence = @ag_end_event_influence_large } }
	# }
}

# Noti: Alpha Archive ugrade available.
country_event = {
	id = ag_alpha.99
	title = "ag_alpha.99.name"
	desc = "ag_alpha.99.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_outpost_room }
	show_sound = event_mystic_reveal
	location = root
	is_triggered_only = yes
	option = { name = "ag_alpha.99.a" }
}

# on_colonized, Colonize stabled ringworlds after event ended.
planet_event = {
	id = ag_alpha.100
	title = "ag_alpha.100.name"
	desc = "ag_alpha.100.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_arctic_planet_room }
	show_sound = event_mystic_reveal
	location = root
	is_triggered_only = yes
	trigger = {
		OR = {
			is_same_value = event_target:ag_ancient_alpha_shielded_world
			is_same_value = event_target:ag_ancient_alpha_shielded_world_2
		}
		has_planet_flag = ag_alpha_ringworld_phase_locked
		has_deposit = ag_alpha_archive_deposit
	}
	option = {
		name = "ag_alpha.100.a"
		remove_deposit = ag_alpha_archive_deposit
		add_building = ag_ancient_alpha_archive_0
	}
	# option = {
		# name = "ag_alpha.100.b"
		# owner = { add_resource = { influence = @ag_end_event_influence_large } }
	# }
}

# Build Alpha Titan.
# Ancient Titan, stage 1/5
country_event = {
	id = ag_alpha.110
	title = "ag_alpha.110.name"
	desc = "ag_alpha.110.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_s_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_megastructure_construction_room }
	show_sound = event_ringworld_build_start
	location = fromfromfrom
	is_triggered_only = yes
	option = { name = "ag_alpha.110.a" }
	option = {
		name = "ag_auto_upgrade"
		trigger = { fromfromfrom = { NOT = { has_megastructure_flag = ag_auto_upgrade_megastructure } } }
		ag_set_auto_upgrade_megastructure = yes
	}
}
# Ancient Titan, stage 2/5
country_event = {
	id = ag_alpha.111
	title = "ag_alpha.111.name"
	desc = "ag_alpha.111.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_s_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_megastructure_construction_room }
	show_sound = event_dyson_sphere_build_upgrade_frame
	location = fromfromfrom
	is_triggered_only = yes
	option = { name = "ag_alpha.111.a" }
	option = {
		name = "ag_auto_upgrade"
		trigger = { fromfromfrom = { NOT = { has_megastructure_flag = ag_auto_upgrade_megastructure } } }
		ag_set_auto_upgrade_megastructure = yes
	}
}
# Ancient Titan, stage 3/5
country_event = {
	id = ag_alpha.112
	title = "ag_alpha.112.name"
	desc = "ag_alpha.112.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_s_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_megastructure_construction_room }
	show_sound = event_dyson_sphere_build_upgrade_frame
	location = fromfromfrom
	is_triggered_only = yes
	option = { name = "ag_alpha.112.a" }
	option = {
		name = "ag_auto_upgrade"
		trigger = { fromfromfrom = { NOT = { has_megastructure_flag = ag_auto_upgrade_megastructure } } }
		ag_set_auto_upgrade_megastructure = yes
	}
}
# Ancient Titan, stage 4/5
country_event = {
	id = ag_alpha.113
	title = "ag_alpha.113.name"
	desc = "ag_alpha.113.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_s_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_megastructure_construction_room }
	show_sound = event_dyson_sphere_build_upgrade_frame
	location = fromfromfrom
	is_triggered_only = yes
	option = { name = "ag_alpha.113.a" }
	option = {
		name = "ag_auto_upgrade"
		trigger = { fromfromfrom = { NOT = { has_megastructure_flag = ag_auto_upgrade_megastructure } } }
		ag_set_auto_upgrade_megastructure = yes
	}
}
# Ancient Titan, stage 5/5
country_event = {
	id = ag_alpha.114
	title = "ag_alpha.114.name"
	desc = "ag_alpha.114.desc"
	inline_script = "events/ag_ancient_titan_built_options"
}
# Ancient Titan, stage 1/5 (others)
country_event = {
	id = ag_alpha.115
	title = "ag_alpha.1066.name"
	desc = "ag_alpha.1066.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_s_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_megastructure_construction_room }
	show_sound = event_mega_structure_other_empire_build_complete
	location = fromfromfrom
	is_triggered_only = yes
	option = { name = "ag_alpha.115.a" }
}
# Ancient Titan, stage 5/5 (others)
country_event = {
	id = ag_alpha.116
	title = "ag_alpha.116.name"
	desc = "ag_alpha.116.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_s_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_megastructure_construction_room }
	show_sound = event_mega_structure_other_empire_build_complete
	location = fromfromfrom
	is_triggered_only = yes
	inline_script = "events/ag_ancient_titan_built_other_options"
}

# Psionic Conduit Stable Calculation.
country_event = {
	id = ag_alpha.120
	hide_window = yes
	is_triggered_only = yes
	immediate = {
		if = {
			limit = { exists = event_target:ag_psionic_conduit_megastructure }
			event_target:ag_psionic_conduit_megastructure = { ag_alpha_psionic_conduit_calculate_stability = yes }
			if = {
				limit = { NOT = { has_country_flag = ag_alpha_psionic_conduit_events_cooldown } }
				reroll_random = yes
				random_list = {
					10 = { set_timed_country_flag = { flag = ag_alpha_psionic_conduit_events_cooldown days = 180 } }
					10 = { set_timed_country_flag = { flag = ag_alpha_psionic_conduit_events_cooldown days = 360 } }
					10 = { set_timed_country_flag = { flag = ag_alpha_psionic_conduit_events_cooldown days = 540 } }
					10 = { set_timed_country_flag = { flag = ag_alpha_psionic_conduit_events_cooldown days = 720 } }
					10 = { set_timed_country_flag = { flag = ag_alpha_psionic_conduit_events_cooldown days = 900 } }
					10 = { set_timed_country_flag = { flag = ag_alpha_psionic_conduit_events_cooldown days = 1080 } }
				}
				if = {
					limit = { event_target:ag_psionic_conduit_megastructure = { check_variable = { which = ag_alpha_psionic_conduit_stability value < 40 } } }
					if = {
						limit = { has_global_flag = ag_ancient_zeta_guardian_destroyed NOT = { has_global_flag = ag_zeta_crisis_ended } }
						ag_create_random_psionic_effect_on_target = yes
					}
				}
				if = {
					limit = { event_target:ag_psionic_conduit_megastructure = { check_variable = { which = ag_alpha_psionic_conduit_stability value < 20 } } }
					if = {
						limit = { has_global_flag = ag_ancient_zeta_guardian_destroyed NOT = { has_global_flag = ag_zeta_crisis_ended } }
						ag_create_random_psionic_effect_on_target = yes
					}
					if = {
						limit = { NOR = { has_country_flag = ag_alpha_psionic_conduit_low_stability_tmp has_country_flag = ag_alpha_psionic_conduit_low_stability_flag has_situation = ag_psionic_conduit_unstable_situation } }
						set_country_flag = ag_alpha_psionic_conduit_low_stability_tmp
						create_message = {
							type = message_ag_psionic_conduit_unstable
							localization = message_ag_psionic_conduit_unstable_desc
							target = event_target:ag_psionic_conduit_megastructure
							days = 30
						}
					}
					else_if = {
						limit = { has_country_flag = ag_alpha_psionic_conduit_low_stability_tmp NOT = { has_situation = ag_psionic_conduit_unstable_situation } }
						remove_country_flag = ag_alpha_psionic_conduit_low_stability_tmp
						set_country_flag = ag_alpha_psionic_conduit_low_stability_flag
					}
				}
			}
			country_event = { id = ag_alpha.120 days = 30 }
		}
		else = { remove_country_flag = ag_alpha_120_fired }
	}
}
# Psionic Conduit opening event.
fleet_event = {
	id = ag_alpha.121
	hide_window = yes
	is_triggered_only = yes
	immediate = {
		if = {
			limit = { NOT = { exists = event_target:ag_psionic_conduit_megastructure } }
			solar_system = {
				random_system_ambient_object = { limit = { is_ambient_object_type = ag_alpha_megastructure_activated_object } save_event_target_as = ag_target_ambient_object }
				spawn_megastructure = {
					type = ag_ancient_alpha_megastructure
					coords_from = event_target:ag_target_ambient_object
					owner = root.owner
					init_effect = {
						save_global_event_target_as = ag_psionic_conduit_megastructure
						set_variable = { which = ag_alpha_psionic_conduit_energy_percent value = 50.0 }
						set_variable = { which = ag_alpha_psionic_conduit_used_capacity value = 50.0 }
					}
				}
				event_target:global_event_country = { if = {
					limit = { NOT = { has_country_flag = ag_alpha_120_fired } }
					set_country_flag = ag_alpha_120_fired
					country_event = { id = ag_alpha.120 }
				} }
				event_target:ag_target_ambient_object = { destroy_ambient_object = this }
			}
			owner = { country_event = { id = ag_alpha.123 } }
		}
		else = { owner = { country_event = { id = ag_alpha.122 } } }
	}
}

# Psionic Conduit Menu.
country_event = {
	id = ag_alpha.122
	title = "ag_alpha.122.name"
	desc = "ag_alpha.122.desc"
	diplomatic = yes
	custom_gui = "ag_alpha_psionic_conduit_window"
	picture_event_data = { room = ag_alpha_psionic_conduit_window_room portrait = root.species }
	show_sound = event_mystic_reveal
	is_triggered_only = yes
	
	immediate = {
		set_country_flag = ag_alpha_psionic_conduit_menu_opened
		set_variable = { which = ag_alpha_psionic_conduit_total_capacity_var value = 100 }
		change_variable = { which = ag_alpha_psionic_conduit_total_capacity_var value = modifier:ag_alpha_psionic_conduit_capacity }
		event_target:ag_psionic_conduit_megastructure = {
			if = { limit = { NOT = { is_variable_set = ag_alpha_psionic_conduit_used_capacity } } set_variable = { which = ag_alpha_psionic_conduit_used_capacity value = 0 } }
			ag_alpha_psionic_conduit_calculate_stability = yes
			ag_alpha_psionic_conduit_refresh = yes
		}
	}
	after = { hidden_effect = {
		remove_country_flag = ag_alpha_psionic_conduit_menu_opened
		clear_variable = ag_alpha_psionic_conduit_total_capacity_var
	} }

	option = { name = "ag_alpha.122.default_option" custom_gui = "ag_alpha_psionic_conduit_common_option_dummy" default_hide_option = yes trigger = { always = yes } }
	option = {
		name = "ag_alpha.122.open"
		custom_gui = "ag_alpha_psionic_conduit_common_option"
		trigger = { hidden_trigger = { event_target:ag_psionic_conduit_megastructure = { NOT = { is_megastructure_type = ag_ancient_alpha_megastructure } } } }
		allow = { resource_stockpile_compare = { resource = energy value >= 1 mult = value:ag_enter_excited_shroud_cost } }
		hidden_effect = {
			add_resource = { energy = -1 mult = value:ag_enter_excited_shroud_cost }
			event_target:ag_psionic_conduit_megastructure = {
				solar_system = { spawn_megastructure = {
					type = ag_ancient_alpha_megastructure
					coords_from = prev
					init_effect = {
						if = { limit = { solar_system = { exists = space_owner } } set_owner = solar_system.space_owner }
						copy_flags_and_variables_from = event_target:ag_psionic_conduit_megastructure
						clear_global_event_target = ag_psionic_conduit_megastructure
						save_global_event_target_as = ag_psionic_conduit_megastructure
					}
				} }
				remove_megastructure = this
			}
		}
	}
	option = {
		name = "ag_alpha.122.close"
		custom_gui = "ag_alpha_psionic_conduit_common_option"
		trigger = { hidden_trigger = { event_target:ag_psionic_conduit_megastructure = { is_megastructure_type = ag_ancient_alpha_megastructure } } }
		allow = { resource_stockpile_compare = { resource = energy value >= 1 mult = value:ag_enter_excited_shroud_cost } }
		hidden_effect = {
			add_resource = { energy = -1 mult = value:ag_enter_excited_shroud_cost }
			event_target:ag_psionic_conduit_megastructure = {
				solar_system = { spawn_megastructure = {
					type = ag_ancient_alpha_megastructure_closed
					coords_from = prev
					init_effect = {
						if = { limit = { solar_system = { exists = space_owner } } set_owner = solar_system.space_owner }
						copy_flags_and_variables_from = event_target:ag_psionic_conduit_megastructure
						clear_global_event_target = ag_psionic_conduit_megastructure
						save_global_event_target_as = ag_psionic_conduit_megastructure
					}
				} }
				remove_megastructure = this
			}
		}
	}
	option = { name = "" custom_gui = "ag_alpha_psionic_conduit_stability_option" is_dialog_only = yes response_text = "ag_alpha.122.desc" custom_tooltip = "ag_alpha.122.option.tooltip"
		trigger = { hidden_trigger = { event_target:ag_psionic_conduit_megastructure = { is_megastructure_type = ag_ancient_alpha_megastructure } } }
		hidden_effect = { ag_alpha_psionic_conduit_produce_switch_alt = { ag_resource = stability } }
	}
	option = { name = "" custom_gui = "ag_alpha_psionic_conduit_energy_option" is_dialog_only = yes response_text = "ag_alpha.122.desc" custom_tooltip = "ag_alpha.122.option.tooltip"
		trigger = { hidden_trigger = { event_target:ag_psionic_conduit_megastructure = { is_megastructure_type = ag_ancient_alpha_megastructure } } }
		hidden_effect = { ag_alpha_psionic_conduit_produce_switch = { ag_resource = energy } }
	}
	option = { name = "" custom_gui = "ag_alpha_psionic_conduit_minerals_option" is_dialog_only = yes response_text = "ag_alpha.122.desc" custom_tooltip = "ag_alpha.122.option.tooltip"
		trigger = { hidden_trigger = { event_target:ag_psionic_conduit_megastructure = { is_megastructure_type = ag_ancient_alpha_megastructure } } }
		hidden_effect = { ag_alpha_psionic_conduit_produce_switch = { ag_resource = minerals } }
	}
	option = { name = "" custom_gui = "ag_alpha_psionic_conduit_food_option" is_dialog_only = yes response_text = "ag_alpha.122.desc" custom_tooltip = "ag_alpha.122.option.tooltip"
		trigger = { hidden_trigger = { event_target:ag_psionic_conduit_megastructure = { is_megastructure_type = ag_ancient_alpha_megastructure } } }
		hidden_effect = { ag_alpha_psionic_conduit_produce_switch = { ag_resource = food } }
	}
	option = { name = "" custom_gui = "ag_alpha_psionic_conduit_consumer_goods_option" is_dialog_only = yes response_text = "ag_alpha.122.desc" custom_tooltip = "ag_alpha.122.option.tooltip"
		trigger = { hidden_trigger = { event_target:ag_psionic_conduit_megastructure = { is_megastructure_type = ag_ancient_alpha_megastructure } } }
		hidden_effect = { ag_alpha_psionic_conduit_produce_switch = { ag_resource = consumer_goods } }
	}
	option = { name = "" custom_gui = "ag_alpha_psionic_conduit_alloys_option" is_dialog_only = yes response_text = "ag_alpha.122.desc" custom_tooltip = "ag_alpha.122.option.tooltip"
		trigger = { hidden_trigger = { event_target:ag_psionic_conduit_megastructure = { is_megastructure_type = ag_ancient_alpha_megastructure } } }
		hidden_effect = { ag_alpha_psionic_conduit_produce_switch = { ag_resource = alloys } }
	}
	option = { name = "" custom_gui = "ag_alpha_psionic_conduit_volatile_motes_option" is_dialog_only = yes response_text = "ag_alpha.122.desc" custom_tooltip = "ag_alpha.122.option.tooltip"
		trigger = { hidden_trigger = { event_target:ag_psionic_conduit_megastructure = { is_megastructure_type = ag_ancient_alpha_megastructure } } }
		hidden_effect = { ag_alpha_psionic_conduit_produce_switch = { ag_resource = volatile_motes } }
	}
	option = { name = "" custom_gui = "ag_alpha_psionic_conduit_exotic_gases_option" is_dialog_only = yes response_text = "ag_alpha.122.desc" custom_tooltip = "ag_alpha.122.option.tooltip"
		trigger = { hidden_trigger = { event_target:ag_psionic_conduit_megastructure = { is_megastructure_type = ag_ancient_alpha_megastructure } } }
		hidden_effect = { ag_alpha_psionic_conduit_produce_switch = { ag_resource = exotic_gases } }
	}
	option = { name = "" custom_gui = "ag_alpha_psionic_conduit_rare_crystals_option" is_dialog_only = yes response_text = "ag_alpha.122.desc" custom_tooltip = "ag_alpha.122.option.tooltip"
		trigger = { hidden_trigger = { event_target:ag_psionic_conduit_megastructure = { is_megastructure_type = ag_ancient_alpha_megastructure } } }
		hidden_effect = { ag_alpha_psionic_conduit_produce_switch = { ag_resource = rare_crystals } }
	}
	option = { name = "" custom_gui = "ag_alpha_psionic_conduit_sr_living_metal_option" is_dialog_only = yes response_text = "ag_alpha.122.desc" custom_tooltip = "ag_alpha.122.option.tooltip"
		trigger = { hidden_trigger = { event_target:ag_psionic_conduit_megastructure = { is_megastructure_type = ag_ancient_alpha_megastructure } } }
		hidden_effect = { ag_alpha_psionic_conduit_produce_switch = { ag_resource = sr_living_metal } }
	}
	option = { name = "" custom_gui = "ag_alpha_psionic_conduit_nanites_option" is_dialog_only = yes response_text = "ag_alpha.122.desc" custom_tooltip = "ag_alpha.122.option.tooltip"
		trigger = { hidden_trigger = { event_target:ag_psionic_conduit_megastructure = { is_megastructure_type = ag_ancient_alpha_megastructure } } }
		hidden_effect = { ag_alpha_psionic_conduit_produce_switch = { ag_resource = nanites } }
	}
	option = { name = "" custom_gui = "ag_alpha_psionic_conduit_sr_dark_matter_option" is_dialog_only = yes response_text = "ag_alpha.122.desc" custom_tooltip = "ag_alpha.122.option.tooltip"
		trigger = { hidden_trigger = { event_target:ag_psionic_conduit_megastructure = { is_megastructure_type = ag_ancient_alpha_megastructure } } }
		hidden_effect = { ag_alpha_psionic_conduit_produce_switch = { ag_resource = sr_dark_matter } }
	}
	option = { name = "" custom_gui = "ag_alpha_psionic_conduit_sr_zro_option" is_dialog_only = yes response_text = "ag_alpha.122.desc" custom_tooltip = "ag_alpha.122.option.tooltip"
		trigger = { hidden_trigger = { event_target:ag_psionic_conduit_megastructure = { is_megastructure_type = ag_ancient_alpha_megastructure } } }
		hidden_effect = { ag_alpha_psionic_conduit_produce_switch = { ag_resource = sr_zro } }
	}
	option = { name = "" custom_gui = "ag_alpha_psionic_conduit_minor_artifacts_option" is_dialog_only = yes response_text = "ag_alpha.122.desc" custom_tooltip = "ag_alpha.122.option.tooltip"
		trigger = { hidden_trigger = { event_target:ag_psionic_conduit_megastructure = { is_megastructure_type = ag_ancient_alpha_megastructure } } }
		hidden_effect = { ag_alpha_psionic_conduit_produce_switch = { ag_resource = minor_artifacts } }
	}
}

# First open psi conduit.
country_event = {
	id = ag_alpha.123
	title = "ag_alpha.123.name"
	desc = "ag_alpha.123.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_s_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_alpha_psionic_conduit_window_room }
	show_sound = event_psionic
	location = event_target:ag_psionic_conduit_megastructure
	is_triggered_only = yes
	option = {
		name = "ag_alpha.123.a"
		hidden_effect = { country_event = { id = ag_alpha.122 } }
	}
}

# Noti, psionic conduit unstable.
country_event = {
	id = ag_alpha.124
	title = "ag_alpha.124.name"
	desc = "ag_alpha.124.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_s_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_glitchy_matrix_room }
	show_sound = event_yellow_alert
	location = event_target:ag_psionic_conduit_megastructure
	is_triggered_only = yes
	option = {
		name = "ag_alpha.124.a"
		start_situation = { type = "ag_psionic_conduit_unstable_situation" target = event_target:ag_psionic_conduit_megastructure }
	}
}

# Noti, psionic conduit stabled.
country_event = {
	id = ag_alpha.125
	title = "ag_alpha.125.name"
	desc = "ag_alpha.125.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_s_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_alpha_psionic_conduit_room }
	show_sound = event_mystic_reveal
	location = event_target:ag_psionic_conduit_megastructure
	is_triggered_only = yes
	option = { name = "ag_alpha.125.a" destroy_situation = from }
}

# Noti, psionic conduit unstable progress completed.
country_event = {
	id = ag_alpha.126
	hide_window = yes
	is_triggered_only = yes
	immediate = {
		if = {
			limit = { ag_zeta_crisis_event_active = yes }
			event_target:global_event_country = { change_variable = { which = ag_num_psionic_portals_spawned value = 1 } }
			event_target:ag_psionic_conduit_megastructure.solar_system.star = {
				save_event_target_as = ag_zeta_crisis_extra_portal
				set_planet_flag = ag_zeta_crisis_portal_extra_planet
				remove_modifier = "ag_zeta_crisis_core_planet"
				every_moon = { limit = { exists = this } ag_remove_planet = yes }
				create_fleet = {
					name = "NAME_ag_zeta_crisis_portal_fleet"
					settings = { is_boss = yes spawn_debris = no }
					effect = {
						set_fleet_flag = ag_zeta_crisis_gate_portal
						set_fleet_flag = ag_zeta_crisis_portal_extra_fleet
						set_fleet_flag = ag_zeta_crisis_portal
						set_owner = event_target:ag_zeta_crisis_country
						create_ship = {
							name = "NAME_ag_zeta_crisis_portal_ship"
							design = "NAME_ag_zeta_crisis_portal"
							prefix = no
							effect = {
								ag_difficulty_bonus = yes
								ag_set_disable_at_health = { ag_value = 0.05 ag_disable_type = event }
							}
						}
						set_location = { target = prev distance = 0 angle = 0 }
					}
				}
				ag_spawn_zeta_crisis_guardian_fleet = yes
				ag_spawn_zeta_crisis_assault_fleet = yes
				ag_spawn_zeta_crisis_construction_ship = yes
				ag_spawn_zeta_crisis_protector_fleet = yes
				if = {
					limit = { event_target:global_event_country = { check_variable = { which = ag_scaled_difficulty value > 2 } } }
					ag_spawn_zeta_crisis_assault_fleet = yes
					random_list = { 50 = { } 50 = { ag_spawn_zeta_crisis_assault_fleet = yes } } reroll_random = yes
					random_list = { 75 = { } 25 = { ag_spawn_zeta_crisis_assault_fleet = yes } } reroll_random = yes
				}
				solar_system = {
					set_timed_star_flag = { flag = ag_zeta_crisis_gate_portal_spawned days = 60 }
					ag_create_zeta_crisis_special_ships = yes
					every_fleet_in_system = {
						limit = {
							exists = owner
							owner = { NOR = { is_country_type = ag_zeta_crisis_country is_country_type = ag_zeta_crisis_portal_holder } }
						}
						destroy_fleet = this
					}
					spawn_megastructure = {
						type = ag_psionic_portal_megastructure
						orbit_angle = 233
						orbit_distance = 0
						coords_from = event_target:ag_zeta_crisis_extra_portal
					}
					ag_create_zeta_crisis_starbase = yes
					if = {
						limit = {
							OR = { has_galactic_custodian = yes has_galactic_emperor = yes }
							any_neighbor_system = {
								exists = space_owner
								space_owner = {
									is_ai = yes
									is_galactic_community_member = yes
									is_galactic_custodian = no
									is_galactic_emperor = no
								}
							}
						}
						save_event_target_as = ag_psionic_portal_spawn_system
						random_neighbor_system = {
							limit = {
								exists = space_owner
								space_owner = {
									is_ai = yes
									is_galactic_community_member = yes
									is_galactic_custodian = no
									is_galactic_emperor = no
								}
							}
							space_owner = { save_event_target_as = ag_target_community_member }
						}
						if = {
							limit = { has_galactic_custodian = yes }
							random_playable_country = {
								limit = { is_galactic_custodian = yes }
								country_event = { id = ag_zeta_psionics.105 }
							}
						}
						else = { if = {
							limit = { has_galactic_emperor = yes }
							random_playable_country = {
								limit = { is_galactic_emperor = yes }
								country_event = { id = ag_zeta_psionics.106 }
							}
						} }
					}
				}
			}
			every_playable_country = { limit = { NOT = { is_country_type = ag_zeta_crisis_country } } country_event = { id = ag_alpha.127 } }
			event_target:ag_zeta_crisis_country = { change_variable = { which = ag_zeta_crisis_total_psionic_portals_spawned value = 1 } }
		}
		else = {
			event_target:ag_psionic_conduit_megastructure.solar_system = {
				star = { create_ambient_object = {
					type = ag_zeta_crisis_psionic_storm_small_object
					location = this
					duration = -1
					use_3d_location = yes
					entity_offset = { min = 0 max = 0 }
					entity_offset_angle = { min = 0 max = 0 }
					entity_offset_height = { min = 0 max = 0 }
					entity_scale_to_size = no
					scale = 1.0
				} }
				add_modifier = { modifier = "ag_zeta_crisis_psionic_storm_final_effect" days = -1 }
			}
			every_playable_country = { country_event = { id = ag_alpha.128 } }
		}
		event_target:ag_psionic_conduit_megastructure = {
			solar_system = {
				ag_spawn_explosion_effect = { ag_scale = xl ag_color = violet }
				spawn_megastructure = {
					type = ag_ancient_alpha_megastructure_damaged
					coords_from = event_target:ag_psionic_conduit_megastructure
					owner = event_target:ag_zeta_crisis_country
				}
			}
			remove_megastructure = this
		}
	}
	after = { destroy_situation = from }
}
country_event = {
	id = ag_alpha.127
	title = "ag_alpha.127.name"
	desc = "ag_alpha.127.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_s_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_ag_zeta_crisis_psionic_portal_room }
	show_sound = event_red_alert
	is_triggered_only = yes
	option = { name = "ag_alpha.127.a" }
}
country_event = {
	id = ag_alpha.128
	title = "ag_alpha.128.name"
	desc = "ag_alpha.128.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_s_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_supernova_room }
	show_sound = event_super_explosion
	is_triggered_only = yes
	option = { name = "ag_alpha.128.a" }
}

# Situation events.
country_event = {
	id = ag_alpha.130
	title = "ag_alpha.130.name"
	desc = "ag_alpha.130.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_m_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_throne_room }
	show_sound = event_mystic_reveal
	location = root
	is_triggered_only = yes
	trigger = {
		NOT = { has_country_flag = ag_alpha_situation_started }
		has_global_flag = ag_ancient_alpha_guardian_destroyed
		exists = event_target:ag_ancient_alpha_shielded_world
		exists = event_target:ag_ancient_alpha_shielded_world_2
		OR = {
			event_target:ag_ancient_alpha_shielded_world = {
				exists = owner
				owner = { is_same_value = root }
				has_building = ag_ancient_alpha_archive
				has_ground_combat = no
				ag_has_researcher = yes
			}
			event_target:ag_ancient_alpha_shielded_world_2 = {
				exists = owner
				owner = { is_same_value = root }
				has_building = ag_ancient_alpha_archive
				has_ground_combat = no
				ag_has_researcher = yes
			}
		}
	}
	immediate = { set_country_flag = ag_alpha_situation_started }
	option = {
		name = "ag_alpha.130.a"
		if = {
			limit = {
				exists = event_target:ag_ancient_alpha_shielded_world
				event_target:ag_ancient_alpha_shielded_world = {
					exists = owner
					owner = { is_same_value = root }
					has_building = ag_ancient_alpha_archive
					has_ground_combat = no
					ag_has_researcher = yes
				}
			}
			start_situation = { type = "ag_alpha_situation" target = event_target:ag_ancient_alpha_shielded_world }
		}
		else = { start_situation = { type = "ag_alpha_situation" target = event_target:ag_ancient_alpha_shielded_world_2 } }
	}
}

# Reward events.
country_event = {
	id = ag_alpha.131
	title = "ag_alpha.131.name"
	desc = "ag_alpha.131.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_city_ruins_room }
	show_sound = event_mystic_reveal
	location = event_target:ag_ancient_alpha_star
	is_triggered_only = yes
	immediate = {
		reroll_random = yes
		random_list = {
			10 = { set_variable = { which = ag_ancient_knowledge_common_var value = 1 } }
			10 = { set_variable = { which = ag_ancient_knowledge_common_var value = 1.5 } }
			10 = { set_variable = { which = ag_ancient_knowledge_common_var value = 2 } }
			10 = { set_variable = { which = ag_ancient_knowledge_common_var value = 2.5 } }
			10 = { set_variable = { which = ag_ancient_knowledge_common_var value = 3 } }
		}
		reroll_random = yes
		random_list = {
			10 = { change_variable = { which = ag_ancient_knowledge_common_var value = 0.25 } }
			10 = { change_variable = { which = ag_ancient_knowledge_common_var value = 0.125 } }
			10 = { subtract_variable = { which = ag_ancient_knowledge_common_var value = 0.25 } }
			10 = { subtract_variable = { which = ag_ancient_knowledge_common_var value = 0.125 } }
			10 = { }
		}
		reroll_random = yes
	}
	# after = { hidden_effect = { clear_variable = ag_ancient_knowledge_common_var } }
	option = { name = "ag_alpha.131.a" ag_add_ancient_knowledge = { ag_value = ag_ancient_knowledge_common_var ag_notification_desc = "" } }
}
country_event = {
	id = ag_alpha.132
	title = "ag_alpha.132.name"
	desc = "ag_alpha.132.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_archaeological_dig_room }
	show_sound = event_finding_loot
	location = event_target:ag_ancient_alpha_star
	is_triggered_only = yes
	option = {
		name = "ag_alpha.132.a"
		hidden_effect = { country_event = { id = ag_alpha.133 days = 15 random = 15 } }
	}
}
country_event = {
	id = ag_alpha.133
	title = "ag_alpha.133.name"
	desc = "ag_alpha.133.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_burning_settlement_room }
	show_sound = event_finding_loot
	location = event_target:ag_ancient_alpha_star
	is_triggered_only = yes
	option = {
		name = "ag_alpha.133.a"
		hidden_effect = { country_event = { id = ag_alpha.134 days = 15 random = 15 } }
	}
}
country_event = {
	id = ag_alpha.134
	title = "ag_alpha.134.name"
	desc = "ag_alpha.134.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_ancient_AI_room }
	show_sound = event_mystic_reveal
	location = event_target:ag_ancient_alpha_star
	is_triggered_only = yes
	option = {
		name = "ag_alpha.134.a"
		ag_add_research_option = { ag_tech = tech_ag_alpha_titan }
	}
}
country_event = {
	id = ag_alpha.135
	title = "ag_alpha.135.name"
	desc = "ag_alpha.135.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_archaeological_dig_room }
	show_sound = event_finding_loot
	location = event_target:ag_ancient_alpha_star
	is_triggered_only = yes
	option = {
		name = "ag_alpha.135.a"
		hidden_effect = { country_event = { id = ag_alpha.136 days = 15 random = 15 } }
	}
}
country_event = {
	id = ag_alpha.136
	title = "ag_alpha.136.name"
	desc = "ag_alpha.136.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_sabotaged_ship_room }
	show_sound = event_finding_loot
	location = event_target:ag_ancient_alpha_star
	is_triggered_only = yes
	option = {
		name = "ag_alpha.136.a"
		hidden_effect = { country_event = { id = ag_alpha.137 days = 15 random = 15 } }
	}
}
country_event = {
	id = ag_alpha.137
	title = "ag_alpha.137.name"
	desc = "ag_alpha.137.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_arguing_senate_room }
	show_sound = event_mystic_reveal
	location = event_target:ag_ancient_alpha_star
	is_triggered_only = yes
	immediate = { set_country_flag = ag_alpha_player_psionic_conduit_available }
	option = { name = "ag_alpha.137.a" custom_tooltip = "ag_alpha.137.a.tooltip" }
}
country_event = {
	id = ag_alpha.138
	title = "ag_alpha.138.name"
	desc = "ag_alpha.138.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_archaeological_dig_room }
	show_sound = event_finding_loot
	location = event_target:ag_ancient_alpha_star
	is_triggered_only = yes
	option = {
		name = "ag_alpha.138.a"
		hidden_effect = { country_event = { id = ag_alpha.139 days = 15 random = 15 } }
	}
}
country_event = {
	id = ag_alpha.139
	title = "ag_alpha.139.name"
	desc = "ag_alpha.139.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_archaeological_dig_room }
	show_sound = event_mystic_reveal
	location = event_target:ag_ancient_alpha_star
	is_triggered_only = yes
	immediate = {
		reroll_random = yes
		random_list = {
			10 = { set_variable = { which = ag_ancient_knowledge_common_var value = 1 } }
			10 = { set_variable = { which = ag_ancient_knowledge_common_var value = 1.5 } }
			10 = { set_variable = { which = ag_ancient_knowledge_common_var value = 2 } }
			10 = { set_variable = { which = ag_ancient_knowledge_common_var value = 2.5 } }
			10 = { set_variable = { which = ag_ancient_knowledge_common_var value = 3 } }
		}
		reroll_random = yes
		random_list = {
			10 = { change_variable = { which = ag_ancient_knowledge_common_var value = 0.25 } }
			10 = { change_variable = { which = ag_ancient_knowledge_common_var value = 0.125 } }
			10 = { subtract_variable = { which = ag_ancient_knowledge_common_var value = 0.25 } }
			10 = { subtract_variable = { which = ag_ancient_knowledge_common_var value = 0.125 } }
			10 = { }
		}
		reroll_random = yes
	}
	# after = { hidden_effect = { clear_variable = ag_ancient_knowledge_common_var } }
	option = { name = "ag_alpha.131.a" ag_add_ancient_knowledge = { ag_value = ag_ancient_knowledge_common_var ag_notification_desc = "" } }
}
country_event = {
	id = ag_alpha.140
	title = "ag_alpha.140.name"
	desc = "ag_alpha.140.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_throne_room }
	show_sound = event_finding_loot
	location = event_target:ag_ancient_alpha_star
	is_triggered_only = yes
	immediate = {
		reroll_random = yes
		random_list = {
			10 = { set_variable = { which = ag_ancient_knowledge_common_var value = 1 } }
			10 = { set_variable = { which = ag_ancient_knowledge_common_var value = 1.5 } }
			10 = { set_variable = { which = ag_ancient_knowledge_common_var value = 2 } }
			10 = { set_variable = { which = ag_ancient_knowledge_common_var value = 2.5 } }
			10 = { set_variable = { which = ag_ancient_knowledge_common_var value = 3 } }
		}
		reroll_random = yes
		random_list = {
			10 = { change_variable = { which = ag_ancient_knowledge_common_var value = 0.25 } }
			10 = { change_variable = { which = ag_ancient_knowledge_common_var value = 0.125 } }
			10 = { subtract_variable = { which = ag_ancient_knowledge_common_var value = 0.25 } }
			10 = { subtract_variable = { which = ag_ancient_knowledge_common_var value = 0.125 } }
			10 = { }
		}
		reroll_random = yes
	}
	after = { hidden_effect = {
		# clear_variable = ag_ancient_knowledge_common_var
		destroy_situation = from
	} }
	option = { name = "ag_alpha.140.a" ag_add_ancient_knowledge = { ag_value = ag_ancient_knowledge_common_var ag_notification_desc = "" } }
	option = {
		name = "ag_alpha.140.b"
		trigger = { OR = {
			has_ethic = ethic_fanatic_pacifist
			has_ethic = ethic_pacifist
		} }
		ag_add_ancient_knowledge = { ag_value = ag_ancient_knowledge_common_var ag_notification_desc = "" }
	}
	option = {
		name = "ag_alpha.140.c"
		trigger = { OR = {
			has_ethic = ethic_fanatic_authoritarian
			has_ethic = ethic_authoritarian
		} }
		ag_add_ancient_knowledge = { ag_value = ag_ancient_knowledge_common_var ag_notification_desc = "" }
	}
	option = {
		name = "ag_alpha.140.d"
		trigger = { OR = {
			has_ethic = ethic_fanatic_xenophobe
			has_ethic = ethic_xenophobe
			has_valid_civic = civic_fanatic_purifiers
			has_valid_civic = civic_hive_devouring_swarm
			has_valid_civic = civic_machine_terminator
		} }
		ag_add_ancient_knowledge = { ag_value = ag_ancient_knowledge_common_var ag_notification_desc = "" }
	}
	option = {
		name = "ag_alpha.140.e"
		trigger = { OR = {
			has_ethic = ethic_fanatic_xenophile
			has_ethic = ethic_xenophile
		} }
		ag_add_ancient_knowledge = { ag_value = ag_ancient_knowledge_common_var ag_notification_desc = "" }
	}
}

# Unlock ancient ship.
country_event = {
	id = ag_alpha.141
	title = "ag_alpha.141.name"
	desc = "ag_alpha.141.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_s_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_ancient_AI_room }
	show_sound = event_mystic_reveal
	is_triggered_only = yes
	immediate = {
		set_country_flag = ag_has_ancient_code
		country_event = { id = ag_alpha.142 days = 5 random = 55 }
	}
	option = { name = "ag_alpha.141.a" }
}

# Upgrade ships(Hidden)
country_event = {
    id = ag_alpha.142
    hide_window = yes
	is_triggered_only = yes
	trigger = { has_country_flag = ag_alpha_ships_unlocked }
	immediate = {
		set_country_flag = ag_alpha_142_fired
		if = {
			limit = { any_controlled_ship = { is_ship_size = ag_alpha_titan_0 } }
			while = {
				limit = { any_controlled_ship = { is_ship_size = ag_alpha_titan_0 } }
				random_controlled_ship = {
					limit = { is_ship_size = ag_alpha_titan_0 }
					ag_spawn_explosion_effect = { ag_scale = xl ag_color = red }
					fleet = {
						if = {
							limit = { exists = leader }
							leader = {
								save_global_event_target_as = ag_target_leader_on_fleet
								prev = { save_global_event_target_as = ag_target_fleet_swap }
								unassign_leader = this
							}
						}
						ag_create_alpha_titan_player = { ag_unlock_ship = yes ag_owner = root ag_clone_disable_info = yes }
					}
					delete_ship = this
					if = {
						limit = { exists = event_target:ag_target_fleet_swap }
						event_target:ag_target_fleet_swap = { assign_leader = event_target:ag_target_leader_on_fleet }
						clear_global_event_target = ag_target_fleet_swap
						clear_global_event_target = ag_target_leader_on_fleet
					}
				}
			}
		}
	}
}

# Construction sections.
country_event = {
	id = ag_alpha.151
	title = "ag_alpha.151.name"
	desc = {
		trigger = { NOT = { has_country_flag = ag_known_construction_section } }
		text = "ag_alpha.151.a.desc"
	}
	desc = {
		trigger = { has_country_flag = ag_known_construction_section }
		text = "ag_alpha.151.b.desc"
	}
	diplomatic = yes
	custom_gui = "ag_ancient_event_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_ringworld_room }
	show_sound = event_finding_loot
	location = event_target:ag_ancient_alpha_star
	is_triggered_only = yes
	
	immediate = {
		event_target:ag_ancient_alpha_star = { solar_system = { random_system_planet = {
			limit = { has_planet_flag = ag_ancient_construction_section_0 }
			save_event_target_as = ag_ancient_construction_section_loc
		} } }
	}
	
	option = {
		name = "ag_alpha.151.a"
		enable_special_project = {
			name = "ag_alpha_construction_section"
			location = event_target:ag_ancient_construction_section_loc
			owner = root
		}
		ai_chance = { factor = 1000 }
	}
	option = {
		name = "ag_alpha.151.b"
		add_resource = { influence = @ag_end_event_influence_medium }
		ai_chance = { factor = 0 }
	}
}

# Successfully unlocked Construction Sections
country_event = {
	id = ag_alpha.152
	title = "ag_alpha.152.name"
	desc = "ag_alpha.152.desc"
	diplomatic = yes
	custom_gui = "ag_ancient_event_s_window"
	custom_gui_option = "ag_ancient_event_option"
	picture_event_data = { room = ag_event_ringworld_room }
	show_sound = event_think_tank_build_complete
	location = from
	is_triggered_only = yes
	immediate = {
		set_global_flag = ag_alpha_construction_section_unlocked
		set_country_flag = ag_known_construction_section
		event_target:ag_ancient_alpha_star = { solar_system = { ag_spawn_ancient_construction_section = yes } }
	}
	
	option = { name = "ag_alpha.152.a" }
}
