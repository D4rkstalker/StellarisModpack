namespace = ehof_resources

################## Quasi-Negative Mass discovered on_survey
ship_event = {
	id = ehof_resources.001
	title = "ehof_resource_discovered"
	diplomatic = yes
	custom_gui = "ehof_eventui_window"
	picture_event_data = { room = "surreal_visions_room" }
	show_sound = event_default
	location = from
	is_triggered_only = yes
	desc = {
		trigger = {
			success_text = {
				text = "ehof_sr_negative_mass_discovery"
				hidden:from = { has_resource = { type = ehof_sr_negative_mass amount > 0 } }
			}
			success_text = {
				text = "action.92.has_tech"
				hidden:from = { has_resource = { type = ehof_sr_negative_mass amount > 0 } }
				hidden:owner = { has_technology = tech_negative_pressure }
			}
			success_text = {
				text = "action.92.no_tech"
				NAND = {
					hidden:from = { has_resource = { type = ehof_sr_negative_mass amount > 0 } }
					hidden:owner = { has_technology = tech_negative_pressure }
				}
			}
		}
	}

	trigger = {
		from = {
			has_strategic_resource = yes
			has_anomaly = no
		}
		owner = {
			root.from = { has_resource = { type = ehof_sr_negative_mass amount > 0 } }
			NOT = { has_country_flag = ehof_sr_negative_mass_found }
		}
	}

	immediate = { owner = { set_country_flag = ehof_sr_negative_mass_found } }
	option = { custom_gui = "ehof_eventui_option" name = OK custom_tooltip = "ehof_sr_negative_mass.tooltip" }
}

################## Sentient Metal discovered on_survey
ship_event = {
	id = ehof_resources.002
	title = "ehof_resource_discovered"
	diplomatic = yes
	custom_gui = "ehof_eventui_window"
	picture_event_data = { room = "surreal_visions_room" }
	show_sound = event_default
	location = from
	is_triggered_only = yes
	desc = {
		trigger = {
			success_text = {
				text = "ehof_sr_sentient_metal_discovery"
				hidden:from = { has_resource = { type = ehof_sr_sentient_metal amount > 0 } }
			}
			success_text = {
				text = "action.92.has_tech"
				hidden:from = { has_resource = { type = ehof_sr_sentient_metal amount > 0 } }
				hidden:owner = { has_technology = tech_negative_pressure }
			}
			success_text = {
				text = "action.92.no_tech"
				NAND = {
					hidden:from = { has_resource = { type = ehof_sr_sentient_metal amount > 0 } }
					hidden:owner = { has_technology = tech_negative_pressure }
				}
			}
		}
	}

	trigger = {
		from = {
			has_strategic_resource = yes
			has_anomaly = no
		}
		owner = {
			root.from = { has_resource = { type = ehof_sr_sentient_metal amount > 0 } }
			NOT = { has_country_flag = ehof_sr_sentient_metal_found }
		}
	}

	immediate = { owner = { set_country_flag = ehof_sr_sentient_metal_found } }
	option = { custom_gui = "ehof_eventui_option" name = OK custom_tooltip = "ehof_sr_sentient_metal.tooltip" }
}

################## QNM Modifier application
event = {
	id = ehof_resources.101
	hide_window = yes
	is_triggered_only = yes
	
	trigger = {
		any_country = {
			has_resource = { type = ehof_sr_negative_mass amount > 1000 }
			is_country_type = default
		}
	}

	immediate = {
		every_country = {
			limit = {
				OR = {
					is_country_type = default
					is_country_type = fallen_empire
					is_country_type = awakened_fallen_empire
				}
			}
			country_event = { id = ehof_mega_trader.102 days = 2 }
			if = {
				limit = { has_resource = { type = ehof_sr_negative_mass amount > 20000 } is_country_type = default }
				if = { limit = { has_modifier = negative_mass_buffs_1 } remove_modifier = negative_mass_buffs_1 }
				if = { limit = { has_modifier = negative_mass_buffs_2 } remove_modifier = negative_mass_buffs_2 }
				add_modifier = { modifier = negative_mass_buffs_3 days = -1 }
			}
			else_if = {
				limit = { has_resource = { type = ehof_sr_negative_mass amount > 2000 } has_resource = { type = ehof_sr_negative_mass amount <= 20000 } is_country_type = default }
				if = { limit = { has_modifier = negative_mass_buffs_1 } remove_modifier = negative_mass_buffs_1 }
				if = { limit = { has_modifier = negative_mass_buffs_3 } remove_modifier = negative_mass_buffs_3 }
				add_modifier = { modifier = negative_mass_buffs_2 days = -1 }
			}
			else_if = {
				limit = { has_resource = { type = ehof_sr_negative_mass amount > 1000 } has_resource = { type = ehof_sr_negative_mass amount <= 2000 } is_country_type = default }
				if = { limit = { has_modifier = negative_mass_buffs_2 } remove_modifier = negative_mass_buffs_2 }
				if = { limit = { has_modifier = negative_mass_buffs_3 } remove_modifier = negative_mass_buffs_3 }
				add_modifier = { modifier = negative_mass_buffs_1 days = -1 }
			}
		}
	}
}