namespace = giga_alderson

country_event = {
	id = giga_alderson.001
	hide_window = yes
	is_triggered_only = yes
	trigger = { has_origin = origin_alderson }

	immediate = {
		# Give key techs to make districts not dissappear
		give_technology = { tech = giga_tech_alderson_disk	message = no }

		capital_scope = {
			trigger_megastructure_icon = yes
			clear_planet_modifiers = yes
			clear_deposits = yes
			clear_blockers = yes
			remove_all_districts = yes
			remove_all_buildings = yes
			add_deposit = d_alderson_generator
			add_deposit = d_alderson_ruined_housing
			add_deposit = d_alderson_ruined_district
			add_deposit = d_alderson_lost01

			if = {
				limit = { root = { any_owned_pop = { is_gestalt = no is_robot_pop = no } } }
				root = {
					random_owned_pop = {
						limit = { is_gestalt = no is_robot_pop = no }
						prevprev = { while = { count = 5 create_pop = { species = prev } } }
					}
				}
			}
			else = { root = { random_owned_pop = { prevprev = { while = { count = 5 create_pop = { species = prev } } } } } }

			if = {
				limit = { root = { is_regular_empire = yes } }
				add_district = district_giga_alderson_city
				add_district = district_giga_alderson_mining
				add_district = district_giga_alderson_farming
				if = {
					limit = { root = { is_fallen_empire = yes } }
					add_district = district_giga_alderson_generator
					add_deposit = d_alderson_ruined_technician
				}
				else = {
					add_district = district_giga_alderson_commercial
					add_deposit = d_alderson_ruined_miner
					add_deposit = d_alderson_ruined_farmer
					add_deposit = d_alderson_ruined_merchant
					add_deposit = d_alderson_ruined_artisan
					add_deposit = d_alderson_ruined_clerk
				}

				add_building = building_capital
				add_building = building_bureaucratic_1
				add_building = building_research_lab_1
				add_building = building_foundry_1
				add_building = building_factory_1
			}
			else_if = {
				limit = { root = { is_machine_empire = yes } }
				add_district = district_giga_alderson_nexus
				add_district = district_giga_alderson_mining
				add_district = district_giga_alderson_farming
				add_district = district_giga_alderson_generator

				add_building = building_machine_capital
				add_building = building_machine_assembly_plant
				add_building = building_uplink_node
				add_building = building_research_lab_1
				add_building = building_foundry_1

				add_deposit = d_alderson_ruined_mining_drone
				add_deposit = d_alderson_ruined_agri_drone
				add_deposit = d_alderson_ruined_technician_drone
				add_deposit = d_alderson_ruined_maintenance_drone

				# Servitors
				if = {
					limit = { owner = { has_civic = civic_machine_servitor } }
					add_building = building_organic_sanctuary
				}
			}
			else_if = {
				limit = { root = { is_hive_empire = yes } }
				add_district = district_giga_alderson_hive
				add_district = district_giga_alderson_mining
				add_district = district_giga_alderson_farming
				add_district = district_giga_alderson_generator

				add_building = building_hive_capital
				add_building = building_hive_node
				add_building = building_research_lab_1
				add_building = building_foundry_1
				add_building = building_spawning_pool
				add_building = building_hive_warren

				add_deposit = d_alderson_ruined_mining_drone_hive
				add_deposit = d_alderson_ruined_agri_drone_hive
				add_deposit = d_alderson_ruined_technician_drone
				add_deposit = d_alderson_ruined_maintenance_drone_hive
			}

			every_owned_pop = {
				unemploy_pop = yes
				clear_pop_category = yes
			}
			check_planet_employment = yes
		}
	}
}