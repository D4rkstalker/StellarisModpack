namespace = legw_script

#Started from on_actions by terraform complete
planet_event = {
	id = legw_script.1
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		this = {
			# Remove legendary stuff
			if = {
				limit = {
					has_legw_modifier = yes
				}
				remove_legw_modifiers = yes
				remove_legw_deposits = yes
			}
			
			legw_add_terraform = yes # Chance to get legendary terraform (even on colonies)
			
			if = {
				limit = {
					NOR = {
						is_colony = yes
						has_legw_modifier = yes
					}
				}
				random_list = { #chances in % to get a legendary by terraforming a uncolonized world
					5 = {
						legw_add_modifier_ingame = yes # Chance to get any legendary
					}
					95 = {
					}
				
				}
			}
			planet_event = { id = legw_color.2 days = 1 }	# color planet, if legendary
			
		}
	}
}

#Started from on_actions by megastructure built/upgraded
country_event = {
	id = legw_script.2
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		fromfrom = { #this system
			every_system_planet = {
				if = {
					limit = { 
						legw_megaplanet = yes
						NOT = { has_planet_flag = "legw_no_megabuff" }
					}
					legw_add_mega_all = yes # Chance to get legendary megastructure
				}
				planet_event = { id = legw_color.2 days = 1 }	# color planet, if legendary
			}
		}
	}
}
country_event = {
	id = legw_script.3
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		fromfrom = { #this system
			every_system_planet = {
				if = {
					limit = { 
						legw_megaplanet = yes
						NOT = { has_planet_flag = "legw_no_megabuff" }
					}
					legw_add_mega_all = yes # Chance to get legendary megastructure
				}
				planet_event = { id = legw_color.2 days = 10 }	# color planet, if legendary
			}
		}
	}
}
#called yearly for another chance of megastructure getting leg_mega modifier
event = {
	id = legw_script.4
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		every_galaxy_planet = {
			if = {
				limit = {
					legw_megaplanet = yes
					NOT = { has_planet_flag = "legw_no_megabuff" }
				}
				planet_event = { id = legw_spawn_event.44 }		# Call for Modifier Event
				planet_event = { id = legw_color.2 days = 10 }	# color planet, if legendary
			}	
				
		} #everyplanetend
	} #immediateend
}

#Switch event for timeshifted planets
event = {
	id = legw_script.5
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		every_galaxy_planet = {
			if = {
				limit = {
					OR = {
						has_modifier = "timeshift_slow"
					}
				}
			
				planet_event = { id = legw_script.6 days = 1 }
			} #ifend
				
				
		} #everyplanetend
	} #immediateend
}
event = {
	id = legw_script.55
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		every_galaxy_planet = {
			if = {
				limit = {
					OR = {
						has_modifier = "timeshift_fast"
					}
				}
			
				planet_event = { id = legw_script.66 days = 1 }
			} #ifend
				
		} #everyplanetend
	} #immediateend
}

#swap the timeshift modifier
planet_event = {
	id = legw_script.6
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		this = {
			remove_modifier = "timeshift_slow"
			remove_modifier = "timeshift_fast"

			random_list = {
				70 = {
					#remove_modifier = "timeshift_slow"
					add_modifier = { days = 365 modifier = "timeshift_fast" }
				}
				30 = {
					#remove_modifier = "timeshift_slow"
					add_modifier = { days = 365 modifier = "timeshift_slow" }
				}
			}
		}
			
	}
}
planet_event = {
	id = legw_script.66
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		this = {
			remove_modifier = "timeshift_slow"
			remove_modifier = "timeshift_fast"

			random_list = {
				70 = {
					#remove_modifier = "timeshift_slow"
					add_modifier = { days = 365 modifier = "timeshift_slow" }
				}
				30 = {
					#remove_modifier = "timeshift_slow"
					add_modifier = { days = 365 modifier = "timeshift_fast" }
				}
			}
		}
			
	}
}

# Ursa Event Series
# Ursa gets killed
planet_event = {
	id = legw_script.7
	title = legw_script.7.name
	desc = legw_script.7.desc
	hide_window = yes
	
	#is_advisor_event = yes #creates event on a side panel to the right side
	is_triggered_only = yes

	trigger = {
		this = {
			has_modifier = "missing_ursa"
		}
	}
	
	immediate = {
		planet_event = { id = legw_script.8 days = 1 }	# Call for Modifier Event
		this = {
			every_deposit = {
				limit = {
					is_deposit_type = legw_d_ursaterr
				}
				remove_deposit = yes
			}
			if = {
				limit = { has_modifier = angry_ursa2 }
				remove_modifier = angry_ursa2
			}
		}
	}
}
# Ursa is not missing and starts rampaging
planet_event = {
	id = legw_script.8
	title = legw_script.8.name
	desc = legw_script.8.desc
	show_sound = event_ship_bridge
	picture = GFX_evt_animal_wildlife
	
	#is_advisor_event = yes #creates event on a side panel to the right side
	is_triggered_only = yes
	
	#days = 18 #delay

	trigger = {
		this = {
			has_modifier = "missing_ursa"
		}
	}
	
	immediate = {
	}
	
	option = {
		name = "OK"
		hidden_effect = {
			this = { 
				add_modifier = { days = -1 modifier = "angry_ursa" }
				remove_modifier = "missing_ursa"
			} 
		}
	}
}
# Ursa gets his food and leaves (end)
planet_event = {
	id = legw_script.9
	title = legw_script.9.name
	desc = legw_script.9.desc
	show_sound = event_ship_bridge
	picture = GFX_evt_animal_wildlife
	
	is_triggered_only = yes
	

	trigger = {
		this = {
			has_modifier = "angry_ursa"
		}
	}
	
	immediate = {
	}
	
	option = {
		name = "OK"
		this = { 
			remove_modifier = "angry_ursa"
		} 
	}
}

# Ocean Treasures (3 Events)
# only one will be repeatable
planet_event = {
	id = legw_script.10
	title = legw_script.10.name
	desc = legw_script.10.desc
	show_sound = event_ship_bridge
	picture = GFX_evt_underwater_ruins
	
	is_triggered_only = yes
	fire_only_once = yes
	
	trigger = {
		this = {
			has_modifier = "ocean_treasure1"
		}
	}
	
	immediate = {
	}
	
	option = {
		name = "legw_script.10.a"

		root = {
			owner = {
				random_list = {
					20 = {
						add_monthly_resource_mult = {
							resource = food
							value = 100
							min = 400
							max = 1400
						}
					}
					40 = {
						add_monthly_resource_mult = {
							resource = minerals
							value = 100
							min = 500
							max = 1600
						}
					}
					40 = {
						add_monthly_resource_mult = {
							resource = alloys
							value = 100
							min = 100
							max = 600
						}
					}
				}
			}
		}

		hidden_effect = {
			this = { 
				remove_modifier = "ocean_treasure1"
			} 
		}
	}
	
}
planet_event = {
	id = legw_script.11
	title = legw_script.11.name
	desc = legw_script.11.desc
	show_sound = event_ship_bridge
	picture = GFX_evt_underwater_ruins
	
	is_triggered_only = yes
	fire_only_once = yes
	
	trigger = {
		this = {
			has_modifier = "ocean_treasure2"
		}
	}
	
	immediate = {
	}
	
	option = {
		name = "legw_script.10.a"

		root = {
			owner = {
				random_list = {
					15 = {
						add_monthly_resource_mult = {
							resource = food
							value = 100
							min = 2800
							max = 4800
						}
					}
					40 = {
						add_monthly_resource_mult = {
							resource = minerals
							value = 100
							min = 3500
							max = 5900
						}
					}
					45 = {
						add_monthly_resource_mult = {
							resource = alloys
							value = 100
							min = 1300
							max = 3500
						}
					}
				}
			}
		}

		hidden_effect = {
			this = { 
				remove_modifier = "ocean_treasure2"
			} 
		}
	}
	
}
planet_event = {
	id = legw_script.12
	title = legw_script.12.name
	desc = legw_script.12.desc
	show_sound = event_ship_bridge
	picture = GFX_evt_underwater_ruins
	
	is_triggered_only = yes
	fire_only_once = yes

	trigger = {
		this = {
			has_modifier = "ocean_treasure3"
		}
	}
	
	immediate = {
	}
	
	option = {
		name = "legw_script.10.a"

		root = {
			owner = {
				random_list = {
					10 = {
						add_monthly_resource_mult = {
							resource = food
							value = 100
							min = 9000
							max = 12000
						}
					}
					35 = {
						add_monthly_resource_mult = {
							resource = minerals
							value = 100
							min = 11000
							max = 18000
						}
					}
					55 = {
						add_monthly_resource_mult = {
							resource = alloys
							value = 100
							min = 7500
							max = 12000
						}
					}
				}
			}
		}

		hidden_effect = {
			this = { 
				remove_modifier = "ocean_treasure3"
			} 
		}
	}
	
}

#Started from on_actions
country_event = {
	id = legw_script.13
	hide_window = yes
	is_triggered_only = yes
	
	# set the correct planet, only the first time from primitive
	trigger = {
		AND = {
			from = { is_country_type = primitive }
			fromfrom = {
				has_modifier = "legw_prim_admins"
			}
		}
	}
	
	immediate = {
		fromfrom = {
			remove_modifier = "planet_culture_shock" # removes vanilla shock
			random_list = {
				45 = {
					add_modifier = { days = 1080 modifier = "legw_prim_shock" }
				}
				45 = {
					add_modifier = { days = 3600 modifier = "legw_prim_shock" }
				}
				10 = {
					# Adds a random legendary, removes primitive legendary
					#planet_event = { id = legw_script.131 } #run if possible -> sets flag for legw131 not to trigger
					planet_event = { id = legw_script.131 days = 1 } #delay 1 day for checking flag
					add_modifier = { days = 1080 modifier = "legw_prim_shock" }
					add_modifier = { days = 360 modifier = "legw_prim_leg_added" }
				}
			}
			
		}
	}
}
country_event = {
	id = legw_script.14
	hide_window = yes
	is_triggered_only = yes
	
	# set the correct planet, only the first time from primitive
	trigger = {
		AND = {
			from = { is_country_type = primitive }
			fromfrom = {
				has_modifier = "legw_prim_nature"
			}
		}
	}
	
	immediate = {
		fromfrom = {
			remove_modifier = "planet_culture_shock" # removes vanilla shock
			random_list = {
				40 = {
					add_modifier = { days = 720 modifier = "legw_prim_shock" }
				}
				50 = {
					add_modifier = { days = 1800 modifier = "legw_prim_shock" }
				}
				10 = {
					# Adds a random legendary, removes primitive legendary
					#planet_event = { id = legw_script.131 } #run if possible -> sets flag for legw131 not to trigger
					planet_event = { id = legw_script.131 days = 1 } #delay 1 day for checking flag
					add_modifier = { days = 1080 modifier = "legw_prim_shock" }
					add_modifier = { days = 360 modifier = "legw_prim_leg_added" }
				}
			}
			
		}
	}
}
country_event = {
	id = legw_script.15
	hide_window = yes
	is_triggered_only = yes
	
	# set the correct planet, only the first time from primitive
	trigger = {
		AND = {
			from = { is_country_type = primitive }
			fromfrom = {
				has_modifier = "legw_prim_tech"
			}
		}
	}
	
	immediate = {
		fromfrom = {
			remove_modifier = "planet_culture_shock" # removes vanilla shock
			random_list = {
				10 = {
					add_modifier = { days = 4800 modifier = "legw_prim_shock" }
				}
				35 = {
					remove_modifier = "legw_prim_tech"
					add_modifier = { days = -1 modifier = "legw_prim_leg_lost" }
					add_modifier = { days = 900 modifier = "legw_prim_shock" }
				}
				40 = {
					remove_modifier = "legw_prim_tech"
					add_modifier = { days = -1 modifier = "legw_prim_leg_lost" }
					add_modifier = { days = 1400 modifier = "legw_prim_shock" }
				}
				15 = {
					remove_modifier = "legw_prim_tech"
					add_modifier = { days = -1 modifier = "legw_prim_leg_lost" }
					add_modifier = { days = 3200 modifier = "legw_prim_shock" }
				}
			}
			
		}
	}
}
country_event = {
	id = legw_script.16
	hide_window = yes
	is_triggered_only = yes
	
	# set the correct planet, only the first time from primitive
	trigger = {
		AND = {
			from = { is_country_type = primitive }
			fromfrom = {
				has_modifier = "legw_prim_robo"
			}
		}
	}
	
	immediate = {
		fromfrom = {
			remove_modifier = "planet_culture_shock" # removes vanilla shock
			random_list = {
				25 = {
					add_modifier = { days = 4800 modifier = "legw_prim_shock" }
				}
				65 = {
					remove_modifier = "legw_prim_robo"
					add_modifier = { days = -1 modifier = "legw_prim_leg_lost" }
					add_modifier = { days = 3600 modifier = "legw_prim_shock" }
				}
				10 = {
					# Adds a random legendary, removes primitive legendary
					#planet_event = { id = legw_script.131 } #run if possible -> sets flag for legw131 not to trigger
					planet_event = { id = legw_script.131 days = 1 } #delay 1 day for checking flag
					add_modifier = { days = 2160 modifier = "legw_prim_shock" }
					add_modifier = { days = 360 modifier = "legw_prim_leg_added" }
				}
			}
			
		}
	}
}
country_event = {
	id = legw_script.17
	hide_window = yes
	is_triggered_only = yes
	
	# set the correct planet, only the first time from primitive
	trigger = {
		AND = {
			from = { is_country_type = primitive }
			fromfrom = {
				has_modifier = "legw_prim_defense"
			}
		}
	}
	
	immediate = {
		fromfrom = {
			remove_modifier = "planet_culture_shock" # removes vanilla shock
			random_list = {
				25 = {
					add_modifier = { days = 360 modifier = "legw_prim_shock" }
				}
				25 = {
					remove_modifier = "legw_prim_defense"
					add_modifier = { days = -1 modifier = "legw_prim_leg_lost" }
					add_modifier = { days = 360 modifier = "legw_prim_shock" }
				}
				50 = {
					add_modifier = { days = -1 modifier = "depot_planet" }
					set_planet_flag = legw_planet

					add_deposit = "legw_d_depotE"
					add_deposit = "legw_d_depotM" 
					add_deposit = "legw_d_depotF"
					random_list = {
						20 = {
							add_deposit = "legw_d_depotE"
							add_deposit = "legw_d_depotM" 
							add_deposit = "legw_d_depotF"
						}
						50 = {
							add_deposit = "legw_d_depotE"
							add_deposit = "legw_d_depotM" 
							add_deposit = "legw_d_depotF"
							add_deposit = "legw_d_depotE"
							add_deposit = "legw_d_depotM" 
							add_deposit = "legw_d_depotF"
						}
						30 = {
							add_deposit = "legw_d_depotE"
							add_deposit = "legw_d_depotM" 
							add_deposit = "legw_d_depotF"
							add_deposit = "legw_d_depotE"
							add_deposit = "legw_d_depotM" 
							add_deposit = "legw_d_depotF"
							add_deposit = "legw_d_depotE"
							add_deposit = "legw_d_depotM" 
							add_deposit = "legw_d_depotF"
						}
					}
					random_list = {
						20 = {
						}
						50 = {
							add_deposit = "legw_d_depotE"
						}
						30 = {
							add_deposit = "legw_d_depotE"
							add_deposit = "legw_d_depotE"
						}
					}
					random_list = {
						20 = {
						}
						50 = {
							add_deposit = "legw_d_depotM"
						}
						30 = {
							add_deposit = "legw_d_depotM"
							add_deposit = "legw_d_depotM"
						}
					}
					random_list = {
						20 = {
						}
						50 = {
							add_deposit = "legw_d_depotF"
						}
						30 = {
							add_deposit = "legw_d_depotF"
							add_deposit = "legw_d_depotF"
						}
					}
					
					planet_event = { id = legw_color.2 days = 1 }
					
					add_modifier = { days = 360 modifier = "legw_prim_shock" }
					add_modifier = { days = 360 modifier = "legw_prim_leg_added" }
				}
			}
			
		}
	}
}

country_event = {
	id = legw_script.18
	hide_window = yes
	is_triggered_only = yes
	
	# set the correct planet, only the first time from primitive
	trigger = {
		AND = {
			from = { is_country_type = primitive }
			fromfrom = {
				has_modifier = "legw_prim_ships"
			}
		}
	}
	
	immediate = {
		fromfrom = {
			remove_modifier = "planet_culture_shock" # removes vanilla shock
			random_list = {
				65 = {
					add_modifier = { days = 7200 modifier = "legw_prim_shock" }
				}
				25 = {
					add_modifier = { days = -1 modifier = "legw_prim_leg_lost" }
					add_modifier = { days = 3600 modifier = "legw_prim_shock" }
				}
				10 = {
					# Adds a random legendary, removes primitive legendary
					#planet_event = { id = legW_script.131 } #run if possible -> sets flag for legw131 not to trigger
					planet_event = { id = legw_script.131 days = 1 } #delay 1 day for checking flag
					add_modifier = { days = 3600 modifier = "legw_prim_shock" }
					add_modifier = { days = 360 modifier = "legw_prim_leg_added" }
				}
			}
			
		}
	}
}

country_event = {
	id = legw_script.19
	hide_window = yes
	is_triggered_only = yes
	
	# set the correct planet, only the first time from primitive
	trigger = {
		AND = {
			from = { is_country_type = primitive }
			fromfrom = {
				has_modifier = "legw_prim_mega"
			}
		}
	}
	
	immediate = {
		fromfrom = {
			remove_modifier = "planet_culture_shock" # removes vanilla shock
			random_list = {
				65 = {
					add_modifier = { days = 1800 modifier = "legw_prim_shock" }
				}
				35 = {
					add_modifier = { days = 3600 modifier = "legw_prim_shock" }
				}
			}
			
		}
	}
}

country_event = {
	id = legw_script.20
	hide_window = yes
	is_triggered_only = yes
	
	# set the correct planet, only the first time from primitive
	trigger = {
		AND = {
			from = { is_country_type = primitive }
			fromfrom = {
				has_modifier = "legw_prim_vip"
			}
		}
	}
	
	immediate = {
		fromfrom = {
			remove_modifier = "planet_culture_shock" # removes vanilla shock
			random_list = {
				45 = {
					add_modifier = { days = 1800 modifier = "legw_prim_shock" }
				}
				15 = {
					add_modifier = { days = 4600 modifier = "legw_prim_leg_lost" }
					add_modifier = { days = 1000 modifier = "legw_prim_shock" }
				}
				40 = {
					# Adds a random legendary, removes primitive legendary
					#planet_event = { id = legw_script.131 } #run if possible -> sets flag for legw131 not to trigger
					planet_event = { id = legw_script.131 days = 1 } #delay 1 day for checking flag
					add_modifier = { days = 1800 modifier = "legw_prim_shock" }
					add_modifier = { days = 360 modifier = "legw_prim_leg_added" }
				}
			}
			
		}
	}
}

# Started from primitive events, when needed
planet_event = {
	id = legw_script.131
	hide_window = yes
	is_triggered_only = yes
	
	# use ADDON if available, else dont trigger
	trigger = {
		this = {
			NOT = { has_planet_flag = "lege_mods_added" }
		}
	}
	
	immediate = {
		this = {
			if = {
				limit = { is_artificial = yes }
				legw_add_mega_all = yes
			}
			if = {
				limit = { is_artificial = no }
				# remove any prim modifier
				remove_modifier = "legw_prim_admins"
				remove_modifier = "legw_prim_nature"
				remove_modifier = "legw_prim_tech"
				remove_modifier = "legw_prim_robo"
				remove_modifier = "legw_prim_defense"
				remove_modifier = "legw_prim_ships"
				remove_modifier = "legw_prim_mega"
				remove_modifier = "legw_prim_vip"
				
				legw_add_modifier_ingame = yes # Add a random leg
			}

			planet_event = { id = legw_color.2 days = 1 }	# color planet, if legendary		
		}
	}
	
}