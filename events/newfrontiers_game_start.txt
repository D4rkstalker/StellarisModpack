############################
#
# Colony Events
#
# Written by Annatar
#
############################

namespace = newfrontiers_colony_mod


### Long Night ###

#Darkness has come
planet_event = {
	id = newfrontiers_colony_mod.1
	title = "newfrontiers_colony_mod.1.name"
	desc = "newfrontiers_colony_mod.1.desc"
	picture = GFX_evt_eclipse
	show_sound = event_air_raid_siren
	location = ROOT
	
	trigger = {
		has_owner = yes
		original_owner = yes
		is_homeworld = no
		owner = { is_ai = no }
		has_modifier = "long_night"
		NOT = { has_modifier = "darkness_has_come" }
		has_ground_combat = no
		num_pops > 0
		is_capital = no
		NOR = {
			has_planet_flag = darkness_planet
			has_planet_flag = colony_event
		}
	}
	
	is_triggered_only = yes
	
	immediate = {
		set_planet_flag = colony_event
		owner = { set_country_flag = darkness_come_country }
	}
	
	option = {
		name = GOOD
		add_modifier = {
			modifier = "darkness_has_come"
			days = -1
		}
		hidden_effect = {
			random_list = {
				50 = { planet_event = { id = newfrontiers_colony_mod.2 days = 365 random = 180 } }
				50 = { planet_event = { id = newfrontiers_colony_mod.3 days = 365 random = 180 } }
			}
		}
	}
}

#Darkness is gone
planet_event = {
	id = newfrontiers_colony_mod.2
	title = "newfrontiers_colony_mod.2.name"
	desc = "newfrontiers_colony_mod.2.desc"
	picture = GFX_evt_colony_settlement
	show_sound = event_air_raid_siren
	location = ROOT
	
	is_triggered_only = yes
	
	immediate = {
		remove_planet_flag = colony_event
		owner = { remove_country_flag = darkness_come_country }
	}
	
	option = {
		name = EXCELLENT
		remove_modifier = "darkness_has_come"
	}
}

#The colony is lost
planet_event = {
	id = newfrontiers_colony_mod.3
	title = "newfrontiers_colony_mod.3.name"
	desc = "newfrontiers_colony_mod.3.desc"
	picture = GFX_evt_colony_settlement
	show_sound = event_air_raid_siren
	location = ROOT
	
	is_triggered_only = yes
	
	immediate = {
		set_planet_flag = darkness_planet
	}
	
	option = {
		name = WORRYING
		destroy_colony = yes
		remove_modifier = "darkness_has_come"
	}
}

#Darkness has come again
planet_event = {
	id = newfrontiers_colony_mod.4
	title = "newfrontiers_colony_mod.4.name"
	desc = "newfrontiers_colony_mod.4.desc"
	picture = GFX_evt_eclipse
	show_sound = event_air_raid_siren
	location = ROOT
	
	trigger = {
		has_planet_flag = darkness_planet
		has_modifier = "long_night"
		NOT = { has_modifier = "darkness_has_come" }
		has_ground_combat = no
		num_pops > 0
		is_capital = no
	}
	
	is_triggered_only = yes
	
	immediate = {
		set_planet_flag = darkness_planet
		set_planet_flag = colony_event
		owner = { set_country_flag = darkness_come_country }
	}
	
	option = {
		name = newfrontiers_colony_mod.4.a
		add_modifier = {
			modifier = "darkness_has_come"
			days = 600
		}
		hidden_effect = {
			planet_event = { id = newfrontiers_colony_mod.5 days = 365 random = 180 }
		}
	}
}

#Attack!
planet_event = {
	id = newfrontiers_colony_mod.5
	title = "newfrontiers_colony_mod.5.name"
	desc = "newfrontiers_colony_mod.5.desc"
	picture = GFX_evt_eclipse
	show_sound = event_air_raid_siren
	location = ROOT
	
	is_triggered_only = yes
	
	immediate = {
		remove_planet_flag = darkness_planet
		remove_planet_flag = colony_event
		owner = { remove_country_flag = darkness_come_country }
		create_army = {
			name = "NAME_Terrible_Creatures"
			owner = last_created
			type = "night_monsters"
		}
		create_army = {
			name = "NAME_Terrible_Creatures"
			owner = last_created
			type = "night_monsters"
		}
		create_army = {
			name = "NAME_Terrible_Creatures"
			owner = last_created
			type = "night_monsters"
		}
		create_army = {
			name = "NAME_Terrible_Creatures"
			owner = last_created
			type = "night_monsters"
		}
		create_army = {
			name = "NAME_Terrible_Creatures"
			owner = last_created
			type = "night_monsters"
		}
		create_army = {
			name = "NAME_Terrible_Creatures"
			owner = last_created
			type = "night_monsters"
		}
		create_army = {
			name = "NAME_Terrible_Creatures"
			owner = last_created
			type = "night_monsters"
		}
		create_army = {
			name = "NAME_Terrible_Creatures"
			owner = last_created
			type = "night_monsters"
		}
		create_army = {
			name = "NAME_Terrible_Creatures"
			owner = last_created
			type = "night_monsters"
		}
	}
	
	option = {
		name = newfrontiers_colony_mod.5.a
		custom_tooltip = newfrontiers_colony_mod.5.tooltip
	}
}

planet_event = {
	id = newfrontiers_colony_mod.6
	title = "newfrontiers_colony_mod.6.name"
	desc = "newfrontiers_colony_mod.6.desc"
	picture = GFX_evt_interior_battle
	show_sound = event_mystic_reveal
	location = ROOT
	
	is_triggered_only = yes
	
	option = {
		name = EXCELLENT
		hidden_effect = {
			owner = { set_country_flag = hardened_warriors }
			set_planet_flag = hardened_warriors_can_build
		}
		custom_tooltip = hardened_warriors_recruit_tooltip
	}

}

#Gatekeeper - Colony Events
planet_event = {
	id = newfrontiers_colony_mod.100
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		OR = {
			has_modifier = long_night
			has_modifier = death_world
		}
	}

	immediate = {	
		if = {
			limit = { 
				has_modifier = long_night
				NOT = { has_modifier = darkness_has_come }
			}
			planet_event = { id = newfrontiers_colony_mod.1 days = 30 random = 90 }
			break = yes
		}
		if = {
			limit = { 
				has_modifier = death_world
				NOT = { has_planet_flag = hardened_warriors_can_build }
			}
			planet_event = { id = newfrontiers_colony_mod.6 days = 30 random = 90 }
			break = yes
		}
	}
}