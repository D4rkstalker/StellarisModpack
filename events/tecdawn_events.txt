# -----------------------------------------------------------
# "A Second dawn" events
# Written by Rodahtnov - Stellaris Modding jam
# Collaborators: OldEnt
# -----------------------------------------------------------

namespace = tecdawn


# -----------------------------  SETUP  -----------------------------
#Launches the origin
event = {
	id = tecdawn.1
	hide_window = yes
	is_triggered_only = yes

	immediate = {
	#	change_variable = {					# moved to the initiator
	#		which = tecdawn_countries
	#		value = 1
	#	}
		every_playable_country = {
			limit = { 
				has_origin = origin_tecdawn 
			}
			country_event = { 
				id = tecdawn.2
			}
		}
	}
}

# Alters the setup
country_event = {
	id = tecdawn.2
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		NOT = {
			has_country_flag = tecdawn_origin_setup
		}
	}

	immediate = {
		# This is for recognising the number of empires with the origin, will write about it more later
		random_country = {
			limit = {
				is_country_type = global_event
			}
			change_variable = {
				which = tecdawn_countries
				value = 1
			}
		}
		set_country_flag = tecdawn_origin_setup
		# Promised land
		country_event = {
			id = tecdawn.20
			days = 3
		}
		# System cleanup
	#	country_event = {
	#		id = tecdawn.10
	#		days = 360
	#	}
		#	Removes story thing
	#	set_country_flag = Story4						# discovered presapients
		set_country_flag = Story5						# Discovered remnants


		# UNE-COM interaction
		if = {
			limit = { 
				has_country_flag = human_2 # DENEB
			}
			random_country = {
				limit = {
					is_country_type = default
					has_country_flag = human_1 # UNE
					is_ai = yes
				}
				set_origin = origin_tecdawn
				country_event = {
					id = tecdawn.2
				}
				capital_scope = {
					remove_modifier = prosp_uni_mod
				}
			}
		}
		# Doesnt matter if UNE spawns as COM is lost colony, so it has kinda sense lore-rpwise

		capital_scope = {
			# Having to remove all districts all buildings so empires start accordingly
			remove_all_buildings = yes
			remove_all_districts = yes
			# Alters the capital
			change_pc = pc_tecdawn
			set_planet_flag = tecdawn_planet@root
			set_planet_flag = tecdawn_first_world
			# Clean the world, add the deposits
			tecdawn_generate_synth_deposits_and_blockers = yes
			generate_start_buildings_and_districts = yes
			add_deposit = d_tecdawn_locked_vault_2
			# Tweaks the system
			if = {
				limit = { 
					has_planet_flag = planet_earth
				}
				set_planet_entity = {
					entity = "tecdawn_planet_earth_entity"
				}
				owner = {
					set_country_flag = tecdawn_sol_start
				}
			}
			root = {				# Marks the planet so no stealerino of the digsite
				set_country_flag = tecdawn_planet_@prev
			}
			solar_system = {
				set_star_flag = tecdawn_first_system
				if = {
					limit = { 
						has_star_flag = sol
					}
					random_system_planet = {
						limit = {
							planet_size = 5
							is_planet_class = pc_barren_cold
							is_moon = yes
							NOT = {
								has_planet_flag = tecdawn_first_world
							}
						}
						set_planet_size = 8
						set_planet_entity = {
							entity = pc_shattered
						}
						change_pc = pc_shattered
						set_planet_flag = tecdawn_planet@root
						# This is done to avoid the animation, anyway it will probably be spawned :(
						root = {				# Marks the planet so no stealerino of the digsite
							set_country_flag = tecdawn_planet_@prev
						}
					}
					# Prepares mars for the future of the chain
					random_system_planet = {
						limit = {
							is_planet_class = pc_barren
							has_modifier = terraforming_candidate
							NOT = {
								has_planet_flag = tecdawn_fourth_world
							}
						}
						remove_modifier = terraforming_candidate
						change_pc = pc_toxic
						set_planet_flag = tecdawn_toxic_world@root
						set_planet_flag = tecdawn_fourth_world
						set_planet_flag = tecdawn_has_observer
						create_ambient_object = {
							type = tecdawn_observer
						}
						last_created_ambient_object = {
							set_ambient_object_flag = tecdawn_ae_observer
						}
						create_ambient_object = {
							type = medium_debris_01_object
						}
						last_created_ambient_object = {
							set_ambient_object_flag = tecdawn_ae_debris
						}
						set_planet_flag = tecdawn_debris
						root = {				# Marks the planet so no stealerino of the digsite
							set_country_flag = tecdawn_planet_@prev
						}
					}

					while = {
						count = 2
						random_system_planet = {
							if = {
								limit = {
									OR = {
										is_planet_class = pc_gas_giant
										is_planet_class = pc_toxic
										is_planet_class = pc_frozen
									}
									NOT = {
										has_planet_flag = tecdawn_debris
									}
								}
								create_ambient_object = {
									type = large_debris_object
								}
								last_created_ambient_object = {
									set_ambient_object_flag = tecdawn_ae_debris
								}
								set_planet_flag = tecdawn_debris
								root = {				# Marks the planet so no stealerino of the digsite
									set_country_flag = tecdawn_planet_@prev
								}
								
							}
						}
					}
					
					while = {
						count = 2
						random_system_planet = {
							if = {
								limit = {
									OR = {
										is_planet_class = pc_gas_giant
										is_planet_class = pc_toxic
										is_planet_class = pc_frozen
									}
									NOT = {
										has_planet_flag = tecdawn_debris
									}
								}
								create_ambient_object = {
									type = medium_debris_01_object
								}
								last_created_ambient_object = {
									set_ambient_object_flag = tecdawn_ae_debris
								}
								set_planet_flag = tecdawn_debris
								root = {				# Marks the planet so no stealerino of the digsite
									set_country_flag = tecdawn_planet_@prev
								}
							}
						}
					}	
				}
				if = {
					limit = {
						NOT = {
							has_star_flag = sol	
						}
						
					}
					random_system_planet = {
						limit = {
							is_moon = yes
							OR = {
								is_planet_class = pc_barren_cold
								is_planet_class = pc_barren
								is_planet_class = pc_molten
								is_planet_class = pc_toxic
							}
							NOT = {
								has_planet_flag = tecdawn_first_world
							}
						}
						set_planet_size = 8
						set_planet_entity = {
							entity = pc_shattered
						}
						change_pc = pc_shattered
						set_planet_flag = tecdawn_shattered_world
						set_planet_flag = tecdawn_planet@root
						# This is done to avoid the animation, anyway it will probably be spawned :(
						root = {				# Marks the planet so no stealerino of the digsite
							set_country_flag = tecdawn_planet_@prev
						}
					}
					if = {			# safeguard
						limit = {
							NOT = {
								any_system_planet = {
									has_planet_flag = tecdawn_shattered_world
								}
							}
						}
						random_system_planet = {
							limit = {
								OR = {
									is_planet_class = pc_barren_cold
									is_planet_class = pc_barren
									is_planet_class = pc_molten
								}
								NOT = {
									has_planet_flag = tecdawn_first_world
								}
							}
							set_planet_size = 8
							set_planet_entity = {
								entity = pc_shattered
							}
							set_planet_flag = tecdawn_shattered_world
							change_pc = pc_shattered
							set_planet_flag = tecdawn_planet@root
							# This is done to avoid the animation, anyway it will probably be spawned :(
							root = {				# Marks the planet so no stealerino of the digsite
								set_country_flag = tecdawn_planet_@prev
							}
						}
					}
					# Prepares a random barren planet for future interactions
					random_system_planet = {
						limit = {
							OR = {
								is_planet_class = pc_barren
								is_planet_class = pc_barren_cold	
								is_planet_class = pc_toxic
								is_planet_class = pc_molten
							}
							NOT = {
								has_planet_flag = tecdawn_planet@root
							}
						}
						change_pc = pc_toxic
						set_planet_size = 15
						set_planet_flag = tecdawn_toxic_world@root
						set_planet_flag = tecdawn_fourth_world
						set_planet_flag = tecdawn_has_observer
						create_ambient_object = {
							type = tecdawn_observer
						}
						last_created_ambient_object = {
							set_ambient_object_flag = tecdawn_ae_observer
						}
						create_ambient_object = {
							type = medium_debris_01_object
						}
						last_created_ambient_object = {
							set_ambient_object_flag = tecdawn_ae_debris
						}
						set_planet_flag = tecdawn_debris
						root = {				# Marks the planet so no stealerino of the digsite
							set_country_flag = tecdawn_planet_@prev
						}
					}

					while = {
						count = 2
						random_system_planet = {
							if = {
								limit = {
									OR = {
										is_planet_class = pc_gas_giant
										is_planet_class = pc_toxic
										is_planet_class = pc_frozen
									}
									NOT = {
										has_planet_flag = tecdawn_debris
									}
								}
								create_ambient_object = {
									type = large_debris_object
								}
								last_created_ambient_object = {
									set_ambient_object_flag = tecdawn_ae_debris
								}
								set_planet_flag = tecdawn_debris
								root = {				# Marks the planet so no stealerino of the digsite
									set_country_flag = tecdawn_planet_@prev
								}
							}
						}
					}
					
					while = {
						count = 2
						random_system_planet = {
							if = {
								limit = {
									OR = {
										is_planet_class = pc_gas_giant
										is_planet_class = pc_toxic
										is_planet_class = pc_frozen
									}
									NOT = {
										has_planet_flag = tecdawn_debris
									}
								}
								create_ambient_object = {
									type = medium_debris_01_object
								}
								last_created_ambient_object = {
									set_ambient_object_flag = tecdawn_ae_debris
								}
								set_planet_flag = tecdawn_debris
								root = {				# Marks the planet so no stealerino of the digsite
									set_country_flag = tecdawn_planet_@prev
								}
							}
						}
					}	
				}
			}
			
			# Tweaks near systems
			if = {
				limit = {
					num_guaranteed_colonies >= 2 
				}
				solar_system = {
					closest_system = {
						limit = { 
							has_star_flag = neighbor_t1_first_colony 
						}
						set_star_flag = tecdawn_second_system
						random_system_planet = {
							limit = { 
								has_planet_flag = prescripted_ideal 
							}
							save_event_target_as = tecdawn_colony
							tecdawn_generate_synth_deposits_and_blockers = yes
							add_deposit = d_tecdawn_locked_vault_1
							set_planet_flag = tecdawn_planet@root
							set_planet_flag = tecdawn_second_world
							set_planet_flag = tecdawn_has_observer
							create_ambient_object = {
								type = tecdawn_observer
							}
							last_created_ambient_object = {
								set_ambient_object_flag = tecdawn_ae_observer
							}
							if = {
								limit = {
									planet_size < 18
								}
								set_planet_size = 18
							}
							change_pc = pc_tecdawn
							if = {
								limit = {
									root = {
										has_country_flag = tecdawn_sol_start
									}
								}
								set_planet_entity = {
									entity = "tecdawn_planet_earth_entity"
								}
							}
							root = {				# Marks the planet so no stealerino of the digsite
								set_country_flag = tecdawn_planet_@prev
							}
						}
					}
					closest_system = {
						limit = { 
							has_star_flag = neighbor_t2_second_colony 
						}
						set_star_flag = tecdawn_third_system
						random_system_planet = {
							limit = { 
								has_planet_flag = prescripted_ideal 
							}
							set_planet_size = 16
							set_planet_flag = tecdawn_toxic_world@root
							set_planet_flag = tecdawn_third_world
							set_planet_flag = tecdawn_has_observer
							create_ambient_object = {
								type = tecdawn_observer
							}
							last_created_ambient_object = {
								set_ambient_object_flag = tecdawn_ae_observer
							}
							save_event_target_as = tecdawn_colony_poi_2
							change_pc = pc_toxic 
							reset_planet = yes
							root = {				# Marks the planet so no stealerino of the digsite
								set_country_flag = tecdawn_planet_@prev
							}
						}
					}
				}
			}

			if = {
				limit = { 
					num_guaranteed_colonies = 1 
				}
				solar_system = {
					closest_system = {
						limit = { 
							has_star_flag = neighbor_t1_first_colony 
						}
						set_star_flag = tecdawn_second_system
						random_system_planet = {
							limit = { 
								has_planet_flag = prescripted_ideal 
							}
							save_event_target_as = tecdawn_colony
							tecdawn_generate_synth_deposits_and_blockers = yes
							add_deposit = d_tecdawn_locked_vault_1
							set_planet_flag = tecdawn_planet@root
							set_planet_flag = tecdawn_second_world
							set_planet_flag = tecdawn_has_observer
							create_ambient_object = {
								type = tecdawn_observer
							}
							last_created_ambient_object = {
								set_ambient_object_flag = tecdawn_ae_observer
							}
							if = {
								limit = {
									planet_size < 18
								}
								set_planet_size = 18
							}
							change_pc = pc_tecdawn
							if = {
								limit = { 
									root = {
										has_country_flag = tecdawn_sol_start
									}
								}
								set_planet_entity = {
									entity = "tecdawn_planet_earth_entity"
								}
							}
							save_event_target_as = tecdawn_colony_poi_1
							root = {				# Marks the planet so no stealerino of the digsite
								set_country_flag = tecdawn_planet_@prev
							}
						}
					}
					closest_system = {
						limit = {
							NOR = {
								has_star_flag = neighbor_t1_second_colony
								has_star_flag = tecdawn_first_system
								has_star_flag = tecdawn_second_system
								has_planet_class = pc_black_hole
							}
							num_planets_in_system > 5
							any_system_planet = {			# Prevent fully asteroid systems to be selectable...
								OR = {
									is_planet_class = pc_barren
									is_planet_class = pc_barren_cold
									is_planet_class = pc_molten
									is_planet_class = pc_toxic
								}
							}
						}
						set_star_flag = tecdawn_third_system
						random_system_planet = {
							limit = { 
								is_moon = no
								OR = {
									is_planet_class = pc_barren
									is_planet_class = pc_barren_cold
									is_planet_class = pc_molten
									is_planet_class = pc_toxic
								}
							}
							set_planet_size = 16
							set_planet_flag = tecdawn_toxic_world@root
							set_planet_flag = tecdawn_third_world
							set_planet_flag = tecdawn_has_observer
							create_ambient_object = {
								type = tecdawn_observer
							}
							last_created_ambient_object = {
								set_ambient_object_flag = tecdawn_ae_observer
							}
							change_pc = pc_toxic 
							reset_planet = yes
							
							root = {				# Marks the planet so no stealerino of the digsite
								set_country_flag = tecdawn_planet_@prev
							}
						}
					}
				}
			}


			if = {
				limit = { 
					num_guaranteed_colonies = 0 
				}

				solar_system = {
					closest_system = {
						limit = { 
							NOR = {
								has_star_flag = tecdawn_first_system
								has_star_flag = tecdawn_second_system
								has_star_flag = tecdawn_third_system
								has_star_flag = hostile_system
							}
							has_owner = no
							num_planets_in_system > 5
							any_system_planet = {			# Prevent fully asteroid systems to be selectable...
								OR = {
									is_planet_class = pc_barren
									is_planet_class = pc_barren_cold
									is_planet_class = pc_molten
									is_planet_class = pc_toxic
								}
							}
						}
						set_star_flag = tecdawn_second_system
						random_system_planet = {
							limit = { 
								is_moon = no
								OR = {
									is_planet_class = pc_barren
									is_planet_class = pc_barren_cold
									is_planet_class = pc_molten
									is_planet_class = pc_toxic
								}
							}
							save_event_target_as = tecdawn_colony
							tecdawn_generate_synth_deposits_and_blockers = yes
							add_deposit = d_tecdawn_locked_vault_1
							set_planet_flag = tecdawn_planet@root
							set_planet_flag = tecdawn_second_world
							set_planet_flag = tecdawn_has_observer
							create_ambient_object = {
								type = tecdawn_observer
							}
							last_created_ambient_object = {
								set_ambient_object_flag = tecdawn_ae_observer
							}
							change_pc = pc_tecdawn
							if = {
								limit = { 
									root = {
										has_country_flag = tecdawn_sol_start
									}
								}
								set_planet_entity = {
									entity = "tecdawn_planet_earth_entity"
								}
							}
							if = {
								limit = {
									planet_size < 18
								}
								set_planet_size = 18
							}
							root = {				# Marks the planet so no stealerino of the digsite
								set_country_flag = tecdawn_planet_@prev
							}
						}
					}
					closest_system = {
						limit = {
							NOR = {
								has_star_flag = tecdawn_first_system
								has_star_flag = tecdawn_second_system
								has_star_flag = tecdawn_third_system
								has_star_flag = hostile_system
							}
							has_owner = no
							num_planets_in_system > 5
							any_system_planet = {			# Prevent fully asteroid systems to be selectable...
								OR = {
									is_planet_class = pc_barren
									is_planet_class = pc_barren_cold
									is_planet_class = pc_molten
									is_planet_class = pc_toxic
								}
							}
						}
						set_star_flag = tecdawn_third_system
						random_system_planet = {
							limit = { 
								is_moon = no
								OR = {
									is_planet_class = pc_barren
									is_planet_class = pc_barren_cold
									is_planet_class = pc_molten
									is_planet_class = pc_toxic
								}
							}
							set_planet_size = 16
							set_planet_flag = tecdawn_toxic_world@root
							set_planet_flag = tecdawn_third_world
							set_planet_flag = tecdawn_has_observer
							create_ambient_object = {
								type = tecdawn_observer
							}
							last_created_ambient_object = {
								set_ambient_object_flag = tecdawn_ae_observer
							}
							change_pc = pc_toxic 
							reset_planet = yes
							
							root = {				# Marks the planet so no stealerino of the digsite
								set_country_flag = tecdawn_planet_@prev
							}
						}
					}
				}
			}
			# Spawns random shattered planets around - damn you, horizon signal
			closest_system = {
				limit = { 
					NOR = {
						has_star_flag = tecdawn_first_system
						has_star_flag = tecdawn_second_system
						has_star_flag = tecdawn_third_system
						has_star_flag = hostile_system
						has_star_flag = tecdawn_has_broken_planet_system
					}
					has_owner = no
					num_planets_in_system > 5
					any_system_planet = {			# Prevent fully asteroid systems to be selectable...
						OR = {
							is_planet_class = pc_barren
							is_planet_class = pc_barren_cold
							is_planet_class = pc_molten
							is_planet_class = pc_toxic
						}
					}
				}
				set_star_flag = tecdawn_has_broken_planet_system
				random_system_planet = {
					limit = {
						or = {
							is_planet_class = pc_barren
							is_planet_class = pc_barren_cold
						}
					}
					set_planet_entity = {
						entity = pc_shattered
					}
					change_pc = pc_shattered
					set_planet_flag = tecdawn_planet@root
					# This is done to avoid the animation, anyway it will probably be spawned :(
					root = {				# Marks the planet so no stealerino of the digsite
						set_country_flag = tecdawn_planet_@prev
					}
				}
			}
			# Spawns random shattered planets around - damn you, horizon signal
			closest_system = {
				limit = { 
					NOR = {
						has_star_flag = tecdawn_first_system
						has_star_flag = tecdawn_second_system
						has_star_flag = tecdawn_third_system
						has_star_flag = hostile_system
						has_star_flag = tecdawn_has_broken_planet_system
					}
					has_owner = no
					num_planets_in_system > 5
					any_system_planet = {			# Prevent fully asteroid systems to be selectable...
						OR = {
							is_planet_class = pc_barren
							is_planet_class = pc_barren_cold
							is_planet_class = pc_molten
							is_planet_class = pc_toxic
						}
					}
				}
				set_star_flag = tecdawn_has_broken_planet_system
				random_system_planet = {
					limit = {
						or = {
							is_planet_class = pc_barren
							is_planet_class = pc_barren_cold
						}
					}
					set_planet_entity = {
						entity = pc_shattered
					}
					change_pc = pc_shattered
					set_planet_flag = tecdawn_planet@root
					# This is done to avoid the animation, anyway it will probably be spawned :(
					root = {				# Marks the planet so no stealerino of the digsite
						set_country_flag = tecdawn_planet_@prev
					}
				}
			}
		}
	}
}


## Microchain 1, optional, for removing the rubble from the system - Ancient Rubble log - removes ancient civ discover
#country_event = {
#	id = tecdawn.10
#	hide_window = no
#	is_triggered_only = yes
#
#	trigger = {
#		has_country_flag = tecdawn_origin_setup
#	}
#
#	title = tecdawn.10.title
#	desc = tecdawn.10.desc
#
#	option = {
#		name = tecdawn.10.a
#		custom_tooltip = tecdawn.10.a.tooltip
#		hidden_effect = {
#			capital_scope = {
#				save_event_target_as = tecdawn_capital_cleanup
#			}
#			enable_special_project = {
#				location = event_target:tecdawn_capital_cleanup
#				type = TECDAWN_SYSTEM_CLEANUP
#			}
#		}
#	}
#
#	option = {
#		name = tecdawn.10.b
#		custom_tooltip = tecdawn.10.b.tooltip
#	}
#}
#
## System cleanup effect, rewards automatic exploration tech as guaranteed
#country_event = {
#	id = tecdawn.11
#	hide_window = no
#	is_triggered_only = yes
#
#	trigger = {
#		has_country_flag = tecdawn_origin_setup
#	}
#
#	title = tecdawn.11.title
#	desc = tecdawn.11.desc
#
#	option = {
#		name = EXCELLENT
#		while = {
#			count = 2
#			random_list = {
#				1 = {
#					add_monthly_resource_mult = {
#						resource = alloys
#						value = 100
#					}
#				}
#				1 = {
#					add_monthly_resource_mult = {
#						resource = minor_artifacts
#						value = 3
#					}
#				}
#				1 = {
#					add_research_option = tech_automated_exploration
#					add_tech_progress = {
#						tech = tech_automated_exploration
#						progress = 0.5
#					}
#				}
#			}
#		}
#	}
#
#	immediate = {
#		capital_scope = {
#			solar_system = {
#				every_system_ambient_object= {
#					limit = {
#						has_ambient_object_flag = tecdawn_ae_debris
#					}
#					destroy_ambient_object = this
#				}
#			}
#		}
#		set_country_flag = tecdawn_cleared_debris
#	}
#}



# Starting markup of the interests systems - THE PROMISED LAND log
country_event = {
	id = tecdawn.20
	is_triggered_only = yes
	picture = GFX_evt_star_chart
	

	trigger = {
		has_country_flag = tecdawn_origin_setup
	}

	title = tecdawn.20.title
	desc = tecdawn.20.desc

	option = {
		name = tecdawn.20.a
		custom_tooltip = tecdawn.20.a.tooltip
		
	}

	immediate = {
		hidden_effect = {
			begin_event_chain = {
				event_chain = "tecdawn_promised_land_chain"
				target = ROOT
			}
			capital_scope = {
				solar_system = {
					closest_system = {
						limit = {
							has_star_flag = tecdawn_second_system
						}
						random_system_planet = {
							limit = {
								has_planet_flag = tecdawn_second_world
							}
							save_event_target_as = tecdawn_colony_poi_1
							
						}
					}
					closest_system = {
						limit = {
							has_star_flag = tecdawn_third_system
						}
						random_system_planet = {
							limit = {
								has_planet_flag = tecdawn_third_world
							}
							save_event_target_as = tecdawn_colony_poi_2
							
						}
					}	
				}	
			}
			create_point_of_interest = {
				id = tecdawn_promised_land_poi.1
				name = "tecdawn_promised_land_poi.1.name"
				desc = "tecdawn_promised_land_poi.1.desc"
				event_chain = tecdawn_promised_land_chain
				location = event_target:tecdawn_colony_poi_1
			}
			create_point_of_interest = {
				id = tecdawn_promised_land_poi.2
				name = "tecdawn_promised_land_poi.2.name"
				desc = "tecdawn_promised_land_poi.2.desc"
				event_chain = tecdawn_promised_land_chain
				location = event_target:tecdawn_colony_poi_2
			}
		}
		
	}
}


# -----------------------------  CHAIN I  ----------------------------- 2200-2215

# triggered on survey
# tecdawn101 - A twin world

ship_event = {
	id = tecdawn.101
	is_triggered_only = yes
	picture = GFX_evt_star_chart

	trigger = {
		from = {
			has_planet_flag = tecdawn_planet@root.owner
			is_planet_class = pc_tecdawn
		}
	}

	title = tecdawn.101.name

	desc = {
		text = tecdawn.101.regular.desc
		trigger = {
			hidden:root.owner = {
				is_regular_empire = yes
				NOR = {
					has_civic = civic_fanatic_purifiers
				}
			}
		}
	}

	desc = {
		text = tecdawn.101.purif.desc
		trigger = {
			hidden:root.owner = {
				is_regular_empire = yes
				has_civic = civic_fanatic_purifiers
			}
		}
	}

	desc = {
		text = tecdawn.101.hive.desc
		trigger = {
			hidden:root.owner = {
				is_hive_empire = yes
			}
		}
	}

	desc = {
		text = tecdawn.101.machine.desc
		trigger = {
			hidden:root.owner = {
				is_machine_empire = yes
			}
		}
	}

	option = {
		name = tecdawn.impossible.coincidence
	}

	immediate = {
		hidden_effect = {
			owner = {
				remove_point_of_interest = tecdawn_promised_land_poi.1
				set_country_flag = tecdawn_promised_land_poi_1_discovered
				if = {
					limit = { 
						has_country_flag = tecdawn_promised_land_poi_2_discovered
						has_country_flag = tecdawn_promised_land_poi_1_discovered
					}
					end_event_chain = "tecdawn_promised_land_chain"
				}
			}
		}
	}
}


ship_event = {
	id = tecdawn.102
	is_triggered_only = yes
	picture = GFX_evt_toxic

	trigger = {
		from = {
			has_planet_flag = tecdawn_toxic_world@root.owner
			is_planet_class = pc_toxic
		}
	}

	title = tecdawn.102.name

	desc = {
		text = tecdawn.102.desc
		trigger = {
			hidden:root.owner = {
				is_machine_empire = no
			}
		}
	}

	desc = {
		text = tecdawn.102.machine.desc
		trigger = {
			hidden:root.owner = {
				is_machine_empire = yes
			}
		}
	}

	option = {
		name = tecdawn.poisoned.paradise
	}

	immediate = {
		hidden_effect = {
			owner = {
				remove_point_of_interest = tecdawn_promised_land_poi.2
				set_country_flag = tecdawn_promised_land_poi_2_discovered
				if = {
					limit = { 
						has_country_flag = tecdawn_promised_land_poi_2_discovered
						has_country_flag = tecdawn_promised_land_poi_1_discovered
					}
					end_event_chain = "tecdawn_promised_land_chain"
				}
			}
		}
	}
}

# On colonization of that planet
planet_event = {
	id = tecdawn.110
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		has_planet_flag = tecdawn_planet@root.owner
		is_planet_class = pc_tecdawn
		NOT = {
			has_planet_flag = tecdawn_planet_already_colonized
		}
		owner = {
			has_country_flag = tecdawn_planet_@root
		}
	}

	immediate = {
		set_planet_flag = tecdawn_planet_already_colonized
		hidden_effect = {
			planet_event = {
				id = tecdawn.111
				days = @tecdawn1year
			}
		}
	}
}

# Possibility of the planet having dangerous creatures ?

# After X years spawn the primitives - Reflections of the past
planet_event = {
	id = tecdawn.111
	picture = GFX_evt_alien_cavemen
	is_triggered_only = yes
	show_sound = event_mystic_reveal

	trigger = {
		has_planet_flag = tecdawn_planet@root.owner
		is_planet_class = pc_tecdawn
		has_planet_flag = tecdawn_planet_already_colonized
		owner = {
			has_country_flag = tecdawn_planet_@root
		}
	}

	
	title = tecdawn.111.name

	desc = {
		text = tecdawn.111.regular.desc
		trigger = {
			hidden:root.owner = {
				is_regular_empire = yes
				NOR = {
					has_civic = civic_fanatic_purifiers
				}
			}
		}
	}

	desc = {
		text = tecdawn.111.purif.desc
		trigger = {
			hidden:root.owner = {
				is_regular_empire = yes
				has_civic = civic_fanatic_purifiers
			}
		}
	}

	desc = {
		text = tecdawn.111.hive.desc
		trigger = {
			hidden:root.owner = {
				is_hive_empire = yes
				NOT = {
					has_valid_civic = civic_hive_devouring_swarm
				}
			}
		}
	}

	desc = {
		text = tecdawn.111.hive.dev.desc
		trigger = {
			hidden:root.owner = {
				is_hive_empire = yes
				has_valid_civic = civic_hive_devouring_swarm
			}
		}
	}

	desc = {
		text = tecdawn.111.machine.desc
		trigger = {
			hidden:root.owner = {
				is_machine_empire = yes
			}
		}
	}

	# non purf option
	option = {
		name = tecdawn.111.option.a
		trigger = {
			this.owner = {
				NOR = {
					has_valid_civic = civic_machine_terminator
					has_valid_civic = civic_hive_devouring_swarm
					has_valid_civic = civic_fanatic_purifiers
				}
			}
		}
		hidden_effect = {
			this = {
				planet_event = {
					id = tecdawn.112
				}
				set_planet_flag = tecdawn_regular_primitives
				# Integration after 15 years
				planet_event = {
					id = tecdawn.114
					days = @tecdawn15years
				}

			}
		}
		custom_tooltip = "tecdawn.111.spawnprimitives"
		ai_chance = {
			factor = 1
		}
	}

	# default option
	option = {
		name = tecdawn.111.option.a2
		custom_tooltip = "tecdawn.111.investigateprimitives"
		hidden_effect = {
			this = {
				planet_event = {
					id = tecdawn.112
				}
				set_planet_flag = tecdawn_investigating_primitives
				
				
			}
			this.owner = {
				enable_special_project = {
					name = TECDAWN_FORCEUPLIFT_PRIMITIVES
					location = ROOT
				}
			}
		}
		ai_chance = {
			factor = 10
		}
		# Ai wants to do this
	}

	option = {
		name = tecdawn.111.option.b
		custom_tooltip = "tecdawn.111.killprimitives"
		trigger = {
			this.owner = {
				has_valid_civic = civic_fanatic_purifiers
			}
		}
		hidden_effect = {
			this = {
				planet_event = {
					id = tecdawn.112
				}
				planet_event = {
					id = tecdawn.113
					days = @tecdawn2years
				}
				set_planet_flag = tecdawn_purging_primitives
			}
			random_country = {
				limit = {
					is_country_type = global_event
				}
				change_variable = {
					which = tecdawn_killed_primitives
					value = 1
				}
			}
		}
		ai_chance = {
			factor = 1
		}
	}

	option = {
		name = tecdawn.111.option.c
		custom_tooltip = "tecdawn.111.eatprimitives"
		trigger = {
			this.owner = {
				has_valid_civic = civic_hive_devouring_swarm
			}
		}
		hidden_effect = {
			this = {
				planet_event = {
					id = tecdawn.112
				}
				planet_event = {
					id = tecdawn.113
					days = @tecdawn2years
				}
				set_planet_flag = tecdawn_eating_primitives
			}
			random_country = {
				limit = {
					is_country_type = global_event
				}
				change_variable = {
					which = tecdawn_killed_primitives
					value = 1
				}
			}
		}
		ai_chance = {
			factor = 1
		}
	}

	option = {
		name = tecdawn.111.option.d
		custom_tooltip = "tecdawn.111.terminateprimitives"
		trigger = {
			this.owner = {
				has_valid_civic = civic_machine_terminator
			}
		}
		hidden_effect = {
			this = {
				planet_event = {
					id = tecdawn.112
				}
				planet_event = {
					id = tecdawn.113
					days = @tecdawn2years
				}
				set_planet_flag = tecdawn_terminating_primitives
			}
			random_country = {
				limit = {
					is_country_type = global_event
				}
				change_variable = {
					which = tecdawn_killed_primitives
					value = 1
				}
			}
		}
		ai_chance = {
			factor = 1
		}
	}

	option = {
		name = tecdawn.111.option.e
		custom_tooltip = "tecdawn.111.dismantleprimitives"
		trigger = {
			this.owner = {
				is_machine_empire = yes
			}
		}
		hidden_effect = {
			this = {
				planet_event = {
					id = tecdawn.112
				}
				planet_event = {
					id = tecdawn.113
					days = @tecdawn2years
				}
				set_planet_flag = tecdawn_dismantling_primitives
			}
			random_country = {
				limit = {
					is_country_type = global_event
				}
				change_variable = {
					which = tecdawn_killed_primitives
					value = 1
				}
			}
		}
		ai_chance = {
			factor = 1
		}
	}

	option = {
		name = tecdawn.111.option.f
		custom_tooltip = "tecdawn.111.assimilateprimitives"
		trigger = {
			this.owner = {
				is_gestalt = yes
			}
		}
		hidden_effect = {
			this = {
				planet_event = {
					id = tecdawn.112
				}
				planet_event = {
					id = tecdawn.113
					days = @tecdawn2years
				}
				set_planet_flag = tecdawn_integrating_primitives
			}
		}
		ai_chance = {
			factor = 10
		}
	}

	immediate = {
		hidden_effect = {
			root.owner = {
				set_country_flag = tecdawn_misterious_primitives_discovered
			#	set_country_flag = story.6						# Discovered primitives
			}
			# Discovery of the array after 5 years
			planet_event = {
				id = tecdawn.120
				days = @tecdawn5years
			}
		}
	}
}

# Spawn the primitives thing
planet_event = {
	id = tecdawn.112
	hide_window = yes
	is_triggered_only = yes


	immediate = {
		while = {
			count = 4
			set_variable = {
				which = tecdawn_planet_primitives
				value = 1
			}
			create_pop = {
				species = THIS.owner
			}
			last_created_pop = {
				save_event_target_as = tecdawn_primitive_target
			}
			event_target:tecdawn_primitive_target = {
				if = {
					limit = {
						NOT = {
							has_pop_flag = tecdawn_modified_pop
						}
					}
					if = {
						limit = { 
							root.owner = {
								OR = {
									is_regular_empire = yes
									is_hive_empire = yes
								}
							}
						}
						modify_species = {
							add_trait = trait_tecdawn_presapient
						}
						
					}
					else_if = {
						limit = { 
							root.owner = {
								is_machine_empire = yes
							}
						}
						modify_species = {
							add_trait = trait_tecdawn_machine_rudimentary
						}
					}
					set_pop_flag = tecdawn_modified_pop
				}
				
			}
		}
	}
}

# If the primitives are purged, this happens each 2 years
planet_event = {
	id = tecdawn.113
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		random_owned_pop = {
			limit = {
				has_pop_flag = tecdawn_modified_pop
			}
			kill_pop = yes
		}
		subtract_variable = {
			which = tecdawn_planet_primitives
			value = 1
		}
		if = {
			limit = { 
				has_planet_flag = tecdawn_purging_primitives
			}
			root.owner = {
				add_resource = {
					unity = 15
				}
			}
		}
		if = {
			limit = { 
				has_planet_flag = tecdawn_eating_primitives
			}
			root.owner = {
				add_resource = {
					food = 20
				}
			}
		}
		if = {
			limit = { 
				has_planet_flag = tecdawn_terminating_primitives
			}
			root.owner = {
				add_resource = {
					unity = 10
					engineering_research = 10
				}
			}

		}
		if = {
			limit = { 
				has_planet_flag = tecdawn_dismantling_primitives
			}
			root.owner = {
				add_resource = {
					alloys = 10
					engineering_research = 5
				}
			}
		}
		if = {
			limit = { 
				has_planet_flag = tecdawn_integrating_primitives
			}
			create_pop = {
				species = root.owner
			}
		}
		if = {
			limit = {
				check_variable = {
					which = tecdawn_planet_primitives
					value > 0
				}
			}
			planet_event = {
				id = tecdawn.113
				days = @tecdawn2years
			}			
		}
	}
}



# 114 - Regular primitive uplifting 
planet_event = {
	id = tecdawn.114
	picture = GFX_evt_alien_cavemen
	is_triggered_only = yes
	show_sound = event_mystic_reveal

	trigger = {
		has_planet_flag = tecdawn_planet@root.owner
		is_planet_class = pc_tecdawn
		has_planet_flag = tecdawn_planet_already_colonized
		has_planet_flag = tecdawn_investigating_primitives
	}

	
	title = tecdawn.114.name

	desc = {
		text = tecdawn.114.normal.desc
		trigger = {
			hidden:root.owner = {
				is_regular_empire = yes
				NOR = {
					has_civic = civic_fanatic_purifiers
				}
			}
		}
	}

	desc = {
		text = tecdawn.114.purif.desc
		trigger = {
			hidden:root.owner = {
				is_regular_empire = yes
				has_civic = civic_fanatic_purifiers
			}
		}
	}

	desc = {
		text = tecdawn.114.hive.desc
		trigger = {
			hidden:root.owner = {
				is_hive_empire = yes
			}
		}
	}

	desc = {
		text = tecdawn.114.machine.desc
		trigger = {
			hidden:root.owner = {
				is_machine_empire = yes
			}
		}
	}

	# default option
	option = {
		name = EXCELLENT
		hidden_effect = {
			#this.owner = {
			#	set_country_flag = has_uplifted_species			# uplifted primitives
			#}
			this = {
				while = {
					count = 4
					random_owned_pop = {
						limit = {
							has_pop_flag = tecdawn_modified_pop
						}
						kill_pop = yes
					}
					subtract_variable = {
						which = tecdawn_planet_primitives
						value = 1
					}
					create_pop = {
						species = root.owner
					}
					event_target:tecdawn_modify_this_pop = {
						if = {
							limit = { 
								owner = {
									is_machine_empire = yes
								}
							}
							modify_species = {
								add_trait = trait_tecdawn_machine_rudimentary_good	
							}	
						}
						else_if = {
							limit = { 
								owner = {
									is_machine_empire = no
								}
							}
							modify_species = {
								add_trait = trait_tecdawn_presapient_good
							}
						}
					}
				}
			}
		}
	}
}

# 115 - Forced primitive uplifting
planet_event = {
	id = tecdawn.115
	picture = GFX_evt_cybernetics
	is_triggered_only = yes
	show_sound = event_mystic_reveal

	trigger = {
		has_planet_flag = tecdawn_planet@root.owner
		is_planet_class = pc_tecdawn
		has_planet_flag = tecdawn_planet_already_colonized
		has_planet_flag = tecdawn_investigating_primitives
	}

	
	title = tecdawn.115.name

	desc = {
		text = tecdawn.115.normal.desc
		trigger = {
			hidden:root.owner = {
				is_regular_empire = yes
				NOR = {
					has_civic = civic_fanatic_purifiers
				}
			}
		}
	}

	desc = {
		text = tecdawn.115.purif.desc
		trigger = {
			hidden:root.owner = {
				is_regular_empire = yes
				has_civic = civic_fanatic_purifiers
			}
		}
	}

	desc = {
		text = tecdawn.115.hive.desc
		trigger = {
			hidden:root.owner = {
				is_hive_empire = yes
			}
		}
	}

	desc = {
		text = tecdawn.115.machine.desc
		trigger = {
			hidden:root.owner = {
				is_machine_empire = yes
			}
		}
	}

	# default option
	option = {
		name = EXCELLENT
		hidden_effect = {
			#this.owner = {
			#	set_country_flag = has_uplifted_species			# uplifted primitives
			#}
			this = {
				while = {
					count = 4
					random_owned_pop = {
						limit = {
							has_pop_flag = tecdawn_modified_pop
						}
						kill_pop = yes
					}
					subtract_variable = {
						which = tecdawn_planet_primitives
						value = 1
					}
					create_pop = {
						species = root.owner
					}
					last_created_pop = {
						save_event_target_as = tecdawn_modify_this_pop
					}
					event_target:tecdawn_modify_this_pop = {
						if = {
							limit = { 
								owner = {
									is_machine_empire = yes
								}
							}
							modify_species = {
								add_trait = trait_tecdawn_machine_rudimentary_good
							}	
						}
						else_if = {
							limit = { 
								owner = {
									is_machine_empire = no
								}
							}
							modify_species = {
								add_trait = trait_tecdawn_presapient_good
							}
						}
					}
				}
			}
		}
	}
}




# Discovery of the ruined array - First digsite after 6 years
planet_event = {
	id = tecdawn.120
	is_triggered_only = yes
	picture = GFX_evt_habitable_dig_site

	trigger = {
		from = {
			has_planet_flag = tecdawn_planet@root.owner
		}
	}

	title = tecdawn.120.name

	desc = {
		text = tecdawn.120.normal.prim
		trigger = {
			has_planet_flag = tecdawn_regular_primitives
		}
	}
	desc = {
		text = tecdawn.120.investigated.prim
		trigger = {
			has_planet_flag = tecdawn_investigating_primitives	
		}
	}
	desc = {
		text = tecdawn.120.killed.prim
		trigger = {
			OR = {
				has_planet_flag = tecdawn_purging_primitives
				has_planet_flag = tecdawn_eating_primitives
				has_planet_flag = tecdawn_terminating_primitives
				has_planet_flag = tecdawn_dismantling_primitives
			}
			
		}
	}
	desc = {
		text = tecdawn.120.integrated.prim
		trigger = {
			hidden:root.owner = {
				is_regular_empire = yes
				NOR = {
					has_civic = civic_fanatic_purifiers
				}
			}
		}
	}
	desc = {
		text = tecdawn.120.notecdawnempire
		trigger = {
			hidden:root.owner = {
				NOT = {
					has_country_flag = tecdawn_planet_@root
				}
			}
		}
	}

	option = {
		name = tecdawn.needs.to.be.investigated
		hidden_effect = {
			# prevents the event to be lost if someone conquered the planet
			# checked each 5 years in loop if the planet has a different owner
			# needed to be done as the digsite is key for the chain
			if = {
				limit = {
					owner = {
						NOT = {
							has_country_flag = tecdawn_planet_@root
						}
					}
				}
				planet_event = {
					id = tecdawn.121
					days = @tecdawn5years
				}
			}
			if = {
				limit = {
					owner = {
						has_country_flag = tecdawn_planet_@root
					}
				}
				owner = {
					set_country_flag = tecdawn_story_1
				}
				
			}
		}
	}
}

# safeguard
planet_event = {
	id = tecdawn.121
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		if = {
			limit = {
				owner = {
					NOT = {
						has_country_flag = tecdawn_planet_@root
					}
				}
			}
			planet_event = {
				id = tecdawn.121
				days = @tecdawn5years
			}
		}
		if = {
			limit = {
				owner = {
					has_country_flag = tecdawn_planet_@root
				}
			}
			planet_event = {
				id = tecdawn.120
			}
		}
	}
}



# DIGSITE EVENTS - Shadows in the Dark
# 1010
fleet_event = {
	id = tecdawn.1010
	#archaeology_window = yes
	title = "tecdawn.1010.name"
	desc = "tecdawn.1010.desc"
	picture = GFX_evt_surreal_visions
	show_sound = event_finding_loot
	location = from

	archaeology = yes

	is_triggered_only = yes

	immediate = {
		fromfrom = { set_site_progress_locked = yes }
	}

	after = { 
		fromfrom = { set_site_progress_locked = no }
	}
	

	option = {
		name = "tecdawn.1010.a"
		small_artifact_reward = yes
	}
}

# 1012
fleet_event = {
	id = tecdawn.1012
	#archaeology_window = yes
	title = "tecdawn.1012.name"
	desc = "tecdawn.1012.desc"
	picture = GFX_evt_archaeology_camp
	show_sound = event_finding_loot
	location = from

	archaeology = yes

	is_triggered_only = yes

	immediate = {
		fromfrom = { set_site_progress_locked = yes }
	}

	after = { 
		fromfrom = { set_site_progress_locked = no }
	}
	

	option = {
		name = "tecdawn.1012.a"
		small_artifact_reward = yes
	}
}

# 1013
fleet_event = {
	id = tecdawn.1013
	#archaeology_window = yes
	title = "tecdawn.1013.name"
	desc = "tecdawn.1013.desc"
	picture = GFX_evt_in_the_dark
	show_sound = event_finding_loot
	location = from

	archaeology = yes

	is_triggered_only = yes

	immediate = {
		fromfrom = { set_site_progress_locked = yes }
	}

	after = { 
		fromfrom = { set_site_progress_locked = no }
	}
	

	option = {
		name = "tecdawn.1013.a"
		tecdawn_small_minerals_reward = yes
	}
}

# 1014
fleet_event = {
	id = tecdawn.1014
	#archaeology_window = yes
	title = "tecdawn.1014.name"
	desc = "tecdawn.1014.desc"
	picture = GFX_evt_in_the_dark
	show_sound = event_bad_omen
	location = from

	archaeology = yes

	is_triggered_only = yes

	immediate = {
		fromfrom = { set_site_progress_locked = yes }
	}

	after = { 
		fromfrom = { set_site_progress_locked = no }
	}
	

	option = {
		name = "tecdawn.1014.a"
		tecdawn_small_alloys_reward = yes
		hidden_effect = {
			root.owner = {
				if = {
					limit = { 
						capital_scope = {
							is_planet_class = pc_tecdawn
						}

					}
					capital_scope = {
						planet_event = {
							id = tecdawn.130
							days = 30 #@tecdawn5years
						}
					}
				}
				else = {
					random_owned_planet = {
						limit = {
							has_planet_flag = tecdawn_first_world
						}
						planet_event = {
							id = tecdawn.130
							days = 30 #@tecdawn5years
						}
					}
				}
			}
		}
	}
}

# /DIGSITE EVENTS



# After the digsite is finished, 5 years delay and the next step is marked
planet_event = {
	id = tecdawn.130
	is_triggered_only = yes
	picture = GFX_evt_physics_research
	show_sound = event_ancient_drone

	title = tecdawn.130.name

	desc = {
		text = tecdawn.130.normal.prim
		trigger = {
			owner = {
				has_country_flag = tecdawn_planet_@root
			}
		}
	}

	desc = {
		text = tecdawn.130.notecdawnempire
		trigger = {
			owner = {
				NOT = {
					has_country_flag = tecdawn_planet_@root
				}
			}
		}
	}
	
	option = {
		name = tecdawn.move.teams.to.observe
	}

	immediate = {
		hidden_effect = {
			# prevents the event to be lost if someone conquered the planet
			# checked each 5 years in loop if the planet has a different owner
			# needed to be done as the digsite is key for the chain
			if = {
				limit = {
					owner = {
						NOT = {
							has_country_flag = tecdawn_planet_@root
						}
					}
				}
				planet_event = {
					id = tecdawn.131
					days = @tecdawn5years
				}
			}
			if = {
				limit = {
					owner = {
						has_country_flag = tecdawn_planet_@root
					}
				}
				owner = {
					set_country_flag = tecdawn_story_2
				}
			}
		}
	}
}


# safeguard
planet_event = {
	id = tecdawn.131
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		if = {
			limit = {
				owner = {
					NOT = {
						has_country_flag = tecdawn_planet_@root
					}
				}
			}
			planet_event = {
				id = tecdawn.131
				days = @tecdawn5years
			}
		}
		if = {
			limit = {
				owner = {
					has_country_flag = tecdawn_planet_@root
				}
			}
			planet_event = {
				id = tecdawn.130
			}
		}
	}
}

# -----------------------------  CHAIN II  ----------------------------- 2215-2230

# DIGSITE EVENTS - A Known Melody
# 2010
fleet_event = {
	id = tecdawn.2010
	#archaeology_window = yes
	title = "tecdawn.2010.name"
	desc = "tecdawn.2010.desc"
	picture = GFX_evt_alien_planet
	show_sound = event_finding_loot
	location = from

	archaeology = yes

	is_triggered_only = yes

	immediate = {
		fromfrom = { set_site_progress_locked = yes }
	}

	after = { 
		fromfrom = { set_site_progress_locked = no }
	}
	

	option = {
		name = "tecdawn.2010.a"
	}
}

# 2011
fleet_event = {
	id = tecdawn.2011
	#archaeology_window = yes
	title = "tecdawn.2011.name"
	desc = "tecdawn.2011.desc"
	picture = GFX_evt_mining_operations
	show_sound = event_finding_loot
	location = from

	archaeology = yes

	is_triggered_only = yes

	immediate = {
		fromfrom = { set_site_progress_locked = yes }
	}

	after = { 
		fromfrom = { set_site_progress_locked = no }
	}
	

	option = {
		name = "tecdawn.2011.a"
		tecdawn_medium_minerals_reward = yes
		small_artifact_reward = yes
	}
}
# 2012
fleet_event = {
	id = tecdawn.2012
	#archaeology_window = yes
	title = "tecdawn.2012.name"
	desc = "tecdawn.2012.desc"
	picture = GFX_evt_derelict_interior
	show_sound = event_finding_loot
	location = from

	archaeology = yes

	is_triggered_only = yes

	immediate = {
		fromfrom = { set_site_progress_locked = yes }
	}

	after = { 
		fromfrom = { set_site_progress_locked = no }
	}
	

	option = {
		name = "tecdawn.2012.a"
		tecdawn_small_alloys_reward = yes
		medium_artifact_reward = yes
	}
}

# 2013
fleet_event = {
	id = tecdawn.2013
	#archaeology_window = yes
	title = "tecdawn.2013.name"
	desc = "tecdawn.2013.desc"
	picture = GFX_evt_resource_cache
	show_sound = event_finding_loot
	location = from

	archaeology = yes

	is_triggered_only = yes

	immediate = {
		fromfrom = { set_site_progress_locked = yes }
		hidden_effect = {
			root.owner = {
				country_event = {
					id = tecdawn.200
					days = @tecdawn1year
				}
			}
		}
	}

	after = { 
		fromfrom = { set_site_progress_locked = no }
	}
	

	option = {
		name = "tecdawn.2013.a"
		small_artifact_reward = yes
	}
}
# /DIGSITE EVENTS

# tecdawn200 - The missing Link
country_event = {
	id = tecdawn.200
	title = "tecdawn.200.name"
	desc = "tecdawn.200.desc"
	picture = GFX_evt_physics_research
	show_sound = event_radio_chatter

	is_triggered_only = yes

	option = {
		name = tecdawn.200.a
		enable_special_project = {
			name = TECDAWN_MISSING_LINK_PROJECT
			location = capital_scope
		}
	}
}




# After special project is done, marks 4 locations for investigation
country_event = {
	id = tecdawn.201
	title = "tecdawn.201.name"
	desc = "tecdawn.201.desc"
	picture = GFX_evt_physics_research
	show_sound = event_radio_chatter

	is_triggered_only = yes

	option = {
		name = tecdawn.200.a
		begin_event_chain = {
			event_chain = "tecdawn_locate_missing_link_chain"
			target = ROOT
		}
		random_planet_within_border = {
			limit = {
			#	is_planet_class = pc_toxic
				has_planet_flag = tecdawn_has_observer
				has_planet_flag = tecdawn_fourth_world
				has_planet_flag = tecdawn_toxic_world@root
			}
			enable_special_project = {
				name = "TECDAWN_MISLINK_OBSERVER_PROJECT"
				location = this
				owner = root
			}
		}
		random_planet_within_border = {
			limit = {
			#	is_planet_class = pc_toxic
				has_planet_flag = tecdawn_third_world
				has_planet_flag = tecdawn_toxic_world@root
			}
			enable_special_project = {
				name = "TECDAWN_MISLINK_TOXIC_PROJECT"
				location = this
				owner = root
			}
		}
		
		random_planet_within_border = {
			limit = {
				is_planet_class = pc_shattered
				has_planet_flag = tecdawn_planet@root
			}
			enable_special_project = {
				name = "TECDAWN_MISLINK_SHATTERED_PROJECT"
				location = this
				owner = root
			}
		}

		random_planet_within_border = {
			limit = {
				OR = {
					is_planet_class = pc_barren
					is_planet_class = pc_barren_cold
					is_planet_class = pc_frozen
				}
				distance = {
					source = root.capital_scope
					max_jumps = 1
				}
			}
			set_planet_flag = tecdawn_important_planet_@root
			set_planet_flag = tecdawn_collapsed_@root
			root = {
				set_country_flag = tecdawn_planet_@prev
			}
			enable_special_project = {
				name = "TECDAWN_MISLINK_COLLAPSE_PROJECT"
				location = this
				owner = root
			}
		}
	}
}


# shattered
ship_event = {
	id = tecdawn.205
	title = "tecdawn.205.name"
	desc = "tecdawn.205.desc"
	picture = GFX_evt_shattered_planet
	show_sound = event_ship_bridge

	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			owner = {
				add_event_chain_counter = { 
					event_chain = tecdawn_locate_missing_link_chain
					counter = tecdawn_sites_visited
					amount = 1 
				}
			}
		}
	}
	option = {
		name = tecdawn.205.ok
		trigger = {
			owner = {
				NOT = {
					has_completed_event_chain_counter = {
						event_chain = tecdawn_locate_missing_link_chain
						counter = tecdawn_sites_visited
					}	
				}
			}
		}
	}
	option = {
		name = tecdawn.205.last
		trigger = {
			owner = {
				has_completed_event_chain_counter = {
					event_chain = tecdawn_locate_missing_link_chain
					counter = tecdawn_sites_visited
				}	
			}
		}
		hidden_effect = {
			root.owner = {
				set_country_flag = tecdawn_finished_missing_link_chain
				end_event_chain = tecdawn_locate_missing_link_chain
				country_event = {
					id = tecdawn.209
					days = 30
				}
			}
		}
	}
}

# Collapsed
ship_event = {
	id = tecdawn.206
	title = "tecdawn.206.name"
	desc = "tecdawn.206.desc"
	picture = GFX_evt_nuclear_explosion
	show_sound = event_ship_bridge

	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			owner = {
				add_event_chain_counter = { 
					event_chain = tecdawn_locate_missing_link_chain
					counter = tecdawn_sites_visited
					amount = 1 
				}
			}
		}
	}
	option = {
		name = tecdawn.206.ok
		trigger = {
			owner = {
				NOT = {
					has_completed_event_chain_counter = {
						event_chain = tecdawn_locate_missing_link_chain
						counter = tecdawn_sites_visited
					}	
				}
			}
		}
	}
	option = {
		name = tecdawn.206.last
		trigger = {
			owner = {
				has_completed_event_chain_counter = {
					event_chain = tecdawn_locate_missing_link_chain
					counter = tecdawn_sites_visited
				}
				
			}
		}
		hidden_effect = {
			root.owner = {
				set_country_flag = tecdawn_finished_missing_link_chain
				end_event_chain = tecdawn_locate_missing_link_chain
				country_event = {
					id = tecdawn.209
					days = 30
				}
			}
		}
	}

}



# Toxic
ship_event = {
	id = tecdawn.207
	title = "tecdawn.207.name"
	desc = "tecdawn.207.desc"
	picture = GFX_evt_toxic
	show_sound = event_ship_bridge

	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			owner = {
				add_event_chain_counter = { 
					event_chain = tecdawn_locate_missing_link_chain
					counter = tecdawn_sites_visited
					amount = 1 
				}
			}
		}
	}
	option = {
		name = tecdawn.206.ok
		trigger = {
			owner = {
				NOT = {
					has_completed_event_chain_counter = {
						event_chain = tecdawn_locate_missing_link_chain
						counter = tecdawn_sites_visited
					}	
				}
			}
		}
		hidden_effect = {
		}
	}
	option = {
		name = tecdawn.206.last
		trigger = {
			owner = {
				has_completed_event_chain_counter = {
					event_chain = tecdawn_locate_missing_link_chain
					counter = tecdawn_sites_visited
				}	
			}
		}
		hidden_effect = {
			root.owner = {
				set_country_flag = tecdawn_finished_missing_link_chain
				end_event_chain = tecdawn_locate_missing_link_chain
				country_event = {
					id = tecdawn.209
					days = 30
				}
			}
		}
	}
}



# Observer
ship_event = {
	id = tecdawn.208
	title = "tecdawn.208.name"
	desc = "tecdawn.208.desc"
	picture = GFX_evt_space_debris
	show_sound = event_ship_bridge

	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			owner = {
				add_event_chain_counter = { 
					event_chain = tecdawn_locate_missing_link_chain
					counter = tecdawn_sites_visited
					amount = 1 
				}
			}
		}
	}
	option = {
		name = tecdawn.206.ok
		trigger = {
			owner = {
				NOT = {
					has_completed_event_chain_counter = {
						event_chain = tecdawn_locate_missing_link_chain
						counter = tecdawn_sites_visited
					}	
				}
			}
		}
	}
	option = {
		name = tecdawn.206.last
		trigger = {
			owner = {
				has_completed_event_chain_counter = {
					event_chain = tecdawn_locate_missing_link_chain
					counter = tecdawn_sites_visited
				}	
			}
		}
		hidden_effect = {
			root.owner = {
				set_country_flag = tecdawn_finished_missing_link_chain
				end_event_chain = tecdawn_locate_missing_link_chain
				country_event = {
					id = tecdawn.209
					days = 30
				}
			}
		}
	}
}

# Impact crater manager - Why non habitable planets are so DULL to code T-T
country_event = {
	id = tecdawn.209
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		random_planet_within_border = {
			limit = {
				OR = {
					is_planet_class = pc_barren
					is_planet_class = pc_barren_cold
					is_planet_class = pc_frozen
				}
				has_planet_flag = tecdawn_important_planet_@root
			}
			planet_event = {
				id = tecdawn.210
				days = 1
			}
			
		}
		country_event = {
			id = tecdawn.211
			days = 1
		}
	}
}

planet_event = {
	id = tecdawn.210
	hide_window = yes

	is_triggered_only = yes

	trigger = {
		always = yes
	}

	immediate = {
		create_archaeological_site = site_tecdawn_fallen
	}

}



country_event = {
	id = tecdawn.211
	title = "tecdawn.211.name"
	desc = "tecdawn.211.desc"
	picture = GFX_evt_ship_offloading_cargo
	show_sound = event_alien_signal

	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			random_planet_within_border = {
				limit = {
					has_planet_flag = tecdawn_collapsed_@root
				}
				save_event_target_as = event_target:tecdawn_collapsed_planet
			}
	
		}
	}
	option = {
		name = tecdawn.211.regular.ok
		trigger = {
			owner = {
				is_regular_empire = yes
			}
		}
	}
	option = {
		name = tecdawn.211.hive.ok
		trigger = {
			owner = {
				is_hive_empire = yes
			}
		}
	}
	option = {
		name = tecdawn.211.machine.ok
		trigger = {
			owner = {
				is_machine_empire = yes	
			}
		}
		ai_chance = {
			factor = 1
		}
	}
}




#Subchain
# Primitives are synthetics
# Primitives start dissapearing
# More primitives appear




# -----------------------------  CHAIN III  ----------------------------- 2230-2275


# DIGSITE III
# 3010
fleet_event = {
	id = tecdawn.3010
	#archaeology_window = yes
	title = "tecdawn.3010.name"
	desc = "tecdawn.3010.desc"
	picture = GFX_evt_crashed_station
	show_sound = event_finding_loot
	location = from

	archaeology = yes

	is_triggered_only = yes

	immediate = {
		fromfrom = { set_site_progress_locked = yes }
	}

	after = { 
		fromfrom = { set_site_progress_locked = no }
	}

	option = {
		name = "tecdawn.3010.a"
		tecdawn_medium_minerals_reward = yes
	}
}

# 3011
fleet_event = {
	id = tecdawn.3011
	#archaeology_window = yes
	title = "tecdawn.3011.name"
	desc = "tecdawn.3011.desc"
	picture = GFX_evt_ruined_system
	show_sound = event_finding_loot
	location = from

	archaeology = yes

	is_triggered_only = yes

	immediate = {
		fromfrom = { set_site_progress_locked = yes }
	}

	after = { 
		fromfrom = { set_site_progress_locked = no }
	}

	option = {
		name = "tecdawn.3011.a"
	}
}

# 3012
fleet_event = {
	id = tecdawn.3012
	#archaeology_window = yes
	title = "tecdawn.3012.name"
	desc = "tecdawn.3012.desc"
	picture = GFX_evt_ancient_databank
	show_sound = event_finding_loot
	location = from

	archaeology = yes

	is_triggered_only = yes

	immediate = {
		fromfrom = { set_site_progress_locked = yes }
	}

	after = { 
		fromfrom = { set_site_progress_locked = no }
	}

	option = {
		name = "tecdawn.3012.a"
		tecdawn_medium_alloys_reward = yes
		medium_artifact_reward = yes
		hidden_effect = {
			root.owner = {
				country_event = {
					id = tecdawn.308
					days = 10
				}
			}
		}
	}
}
# /THIRD DIGSITE



country_event = {
	id = tecdawn.308
	title = "tecdawn.308.name"
	desc = "tecdawn.308.desc"
	picture = GFX_evt_busy_spaceport
	show_sound = event_mystic_reveal

	is_triggered_only = yes

	option = {
		name = tecdawn.308.ok

		hidden_effect = {
			set_country_flag = tecdawn_unlocked_array
			begin_event_chain = {
				event_chain = "tecdawn_build_arrays_chain"
				target = ROOT
			}
			random_planet = {
				limit = {
					has_planet_flag = tecdawn_first_world
					has_planet_flag = tecdawn_planet@root
				}
				create_point_of_interest = {
					id = tecdawn_array_poi_1
					name = tecdawn_array_poi_1
					event_chain = tecdawn_build_arrays_chain
					location = THIS
				}
			}
			random_planet = {
				limit = {
					has_planet_flag = tecdawn_second_world
					has_planet_flag = tecdawn_planet@root
				}
				create_point_of_interest = {
					id = tecdawn_array_poi_2
					name = tecdawn_array_poi_2
					event_chain = tecdawn_build_arrays_chain
					location = THIS
				}
			}
		}
	}
}



# Each dawn array adds a variable / complete one of the objectives flags

# First array completed
planet_event = {
	id = tecdawn.309
	title = "tecdawn.309.name"
	desc = "tecdawn.309.desc"
	picture = GFX_evt_busy_spaceport
	show_sound = event_mystic_reveal

	is_triggered_only = yes

	option = {
		name = tecdawn.309.ok

		hidden_effect = {
			
		}
	}
}

# Second array completed
planet_event = {
	id = tecdawn.310
	title = "tecdawn.310.name"
	desc = "tecdawn.310.desc"
	picture = GFX_evt_busy_spaceport
	show_sound = event_mystic_reveal

	is_triggered_only = yes

	option = {
		name = tecdawn.310.ok

		hidden_effect = {
			owner = {
				country_event = {
					id = tecdawn.311
					days = 90
				}
			}
		}
	}
}

# Both arrays completed
country_event = {
	id = tecdawn.311
	title = "tecdawn.311.name"
	desc = "tecdawn.311.desc"
	picture = GFX_evt_busy_spaceport
	show_sound = event_activating_unknown_technology

	is_triggered_only = yes

	option = {
		name = tecdawn.311.ok

		hidden_effect = {
			end_event_chain = tecdawn_build_arrays_chain
			country_event = {
				id = tecdawn.312
				days = @tecdawn1year
			}
		}
	}
}


country_event = {
	id = tecdawn.312
	title = "tecdawn.312.name"
	desc = "tecdawn.312.desc"
	picture = GFX_evt_baol_datacrystals
	show_sound = event_activating_unknown_technology

	is_triggered_only = yes

	option = {
		name = tecdawn.312.ok

		hidden_effect = {
			enable_special_project = {
				name = TECDAWN_RESCAN_ARRAY
				location = capital_scope
			}
		}
	}
}


# digsite on the second guaranteed system
country_event = {
	id = tecdawn.313
	title = "tecdawn.313.name"
	desc = "tecdawn.313.desc"
	picture = GFX_evt_toxic
	show_sound = event_activating_unknown_technology

	is_triggered_only = yes

	option = {
		name = tecdawn.313.ok

		hidden_effect = {
			random_planet = {
				limit = {
					has_planet_flag = tecdawn_fourth_world
					has_planet_flag = tecdawn_toxic_world@root
				}
				create_archaeological_site = site_tecdawn_silent
			}
		}
	}
}



# Subchain
# Electronic disturbances on colony 2 - Animals go wilder
# Research one of the toxic planets around the main system for hints
# Discover a pop assembly subterranean station of colony 2



# -----------------------------  CHAIN IV  ----------------------------- 2275-2300

# DIGSIVE IV
# 4010
fleet_event = {
	id = tecdawn.4010
	#archaeology_window = yes
	title = "tecdawn.4010.name"
	desc = "tecdawn.4010.desc"
	picture = GFX_evt_mining_operations
	show_sound = event_finding_loot
	location = from

	archaeology = yes

	is_triggered_only = yes

	immediate = {
		fromfrom = { set_site_progress_locked = yes }
	}

	after = { 
		fromfrom = { set_site_progress_locked = no }
	}

	option = {
		name = "tecdawn.4010.a"
	}
}

# 4011
fleet_event = {
	id = tecdawn.4011
	#archaeology_window = yes
	title = "tecdawn.4011.name"
	desc = "tecdawn.4011.desc"
	picture = GFX_evt_derelict_interior
	show_sound = event_finding_loot
	location = from

	archaeology = yes

	is_triggered_only = yes

	immediate = {
		fromfrom = { set_site_progress_locked = yes }
	}

	after = { 
		fromfrom = { set_site_progress_locked = no }
	}

	option = {
		name = "tecdawn.4011.a"
		tecdawn_small_gas_reward = yes
		small_artifact_reward = yes
	}
}


# 4012
fleet_event = {
	id = tecdawn.4012
	#archaeology_window = yes
	title = "tecdawn.4012.name"
	desc = "tecdawn.4012.desc"
	picture = GFX_evt_derelict_interior
	show_sound = event_finding_loot
	location = from

	archaeology = yes

	is_triggered_only = yes

	immediate = {
		fromfrom = { set_site_progress_locked = yes }
	}

	after = { 
		fromfrom = { set_site_progress_locked = no }
	}

	option = {
		name = "tecdawn.4012.a"
		tecdawn_medium_gas_reward = yes
		small_artifact_reward = yes
	}
}


# 4013
fleet_event = {
	id = tecdawn.4013
	#archaeology_window = yes
	title = "tecdawn.4013.name"
	desc = "tecdawn.4013.desc"
	picture = GFX_evt_baol_datacrystals
	show_sound = event_finding_loot
	location = from

	archaeology = yes

	is_triggered_only = yes

	immediate = {
		fromfrom = { set_site_progress_locked = yes }
	}

	after = { 
		fromfrom = { set_site_progress_locked = no }
	}

	option = {
		name = "tecdawn.4013.a"
		medium_artifact_reward = yes
		hidden_effect = {
			root.owner = {
				country_event = {
					id = tecdawn.314
					days = 10
				}
			}
		}
	}
}

# / DIGSITE IV


# Chain 4 ending
country_event = {
	id = tecdawn.314
	title = "tecdawn.314.name"
	desc = "tecdawn.314.desc"
	picture = GFX_evt_ancient_alien_temple
	show_sound = event_activating_unknown_technology

	is_triggered_only = yes

	option = {
		name = tecdawn.314.ok

		enable_special_project = {
			name = TECDAWN_RESTART_ARRAYS
			location = capital_scope
		}
	}
}


# tecdawn400 - Before the storm
country_event = {
	id = tecdawn.400
	title = "tecdawn.400.name"
	desc = "tecdawn.400.desc"
	picture = GFX_evt_planet_beam
	show_sound = event_dyson_sphere_build_complete

	is_triggered_only = yes

	option = {
		name = tecdawn.400.ok

		hidden_effect = {
			country_event = {
				id = tecdawn.401
				days = 5
			}
		}
	}
}


# tecdawn401 - Before the storm II
country_event = {
	id = tecdawn.401
	title = "tecdawn.401.name"
	desc = "tecdawn.401.desc"
	picture = GFX_evt_binary_stars
	show_sound = event_energy_field

	is_triggered_only = yes

	option = {
		name = tecdawn.401.ok

		hidden_effect = {
			country_event = {
				id = tecdawn.402
			}
			random_planet = {
				limit = {
				#	is_planet_class = pc_toxic	# Removed because horizon signal magic ...
					has_planet_flag = tecdawn_toxic_world@root
					has_planet_flag = tecdawn_third_world
				}
				planet_event = {
					id = tecdawn.405
				}
			}
		}
	}
}

# The first, second and third system will be affected by a space storm during 15 years
# Handles the storm
country_event = {
	id = tecdawn.402
	hide_window = yes

	is_triggered_only = yes

	immediate = {
		capital_scope = {
			solar_system = {
				set_star_flag = storm_system
				set_star_flag = tecdawn_storm_system
					star = {
						create_ambient_object = {
							type = "space_storm_1"
							location = this
						}
						last_created_ambient_object = {
							set_ambient_object_flag = space_storm_object
							set_location = {
								target = prev
								distance = 0
								angle = random
							}
						}
						planet_event = {
							id = tecdawn.403
							days = @tecdawn15years
						}
					}
				add_modifier = { modifier = space_storm }
			}
			closest_system = {
				limit = {
					has_star_flag = tecdawn_second_system
				}
				set_star_flag = storm_system
				set_star_flag = tecdawn_storm_system
					star = {
						create_ambient_object = {
							type = "space_storm_1"
							location = this
						}
						last_created_ambient_object = {
							set_ambient_object_flag = space_storm_object
							set_location = {
								target = prev
								distance = 0
								angle = random
							}
						}
						planet_event = {
							id = tecdawn.403
							days = @tecdawn15years
						}
					}
				add_modifier = { modifier = space_storm }
			}
			closest_system = {
				limit = {
					has_star_flag = tecdawn_third_system
				}
				set_star_flag = storm_system
				set_star_flag = tecdawn_storm_system
					star = {
						create_ambient_object = {
							type = "space_storm_1"
							location = this
						}
						last_created_ambient_object = {
							set_ambient_object_flag = space_storm_object
							set_location = {
								target = prev
								distance = 0
								angle = random
							}
						}
						planet_event = {
							id = tecdawn.403
							days = @tecdawn15years
						}
					}
					add_modifier = { modifier = space_storm }
			}
			closest_system = {
				limit = {
					has_owner = yes
					owner = {
						is_same_value = root
					}
					distance = {
						source = THIS
						max_jumps < 3
					}
					NOR = {
						has_star_flag = tecdawn_third_system
						has_star_flag = tecdawn_second_system
						has_star_flag = tecdawn_first_system
						has_star_flag = tecdawn_storm_system
						has_modifier = space_storm
						has_modifier = turbulent_nebula
					}
				}
				set_star_flag = storm_system
				set_star_flag = tecdawn_storm_system
				star = {
					create_ambient_object = {
						type = "space_storm_1"
						location = this
					}
					last_created_ambient_object = {
						set_ambient_object_flag = space_storm_object
						set_location = {
							target = prev
							distance = 0
							angle = random
						}
					}
					planet_event = {
						id = tecdawn.403
						days = @tecdawn15years
					}
				}
				add_modifier = { modifier = space_storm }
			}
			closest_system = {
				limit = {
					has_owner = yes
					owner = {
						is_same_value = root
					}
					distance = {
						source = THIS
						max_jumps < 3
					}
					NOR = {
						has_star_flag = tecdawn_third_system
						has_star_flag = tecdawn_second_system
						has_star_flag = tecdawn_first_system
						has_star_flag = tecdawn_storm_system
						has_modifier = space_storm
						has_modifier = turbulent_nebula
					}
				}
				set_star_flag = storm_system
				set_star_flag = tecdawn_storm_system
				star = {
					create_ambient_object = {
						type = "space_storm_1"
						location = this
					}
					last_created_ambient_object = {
						set_ambient_object_flag = space_storm_object
						set_location = {
							target = prev
							distance = 0
							angle = random
						}
					}
					planet_event = {
						id = tecdawn.403
						days = @tecdawn15years
					}
				}
				add_modifier = { modifier = space_storm }
			}
			closest_system = {
				limit = {
					has_owner = yes
					owner = {
						is_same_value = root
					}
					distance = {
						source = THIS
						max_jumps < 3
					}
					NOR = {
						has_star_flag = tecdawn_third_system
						has_star_flag = tecdawn_second_system
						has_star_flag = tecdawn_first_system
						has_star_flag = tecdawn_storm_system
						has_modifier = space_storm
						has_modifier = turbulent_nebula
					}
				}
				set_star_flag = storm_system
				set_star_flag = tecdawn_storm_system
				star = {
					create_ambient_object = {
						type = "space_storm_1"
						location = this
					}
					last_created_ambient_object = {
						set_ambient_object_flag = space_storm_object
						set_location = {
							target = prev
							distance = 0
							angle = random
						}
					}
					planet_event = {
						id = tecdawn.403
						days = @tecdawn15years
					}
				}
				add_modifier = { modifier = space_storm }
			}
		}
	}
}


# Alternative and safest version
planet_event = {
	id = tecdawn.403
	hide_window = yes

	is_triggered_only = yes

	immediate = {
		this = {
			solar_system = {
				remove_star_flag = storm_system
				remove_star_flag = tecdawn_storm_system
				random_system_ambient_object = {
					limit = { has_ambient_object_flag = space_storm_object }
					destroy_ambient_object = this
				}
				remove_modifier = space_storm
				if = {
					limit = { 
						any_system_ambient_object = {
							has_ambient_object_flag = tecdawn_ae_observer
						}
					}
					every_system_ambient_object = {
						limit = {
							has_ambient_object_flag = tecdawn_ae_observer
						}
						destroy_ambient_object = this
					}
					every_system_ambient_object = {
						limit = {
							has_ambient_object_flag = tecdawn_ae_debris
						}
						destroy_ambient_object = this
					}
					every_system_planet = {
						limit = {
							has_planet_flag = tecdawn_has_observer
						}
						create_ambient_object = {
							type = tecdawn_active_observer
						}
						last_created_ambient_object = {
							set_ambient_object_flag = tecdawn_ae_repaired_observer
						}
					}
				}
			}
		}
	}
}



# Starts the transformation of the planet - Used later by the array
planet_event = {
	id = tecdawn.405
	hide_window = yes

	is_triggered_only = yes

	immediate = {
		this = {
			add_modifier = {
				modifier = tecdawn_being_terraformed
				#days = 360 #Test	# Barren planets dont get the cooldown working... xd
			}
			planet_event = {
				id = tecdawn.406
				days = @tecdawn15years
			}
			create_ambient_object = {
				type = "turbulent_nebula_2"
				location = this
				entity_offset_height = -13
				scale = 0.015
			}
			last_created_ambient_object = {
				set_ambient_object_flag = tecdawn_terraform_nebula@prev
				set_location = {
					target = prev
					distance = 0
					angle = random
				}
			}
			create_ambient_object = {
				type = "space_storm_1"
				location = this
				entity_offset_height = -13
				scale = 0.075
			}
			last_created_ambient_object = {
				set_ambient_object_flag = tecdawn_terraform_storm@prev
				set_location = {
					target = prev
					distance = 0
					angle = random
				}
			}
			create_point_of_interest = {
				id = tecdawn_touched_by_the_light
				name = tecdawn_touched_by_the_light.name
				desc = tecdawn_touched_by_the_light.desc
				event_chain = tecdawn_touched_by_the_light_chain
				location = THIS
			}
			solar_system = {
				owner = {
					country_event = {
						id = tecdawn.410
						days = 30
					}
				}
			}
		}
	}
}


planet_event = {
	id = tecdawn.406
	hide_window = yes

	is_triggered_only = yes

	immediate = {
		this = {
			change_pc = pc_tecdawn
			remove_all_buildings = yes
			clear_deposits = yes
			clear_blockers = yes
			remove_modifier = tecdawn_being_terraformed
			tecdawn_generate_synth_deposits_and_blockers_second = yes
			
			solar_system = {
				random_system_ambient_object = {
					limit = { 
						has_ambient_object_flag = tecdawn_terraform_nebula@root
					}
					destroy_ambient_object = this
				}
				random_system_ambient_object = {
					limit = { 
						has_ambient_object_flag = tecdawn_terraform_storm@root
					}
					destroy_ambient_object = this
				}
				random_playable_country = {
					limit = {
						has_country_flag = tecdawn_planet_@root
					}
					country_event = {
						id = tecdawn.411
					}
					remove_point_of_interest = tecdawn_touched_by_the_light
					end_event_chain = tecdawn_touched_by_the_light_chain
				}
			}
			
		}
	}
}


# transformation lore (after researching anomaly)
country_event = {
	id = tecdawn.410
	title = "tecdawn.410.name"
	desc = "tecdawn.410.desc"
	picture = GFX_evt_gray_gooed_planet
	show_sound = event_energy_field

	is_triggered_only = yes

	option = {
		name = tecdawn.410.ok
	}
}


# Planet transformed
country_event = {
	id = tecdawn.411
	title = "tecdawn.411.name"

	picture = GFX_evt_gray_gooed_planet
	show_sound = event_energy_field

	is_triggered_only = yes

	immediate = {
		closest_system = {			#At this stage the country could have lost the systems, so better to be sure
			limit = {
				has_star_flag = tecdawn_third_system
				any_system_planet = {
					has_planet_flag = tecdawn_toxic_world@root
					has_planet_flag = tecdawn_third_world
				}
			}
			random_planet = {
				limit = {
					has_planet_flag = tecdawn_toxic_world@root
					has_planet_flag = tecdawn_third_world
				}
				save_event_target_as = tecdawn_terraformed_planet
			}
		}
	}
	desc = {		#tecdawn country
		text = tecdawn.411.desc
		trigger = {
			owner = {
				has_origin = origin_tecdawn
			}
		}
	}

	desc = {		#notecdawn country
		text = tecdawn.411.desc.notecdawnempire
		trigger = {
			owner = {
				NOT = {
					has_origin = origin_tecdawn
				}
			}
		}
	}

	option = {
		name = tecdawn.411.ok
		trigger = {
			owner = {
				has_country_flag = tecdawn_planet_@root
			}
		}
		hidden_effect = {
			owner = {
				set_country_flag = tecdawn_story_5
			}
		}
	}

	option = {
		name = tecdawn.411.intradesting
		trigger = {
			owner = {
				NOT = {
					has_country_flag = tecdawn_planet_@root
				}
			}
		}
		hidden_effect = {
			random_playable_country = {
				limit = {
					has_country_flag = tecdawn_planet_@event_target:tecdawn_terraformed_planet
				}
				set_country_flag = tecdawn_story_5
			}
		}
	}

	after = {
		event_target:tecdawn_terraformed_planet = {
			if = {
				limit = { 
					NOT = {
						has_deposit = d_tecdawn_locked_vault_3
					
					}
				}
				add_deposit = d_tecdawn_locked_vault_3
			}
			
		}
	}
}

#safeguard

# safeguard
planet_event = {
	id = tecdawn.412
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		if = {
			limit = {
				solar_system = {
					owner = {
						NOT = {
							has_country_flag = tecdawn_planet_@root
						}
					}	
				}
				
			}
			planet_event = {
				id = tecdawn.412
				days = @tecdawn5years
			}
		}
		if = {
			limit = {
				solar_system = {
					owner = {
						has_country_flag = tecdawn_planet_@root
					}	
				}
				
			}
			solar_system = {
				owner = {
					country_event = {
						id = tecdawn.411
					}
				}	
			}
		}
	}
}

# Subchain
# Project to soothe the lifeforms on the second colony / terminate the lifeforms

# -----------------------------  CHAIN V  ----------------------------- 2300-2325

# triggered on survey
# tecdawn501 - Unescapable consequences


# The first planet will receive a blocker deposit and a digsite


# DIGSITE V
# 5010
fleet_event = {
	id = tecdawn.5010
	#archaeology_window = yes
	title = "tecdawn.5010.name"
	desc = "tecdawn.5010.desc"
	picture = GFX_evt_derelict_interior
	show_sound = event_finding_loot
	location = from

	archaeology = yes

	is_triggered_only = yes

	immediate = {
		fromfrom = { set_site_progress_locked = yes }
	}

	after = { 
		fromfrom = { set_site_progress_locked = no }
	}

	option = {
		name = "tecdawn.5010.a"
		small_artifact_reward = yes
	}
}

# 5011
fleet_event = {
	id = tecdawn.5011
	#archaeology_window = yes
	title = "tecdawn.5011.name"
	desc = "tecdawn.5011.desc"
	picture = GFX_evt_derelict_interior
	show_sound = event_finding_loot
	location = from

	archaeology = yes

	is_triggered_only = yes

	immediate = {
		fromfrom = { set_site_progress_locked = yes }
	}

	after = { 
		fromfrom = { set_site_progress_locked = no }
	}
	

	option = {
		name = "tecdawn.5011.a"
	}
}

# 5012
fleet_event = {
	id = tecdawn.5012
	#archaeology_window = yes
	title = "tecdawn.5012.name"
	desc = "tecdawn.5012.desc"
	picture = GFX_evt_derelict_interior
	show_sound = event_finding_loot
	location = from

	archaeology = yes

	is_triggered_only = yes

	immediate = {
		fromfrom = { set_site_progress_locked = yes }
	}

	after = { 
		fromfrom = { set_site_progress_locked = no }
	}
	

	option = {
		name = "tecdawn.5012.a"
		tecdawn_medium_gas_reward = yes
		small_artifact_reward = yes
	}
}

# 5013
fleet_event = {
	id = tecdawn.5013
	#archaeology_window = yes
	title = "tecdawn.5013.name"
	desc = "tecdawn.5013.desc"
	picture = GFX_evt_sapient_AI
	show_sound = event_finding_loot
	location = from

	archaeology = yes

	is_triggered_only = yes

	immediate = {
		fromfrom = { set_site_progress_locked = yes }
	}

	after = { 
		fromfrom = { set_site_progress_locked = no }
	}
	

	option = {
		name = "tecdawn.5013.a"
		medium_artifact_reward = yes
	}
}

# Stage 5&6 - Ending outcome
fleet_event = {
	id = tecdawn.5014
	hide_window = yes
	
	archaeology = yes
	is_triggered_only = yes

	immediate = {
	# If only one empire has the origin, draws equally between the endings
		if = {
			limit = {
				event_target:global_event_country = {
					check_variable = {
						which = tecdawn_countries
						value = 1
					}
				}
			}
			random_list = {
				# Unjust experiment - We are a experiment
				20 = {
					fleet_event = { 
						id = tecdawn.5020 
					}
					root.owner = {
						set_country_flag = tecdawn_unjustexperiment_ending
						country_event = {
							id = tecdawn.10100 
						}
					}
				}
				# The last resort - Precursors are us
				20 = {
					fleet_event = { 
						id = tecdawn.5025
					}
					root.owner = {
						set_country_flag = tecdawn_lastresort_ending
						country_event = {
							id = tecdawn.10300 
						}
					}
				}
				# Souless Remorse - Machines regretted killing us
				20 = {
					fleet_event = { 
						id = tecdawn.5030 
					}
					root.owner = {
						set_country_flag = tecdawn_souless_ending
						country_event = {
							id = tecdawn.10200 
						}
					}
				}
			#	# The Dawn Engine - Spicy
			#	20 = {
			#		fleet_event = { 
			#			id = tecdawn.5035
			#		}
			#		root.owner = {
			#			set_country_flag = tecdawn_dawnengine_ending
			#			country_event = {
			#				id = tecdawn.20000 
			#			}
			#		}
			#	}
			}
		}
		# If there are 2 empires with the origin, increased chance
		if = {
			limit = {
				event_target:global_event_country = {
					check_variable = {
						which = tecdawn_countries
						value = 2
					}
				}
			}
			random_list = {
				# Unjust experiment - We are a experiment
				10 = {
					fleet_event = { 
						id = tecdawn.5020 
					}
					root.owner = {
						set_country_flag = tecdawn_unjustexperiment_ending
						country_event = {
							id = tecdawn.10100 
						}
					}
				}
				# The last resort - Precursors are us
				10 = {
					fleet_event = { 
						id = tecdawn.5025
					}
					root.owner = {
						set_country_flag = tecdawn_lastresort_ending
						country_event = {
							id = tecdawn.10300 
						}
					}
				}
				# Souless Remorse - Machines regretted killing us
				10 = {
					fleet_event = { 
						id = tecdawn.5030 
					}
					root.owner = {
						set_country_flag = tecdawn_souless_ending
						country_event = {
							id = tecdawn.10200 
						}
					}
				}
				# The Dawn Engine - Spicy
			#	30 = {
			#		fleet_event = { 
			#			id = tecdawn.5035
			#		}
			#		root.owner = {
			#			set_country_flag = tecdawn_dawnengine_ending
			#			country_event = {
			#				id = tecdawn.20000 
			#			}
			#		}
			#	}
			}
		}
		# If there are 3 empires with the origin, increased chance
		if = {
			limit = {
				event_target:global_event_country = {
					check_variable = {
						which = tecdawn_countries
						value >= 3
					}
				}
			}
			random_list = {
				# Unjust experiment - We are a experiment
				10 = {
					fleet_event = { 
						id = tecdawn.5020 
					}
					root.owner = {
						set_country_flag = tecdawn_unjustexperiment_ending
						country_event = {
							id = tecdawn.10100 
						}
					}
				}
				# The last resort - Precursors are us
				10 = {
					fleet_event = { 
						id = tecdawn.5025
					}
					root.owner = {
						set_country_flag = tecdawn_lastresort_ending
						country_event = {
							id = tecdawn.10300 
						}
					}
				}
				# Souless Remorse - Machines regretted killing us
				10 = {
					fleet_event = { 
						id = tecdawn.5030 
					}
					root.owner = {
						set_country_flag = tecdawn_souless_ending
						country_event = {
							id = tecdawn.10200
						}
					}
				}
				# The Dawn Engine - Spicy
			#	40 = {
			#		fleet_event = { 
			#			id = tecdawn.5035
			#		}
			#		root.owner = {
			#			set_country_flag = tecdawn_dawnengine_ending
			#			country_event = {
			#				id = tecdawn.20000 
			#			}
			#		}
			#	}
			}
		}
		# If there are 4 or more, dawn engine is secured
	#	if = {
	#		limit = {
	#			event_target:global_event_country = {
	#				check_variable = {
	#					which = tecdawn_countries
	#					value > 3
	#				}
	#			}
	#		}
	#		fleet_event = { 
	#			id = tecdawn.5035
	#		}
	#		root.owner = {
	#			set_country_flag = tecdawn_dawnengine_ending
	#			country_event = {
	#				id = tecdawn.20000 
	#			}
	#		}
	#	}
		root.owner = {
			set_country_flag= tecdawn_flexible_array
		}
	}

	after = { 
		from = { expire_site_event = tecdawn.5014 } 
	}

}


fleet_event = {
	id = tecdawn.5015
	hide_window = yes
	
	archaeology = yes
	is_triggered_only = yes

	immediate = {
		if = {
			limit = {
				root.owner = {
					has_country_flag = tecdawn_unjustexperiment_ending
				}	
			}
			fleet_event = { 
				id = tecdawn.5021 
			}
		}
		if = {
			limit = {
				root.owner = {
					has_country_flag = tecdawn_lastresort_ending
				}	
			}
			fleet_event = { 
				id = tecdawn.5026
			}
		}
		if = {
			limit = {
				root.owner = {
					has_country_flag = tecdawn_souless_ending
				}	
			}
			fleet_event = { 
				id = tecdawn.5031
			}
		}
		# default ending, just in case, so the digsite dont get confused
		if = {				
			limit = {
				root.owner = {
					OR = {
						has_country_flag = tecdawn_dawnengine_ending
						NOR = {
							has_country_flag = tecdawn_unjustexperiment_ending
							has_country_flag = tecdawn_lastresort_ending
							has_country_flag = tecdawn_souless_ending
							has_country_flag = tecdawn_dawnengine_ending
						}
					}
				}	
			}
			fleet_event = { 
				id = tecdawn.5036
			}
		}
	}
	after = { 
		from = { expire_site_event = tecdawn.5015 } 
	}

}


# Stage 5&6 - Ending outcome I

# 5020 # Unjust experiment
fleet_event = {
	id = tecdawn.5020
	#archaeology_window = yes
	title = "tecdawn.5020.name"
	desc = "tecdawn.5020.desc"
	picture = GFX_evt_clones
	show_sound = event_finding_loot
	location = from

	archaeology = yes

	is_triggered_only = yes


	immediate = {
		fromfrom = { set_site_progress_locked = yes }
	}

	after = { 
		fromfrom = { set_site_progress_locked = no }
	}

	option = {
		name = "tecdawn.5020.a"
		small_artifact_reward = yes
	}

}

fleet_event = {
	id = tecdawn.5021
	#archaeology_window = yes
	title = "tecdawn.5021.name"
	desc = "tecdawn.5021.desc"
	picture = GFX_evt_clones
	show_sound = event_finding_loot
	location = from

	archaeology = yes

	is_triggered_only = yes

	immediate = {
		fromfrom = { set_site_progress_locked = yes }
	}

	option = {
		name = "tecdawn.5021.a"
		large_artifact_reward = yes
	}

	after = { 
		fromfrom = { set_site_progress_locked = no }
		hidden_effect = {
			root.owner = {
				country_event = {
					id = tecdawn.10150
					days = @tecdawn1year
				}
			}
		}
	}

}



# 5025 # The last resort
fleet_event = {
	id = tecdawn.5025
	#archaeology_window = yes
	title = "tecdawn.5025.name"
	desc = "tecdawn.5025.desc"
	picture = GFX_evt_derelict_interior
	show_sound = event_finding_loot
	location = from

	archaeology = yes

	is_triggered_only = yes

	immediate = {
		fromfrom = { set_site_progress_locked = yes }
	}

	option = {
		name = "tecdawn.5025.a"
		small_artifact_reward = yes
	}

	after = { 
		fromfrom = { set_site_progress_locked = no }
	}

}

fleet_event = {
	id = tecdawn.5026
	#archaeology_window = yes
	title = "tecdawn.5026.name"
	desc = "tecdawn.5026.desc"
	picture = GFX_evt_derelict_interior
	show_sound = event_finding_loot
	location = from

	archaeology = yes

	is_triggered_only = yes

	immediate = {
		fromfrom = { set_site_progress_locked = yes }
	}

	after = { 
		fromfrom = { set_site_progress_locked = no }
		hidden_effect = {
			root.owner = {
				country_event = {
					id = tecdawn.10350
					days = @tecdawn1year
				}
			}
		}
	}


	option = {
		name = "tecdawn.5026.a"
		large_artifact_reward = yes
	}
}




# 5030 # Souless Remorse 
fleet_event = {
	id = tecdawn.5030
	#archaeology_window = yes
	title = "tecdawn.5030.name"
	desc = "tecdawn.5030.desc"
	picture = GFX_evt_sapient_AI
	show_sound = event_finding_loot
	location = from

	archaeology = yes

	is_triggered_only = yes

	immediate = {
		fromfrom = { set_site_progress_locked = yes }
	}

	after = { 
		fromfrom = { set_site_progress_locked = no }
	}


	option = {
		name = "tecdawn.5030.a"
		small_artifact_reward = yes
	}
}

fleet_event = {
	id = tecdawn.5031
	#archaeology_window = yes
	title = "tecdawn.5031.name"
	desc = "tecdawn.5031.desc"
	picture = GFX_evt_sapient_AI
	show_sound = event_finding_loot
	location = from

	archaeology = yes

	is_triggered_only = yes

	immediate = {
		fromfrom = { set_site_progress_locked = yes }
	}

	after = { 
		fromfrom = { set_site_progress_locked = no }
		hidden_effect = {
			root.owner = {
				country_event = {
					id = tecdawn.10250
					days = @tecdawn1year
				}
			}
		}
	}


	option = {
		name = "tecdawn.5031.a"
		large_artifact_reward = yes
	}
}



# 5035 # The Dawn Engine 
fleet_event = {
	id = tecdawn.5035
	#archaeology_window = yes
	title = "tecdawn.5035.name"
	desc = "tecdawn.5035.desc"
	picture = GFX_evt_interstellar_assembly
	show_sound = event_finding_loot
	location = from

	archaeology = yes

	is_triggered_only = yes

	immediate = {
		fromfrom = { set_site_progress_locked = yes }
	}

	after = { 
		fromfrom = { set_site_progress_locked = no }
	}

	option = {
		name = "tecdawn.5035.a"
		small_artifact_reward = yes
	}
}

fleet_event = {
	id = tecdawn.5036
	#archaeology_window = yes
	title = "tecdawn.5036.name"
	desc = "tecdawn.5036.desc"
	picture = GFX_evt_interstellar_assembly
	show_sound = event_finding_loot
	location = from

	archaeology = yes

	is_triggered_only = yes

	immediate = {
		fromfrom = { set_site_progress_locked = yes }
	}

	after = { 
		fromfrom = { set_site_progress_locked = no }
	}


	option = {
		name = "tecdawn.5036.a"
		large_artifact_reward = yes
	}
}
# /DIGSITE V

# On completion marks the end of the chain and ending


# -----------------------------  CHAIN V  ----------------------------- 2325-2400



# Ending 1 : Unjust Experiment tecdawn.10100 

# ENDING A - Unexpected host
country_event = {
	id = tecdawn.10100
	title = "tecdawn.10100.name"
	desc = "tecdawn.10100.desc"
	picture = GFX_evt_sapient_AI
	show_sound = relic_activation_isolated_contingency_core

	is_triggered_only = yes

	option = {
		name = tecdawn.10100.a
		hidden_effect = {
			set_country_flag = tecdawn_attempted_to_run
			country_event = { id = tecdawn.10110 }
		}
	}
	option = {
		name = tecdawn.10100.b
		hidden_effect = {
			set_country_flag = tecdawn_attempted_to_shoot
			country_event = { id = tecdawn.10110 }
		}
	}
	option = {
		name = tecdawn.10100.c
		hidden_effect = {
			set_country_flag = tecdawn_attempted_to_nothing
			country_event = { id = tecdawn.10110 }
		}
	}
}

# ENDING A - Unexpected host II
country_event = {
	id = tecdawn.10110 
	title = "tecdawn.10110.name"
	
	picture = GFX_evt_sapient_AI
	show_sound = event_radio_chatter

	is_triggered_only = yes

	desc = {
		text = tecdawn.10110.desc.a
		trigger = {
			has_country_flag = tecdawn_attempted_to_run
		}
	}

	desc = {
		text = tecdawn.10110.desc.b
		trigger = {
			has_country_flag = tecdawn_attempted_to_shoot
		}
	}

	desc = {
		text = tecdawn.10110.desc.c
		trigger = {
			has_country_flag = tecdawn_attempted_to_nothing
		}
	}

	option = {
		name = tecdawn.10110.a
		hidden_effect = {
			country_event = { 
				id = tecdawn.10120 
			}
		}
	}
}

# ENDING A - Incoming Transmission
country_event = {
	id = tecdawn.10120 
	title = "TRANSMISSION"
	desc = "tecdawn.10120.desc"
	show_sound = advisor_notification_incoming_transmission

	diplomatic = yes

	picture_event_data = {
		room = no_video_feed_room
	}

	is_triggered_only = yes

	option = {
		name = tecdawn.10120.a
		response_text = tecdawn.10120.a.response
		is_dialog_only = yes
	}
	option = {
		name = tecdawn.10120.b
		response_text = tecdawn.10120.b.response
		is_dialog_only = yes
	}
	option = {
		name = tecdawn.10120.c
		response_text = tecdawn.10120.c.response
		is_dialog_only = yes
	}
	option = {
		name = tecdawn.10120.d
		response_text = tecdawn.10120.d.response
		is_dialog_only = yes
	}
	option = {
		name = tecdawn.10120.e
	}
}




# ENDING A - 1 year after finishing digsite
# Spawn the system
country_event = {
	id = tecdawn.10150
	title = tecdawn.10150.name
	desc = tecdawn.10150.desc
	picture = GFX_evt_ruined_system
	show_sound = event_mystic_reveal
	is_triggered_only = yes

	option = {
		name = tecdawn.10150.a
	}
	after = {
		begin_event_chain = {
			event_chain = tecdawn_precursor_planet_chain
		}
		hidden_effect = {
			if = {
				limit = {
					any_system_within_border = { 
						OR = {
							has_star_flag = tecdawn_first_system
							has_star_flag = tecdawn_second_system
							has_star_flag = tecdawn_third_system
						}
					}
				}
				random_system_within_border = {
					limit = { 
						OR = {
							has_star_flag = tecdawn_first_system
							has_star_flag = tecdawn_second_system
							has_star_flag = tecdawn_third_system
						}
					}
					random_list = {
						10  = { 
							spawn_system = {
								min_distance = 10
								max_distance = 30
								max_jumps = 0
								initializer = "random_empire_init_01"
							}
						}
						10  = { 
							spawn_system = {
								min_distance = 10
								max_distance = 30
								max_jumps = 0
								initializer = "random_empire_init_02"
							}
						}
						10  = { 
							spawn_system = {
								min_distance = 10
								max_distance = 30
								max_jumps = 0
								initializer = "random_empire_init_03"
							}
						}
						10  = { 
							spawn_system = {
								min_distance = 10
								max_distance = 30
								max_jumps = 0
								initializer = "random_empire_init_04"
							}
						}
						10  = { 
							spawn_system = {
								min_distance = 10
								max_distance = 30
								max_jumps = 0
								initializer = "random_empire_init_05"
							}
						}
						10  = { 
							spawn_system = {
								min_distance = 10
								max_distance = 30
								max_jumps = 0
								initializer = "random_empire_init_06"
							}
						}
					}
				}
			}
			else = {
				random_system = {
					limit = { 
						has_owner = yes
						owner = {
							is_same_value = root
						}
					}
					random_list = {
						10  = { 
							spawn_system = {
								min_distance = 10
								max_distance = 30
								max_jumps = 0
								initializer = "random_empire_init_01"
							}
						}
						10  = { 
							spawn_system = {
								min_distance = 10
								max_distance = 30
								max_jumps = 0
								initializer = "random_empire_init_02"
							}
						}
						10  = { 
							spawn_system = {
								min_distance = 10
								max_distance = 30
								max_jumps = 0
								initializer = "random_empire_init_03"
							}
						}
						10  = { 
							spawn_system = {
								min_distance = 10
								max_distance = 30
								max_jumps = 0
								initializer = "random_empire_init_04"
							}
						}
						10  = { 
							spawn_system = {
								min_distance = 10
								max_distance = 30
								max_jumps = 0
								initializer = "random_empire_init_05"
							}
						}
						10  = { 
							spawn_system = {
								min_distance = 10
								max_distance = 30
								max_jumps = 0
								initializer = "random_empire_init_06"
							}
						}
					}
					
				}
			}
			last_created_system = {
				set_star_flag = tecdawn_precursor_system_@root
				random_system_planet = {
					limit = {
						NOR = {
							is_star = yes
							is_planet_class = pc_black_hole
							is_asteroid = yes
						}
					}
					save_event_target_as = tecdawn_precursor_planet_target
					root  = {
						create_point_of_interest = {
							id = tecdawn_precursor_planet
							name =  "tecdawn_precursor_planet.name"
							desc = "tecdawn_precursor_planet.desc"
							event_chain = tecdawn_precursor_planet_chain
							location = event_target:tecdawn_precursor_planet_target
						}
					}
					if = {
						limit = { 
							habitable_planet = yes
						}
						
						if = {
							limit = { 
								host_has_dlc = "Ancient Relics Story Pack"
							}
							change_pc = pc_relic
							reroll_planet = yes
							add_deposit = d_black_soil			# Food for variety, useless but...
							add_deposit = d_fungal_caves

						}
						else = {
							change_pc = pc_nuked
							reroll_planet = yes
						}
						set_planet_size = 22
						set_planet_flag = tecdawn_precursor_planet_@root
						root = {
							set_country_flag = tecdawn_planet_@prev
						}
						set_planet_flag = tecdawn_has_observer
						create_ambient_object = {
							type = tecdawn_observer
						}
						last_created_ambient_object = {
							set_ambient_object_flag = tecdawn_ae_observer
						}
						create_ambient_object = {
							type = medium_debris_01_object
						}
						last_created_ambient_object = {
							set_ambient_object_flag = tecdawn_ae_debris
						}
						set_planet_flag = tecdawn_debris
					}
					else = {
					#	limit = {
					#		uninhabitable_regular_planet = yes
					#	}
						
						if = {
							limit = { 
								host_has_dlc = "Ancient Relics Story Pack"
							}
							change_pc = pc_relic
							relic_world_deposits = yes
							add_deposit = d_black_soil
							add_deposit = d_fungal_caves
							
						}
						else = {
							change_pc = pc_nuked
							reroll_planet = yes
						}
						set_planet_size = 22
						set_planet_flag = tecdawn_precursor_planet_@root
						root = {
							set_country_flag = tecdawn_planet_@prev
						}
						set_planet_flag = tecdawn_has_observer
						create_ambient_object = {
							type = tecdawn_observer
						}
						last_created_ambient_object = {
							set_ambient_object_flag = tecdawn_ae_observer
						}
						create_ambient_object = {
							type = medium_debris_01_object
						}
						last_created_ambient_object = {
							set_ambient_object_flag = tecdawn_ae_debris
						}
						set_planet_flag = tecdawn_debris
					}
				}
			}
		}
	}
}

# ENDING A - On survey
ship_event = {
	id = tecdawn.10160
	is_triggered_only = yes
	picture = GFX_evt_star_chart

	trigger = {
		from = {
			has_planet_flag = tecdawn_precursor_planet_@root.owner
			solar_system = {
				has_star_flag = tecdawn_precursor_system_@root.owner
			}
			root.owner = {
				has_country_flag = tecdawn_unjustexperiment_ending
			}
		}
	}

	title = tecdawn.10160.name

	desc = tecdawn.10160.desc

	option = {
		name = tecdawn.10160.a
	}

	after = {
		from = {
			create_archaeological_site = site_tecdawn_irony
		}
	}
}

# ENDING A DIGSITE
fleet_event = {
	id = tecdawn.6010
	#archaeology_window = yes
	title = "tecdawn.6010.name"
	desc = "tecdawn.6010.desc"
	picture = GFX_evt_city_ruins
	show_sound = event_wind_ruins
	location = from

	archaeology = yes

	is_triggered_only = yes

	immediate = {
		fromfrom = { set_site_progress_locked = yes }
	}

	after = { 
		fromfrom = { set_site_progress_locked = no }
	}
	

	option = {
		name = "tecdawn.6010.a"
		medium_artifact_reward = yes
	}
}

fleet_event = {
	id = tecdawn.6011
	#archaeology_window = yes
	title = "tecdawn.6011.name"
	desc = "tecdawn.6011.desc"
	picture = GFX_evt_city_ruins
	show_sound = event_wind_ruins
	location = from

	archaeology = yes

	is_triggered_only = yes

	immediate = {
		fromfrom = { set_site_progress_locked = yes }
	}

	after = { 
		fromfrom = { set_site_progress_locked = no }
	}
	

	option = {
		name = "tecdawn.6011.a"
		medium_artifact_reward = yes
	}
}

fleet_event = {
	id = tecdawn.6012
	#archaeology_window = yes
	title = "tecdawn.6012.name"
	desc = "tecdawn.6012.desc"
	picture = GFX_evt_excavation_team
	show_sound = event_wind_ruins
	location = from

	archaeology = yes

	is_triggered_only = yes

	immediate = {
		fromfrom = { set_site_progress_locked = yes }
	}

	after = { 
		fromfrom = { set_site_progress_locked = no }
	}
	

	option = {
		name = "tecdawn.6012.a"
		tecdawn_big_alloys_reward = yes
		medium_artifact_reward = yes
	}
}


fleet_event = {
	id = tecdawn.6013
	#archaeology_window = yes
	title = "tecdawn.6013.name"
	desc = "tecdawn.6013.desc"
	picture = GFX_evt_excavation_team
	show_sound = event_finding_loot
	location = from

	archaeology = yes

	is_triggered_only = yes

	immediate = {
		fromfrom = { set_site_progress_locked = yes }
	}

	after = { 
		fromfrom = { set_site_progress_locked = no }
	}
	

	option = {
		name = "tecdawn.6013.a"
		large_artifact_reward = yes
		root.owner = {
			add_modifier = {
				modifier = tecdawn_unjust_experiment_bonus
			}
			hidden_effect = {
				end_event_chain = tecdawn_precursor_planet_chain
				set_country_flag = tecdawn_can_use_dawnengine_small
				set_variable = {
					which = tecdawn_engine_uses
					value = 3
				}
			}
		}
	}
}


# Ending 2: Souless Remorse 10200
# Unexpected host
country_event = {
	id = tecdawn.10200
	title = "tecdawn.10200.name"
	desc = "tecdawn.10200.desc"
	picture = GFX_evt_sapient_AI
	show_sound = relic_activation_isolated_contingency_core

	is_triggered_only = yes

	option = {
		name = tecdawn.10200.a
		hidden_effect = {
			set_country_flag = tecdawn_attempted_to_run
			country_event = { id = tecdawn.10210 }
		}
	}
	option = {
		name = tecdawn.10200.b
		hidden_effect = {
			set_country_flag = tecdawn_attempted_to_shoot
			country_event = { id = tecdawn.10210 }
		}
	}
	option = {
		name = tecdawn.10200.c
		hidden_effect = {
			set_country_flag = tecdawn_attempted_to_nothing
			country_event = { id = tecdawn.10210 }
		}
	}
}

# Unexpected host
country_event = {
	id = tecdawn.10210 
	title = "tecdawn.10210.name"
	
	picture = GFX_evt_sapient_AI
	show_sound = event_radio_chatter

	is_triggered_only = yes

	desc = {
		text = tecdawn.10210.desc.a
		trigger = {
			has_country_flag = tecdawn_attempted_to_run
		}
	}

	desc = {
		text = tecdawn.10210.desc.b
		trigger = {
			has_country_flag = tecdawn_attempted_to_shoot
		}
	}

	desc = {
		text = tecdawn.10210.desc.c
		trigger = {
			has_country_flag = tecdawn_attempted_to_nothing
		}
	}

	option = {
		name = tecdawn.10210.a
		hidden_effect = {
			country_event = { 
				id = tecdawn.10220 
			}
		}
	}
}

# Incoming Transmission
country_event = {
	id = tecdawn.10220 
	title = "TRANSMISSION"
	desc = "tecdawn.10220.desc"

	diplomatic = yes

	picture_event_data = {
		room = no_video_feed_room
	}

	is_triggered_only = yes

	option = {
		name = tecdawn.10220.a
		response_text = tecdawn.10220.a.response
		is_dialog_only = yes
	}
	option = {
		name = tecdawn.10220.b
		response_text = tecdawn.10220.b.response
		is_dialog_only = yes
	}
	option = {
		name = tecdawn.10220.c
		response_text = tecdawn.10220.c.response
		is_dialog_only = yes
	}
	option = {
		name = tecdawn.10220.d
		response_text = tecdawn.10220.d.response
		is_dialog_only = yes
	}
	option = {
		name = tecdawn.10220.e
		response_text = tecdawn.10220.e.response
		is_dialog_only = yes
	}
	option = {
		name = tecdawn.10220.f
		hidden_effect = {
		}
	}
}


# ENDING B - 1 year after finishing digsite
# Spawn the system
country_event = {
	id = tecdawn.10250
	title = tecdawn.10250.name
	desc = tecdawn.10250.desc
	picture = GFX_evt_ruined_system
	show_sound = event_mystic_reveal
	is_triggered_only = yes

	option = {
		name = tecdawn.10250.a
	}
	after = {
		begin_event_chain = {
			event_chain = tecdawn_precursor_planet_chain
		}
		hidden_effect = {
			if = {
				limit = {
					any_system_within_border = { 
						OR = {
							has_star_flag = tecdawn_first_system
							has_star_flag = tecdawn_second_system
							has_star_flag = tecdawn_third_system
						}
					}
				}
				random_system_within_border = {
					limit = { 
						OR = {
							has_star_flag = tecdawn_first_system
							has_star_flag = tecdawn_second_system
							has_star_flag = tecdawn_third_system
						}
					}
					random_list = {
						10  = { 
							spawn_system = {
								min_distance = 10
								max_distance = 30
								max_jumps = 0
								initializer = "random_empire_init_01"
							}
						}
						10  = { 
							spawn_system = {
								min_distance = 10
								max_distance = 30
								max_jumps = 0
								initializer = "random_empire_init_02"
							}
						}
						10  = { 
							spawn_system = {
								min_distance = 10
								max_distance = 30
								max_jumps = 0
								initializer = "random_empire_init_03"
							}
						}
						10  = { 
							spawn_system = {
								min_distance = 10
								max_distance = 30
								max_jumps = 0
								initializer = "random_empire_init_04"
							}
						}
						10  = { 
							spawn_system = {
								min_distance = 10
								max_distance = 30
								max_jumps = 0
								initializer = "random_empire_init_05"
							}
						}
						10  = { 
							spawn_system = {
								min_distance = 10
								max_distance = 30
								max_jumps = 0
								initializer = "random_empire_init_06"
							}
						}
					}
				}
			}
			else = {
				random_system = {
					limit = { 
						has_owner = yes
						owner = {
							is_same_value = root
						}
					}
					random_list = {
						10  = { 
							spawn_system = {
								min_distance = 10
								max_distance = 30
								max_jumps = 0
								initializer = "random_empire_init_01"
							}
						}
						10  = { 
							spawn_system = {
								min_distance = 10
								max_distance = 30
								max_jumps = 0
								initializer = "random_empire_init_02"
							}
						}
						10  = { 
							spawn_system = {
								min_distance = 10
								max_distance = 30
								max_jumps = 0
								initializer = "random_empire_init_03"
							}
						}
						10  = { 
							spawn_system = {
								min_distance = 10
								max_distance = 30
								max_jumps = 0
								initializer = "random_empire_init_04"
							}
						}
						10  = { 
							spawn_system = {
								min_distance = 10
								max_distance = 30
								max_jumps = 0
								initializer = "random_empire_init_05"
							}
						}
						10  = { 
							spawn_system = {
								min_distance = 10
								max_distance = 30
								max_jumps = 0
								initializer = "random_empire_init_06"
							}
						}
					}
					
				}
			}
			last_created_system = {
				set_star_flag = tecdawn_precursor_system_@root
				random_system_planet = {
					limit = {
						NOR = {
							is_star = yes
							is_planet_class = pc_black_hole
							is_asteroid = yes
						}
					}
					save_event_target_as = tecdawn_precursor_planet_target
					root  = {
						create_point_of_interest = {
							id = tecdawn_precursor_planet
							name =  "tecdawn_precursor_planet.name"
							desc = "tecdawn_precursor_planet.desc"
							event_chain = tecdawn_precursor_planet_chain
							location = event_target:tecdawn_precursor_planet_target
						}
					}
					if = {
						limit = { 
							habitable_planet = yes
						}
						
						if = {
							limit = { 
								host_has_dlc = "Ancient Relics Story Pack"
							}
							change_pc = pc_relic
							reroll_planet = yes
							add_deposit = d_black_soil			# Food for variety, useless but...
							add_deposit = d_fungal_caves

						}
						else = {
							change_pc = pc_nuked
							reroll_planet = yes
						}
						set_planet_size = 22
						set_planet_flag = tecdawn_precursor_planet_@root
						root = {
							set_country_flag = tecdawn_planet_@prev
						}
						set_planet_flag = tecdawn_has_observer
						create_ambient_object = {
							type = tecdawn_observer
						}
						last_created_ambient_object = {
							set_ambient_object_flag = tecdawn_ae_observer
						}
						create_ambient_object = {
							type = medium_debris_01_object
						}
						last_created_ambient_object = {
							set_ambient_object_flag = tecdawn_ae_debris
						}
						set_planet_flag = tecdawn_debris
					}
					else = {
					#	limit = {
					#		uninhabitable_regular_planet = yes
					#	}
						
						if = {
							limit = { 
								host_has_dlc = "Ancient Relics Story Pack"
							}
							change_pc = pc_relic
							relic_world_deposits = yes
							add_deposit = d_black_soil
							add_deposit = d_fungal_caves
							
						}
						else = {
							change_pc = pc_nuked
							reroll_planet = yes
						}
						set_planet_size = 22
						set_planet_flag = tecdawn_precursor_planet_@root
						root = {
							set_country_flag = tecdawn_planet_@prev
						}
						set_planet_flag = tecdawn_has_observer
						create_ambient_object = {
							type = tecdawn_observer
						}
						last_created_ambient_object = {
							set_ambient_object_flag = tecdawn_ae_observer
						}
						create_ambient_object = {
							type = medium_debris_01_object
						}
						last_created_ambient_object = {
							set_ambient_object_flag = tecdawn_ae_debris
						}
						set_planet_flag = tecdawn_debris
					}
				}
			}
		}
	}
}

# ENDING B - On survey
ship_event = {
	id = tecdawn.10260
	is_triggered_only = yes
	picture = GFX_evt_star_chart

	trigger = {
		from = {
			has_planet_flag = tecdawn_precursor_planet_@root.owner
			solar_system = {
				has_star_flag = tecdawn_precursor_system_@root.owner
			}
			root.owner = {
				has_country_flag = tecdawn_souless_ending
			}
		}
	}

	title = tecdawn.10260.name

	desc = tecdawn.10260.desc

	option = {
		name = tecdawn.10260.a
	}

	after = {
		from = {
			create_archaeological_site = site_tecdawn_ghosts
		}
	}
}

# ENDING A DIGSITE
fleet_event = {
	id = tecdawn.8010
	#archaeology_window = yes
	title = "tecdawn.8010.name"
	desc = "tecdawn.8010.desc"
	picture = GFX_evt_city_ruins
	show_sound = event_wind_ruins
	location = from

	archaeology = yes

	is_triggered_only = yes

	immediate = {
		fromfrom = { set_site_progress_locked = yes }
	}

	after = { 
		fromfrom = { set_site_progress_locked = no }
	}
	

	option = {
		name = "tecdawn.8010.a"
		medium_artifact_reward = yes
	}
}

fleet_event = {
	id = tecdawn.8011
	#archaeology_window = yes
	title = "tecdawn.8011.name"
	desc = "tecdawn.8011.desc"
	picture = GFX_evt_city_ruins
	show_sound = event_wind_ruins
	location = from

	archaeology = yes

	is_triggered_only = yes

	immediate = {
		fromfrom = { set_site_progress_locked = yes }
	}

	after = { 
		fromfrom = { set_site_progress_locked = no }
	}
	

	option = {
		name = "tecdawn.8011.a"
		medium_artifact_reward = yes
	}
}

fleet_event = {
	id = tecdawn.8012
	#archaeology_window = yes
	title = "tecdawn.8012.name"
	desc = "tecdawn.8012.desc"
	picture = GFX_evt_excavation_team
	show_sound = event_wind_ruins
	location = from

	archaeology = yes

	is_triggered_only = yes

	immediate = {
		fromfrom = { set_site_progress_locked = yes }
	}

	after = { 
		fromfrom = { set_site_progress_locked = no }
	}
	

	option = {
		name = "tecdawn.8012.a"
		tecdawn_big_alloys_reward = yes
		medium_artifact_reward = yes
	}
}


fleet_event = {
	id = tecdawn.8013
	#archaeology_window = yes
	title = "tecdawn.8013.name"
	desc = "tecdawn.8013.desc"
	picture = GFX_evt_sapient_AI
	show_sound = event_finding_loot
	location = from

	archaeology = yes

	is_triggered_only = yes

	immediate = {
		fromfrom = { set_site_progress_locked = yes }
	}

	after = { 
		fromfrom = { set_site_progress_locked = no }
	}
	

	option = {
		name = "tecdawn.8013.a"
		large_artifact_reward = yes
		root.owner = {
			hidden_effect = {
				end_event_chain = tecdawn_precursor_planet_chain
				set_country_flag = tecdawn_can_use_dawnengine_small
				set_country_flag = tecdawn_can_use_dawnengine_small
				set_variable = {
					which = tecdawn_engine_uses
					value = 3
				}
				country_event = {
					id = tecdawn.10270	#Chose what to do with the machine and get the modifier
					days = 60
				}
				if = {
					limit = { 
						is_machine_empire = yes
					}
					country_event = {
						id = tecdawn.10280	#Machine civic magic
						days = @tecdawn1year
					}
				}
			}
		}
	}
}

country_event = {
	id = tecdawn.10270
	title = "tecdawn.10270.name"
	desc = "tecdawn.10270.desc"
	picture = GFX_evt_sapient_AI
	show_sound = event_finding_loot
	is_triggered_only = yes

	option = {
		name = tecdawn.10270.a
		add_modifier = {
			modifier = tecdawn_ending_researchbot
		}
	}

	option = {
		name = tecdawn.10270.b
		add_modifier = {
			modifier = tecdawn_ending_producebot
		}
	}

	option = {
		name = tecdawn.10270.c
		add_modifier = {
			modifier = tecdawn_ending_assemblybot
		}
	}

	option = {
		name = tecdawn.10270.d
		add_modifier = {
			modifier = tecdawn_ending_storedbot
		}
		trigger = {
			is_gestalt = no
		}
	}
}

country_event = {
	id = tecdawn.10280
	title = "tecdawn.10280.name"
	desc = "tecdawn.10280.desc"
	picture = GFX_evt_machine_sapience
	show_sound = event_mystic_reveal
	is_triggered_only = yes

	option = {
		name = tecdawn.10280.a
	}

	option = {
		name = tecdawn.10280.b
		trigger = {
			is_machine_empire = yes
			has_valid_civic = civic_machine_terminator
		}
		force_remove_civic = civic_machine_terminator
	}

	option = {
		name = tecdawn.10280.c
		trigger = {
			is_machine_empire = yes
			NOT = {
				has_valid_civic = civic_machine_servitor
			}
		}
		force_add_civic = civic_machine_servitor
		hidden_effect = {
			force_remove_civic = civic_machine_terminator
			force_remove_civic = civic_machine_assimilator
		}
	}

	option = {
		name = tecdawn.10280.d
		trigger = {
			is_machine_empire = yes
			NOT = {
				has_valid_civic = civic_machine_assimilator
			}
		}
		force_add_civic = civic_machine_assimilator
		hidden_effect = {
			force_remove_civic = civic_machine_terminator
			force_remove_civic = civic_machine_servitor
		}
	}

	
}


# Ending 3: The last resort tecdawn.10200 
# Unexpected host
country_event = {
	id = tecdawn.10300
	title = "tecdawn.10300.name"
	desc = "tecdawn.10300.desc"
	picture = GFX_evt_sapient_AI
	show_sound = relic_activation_isolated_contingency_core

	is_triggered_only = yes

	option = {
		name = tecdawn.10300.a
		hidden_effect = {
			set_country_flag = tecdawn_attempted_to_run
			country_event = { id = tecdawn.10310 }
		}
	}
	option = {
		name = tecdawn.10300.b
		hidden_effect = {
			set_country_flag = tecdawn_attempted_to_shoot
			country_event = { id = tecdawn.10310 }
		}
	}
	option = {
		name = tecdawn.10300.c
		hidden_effect = {
			set_country_flag = tecdawn_attempted_to_nothing
			country_event = { id = tecdawn.10310 }
		}
	}
}

# E3 Unexpected host 10310
country_event = {
	id = tecdawn.10310 
	title = "tecdawn.10310.name"
	
	picture = GFX_evt_sapient_AI
	show_sound = event_radio_chatter

	is_triggered_only = yes

	desc = {
		text = tecdawn.10310.desc.a
		trigger = {
			has_country_flag = tecdawn_attempted_to_run
		}
	}

	desc = {
		text = tecdawn.10310.desc.b
		trigger = {
			has_country_flag = tecdawn_attempted_to_shoot
		}
	}

	desc = {
		text = tecdawn.10310.desc.c
		trigger = {
			has_country_flag = tecdawn_attempted_to_nothing
		}
	}

	option = {
		name = tecdawn.10310.a
		hidden_effect = {
			country_event = { 
				id = tecdawn.10330 
			}
		}
	}
}

# E3 Incoming Transmission 10330
country_event = {
	id = tecdawn.10330 
	title = "TRANSMISSION"
	desc = "tecdawn.10330.desc"

	diplomatic = yes

	picture_event_data = {
		room = no_video_feed_room
	}

	is_triggered_only = yes

	option = {
		name = tecdawn.10330.a
		response_text = tecdawn.10330.a.response
		is_dialog_only = yes
	}
	option = {
		name = tecdawn.10330.b
		response_text = tecdawn.10330.b.response
		is_dialog_only = yes
	}
	option = {
		name = tecdawn.10330.c
		response_text = tecdawn.10330.c.response
		is_dialog_only = yes
	}
	option = {
		name = tecdawn.10330.d
		response_text = tecdawn.10330.d.response
		is_dialog_only = yes
	}
	option = {
		name = tecdawn.10330.e
		country_event = {
			id = tecdawn.10340
		}
		break = yes
	}
}



# E3 Incoming Transmission  II
country_event = {
	id = tecdawn.10340
	title = "TRANSMISSION"
	desc = "tecdawn.10340.desc"

	diplomatic = yes

	picture_event_data = {
		portrait = tecdawn_crisis_1
	#	room = no_video_feed_room
	}

	is_triggered_only = yes

	option = {
		name = tecdawn.10340.a
		hidden_effect = {
			country_event = {
				id = tecdawn.10341
			}
			break = yes
		}
	}
}

#2
country_event = {
	id = tecdawn.10341
	title = "TRANSMISSION"
	desc = "tecdawn.10340.a.response"

	diplomatic = yes

	picture_event_data = {
		portrait = tecdawn_crisis_1
	#	room = no_video_feed_room
	}

	is_triggered_only = yes

	option = {
		name = tecdawn.10340.a
		response_text = tecdawn.10340.a.response
		is_dialog_only = yes
	}

	option = {
		name = tecdawn.10340.b
		hidden_effect = {
			country_event = {
				id = tecdawn.10342
			}
		}
	}
}

#3
country_event = {
	id = tecdawn.10342
	title = "TRANSMISSION"
	desc = "tecdawn.10340.b.response"

	diplomatic = yes

	picture_event_data = {
		portrait = tecdawn_crisis_1
	#	room = no_video_feed_room
	}

	is_triggered_only = yes

	option = {
		name = tecdawn.10340.a
		response_text = tecdawn.10340.a.response
		is_dialog_only = yes
	}
	option = {
		name = tecdawn.10340.b
		response_text = tecdawn.10340.b.response
		is_dialog_only = yes
	}
	option = {
		name = tecdawn.10340.c
		hidden_effect = {
			country_event = {
				id = tecdawn.10343
			}
		}
	}
}

#4
country_event = {
	id = tecdawn.10343
	title = "TRANSMISSION"
	desc = "tecdawn.10340.c.response"

	diplomatic = yes

	picture_event_data = {
		portrait = tecdawn_crisis_1
	#	room = no_video_feed_room
	}

	is_triggered_only = yes

	option = {
		name = tecdawn.10340.a
		response_text = tecdawn.10340.a.response
		is_dialog_only = yes
	}
	option = {
		name = tecdawn.10340.b
		response_text = tecdawn.10340.b.response
		is_dialog_only = yes
	}
	option = {
		name = tecdawn.10340.c
		response_text = tecdawn.10340.c.response
		is_dialog_only = yes
	}
	option = {
		name = tecdawn.10340.d
	}
}




# 1 year after finishing digsite
# Spawn the system
country_event = {
	id = tecdawn.10350
	title = tecdawn.10350.name
	desc = tecdawn.10350.desc
	picture = GFX_evt_ruined_system
	show_sound = event_mystic_reveal
	is_triggered_only = yes

	option = {
		name = tecdawn.10350.a
	}
	after = {
		begin_event_chain = {
			event_chain = tecdawn_precursor_planet_chain
		}
		hidden_effect = {
			if = {
				limit = {
					any_system_within_border = { 
						OR = {
							has_star_flag = tecdawn_first_system
							has_star_flag = tecdawn_second_system
							has_star_flag = tecdawn_third_system
						}
					}
				}
				random_system_within_border = {
					limit = { 
						OR = {
							has_star_flag = tecdawn_first_system
							has_star_flag = tecdawn_second_system
							has_star_flag = tecdawn_third_system
						}
					}
					random_list = {
						10  = { 
							spawn_system = {
								min_distance = 10
								max_distance = 30
								max_jumps = 0
								initializer = "random_empire_init_01"
							}
						}
						10  = { 
							spawn_system = {
								min_distance = 10
								max_distance = 30
								max_jumps = 0
								initializer = "random_empire_init_02"
							}
						}
						10  = { 
							spawn_system = {
								min_distance = 10
								max_distance = 30
								max_jumps = 0
								initializer = "random_empire_init_03"
							}
						}
						10  = { 
							spawn_system = {
								min_distance = 10
								max_distance = 30
								max_jumps = 0
								initializer = "random_empire_init_04"
							}
						}
						10  = { 
							spawn_system = {
								min_distance = 10
								max_distance = 30
								max_jumps = 0
								initializer = "random_empire_init_05"
							}
						}
						10  = { 
							spawn_system = {
								min_distance = 10
								max_distance = 30
								max_jumps = 0
								initializer = "random_empire_init_06"
							}
						}
					}
				}
			}
			else = {
				random_system = {
					limit = { 
						has_owner = yes
						owner = {
							is_same_value = root
						}
					}
					random_list = {
						10  = { 
							spawn_system = {
								min_distance = 10
								max_distance = 30
								max_jumps = 0
								initializer = "random_empire_init_01"
							}
						}
						10  = { 
							spawn_system = {
								min_distance = 10
								max_distance = 30
								max_jumps = 0
								initializer = "random_empire_init_02"
							}
						}
						10  = { 
							spawn_system = {
								min_distance = 10
								max_distance = 30
								max_jumps = 0
								initializer = "random_empire_init_03"
							}
						}
						10  = { 
							spawn_system = {
								min_distance = 10
								max_distance = 30
								max_jumps = 0
								initializer = "random_empire_init_04"
							}
						}
						10  = { 
							spawn_system = {
								min_distance = 10
								max_distance = 30
								max_jumps = 0
								initializer = "random_empire_init_05"
							}
						}
						10  = { 
							spawn_system = {
								min_distance = 10
								max_distance = 30
								max_jumps = 0
								initializer = "random_empire_init_06"
							}
						}
					}
					
				}
			}
			last_created_system = {
				set_star_flag = tecdawn_precursor_system_@root
				random_system_planet = {
					limit = {
						NOR = {
							is_star = yes
							is_planet_class = pc_black_hole
							is_asteroid = yes
						}
					}
					save_event_target_as = tecdawn_precursor_planet_target
					root  = {
						create_point_of_interest = {
							id = tecdawn_precursor_planet
							name =  "tecdawn_precursor_planet.name"
							desc = "tecdawn_precursor_planet.desc"
							event_chain = tecdawn_precursor_planet_chain
							location = event_target:tecdawn_precursor_planet_target
						}
					}
					if = {
						limit = { 
							habitable_planet = yes
						}
						
						if = {
							limit = { 
								host_has_dlc = "Ancient Relics Story Pack"
							}
							change_pc = pc_relic
							reroll_planet = yes
							add_deposit = d_black_soil			# Food for variety, useless but...
							add_deposit = d_fungal_caves

						}
						else = {
							change_pc = pc_nuked
							reroll_planet = yes
						}
						set_planet_size = 22
						set_planet_flag = tecdawn_precursor_planet_@root
						root = {
							set_country_flag = tecdawn_planet_@prev
						}
						set_planet_flag = tecdawn_has_observer
						create_ambient_object = {
							type = tecdawn_observer
						}
						last_created_ambient_object = {
							set_ambient_object_flag = tecdawn_ae_observer
						}
						create_ambient_object = {
							type = medium_debris_01_object
						}
						last_created_ambient_object = {
							set_ambient_object_flag = tecdawn_ae_debris
						}
						set_planet_flag = tecdawn_debris
					}
					else = {
					#	limit = {
					#		uninhabitable_regular_planet = yes
					#	}
						
						if = {
							limit = { 
								host_has_dlc = "Ancient Relics Story Pack"
							}
							change_pc = pc_relic
							relic_world_deposits = yes
							add_deposit = d_black_soil
							add_deposit = d_fungal_caves
							
						}
						else = {
							change_pc = pc_nuked
							reroll_planet = yes
						}
						set_planet_size = 22
						set_planet_flag = tecdawn_precursor_planet_@root
						root = {
							set_country_flag = tecdawn_planet_@prev
						}
						set_planet_flag = tecdawn_has_observer
						create_ambient_object = {
							type = tecdawn_observer
						}
						last_created_ambient_object = {
							set_ambient_object_flag = tecdawn_ae_observer
						}
						create_ambient_object = {
							type = medium_debris_01_object
						}
						last_created_ambient_object = {
							set_ambient_object_flag = tecdawn_ae_debris
						}
						set_planet_flag = tecdawn_debris
					}
				}
			}
		}
	}
}



# ENDING C - On survey
ship_event = {
	id = tecdawn.10360
	is_triggered_only = yes
	picture = GFX_evt_star_chart

	trigger = {
		from = {
			has_planet_flag = tecdawn_precursor_planet_@root.owner
			solar_system = {
				has_star_flag = tecdawn_precursor_system_@root.owner
			}
		}
		root.owner = {
			has_country_flag = tecdawn_lastresort_ending
		}
	}

	title = tecdawn.10360.name

	desc = tecdawn.10360.desc

	option = {
		name = tecdawn.10360.a
	}

	after = {
		from = {
			create_archaeological_site = site_tecdawn_home
		}
	}
}

# ENDING C DIGSITE
fleet_event = {
	id = tecdawn.7010
	#archaeology_window = yes
	title = "tecdawn.7010.name"
	desc = "tecdawn.7010.desc"
	picture = GFX_evt_dead_city
	show_sound = event_wind_ruins
	location = from

	archaeology = yes

	is_triggered_only = yes

	immediate = {
		fromfrom = { set_site_progress_locked = yes }
	}

	after = { 
		fromfrom = { set_site_progress_locked = no }
	}
	

	option = {
		name = "tecdawn.8010.a"
		medium_artifact_reward = yes
	}
}

fleet_event = {
	id = tecdawn.7011
	#archaeology_window = yes
	title = "tecdawn.7011.name"
	desc = "tecdawn.7011.desc"
	picture = GFX_evt_tecdawn_digsite
	show_sound = event_finding_loot
	location = from

	archaeology = yes

	is_triggered_only = yes

	immediate = {
		fromfrom = { set_site_progress_locked = yes }
	}

	after = { 
		fromfrom = { set_site_progress_locked = no }
	}
	

	option = {
		name = "tecdawn.7011.a"
		medium_artifact_reward = yes
	}
}

fleet_event = {
	id = tecdawn.7012
	#archaeology_window = yes
	title = "tecdawn.7012.name"
	desc = "tecdawn.7012.desc"
	picture = GFX_evt_clones
	show_sound = event_finding_loot
	location = from

	archaeology = yes

	is_triggered_only = yes

	immediate = {
		fromfrom = { set_site_progress_locked = yes }
	}

	after = { 
		fromfrom = { set_site_progress_locked = no }
	}
	

	option = {
		name = "tecdawn.7012.a"
		medium_artifact_reward = yes
	}
}

fleet_event = {
	id = tecdawn.7013
	#archaeology_window = yes
	title = "tecdawn.7013.name"
	desc = "tecdawn.7013.desc"
	picture = GFX_evt_resource_cache
	show_sound = event_finding_loot
	location = from

	archaeology = yes

	is_triggered_only = yes

	immediate = {
		fromfrom = { set_site_progress_locked = yes }
	}

	after = { 
		fromfrom = { set_site_progress_locked = no }
	}
	

	option = {
		name = "tecdawn.7013.a"
		tecdawn_big_alloys_reward = yes
		large_artifact_reward = yes
		root.owner = {
			add_modifier = {
				modifier = tecdawn_last_resort_bonus
			}
			hidden_effect = {
				end_event_chain = tecdawn_precursor_planet_chain
				set_country_flag = tecdawn_can_use_dawnengine_small
				remove_point_of_interest = tecdawn_precursor_planet
				set_country_flag = tecdawn_can_use_dawnengine_small
				set_variable = {
					which = tecdawn_engine_uses
					value = 3
				}
				country_event = {
					id = tecdawn.10370	#Gains 10 pops and districts
					days = @tecdawn1year
				}
			}
		}
	}
}



country_event = {
	id = tecdawn.10370
	title = "tecdawn.10370.name"
	desc = "tecdawn.10370.desc"
	picture = GFX_evt_alien_cavemen
	show_sound = event_finding_loot
	is_triggered_only = yes

	option = {
		name = tecdawn.10370.a
	}

	after = {
		hidden_effect = {
			random_owned_planet = {
				limit = {
					has_planet_flag = tecdawn_precursor_planet_@root
				}
				planet_event = {
					id = tecdawn.403
				}
				while = {
					count = 10
					create_pop = {
						species = root
					}
				}
				if = {
					limit = { 
						owner = {
							is_hive_empire = yes	
						}
					}
					add_district = district_hive
					add_district = district_mining
					add_district = district_generator
					add_district = district_generator
				}
				if = {
					limit = { 
						owner = {
							is_regular_empire = yes	
						}
					}
					add_district = district_city
					add_district = district_city
					add_district = district_generator
					add_district = district_generator
					add_district = district_generator
				}
				if = {
					limit = { 
						owner = {
							is_machine_empire = yes	
						}
					}
					add_district = district_nexus
					add_district = district_mining
					add_district = district_generator
					add_district = district_generator

				}
			}
		}
		
	}
}







# Ending 4: The Dawn Engine  WIP NOT FOR THE FINAL RELEASE- MAY BE SCRAPPED

country_event = {
	id = tecdawn.20000
	hide_window = yes
#	title = "tecdawn.20000.name"
#	desc = "tecdawn.20000.desc"
	picture = GFX_evt_gray_goo_ships
	show_sound = event_the_great_awakening

	is_triggered_only = yes

#	option = {
#		name = tecdawn.20000.a
#	}
}


# Incoming Transmission - BAD
country_event = {
	id = tecdawn.20900
	title = "TRANSMISSION"
	desc = "tecdawn.20900.desc"

	diplomatic = yes

	picture_event_data = {
		portrait = tecdawn_crisis_1
	#	room = no_video_feed_room
	}

	is_triggered_only = yes

	option = {
		name = tecdawn.20900.a
		hidden_effect = {
			country_event = {
				id = tecdawn.20902
			}
			break = yes
		}
	}
}

#2
country_event = {
	id = tecdawn.20902
	title = "TRANSMISSION"
	desc = "tecdawn.20900.a.response"

	diplomatic = yes

	picture_event_data = {
		portrait = tecdawn_crisis_1
	#	room = no_video_feed_room
	}

	is_triggered_only = yes

	option = {
		name = tecdawn.20900.a
		response_text = tecdawn.20900.a.response
		is_dialog_only = yes
	}

	option = {
		name = tecdawn.20900.b
		hidden_effect = {
			country_event = {
				id = tecdawn.20903
			}
		}
	}
}

#3
country_event = {
	id = tecdawn.20903
	title = "TRANSMISSION"
	desc = "tecdawn.20900.b.response"

	diplomatic = yes

	picture_event_data = {
		portrait = tecdawn_crisis_1
	#	room = no_video_feed_room
	}

	is_triggered_only = yes

	option = {
		name = tecdawn.20900.a
		response_text = tecdawn.20900.a.response
		is_dialog_only = yes
	}
	option = {
		name = tecdawn.20900.b
		response_text = tecdawn.20900.b.response
		is_dialog_only = yes
	}
	option = {
		name = tecdawn.20900.c
		hidden_effect = {
			country_event = {
				id = tecdawn.20904
			}
		}
	}
}

#4
country_event = {
	id = tecdawn.20904
	title = "TRANSMISSION"
	desc = "tecdawn.20900.c.response"

	diplomatic = yes

	picture_event_data = {
		portrait = tecdawn_crisis_1
	#	room = no_video_feed_room
	}

	is_triggered_only = yes

	option = {
		name = tecdawn.20900.a
		response_text = tecdawn.20900.a.response
		is_dialog_only = yes
	}
	option = {
		name = tecdawn.20900.b
		response_text = tecdawn.20900.b.response
		is_dialog_only = yes
	}
	option = {
		name = tecdawn.20900.c
		response_text = tecdawn.20900.c.response
		is_dialog_only = yes
	}
	option = {
		name = tecdawn.20900.d
		hidden_effect = {
			country_event = {
				id = tecdawn.20905
			}
		}
	}
}


#5
country_event = {
	id = tecdawn.20905
	title = "TRANSMISSION"
	desc = "tecdawn.20900.d.response"

	diplomatic = yes

	picture_event_data = {
		portrait = tecdawn_crisis_1
	#	room = no_video_feed_room
	}

	is_triggered_only = yes

	option = {
		name = tecdawn.20900.a
		response_text = tecdawn.20900.a.response
		is_dialog_only = yes
	}
	option = {
		name = tecdawn.20900.b
		response_text = tecdawn.20900.b.response
		is_dialog_only = yes
	}
	option = {
		name = tecdawn.20900.c
		response_text = tecdawn.20900.c.response
		is_dialog_only = yes
	}
	option = {
		name = tecdawn.20900.d
		response_text = tecdawn.20900.d.response
		is_dialog_only = yes
	}
	option = {
		name = tecdawn.20900.e
		hidden_effect = {
			country_event = {
				id = tecdawn.20906
			}
		}
	}
}

#6
country_event = {
	id = tecdawn.20906
	title = "TRANSMISSION"
	desc = "tecdawn.20900.e.response"

	diplomatic = yes

	picture_event_data = {
		portrait = tecdawn_crisis_1
	#	room = no_video_feed_room
	}

	is_triggered_only = yes

	option = {
		name = tecdawn.20900.a
		response_text = tecdawn.20900.a.response
		is_dialog_only = yes
	}
	option = {
		name = tecdawn.20900.b
		response_text = tecdawn.20900.b.response
		is_dialog_only = yes
	}
	option = {
		name = tecdawn.20900.c
		response_text = tecdawn.20900.c.response
		is_dialog_only = yes
	}
	option = {
		name = tecdawn.20900.d
		response_text = tecdawn.20900.d.response
		is_dialog_only = yes
	}
	option = {
		name = tecdawn.20900.e
		response_text = tecdawn.20900.e.response
		is_dialog_only = yes
	}
	option = {
		name = tecdawn.20900.f
		trigger = {
			OR = {
				has_valid_civic = civic_fanatic_purifiers
				has_valid_civic = civic_machine_terminator
				has_valid_civic = civic_hive_devouring_swarm
			}
		}
		hidden_effect = {
			country_event = {
				id = tecdawn.20907
			}
		}
	}
	option = {
		trigger = {
			NOR = {
				has_valid_civic = civic_fanatic_purifiers
				has_valid_civic = civic_machine_terminator
				has_valid_civic = civic_hive_devouring_swarm
			}
		}
		name = tecdawn.20900.g
	}
}



#6
country_event = {
	id = tecdawn.20907
	title = "TRANSMISSION"
	desc = "tecdawn.20900.f.response"

	diplomatic = yes

	picture_event_data = {
		portrait = tecdawn_crisis_1
	#	room = no_video_feed_room
	}

	is_triggered_only = yes

	option = {
		name = tecdawn.20900.g
	}
}







# Incoming Transmission - BAD
country_event = {
	id = tecdawn.26900
	title = "TRANSMISSION"
	desc = "tecdawn.26900.desc"

	diplomatic = yes

	picture_event_data = {
		portrait = tecdawn_crisis_1
	#	room = no_video_feed_room
	}

	is_triggered_only = yes

	option = {
		name = tecdawn.26900.a
		hidden_effect = {
			country_event = {
				id = tecdawn.26902
			}
			break = yes
		}
	}
}

#2
country_event = {
	id = tecdawn.26902
	title = "TRANSMISSION"
	desc = "tecdawn.26900.a.response"

	diplomatic = yes

	picture_event_data = {
		portrait = tecdawn_crisis_1
	#	room = no_video_feed_room
	}

	is_triggered_only = yes

	option = {
		name = tecdawn.26900.a
		response_text = tecdawn.26900.a.response
		is_dialog_only = yes
	}

	option = {
		name = tecdawn.26900.b
		hidden_effect = {
			country_event = {
				id = tecdawn.26903
			}
		}
	}
}

#3
country_event = {
	id = tecdawn.26903
	title = "TRANSMISSION"
	desc = "tecdawn.26900.b.response"

	diplomatic = yes

	picture_event_data = {
		portrait = tecdawn_crisis_1
	#	room = no_video_feed_room
	}

	is_triggered_only = yes

	option = {
		name = tecdawn.26900.a
		response_text = tecdawn.26900.a.response
		is_dialog_only = yes
	}
	option = {
		name = tecdawn.26900.b
		response_text = tecdawn.26900.b.response
		is_dialog_only = yes
	}
	option = {
		name = tecdawn.26900.c
		hidden_effect = {
			country_event = {
				id = tecdawn.26904
			}
		}
	}
}

#4
country_event = {
	id = tecdawn.26904
	title = "TRANSMISSION"
	desc = "tecdawn.26900.c.response"

	diplomatic = yes

	picture_event_data = {
		portrait = tecdawn_crisis_1
	#	room = no_video_feed_room
	}

	is_triggered_only = yes

	option = {
		name = tecdawn.26900.a
		response_text = tecdawn.26900.a.response
		is_dialog_only = yes
	}
	option = {
		name = tecdawn.26900.b
		response_text = tecdawn.26900.b.response
		is_dialog_only = yes
	}
	option = {
		name = tecdawn.26900.c
		response_text = tecdawn.26900.c.response
		is_dialog_only = yes
	}
	option = {
		name = tecdawn.26900.d
		hidden_effect = {
			country_event = {
				id = tecdawn.26905
			}
		}
	}
}

#5
country_event = {
	id = tecdawn.26905
	title = "TRANSMISSION"
	desc = "tecdawn.26900.d.response"

	diplomatic = yes

	picture_event_data = {
		portrait = tecdawn_crisis_1
	#	room = no_video_feed_room
	}

	is_triggered_only = yes

	option = {
		name = tecdawn.26900.a
		response_text = tecdawn.26900.a.response
		is_dialog_only = yes
	}
	option = {
		name = tecdawn.26900.b
		response_text = tecdawn.26900.b.response
		is_dialog_only = yes
	}
	option = {
		name = tecdawn.26900.c
		response_text = tecdawn.26900.c.response
		is_dialog_only = yes
	}
	option = {
		name = tecdawn.26900.d
		response_text = tecdawn.26900.d.response
		is_dialog_only = yes
	}
	option = {
		name = tecdawn.26900.e
	}
}









# Dawn engine managements (add relic, removes relic)
country_event = {
	id = tecdawn.90800
	title = "graygoo.10.name"
	desc = "graygoo.13.desc"
	picture = GFX_evt_gray_goo_ships
	show_sound = event_radio_chatter

	is_triggered_only = yes

	option = {
		name = tecdawn.10200.a
	}
}


