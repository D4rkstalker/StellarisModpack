# Filename:		scluster_tech_overwrites.txt
# Contributors:	SirBlackAxe

# tech_wormhole_stabilization:ai_weight - Now scales w/ number of owned wormhole systems

tech_wormhole_stabilization = {
	cost = @tier3cost1
	area = physics
	tier = 3
	category = { particles }
	is_rare = yes
	is_reverse_engineerable = no
	weight = @tier3weight1
	prerequisites = { "tech_hyper_drive_2" }

	feature_flags = { wormhole_stabilization }

	weight_modifier = {
		factor = 0.5
		modifier = {
			factor = 0.5
			NOR = {
				has_trait_in_council = { TRAIT = leader_trait_expertise_particles }
				has_trait_in_council = { TRAIT = leader_trait_curator }
				has_trait_in_council = { TRAIT = leader_trait_spark_of_genius }
				has_trait_in_council = { TRAIT = leader_trait_spark_of_genius_2 }
				has_trait_in_council = { TRAIT = leader_trait_maniacal }
				has_trait_in_council = { TRAIT = leader_trait_maniacal_2 }
				has_trait_in_council = { TRAIT = leader_trait_maniacal_3 }
			}
		}
		modifier = {
			factor = 1.25
			has_tradition = tr_discovery_adopt
		}
		modifier = {
			factor = @ap_technological_ascendancy_rare_tech
			has_ascension_perk = ap_technological_ascendancy
		}
		modifier = {
			factor = @ap_grasp_the_void_travel_tech
			has_ascension_perk = ap_grasp_the_void
		}
		modifier = {
			factor = @eager_explorer_effect
			is_eager_explorer_empire = yes
		}
		modifier = {
			factor = @federation_perk_factor
			has_federation = yes
			federation = {
				has_federation_perk = rare_tech_boost
				any_member = { has_technology = tech_wormhole_stabilization }
			}
		}
		modifier = {
			factor = value:tech_weight_likelihood
			has_trait_in_council = { TRAIT = leader_trait_expertise_particles }
		}
		modifier = {
			factor = 0
			NOR = {
				has_seen_any_bypass = wormhole
				any_relation = {
					is_country_type = default
					has_communications = ROOT
					has_technology = tech_wormhole_stabilization
				}
			}
		}
		modifier = {
			factor = 4
			owns_any_bypass = wormhole
		}
		modifier = {
			factor = 10
			mid_game_years_passed > 0
			exists = event_target:chosen_empire
			is_same_value = event_target:chosen_empire
		}
	}

	ai_weight = {
		complex_trigger_modifier = { # Added: Better the more wormholes you have.
			trigger = count_system_within_border
			# potential = { owns_any_bypass = wormhole }
			parameters = { limit = { has_natural_wormhole = yes } }
			mult = 0.25
			# add = 1 # Error: "Unexpected token: add
			mode = add
		}
		modifier = {
			factor = 1.25
			has_trait_in_council = { TRAIT = leader_trait_expertise_particles }
		}
		modifier = { # Added: If we can't expand anywhere else, let's try here.
			factor = 2
			owns_any_bypass = wormhole
			has_ai_expansion_plan = no
			# Also if corporate (find more cutomers?)
		}
		modifier = { # Added: Getting into the Storm Cluster is better if you do it earlier
			factor = 2
			has_global_flag = scluster_in_progress
			any_system_within_border = { has_star_flag = scluster_entrance }
		}
		modifier = {
			factor = 100
			mid_game_years_passed > 0
			has_country_flag = chosen_empire
		}
		# Reduced if Isolationist?
		# Also want to be able to use allies' wormholes, not just owned ones.
	}
}
