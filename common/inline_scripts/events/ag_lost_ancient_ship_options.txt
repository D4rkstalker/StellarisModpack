
# 特殊对话，摧毁Z星域防御系统
option = {
	name = "ag_lost_ancient_ship_dialog.option.01"
	response_text = "ag_lost_ancient_ship_dialog.response.01"
	is_dialog_only = yes
	trigger = { hidden_trigger = { has_country_flag = ag_lost_ancient_ship_zeta_guardian_destroyed_recent } }
	allow = { hidden_trigger = { NOT = { has_country_flag = ag_lost_ancient_ship_zeta_guardian_destroyed_response } } }
	hidden_effect = { set_country_flag = ag_lost_ancient_ship_zeta_guardian_destroyed_response }
}
option = {
	name = "ag_lost_ancient_ship_dialog.option.02"
	response_text = "ag_lost_ancient_ship_dialog.response.02"
	is_dialog_only = yes
	trigger = { hidden_trigger = { has_country_flag = ag_lost_ancient_ship_zeta_guardian_destroyed_recent } }
	allow = { hidden_trigger = { NOT = { has_country_flag = ag_lost_ancient_ship_zeta_guardian_destroyed_response } } }
	hidden_effect = { set_country_flag = ag_lost_ancient_ship_zeta_guardian_destroyed_response }
}
# ->科研船
option = {
	name = "ag_side.31.a"
	response_text = "ag_side.31.a.response"
	trigger = { hidden_trigger = {
		NOT = { has_country_flag = ag_lost_ancient_ship_science_ship_form_active }
		NOT = { has_country_flag = ag_lost_ancient_ship_scientist_active }
	} }
	allow = { ag_lost_ancient_ship_action_basic_check = yes }
	hidden_effect = { ag_lost_ancient_ship_to_science_ship = yes }
}
option = {
	name = "ag_side.31.a"
	response_text = "ag_side.31.a.response_alt"
	trigger = { hidden_trigger = {
		NOT = { has_country_flag = ag_lost_ancient_ship_science_ship_form_active }
		has_country_flag = ag_lost_ancient_ship_scientist_active
	} }
	allow = { ag_lost_ancient_ship_action_basic_check = yes }
	hidden_effect = { ag_lost_ancient_ship_to_science_ship = yes }
}
# ->战列舰
option = {
	name = "ag_side.32.a"
	response_text = "ag_side.32.a.response"
	trigger = { hidden_trigger = {
		NOT = { has_country_flag = ag_lost_ancient_ship_battleship_form_active }
		has_country_flag = ag_lost_ancient_ship_science_ship_form_active
	} }
	allow = { ag_lost_ancient_ship_action_basic_check = yes }
	hidden_effect = { ag_lost_ancient_ship_to_battleship = yes }
}
option = {
	name = "ag_side.32.a"
	response_text = "ag_side.32.a.response_alt"
	trigger = { hidden_trigger = {
		NOT = { has_country_flag = ag_lost_ancient_ship_battleship_form_active }
		NOT = { has_country_flag = ag_lost_ancient_ship_science_ship_form_active }
	} }
	allow = { ag_lost_ancient_ship_action_basic_check = yes }
	hidden_effect = { ag_lost_ancient_ship_to_battleship = yes }
}
# ->科学家
option = {
	name = "ag_side.31.to_sci"
	response_text = "ag_side.31.to_sci.response"
	trigger = { hidden_trigger = {
		NOT = { has_country_flag = ag_lost_ancient_ship_scientist_active }
		NOT = { has_country_flag = ag_lost_ancient_ship_admiral_active }
	} }
	allow = { ag_lost_ancient_ship_action_basic_check = yes }
	hidden_effect = { ag_lost_ancient_ship_to_scientist = yes }
}
option = {
	name = "ag_side.31.to_sci"
	response_text = "ag_side.31.to_sci.response_alt"
	trigger = { hidden_trigger = {
		NOT = { has_country_flag = ag_lost_ancient_ship_scientist_active }
		has_country_flag = ag_lost_ancient_ship_admiral_active
	} }
	allow = { ag_lost_ancient_ship_action_basic_check = yes }
	hidden_effect = { ag_lost_ancient_ship_to_scientist = yes }
}
# ->舰队司令
option = {
	name = "ag_side.31.to_adm"
	response_text = "ag_side.31.to_adm.response"
	trigger = { hidden_trigger = {
		NOT = { has_country_flag = ag_lost_ancient_ship_admiral_active }
		NOT = { has_country_flag = ag_lost_ancient_ship_scientist_active }
	} }
	allow = { ag_lost_ancient_ship_action_basic_check = yes }
	hidden_effect = { ag_lost_ancient_ship_to_admiral = yes }
}
option = {
	name = "ag_side.31.to_adm"
	response_text = "ag_side.31.to_adm.response_alt"
	trigger = { hidden_trigger = {
		NOT = { has_country_flag = ag_lost_ancient_ship_admiral_active }
		has_country_flag = ag_lost_ancient_ship_scientist_active
	} }
	allow = { ag_lost_ancient_ship_action_basic_check = yes }
	hidden_effect = { ag_lost_ancient_ship_to_admiral = yes }
}
# 更换FTL引擎
option = {
	name = "ag_side.31.b"
	trigger = {
		event_target:ag_starlight_2_ship = { is_scope_type = ship }
		OR = {
			has_technology = tech_hyper_drive_1
			has_technology = tech_hyper_drive_2
			has_technology = tech_hyper_drive_3
			has_technology = tech_jump_drive_1
			has_technology = tech_psi_jump_drive_1
			has_country_flag = ag_lost_ancient_ship_restored
		}
	}
	allow = { ag_lost_ancient_ship_action_basic_check = yes }
	hidden_effect = { country_event = { id = ag_side.37 } }
}
# 自动攻击利维坦
option = {
	name = "ag_side.31.d"
	response_text = "ag_side.31.d.response"
	trigger = { hidden_trigger = {
		event_target:ag_starlight_2_ship = { exists = fleet }
		any_country = {
			has_communications = prev.owner
			OR = {
				is_country_type = guardian_dragon
				is_country_type = guardian_fortress
				is_country_type = guardian_stellarite
				is_country_type = guardian_horror
				is_country_type = guardian_hiver
				is_country_type = guardian_sphere
				is_country_type = guardian_dreadnought
				is_country_type = guardian_wraith
				is_country_type = guardian_hatchling
				is_country_type = guardian_scavenger_bot
				is_country_type = guardian_elderly_tiyanki
			}
		}
	} }
	allow = { ag_lost_ancient_ship_action_basic_check = yes }
	hidden_effect = {
		ag_lost_ancient_ship_clear_failed_flags = yes
		event_target:ag_starlight_2_ship.fleet = {
			set_fleet_flag = ag_lost_ancient_ship_targeting_guardians
			fleet_event = { id = ag_side.38 days = 2 random = 3 }
		}
	}
}
# 设置自动攻击利维坦目标
option = {
	name = "ag_side.31.d_target"
	trigger = { hidden_trigger = {
		event_target:ag_starlight_2_ship = { exists = fleet fleet = { has_fleet_flag = ag_lost_ancient_ship_targeting_guardians } }
	} }
	hidden_effect = {
		ag_lost_ancient_ship_clear_guardians_flags = yes
		ag_lost_ancient_ship_set_guardians_flag = yes
		country_event = { id = ag_side.383 }
	}
}
# 停止自动攻击利维坦
option = {
	name = "ag_side.31.d_alt"
	response_text = "ag_side.31.d_alt.response"
	trigger = { hidden_trigger = {
		event_target:ag_starlight_2_ship = { exists = fleet fleet = { has_fleet_flag = ag_lost_ancient_ship_targeting_guardians } }
	} }
	hidden_effect = { event_target:ag_starlight_2_ship.fleet = {
		remove_fleet_flag = ag_lost_ancient_ship_targeting_guardians
		clear_orders = yes
		clear_fleet_actions = this
		auto_move_to_planet = { target = root.capital_scope clear_auto_move_on_arrival = yes }
	} }
}
# 退出界面
option = {
	name = "ag_side.31.c"
	default_hide_option = yes
}
