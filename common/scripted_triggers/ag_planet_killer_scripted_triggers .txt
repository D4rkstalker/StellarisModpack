
can_destroy_planet_with_ag_ancient_epsilon_planet_killer_weapon = {
	custom_tooltip = {
		fail_text = "ag_requires_a_star_star_killer" 
		NOR = {
			is_planet_class = pc_ag_void_star
			is_planet_class = pc_ag_void_planet
		}
	}
	custom_tooltip = {
		fail_text = "ag_requires_is_star_star_killer" 
		OR = {
			AND = {
				from.owner = {
					has_country_flag = ag_ship_subsystem_enabled_501_19
					OR = {
						has_country_flag = ag_epsilon_star_killer_planet_killer_mode
						has_country_flag = ag_epsilon_star_killer_planet_sweeper_mode
					}
				}
				is_star = no
			}
			is_star = yes
		}
	}
	custom_tooltip = {
		fail_text = "ag_requires_no_compact_star_star_killer"
		NOT = { is_planet_class = pc_black_hole }
	}
	custom_tooltip = {
		fail_text = "ag_requires_outside_border_star_killer"
		NOR = {
			AND = {
				from.owner = {
					NOR = {
						has_country_flag = ag_epsilon_star_killer_planet_killer_mode
						has_country_flag = ag_epsilon_star_killer_planet_sweeper_mode
					}
				}
				is_inside_border = from.owner
				solar_system = {
					any_system_planet = {
						OR = {
							is_colony = yes
							is_under_colonization = yes
						}
					}
				}
			}
			AND = {
				from.owner = {
					OR = {
						has_country_flag = ag_epsilon_star_killer_planet_killer_mode
						has_country_flag = ag_epsilon_star_killer_planet_sweeper_mode
					}
				}
				exists = owner
				owner = { is_same_value = from.owner }
			}
		}
	}
	custom_tooltip = {
		fail_text = "ag_requires_declares_war_star_killer"
		OR = {
			AND = {
				from.owner = {
					NOR = {
						has_country_flag = ag_epsilon_star_killer_planet_killer_mode
						has_country_flag = ag_epsilon_star_killer_planet_sweeper_mode
					}
				}
				OR = {
					is_inside_border = from.owner
					solar_system = { NOT = { exists = space_owner } }
					AND = {
						solar_system = {
							exists = space_owner
							space_owner = { NOT = { is_hostile = from.owner } }
						}
					}
				}
			}
			AND = {
				from.owner = {
					OR = {
						has_country_flag = ag_epsilon_star_killer_planet_killer_mode
						has_country_flag = ag_epsilon_star_killer_planet_sweeper_mode
					}
				}
				NAND = {
					exists = owner
					owner = { NOT = { is_hostile = from.owner } }
				}
			}
		}
	}
	custom_tooltip = {
		fail_text = "ag_requires_no_pacifist_star_killer"
		from.owner = {
			NOR = {
				has_ethic = ethic_fanatic_pacifist
				has_ethic = ethic_pacifist
			}
		}
	}
	custom_tooltip = {
		fail_text = "ag_requires_no_ancient_system" 
		ag_is_ancient_system = no
	}
	custom_tooltip = {
		fail_text = "ag_requires_no_zeta_crisis_system" 
		NOT = { has_star_flag = ag_zeta_crisis_core_system }
	}
	custom_tooltip = {
		fail_text = "ag_requires_no_charging_star_killer"
		from = { NOT = { any_owned_ship = {
			is_ship_size = ag_epsilon_titan_1
			has_ship_flag = ag_epsilon_firing_star_killer_weapon
		} } }
	}
}

ag_epsilon_planet_killer_weapon_selector_trigger = {
	OR = {
		hidden_trigger = { root = { NOT = { has_country_flag = ag_enabled_epsilon_planet_killer_selector } } }
		AND = {
			custom_tooltip = {
				fail_text = "ag_requires_a_star_star_killer" 
				event_target:ag_system_selector_marked_system_[[ag_system_seq]$ag_system_seq$] = { NOT = { is_star_class = sc_ag_void } }
			}
			custom_tooltip = {
				fail_text = "ag_requires_no_compact_star_star_killer"
				event_target:ag_system_selector_marked_system_[[ag_system_seq]$ag_system_seq$] = { NOT = { is_star_class = sc_black_hole } }
			}
			custom_tooltip = {
				fail_text = "ag_requires_outside_border_star_killer"
				event_target:ag_system_selector_marked_system_[[ag_system_seq]$ag_system_seq$] = { NAND = {
					is_inside_border = root
					any_system_planet = {
						OR = {
							is_colony = yes
							is_under_colonization = yes
						}
					}
				} }
			}
			custom_tooltip = {
				fail_text = "ag_requires_declares_war_star_killer"
				event_target:ag_system_selector_marked_system_[[ag_system_seq]$ag_system_seq$] = { OR = {
					is_inside_border = root
					NOT = { exists = space_owner }
					AND = {
						exists = space_owner
						space_owner = { NOT = { is_hostile = root } }
					}
				} }
			}
			custom_tooltip = {
				fail_text = "ag_requires_no_ancient_system" 
				event_target:ag_system_selector_marked_system_[[ag_system_seq]$ag_system_seq$] = { ag_is_ancient_system = no }
			}
			custom_tooltip = {
				fail_text = "ag_requires_no_zeta_crisis_system" 
				event_target:ag_system_selector_marked_system_[[ag_system_seq]$ag_system_seq$] = { NOT = { has_star_flag = ag_zeta_crisis_core_system } }
			}
			custom_tooltip = {
				fail_text = "ag_requires_no_too_many_targets" 
				OR = {
					ag_system_selector_system_selected_trigger = { ag_system_seq = $ag_system_seq$ }
					root = { check_variable = { which = ag_num_system_selector_selected_systems value < 5 } }
				}
			}
		}
	}
}

ag_epsilon_star_killer_weapon_confirm = {
	OR = {
		hidden_trigger = { root = { NOT = { has_country_flag = ag_enabled_epsilon_planet_killer_selector } } }
		hidden_trigger = { root = { check_variable = { which = ag_num_system_selector_selected_systems value = 0 } } }
		AND = {
			custom_tooltip = { fail_text = "ag_star_killer_selected_1_targets" root = { check_variable = { which = ag_num_system_selector_selected_systems value = 1 } } }
			resource_stockpile_compare = { resource = energy value >= 10000 }
			resource_stockpile_compare = { resource = sr_dark_matter value >= 1000 }
		}
		AND = {
			custom_tooltip = { fail_text = "ag_star_killer_selected_2_targets" root = { check_variable = { which = ag_num_system_selector_selected_systems value = 2 } } }
			resource_stockpile_compare = { resource = energy value >= 20000 }
			resource_stockpile_compare = { resource = sr_dark_matter value >= 2000 }
		}
		AND = {
			custom_tooltip = { fail_text = "ag_star_killer_selected_3_targets" root = { check_variable = { which = ag_num_system_selector_selected_systems value = 3 } } }
			resource_stockpile_compare = { resource = energy value >= 40000 }
			resource_stockpile_compare = { resource = sr_dark_matter value >= 4000 }
		}
		AND = {
			custom_tooltip = { fail_text = "ag_star_killer_selected_4_targets" root = { check_variable = { which = ag_num_system_selector_selected_systems value = 4 } } }
			resource_stockpile_compare = { resource = energy value >= 80000 }
			resource_stockpile_compare = { resource = sr_dark_matter value >= 8000 }
		}
		AND = {
			custom_tooltip = { fail_text = "ag_star_killer_selected_5_targets" root = { check_variable = { which = ag_num_system_selector_selected_systems value = 5 } } }
			resource_stockpile_compare = { resource = energy value >= 160000 }
			resource_stockpile_compare = { resource = sr_dark_matter value >= 16000 }
		}
	}
}
