@max_jumprange = 9999
quantum_wormhole_node = {
	entity = "natural_wormhole_entity"
	construction_entity = "natural_wormhole_entity"
	portrait = "GFX_megastructure_construction_background"
	place_entity_on_planet_plane = no
	show_galactic_map_icon = no
	potential = {
		always = no
	}
	possible = {
		always = no
	}
	construction_blocks_and_blocked_by = self_type
	bypass_type = quantum_wormhole
}

# Quantum Catapult 3
quantum_catapult_3 = {
	entity = "quantum_catapult_stage_3_entity"
	construction_entity = "quantum_catapult_stage_3_entity"
	portrait = GFX_megastructure_quantum_catapult_background
	place_entity_on_planet_plane = yes
	entity_offset = {
		x = 0
		y = 0
	}
	build_time = 1800
	resources = {
		category = megastructures
		cost = {
			alloys = 10000
		}
		upkeep = {
			energy = 30
		}
	}
	upgrade_from = {
		quantum_catapult_2
	}
	possible = {
		from = {
			has_technology = tech_mega_engineering
		}
	}
	prerequisites = {
		"tech_quantum_catapult"
	}
	show_prereqs = yes
	country_modifier = {
		country_mia_time_mult = -0.3
	}
	station_modifier = {
		catapult_spread_base = 30
		catapult_range_base = @max_jumprange
		quantum_catapult_megastructure_bypass_windup_mult = -0.5
	}
	on_build_complete = {
		from = {
			set_country_flag = has_built_or_repaired_megastructure
			if = {
				limit = {
					has_country_flag = has_created_quantum_gateway
				}
				country_event = {
					id = quantum_events.2
				}
			}
			else = {
				country_event = {
					id = over.10
				}
			}
		}
	}
	bypass_type = quantum_catapult
}

# Quantum Catapult 3
quantum_catapult_4 = {
	entity = "quantum_catapult_stage_3_entity"
	construction_entity = "quantum_catapult_stage_3_entity"
	portrait = GFX_megastructure_construction_background
	place_entity_on_planet_plane = yes
	entity_offset = {
		x = 0
		y = 0
	}
	resources = {
		category = megastructures
		upkeep = {
			energy = 2000
		}
	}
	potential = {
		always = no
	}
	possible = {
		always = no
	}
	country_modifier = {
		country_mia_time_mult = -0.3
	}
	on_build_complete = {
		from = {
			set_country_flag = has_created_quantum_gateway
		}
	}
}

# This dummy is here so that we change from the active Quantum Catapult to this.
quantum_catapult_dummy = {
	entity = ""
	construction_entity = ""
	portrait = GFX_megastructure_construction_background
	place_entity_on_planet_plane = yes
	construction_blocks_and_blocked_by = none
	construction_blocks_others = no
	entity_offset = {
		x = 0
		y = 0
	}
	build_time = 60
	possible = {
		from = {
			has_technology = tech_mega_engineering
		}
	}
	upgrade_from = {
		quantum_catapult_4
	}
	prerequisites = {
		"tech_quantum_catapult"
	}
	show_prereqs = yes
	country_modifier = {
		country_mia_time_mult = -0.3
	}
	on_build_complete = {
		from = {
			remove_country_flag = yeeted_a_fleet
		}
		spawn_megastructure = {
			type = quantum_catapult_3
			coords_from = fromfrom
			owner = root
		}
		remove_megastructure = fromfrom
	}
}

# Restored Quantum Catapult
quantum_catapult_restored = {
	entity = "quantum_catapult_stage_3_entity"
	construction_entity = "quantum_catapult_stage_3_entity"
	portrait = "GFX_megastructure_quantum_catapult_background"
	place_entity_on_planet_plane = yes
	entity_offset = {
		x = 0
		y = 0
	}
	build_time = 3600
	resources = {
		category = megastructures
		cost = {
			alloys = 10000
		}
		upkeep = {
			energy = 40
		}
	}
	upgrade_from = {
		quantum_catapult_ruined
	}
	possible = {
		from = {
			has_technology = tech_mega_engineering
		}
	}
	country_modifier = {
		country_mia_time_mult = -0.3
	}
	station_modifier = {
		catapult_spread_base = 30
		catapult_range_base = @max_jumprange
		quantum_catapult_megastructure_bypass_windup_mult = -0.5
	}
	on_build_start = {
		fromfrom = {
			set_graphical_culture = root.from
		}
	}
	on_build_complete = {
		set_star_flag = quantum_catapult_built
		every_system_ambient_object = {
			limit = {
				OR = {
					is_ambient_object_type = large_debris_object
					is_ambient_object_type = medium_debris_01_object
					is_ambient_object_type = medium_debris_02_object
				}
			}
			destroy_ambient_object = this
		}
		from = {
			set_country_flag = has_built_or_repaired_megastructure
			country_event = {
				id = over.25
			}
			country_event = {
				id = tutorial.2126
			}
		}
	}
	bypass_type = quantum_catapult
}

# Quantum Catapult Improved
quantum_catapult_improved_slingshot = {
	entity = "quantum_catapult_stage_3_entity"
	construction_entity = "quantum_catapult_stage_3_entity"
	portrait = "GFX_megastructure_quantum_catapult_background"
	place_entity_on_planet_plane = yes
	entity_offset = {
		x = 0
		y = 0
	}
	build_time = 3600
	resources = {
		category = megastructures
		cost = {
			alloys = 15000
		}
		upkeep = {
			energy = 40
		}
	}
	upgrade_from = {
		quantum_catapult_restored_slingshot
	}
	possible = {
		from = {
			has_technology = tech_mega_engineering
		}
	}
	prerequisites = {
		"tech_quantum_catapult"
	}
	show_prereqs = no
	country_modifier = {
		country_mia_time_mult = -0.3
	}
	station_modifier = {
		catapult_spread_base = 30
		catapult_range_base = @max_jumprange
		quantum_catapult_megastructure_bypass_windup_mult = -0.5
	}
	on_build_complete = {
		set_star_flag = quantum_catapult_built
		from = {
			set_country_flag = has_built_or_repaired_megastructure
			country_event = {
				id = over.10
			}
		}
	}
	bypass_type = quantum_catapult
}
