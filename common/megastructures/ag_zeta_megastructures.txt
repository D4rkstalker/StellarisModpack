
ag_psionic_portal_megastructure = {
	entity = ""
	construction_entity = ""
	portrait = "GFX_ag_zeta_crisis_psionic_portal"
	place_entity_on_planet_plane = no
	show_galactic_map_icon = no
	entity_offset = { x = 0 y = 0 }
	
	potential = { always = no }

	construction_blocked_by_others = no
	construction_blocks_others = no

	bypass_type = ag_psionic_portal
}
ag_psionic_portal_stabled_megastructure = {
	entity = ""
	construction_entity = ""
	portrait = "GFX_ag_zeta_crisis_psionic_portal_stable"
	place_entity_on_planet_plane = no
	show_galactic_map_icon = no
	entity_offset = { x = 0 y = 0 }
	
	potential = { always = no }
	
	upgrade_from = { ag_psionic_portal_megastructure }

	construction_blocked_by_others = no
	construction_blocks_others = no

	bypass_type = ag_psionic_portal
}

ag_zeta_crisis_relic_psionic_storm_megastructure = {
	entity = "ag_void_entity"
	construction_entity = "ag_void_entity"
	portrait = "GFX_megastructure_construction_background"
	
	place_entity_on_planet_plane = no
	show_galactic_map_icon = no
	
	build_time = 5400
	
	upgrade_desc = hide
	
	entity_offset = { x = 0 y = 0 }
	
	resources = {
		category = megastructures
		cost = {
			sr_living_metal = 13125
			nanites = 3750
			sr_zro = 4500
		}
		cost = {
			trigger = { owner = { NOT = { has_country_flag = ag_ship_subsystem_enabled_704_13 } } }
			sr_living_metal = 4375
			nanites = 1250
			sr_zro = 1500
		}
	}
	
	potential = {
		NOT = { has_global_flag = ag_ancient_empire_mod_shipyard_building }
		has_relic = ag_zeta_crisis_relic
		has_country_flag = ag_zeta_crisis_relic_actived
	}
	
	possible = {
		custom_tooltip = {
			fail_text = "requires_inside_border"
			is_inside_border = from
		}		
		custom_tooltip = {
			fail_text = "requires_surveyed_system"
			NOT = {
				any_system_planet = {
					is_surveyed = {
						who = prev.from
						status = no
					}
				}
			}
		}
		custom_tooltip = {
			fail_text = "ag_requires_usable_ancient_construction_section"
			NOT = {
				any_system_planet = {
					has_planet_flag = ag_using_ancient_construction_section_system
				}
			}
		}
	}
	
	placement_rules = {
		planet_possible = {
			custom_tooltip = {
				fail_text = "ag_requires_ancient_construction_section"
				has_planet_flag = ag_ancient_construction_section
			}
			custom_tooltip = {
				fail_text = "ag_requires_usable_ancient_construction_section"
				NOT = {
					has_planet_flag = has_megastructure
				}
			}
		}
	}
	
	on_build_start = {
	}
	on_build_cancel = {
	}
	on_build_complete = {
		from = { country_event = { id = ag_ancient_knowledge.26 } }
		create_message = {
			type = "MEGASTRUCTURE_BUILT"
			localization = "ag_zeta_psionic_storm_core_built_message_desc"
			days = 30
			target = from
			variable = {
				type = name
				localization = "ag_megastructure_system"
				scope = fromfrom.solar_system
			}
		}
		create_fleet = {
			name = "NAME_ag_ancient_psionic_storm_container_fleet"
			settings = {
				is_boss = yes
				spawn_debris = no 
				can_upgrade = no
				can_change_composition = no
				can_change_leader = no
			}
			effect = {
				set_owner = from
				set_fleet_flag = ag_ancient_psionic_container_player
				create_ship = {
					name = "NAME_ag_ancient_psionic_container_ship"
					design = "NAME_ag_ancient_psionic_container"
					prefix = no
					effect = {
						set_ship_flag = ag_ancient_psionic_storm_container_player
						ag_difficulty_bonus = yes
					}
				}
				set_location = {
					target = fromfrom
					distance = 0
					angle = 0
				}
			}
		}
		remove_megastructure = fromfrom
	}
	construction_blocked_by_others = no
	construction_blocks_others = no
	
	ai_weight = {
		weight = 0
	}
}
ag_zeta_crisis_relic_psionic_singularity_megastructure = {
	entity = "ag_void_entity"
	construction_entity = "ag_void_entity"
	portrait = "GFX_megastructure_construction_background"
	
	place_entity_on_planet_plane = no
	show_galactic_map_icon = no
	
	build_time = 5400
	
	upgrade_desc = hide
	
	entity_offset = { x = 0 y = 0 }
	
	resources = {
		category = megastructures
		cost = {
			sr_living_metal = 13125
			nanites = 3750
			sr_zro = 4500
		}
		cost = {
			trigger = { owner = { NOT = { has_country_flag = ag_ship_subsystem_enabled_704_13 } } }
			sr_living_metal = 4375
			nanites = 1250
			sr_zro = 1500
		}
	}
	
	potential = {
		NOT = { has_global_flag = ag_ancient_empire_mod_shipyard_building }
		has_relic = ag_zeta_crisis_relic
		has_country_flag = ag_zeta_crisis_relic_actived
	}
	
	possible = {
		custom_tooltip = {
			fail_text = "requires_inside_border"
			is_inside_border = from
		}		
		custom_tooltip = {
			fail_text = "requires_surveyed_system"
			NOT = {
				any_system_planet = {
					is_surveyed = {
						who = prev.from
						status = no
					}
				}
			}
		}
		custom_tooltip = {
			fail_text = "ag_requires_usable_ancient_construction_section"
			NOT = {
				any_system_planet = {
					has_planet_flag = ag_using_ancient_construction_section_system
				}
			}
		}
	}
	
	placement_rules = {
		planet_possible = {
			custom_tooltip = {
				fail_text = "ag_requires_ancient_construction_section"
				has_planet_flag = ag_ancient_construction_section
			}
			custom_tooltip = {
				fail_text = "ag_requires_usable_ancient_construction_section"
				NOT = {
					has_planet_flag = has_megastructure
				}
			}
		}
	}
	
	on_build_start = {
	}
	on_build_cancel = {
	}
	on_build_complete = {
		from = { country_event = { id = ag_ancient_knowledge.26 } }
		create_message = {
			type = "MEGASTRUCTURE_BUILT"
			localization = "ag_zeta_psionic_singularity_core_built_message_desc"
			days = 30
			target = from
			variable = {
				type = name
				localization = "ag_megastructure_system"
				scope = fromfrom.solar_system
			}
		}
		create_fleet = {
			name = "NAME_ag_ancient_psionic_singularity_container_fleet"
			settings = {
				is_boss = yes
				spawn_debris = no 
				can_upgrade = no
				can_change_composition = no
				can_change_leader = no
			}
			effect = {
				set_owner = from
				set_fleet_flag = ag_ancient_psionic_container_player
				create_ship = {
					name = "NAME_ag_ancient_psionic_container_ship"
					design = "NAME_ag_ancient_psionic_container_alt"
					prefix = no
					effect = {
						set_ship_flag = ag_ancient_psionic_singularity_container_player
						ag_difficulty_bonus = yes
					}
				}
				set_location = {
					target = fromfrom
					distance = 0
					angle = 0
				}
			}
		}
		remove_megastructure = fromfrom
	}
	construction_blocked_by_others = no
	construction_blocks_others = no
	
	ai_weight = {
		weight = 0
	}
}