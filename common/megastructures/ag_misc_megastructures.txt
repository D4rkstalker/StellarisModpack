
@entity_x = 0
@entity_y = 0

ag_ancient_construction_section = {
	entity = "ag_void_entity"
	construction_entity = "ag_void_entity"
	portrait = "GFX_megastructure_construction_background"
	
	place_entity_on_planet_plane = yes
	show_galactic_map_icon = no
	build_time = 1
	upgrade_desc = hide
	entity_offset = { x = @entity_x y = @entity_y }
	potential = { always = no }
	construction_blocks_and_blocked_by = self_type
	

	resources = {
		category = megastructures
		upkeep = { energy = 25 }
	}
	ship_modifier = {
		ship_starting_experience_add = 11100
	}
	station_modifier = {
		starbase_shipyard_capacity_add = 4
		starbase_shipyard_build_speed_mult = 0.5
		starbase_shipyard_build_cost_mult = -0.10
	}
	
	ai_weight = { weight = 0 }
}

ag_space_mine_field_megastructure = {
	entity = "ag_void_entity"
	construction_entity = "ag_void_entity"
	portrait = "GFX_megastructure_construction_background"
	
	place_entity_on_planet_plane = no
	show_galactic_map_icon = no
	
	build_time = @ag_space_mine_field_megastructure_buildtime
	
	upgrade_desc = hide
	
	entity_offset = { x = 0 y = -20 }
	
	resources = {
		category = megastructures
		cost = {
			energy = @ag_space_mine_field_megastructure_cost_energy
			sr_living_metal = @ag_space_mine_field_megastructure_cost_sr_living_metal
			nanites = @ag_space_mine_field_megastructure_cost_nanites
			sr_dark_matter = @ag_space_mine_field_megastructure_cost_sr_dark_matter
		}
		upkeep = {
			energy = @ag_space_mine_field_megastructure_upkeep_energy
		}
		
	}
	
	potential = { has_technology = tech_ag_space_mine_field }
	
	possible = {
		custom_tooltip = {
			fail_text = "requires_inside_border"
			is_inside_border = from
		}
		custom_tooltip = {
			fail_text = "requires_surveyed_system"
			NOT = { any_system_planet = { is_surveyed = {
				who = prev.from
				status = no
			} } }
		}
		custom_tooltip = {
			fail_text = "ag_requires_tech_ag_space_mine_field"
			from = { has_technology = tech_ag_space_mine_field }
		}
		custom_tooltip = {
			fail_text = "ag_requires_no_existing_space_mine_field"
			NOR = {
				any_fleet_in_system = { has_fleet_flag = ag_space_mine_field_fleet }
				any_system_megastructure = { is_megastructure_type = ag_space_mine_field_megastructure }
			}
		}
	}
	
	placement_rules = {
		planet_possible = {
			custom_tooltip = { fail_text = "must_build_around_star" is_star = yes }
			custom_tooltip = { fail_text = "requires_no_anomaly" NOT = { has_anomaly = yes } }
		}
	}
	
	on_build_start = { }
	on_build_cancel = { }
	on_build_complete = {
		create_message = {
			type = "MEGASTRUCTURE_BUILT"
			localization = "ag_space_mine_field_built_message_desc"
			days = 30
			target = from
			variable = {
				type = name
				localization = "ag_megastructure_system"
				scope = fromfrom.solar_system
			}
		}
		create_fleet = {
			name = "NAME_ag_space_mine_field_fleet"
			settings = {
				is_boss = yes
				can_upgrade = no 
				can_change_composition = no 
				can_change_leader = no 
				spawn_debris = no 
			}
			effect = {
				set_fleet_flag = ag_space_mine_field_fleet
				set_variable = { which = ag_num_mines value = 25 }
				set_owner = from
				create_ship = {
					name = "NAME_ag_space_mine_field_ship"
					design = "NAME_ag_space_mine_field"
					prefix = no
				}
				set_location = { target = fromfrom.planet distance = 0 angle = 0 }
				set_event_locked = yes
			}
		}
		remove_megastructure = fromfrom
	}

	construction_blocks_and_blocked_by = self_type
	
	
	ai_weight = { weight = 0 }
}

spy_orb_4_dummy = {
	entity = "spyorb_phase_04_entity"
	construction_entity = "spyorb_phase_04_construction_entity"
	portrait = "GFX_megastructure_spy_orb_background"
	place_entity_on_planet_plane = no
	entity_offset = { x = -15 y = -15 }
	build_time = 0
	resources = {
		category = megastructures
		upkeep = { energy = 100 }
	}
	potential = { always = no }
	country_modifier = {
		add_base_country_intel = 40
	}
}
spy_orb_restored_dummy = {
	entity = "spyorb_phase_04_entity"
	construction_entity = "spyorb_phase_04_construction_entity"
	portrait = "GFX_megastructure_spy_orb_background"
	place_entity_on_planet_plane = no
	entity_offset = { x = -15 y = -15 }
	build_time = 0
	resources = {
		category = megastructures
		upkeep = { energy = 100 }
	}
	potential = { always = no }
	country_modifier = {
		add_base_country_intel = 40
	}
}
