
@entity_x = 8
@entity_y = 8

ag_ancient_anchor_station_0 = {
	entity = "ag_ancient_anchor_station_0_hull_entity"
	construction_entity = "ag_void_entity"
	portrait = "GFX_ag_anchor_station"
	
	place_entity_on_planet_plane = no
	show_galactic_map_icon = no
	show_in_outliner = no
	
	build_time = 0
	upgrade_desc = hide
	entity_offset = { x = @entity_x y = @entity_y }
	
	resources = {
		category = megastructures
		produces = {
			trigger = {
				exists = owner
				has_global_flag = ag_system_spawn_1
			}
			physics_research = 50
			engineering_research = 50
		}
	}
	
	potential = { always = no }
	construction_blocks_and_blocked_by = self_type
	
	ai_weight = { weight = 0 }
}
ag_ancient_anchor_station_1 = {
	entity = "ag_ancient_anchor_station_1_hull_entity"
	construction_entity = "ag_void_entity"
	portrait = "GFX_ag_anchor_station_alt"
	
	place_entity_on_planet_plane = no
	show_galactic_map_icon = no
	show_in_outliner = no
	
	build_time = 0
	upgrade_desc = hide
	entity_offset = { x = @entity_x y = @entity_y }

	upgrade_from = {
		ag_ancient_anchor_station_0
	}
	
	resources = {
		category = megastructures
		produces = {
			trigger = {
				exists = owner
				has_global_flag = ag_system_spawn_1
			}
			physics_research = 50
			engineering_research = 50
		}
	}
	
	potential = { always = no }
	construction_blocks_and_blocked_by = self_type
	
	ai_weight = { weight = 0 }
}
ag_ancient_anchor_station_2 = {
	entity = "ag_ancient_anchor_station_1_hull_entity"
	construction_entity = "ag_void_entity"
	portrait = "GFX_ag_anchor_station_alt"
	
	place_entity_on_planet_plane = no
	show_galactic_map_icon = no
	show_in_outliner = yes
	
	build_time = @ag_ancient_anchor_station_2_buildtime
	upgrade_desc = hide
	entity_offset = { x = @entity_x y = @entity_y }

	upgrade_from = {
		ag_ancient_anchor_station_1
	}
	
	resources = {
		category = megastructures
		cost = {
			energy = @ag_ancient_anchor_station_2_cost_energy
			sr_dark_matter = @ag_ancient_anchor_station_2_cost_sr_dark_matter
		}
		produces = {
			trigger = { exists = owner }
			physics_research = @ag_ancient_anchor_station_2_produces_physics_research
			engineering_research = @ag_ancient_anchor_station_2_produces_engineering_research
		}
	}

	country_modifier = {
		ship_ftl_jumpdrive_range_mult = 0.050
		ship_jumpdrive_cooldown_mult = -0.025
	}
	
	prerequisites = { tech_ag_ancient_anchor_station }

	on_build_complete = {
		random_list = {
			# Good result
			75 = {
				if = {
					limit = { exists = event_target:ag_ancient_wandering_ship_fleet }
					event_target:ag_ancient_wandering_ship_fleet = {
						change_variable = { which = ag_num_disabled_anchor_stations value = 1 }
						if = {
							limit = { check_variable = { which = ag_num_disabled_anchor_stations value = 6 } }
							add_modifier = { modifier = "ag_ancient_wandering_ship_debuff_1" days = -1 }
						}
						else_if = {
							limit = { check_variable = { which = ag_num_disabled_anchor_stations value = 7 } }
							add_modifier = { modifier = "ag_ancient_wandering_ship_debuff_2" days = -1 }
						}
						else_if = {
							limit = { check_variable = { which = ag_num_disabled_anchor_stations value = 8 } }
							add_modifier = { modifier = "ag_ancient_wandering_ship_debuff_3" days = -1 }
						}
						else_if = {
							limit = { check_variable = { which = ag_num_disabled_anchor_stations value = 9 } }
							add_modifier = { modifier = "ag_ancient_wandering_ship_debuff_4" days = -1 }
						}
						else_if = {
							limit = { check_variable = { which = ag_num_disabled_anchor_stations value = 10 } }
							add_modifier = { modifier = "ag_ancient_wandering_ship_debuff_5" days = -1 }
						}
					}
					from = { country_event = { id = ag_wanderer.65 } }
					fromfrom.solar_system = { save_event_target_as = ag_target_system }
					every_country = {
						limit = { NOT = { is_same_value = from } }
						if = {
							limit = { has_event_chain = ag_ancient_anchor_station_chain }
							country_event = { id = ag_wanderer.66 }
						}
						else = { country_event = { id = ag_wanderer.68 } }
					}
				}
				else = {
					from = { country_event = { id = ag_wanderer.67 } }
					every_country = {
						limit = { NOT = { is_same_value = from } }
						country_event = { id = ag_wanderer.68 }
					}
				}
			}
			# Bad result, anchor station turn into hostile
			25 = {
				ag_create_ancient_guardian = {
					ag_country_name = "NAME_ag_ancient_anchor_station_guardian"
					ag_country_type = ag_ancient_anchor_station_country
				}
				last_created_country = {
					set_country_flag = ag_ancient_anchor_station_country
					save_event_target_as = ag_ancient_anchor_station_country
					ag_ancient_country_friendly_to_each_other = yes
				}
				ag_ancient_anchor_station_spawn = yes
				every_country = {
					limit = { NOT = { has_communications = event_target:ag_ancient_anchor_station_country } }
					establish_communications_no_message = event_target:ag_ancient_anchor_station_country
				}
				from = { country_event = { id = ag_wanderer.71 } }
				fromfrom.solar_system = { save_event_target_as = ag_target_system }
				remove_megastructure = fromfrom
			}
		}
	}

	potential = { has_global_flag = ag_wanderer_ship_spawned }
	construction_blocks_and_blocked_by = self_type
	
	ai_weight = {
		weight = 25
		modifier = {
			factor = 0.4
			starbase = { NOT = { has_starbase_size >= starbase_starfortress } }
		}
		modifier = {
			factor = 0.1
			any_neighbor_system = {
				exists = owner
				owner = { NOT = { is_same_value = from } }
			}
		}
		modifier = {
			factor = 0
			from = { fleet_power < 1000000 }
		}
	}
}

ag_ancient_wandering_ship_megastructure_0 = {
	entity = "construction_platform_entity"
	construction_entity = "construction_platform_entity"
	portrait = "GFX_megastructure_construction_background"
	
	place_entity_on_planet_plane = no
	show_galactic_map_icon = yes
	show_in_outliner = yes
	
	build_time = @ag_ancient_wandering_ship_megastructure_0_buildtime
	upgrade_desc = hide
	entity_offset = { x = @entity_x y = @entity_y }
	
	resources = {
		category = megastructures
		cost = {
			alloys = @ag_ancient_wandering_ship_megastructure_0_cost_alloys
			influence = @ag_ancient_wandering_ship_megastructure_0_cost_influence
		}
		upkeep = { energy = @ag_ancient_wandering_ship_megastructure_0_upkeep_energy }
	}
	
	potential = {
		has_technology = tech_ag_ancient_wandering_ship
	}
	
	possible = {
		custom_tooltip = {
			fail_text = "requires_inside_border"
			is_inside_border = from
		}		
		custom_tooltip = {
			fail_text = "requires_surveyed_system"
			NOT = {
				any_system_planet = {
					is_surveyed = {
						who = prev.from
						status = no
					}
				}
			}
		}
		custom_tooltip = {
			fail_text = "ag_requires_tech_ag_ancient_wandering_ship"
			from = { has_technology = tech_ag_ancient_wandering_ship }
		}
		custom_tooltip = {
			fail_text = "ag_requires_no_existing_ag_ancient_wandering_ship"
			from = {
				NOR = {
					any_controlled_ship = {
						OR = {
							is_ship_size = ag_ancient_wandering_ship_0
							is_ship_size = ag_ancient_wandering_ship_1
						}
					}
					any_owned_megastructure = {
						OR = {
							is_megastructure_type = ag_ancient_wandering_ship_megastructure_0
							is_megastructure_type = ag_ancient_wandering_ship_megastructure_1
							is_megastructure_type = ag_ancient_wandering_ship_megastructure_2
							is_megastructure_type = ag_ancient_wandering_ship_megastructure_3
							is_megastructure_type = ag_ancient_wandering_ship_megastructure_4
							is_megastructure_type = ag_ancient_wandering_ship_megastructure_5
						}
					}
					has_special_project = ag_structural_protection_system_2601
				}
			}
		}
		# custom_tooltip = {
		# 	fail_text = "ag_requires_usable_ancient_construction_section"
		# 	NOT = {
		# 		any_system_planet = {
		# 			has_planet_flag = ag_using_ancient_construction_section_system
		# 		}
		# 	}
		# }
	}
	
	placement_rules = {
		planet_possible = {
			ag_is_construction_section = yes
			custom_tooltip = {
				fail_text = "ag_requires_usable_ancient_construction_section"
				NOT = {
					has_planet_flag = has_megastructure
				}
			}
		}
	}
	
	on_build_start = { }
	on_build_cancel = { }
	on_build_complete = {
		fromfrom.planet = { set_planet_flag = has_megastructure }
		from = { country_event = { id = ag_wanderer.121 } }
		every_country = {
			limit = { NOT = { is_same_value = from } }
			country_event = { id = ag_wanderer.127 }
		}
	}

	construction_blocks_and_blocked_by = self_type
	
	
	ai_weight = { weight = 1000 }
}
ag_ancient_wandering_ship_megastructure_1 = {
	entity = "ag_ancient_wandering_ship_part_1_entity"
	construction_entity = "ag_ancient_wandering_ship_part_1_construction_entity"
	portrait = "GFX_megastructure_construction_background"
	
	place_entity_on_planet_plane = no
	show_galactic_map_icon = yes
	show_in_outliner = yes
	
	build_time = @ag_ancient_wandering_ship_megastructure_1_buildtime
	upgrade_desc = hide
	entity_offset = { x = @entity_x y = @entity_y }
	
	upgrade_from = {
		ag_ancient_wandering_ship_megastructure_0
	}
	
	resources = {
		category = megastructures
		cost = {
			sr_living_metal = @ag_ancient_wandering_ship_megastructure_1_cost_sr_living_metal
			nanites = @ag_ancient_wandering_ship_megastructure_1_cost_nanites
			sr_dark_matter = @ag_ancient_wandering_ship_megastructure_1_cost_sr_dark_matter
		}
		upkeep = { energy = @ag_ancient_wandering_ship_megastructure_1_upkeep_energy }
	}
	
	potential = {
		has_technology = tech_ag_ancient_wandering_ship
	}
	
	possible = {
		custom_tooltip = {
			fail_text = "ag_requires_tech_ag_ancient_wandering_ship"
			from = { has_technology = tech_ag_ancient_wandering_ship }
		}
		custom_tooltip = {
			fail_text = "ag_requires_no_existing_ag_ancient_wandering_ship"
			from = {
				NOR = {
					any_controlled_ship = {
						OR = {
							is_ship_size = ag_ancient_wandering_ship_0
							is_ship_size = ag_ancient_wandering_ship_1
						}
					}
					any_owned_megastructure = {
						OR = {
							is_megastructure_type = ag_ancient_wandering_ship_megastructure_1
							is_megastructure_type = ag_ancient_wandering_ship_megastructure_2
							is_megastructure_type = ag_ancient_wandering_ship_megastructure_3
							is_megastructure_type = ag_ancient_wandering_ship_megastructure_4
							is_megastructure_type = ag_ancient_wandering_ship_megastructure_5
						}
					}
					has_special_project = ag_structural_protection_system_2601
				}
			}
		}
		# custom_tooltip = {
		# 	fail_text = "ag_requires_usable_ancient_construction_section"
		# 	NOT = {
		# 		any_system_planet = {
		# 			has_planet_flag = ag_using_ancient_construction_section_system
		# 		}
		# 	}
		# }
	}
	
	on_build_start = {}
	on_build_cancel = {}
	on_build_complete = {
		if = {
			limit = { fromfrom = { has_megastructure_flag = ag_auto_upgrade_megastructure } }
			system_event = { id = ag_ancient.251 days = 1 scopes = { from = root.fromfrom } }
		}
		else = { from = { country_event = { id = ag_wanderer.122 } } }
		from = { country_event = { id = ag_ancient_knowledge.26 } }
	}

	construction_blocks_and_blocked_by = self_type
	
	
	ai_weight = { weight = 1000 }
}
ag_ancient_wandering_ship_megastructure_2 = {
	entity = "ag_ancient_wandering_ship_part_2_entity"
	construction_entity = "ag_ancient_wandering_ship_part_2_construction_entity"
	portrait = "GFX_megastructure_construction_background"
	
	place_entity_on_planet_plane = no
	show_galactic_map_icon = yes
	show_in_outliner = yes
	
	build_time = @ag_ancient_wandering_ship_megastructure_2_buildtime
	upgrade_desc = hide
	entity_offset = { x = @entity_x y = @entity_y }
	
	upgrade_from = {
		ag_ancient_wandering_ship_megastructure_1
	}
	
	resources = {
		category = megastructures
		cost = {
			sr_living_metal = @ag_ancient_wandering_ship_megastructure_2_cost_sr_living_metal
			nanites = @ag_ancient_wandering_ship_megastructure_2_cost_nanites
			sr_dark_matter = @ag_ancient_wandering_ship_megastructure_2_cost_sr_dark_matter
		}
		upkeep = { energy = @ag_ancient_wandering_ship_megastructure_2_upkeep_energy }
	}
	
	potential = {
		has_technology = tech_ag_ancient_wandering_ship
	}
	
	possible = {
		custom_tooltip = {
			fail_text = "ag_requires_tech_ag_ancient_wandering_ship"
			from = { has_technology = tech_ag_ancient_wandering_ship }
		}
		custom_tooltip = {
			fail_text = "ag_requires_no_existing_ag_ancient_wandering_ship"
			from = {
				NOR = {
					any_controlled_ship = {
						OR = {
							is_ship_size = ag_ancient_wandering_ship_0
							is_ship_size = ag_ancient_wandering_ship_1
						}
					}
					any_owned_megastructure = {
						OR = {
							is_megastructure_type = ag_ancient_wandering_ship_megastructure_0
							is_megastructure_type = ag_ancient_wandering_ship_megastructure_2
							is_megastructure_type = ag_ancient_wandering_ship_megastructure_3
							is_megastructure_type = ag_ancient_wandering_ship_megastructure_4
							is_megastructure_type = ag_ancient_wandering_ship_megastructure_5
						}
					}
					has_special_project = ag_structural_protection_system_2601
				}
			}
		}
		# custom_tooltip = {
		# 	fail_text = "ag_requires_usable_ancient_construction_section"
		# 	NOT = {
		# 		any_system_planet = {
		# 			has_planet_flag = ag_using_ancient_construction_section_system
		# 		}
		# 	}
		# }
	}
	
	on_build_start = {}
	on_build_cancel = {}
	on_build_complete = {
		if = {
			limit = { fromfrom = { has_megastructure_flag = ag_auto_upgrade_megastructure } }
			system_event = { id = ag_ancient.251 days = 1 scopes = { from = root.fromfrom } }
		}
		else = { from = { country_event = { id = ag_wanderer.123 } } }
		from = { country_event = { id = ag_ancient_knowledge.26 } }
	}

	construction_blocks_and_blocked_by = self_type
	
	
	ai_weight = { weight = 1000 }
}
ag_ancient_wandering_ship_megastructure_3 = {
	entity = "ag_ancient_wandering_ship_part_3_entity"
	construction_entity = "ag_ancient_wandering_ship_part_3_construction_entity"
	portrait = "GFX_megastructure_construction_background"
	
	place_entity_on_planet_plane = no
	show_galactic_map_icon = yes
	show_in_outliner = yes
	
	build_time = @ag_ancient_wandering_ship_megastructure_3_buildtime
	upgrade_desc = hide
	entity_offset = { x = @entity_x y = @entity_y }
	
	upgrade_from = {
		ag_ancient_wandering_ship_megastructure_2
	}
	
	resources = {
		category = megastructures
		cost = {
			sr_living_metal = @ag_ancient_wandering_ship_megastructure_3_cost_sr_living_metal
			nanites = @ag_ancient_wandering_ship_megastructure_3_cost_nanites
		}
		upkeep = { energy = @ag_ancient_wandering_ship_megastructure_3_upkeep_energy }
	}
	
	potential = {
		has_technology = tech_ag_ancient_wandering_ship
	}
	
	possible = {
		custom_tooltip = {
			fail_text = "ag_requires_tech_ag_ancient_wandering_ship"
			from = { has_technology = tech_ag_ancient_wandering_ship }
		}
		custom_tooltip = {
			fail_text = "ag_requires_no_existing_ag_ancient_wandering_ship"
			from = {
				NOR = {
					any_controlled_ship = {
						OR = {
							is_ship_size = ag_ancient_wandering_ship_0
							is_ship_size = ag_ancient_wandering_ship_1
						}
					}
					any_owned_megastructure = {
						OR = {
							is_megastructure_type = ag_ancient_wandering_ship_megastructure_0
							is_megastructure_type = ag_ancient_wandering_ship_megastructure_1
							is_megastructure_type = ag_ancient_wandering_ship_megastructure_3
							is_megastructure_type = ag_ancient_wandering_ship_megastructure_4
							is_megastructure_type = ag_ancient_wandering_ship_megastructure_5
						}
					}
					has_special_project = ag_structural_protection_system_2601
				}
			}
		}
		# custom_tooltip = {
		# 	fail_text = "ag_requires_usable_ancient_construction_section"
		# 	NOT = {
		# 		any_system_planet = {
		# 			has_planet_flag = ag_using_ancient_construction_section_system
		# 		}
		# 	}
		# }
	}
	
	on_build_start = {}
	on_build_cancel = {}
	on_build_complete = {
		if = {
			limit = { fromfrom = { has_megastructure_flag = ag_auto_upgrade_megastructure } }
			system_event = { id = ag_ancient.251 days = 1 scopes = { from = root.fromfrom } }
		}
		else = { from = { country_event = { id = ag_wanderer.124 } } }
		from = { country_event = { id = ag_ancient_knowledge.26 } }
	}

	construction_blocks_and_blocked_by = self_type
	
	
	ai_weight = { weight = 1000 }
}
ag_ancient_wandering_ship_megastructure_4 = {
	entity = "ag_ancient_wandering_ship_part_4_entity"
	construction_entity = "ag_ancient_wandering_ship_part_4_construction_entity"
	portrait = "GFX_megastructure_construction_background"
	
	place_entity_on_planet_plane = no
	show_galactic_map_icon = yes
	show_in_outliner = yes
	
	build_time = @ag_ancient_wandering_ship_megastructure_4_buildtime
	upgrade_desc = hide
	entity_offset = { x = @entity_x y = @entity_y }
	
	upgrade_from = {
		ag_ancient_wandering_ship_megastructure_3
	}
	
	resources = {
		category = megastructures
		cost = {
			sr_living_metal = @ag_ancient_wandering_ship_megastructure_4_cost_sr_living_metal
			nanites = @ag_ancient_wandering_ship_megastructure_4_cost_nanites
			sr_dark_matter = @ag_ancient_wandering_ship_megastructure_4_cost_sr_dark_matter
		}
		upkeep = { energy = @ag_ancient_wandering_ship_megastructure_4_upkeep_energy }
	}
	
	potential = {
		has_technology = tech_ag_ancient_wandering_ship
	}
	
	possible = {
		custom_tooltip = {
			fail_text = "ag_requires_tech_ag_ancient_wandering_ship"
			from = { has_technology = tech_ag_ancient_wandering_ship }
		}
		custom_tooltip = {
			fail_text = "ag_requires_no_existing_ag_ancient_wandering_ship"
			from = {
				NOR = {
					any_controlled_ship = {
						OR = {
							is_ship_size = ag_ancient_wandering_ship_0
							is_ship_size = ag_ancient_wandering_ship_1
						}
					}
					any_owned_megastructure = {
						OR = {
							is_megastructure_type = ag_ancient_wandering_ship_megastructure_0
							is_megastructure_type = ag_ancient_wandering_ship_megastructure_1
							is_megastructure_type = ag_ancient_wandering_ship_megastructure_2
							is_megastructure_type = ag_ancient_wandering_ship_megastructure_4
							is_megastructure_type = ag_ancient_wandering_ship_megastructure_5
						}
					}
					has_special_project = ag_structural_protection_system_2601
				}
			}
		}
		# custom_tooltip = {
		# 	fail_text = "ag_requires_usable_ancient_construction_section"
		# 	NOT = {
		# 		any_system_planet = {
		# 			has_planet_flag = ag_using_ancient_construction_section_system
		# 		}
		# 	}
		# }
	}
	
	on_build_start = {}
	on_build_cancel = {}
	on_build_complete = {
		if = {
			limit = { fromfrom = { has_megastructure_flag = ag_auto_upgrade_megastructure } }
			system_event = { id = ag_ancient.251 days = 1 scopes = { from = root.fromfrom } }
		}
		else = { from = { country_event = { id = ag_wanderer.125 } } }
		from = { country_event = { id = ag_ancient_knowledge.26 } }
	}

	construction_blocks_and_blocked_by = self_type
	
	
	ai_weight = { weight = 1000 }
}
ag_ancient_wandering_ship_megastructure_5 = {
	entity = "ag_ancient_wandering_ship_part_5_entity"
	construction_entity = "ag_ancient_wandering_ship_part_5_construction_entity"
	portrait = "GFX_megastructure_construction_background"
	
	place_entity_on_planet_plane = no
	show_galactic_map_icon = yes
	show_in_outliner = yes
	
	build_time = @ag_ancient_wandering_ship_megastructure_5_buildtime
	upgrade_desc = hide
	entity_offset = { x = @entity_x y = @entity_y }
	
	upgrade_from = {
		ag_ancient_wandering_ship_megastructure_4
	}
	
	resources = {
		category = megastructures
		cost = {
			sr_living_metal = @ag_ancient_wandering_ship_megastructure_5_cost_sr_living_metal
			nanites = @ag_ancient_wandering_ship_megastructure_5_cost_nanites
			sr_dark_matter = @ag_ancient_wandering_ship_megastructure_5_cost_sr_dark_matter
		}
		upkeep = { energy = @ag_ancient_wandering_ship_megastructure_5_upkeep_energy }
	}

	potential = {
		has_technology = tech_ag_ancient_wandering_ship
	}
	
	possible = {
		custom_tooltip = {
			fail_text = "ag_requires_tech_ag_ancient_wandering_ship"
			from = { has_technology = tech_ag_ancient_wandering_ship }
		}
		custom_tooltip = {
			fail_text = "ag_requires_no_existing_ag_ancient_wandering_ship"
			from = {
				NOR = {
					any_controlled_ship = {
						OR = {
							is_ship_size = ag_ancient_wandering_ship_0
							is_ship_size = ag_ancient_wandering_ship_1
						}
					}
					any_owned_megastructure = {
						OR = {
							is_megastructure_type = ag_ancient_wandering_ship_megastructure_0
							is_megastructure_type = ag_ancient_wandering_ship_megastructure_1
							is_megastructure_type = ag_ancient_wandering_ship_megastructure_2
							is_megastructure_type = ag_ancient_wandering_ship_megastructure_3
							is_megastructure_type = ag_ancient_wandering_ship_megastructure_5
						}
					}
					has_special_project = ag_structural_protection_system_2601
				}
			}
		}
		# custom_tooltip = {
		# 	fail_text = "ag_requires_usable_ancient_construction_section"
		# 	NOT = {
		# 		any_system_planet = {
		# 			has_planet_flag = ag_using_ancient_construction_section_system
		# 		}
		# 	}
		# }
	}
	
	on_build_start = {}
	on_build_cancel = {}
	on_build_complete = {
		from = { if = { limit = { is_ai = yes } country_event = { id = ag_wanderer.102 days = 3600 random = 1800 } } }
		fromfrom.planet = { remove_planet_flag = has_megastructure }
		from = { country_event = { id = ag_wanderer.126 } country_event = { id = ag_ancient_knowledge.26 } }
		add_threat = { who = from amount = 50 }
		if = {
			limit = { from = { NOT = { has_country_flag = ag_wandering_ships_unlocked } } }
			ag_ancient_wandering_ship_player_spawn = {
				ag_unlock_ship = no
				ag_owner = from
				ag_location_target = fromfrom
			}
		}
		else = {
			ag_ancient_wandering_ship_player_spawn = {
				ag_unlock_ship = yes
				ag_owner = from
				ag_location_target = fromfrom
			}
		}
		remove_megastructure = fromfrom
		every_country = {
			limit = { NOT = { is_same_value = from } }
			country_event = { id = ag_wanderer.128 }
		}
	}

	construction_blocks_and_blocked_by = self_type
	
	
	ai_weight = { weight = 1000 }
}

ag_ancient_anchor_station_player = {
	entity = "ag_ancient_anchor_station_1_hull_entity"
	construction_entity = "ag_ancient_anchor_station_1_hull_entity"
	portrait = "GFX_ag_anchor_station_alt"
	
	place_entity_on_planet_plane = no
	show_galactic_map_icon = no
	show_in_outliner = yes
	
	build_time = 2160
	upgrade_desc = hide
	entity_offset = { x = @entity_x y = @entity_y }
	
	resources = {
		category = megastructures
		cost = {
			sr_living_metal = @ag_ancient_anchor_station_player_cost_sr_living_metal
			nanites = @ag_ancient_anchor_station_player_cost_nanites
			sr_dark_matter = @ag_ancient_anchor_station_player_cost_sr_dark_matter
			energy = @ag_ancient_anchor_station_player_cost_energy
		}
		produces = {
			trigger = { exists = owner }
			physics_research = @ag_ancient_anchor_station_player_produces_physics_research
			engineering_research = @ag_ancient_anchor_station_player_produces_engineering_research
		}
	}

	country_modifier = {
		ship_ftl_jumpdrive_range_mult = 0.050
		ship_jumpdrive_cooldown_mult = -0.025
	}
	
	prerequisites = { tech_ag_ancient_anchor_station_mega }
	
	potential = { has_technology = tech_ag_ancient_anchor_station_mega }
	possible = {
		custom_tooltip = {
			fail_text = "requires_inside_border"
			is_inside_border = from
		}		
		custom_tooltip = {
			fail_text = "requires_surveyed_system"
			NOT = {
				any_system_planet = {
					is_surveyed = {
						who = prev.from
						status = no
					}
				}
			}
		}
		custom_tooltip = {
			fail_text = "ag_requires_no_existing_more_than_5_stellar_anchors"
			count_megastructure = {
				limit = { OR = {
					is_megastructure_type = ag_ancient_anchor_station_0
					is_megastructure_type = ag_ancient_anchor_station_1
					is_megastructure_type = ag_ancient_anchor_station_2
					is_megastructure_type = ag_ancient_anchor_station_player
				} }
				count < 5
			}
		}
		custom_tooltip = {
			fail_text = "ag_requires_no_existing_stellar_anchor_in_system"
			NOR = {
				has_megastructure = ag_ancient_anchor_station_0
				has_megastructure = ag_ancient_anchor_station_1
				has_megastructure = ag_ancient_anchor_station_2
				has_megastructure = ag_ancient_anchor_station_player
			}
		}
		# custom_tooltip = {
		# 	fail_text = "ag_requires_usable_ancient_construction_section"
		# 	NOT = {
		# 		any_system_planet = {
		# 			has_planet_flag = ag_using_ancient_construction_section_system
		# 		}
		# 	}
		# }
	}
	placement_rules = {
		planet_possible = {
			ag_is_construction_section = yes
			custom_tooltip = {
				fail_text = "ag_requires_usable_ancient_construction_section"
				NOR = { has_planet_flag = has_megastructure has_planet_flag = ag_has_megastructure }
			}
		}
	}

	on_build_complete = {
		from = {
			create_message = {
				type = "MEGASTRUCTURE_BUILT"
				localization = "ag_anchor_station_built_message_desc"
				days = 30
				target = fromfrom
				variable = {
					type = name
					localization = "ag_megastructure_system"
					scope = fromfrom.solar_system
				}
			}
			country_event = { id = ag_ancient_knowledge.26 }
		}
		fromfrom.planet = { set_planet_flag = ag_has_megastructure }
	}

	construction_blocks_and_blocked_by = self_type
	
	ai_weight = { weight = 0 }
}