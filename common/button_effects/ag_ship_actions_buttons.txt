
ag_ship_action_button = {
	potential = { hidden_trigger = { is_scope_type = fleet } }
	allow = { hidden_trigger = { exists = owner owner = { is_same_value = from NOT = { has_country_flag = ag_ship_action_menu_opened } } } }
	effect = { ag_ship_action_button_effect = yes }
}

ag_action_alpha_titan_event_no_effect = {
	potential = { hidden_trigger = {
		is_scope_type = fleet exists = owner owner = { is_same_value = root.from } has_fleet_flag = ag_ship_action_target_@owner
		from = { NOT = { has_country_flag = ag_alpha_titan_action_available } }
	} }
	allow = { always = yes }
	effect = { custom_tooltip = "ag_action_no_effect" }
}
ag_action_alpha_titan_event_ancient_record = {
	potential = { hidden_trigger = {
		is_scope_type = fleet exists = owner owner = { is_same_value = root.from } has_fleet_flag = ag_ship_action_target_@owner
		from = { has_country_flag = ag_alpha_titan_action_available }
	} }
	allow = { hidden_trigger = { always = yes } }
	effect = {
		custom_tooltip = "ag_action_alpha_titan_event_ancient_record_effect"
		hidden_effect = { from = { country_event = { id = ag_alpha.24 } } }
		ag_close_action_window = yes
	}
}
ag_action_alpha_titan_event_system_locator = {
	potential = { hidden_trigger = {
		is_scope_type = fleet exists = owner owner = { is_same_value = root.from } has_fleet_flag = ag_ship_action_target_@owner
		from = { has_country_flag = ag_alpha_titan_action_available has_country_flag = ag_alpha_titan_system_locator_available }
	} }
	allow = { hidden_trigger = { always = yes } }
	effect = {
		custom_tooltip = "ag_action_alpha_titan_event_system_locator_effect"
		hidden_effect = { from = { country_event = { id = ag_alpha.32 } } }
		ag_close_action_window = yes
	}
}
ag_action_alpha_titan_activate_psionic_conduit = {
	potential = { hidden_trigger = {
		is_scope_type = fleet exists = owner owner = { is_same_value = root.from } has_fleet_flag = ag_ship_action_target_@owner
		from = { has_country_flag = ag_alpha_titan_action_available has_country_flag = ag_event_alpha_titan_contact_available }
	} }
	allow = {
		custom_tooltip = {
			fail_text = "ag_action_alpha_titan_activate_psionic_conduit_fail"
			exists = solar_system
			solar_system = { has_star_flag = ag_alpha_station_system_2 }
		}
		from = {
			resource_stockpile_compare = { resource = energy value >= 1 mult = value:ag_enter_excited_shroud_cost }
			has_technology = "tech_ag_adv_psionic_control"
		}
	}
	effect = {
		custom_tooltip = "ag_action_alpha_titan_activate_psionic_conduit_effect"
		from = { add_resource = { energy = -1 mult = value:ag_enter_excited_shroud_cost } }
		hidden_effect = { from = { country_event = { id = ag_alpha.78 days = 2 random = 1 } } }
		ag_close_action_window = yes
	}
}

ag_action_psionic_container_load = {
	potential = { hidden_trigger = {
		is_scope_type = fleet exists = owner owner = { is_same_value = root.from } has_fleet_flag = ag_ship_action_target_@owner
		any_owned_ship = { has_component = ag_psionic_container_psi_pod_empty }
	} }
	allow = {
		custom_tooltip = {
			fail_text = "ag_action_psionic_container_load_fail"
			exists = solar_system
			solar_system = { OR = {
				has_star_flag = ag_alpha_locked_system_0
				has_star_flag = ag_alpha_locked_system_1
				has_star_flag = ag_alpha_locked_system_2
				has_star_flag = ag_alpha_locked_system_3
				has_star_flag = ag_alpha_locked_system_4
			} }
		}
	}
	effect = {
		custom_tooltip = "ag_action_psionic_container_load_effect"
		hidden_effect = {
			if = {
				limit = { from = { has_country_flag = ag_alpha_system_locator_flag } }
				random_owned_ship = {
					limit = { has_component = ag_psionic_container_psi_pod_empty }
					if = {
						limit = { solar_system = { check_variable = { which = ag_alpha_system_color value = 0 } } }
						fleet = { create_ship = { name = prev design = "NAME_ag_alpha_psionic_container_alt_violet" } }
						solar_system = {
							remove_star_flag = ag_alpha_locked_system_0
							remove_star_flag = ag_alpha_locked_system_1
							remove_star_flag = ag_alpha_locked_system_2
							remove_star_flag = ag_alpha_locked_system_3
							remove_star_flag = ag_alpha_locked_system_4
						}
					}
					if = {
						limit = { solar_system = { check_variable = { which = ag_alpha_system_color value = 1 } } }
						fleet = { create_ship = { name = prev design = "NAME_ag_alpha_psionic_container_alt_red" } }
						solar_system = {
							remove_star_flag = ag_alpha_locked_system_0
							remove_star_flag = ag_alpha_locked_system_1
							remove_star_flag = ag_alpha_locked_system_2
							remove_star_flag = ag_alpha_locked_system_3
							remove_star_flag = ag_alpha_locked_system_4
						}
					}
					if = {
						limit = { solar_system = { check_variable = { which = ag_alpha_system_color value = 2 } } }
						fleet = { create_ship = { name = prev design = "NAME_ag_alpha_psionic_container_alt_yellow" } }
						solar_system = {
							remove_star_flag = ag_alpha_locked_system_0
							remove_star_flag = ag_alpha_locked_system_1
							remove_star_flag = ag_alpha_locked_system_2
							remove_star_flag = ag_alpha_locked_system_3
							remove_star_flag = ag_alpha_locked_system_4
						}
					}
					if = {
						limit = { solar_system = { check_variable = { which = ag_alpha_system_color value = 3 } } }
						fleet = { create_ship = { name = prev design = "NAME_ag_alpha_psionic_container_alt_teal" } }
						solar_system = {
							remove_star_flag = ag_alpha_locked_system_0
							remove_star_flag = ag_alpha_locked_system_1
							remove_star_flag = ag_alpha_locked_system_2
							remove_star_flag = ag_alpha_locked_system_3
							remove_star_flag = ag_alpha_locked_system_4
						}
					}
					delete_ship = this
				}
			}
			else = {
				from = { country_event = { id = ag_alpha.42 } }
				random_owned_ship = {
					limit = { has_component = ag_psionic_container_psi_pod_empty }
					destroy_ship = this
				}
			}
		}
		ag_close_action_window = yes
	}
}
ag_action_psionic_container_unload = {
	potential = { hidden_trigger = {
		is_scope_type = fleet exists = owner owner = { is_same_value = root.from } has_fleet_flag = ag_ship_action_target_@owner
		any_owned_ship = { is_ship_size = ag_alpha_psionic_container_alt }
		NOT = { any_owned_ship = { has_component = ag_psionic_container_psi_pod_empty } }
	} }
	allow = {
		custom_tooltip = {
			fail_text = "ag_action_psionic_container_unload_fail"
			exists = solar_system
			solar_system = { any_ship_in_system = { has_ship_flag = ag_event_alpha_titan } }
		}
	}
	effect = {
		custom_tooltip = "ag_action_psionic_container_unload_effect"
		hidden_effect = { every_owned_ship = {
			limit = { is_ship_size = ag_alpha_psionic_container_alt }
			root.from = { country_event = { id = ag_alpha.36 scopes = { from = root.from fromfrom = prev fromfromfrom = prev } } }
		} }
		ag_close_action_window = yes
	}
}
ag_action_psionic_container_unload_alt = {
	potential = { hidden_trigger = {
		is_scope_type = fleet exists = owner owner = { is_same_value = root.from } has_fleet_flag = ag_ship_action_target_@owner
		any_owned_ship = { is_ship_size = ag_alpha_psionic_container_alt }
		any_owned_ship = { has_component = ag_psionic_container_psi_pod_empty }
	} }
	allow = {
		custom_tooltip = {
			fail_text = "ag_action_psionic_container_unload_fail"
			exists = solar_system
			solar_system = { any_ship_in_system = { has_ship_flag = ag_event_alpha_titan } }
		}
	}
	effect = {
		custom_tooltip = "ag_action_psionic_container_unload_effect"
		hidden_effect = { every_owned_ship = {
			limit = { is_ship_size = ag_alpha_psionic_container_alt }
			root.from = { country_event = { id = ag_alpha.36 scopes = { from = root.from fromfrom = prev fromfromfrom = prev } } }
		} }
		ag_close_action_window = yes
	}
}
ag_action_psionic_container_charge = {
	potential = { hidden_trigger = {
		is_scope_type = fleet exists = owner owner = { is_same_value = root.from } has_fleet_flag = ag_ship_action_target_@owner
		any_owned_ship = { OR = {
			has_component = ag_psionic_container_psi_pod_violet
			has_component = ag_psionic_container_psi_pod_red
			has_component = ag_psionic_container_psi_pod_yellow
			has_component = ag_psionic_container_psi_pod_teal
		} }
		NOR = {
			any_owned_ship = { is_ship_size = ag_alpha_psionic_container_alt }
			any_owned_ship = { has_component = ag_psionic_container_psi_pod_empty }
		}
	} }
	allow = {
		custom_tooltip = {
			fail_text = "ag_action_psionic_container_charge_fail"
			exists = solar_system
			solar_system = { has_star_flag = ag_alpha_station_system_1 }
		}
	}
	effect = {
		custom_tooltip = "ag_action_psionic_container_charge_effect"
		hidden_effect = { every_owned_ship = {
			limit = { OR = {
				has_component = ag_psionic_container_psi_pod_violet
				has_component = ag_psionic_container_psi_pod_red
				has_component = ag_psionic_container_psi_pod_yellow
				has_component = ag_psionic_container_psi_pod_teal
			} }
			ag_spawn_explosion_effect = { ag_scale = m ag_color = violet }
			if = { limit = { has_component = ag_psionic_container_psi_pod_violet } solar_system.star = { change_variable = { which = ag_ancient_psi_star_weapon_charge_0 value = 1 } } }
			if = { limit = { has_component = ag_psionic_container_psi_pod_red } solar_system.star = { change_variable = { which = ag_ancient_psi_star_weapon_charge_1 value = 1 } } }
			if = { limit = { has_component = ag_psionic_container_psi_pod_yellow } solar_system.star = { change_variable = { which = ag_ancient_psi_star_weapon_charge_2 value = 1 } } }
			if = { limit = { has_component = ag_psionic_container_psi_pod_teal } solar_system.star = { change_variable = { which = ag_ancient_psi_star_weapon_charge_3 value = 1 } } }
			delete_ship = this
		} }
		ag_close_action_window = yes
	}
}
ag_action_psionic_container_charge_alt = {
	potential = { hidden_trigger = {
		is_scope_type = fleet exists = owner owner = { is_same_value = root.from } has_fleet_flag = ag_ship_action_target_@owner
		any_owned_ship = { OR = {
			has_component = ag_psionic_container_psi_pod_violet
			has_component = ag_psionic_container_psi_pod_red
			has_component = ag_psionic_container_psi_pod_yellow
			has_component = ag_psionic_container_psi_pod_teal
		} }
		OR = {
			any_owned_ship = { is_ship_size = ag_alpha_psionic_container_alt }
			any_owned_ship = { has_component = ag_psionic_container_psi_pod_empty }
		}
		NAND = {
			any_owned_ship = { is_ship_size = ag_alpha_psionic_container_alt }
			any_owned_ship = { has_component = ag_psionic_container_psi_pod_empty }
		}
	} }
	allow = {
		custom_tooltip = {
			fail_text = "ag_action_psionic_container_charge_fail"
			exists = solar_system
			solar_system = { has_star_flag = ag_alpha_station_system_1 }
		}
	}
	effect = {
		custom_tooltip = "ag_action_psionic_container_charge_effect"
		hidden_effect = { every_owned_ship = {
			limit = { OR = {
				has_component = ag_psionic_container_psi_pod_violet
				has_component = ag_psionic_container_psi_pod_red
				has_component = ag_psionic_container_psi_pod_yellow
				has_component = ag_psionic_container_psi_pod_teal
			} }
			ag_spawn_explosion_effect = { ag_scale = m ag_color = violet }
			if = { limit = { has_component = ag_psionic_container_psi_pod_violet } solar_system.star = { change_variable = { which = ag_ancient_psi_star_weapon_charge_0 value = 1 } } }
			if = { limit = { has_component = ag_psionic_container_psi_pod_red } solar_system.star = { change_variable = { which = ag_ancient_psi_star_weapon_charge_1 value = 1 } } }
			if = { limit = { has_component = ag_psionic_container_psi_pod_yellow } solar_system.star = { change_variable = { which = ag_ancient_psi_star_weapon_charge_2 value = 1 } } }
			if = { limit = { has_component = ag_psionic_container_psi_pod_teal } solar_system.star = { change_variable = { which = ag_ancient_psi_star_weapon_charge_3 value = 1 } } }
			delete_ship = this
		} }
		ag_close_action_window = yes
	}
}
ag_action_psionic_container_charge_alt2 = {
	potential = { hidden_trigger = {
		is_scope_type = fleet exists = owner owner = { is_same_value = root.from } has_fleet_flag = ag_ship_action_target_@owner
		any_owned_ship = { OR = {
			has_component = ag_psionic_container_psi_pod_violet
			has_component = ag_psionic_container_psi_pod_red
			has_component = ag_psionic_container_psi_pod_yellow
			has_component = ag_psionic_container_psi_pod_teal
		} }
		any_owned_ship = { is_ship_size = ag_alpha_psionic_container_alt }
		any_owned_ship = { has_component = ag_psionic_container_psi_pod_empty }
	} }
	allow = {
		custom_tooltip = {
			fail_text = "ag_action_psionic_container_charge_fail"
			exists = solar_system
			solar_system = { has_star_flag = ag_alpha_station_system_1 }
		}
	}
	effect = {
		custom_tooltip = "ag_action_psionic_container_charge_effect"
		hidden_effect = { every_owned_ship = {
			limit = { OR = {
				has_component = ag_psionic_container_psi_pod_violet
				has_component = ag_psionic_container_psi_pod_red
				has_component = ag_psionic_container_psi_pod_yellow
				has_component = ag_psionic_container_psi_pod_teal
			} }
			ag_spawn_explosion_effect = { ag_scale = m ag_color = violet }
			if = { limit = { has_component = ag_psionic_container_psi_pod_violet } solar_system.star = { change_variable = { which = ag_ancient_psi_star_weapon_charge_0 value = 1 } } }
			if = { limit = { has_component = ag_psionic_container_psi_pod_red } solar_system.star = { change_variable = { which = ag_ancient_psi_star_weapon_charge_1 value = 1 } } }
			if = { limit = { has_component = ag_psionic_container_psi_pod_yellow } solar_system.star = { change_variable = { which = ag_ancient_psi_star_weapon_charge_2 value = 1 } } }
			if = { limit = { has_component = ag_psionic_container_psi_pod_teal } solar_system.star = { change_variable = { which = ag_ancient_psi_star_weapon_charge_3 value = 1 } } }
			delete_ship = this
		} }
		ag_close_action_window = yes
	}
}

ag_action_alpha_titan_no_effect = {
	potential = { hidden_trigger = {
		is_scope_type = fleet exists = owner owner = { is_same_value = root.from } has_fleet_flag = ag_ship_action_target_@owner
		from = {
			NAND = { exists = event_target:ag_psionic_conduit_megastructure event_target:ag_psionic_conduit_megastructure = { exists = owner owner = { is_same_value = from } } }
			NOT = { has_country_flag = ag_ship_subsystem_enabled_101_42 }
		}
	} }
	allow = { always = yes }
	effect = { custom_tooltip = "ag_action_no_effect" }
}
ag_action_alpha_titan_psi_shield = {
	potential = { hidden_trigger = {
		is_scope_type = fleet exists = owner owner = { is_same_value = root.from } has_fleet_flag = ag_ship_action_target_@owner
		from = { has_country_flag = ag_ship_subsystem_enabled_101_42 }
		any_controlled_ship = { NOT = { has_ship_flag = ag_alpha_titan_psi_shield_enabled } OR = { is_ship_size = ag_alpha_titan_0 is_ship_size = ag_alpha_titan_1 } }
	} }
	allow = {
		custom_tooltip = {
			fail_text = "ag_requires_alpha_psi_shield_charged"
			any_controlled_ship = {
				is_variable_set = ag_alpha_psi_shield_charge
				check_variable = { which = ag_alpha_psi_shield_charge value > 0 }
			}
		}
	}
	effect = {
		custom_tooltip = "ag_action_alpha_titan_psi_shield_enable_effect"
		hidden_effect = { root = { every_controlled_ship = {
			limit = { OR = { is_ship_size = ag_alpha_titan_0 is_ship_size = ag_alpha_titan_1 } }
			ag_alpha_titan_player_psi_shield_effect = { ag_days = value:ag_alpha_titan_psi_shield_active_days }
		} } }
	}
}
ag_action_alpha_titan_psi_shield_alt = {
	potential = { hidden_trigger = {
		is_scope_type = fleet exists = owner owner = { is_same_value = root.from } has_fleet_flag = ag_ship_action_target_@owner
		from = { has_country_flag = ag_ship_subsystem_enabled_101_42 }
		any_controlled_ship = { has_ship_flag = ag_alpha_titan_psi_shield_enabled OR = { is_ship_size = ag_alpha_titan_0 is_ship_size = ag_alpha_titan_1 } }
	} }
	allow = { hidden_trigger = { always = yes } }
	effect = {
		custom_tooltip = "ag_action_alpha_titan_psi_shield_disable_effect"
		hidden_effect = { root = { every_controlled_ship = {
			limit = { has_ship_flag = ag_alpha_titan_psi_shield_enabled OR = { is_ship_size = ag_alpha_titan_0 is_ship_size = ag_alpha_titan_1 } }
			ag_alpha_titan_player_remove_psi_shield_effect = yes
		} } }
	}
}
ag_action_alpha_titan_psi_shield_manual = {
	potential = { hidden_trigger = {
		is_scope_type = fleet exists = owner owner = { is_same_value = root.from } has_fleet_flag = ag_ship_action_target_@owner
		from = { has_country_flag = ag_ship_subsystem_enabled_101_42 NOT = { has_country_flag = ag_alpha_titan_psi_shield_auto } }
	} }
	allow = { hidden_trigger = { always = yes } }
	effect = {
		custom_tooltip = "ag_action_alpha_titan_psi_shield_auto_effect"
		hidden_effect = { from = { set_country_flag = ag_alpha_titan_psi_shield_auto } }
	}
}
ag_action_alpha_titan_psi_shield_auto = {
	potential = { hidden_trigger = {
		is_scope_type = fleet exists = owner owner = { is_same_value = root.from } has_fleet_flag = ag_ship_action_target_@owner
		from = { has_country_flag = ag_ship_subsystem_enabled_101_42 has_country_flag = ag_alpha_titan_psi_shield_auto }
	} }
	allow = { hidden_trigger = { always = yes } }
	effect = {
		custom_tooltip = "ag_action_alpha_titan_psi_shield_manual_effect"
		hidden_effect = { from = { remove_country_flag = ag_alpha_titan_psi_shield_auto } }
	}
}
ag_action_alpha_titan_psi_shield_auto_days_minus = {
	potential = { hidden_trigger = {
		is_scope_type = fleet exists = owner owner = { is_same_value = root.from } has_fleet_flag = ag_ship_action_target_@owner
		from = { has_country_flag = ag_ship_subsystem_enabled_101_42 }
	} }
	allow = { hidden_trigger = { from = { check_variable = { which = ag_alpha_psi_shield_auto_days value > 1 } } } }
	effect = { custom_tooltip = "ag_action_alpha_titan_psi_shield_auto_days_desc" hidden_effect = { from = { subtract_variable = { which = ag_alpha_psi_shield_auto_days value = 1 } } } }
}
ag_action_alpha_titan_psi_shield_auto_days_plus = {
	potential = { hidden_trigger = {
		is_scope_type = fleet exists = owner owner = { is_same_value = root.from } has_fleet_flag = ag_ship_action_target_@owner
		from = { has_country_flag = ag_ship_subsystem_enabled_101_42 }
	} }
	allow = { hidden_trigger = { from = { check_variable = { which = ag_alpha_psi_shield_auto_days value < @ag_alpha_psi_shield_charge_days_max } } } }
	effect = { custom_tooltip = "ag_action_alpha_titan_psi_shield_auto_days_desc" hidden_effect = { from = { change_variable = { which = ag_alpha_psi_shield_auto_days value = 1 } } } }
}
ag_action_alpha_titan_psi_shield_auto_delay_minus = {
	potential = { hidden_trigger = {
		is_scope_type = fleet exists = owner owner = { is_same_value = root.from } has_fleet_flag = ag_ship_action_target_@owner
		from = { has_country_flag = ag_ship_subsystem_enabled_101_42 }
	} }
	allow = { hidden_trigger = { from = { check_variable = { which = ag_alpha_psi_shield_auto_delay value > 0 } } } }
	effect = { custom_tooltip = "ag_action_alpha_titan_psi_shield_auto_delay_desc" hidden_effect = { from = { subtract_variable = { which = ag_alpha_psi_shield_auto_delay value = 1 } } } }
}
ag_action_alpha_titan_psi_shield_auto_delay_plus = {
	potential = { hidden_trigger = {
		is_scope_type = fleet exists = owner owner = { is_same_value = root.from } has_fleet_flag = ag_ship_action_target_@owner
		from = { has_country_flag = ag_ship_subsystem_enabled_101_42 }
	} }
	allow = { hidden_trigger = { always = yes } }
	effect = { custom_tooltip = "ag_action_alpha_titan_psi_shield_auto_delay_desc" hidden_effect = { from = { change_variable = { which = ag_alpha_psi_shield_auto_delay value = 1 } } } }
}
ag_action_alpha_titan_psi_shield_desc_button = {
	potential = { hidden_trigger = {
		is_scope_type = fleet exists = owner owner = { is_same_value = root.from } has_fleet_flag = ag_ship_action_target_@owner
		from = { has_country_flag = ag_ship_subsystem_enabled_101_42 }
	} }
	allow = { hidden_trigger = { always = yes } }
	effect = { }
}

ag_action_alpha_titan_psionic_conduit_settings = {
	potential = { hidden_trigger = {
		is_scope_type = fleet exists = owner owner = { is_same_value = root.from } has_fleet_flag = ag_ship_action_target_@owner
		any_controlled_ship = { NOT = { has_ship_flag = ag_alpha_titan_psi_shield_enabled } OR = { is_ship_size = ag_alpha_titan_0 is_ship_size = ag_alpha_titan_1 } }
		from = { NOT = { has_country_flag = ag_ship_subsystem_enabled_101_42 } has_country_flag = ag_alpha_player_psionic_conduit_available }
	} }
	allow = {
		custom_tooltip = {
			fail_text = "ag_action_alpha_titan_activate_psionic_conduit_fail"
			exists = solar_system
			solar_system = { OR = {
				any_system_ambient_object = { is_ambient_object_type = ag_alpha_megastructure_activated_object }
				any_system_megastructure = { OR = {
					is_megastructure_type = ag_ancient_alpha_megastructure
					is_megastructure_type = ag_ancient_alpha_megastructure_closed
				} }
			} }
		}
		from = {
			resource_stockpile_compare = { resource = energy value >= 1 mult = value:ag_enter_excited_shroud_cost }
			has_technology = "tech_ag_adv_psionic_control"
		}
	}
	effect = {
		custom_tooltip = "ag_action_alpha_titan_activate_psionic_conduit_effect"
		from = { add_resource = { energy = -1 mult = value:ag_enter_excited_shroud_cost } }
		hidden_effect = { fleet_event = { id = ag_alpha.121 } }
	}
}
ag_action_alpha_titan_psionic_conduit_settings_alt = {
	potential = { hidden_trigger = {
		is_scope_type = fleet exists = owner owner = { is_same_value = root.from } has_fleet_flag = ag_ship_action_target_@owner
		any_controlled_ship = { NOT = { has_ship_flag = ag_alpha_titan_psi_shield_enabled } OR = { is_ship_size = ag_alpha_titan_0 is_ship_size = ag_alpha_titan_1 } }
		from = { has_country_flag = ag_ship_subsystem_enabled_101_42 has_country_flag = ag_alpha_player_psionic_conduit_available }
	} }
	allow = {
		custom_tooltip = {
			fail_text = "ag_action_alpha_titan_activate_psionic_conduit_fail"
			exists = solar_system
			solar_system = { OR = {
				any_system_ambient_object = { is_ambient_object_type = ag_alpha_megastructure_activated_object }
				any_system_megastructure = { OR = {
					is_megastructure_type = ag_ancient_alpha_megastructure
					is_megastructure_type = ag_ancient_alpha_megastructure_closed
				} }
			} }
		}
		from = {
			resource_stockpile_compare = { resource = energy value >= 1 mult = value:ag_enter_excited_shroud_cost }
			has_technology = "tech_ag_adv_psionic_control"
		}
	}
	effect = {
		custom_tooltip = "ag_action_alpha_titan_activate_psionic_conduit_effect"
		from = { add_resource = { energy = -1 mult = value:ag_enter_excited_shroud_cost } }
		hidden_effect = { fleet_event = { id = ag_alpha.121 } }
	}
}

ag_action_gamma_fleet_jumpdrive = {
	potential = { hidden_trigger = {
		is_scope_type = fleet exists = owner owner = { is_same_value = root.from } has_fleet_flag = ag_ship_action_target_@owner
		from = { has_country_flag = ag_ship_subsystem_enabled_301_10 }
		root = { NOT = { has_fleet_flag = ag_gamma_fleet_jumpdrive_enabled } }
	} }
	allow = { hidden_trigger = { always = yes } }
	effect = {
		custom_tooltip = "ag_action_fleet_jumpdrive_enable_effect"
		hidden_effect = { root = { set_fleet_flag = ag_gamma_fleet_jumpdrive_enabled } }
	}
}
ag_action_gamma_fleet_jumpdrive_alt = {
	potential = { hidden_trigger = {
		is_scope_type = fleet exists = owner owner = { is_same_value = root.from } has_fleet_flag = ag_ship_action_target_@owner
		from = { has_country_flag = ag_ship_subsystem_enabled_301_10 }
		root = { has_fleet_flag = ag_gamma_fleet_jumpdrive_enabled }
	} }
	allow = { hidden_trigger = { always = yes } }
	effect = {
		custom_tooltip = "ag_action_fleet_jumpdrive_disable_effect"
		hidden_effect = { root = { remove_fleet_flag = ag_gamma_fleet_jumpdrive_enabled } }
	}
}
ag_action_gamma_station_cloaking = {
	potential = { hidden_trigger = { is_scope_type = fleet exists = owner owner = { is_same_value = root.from } has_fleet_flag = ag_ship_action_target_@owner is_cloaked = no } }
	allow = {
		custom_tooltip = {
			fail_text = "ag_gamma_station_cloaking_cooldown"
			NOT = { has_fleet_flag = ag_gamma_station_cloaking_cooldown }
		}
	}
	effect = {
		custom_tooltip = "ag_gamma_station_cloaking_effect"
		hidden_effect = {
			set_cloaking_active = yes
			if = { limit = { is_cloaked = yes } fleet_event = { id = ag_ancient.1057 days = @ag_gamma_station_cloaking_days } }
		}
	}
}
ag_action_gamma_station_cloaking_alt = {
	potential = { hidden_trigger = { is_scope_type = fleet exists = owner owner = { is_same_value = root.from } has_fleet_flag = ag_ship_action_target_@owner is_cloaked = yes } }
	allow = { hidden_trigger = { always = yes } }
	effect = {
		custom_tooltip = "ag_gamma_station_cloaking_effect_alt"
		hidden_effect = {
			set_cloaking_active = no
			set_timed_fleet_flag = { flag = ag_gamma_station_cloaking_cooldown days = @ag_gamma_station_cloaking_cooldown_days }
		}
	}
}

ag_action_delta_platform_deploying = {
	potential = { hidden_trigger = {
		is_scope_type = fleet exists = owner owner = { is_same_value = root.from } has_fleet_flag = ag_ship_action_target_@owner
		root = { has_fleet_flag = ag_delta_platform_deploying }
	} }
	allow = { hidden_trigger = { always = yes } }
	effect = { custom_tooltip = "ag_ancient_turret_deploying_effect" }
}
ag_action_delta_platform_deploy_single = {
	potential = { hidden_trigger = {
		is_scope_type = fleet exists = owner owner = { is_same_value = root.from } has_fleet_flag = ag_ship_action_target_@owner
		root = { NOT = { has_fleet_flag = ag_delta_platform_deploying } }
	} }
	allow = { root = { exists = solar_system } }
	effect = {
		custom_tooltip = "ag_deploy_ancient_turret_single_effect"
		hidden_effect = { root = {
			if = {
				limit = { owner = { has_country_flag = ag_ship_subsystem_enabled_402_14 } }
				ag_deploy_ancient_turret_preparation = { ag_delay = 2 }
			}
			else = { ag_deploy_ancient_turret_preparation = { ag_delay = 5 } }
		} }
		ag_close_action_window = yes
	}
}
ag_action_delta_platform_deploy_system = {
	potential = { hidden_trigger = {
		is_scope_type = fleet exists = owner owner = { is_same_value = root.from } has_fleet_flag = ag_ship_action_target_@owner
		root = { NOT = { has_fleet_flag = ag_delta_platform_deploying } }
	} }
	allow = { root = { exists = solar_system } }
	effect = {
		custom_tooltip = "ag_deploy_ancient_turret_system_effect"
		hidden_effect = { root = {
			if = {
				limit = { owner = { has_country_flag = ag_ship_subsystem_enabled_402_14 } }
				solar_system = {
					every_fleet_in_system = {
						limit = {
							exists = owner
							owner = { is_same_value = root.owner }
							has_fleet_flag = ag_delta_platform_player
							NOT = { has_fleet_flag = ag_delta_platform_deploying }
						}
						ag_deploy_ancient_turret_preparation = { ag_delay = 2 }
					}
				}
			}
			else = {
				solar_system = {
					every_fleet_in_system = {
						limit = {
							exists = owner
							owner = { is_same_value = root.owner }
							has_fleet_flag = ag_delta_platform_player
							NOT = { has_fleet_flag = ag_delta_platform_deploying }
						}
						ag_deploy_ancient_turret_preparation = { ag_delay = 5 }
					}
				}
			}
		} }
		ag_close_action_window = yes
	}
}
ag_action_delta_platform_deploy_all = {
	potential = { hidden_trigger = {
		is_scope_type = fleet exists = owner owner = { is_same_value = root.from } has_fleet_flag = ag_ship_action_target_@owner
		root = { NOT = { has_fleet_flag = ag_delta_platform_deploying } }
	} }
	allow = { root = { exists = solar_system } }
	effect = {
		custom_tooltip = "ag_deploy_ancient_turret_all_effect"
		hidden_effect = { from = {
			if = {
				limit = { has_country_flag = ag_ship_subsystem_enabled_402_14 }
				every_controlled_fleet = {
					limit = {
						has_fleet_flag = ag_delta_platform_player
						NOT = { has_fleet_flag = ag_delta_platform_deploying }
					}
					ag_deploy_ancient_turret_preparation = { ag_delay = 2 }
				}
			}
			else = { every_controlled_fleet = {
				limit = {
					has_fleet_flag = ag_delta_platform_player
					NOT = { has_fleet_flag = ag_delta_platform_deploying }
				}
				ag_deploy_ancient_turret_preparation = { ag_delay = 5 }
			} }
		} }
		ag_close_action_window = yes
	}
}

ag_action_epsilon_titan_no_effect = {
	potential = { hidden_trigger = {
		is_scope_type = fleet exists = owner owner = { is_same_value = root.from } has_fleet_flag = ag_ship_action_target_@owner
		from = { NOR = { has_country_flag = ag_ship_subsystem_enabled_501_18 has_country_flag = ag_ship_subsystem_enabled_501_19 } }
		NAND = { exists = leader leader = { has_trait = leader_trait_ag_ancient_ai_StarInAurora } }
	} }
	allow = { always = yes }
	effect = { custom_tooltip = "ag_action_no_effect" }
}
ag_action_epsilon_titan_star_killer_weapon_range = {
	potential = { hidden_trigger = {
		is_scope_type = fleet exists = owner owner = { is_same_value = root.from } has_fleet_flag = ag_ship_action_target_@owner
		from = {
			NOT = { has_country_flag = ag_ship_subsystem_enabled_501_19 }
			has_country_flag = ag_ship_subsystem_enabled_501_18
		}
		NAND = { exists = leader leader = { has_trait = leader_trait_ag_ancient_ai_StarInAurora } }
	} }
	allow = {
		root = { exists = solar_system }
		custom_tooltip = {
			fail_text = "ag_requires_no_charging_star_killer"
			root = { any_controlled_ship = {
				is_ship_size = ag_epsilon_titan_1
				NOT = { has_ship_flag = ag_epsilon_firing_star_killer_weapon }
			} }
		}
		custom_tooltip = {
			fail_text = "ag_requires_no_coldown"
			root = { any_controlled_ship = {
				is_ship_size = ag_epsilon_titan_1
				NOT = { has_ship_flag = ag_epsilon_star_weapon_remote_target_cooldown }
			} }
		}
	}
	effect = {
		custom_tooltip = "ag_epsilon_star_killer_target_selector_effect"
		hidden_effect = { from = {
			set_country_flag = ag_enabled_epsilon_planet_killer_selector
			country_event = { id = ag_system_selector.1 }
		} }
		ag_close_action_window = yes
	}
}
ag_action_epsilon_titan_star_killer_weapon_range_alt = {
	potential = { hidden_trigger = {
		is_scope_type = fleet exists = owner owner = { is_same_value = root.from } has_fleet_flag = ag_ship_action_target_@owner
		exists = leader
		leader = { has_trait = leader_trait_ag_ancient_ai_StarInAurora }
	} }
	allow = {
		root = { exists = solar_system }
		custom_tooltip = {
			fail_text = "ag_requires_no_charging_star_killer"
			root = { any_controlled_ship = {
				is_ship_size = ag_epsilon_titan_1
				NOT = { has_ship_flag = ag_epsilon_firing_star_killer_weapon }
			} }
		}
		custom_tooltip = {
			fail_text = "ag_requires_no_coldown"
			root = { any_controlled_ship = {
				is_ship_size = ag_epsilon_titan_1
				NOT = { has_ship_flag = ag_epsilon_star_weapon_remote_target_cooldown }
			} }
		}
	}
	effect = {
		custom_tooltip = "ag_epsilon_star_killer_target_selector_effect"
		hidden_effect = { from = {
			set_country_flag = ag_enabled_epsilon_planet_killer_selector
			country_event = { id = ag_system_selector.1 }
		} }
		ag_close_action_window = yes
	}
}
ag_action_epsilon_titan_star_killer_weapon = {
	potential = { hidden_trigger = {
		is_scope_type = fleet exists = owner owner = { is_same_value = root.from } has_fleet_flag = ag_ship_action_target_@owner
		OR = {
			AND = { exists = leader leader = { has_trait = leader_trait_ag_ancient_ai_StarInAurora } }
			from = { has_country_flag = ag_ship_subsystem_enabled_501_19 }
		}
		from = { OR = {
			has_country_flag = ag_epsilon_star_killer_planet_killer_mode
			has_country_flag = ag_epsilon_star_killer_planet_sweeper_mode
		} }
	} }
	allow = { hidden_trigger = { always = yes } }
	effect = {
		custom_tooltip = "ag_epsilon_star_killer_weapon_effect"
		hidden_effect = { root = {
			every_controlled_ship = {
				limit = { is_ship_size = ag_epsilon_titan_1 }
				remove_ship_flag = ag_epsilon_star_killer_planet_killer_mode
				remove_ship_flag = ag_epsilon_star_killer_planet_sweeper_mode
			}
			owner = {
				remove_country_flag = ag_epsilon_star_killer_planet_killer_mode
				remove_country_flag = ag_epsilon_star_killer_planet_sweeper_mode
			}
		} }
	}
}
ag_action_epsilon_titan_star_killer_weapon_alt = {
	potential = { hidden_trigger = {
		is_scope_type = fleet exists = owner owner = { is_same_value = root.from } has_fleet_flag = ag_ship_action_target_@owner
		OR = {
			AND = { exists = leader leader = { has_trait = leader_trait_ag_ancient_ai_StarInAurora } }
			from = { has_country_flag = ag_ship_subsystem_enabled_501_19 }
		}
		from = { NOR = {
			has_country_flag = ag_epsilon_star_killer_planet_killer_mode
			has_country_flag = ag_epsilon_star_killer_planet_sweeper_mode
		} }
	} }
	allow = { hidden_trigger = { always = yes } }
	effect = { custom_tooltip = "ag_epsilon_star_killer_weapon_effect_alt" }
}
ag_action_epsilon_titan_planet_killer_weapon = {
	potential = { hidden_trigger = {
		is_scope_type = fleet exists = owner owner = { is_same_value = root.from } has_fleet_flag = ag_ship_action_target_@owner
		OR = {
			AND = { exists = leader leader = { has_trait = leader_trait_ag_ancient_ai_StarInAurora } }
			from = { has_country_flag = ag_ship_subsystem_enabled_501_19 }
		}
		from = { NOT = { has_country_flag = ag_epsilon_star_killer_planet_killer_mode } }
	} }
	allow = { hidden_trigger = { always = yes } }
	effect = {
		custom_tooltip = "ag_epsilon_planet_killer_weapon_effect"
		hidden_effect = { root = {
			every_controlled_ship = {
				limit = { is_ship_size = ag_epsilon_titan_1 }
				set_ship_flag = ag_epsilon_star_killer_planet_killer_mode
				remove_ship_flag = ag_epsilon_star_killer_planet_sweeper_mode
			}
			owner = {
				set_country_flag = ag_epsilon_star_killer_planet_killer_mode
				remove_country_flag = ag_epsilon_star_killer_planet_sweeper_mode
			}
		} }
	}
}
ag_action_epsilon_titan_planet_killer_weapon_alt = {
	potential = { hidden_trigger = {
		is_scope_type = fleet exists = owner owner = { is_same_value = root.from } has_fleet_flag = ag_ship_action_target_@owner
		OR = {
			AND = { exists = leader leader = { has_trait = leader_trait_ag_ancient_ai_StarInAurora } }
			from = { has_country_flag = ag_ship_subsystem_enabled_501_19 }
		}
		from = { has_country_flag = ag_epsilon_star_killer_planet_killer_mode }
	} }
	allow = { hidden_trigger = { always = yes } }
	effect = { custom_tooltip = "ag_epsilon_planet_killer_weapon_effect_alt" }
}
ag_action_epsilon_titan_planet_sweeper_weapon = {
	potential = { hidden_trigger = {
		is_scope_type = fleet exists = owner owner = { is_same_value = root.from } has_fleet_flag = ag_ship_action_target_@owner
		OR = {
			AND = { exists = leader leader = { has_trait = leader_trait_ag_ancient_ai_StarInAurora } }
			from = { has_country_flag = ag_ship_subsystem_enabled_501_19 }
		}
		from = { NOT = { has_country_flag = ag_epsilon_star_killer_planet_sweeper_mode } }
	} }
	allow = { hidden_trigger = { always = yes } }
	effect = {
		custom_tooltip = "ag_epsilon_planet_sweeper_weapon_effect"
		hidden_effect = { root = {
			every_controlled_ship = {
				limit = { is_ship_size = ag_epsilon_titan_1 }
				remove_ship_flag = ag_epsilon_star_killer_planet_killer_mode
				set_ship_flag = ag_epsilon_star_killer_planet_sweeper_mode
			}
			owner = {
				remove_country_flag = ag_epsilon_star_killer_planet_killer_mode
				set_country_flag = ag_epsilon_star_killer_planet_sweeper_mode
			}
		} }
	}
}
ag_action_epsilon_titan_planet_sweeper_weapon_alt = {
	potential = { hidden_trigger = {
		is_scope_type = fleet exists = owner owner = { is_same_value = root.from } has_fleet_flag = ag_ship_action_target_@owner
		OR = {
			AND = { exists = leader leader = { has_trait = leader_trait_ag_ancient_ai_StarInAurora } }
			from = { has_country_flag = ag_ship_subsystem_enabled_501_19 }
		}
		from = { has_country_flag = ag_epsilon_star_killer_planet_sweeper_mode }
	} }
	allow = { hidden_trigger = { always = yes } }
	effect = { custom_tooltip = "ag_epsilon_planet_sweeper_weapon_effect_alt" }
}

ag_action_zeta_titan_no_effect = {
	potential = { hidden_trigger = {
		is_scope_type = fleet exists = owner owner = { is_same_value = root.from } has_fleet_flag = ag_ship_action_target_@owner
		from = { NOT = { has_country_flag = ag_ship_subsystem_enabled_701_30 } }
	} }
	allow = { always = yes }
	effect = { custom_tooltip = "ag_action_no_effect" }
}
ag_action_zeta_ship_gravity_weapon_titans = {
	potential = { hidden_trigger = {
		is_scope_type = fleet exists = owner owner = { is_same_value = root.from } has_fleet_flag = ag_ship_action_target_@owner
		root = { NOT = { check_variable = { which = ag_num_zeta_titans value = ag_num_zeta_titans_gra } } }
		from = { has_country_flag = ag_ship_subsystem_enabled_701_30 }
	} }
	allow = {
		root = { exists = solar_system }
		custom_tooltip = { fail_text = "ag_requires_no_in_battle" root = { is_in_combat = no } }
		custom_tooltip = { fail_text = "ag_requires_no_in_badly_damaged" root = { any_controlled_ship = { has_hp_percentage > 0.85 } } }
		custom_tooltip = { fail_text = "ag_requires_no_change_weapon_cooldown" root = { any_controlled_ship = {
			is_ship_size = ag_zeta_titan
			NOR = { has_ship_flag = ag_zeta_ship_gravity_weapon has_ship_flag = ag_zeta_ship_change_weapon_cooldown }
		} } }
	}
	effect = {
		custom_tooltip = "ag_zeta_ship_gravity_weapon_titans_effect"
		hidden_effect = { root = {
			set_variable = { which = ag_num_zeta_titans_gra value = ag_num_zeta_titans }
			set_variable = { which = ag_num_zeta_titans_psi value = 0 }
			if = { limit = { exists = leader } leader = { save_global_event_target_as = ag_weapon_swap_target_leader unassign_leader = this } }
			every_controlled_ship = {
				limit = { is_ship_size = ag_zeta_titan NOR = { has_ship_flag = ag_zeta_ship_gravity_weapon has_ship_flag = ag_zeta_ship_change_weapon_cooldown } }
				ag_zeta_ship_change_weapon_effect = yes
			}
			if = { limit = { exists = event_target:ag_weapon_swap_target_leader } assign_leader = event_target:ag_weapon_swap_target_leader clear_global_event_target = ag_target_fleet_swap }
		} }
	}
}
ag_action_zeta_ship_gravity_weapon_titans_alt = {
	potential = { hidden_trigger = {
		is_scope_type = fleet exists = owner owner = { is_same_value = root.from } has_fleet_flag = ag_ship_action_target_@owner
		root = { check_variable = { which = ag_num_zeta_titans value = ag_num_zeta_titans_gra } }
		from = { has_country_flag = ag_ship_subsystem_enabled_701_30 }
	} }
	allow = { hidden_trigger = { always = yes } }
	effect = { custom_tooltip = "ag_zeta_ship_gravity_weapon_titans_effect" }
}
ag_action_zeta_ship_anti_psi_weapon_titans = {
	potential = { hidden_trigger = {
		is_scope_type = fleet exists = owner owner = { is_same_value = root.from } has_fleet_flag = ag_ship_action_target_@owner
		root = { NOT = { check_variable = { which = ag_num_zeta_titans value = ag_num_zeta_titans_psi } } }
		from = { has_country_flag = ag_ship_subsystem_enabled_701_30 }
	} }
	allow = {
		root = { exists = solar_system }
		custom_tooltip = { fail_text = "ag_requires_no_in_battle" root = { is_in_combat = no } }
		custom_tooltip = { fail_text = "ag_requires_no_in_badly_damaged" root = { any_controlled_ship = { has_hp_percentage > 0.85 } } }
		custom_tooltip = { fail_text = "ag_requires_no_change_weapon_cooldown" root = { any_controlled_ship = {
			is_ship_size = ag_zeta_titan has_ship_flag = ag_zeta_ship_gravity_weapon
			NOT = { has_ship_flag = ag_zeta_ship_change_weapon_cooldown }
		} } }
	}
	effect = {
		custom_tooltip = "ag_zeta_ship_anti_psi_weapon_titans_effect"
		hidden_effect = { root = {
			set_variable = { which = ag_num_zeta_titans_gra value = 0 }
			set_variable = { which = ag_num_zeta_titans_psi value = ag_num_zeta_titans }
			if = { limit = { exists = leader } leader = { save_global_event_target_as = ag_weapon_swap_target_leader unassign_leader = this } }
			every_controlled_ship = {
				limit = { is_ship_size = ag_zeta_titan has_ship_flag = ag_zeta_ship_gravity_weapon NOT = { has_ship_flag = ag_zeta_ship_change_weapon_cooldown } }
				ag_zeta_ship_change_weapon_effect = yes
			}
			if = { limit = { exists = event_target:ag_weapon_swap_target_leader } assign_leader = event_target:ag_weapon_swap_target_leader clear_global_event_target = ag_target_fleet_swap }
		} }
	}
}
ag_action_zeta_ship_anti_psi_weapon_titans_alt = {
	potential = { hidden_trigger = {
		is_scope_type = fleet exists = owner owner = { is_same_value = root.from } has_fleet_flag = ag_ship_action_target_@owner
		root = { check_variable = { which = ag_num_zeta_titans value = ag_num_zeta_titans_psi } }
		from = { has_country_flag = ag_ship_subsystem_enabled_701_30 }
	} }
	allow = { hidden_trigger = { always = yes } }
	effect = { custom_tooltip = "ag_zeta_ship_anti_psi_weapon_titans_effect" }
}
ag_zeta_titan_default_psi_weapon = {
	potential = { hidden_trigger = { from = { check_variable = { which = ag_ship_subsystem_701_2 value = 30 } has_country_flag = ag_zeta_titan_default_gra_weapon } } }
	allow = { hidden_trigger = { always = yes } }
	effect = { hidden_effect = { from = { remove_country_flag = ag_zeta_titan_default_gra_weapon } } }
}
ag_zeta_titan_default_psi_weapon_alt = {
	potential = { hidden_trigger = { from = { check_variable = { which = ag_ship_subsystem_701_2 value = 30 } NOT = { has_country_flag = ag_zeta_titan_default_gra_weapon } } } }
	allow = { hidden_trigger = { always = yes } }
	effect = { }
}
ag_zeta_titan_default_gra_weapon = {
	potential = { hidden_trigger = { from = { check_variable = { which = ag_ship_subsystem_701_2 value = 30 } NOT = { has_country_flag = ag_zeta_titan_default_gra_weapon } } } }
	allow = { hidden_trigger = { always = yes } }
	effect = { hidden_effect = { from = { set_country_flag = ag_zeta_titan_default_gra_weapon } } }
}
ag_zeta_titan_default_gra_weapon_alt = {
	potential = { hidden_trigger = { from = { check_variable = { which = ag_ship_subsystem_701_2 value = 30 } has_country_flag = ag_zeta_titan_default_gra_weapon } } }
	allow = { hidden_trigger = { always = yes } }
	effect = { }
}

ag_action_zeta_battleship_no_effect = {
	potential = { hidden_trigger = {
		is_scope_type = fleet exists = owner owner = { is_same_value = root.from } has_fleet_flag = ag_ship_action_target_@owner
		from = { NOT = { has_country_flag = ag_ship_subsystem_enabled_702_30 } }
	} }
	allow = { always = yes }
	effect = { custom_tooltip = "ag_action_no_effect" }
}
ag_action_zeta_ship_gravity_weapon_battleships = {
	potential = { hidden_trigger = {
		is_scope_type = fleet exists = owner owner = { is_same_value = root.from } has_fleet_flag = ag_ship_action_target_@owner
		root = { NOT = { check_variable = { which = ag_num_zeta_battleships value = ag_num_zeta_battleships_gra } } }
		from = { has_country_flag = ag_ship_subsystem_enabled_702_30 }
	} }
	allow = {
		root = { exists = solar_system }
		custom_tooltip = { fail_text = "ag_requires_no_in_battle" root = { is_in_combat = no } }
		custom_tooltip = { fail_text = "ag_requires_no_in_badly_damaged" root = { any_controlled_ship = { has_hp_percentage > 0.85 } } }
		custom_tooltip = { fail_text = "ag_requires_no_change_weapon_cooldown" root = { any_controlled_ship = {
			is_ship_size = ag_zeta_battleship
			NOR = { has_ship_flag = ag_zeta_ship_gravity_weapon has_ship_flag = ag_zeta_ship_change_weapon_cooldown }
		} } }
	}
	effect = {
		custom_tooltip = "ag_zeta_ship_gravity_weapon_battleships_effect"
		hidden_effect = { root = {
			set_variable = { which = ag_num_zeta_battleships_gra value = ag_num_zeta_battleships }
			set_variable = { which = ag_num_zeta_battleships_psi value = 0 }
			if = { limit = { exists = leader } leader = { save_global_event_target_as = ag_weapon_swap_target_leader unassign_leader = this } }
			every_controlled_ship = {
				limit = { is_ship_size = ag_zeta_battleship NOR = { has_ship_flag = ag_zeta_ship_gravity_weapon has_ship_flag = ag_zeta_ship_change_weapon_cooldown } }
				ag_zeta_ship_change_weapon_effect = yes
			}
			if = { limit = { exists = event_target:ag_weapon_swap_target_leader } assign_leader = event_target:ag_weapon_swap_target_leader clear_global_event_target = ag_target_fleet_swap }
		} }
	}
}
ag_action_zeta_ship_gravity_weapon_battleships_alt = {
	potential = { hidden_trigger = {
		is_scope_type = fleet exists = owner owner = { is_same_value = root.from } has_fleet_flag = ag_ship_action_target_@owner
		root = { check_variable = { which = ag_num_zeta_battleships value = ag_num_zeta_battleships_gra } }
		from = { has_country_flag = ag_ship_subsystem_enabled_702_30 }
	} }
	allow = { hidden_trigger = { always = yes } }
	effect = { custom_tooltip = "ag_zeta_ship_gravity_weapon_battleships_effect" }
}
ag_action_zeta_ship_anti_psi_weapon_battleships = {
	potential = { hidden_trigger = {
		is_scope_type = fleet exists = owner owner = { is_same_value = root.from } has_fleet_flag = ag_ship_action_target_@owner
		root = { NOT = { check_variable = { which = ag_num_zeta_battleships value = ag_num_zeta_battleships_psi } } }
		from = { has_country_flag = ag_ship_subsystem_enabled_702_30 }
	} }
	allow = {
		root = { exists = solar_system }
		custom_tooltip = { fail_text = "ag_requires_no_in_battle" root = { is_in_combat = no } }
		custom_tooltip = { fail_text = "ag_requires_no_in_badly_damaged" root = { any_controlled_ship = { has_hp_percentage > 0.85 } } }
		custom_tooltip = { fail_text = "ag_requires_no_change_weapon_cooldown" root = { any_controlled_ship = {
			is_ship_size = ag_zeta_battleship has_ship_flag = ag_zeta_ship_gravity_weapon
			NOT = { has_ship_flag = ag_zeta_ship_change_weapon_cooldown }
		} } }
	}
	effect = {
		custom_tooltip = "ag_zeta_ship_anti_psi_weapon_battleships_effect"
		hidden_effect = { root = {
			set_variable = { which = ag_num_zeta_battleships_gra value = 0 }
			set_variable = { which = ag_num_zeta_battleships_psi value = ag_num_zeta_battleships }
			if = { limit = { exists = leader } leader = { save_global_event_target_as = ag_weapon_swap_target_leader unassign_leader = this } }
			every_controlled_ship = {
				limit = { is_ship_size = ag_zeta_battleship has_ship_flag = ag_zeta_ship_gravity_weapon NOT = { has_ship_flag = ag_zeta_ship_change_weapon_cooldown } }
				ag_zeta_ship_change_weapon_effect = yes
			}
			if = { limit = { exists = event_target:ag_weapon_swap_target_leader } assign_leader = event_target:ag_weapon_swap_target_leader clear_global_event_target = ag_target_fleet_swap }
		} }
	}
}
ag_action_zeta_ship_anti_psi_weapon_battleships_alt = {
	potential = { hidden_trigger = {
		is_scope_type = fleet exists = owner owner = { is_same_value = root.from } has_fleet_flag = ag_ship_action_target_@owner
		root = { check_variable = { which = ag_num_zeta_battleships value = ag_num_zeta_battleships_psi } }
		from = { has_country_flag = ag_ship_subsystem_enabled_702_30 }
	} }
	allow = { hidden_trigger = { always = yes } }
	effect = { custom_tooltip = "ag_zeta_ship_anti_psi_weapon_battleships_effect" }
}
ag_zeta_battleship_default_psi_weapon = {
	potential = { hidden_trigger = { from = { check_variable = { which = ag_ship_subsystem_702_2 value = 30 } has_country_flag = ag_zeta_battleship_default_gra_weapon } } }
	allow = { hidden_trigger = { always = yes } }
	effect = { hidden_effect = { from = {
		remove_country_flag = ag_zeta_battleship_default_gra_weapon
		if = {
			limit = { ag_has_ship_design = { ag_design = ag_zeta_battleship_red_alt } }
			ag_remove_ship_design = { ag_design = ag_zeta_battleship_red_alt }
		}
		ag_add_ship_design = { ag_design = ag_zeta_battleship }
	} } }
}
ag_zeta_battleship_default_psi_weapon_alt = {
	potential = { hidden_trigger = { from = { check_variable = { which = ag_ship_subsystem_702_2 value = 30 } NOT = { has_country_flag = ag_zeta_battleship_default_gra_weapon } } } }
	allow = { hidden_trigger = { always = yes } }
	effect = { }
}
ag_zeta_battleship_default_gra_weapon = {
	potential = { hidden_trigger = { from = { check_variable = { which = ag_ship_subsystem_702_2 value = 30 } NOT = { has_country_flag = ag_zeta_battleship_default_gra_weapon } } } }
	allow = { hidden_trigger = { always = yes } }
	effect = { hidden_effect = { from = {
		set_country_flag = ag_zeta_battleship_default_gra_weapon
		if = {
			limit = { ag_has_ship_design = { ag_design = ag_zeta_battleship } }
			ag_remove_ship_design = { ag_design = ag_zeta_battleship }
		}
		ag_add_ship_design = { ag_design = ag_zeta_battleship_red_alt }
	} } }
}
ag_zeta_battleship_default_gra_weapon_alt = {
	potential = { hidden_trigger = { from = { check_variable = { which = ag_ship_subsystem_702_2 value = 30 } has_country_flag = ag_zeta_battleship_default_gra_weapon } } }
	allow = { hidden_trigger = { always = yes } }
	effect = { }
}

ag_action_zeta_destroyer_no_effect = {
	potential = { hidden_trigger = {
		is_scope_type = fleet exists = owner owner = { is_same_value = root.from } has_fleet_flag = ag_ship_action_target_@owner
		from = { NOT = { has_country_flag = ag_ship_subsystem_enabled_702_30 } }
	} }
	allow = { always = yes }
	effect = { custom_tooltip = "ag_action_no_effect" }
}
ag_action_zeta_ship_gravity_weapon_destroyers = {
	potential = { hidden_trigger = {
		is_scope_type = fleet exists = owner owner = { is_same_value = root.from } has_fleet_flag = ag_ship_action_target_@owner
		root = { NOT = { check_variable = { which = ag_num_zeta_destroyers value = ag_num_zeta_destroyers_gra } } }
		from = { has_country_flag = ag_ship_subsystem_enabled_703_30 }
	} }
	allow = {
		root = { exists = solar_system }
		custom_tooltip = { fail_text = "ag_requires_no_in_battle" root = { is_in_combat = no } }
		custom_tooltip = { fail_text = "ag_requires_no_in_badly_damaged" root = { any_controlled_ship = { has_hp_percentage > 0.85 } } }
		custom_tooltip = { fail_text = "ag_requires_no_change_weapon_cooldown" root = { any_controlled_ship = {
			is_ship_size = ag_zeta_destroyer
			NOR = { has_ship_flag = ag_zeta_ship_gravity_weapon has_ship_flag = ag_zeta_ship_change_weapon_cooldown }
		} } }
	}
	effect = {
		custom_tooltip = "ag_zeta_ship_gravity_weapon_destroyers_effect"
		hidden_effect = { root = {
			set_variable = { which = ag_num_zeta_destroyers_gra value = ag_num_zeta_destroyers }
			set_variable = { which = ag_num_zeta_destroyers_psi value = 0 }
			if = { limit = { exists = leader } leader = { save_global_event_target_as = ag_weapon_swap_target_leader unassign_leader = this } }
			every_controlled_ship = {
				limit = { is_ship_size = ag_zeta_destroyer NOR = { has_ship_flag = ag_zeta_ship_gravity_weapon has_ship_flag = ag_zeta_ship_change_weapon_cooldown } }
				ag_zeta_ship_change_weapon_effect = yes
			}
			if = { limit = { exists = event_target:ag_weapon_swap_target_leader } assign_leader = event_target:ag_weapon_swap_target_leader clear_global_event_target = ag_target_fleet_swap }
		} }
	}
}
ag_action_zeta_ship_gravity_weapon_destroyers_alt = {
	potential = { hidden_trigger = {
		is_scope_type = fleet exists = owner owner = { is_same_value = root.from } has_fleet_flag = ag_ship_action_target_@owner
		root = { check_variable = { which = ag_num_zeta_destroyers value = ag_num_zeta_destroyers_gra } }
		from = { has_country_flag = ag_ship_subsystem_enabled_703_30 }
	} }
	allow = { hidden_trigger = { always = yes } }
	effect = { custom_tooltip = "ag_zeta_ship_gravity_weapon_destroyers_effect" }
}
ag_action_zeta_ship_anti_psi_weapon_destroyers = {
	potential = { hidden_trigger = {
		is_scope_type = fleet exists = owner owner = { is_same_value = root.from } has_fleet_flag = ag_ship_action_target_@owner
		root = { NOT = { check_variable = { which = ag_num_zeta_destroyers value = ag_num_zeta_destroyers_psi } } }
		from = { has_country_flag = ag_ship_subsystem_enabled_703_30 }
	} }
	allow = {
		root = { exists = solar_system }
		custom_tooltip = { fail_text = "ag_requires_no_in_battle" root = { is_in_combat = no } }
		custom_tooltip = { fail_text = "ag_requires_no_in_badly_damaged" root = { any_controlled_ship = { has_hp_percentage > 0.85 } } }
		custom_tooltip = { fail_text = "ag_requires_no_change_weapon_cooldown" root = { any_controlled_ship = {
			is_ship_size = ag_zeta_destroyer has_ship_flag = ag_zeta_ship_gravity_weapon
			NOT = { has_ship_flag = ag_zeta_ship_change_weapon_cooldown }
		} } }
	}
	effect = {
		custom_tooltip = "ag_zeta_ship_anti_psi_weapon_destroyers_effect"
		hidden_effect = { root = {
			set_variable = { which = ag_num_zeta_destroyers_gra value = 0 }
			set_variable = { which = ag_num_zeta_destroyers_psi value = ag_num_zeta_destroyers }
			if = { limit = { exists = leader } leader = { save_global_event_target_as = ag_weapon_swap_target_leader unassign_leader = this } }
			every_controlled_ship = {
				limit = { is_ship_size = ag_zeta_destroyer has_ship_flag = ag_zeta_ship_gravity_weapon NOT = { has_ship_flag = ag_zeta_ship_change_weapon_cooldown } }
				ag_zeta_ship_change_weapon_effect = yes
			}
			if = { limit = { exists = event_target:ag_weapon_swap_target_leader } assign_leader = event_target:ag_weapon_swap_target_leader clear_global_event_target = ag_target_fleet_swap }
		} }
	}
}
ag_action_zeta_ship_anti_psi_weapon_destroyers_alt = {
	potential = { hidden_trigger = {
		is_scope_type = fleet exists = owner owner = { is_same_value = root.from } has_fleet_flag = ag_ship_action_target_@owner
		root = { check_variable = { which = ag_num_zeta_destroyers value = ag_num_zeta_destroyers_psi } }
		from = { has_country_flag = ag_ship_subsystem_enabled_703_30 }
	} }
	allow = { hidden_trigger = { always = yes } }
	effect = { custom_tooltip = "ag_zeta_ship_anti_psi_weapon_destroyers_effect" }
}
ag_zeta_destroyer_default_psi_weapon = {
	potential = { hidden_trigger = { from = { check_variable = { which = ag_ship_subsystem_703_2 value = 30 } has_country_flag = ag_zeta_destroyer_default_gra_weapon } } }
	allow = { hidden_trigger = { always = yes } }
	effect = { hidden_effect = { from = {
		remove_country_flag = ag_zeta_destroyer_default_gra_weapon
		if = {
			limit = { ag_has_ship_design = { ag_design = ag_zeta_destroyer_red_alt } }
			ag_remove_ship_design = { ag_design = ag_zeta_destroyer_red_alt }
		}
		ag_add_ship_design = { ag_design = ag_zeta_destroyer }
	} } }
}
ag_zeta_destroyer_default_psi_weapon_alt = {
	potential = { hidden_trigger = { from = { check_variable = { which = ag_ship_subsystem_703_2 value = 30 } NOT = { has_country_flag = ag_zeta_destroyer_default_gra_weapon } } } }
	allow = { hidden_trigger = { always = yes } }
	effect = { }
}
ag_zeta_destroyer_default_gra_weapon = {
	potential = { hidden_trigger = { from = { check_variable = { which = ag_ship_subsystem_703_2 value = 30 } NOT = { has_country_flag = ag_zeta_destroyer_default_gra_weapon } } } }
	allow = { hidden_trigger = { always = yes } }
	effect = { hidden_effect = { from = {
		set_country_flag = ag_zeta_destroyer_default_gra_weapon
		if = {
			limit = { ag_has_ship_design = { ag_design = ag_zeta_destroyer } }
			ag_remove_ship_design = { ag_design = ag_zeta_destroyer }
		}
		ag_add_ship_design = { ag_design = ag_zeta_destroyer_red_alt }
	} } }
}
ag_zeta_destroyer_default_gra_weapon_alt = {
	potential = { hidden_trigger = { from = { check_variable = { which = ag_ship_subsystem_703_2 value = 30 } has_country_flag = ag_zeta_destroyer_default_gra_weapon } } }
	allow = { hidden_trigger = { always = yes } }
	effect = { }
}

ag_action_eta_gateway_deploy = {
	potential = { hidden_trigger = { is_scope_type = fleet exists = owner owner = { is_same_value = root.from } has_fleet_flag = ag_ship_action_target_@owner } }
	allow = {
		root = { exists = solar_system }
		custom_tooltip = {
			fail_text = "requires_no_existing_gateway"
			root.solar_system = { NOT = { any_system_megastructure = { ag_is_gateway_megastructure = yes } } }
		}
	}
	effect = {
		custom_tooltip = "ag_deploy_eta_gateway_effect"
		hidden_effect = { root = { ag_set_eta_gateway_deployed = yes } }
		ag_close_action_window = yes
	}
}

ag_action_eta_titan_no_effect = {
	potential = { hidden_trigger = {
		is_scope_type = fleet exists = owner owner = { is_same_value = root.from } has_fleet_flag = ag_ship_action_target_@owner
		from = { NOT = { has_country_flag = ag_ship_subsystem_enabled_602_35 } }
	} }
	allow = { always = yes }
	effect = { custom_tooltip = "ag_action_no_effect" }
}
ag_action_eta_titan_hallucination = {
	potential = { hidden_trigger = {
		is_scope_type = fleet exists = owner owner = { is_same_value = root.from } has_fleet_flag = ag_ship_action_target_@owner
		from = { has_country_flag = ag_ship_subsystem_enabled_602_35 }
	} }
	allow = {
		root = { exists = solar_system }
		custom_tooltip = {
			fail_text = "ag_requires_no_coldown"
			root = { any_controlled_ship = {
				OR = { is_ship_size = ag_eta_titan_0 is_ship_size = ag_eta_titan_1 }
				NOT = { has_ship_flag = ag_eta_titan_phantom_cooldown }
			} }
		}
	}
	effect = {
		custom_tooltip = "ag_eta_hallucination_effect"
		hidden_effect = { from = {
			set_country_flag = ag_enabled_eta_hallucination_target_selector
			country_event = { id = ag_system_selector.1 }
		} }
		ag_close_action_window = yes
	}
}

ag_action_dismissed_mine_field = {
	potential = { hidden_trigger = {
		is_scope_type = fleet exists = owner owner = { is_same_value = root.from } has_fleet_flag = ag_ship_action_target_@owner
		root = { has_fleet_flag = ag_space_mine_field_fleet }
	} }
	allow = { always = yes }
	effect = {
		custom_tooltip = "ag_dismissed_mine_field_effect"
		hidden_effect = { root = { delete_fleet = this } }
		ag_close_action_window = yes
	}
}

ag_action_science_constructor_no_effect = {
	potential = { hidden_trigger = {
		is_scope_type = fleet exists = owner owner = { is_same_value = root.from } has_fleet_flag = ag_ship_action_target_@owner
		root = { NOT = { any_controlled_ship = { OR = {
			has_component = ag_science_constructor_distance_survey_module
			has_component = ag_science_constructor_distance_intel_module
		} } } }
	} }
	allow = { always = yes }
	effect = { custom_tooltip = "ag_action_no_effect" }
}
ag_action_science_constructor_distance_survey = {
	potential = { hidden_trigger = {
		is_scope_type = fleet exists = owner owner = { is_same_value = root.from } has_fleet_flag = ag_ship_action_target_@owner
		root = { any_controlled_ship = { has_component = ag_science_constructor_distance_survey_module } }
	} }
	allow = {
		root = { exists = solar_system }
		custom_tooltip = { fail_text = "ag_requires_no_coldown" root = { NOT = { has_fleet_flag = ag_action_distance_survey_cooldown } } }
	}
	effect = {
		custom_tooltip = "ag_sci_constructor_survey_system_effect"
		hidden_effect = { root = {
			fleet_event = { id = ag_ancient.1201 }
			set_timed_fleet_flag = { flag = ag_action_distance_survey_cooldown days = @ag_science_constructor_distance_survey_cooldown }
		} }
		ag_close_action_window = yes
	}
}
ag_action_science_constructor_distance_intel = {
	potential = { hidden_trigger = {
		is_scope_type = fleet exists = owner owner = { is_same_value = root.from } has_fleet_flag = ag_ship_action_target_@owner
		root = { any_controlled_ship = {
			NOT = { has_component = ag_science_constructor_distance_survey_module }
			has_component = ag_science_constructor_distance_intel_module
		} }
	} }
	allow = {
		root = { exists = solar_system }
		custom_tooltip = { fail_text = "ag_requires_no_coldown" root = { NOT = { has_fleet_flag = ag_action_distance_intel_cooldown } } }
	}
	effect = {
		custom_tooltip = "ag_sci_constructor_distance_intel_effect"
		hidden_effect = { root = {
			set_timed_fleet_flag = { flag = ag_action_distance_intel_cooldown days = @ag_science_constructor_distance_intel_cooldown }
			owner = {
				set_country_flag = ag_enabled_sci_constructor_intel_selector
				country_event = { id = ag_system_selector.1 }
			}
		} }
		ag_close_action_window = yes
	}
}
ag_action_science_constructor_distance_intel_alt = {
	potential = { hidden_trigger = {
		is_scope_type = fleet exists = owner owner = { is_same_value = root.from } has_fleet_flag = ag_ship_action_target_@owner
		root = { any_controlled_ship = {
			has_component = ag_science_constructor_distance_survey_module
			has_component = ag_science_constructor_distance_intel_module
		} }
	} }
	allow = {
		root = { exists = solar_system }
		custom_tooltip = { fail_text = "ag_requires_no_coldown" root = { NOT = { has_fleet_flag = ag_action_distance_intel_cooldown } } }
	}
	effect = {
		custom_tooltip = "ag_sci_constructor_distance_intel_effect"
		hidden_effect = { root = {
			set_timed_fleet_flag = { flag = ag_action_distance_intel_cooldown days = @ag_science_constructor_distance_intel_cooldown }
			owner = {
				set_country_flag = ag_enabled_sci_constructor_intel_selector
				country_event = { id = ag_system_selector.1 }
			}
		} }
		ag_close_action_window = yes
	}
}

ag_action_lost_ancient_ship_auto_outpost = {
	potential = { hidden_trigger = {
		is_scope_type = fleet exists = owner owner = { is_same_value = root.from } has_fleet_flag = ag_ship_action_target_@owner
		from = { NOT = { has_country_flag = ag_lost_ancient_ship_auto_outpost } }
		root = { any_controlled_ship = { has_ship_flag = ag_lost_ancient_ship } }
	} }
	allow = { hidden_trigger = { always = yes } }
	effect = {
		custom_tooltip = "ag_lost_ancient_ship_auto_outpost_effect"
		hidden_effect = { from = { set_country_flag = ag_lost_ancient_ship_auto_outpost } }
	}
}
ag_action_lost_ancient_ship_auto_outpost_alt = {
	potential = { hidden_trigger = {
		is_scope_type = fleet exists = owner owner = { is_same_value = root.from } has_fleet_flag = ag_ship_action_target_@owner
		from = { has_country_flag = ag_lost_ancient_ship_auto_outpost }
		root = { any_controlled_ship = { has_ship_flag = ag_lost_ancient_ship } }
	} }
	allow = { hidden_trigger = { always = yes } }
	effect = {
		custom_tooltip = "ag_lost_ancient_ship_auto_outpost_effect_alt"
		hidden_effect = { from = { remove_country_flag = ag_lost_ancient_ship_auto_outpost } }
	}
}
ag_lost_ancient_ship_auto_station_on = {
	potential = { hidden_trigger = { from = { NOT = { has_country_flag = ag_lost_ancient_ship_auto_station } } } }
	allow = { hidden_trigger = { always = yes } }
	effect = { hidden_effect = { from = { set_country_flag = ag_lost_ancient_ship_auto_station } } }
}
ag_lost_ancient_ship_auto_station_off = {
	potential = { hidden_trigger = { from = { has_country_flag = ag_lost_ancient_ship_auto_station } } }
	allow = { hidden_trigger = { always = yes } }
	effect = { hidden_effect = { from = { remove_country_flag = ag_lost_ancient_ship_auto_station } } }
}
ag_lost_ancient_ship_auto_hyper_relay_on = {
	potential = { hidden_trigger = { from = { NOT = { has_country_flag = ag_lost_ancient_ship_auto_hyper_relay } } } }
	allow = { hidden_trigger = { always = yes } }
	effect = { hidden_effect = { from = { set_country_flag = ag_lost_ancient_ship_auto_hyper_relay } } }
}
ag_lost_ancient_ship_auto_hyper_relay_off = {
	potential = { hidden_trigger = { from = { has_country_flag = ag_lost_ancient_ship_auto_hyper_relay } } }
	allow = { hidden_trigger = { always = yes } }
	effect = { hidden_effect = { from = { remove_country_flag = ag_lost_ancient_ship_auto_hyper_relay } } }
}

ag_action_observation_outpost_mission = {
	potential = { hidden_trigger = {
		is_scope_type = fleet exists = owner owner = { is_same_value = root.from } has_fleet_flag = ag_ship_action_target_@owner
		exists = event_target:ag_primitive_world
		from = { NOR = {
			has_global_flag = ag_primitive_research_mission_global_flag
			has_country_flag = ag_primitive_research_mission_flag
		} }
		root = { any_controlled_ship = { is_ship_size = observation_station exists = solar_system solar_system = { has_star_flag = ag_primitive_system } } }
		event_target:ag_primitive_world = { exists = observation_outpost observation_outpost = { NOT = { has_mission = ag_primitive_research_mission } } }
	} }
	allow = { hidden_trigger = { always = yes } }
	effect = {
		custom_tooltip = "mission_ag_primitive_research_mission"
		hidden_effect = { event_target:ag_primitive_world.observation_outpost = { set_mission = ag_primitive_research_mission } }
		ag_close_action_window = yes
	}
}
ag_action_observation_outpost_mission_alt = {
	potential = { hidden_trigger = {
		is_scope_type = fleet exists = owner owner = { is_same_value = root.from } has_fleet_flag = ag_ship_action_target_@owner
		exists = event_target:ag_primitive_world
		from = { NOR = {
			has_global_flag = ag_primitive_research_mission_global_flag
			has_country_flag = ag_primitive_research_mission_flag
		} }
		root = { any_controlled_ship = { is_ship_size = observation_station exists = solar_system solar_system = { has_star_flag = ag_primitive_system } } }
		event_target:ag_primitive_world = { exists = observation_outpost observation_outpost = { has_mission = ag_primitive_research_mission } }
	} }
	allow = { hidden_trigger = { always = yes } }
	effect = { custom_tooltip = "mission_ag_primitive_research_mission" }
}
ag_action_observation_outpost_mission_2 = {
	potential = { hidden_trigger = {
		is_scope_type = fleet exists = owner owner = { is_same_value = root.from } has_fleet_flag = ag_ship_action_target_@owner
		exists = event_target:ag_primitive_world_2
		from = { NOR = {
			has_global_flag = ag_primitive_2_research_mission_global_flag
			has_country_flag = ag_primitive_2_research_mission_flag
		} }
		root = { any_controlled_ship = { is_ship_size = observation_station exists = solar_system solar_system = { has_star_flag = ag_primitive_system_2 } } }
		event_target:ag_primitive_world_2 = { exists = observation_outpost observation_outpost = { NOT = { has_mission = ag_primitive_2_research_mission } } }
	} }
	allow = { hidden_trigger = { always = yes } }
	effect = {
		custom_tooltip = "mission_ag_primitive_research_mission"
		hidden_effect = { event_target:ag_primitive_world_2.observation_outpost = { set_mission = ag_primitive_2_research_mission } }
		ag_close_action_window = yes
	}
}
ag_action_observation_outpost_mission_2_alt = {
	potential = { hidden_trigger = {
		is_scope_type = fleet exists = owner owner = { is_same_value = root.from } has_fleet_flag = ag_ship_action_target_@owner
		exists = event_target:ag_primitive_world_2
		from = { NOR = {
			has_global_flag = ag_primitive_2_research_mission_global_flag
			has_country_flag = ag_primitive_2_research_mission_flag
		} }
		root = { any_controlled_ship = { is_ship_size = observation_station exists = solar_system solar_system = { has_star_flag = ag_primitive_system_2 } } }
		event_target:ag_primitive_world_2 = { exists = observation_outpost observation_outpost = { has_mission = ag_primitive_2_research_mission } }
	} }
	allow = { hidden_trigger = { always = yes } }
	effect = { custom_tooltip = "mission_ag_primitive_research_mission" }
}

ag_action_common_no_effect = {
	potential = { hidden_trigger = {
		is_scope_type = fleet exists = owner owner = { is_same_value = root.from } has_fleet_flag = ag_ship_action_target_@owner
		NOT = { any_controlled_ship = { OR = { ag_is_ancient_titan_alt = yes has_ship_flag = ag_lost_ancient_ship } } }
	} }
	allow = { hidden_trigger = { always = yes } }
	effect = { custom_tooltip = "ag_action_no_effect" }
}
ag_action_ancient_ship_anti_cloak = {
	potential = { hidden_trigger = {
		is_scope_type = fleet exists = owner owner = { is_same_value = root.from } has_fleet_flag = ag_ship_action_target_@owner
		any_controlled_ship = { OR = { ag_is_ancient_titan_alt = yes has_ship_flag = ag_lost_ancient_ship } }
	} }
	allow = {
		custom_tooltip = {
			fail_text = "ag_requires_no_anti_cloak_cooldown"
			any_controlled_ship = { OR = { ag_is_ancient_titan_alt = yes has_ship_flag = ag_lost_ancient_ship } NOT = { has_ship_flag = ag_ancient_ship_anti_cloak_cooldown } }
		}
	}
	effect = {
		custom_tooltip = "ag_ancient_ship_anti_cloak_effect"
		hidden_effect = {
			random_controlled_ship = { limit = { OR = { ag_is_ancient_titan_alt = yes has_ship_flag = ag_lost_ancient_ship } } set_timed_ship_flag = { flag = ag_ancient_ship_anti_cloak_cooldown days = @ag_ancient_ship_anti_cloak_cooldown_days } }
			solar_system = {
				every_fleet_in_system = {
					limit = { exists = owner owner = { NOT = { is_same_value = root.from } is_hostile = root.from } is_cloaked = yes }
					set_cloaking_active = no
					every_owned_ship = {
						limit = { NOT = { has_ship_flag = ag_ancient_empire_mod_ship } }
						ag_reduce_hp_percent = { ag_value = 10 } ag_spawn_explosion_effect = { ag_color = red ag_scale = m }
					}
					controller = { if = { limit = { NOT = { has_country_flag = ag_ancient_1052_mutex } } set_timed_country_flag = { flag = ag_ancient_1052_mutex days = 2 } country_event = { id = ag_ancient.1052 } } }
				}
				every_neighbor_system = {
					limit = { has_hyperlane_to = prev }
					every_fleet_in_system = {
						limit = { exists = owner owner = { NOT = { is_same_value = root.from } is_hostile = root.from } is_cloaked = yes }
						set_cloaking_active = no
						every_owned_ship = {
							limit = { NOT = { has_ship_flag = ag_ancient_empire_mod_ship } }
							ag_reduce_hp_percent = { ag_value = 10 } ag_spawn_explosion_effect = { ag_color = red ag_scale = m }
						}
						controller = { if = { limit = { NOT = { has_country_flag = ag_ancient_1052_mutex } } set_timed_country_flag = { flag = ag_ancient_1052_mutex days = 2 } country_event = { id = ag_ancient.1052 } } }
					}
					every_neighbor_system = {
						limit = { has_hyperlane_to = prev }
						every_fleet_in_system = {
							limit = { exists = owner owner = { NOT = { is_same_value = root.from } is_hostile = root.from } is_cloaked = yes }
							set_cloaking_active = no
							every_owned_ship = {
								limit = { NOT = { has_ship_flag = ag_ancient_empire_mod_ship } }
								ag_reduce_hp_percent = { ag_value = 10 } ag_spawn_explosion_effect = { ag_color = red ag_scale = m }
							}
							controller = { if = { limit = { NOT = { has_country_flag = ag_ancient_1052_mutex } } set_timed_country_flag = { flag = ag_ancient_1052_mutex days = 2 } country_event = { id = ag_ancient.1052 } } }
						}
					}
				}
			}
			ag_close_action_window = yes
		}
	}
}
