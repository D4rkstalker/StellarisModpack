
ag_eta_gateway_galactic_gateway_active = {
	potential = { hidden_trigger = {
		exists = event_target:ag_eta_gateway_ctrl_target_system
		event_target:ag_eta_gateway_ctrl_target_system = {
			NOT = { any_system_megastructure = {
				is_megastructure_type = ag_ancient_eta_gateway_galactic_gateway
			} }
		}
	} }
	allow = {
		custom_tooltip = {
			fail_text = "ag_eta_gateway_galactic_gateway_failed"
			hidden_trigger = { from = { OR = {
				has_technology = tech_gateway_activation
				has_technology = tech_gateway_construction
			} } }
		}
		custom_tooltip = {
			fail_text = "ag_eta_gateway_working"
			event_target:ag_eta_gateway_ctrl_target_system = {
				NOT = { any_system_megastructure = {
					has_megastructure_flag = ag_eta_gateway_working
					OR = {
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_2
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_4
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_opening
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_closing
					}
				} }
			}
		}
		custom_tooltip = {
			fail_text = "ag_requires_no_galactic_gateway"
			event_target:ag_eta_gateway_ctrl_target_system = {
				NOT = { any_system_megastructure = { OR = {
					is_megastructure_type = gateway_0
					is_megastructure_type = gateway_final
					is_megastructure_type = gateway_ruined
					is_megastructure_type = gateway_restored
				} } }
			}
		}
		from = { resource_stockpile_compare = { resource = energy value >= 5000 } }
	}
	effect = {
		custom_tooltip = "ag_eta_gateway_galactic_gateway_active_desc"
		from = { add_resource = { energy = -5000 } }
		hidden_effect = { event_target:ag_eta_gateway_ctrl_target_system = { random_system_megastructure = {
			limit = { OR = {
				is_megastructure_type = ag_ancient_eta_gateway_megastructure_2
				is_megastructure_type = ag_ancient_eta_gateway_megastructure_4
			} }
			ag_eta_gateway_opening_effect = { ag_galactic_gateway = yes }
		} } }
	}
}
ag_eta_gateway_galactic_gateway_active_alt = {
	potential = { hidden_trigger = {
		exists = event_target:ag_eta_gateway_ctrl_target_system
		event_target:ag_eta_gateway_ctrl_target_system = {
			any_system_megastructure = { is_megastructure_type = ag_ancient_eta_gateway_galactic_gateway }
		}
	} }
	allow = {
		custom_tooltip = {
			fail_text = "ag_eta_gateway_galactic_gateway_failed"
			hidden_trigger = { from = { OR = {
				has_technology = tech_gateway_activation
				has_technology = tech_gateway_construction
			} } }
		}
		custom_tooltip = {
			fail_text = "ag_eta_gateway_working"
			event_target:ag_eta_gateway_ctrl_target_system = {
				NOT = { any_system_megastructure = {
					has_megastructure_flag = ag_eta_gateway_working
					OR = {
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_2
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_4
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_opening
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_closing
					}
				} }
			}
		}
	}
	effect = { custom_tooltip = "ag_eta_gateway_galactic_gateway_active_alt_desc" }
}
ag_eta_gateway_galactic_gateway_deactive = {
	potential = { hidden_trigger = {
		exists = event_target:ag_eta_gateway_ctrl_target_system
		event_target:ag_eta_gateway_ctrl_target_system = {
			any_system_megastructure = { is_megastructure_type = ag_ancient_eta_gateway_galactic_gateway }
		}
	} }
	allow = {
		custom_tooltip = {
			fail_text = "ag_eta_gateway_galactic_gateway_failed"
			hidden_trigger = { from = { OR = {
				has_technology = tech_gateway_activation
				has_technology = tech_gateway_construction
			} } }
		}
		custom_tooltip = {
			fail_text = "ag_eta_gateway_working"
			event_target:ag_eta_gateway_ctrl_target_system = {
				NOT = { any_system_megastructure = {
					has_megastructure_flag = ag_eta_gateway_working
					OR = {
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_2
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_4
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_opening
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_closing
					}
				} }
			}
		}
		from = { resource_stockpile_compare = { resource = energy value >= 500 } }
	}
	effect = {
		custom_tooltip = "ag_eta_gateway_galactic_gateway_deactive_desc"
		from = { add_resource = { energy = -500 } }
		hidden_effect = { event_target:ag_eta_gateway_ctrl_target_system = { random_system_megastructure = {
			limit = { is_megastructure_type = ag_ancient_eta_gateway_megastructure_2 }
			ag_eta_remove_gateway_portal = { ag_type = galactic_gateway }
			ag_eta_gateway_closing_effect = yes
		} } }
	}
}
ag_eta_gateway_galactic_gateway_deactive_alt = {
	potential = { hidden_trigger = {
		exists = event_target:ag_eta_gateway_ctrl_target_system
		event_target:ag_eta_gateway_ctrl_target_system = {
			NOT = { any_system_megastructure = {
				is_megastructure_type = ag_ancient_eta_gateway_galactic_gateway
			} }
		}
	} }
	allow = {
		custom_tooltip = {
			fail_text = "ag_eta_gateway_galactic_gateway_failed"
			hidden_trigger = { from = { OR = {
				has_technology = tech_gateway_activation
				has_technology = tech_gateway_construction
			} } }
		}
		custom_tooltip = {
			fail_text = "ag_eta_gateway_working"
			event_target:ag_eta_gateway_ctrl_target_system = {
				NOT = { any_system_megastructure = {
					has_megastructure_flag = ag_eta_gateway_working
					OR = {
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_2
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_4
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_opening
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_closing
					}
				} }
			}
		}
	}
	effect = { custom_tooltip = "ag_eta_gateway_galactic_gateway_deactive_alt_desc" }
}

ag_eta_gateway_lgate_desc = {
	potential = { hidden_trigger = { always = yes } }
	allow = { hidden_trigger = { always = yes } }
	effect = { custom_tooltip = "ag_eta_gateway_lgate_desc" }
}
ag_eta_gateway_lgate_active = {
	potential = { hidden_trigger = {
		exists = event_target:ag_eta_gateway_ctrl_target_system
		event_target:ag_eta_gateway_ctrl_target_system = {
			NOT = { any_system_megastructure = {
				is_megastructure_type = ag_ancient_eta_gateway_lgate
			} }
		}
	} }
	allow = {
		custom_tooltip = {
			fail_text = "ag_eta_gateway_lgate_failed_no_lgate"
			from = { has_country_flag = ag_has_activated_lgate_in_system }
		}
		custom_tooltip = {
			fail_text = "ag_requires_tech_ag_ancient_eta_gateway_lgate"
			from = { has_technology = tech_ag_ancient_eta_gateway_lgate }
		}
		custom_tooltip = {
			fail_text = "ag_eta_gateway_working"
			event_target:ag_eta_gateway_ctrl_target_system = {
				NOT = { any_system_megastructure = {
					has_megastructure_flag = ag_eta_gateway_working
					OR = {
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_2
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_4
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_opening
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_closing
					}
				} }
			}
		}
		custom_tooltip = {
			fail_text = "ag_requires_no_lgate"
			event_target:ag_eta_gateway_ctrl_target_system = {
				NOT = { any_system_megastructure = { is_megastructure_type = lgate_base } }
			}
		}
		from = { resource_stockpile_compare = { resource = energy value >= 5000 } }
	}
	effect = {
		custom_tooltip = "ag_eta_gateway_lgate_active_desc"
		from = { add_resource = { energy = -5000 } }
		hidden_effect = { event_target:ag_eta_gateway_ctrl_target_system = { random_system_megastructure = {
			limit = { OR = {
				is_megastructure_type = ag_ancient_eta_gateway_megastructure_2
				is_megastructure_type = ag_ancient_eta_gateway_megastructure_4
			} }
			ag_eta_gateway_opening_effect = { ag_lgate = yes }
		} } }
	}
}
ag_eta_gateway_lgate_active_alt = {
	potential = { hidden_trigger = {
		exists = event_target:ag_eta_gateway_ctrl_target_system
		event_target:ag_eta_gateway_ctrl_target_system = {
			any_system_megastructure = { is_megastructure_type = ag_ancient_eta_gateway_lgate }
		}
	} }
	allow = {
		custom_tooltip = {
			fail_text = "ag_eta_gateway_lgate_failed_no_lgate"
			from = { has_country_flag = ag_has_activated_lgate_in_system }
		}
		custom_tooltip = {
			fail_text = "ag_requires_tech_ag_ancient_eta_gateway_lgate"
			from = { has_technology = tech_ag_ancient_eta_gateway_lgate }
		}
		custom_tooltip = {
			fail_text = "ag_eta_gateway_working"
			event_target:ag_eta_gateway_ctrl_target_system = {
				NOT = { any_system_megastructure = {
					has_megastructure_flag = ag_eta_gateway_working
					OR = {
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_2
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_4
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_opening
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_closing
					}
				} }
			}
		}
	}
	effect = { custom_tooltip = "ag_eta_gateway_lgate_active_alt_desc" }
}
ag_eta_gateway_lgate_deactive = {
	potential = { hidden_trigger = {
		exists = event_target:ag_eta_gateway_ctrl_target_system
		event_target:ag_eta_gateway_ctrl_target_system = {
			any_system_megastructure = { is_megastructure_type = ag_ancient_eta_gateway_lgate }
		}
	} }
	allow = {
		custom_tooltip = {
			fail_text = "ag_eta_gateway_lgate_failed_no_lgate"
			from = { has_country_flag = ag_has_activated_lgate_in_system }
		}
		custom_tooltip = {
			fail_text = "ag_requires_tech_ag_ancient_eta_gateway_lgate"
			from = { has_technology = tech_ag_ancient_eta_gateway_lgate }
		}
		custom_tooltip = {
			fail_text = "ag_eta_gateway_working"
			event_target:ag_eta_gateway_ctrl_target_system = {
				NOT = { any_system_megastructure = {
					has_megastructure_flag = ag_eta_gateway_working
					OR = {
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_2
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_4
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_opening
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_closing
					}
				} }
			}
		}
		from = { resource_stockpile_compare = { resource = energy value >= 500 } }
	}
	effect = {
		custom_tooltip = "ag_eta_gateway_lgate_deactive_desc"
		from = { add_resource = { energy = -500 } }
		hidden_effect = { event_target:ag_eta_gateway_ctrl_target_system = { random_system_megastructure = {
			limit = { is_megastructure_type = ag_ancient_eta_gateway_megastructure_2 }
			ag_eta_remove_gateway_portal = { ag_type = lgate }
			solar_system = { remove_star_flag = lcluster1 remove_star_flag = lgate }
			ag_eta_gateway_closing_effect = yes
		} } }
	}
}
ag_eta_gateway_lgate_deactive_alt = {
	potential = { hidden_trigger = {
		exists = event_target:ag_eta_gateway_ctrl_target_system
		event_target:ag_eta_gateway_ctrl_target_system = {
			NOT = { any_system_megastructure = {
				is_megastructure_type = ag_ancient_eta_gateway_lgate
			} }
		}
	} }
	allow = {
		custom_tooltip = {
			fail_text = "ag_eta_gateway_lgate_failed_no_lgate"
			from = { has_country_flag = ag_has_activated_lgate_in_system }
		}
		custom_tooltip = {
			fail_text = "ag_requires_tech_ag_ancient_eta_gateway_lgate"
			from = { has_technology = tech_ag_ancient_eta_gateway_lgate }
		}
		custom_tooltip = {
			fail_text = "ag_eta_gateway_working"
			event_target:ag_eta_gateway_ctrl_target_system = {
				NOT = { any_system_megastructure = {
					has_megastructure_flag = ag_eta_gateway_working
					OR = {
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_2
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_4
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_opening
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_closing
					}
				} }
			}
		}
	}
	effect = { custom_tooltip = "ag_eta_gateway_lgate_deactive_alt_desc" }
}
ag_eta_gateway_lgate_nexus = {
	potential = { hidden_trigger = {
		exists = event_target:ag_eta_gateway_ctrl_target_system
		event_target:ag_eta_gateway_ctrl_target_system = { NOT = { has_star_flag = lcluster1 } }
	} }
	allow = {
		custom_tooltip = {
			fail_text = "ag_eta_gateway_lgate_failed_deactivated"
			event_target:ag_eta_gateway_ctrl_target_system = {
				any_system_megastructure = { is_megastructure_type = ag_ancient_eta_gateway_lgate }
			}
		}
		custom_tooltip = {
			fail_text = "ag_eta_gateway_lgate_failed_no_lgate"
			from = { has_country_flag = ag_has_activated_lgate_in_system }
		}
		custom_tooltip = {
			fail_text = "ag_requires_tech_ag_ancient_eta_gateway_lgate"
			from = { has_technology = tech_ag_ancient_eta_gateway_lgate }
		}
		custom_tooltip = {
			fail_text = "ag_eta_gateway_working"
			event_target:ag_eta_gateway_ctrl_target_system = {
				NOT = { any_system_megastructure = {
					has_megastructure_flag = ag_eta_gateway_working
					OR = {
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_2
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_4
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_opening
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_closing
					}
				} }
			}
		}
		from = { resource_stockpile_compare = { resource = energy value >= 1000 } }
	}
	effect = {
		custom_tooltip = "ag_eta_gateway_lgate_settings_nexus_desc"
		from = { add_resource = { energy = -1000 } }
		hidden_effect = { event_target:ag_eta_gateway_ctrl_target_system = { set_star_flag = lcluster1 } }
	}
}
ag_eta_gateway_lgate_nexus_alt = {
	potential = { hidden_trigger = {
		exists = event_target:ag_eta_gateway_ctrl_target_system
		event_target:ag_eta_gateway_ctrl_target_system = {
			any_system_megastructure = { is_megastructure_type = ag_ancient_eta_gateway_lgate }
			has_star_flag = lcluster1
		}
	} }
	allow = {
		custom_tooltip = {
			fail_text = "ag_eta_gateway_lgate_failed_deactivated"
			event_target:ag_eta_gateway_ctrl_target_system = {
				any_system_megastructure = { is_megastructure_type = ag_ancient_eta_gateway_lgate }
			}
		}
		custom_tooltip = {
			fail_text = "ag_eta_gateway_lgate_failed_no_lgate"
			from = { has_country_flag = ag_has_activated_lgate_in_system }
		}
		custom_tooltip = {
			fail_text = "ag_requires_tech_ag_ancient_eta_gateway_lgate"
			from = { has_technology = tech_ag_ancient_eta_gateway_lgate }
		}
		custom_tooltip = {
			fail_text = "ag_eta_gateway_working"
			event_target:ag_eta_gateway_ctrl_target_system = {
				NOT = { any_system_megastructure = {
					has_megastructure_flag = ag_eta_gateway_working
					OR = {
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_2
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_4
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_opening
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_closing
					}
				} }
			}
		}
		from = { resource_stockpile_compare = { resource = energy value >= 1000 } }
	}
	effect = {
		custom_tooltip = "ag_eta_gateway_lgate_settings_nexus_desc"
		from = { add_resource = { energy = -1000 } }
		hidden_effect = { event_target:ag_eta_gateway_ctrl_target_system = { remove_star_flag = lcluster1 } }
	}
}
ag_eta_gateway_lgate_node = {
	potential = { hidden_trigger = {
		exists = event_target:ag_eta_gateway_ctrl_target_system
		event_target:ag_eta_gateway_ctrl_target_system = { NOT = { has_star_flag = lgate } }
	} }
	allow = {
		custom_tooltip = {
			fail_text = "ag_eta_gateway_lgate_failed_deactivated"
			event_target:ag_eta_gateway_ctrl_target_system = {
				any_system_megastructure = { is_megastructure_type = ag_ancient_eta_gateway_lgate }
			}
		}
		custom_tooltip = {
			fail_text = "ag_eta_gateway_lgate_failed_no_lgate"
			from = { has_country_flag = ag_has_activated_lgate_in_system }
		}
		custom_tooltip = {
			fail_text = "ag_requires_tech_ag_ancient_eta_gateway_lgate"
			from = { has_technology = tech_ag_ancient_eta_gateway_lgate }
		}
		custom_tooltip = {
			fail_text = "ag_eta_gateway_working"
			event_target:ag_eta_gateway_ctrl_target_system = {
				NOT = { any_system_megastructure = {
					has_megastructure_flag = ag_eta_gateway_working
					OR = {
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_2
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_4
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_opening
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_closing
					}
				} }
			}
		}
		from = { resource_stockpile_compare = { resource = energy value >= 1000 } }
	}
	effect = {
		custom_tooltip = "ag_eta_gateway_lgate_settings_node_desc"
		from = { add_resource = { energy = -1000 } }
		hidden_effect = { event_target:ag_eta_gateway_ctrl_target_system = { set_star_flag = lgate } }
	}
}
ag_eta_gateway_lgate_node_alt = {
	potential = { hidden_trigger = {
		exists = event_target:ag_eta_gateway_ctrl_target_system
		event_target:ag_eta_gateway_ctrl_target_system = {
			any_system_megastructure = { is_megastructure_type = ag_ancient_eta_gateway_lgate }
			has_star_flag = lgate
		}
	} }
	allow = {
		custom_tooltip = {
			fail_text = "ag_eta_gateway_lgate_failed_deactivated"
			event_target:ag_eta_gateway_ctrl_target_system = {
				any_system_megastructure = { is_megastructure_type = ag_ancient_eta_gateway_lgate }
			}
		}
		custom_tooltip = {
			fail_text = "ag_eta_gateway_lgate_failed_no_lgate"
			from = { has_country_flag = ag_has_activated_lgate_in_system }
		}
		custom_tooltip = {
			fail_text = "ag_requires_tech_ag_ancient_eta_gateway_lgate"
			from = { has_technology = tech_ag_ancient_eta_gateway_lgate }
		}
		custom_tooltip = {
			fail_text = "ag_eta_gateway_working"
			event_target:ag_eta_gateway_ctrl_target_system = {
				NOT = { any_system_megastructure = {
					has_megastructure_flag = ag_eta_gateway_working
					OR = {
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_2
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_4
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_opening
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_closing
					}
				} }
			}
		}
		from = { resource_stockpile_compare = { resource = energy value >= 1000 } }
	}
	effect = {
		custom_tooltip = "ag_eta_gateway_lgate_settings_node_desc"
		from = { add_resource = { energy = -1000 } }
		hidden_effect = { event_target:ag_eta_gateway_ctrl_target_system = { remove_star_flag = lgate } }
	}
}

ag_eta_gateway_ancient_gateway_desc = {
	potential = { hidden_trigger = { always = yes } }
	allow = { hidden_trigger = { always = yes } }
	effect = { custom_tooltip = "ag_eta_gateway_ancient_gateway_desc" }
}
ag_eta_gateway_ancient_gateway_active = {
	potential = { hidden_trigger = {
		exists = event_target:ag_eta_gateway_ctrl_target_system
		event_target:ag_eta_gateway_ctrl_target_system = {
			NOT = { any_system_megastructure = {
				is_megastructure_type = ag_ancient_eta_gateway_ancient_gateway
			} }
		}
	} }
	allow = {
		custom_tooltip = {
			fail_text = "ag_requires_tech_ag_ancient_eta_gateway_ancients"
			from = { has_technology = tech_ag_ancient_eta_gateway_ancients }
		}
		custom_tooltip = {
			fail_text = "ag_eta_gateway_working"
			event_target:ag_eta_gateway_ctrl_target_system = {
				NOT = { any_system_megastructure = {
					has_megastructure_flag = ag_eta_gateway_working
					OR = {
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_2
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_4
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_opening
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_closing
					}
				} }
			}
		}
		from = {
			resource_stockpile_compare = { resource = energy value >= 5000 }
			resource_stockpile_compare = { resource = sr_dark_matter value >= 800 }
		}
	}
	effect = {
		custom_tooltip = "ag_eta_gateway_ancient_gateway_active_desc"
		from = { add_resource = { energy = -5000 sr_dark_matter = -800 } }
		hidden_effect = { event_target:ag_eta_gateway_ctrl_target_system = { random_system_megastructure = {
			limit = { OR = {
				is_megastructure_type = ag_ancient_eta_gateway_megastructure_2
				is_megastructure_type = ag_ancient_eta_gateway_megastructure_4
			} }
			ag_eta_gateway_opening_effect = { ag_ancient_gateway = yes }
		} } }
	}
}
ag_eta_gateway_ancient_gateway_active_alt = {
	potential = { hidden_trigger = {
		exists = event_target:ag_eta_gateway_ctrl_target_system
		event_target:ag_eta_gateway_ctrl_target_system = {
			any_system_megastructure = { is_megastructure_type = ag_ancient_eta_gateway_ancient_gateway }
		}
	} }
	allow = {
		custom_tooltip = {
			fail_text = "ag_requires_tech_ag_ancient_eta_gateway_ancients"
			from = { has_technology = tech_ag_ancient_eta_gateway_ancients }
		}
		custom_tooltip = {
			fail_text = "ag_eta_gateway_working"
			event_target:ag_eta_gateway_ctrl_target_system = {
				NOT = { any_system_megastructure = {
					has_megastructure_flag = ag_eta_gateway_working
					OR = {
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_2
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_4
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_opening
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_closing
					}
				} }
			}
		}
	}
	effect = { custom_tooltip = "ag_eta_gateway_ancient_gateway_active_alt_desc" }
}
ag_eta_gateway_ancient_gateway_deactive = {
	potential = { hidden_trigger = {
		exists = event_target:ag_eta_gateway_ctrl_target_system
		event_target:ag_eta_gateway_ctrl_target_system = {
			any_system_megastructure = { is_megastructure_type = ag_ancient_eta_gateway_ancient_gateway }
		}
	} }
	allow = {
		custom_tooltip = {
			fail_text = "ag_requires_tech_ag_ancient_eta_gateway_ancients"
			from = { has_technology = tech_ag_ancient_eta_gateway_ancients }
		}
		custom_tooltip = {
			fail_text = "ag_eta_gateway_working"
			event_target:ag_eta_gateway_ctrl_target_system = {
				NOT = { any_system_megastructure = {
					has_megastructure_flag = ag_eta_gateway_working
					OR = {
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_2
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_4
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_opening
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_closing
					}
				} }
			}
		}
		from = { resource_stockpile_compare = { resource = energy value >= 500 } }
	}
	effect = {
		custom_tooltip = "ag_eta_gateway_ancient_gateway_deactive_desc"
		from = { add_resource = { energy = -500 } }
		hidden_effect = { event_target:ag_eta_gateway_ctrl_target_system = { random_system_megastructure = {
			limit = { is_megastructure_type = ag_ancient_eta_gateway_megastructure_2 }
			ag_eta_remove_gateway_portal = { ag_type = ancient_gateway }
			ag_eta_gateway_closing_effect = yes
		} } }
	}
}
ag_eta_gateway_ancient_gateway_deactive_alt = {
	potential = { hidden_trigger = {
		exists = event_target:ag_eta_gateway_ctrl_target_system
		event_target:ag_eta_gateway_ctrl_target_system = {
			NOT = { any_system_megastructure = {
				is_megastructure_type = ag_ancient_eta_gateway_ancient_gateway
			} }
		}
	} }
	allow = {
		custom_tooltip = {
			fail_text = "ag_requires_tech_ag_ancient_eta_gateway_ancients"
			from = { has_technology = tech_ag_ancient_eta_gateway_ancients }
		}
		custom_tooltip = {
			fail_text = "ag_eta_gateway_working"
			event_target:ag_eta_gateway_ctrl_target_system = {
				NOT = { any_system_megastructure = {
					has_megastructure_flag = ag_eta_gateway_working
					OR = {
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_2
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_4
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_opening
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_closing
					}
				} }
			}
		}
	}
	effect = { custom_tooltip = "ag_eta_gateway_ancient_gateway_deactive_alt_desc" }
}
ag_eta_gateway_ancient_gateway_policy_normal = {
	potential = { hidden_trigger = { from = { OR = { has_country_flag = ag_ancient_eta_gateway_policy_white has_country_flag = ag_ancient_eta_gateway_policy_black } } } }
	allow = {
		custom_tooltip = {
			fail_text = "ag_requires_tech_ag_ancient_eta_gateway_ancients"
			from = { has_technology = tech_ag_ancient_eta_gateway_ancients }
		}
		custom_tooltip = {
			fail_text = "ag_eta_gateway_working"
			event_target:ag_eta_gateway_ctrl_target_system = {
				NOT = { any_system_megastructure = {
					has_megastructure_flag = ag_eta_gateway_working
					OR = {
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_2
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_4
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_opening
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_closing
					}
				} }
			}
		}
	}
	effect = {
		custom_tooltip = "ag_eta_gateway_ancient_gateway_policy_normal_desc"
		hidden_effect = { from = {
			remove_country_flag = ag_ancient_eta_gateway_policy_white
			remove_country_flag = ag_ancient_eta_gateway_policy_black
		} }
	}
}
ag_eta_gateway_ancient_gateway_policy_normal_alt = {
	potential = { hidden_trigger = { from = { NOR = { has_country_flag = ag_ancient_eta_gateway_policy_white has_country_flag = ag_ancient_eta_gateway_policy_black } } } }
	allow = {
		custom_tooltip = {
			fail_text = "ag_requires_tech_ag_ancient_eta_gateway_ancients"
			from = { has_technology = tech_ag_ancient_eta_gateway_ancients }
		}
		custom_tooltip = {
			fail_text = "ag_eta_gateway_working"
			event_target:ag_eta_gateway_ctrl_target_system = {
				NOT = { any_system_megastructure = {
					has_megastructure_flag = ag_eta_gateway_working
					OR = {
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_2
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_4
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_opening
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_closing
					}
				} }
			}
		}
	}
	effect = { custom_tooltip = "ag_eta_gateway_ancient_gateway_policy_normal_desc" }
}
ag_eta_gateway_ancient_gateway_policy_white = {
	potential = { hidden_trigger = { from = { NOT = { has_country_flag = ag_ancient_eta_gateway_policy_white } } } }
	allow = {
		custom_tooltip = {
			fail_text = "ag_requires_tech_ag_ancient_eta_gateway_ancients"
			from = { has_technology = tech_ag_ancient_eta_gateway_ancients }
		}
		custom_tooltip = {
			fail_text = "ag_eta_gateway_working"
			event_target:ag_eta_gateway_ctrl_target_system = {
				NOT = { any_system_megastructure = {
					has_megastructure_flag = ag_eta_gateway_working
					OR = {
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_2
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_4
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_opening
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_closing
					}
				} }
			}
		}
	}
	effect = {
		custom_tooltip = "ag_eta_gateway_ancient_gateway_policy_white_desc"
		hidden_effect = { from = { set_country_flag = ag_ancient_eta_gateway_policy_white remove_country_flag = ag_ancient_eta_gateway_policy_black } }
	}
}
ag_eta_gateway_ancient_gateway_policy_white_alt = {
	potential = { hidden_trigger = { from = { has_country_flag = ag_ancient_eta_gateway_policy_white } } }
	allow = {
		custom_tooltip = {
			fail_text = "ag_requires_tech_ag_ancient_eta_gateway_ancients"
			from = { has_technology = tech_ag_ancient_eta_gateway_ancients }
		}
		custom_tooltip = {
			fail_text = "ag_eta_gateway_working"
			event_target:ag_eta_gateway_ctrl_target_system = {
				NOT = { any_system_megastructure = {
					has_megastructure_flag = ag_eta_gateway_working
					OR = {
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_2
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_4
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_opening
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_closing
					}
				} }
			}
		}
	}
	effect = { custom_tooltip = "ag_eta_gateway_ancient_gateway_policy_white_desc" }
}
ag_eta_gateway_ancient_gateway_policy_white_option = {
	potential = { hidden_trigger = { from = { has_country_flag = ag_ancient_eta_gateway_policy_white } } }
	allow = {
		custom_tooltip = {
			fail_text = "ag_requires_tech_ag_ancient_eta_gateway_ancients"
			from = { has_technology = tech_ag_ancient_eta_gateway_ancients }
		}
		custom_tooltip = {
			fail_text = "ag_eta_gateway_working"
			event_target:ag_eta_gateway_ctrl_target_system = {
				NOT = { any_system_megastructure = {
					has_megastructure_flag = ag_eta_gateway_working
					OR = {
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_2
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_4
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_opening
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_closing
					}
				} }
			}
		}
	}
	effect = {
		custom_tooltip = "ag_eta_gateway_ancient_gateway_policy_white_option_desc"
		hidden_effect = { from = { set_country_flag = ag_eta_gateway_country_selector country_event = { id = ag_country_selector.1 } } }
	}
}
ag_eta_gateway_ancient_gateway_policy_black = {
	potential = { hidden_trigger = { from = { NOT = { has_country_flag = ag_ancient_eta_gateway_policy_black } } } }
	allow = {
		custom_tooltip = {
			fail_text = "ag_requires_tech_ag_ancient_eta_gateway_ancients"
			from = { has_technology = tech_ag_ancient_eta_gateway_ancients }
		}
		custom_tooltip = {
			fail_text = "ag_eta_gateway_working"
			event_target:ag_eta_gateway_ctrl_target_system = {
				NOT = { any_system_megastructure = {
					has_megastructure_flag = ag_eta_gateway_working
					OR = {
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_2
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_4
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_opening
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_closing
					}
				} }
			}
		}
	}
	effect = {
		custom_tooltip = "ag_eta_gateway_ancient_gateway_policy_black_desc"
		hidden_effect = { from = { set_country_flag = ag_ancient_eta_gateway_policy_black remove_country_flag = ag_ancient_eta_gateway_policy_white } }
	}
}
ag_eta_gateway_ancient_gateway_policy_black_alt = {
	potential = { hidden_trigger = { from = { has_country_flag = ag_ancient_eta_gateway_policy_black } } }
	allow = {
		custom_tooltip = {
			fail_text = "ag_requires_tech_ag_ancient_eta_gateway_ancients"
			from = { has_technology = tech_ag_ancient_eta_gateway_ancients }
		}
		custom_tooltip = {
			fail_text = "ag_eta_gateway_working"
			event_target:ag_eta_gateway_ctrl_target_system = {
				NOT = { any_system_megastructure = {
					has_megastructure_flag = ag_eta_gateway_working
					OR = {
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_2
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_4
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_opening
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_closing
					}
				} }
			}
		}
	}
	effect = { custom_tooltip = "ag_eta_gateway_ancient_gateway_policy_black_desc" }
}
ag_eta_gateway_ancient_gateway_policy_black_option = {
	potential = { hidden_trigger = { from = { has_country_flag = ag_ancient_eta_gateway_policy_black } } }
	allow = {
		custom_tooltip = {
			fail_text = "ag_requires_tech_ag_ancient_eta_gateway_ancients"
			from = { has_technology = tech_ag_ancient_eta_gateway_ancients }
		}
		custom_tooltip = {
			fail_text = "ag_eta_gateway_working"
			event_target:ag_eta_gateway_ctrl_target_system = {
				NOT = { any_system_megastructure = {
					has_megastructure_flag = ag_eta_gateway_working
					OR = {
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_2
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_4
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_opening
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_closing
					}
				} }
			}
		}
	}
	effect = {
		custom_tooltip = "ag_eta_gateway_ancient_gateway_policy_black_option_desc"
		hidden_effect = { from = { set_country_flag = ag_eta_gateway_country_selector country_event = { id = ag_country_selector.1 } } }
	}
}

ag_eta_gateway_wormhole_temporary_desc = {
	potential = { hidden_trigger = { always = yes } }
	allow = { hidden_trigger = { always = yes } }
	effect = { custom_tooltip = "ag_eta_gateway_wormhole_temporary_desc" }
}
ag_eta_gateway_wormhole_temporary_active = {
	potential = { hidden_trigger = {
		exists = event_target:ag_eta_gateway_ctrl_target_system
		event_target:ag_eta_gateway_ctrl_target_system = {
			NOT = { any_system_megastructure = {
				is_megastructure_type = ag_ancient_eta_gateway_wormhole_temporary
			} }
		}
	} }
	allow = {
		custom_tooltip = {
			fail_text = "ag_requires_tech_ag_ancient_eta_gateway_wormhole"
			from = { has_technology = tech_ag_ancient_eta_gateway_wormhole }
		}
		custom_tooltip = {
			fail_text = "ag_requires_target_system"
			exists = event_target:ag_eta_gateway_wormhole_temporary_target_system
		}
		custom_tooltip = {
			fail_text = "ag_requires_gateway_no_cooldown"
			NOT = { has_global_flag = ag_eta_gateway_wormhole_cooldown }
		}
		custom_tooltip = {
			fail_text = "ag_eta_gateway_working"
			event_target:ag_eta_gateway_ctrl_target_system = {
				NOT = { any_system_megastructure = {
					has_megastructure_flag = ag_eta_gateway_working
					OR = {
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_2
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_4
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_opening
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_closing
					}
				} }
			}
		}
		from = {
			resource_stockpile_compare = { resource = energy value >= 6000 }
			resource_stockpile_compare = { resource = sr_dark_matter value >= 1500 }
		}
	}
	effect = {
		custom_tooltip = "ag_eta_gateway_wormhole_temporary_active_desc"
		from = { add_resource = { energy = -6000 sr_dark_matter = -1500 } }
		hidden_effect = {
			event_target:ag_eta_gateway_ctrl_target_system = { random_system_megastructure = {
				limit = { OR = {
					is_megastructure_type = ag_ancient_eta_gateway_megastructure_2
					is_megastructure_type = ag_ancient_eta_gateway_megastructure_4
				} }
				ag_eta_gateway_opening_effect = { ag_wormhole_temporary = yes }
			} }
			event_target:ag_eta_gateway_wormhole_temporary_target_system = {
				create_ambient_object = { type = ag_eta_gateway_wormhole_windup_object location = this }
				last_created_ambient_object = { set_ambient_object_flag = ag_eta_gateway_wormhole_windup_object }
			}
		}
	}
}
ag_eta_gateway_wormhole_temporary_active_alt = {
	potential = { hidden_trigger = {
		exists = event_target:ag_eta_gateway_ctrl_target_system
		event_target:ag_eta_gateway_ctrl_target_system = {
			any_system_megastructure = { is_megastructure_type = ag_ancient_eta_gateway_wormhole_temporary }
		}
	} }
	allow = {
		custom_tooltip = {
			fail_text = "ag_requires_tech_ag_ancient_eta_gateway_wormhole"
			from = { has_technology = tech_ag_ancient_eta_gateway_wormhole }
		}
		custom_tooltip = {
			fail_text = "ag_requires_target_system"
			exists = event_target:ag_eta_gateway_wormhole_temporary_target_system
		}
		custom_tooltip = {
			fail_text = "ag_requires_gateway_no_cooldown"
			NOT = { has_global_flag = ag_eta_gateway_wormhole_cooldown }
		}
		custom_tooltip = {
			fail_text = "ag_eta_gateway_working"
			event_target:ag_eta_gateway_ctrl_target_system = {
				NOT = { any_system_megastructure = {
					has_megastructure_flag = ag_eta_gateway_working
					OR = {
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_2
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_4
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_opening
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_closing
					}
				} }
			}
		}
	}
	effect = { custom_tooltip = "ag_eta_gateway_wormhole_temporary_active_alt_desc" }
}
ag_eta_gateway_wormhole_temporary_deactive = {
	potential = { hidden_trigger = {
		exists = event_target:ag_eta_gateway_ctrl_target_system
		event_target:ag_eta_gateway_ctrl_target_system = {
			any_system_megastructure = { is_megastructure_type = ag_ancient_eta_gateway_wormhole_temporary }
		}
	} }
	allow = {
		custom_tooltip = {
			fail_text = "ag_requires_tech_ag_ancient_eta_gateway_wormhole"
			from = { has_technology = tech_ag_ancient_eta_gateway_wormhole }
		}
		custom_tooltip = {
			fail_text = "ag_eta_gateway_working"
			event_target:ag_eta_gateway_ctrl_target_system = {
				NOT = { any_system_megastructure = {
					has_megastructure_flag = ag_eta_gateway_working
					OR = {
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_2
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_4
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_opening
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_closing
					}
				} }
			}
		}
		from = { resource_stockpile_compare = { resource = energy value >= 500 } }
	}
	effect = {
		custom_tooltip = "ag_eta_gateway_wormhole_temporary_deactive_desc"
		from = { add_resource = { energy = -500 } }
		hidden_effect = { event_target:ag_eta_gateway_ctrl_target_system = { random_system_megastructure = {
			limit = { is_megastructure_type = ag_ancient_eta_gateway_megastructure_2 }
			ag_eta_remove_gateway_portal = { ag_type = wormhole_temporary }
			ag_eta_gateway_closing_effect = yes
		} } }
	}
}
ag_eta_gateway_wormhole_temporary_deactive_alt = {
	potential = { hidden_trigger = {
		exists = event_target:ag_eta_gateway_ctrl_target_system
		event_target:ag_eta_gateway_ctrl_target_system = {
			NOT = { any_system_megastructure = {
				is_megastructure_type = ag_ancient_eta_gateway_wormhole_temporary
			} }
		}
	} }
	allow = {
		custom_tooltip = {
			fail_text = "ag_requires_tech_ag_ancient_eta_gateway_wormhole"
			from = { has_technology = tech_ag_ancient_eta_gateway_wormhole }
		}
		custom_tooltip = {
			fail_text = "ag_requires_target_system"
			exists = event_target:ag_eta_gateway_wormhole_temporary_target_system
		}
		custom_tooltip = {
			fail_text = "ag_requires_gateway_no_cooldown"
			NOT = { has_global_flag = ag_eta_gateway_wormhole_cooldown }
		}
		custom_tooltip = {
			fail_text = "ag_eta_gateway_working"
			event_target:ag_eta_gateway_ctrl_target_system = {
				NOT = { any_system_megastructure = {
					has_megastructure_flag = ag_eta_gateway_working
					OR = {
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_2
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_4
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_opening
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_closing
					}
				} }
			}
		}
	}
	effect = { custom_tooltip = "ag_eta_gateway_wormhole_temporary_deactive_alt_desc" }
}
ag_eta_gateway_wormhole_temporary_select_system = {
	potential = { hidden_trigger = { NOT = {
		exists = event_target:ag_eta_gateway_wormhole_temporary_target_system
	} } }
	allow = {
		custom_tooltip = {
			fail_text = "ag_requires_tech_ag_ancient_eta_gateway_wormhole"
			from = { has_technology = tech_ag_ancient_eta_gateway_wormhole }
		}
		custom_tooltip = {
			fail_text = "ag_requires_no_actived_wormhole"
			exists = event_target:ag_eta_gateway_ctrl_target_system
			event_target:ag_eta_gateway_ctrl_target_system = {
				NOT = { any_system_megastructure = {
					is_megastructure_type = ag_ancient_eta_gateway_wormhole_temporary
				} }
			}
		}
		custom_tooltip = {
			fail_text = "ag_eta_gateway_working"
			event_target:ag_eta_gateway_ctrl_target_system = {
				NOT = { any_system_megastructure = {
					has_megastructure_flag = ag_eta_gateway_working
					OR = {
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_2
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_4
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_opening
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_closing
					}
				} }
			}
		}
	}
	effect = { hidden_effect = { from = { set_country_flag = ag_enabled_eta_wormhole_target_selector country_event = { id = ag_system_selector.1 } } } }
}
ag_eta_gateway_wormhole_temporary_select_system_alt = {
	potential = { hidden_trigger = { exists = event_target:ag_eta_gateway_wormhole_temporary_target_system } }
	allow = {
		custom_tooltip = {
			fail_text = "ag_requires_tech_ag_ancient_eta_gateway_wormhole"
			from = { has_technology = tech_ag_ancient_eta_gateway_wormhole }
		}
		custom_tooltip = {
			fail_text = "ag_requires_no_actived_wormhole"
			exists = event_target:ag_eta_gateway_ctrl_target_system
			event_target:ag_eta_gateway_ctrl_target_system = {
				NOT = { any_system_megastructure = {
					is_megastructure_type = ag_ancient_eta_gateway_wormhole_temporary
				} }
			}
		}
		custom_tooltip = {
			fail_text = "ag_eta_gateway_working"
			event_target:ag_eta_gateway_ctrl_target_system = {
				NOT = { any_system_megastructure = {
					has_megastructure_flag = ag_eta_gateway_working
					OR = {
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_2
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_4
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_opening
						is_megastructure_type = ag_ancient_eta_gateway_megastructure_closing
					}
				} }
			}
		}
	}
	effect = { hidden_effect = { from = { set_country_flag = ag_enabled_eta_wormhole_target_selector country_event = { id = ag_system_selector.1 } } } }
}
