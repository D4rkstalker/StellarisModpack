
ag_ship_action_button = {
	potential = { hidden_trigger = { is_scope_type = fleet has_fleet_flag = ag_has_ancient_ship_in_fleet } }
	allow = { hidden_trigger = { exists = owner owner = { is_same_value = from } } }
	effect = { ag_ship_action_button_effect = yes }
}

ag_deploy_ancient_turret_help = {
	potential = { is_scope_type = fleet has_fleet_flag = ag_delta_platform_player exists = owner }
	allow = { owner = { is_same_value = from } }
	effect = { custom_tooltip = "ag_deploy_ancient_turret_help" }
}
ag_deploy_ancient_turret = {
	potential = { is_scope_type = fleet has_fleet_flag = ag_delta_platform_player exists = owner }
	allow = {
		owner = { is_same_value = from has_technology = tech_ag_delta_platform }
		custom_tooltip = {
			fail_text = "ag_ancient_turret_deploying"
			NOT = { has_fleet_flag = ag_delta_platform_deploying }
		}
	}
	effect = {
		custom_tooltip = "ag_deploy_ancient_turret_single_effect"
		hidden_effect = {
			if = {
				limit = { owner = { has_country_flag = ag_ship_subsystem_enabled_402_14 } }
				ag_deploy_ancient_turret_preparation = { ag_delay = 2 }
			}
			else = { ag_deploy_ancient_turret_preparation = { ag_delay = 5 } }
		}
	}
}
ag_deploy_ancient_turret_system = {
	potential = { is_scope_type = fleet has_fleet_flag = ag_delta_platform_player exists = owner }
	allow = {
		owner = { is_same_value = from has_technology = tech_ag_delta_platform }
		custom_tooltip = {
			fail_text = "ag_ancient_turret_deploying"
			NOT = { has_fleet_flag = ag_delta_platform_deploying }
		}
	}
	effect = {
		custom_tooltip = "ag_deploy_ancient_turret_system_effect"
		hidden_effect = {
			if = {
				limit = { owner = { has_country_flag = ag_ship_subsystem_enabled_402_14 } }
				solar_system = {
					every_fleet_in_system = {
						limit = {
							exists = owner
							owner = { is_same_value = prevprevprev.owner }
							has_fleet_flag = ag_delta_platform_player
							NOT = { has_fleet_flag = ag_delta_platform_deploying }
						}
						ag_deploy_ancient_turret_preparation = { ag_delay = 2 }
					}
				}
			}
			else = {
				solar_system = {
					every_fleet_in_system = {
						limit = {
							exists = owner
							owner = { is_same_value = prevprevprev.owner }
							has_fleet_flag = ag_delta_platform_player
							NOT = { has_fleet_flag = ag_delta_platform_deploying }
						}
						ag_deploy_ancient_turret_preparation = { ag_delay = 5 }
					}
				}
			}
		}
	}
}
ag_deploy_ancient_turret_all = {
	potential = { is_scope_type = fleet has_fleet_flag = ag_delta_platform_player exists = owner }
	allow = {
		owner = { is_same_value = from has_technology = tech_ag_delta_platform }
		custom_tooltip = {
			fail_text = "ag_ancient_turret_deploying"
			NOT = { has_fleet_flag = ag_delta_platform_deploying }
		}
	}
	effect = {
		custom_tooltip = "ag_deploy_ancient_turret_all_effect"
		hidden_effect = {
			if = {
				limit = { owner = { has_country_flag = ag_ship_subsystem_enabled_402_14 } }
				owner = {
					every_owned_fleet = {
						limit = {
							has_fleet_flag = ag_delta_platform_player
							NOT = { has_fleet_flag = ag_delta_platform_deploying }
						}
						ag_deploy_ancient_turret_preparation = { ag_delay = 2 }
					}
				}
			}
			else = {
				owner = {
					every_owned_fleet = {
						limit = {
							has_fleet_flag = ag_delta_platform_player
							NOT = { has_fleet_flag = ag_delta_platform_deploying }
						}
						ag_deploy_ancient_turret_preparation = { ag_delay = 5 }
					}
				}
			}
		}
	}
}

ag_psionic_container_help = {
	potential = { is_scope_type = fleet has_fleet_flag = ag_ancient_psionic_container_player exists = owner }
	allow = { owner = { is_same_value = from } }
	effect = { custom_tooltip = "ag_psionic_container_help" }
}
ag_psionic_container_passive_mode = {
	potential = { is_scope_type = fleet has_fleet_flag = ag_ancient_psionic_container_player has_fleet_flag = ag_psionic_container_active_mode exists = owner }
	allow = { owner = { is_same_value = from } }
	effect = {
		custom_tooltip = "ag_psionic_container_passive_mode_effect"
		hidden_effect = { remove_fleet_flag = ag_psionic_container_active_mode }
	}
}
ag_psionic_container_active_mode = {
	potential = { is_scope_type = fleet has_fleet_flag = ag_ancient_psionic_container_player NOT = { has_fleet_flag = ag_psionic_container_active_mode } exists = owner }
	allow = { owner = { is_same_value = from } }
	effect = {
		custom_tooltip = "ag_psionic_container_active_mode_effect"
		hidden_effect = { set_fleet_flag = ag_psionic_container_active_mode }
	}
}
ag_psionic_container_explode = {
	potential = { is_scope_type = fleet has_fleet_flag = ag_ancient_psionic_container_player exists = owner }
	allow = {
		owner = { is_same_value = from }
		custom_tooltip = {
			fail_text = "ag_requires_psionic_container_active_mode"
			has_fleet_flag = ag_psionic_container_active_mode
		}
	}
	effect = {
		custom_tooltip = "ag_psionic_container_explode_effect"
		hidden_effect = { random_owned_ship = { ship_event = { id = ag_zeta_crisis.311 } } }
	}
}