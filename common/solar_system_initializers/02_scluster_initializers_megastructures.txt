# Filename:		02_scluster_initializers_megastructures.txt
# Contributors:	SirBlackAxe

# It seems that some unspawned systems will still block their initializers from being used, so I need to use duplicate initializers instead.

@distance = 50
@jumps = 3
@planet_min_size = 10
@planet_max_size = 25
@base_moon_distance = 10
@moon_min_size = 6
@moon_max_size = 10
@homeworld_min_size = 18
@homeworld_max_size = 24 # 21

##########################################
# federations_initializers.txt
##########################################

### Mega Shipyard - Randomly spawned
# 1 standard star, 5-7 planets w/ 0-2 moons
scluster_mega_shipyard_init_01 = {
	class = "rl_standard_stars"

	flags = { scluster ruined_mega_shipyard_system }

	max_instances = 1
	# scaled_spawn_chance = 2
	# usage = misc_system_init
	# usage_odds = {
	# 	base = 0
	# 	modifier = {
	# 		has_federations_dlc = yes
	# 		add = 100
	# 	}
	# }

	# Star
	planet = {
		count = 1
		class = star
		orbit_distance = 0
		orbit_angle = 1
		size = { min = 20 max = 30 }
		has_ring = no
	}

	change_orbit = 35

	# Inner misc. planets
	planet = {
		count = {
			min = 5 # 3
			max = 7
		}
		orbit_distance = 20
		orbit_angle = { min = 90 max = 270 }

		change_orbit = @base_moon_distance

		moon = {
			count = { min = 0 max = 2 }
			orbit_angle = { min = 90 max = 270 }
			orbit_distance = 5
		}
	}

	init_effect = {
		spawn_megastructure = {
			type = "mega_shipyard_ruined"
			planet = star

			init_effect = {
				create_ambient_object = {
					type = "large_debris_object"
					location = this
				}
				last_created_ambient_object = {
					set_location = {
						target = prev
						distance = 20
						angle = 20
					}
				}
			}
		}
	}
}

##########################################
# megacorp_intializers.txt
##########################################

# Ruined Matter Decompressor
# 1 black hole
scluster_megacorp_matter_decompressor_init_01 = {
	class = sc_black_hole

	flags = { scluster ruined_matter_decompressor_system }

	max_instances = 1
	# scaled_spawn_chance = 4
	# usage = misc_system_init
	# usage_odds = {
	# 	base = 0
	# 	modifier = {
	# 		host_has_dlc = "Megacorp"
	# 		add = 100
	# 	}
	# }

	planet = { # star, clear_deposits, matter_decompressor_hole
		class = star
		orbit_distance = 0
		init_effect = {
			save_event_target_as = matter_decompressor_hole
			clear_deposits = yes
		}
	}

	change_orbit = 200

	asteroid_belt = {
		type = icy_asteroid_belt
		radius = 110
	}

	# Add astroids?

	init_effect = {
		spawn_megastructure = {
			type = "matter_decompressor_ruined"
			planet = event_target:matter_decompressor_hole

			init_effect = {
				create_ambient_object = {
					type = "large_debris_object"
					location = this
				}
				last_created_ambient_object = {
					set_location = {
						target = prev
						distance = 20
						angle = 20
					}
				}
				create_ambient_object = {
					type = "large_debris_object"
					location = this
				}
				last_created_ambient_object = {
					set_location = {
						target = prev
						distance = 20
						angle = 150
					}
				}
				create_ambient_object = {
					type = "medium_debris_01_object"
					location = this
				}
				last_created_ambient_object = {
					set_location = {
						target = prev
						distance = 35
						angle = 90
					}
				}
				create_ambient_object = {
					type = "medium_debris_02_object"
					location = this
				}
				last_created_ambient_object = {
					set_location = {
						target = prev
						distance = 3
						angle = 270
					}
				}
			}
		}
	}
}

# Ruined Strategic Coordination Center
# 1 standard star, 5 uninhabitable planets, 6 uninhabitable moons
scluster_megacorp_strategic_coordination_center_init_01 = {
	class = "rl_standard_stars"

	flags = { scluster ruined_strategic_coordination_center_system }

	max_instances = 1
	# scaled_spawn_chance = 4
	# usage = misc_system_init
	# usage_odds = {
	# 	base = 0
	# 	modifier = {
	# 		host_has_dlc = "Megacorp"
	# 		add = 100
	# 	}
	# }

	planet = { # star, coordination_location
		class = star
		orbit_distance = 0
		init_effect = {
			save_event_target_as = coordination_location
		}
	}

	change_orbit = 55

	planet = { # barren size 10-15 w/ debris
		class = "pc_barren"
		size = { min = 10 max = 15 }

		init_effect = {
			create_ambient_object = {
				type = "abandoned_starbase_01_object"
				location = this
			}
			create_ambient_object = {
				type = "medium_debris_01_object"
				location = this
			}
		}
	}

	change_orbit = 25

	planet = { # gas giant size 40 w/ debris, barren size 6 moon w/ debris
		class = "pc_gas_giant"
		orbit_angle = { min = 90 max = 270 }
		size = 40

		init_effect = {
			create_ambient_object = {
				type = "abandoned_starbase_01_object"
				location = this
			}
			last_created_ambient_object = {
				set_location = {
					target = prev
					distance = 10
					angle = 270
				}
			}
			create_ambient_object = {
				type = "abandoned_starbase_01_object"
				location = this
			}
			last_created_ambient_object = {
				set_location = {
					target = prev
					distance = 10
					angle = 180
				}
			}
			create_ambient_object = {
				type = "large_debris_object"
				location = this
			}
		}

		moon = {
			class = "pc_barren"
			size = 6
			orbit_distance = 20
			orbit_angle = { min = 90 max = 270 }
			has_ring = no

			init_effect = {
				create_ambient_object = {
					type = "abandoned_starbase_01_object"
					location = this
				}
				create_ambient_object = {
					type = "medium_debris_01_object"
					location = this
				}
			}
		}
	}

	change_orbit = 25

	planet = { # gas giant size 30 w/ debris; 3 uninhabitable size 6 moons (barren cold, frozen, barren)
		class = "pc_gas_giant"
		orbit_angle = { min = 90 max = 270 }
		size = 30

		init_effect = {
			create_ambient_object = {
				type = "abandoned_starbase_01_object"
				location = this
			}
			last_created_ambient_object = {
				set_location = {
					target = prev
					distance = 7
					angle = 270
				}
			}
			create_ambient_object = {
				type = "abandoned_starbase_01_object"
				location = this
			}
			last_created_ambient_object = {
				set_location = {
					target = prev
					distance = 7
					angle = 180
				}
			}
			create_ambient_object = {
				type = "abandoned_starbase_01_object"
				location = this
			}
			last_created_ambient_object = {
				set_location = {
					target = prev
					distance = 7
					angle = 0
				}
			}
			create_ambient_object = {
				type = "large_debris_object"
				location = this
			}
			last_created_ambient_object = {
				set_location = {
					target = prev
					distance = 15
					angle = 0
				}
			}
			create_ambient_object = {
				type = "large_debris_object"
				location = this
			}
			last_created_ambient_object = {
				set_location = {
					target = prev
					distance = 15
					angle = 180
				}
			}
		}

		moon = {
			class = "pc_barren_cold"
			size = 6
			orbit_distance = 20
			orbit_angle = { min = 90 max = 270 }
			has_ring = no
		}
		moon = {
			class = "pc_frozen"
			size = 6
			orbit_distance = 6
			orbit_angle = { min = 90 max = 270 }
			has_ring = no
		}
		moon = {
			class = "pc_barren"
			size = 6
			orbit_distance = 6
			orbit_angle = { min = 90 max = 270 }
			has_ring = no

			# init_effect = { # Removed
			# 	save_event_target_as = sentry_planet
			# }
		}
	}

	change_orbit = 25

	planet = { # gas giant size 35; 2x frozen size 6 moon
		class = "pc_gas_giant"
		orbit_angle = { min = 90 max = 270 }
		size = 35

		init_effect = {
			create_ambient_object = {
				type = "abandoned_starbase_01_object"
				location = this
			}
			last_created_ambient_object = {
				set_location = {
					target = prev
					distance = 10
					angle = 270
				}
			}
			create_ambient_object = {
				type = "abandoned_starbase_01_object"
				location = this
			}
			last_created_ambient_object = {
				set_location = {
					target = prev
					distance = 10
					angle = 180
				}
			}
			create_ambient_object = {
				type = "abandoned_starbase_01_object"
				location = this
			}
			last_created_ambient_object = {
				set_location = {
					target = prev
					distance = 10
					angle = 0
				}
			}
			create_ambient_object = {
				type = "abandoned_starbase_01_object"
				location = this
			}
			last_created_ambient_object = {
				set_location = {
					target = prev
					distance = 10
					angle = 90
				}
			}
			create_ambient_object = {
				type = "large_debris_object"
				location = this
			}
			last_created_ambient_object = {
				set_location = {
					target = prev
					distance = 15
					angle = 180
				}
			}
			create_ambient_object = {
				type = "large_debris_object"
				location = this
			}
			last_created_ambient_object = {
				set_location = {
					target = prev
					distance = 15
					angle = 0
				}
			}
			create_ambient_object = {
				type = "large_debris_object"
				location = this
			}
			last_created_ambient_object = {
				set_location = {
					target = prev
					distance = 15
					angle = 270
				}
			}
		}

		moon = {
			class = "pc_frozen"
			size = 6
			orbit_distance = 20
			orbit_angle = { min = 90 max = 270 }
			has_ring = no
		}
		moon = {
			class = "pc_frozen"
			size = 6
			orbit_distance = 6
			orbit_angle = { min = 90 max = 270 }
			has_ring = no

			init_effect = {
				create_ambient_object = {
					type = "abandoned_starbase_01_object"
					location = this
				}
				create_ambient_object = {
					type = "medium_debris_01_object"
					location = this
				}
			}
		}
	}

	change_orbit = 25

	planet = { # frozen size 10-15 w/ debris
		class = "pc_frozen"
		size = { min = 10 max = 15 }

		init_effect = {
			create_ambient_object = {
				type = "abandoned_starbase_01_object"
				location = this
			}
			create_ambient_object = {
				type = "medium_debris_02_object"
				location = this
			}
		}
	}

	init_effect = {
		spawn_megastructure = {
			type = "strategic_coordination_center_ruined"
			planet = event_target:coordination_location
		}

		create_ambient_object = {
			type = "large_debris_object"
			location = solar_system
		}
		create_ambient_object = {
			type = "large_debris_object"
			location = solar_system
		}
		create_ambient_object = {
			type = "large_debris_object"
			location = solar_system
		}
		create_ambient_object = {
			type = "medium_debris_01_object"
			location = solar_system
		}
		create_ambient_object = {
			type = "medium_debris_02_object"
			location = solar_system
		}
		create_ambient_object = {
			type = "medium_debris_01_object"
			location = solar_system
		}
		create_ambient_object = {
			type = "medium_debris_02_object"
			location = solar_system
		}
		create_ambient_object = {
			type = "small_debris_object"
			location = solar_system
		}
	}
}

# Ruined Mega Art Installation
# 3 stars, 6-10 planets, 0-10 moons
scluster_megacorp_mega_art_installation_init_01 = {
	class = "rl_trinary_stars"

	flags = { scluster ruined_mega_art_installation_system }

	max_instances = 1
	# scaled_spawn_chance = 4
	# usage = misc_system_init
	# usage_odds = {
	# 	base = 0
	# 	modifier = {
	# 		host_has_dlc = "Megacorp"
	# 		add = 100
	# 	}
	# }

	planet = { # star size 25-30, installation_star
		count = 1
		class = star
		orbit_distance = 25
		orbit_angle = 0
		size = { min = 25 max = 30 }
		has_ring = no
		init_effect = {
			save_event_target_as = installation_star
		}
	}

	planet = { # star size 25-30
		count = 1
		class = star
		orbit_distance = { min = 0 max = 20 }
		orbit_angle = 120
		size = { min = 25 max = 30 }
		has_ring = no
	}

	planet = { # star size 25-30
		count = 1
		class = star
		orbit_distance = { min = 0 max = 20 }
		orbit_angle = 120
		size = { min = 25 max = 30 }
		has_ring = no
	}

	change_orbit = 45

	planet = { # 6-10 planets w/ 0-1 moons
		count = {
			min = 6 # 2
			max = 10
		}
		orbit_distance = 20
		orbit_angle = { min = 90 max = 270 }

		change_orbit = @base_moon_distance

		moon = {
			count = { min = 0 max = 1 }
			orbit_angle = { min = 90 max = 270 }
			orbit_distance = 5
		}
	}

	init_effect = {
		spawn_megastructure = {
			type = "mega_art_installation_ruined"
			planet = event_target:installation_star
		}
		create_ambient_object = {
			type = "large_debris_object"
			location = solar_system
		}
		create_ambient_object = {
			type = "large_debris_object"
			location = solar_system
		}
		create_ambient_object = {
			type = "large_debris_object"
			location = solar_system
		}
		create_ambient_object = {
			type = "medium_debris_01_object"
			location = solar_system
		}
		create_ambient_object = {
			type = "medium_debris_02_object"
			location = solar_system
		}
		create_ambient_object = {
			type = "medium_debris_01_object"
			location = solar_system
		}
		create_ambient_object = {
			type = "medium_debris_02_object"
			location = solar_system
		}
		create_ambient_object = {
			type = "small_debris_object"
			location = solar_system
		}
	}
}

# Ruined Interstellar Assembly (a former capital system)
# 1 starting star, 3-6 random_non_colonizable planets, 1-2 gas giants, 0-12 random_non_colonizable moons
# 1-3 asteroids
# 1 ideal_planet_class homeworld size / generate_empire_home_planet = yes
scluster_megacorp_interstellar_assembly_init_01 = {
	class = "rl_starting_stars"
	asteroid_belt = {
		type = rocky_asteroid_belt
		radius = 50
	}

	max_instances = 1
	# scaled_spawn_chance = 4
	# usage = misc_system_init
	# usage_odds = {
	# 	base = 0
	# 	modifier = {
	# 		host_has_dlc = "Megacorp"
	# 		add = 100
	# 	}
	# }

	flags = { scluster ruined_interstellar_assembly_system }

	planet = { # star size 20-30
		count = 1
		class = star
		orbit_distance = 0
		orbit_angle = 1
		size = { min = 20 max = 30 }
		has_ring = no
	}

	init_effect = {
		generate_home_system_resources = yes
		spawn_megastructure = {
			type = "interstellar_assembly_ruined"
			planet = star

			init_effect = {
				create_ambient_object = {
					type = "large_debris_object"
					location = this
				}
				last_created_ambient_object = {
					set_location = {
						target = prev
						distance = 20
						angle = 20
					}
				}
				create_ambient_object = {
					type = "large_debris_object"
					location = this
				}
				last_created_ambient_object = {
					set_location = {
						target = prev
						distance = 20
						angle = 150
					}
				}
				create_ambient_object = {
					type = "medium_debris_01_object"
					location = this
				}
				last_created_ambient_object = {
					set_location = {
						target = prev
						distance = 35
						angle = 90
					}
				}
				create_ambient_object = {
					type = "medium_debris_02_object"
					location = this
				}
				last_created_ambient_object = {
					set_location = {
						target = prev
						distance = 3
						angle = 270
					}
				}
			}
		}
	}

	change_orbit = 50

	planet = { # 3 asteroids
		count = 3 # { min = 1 max = 3 }
		class = pc_asteroid
		orbit_distance = 0
		orbit_angle = { min = 40 max = 100 }
	}

	planet = { # 1-2 random_non_colonizable planets w/ 0-1 random_non_colonizable moons
		class = random_non_colonizable
		count = {
			min = 1 # 0
			max = 2
		}
		orbit_distance = 20
		orbit_angle = { min = 90 max = 270 }

		change_orbit = @base_moon_distance

		moon = {
			count = { min = 0 max = 1 }
			class = random_non_colonizable
			orbit_angle = { min = 90 max = 270 }
			orbit_distance = 5
		}
	}

	planet = { # 1 ideal_planet_class homeworld size w/ 0-1 random_non_colonizable moon, generate_empire_home_planet = yes
		count = 1
		orbit_distance = 20
		home_planet = yes
		class = ideal_planet_class
		orbit_angle = { min = 90 max = 270 }
		size = { min = @homeworld_min_size max = @homeworld_max_size }
		deposit_blockers = none
		modifiers = none

		init_effect = {
			generate_empire_home_planet = yes
		}

		change_orbit = @base_moon_distance

		moon = {
			count = { min = 0 max = 1 }
			class = random_non_colonizable
			orbit_angle = { min = 90 max = 270 }
			orbit_distance = 5
		}
	}

	planet = { # 2-4 random_non_colonizable w/ 0-1 random_non_colonizable moons
		class = random_non_colonizable
		count = { min = 2 max = 4 }
		orbit_distance = 20
		orbit_angle = { min = 90 max = 270 }

		change_orbit = @base_moon_distance

		moon = {
			class = random_non_colonizable
			count = { min = 0 max = 1 }
			orbit_angle = { min = 90 max = 270 }
			orbit_distance = 5
		}
	}

	planet = { # 1-2 gas giant w/ 0-3 random_non_colonizable moons
		class = pc_gas_giant
		count = { min = 1 max = 2 }
		orbit_distance = 20
		orbit_angle = { min = 90 max = 270 }

		change_orbit = @base_moon_distance

		moon = {
			class = random_non_colonizable
			count = { min = 0 max = 3 }
			orbit_angle = { min = 90 max = 270 }
			orbit_distance = 5
		}
	}
}

##########################################
# overlord_initializers.txt
##########################################

# Ruined Quantum Catapult
# pulsar w/ no deposits, 3-6 planets, 0-6 moons
scluster_quantum_catapult_init_01 = {
	class = sc_pulsar

	flags = { scluster ruined_catapult_system }

	max_instances = 1
	# scaled_spawn_chance = 4
	# usage = misc_system_init
	# usage_odds = {
	# 	base = 100
	# 	modifier = {
	# 		factor = 0
	# 		has_overlord_dlc = no
	# 	}
	# }

	planet = { # star, clear_deposits
		class = star
		orbit_distance = 0
		init_effect = {
			save_event_target_as = quantum_catapult_star
			clear_deposits = yes
			prevent_anomaly = yes # Added
		}
	}

	change_orbit = 45

	planet = { # 3-6 planets w/ 0-1 moons
		count = {
			min = 3 # 1
			max = 6
		}
		orbit_distance = 20
		orbit_angle = { min = 90 max = 270 }

		change_orbit = @base_moon_distance

		moon = {
			count = { min = 0 max = 1 }
			orbit_angle = { min = 90 max = 270 }
			orbit_distance = 5
		}
	}

	init_effect = {
		spawn_megastructure = {
			type = "quantum_catapult_ruined"
			planet = event_target:quantum_catapult_star

			init_effect = {
				create_ambient_object = {
					type = "large_debris_object"
					location = this
				}
				last_created_ambient_object = {
					set_location = {
						target = prev
						distance = 20
						angle = 20
					}
				}
				create_ambient_object = {
					type = "large_debris_object"
					location = this
				}
				last_created_ambient_object = {
					set_location = {
						target = prev
						distance = 20
						angle = 150
					}
				}
				create_ambient_object = {
					type = "medium_debris_01_object"
					location = this
				}
				last_created_ambient_object = {
					set_location = {
						target = prev
						distance = 35
						angle = 90
					}
				}
				create_ambient_object = {
					type = "medium_debris_02_object"
					location = this
				}
				last_created_ambient_object = {
					set_location = {
						target = prev
						distance = 3
						angle = 270
					}
				}
			}
		}
	}
}

# Ruined Orbital Ring
# 2 stars, 1 random_non_colonizable planet
# 2-3 asteroids, 1-2 ice asteroids
# 1 random_colonizable w/ ruined orbital ring
scluster_orbital_ring_init_01 = {
	class = "rl_binary_stars"
	asteroid_belt = {
		type = icy_asteroid_belt
		radius = 145
	}
	flags = { scluster ruined_orbital_ring_system }

	max_instances = 1
	# scaled_spawn_chance = 8	#by galaxy size
	# usage = misc_system_init
	# usage_odds = {
	# 	base = 100
	# 	modifier = {
	# 		factor = 0
	# 		has_overlord_dlc = no
	# 	}
	# 	modifier = {
	# 		factor = 0
	# 		has_star_flag = empire_cluster
	# 	}
	# 	modifier = {
	# 		factor = 0.2
	# 		closest_system = {
	# 			has_megastructure = ring_world_ruined
	# 			distance = {
	# 				source = prev
	# 				max_distance <= 200
	# 			}
	# 		}
	# 	}
	# }

	planet = { # star, size 18-30
		count = 1
		class = star
		orbit_distance = 30
		orbit_angle = 0
		size = { min = 18 max = 30 }
		has_ring = no
	}

	planet = { # star, size 15-25
		count = 1
		class = star
		orbit_distance = 0
		size = { min = 15 max = 25 }
		has_ring = no
	}

	planet = { # 1 random_non_colonizable, size 8-12
		count = 1
		class = random_non_colonizable
		orbit_distance = 45
		orbit_angle = { min = 90 max = 270 }
		size = { min = 8 max = 12 }
		has_ring = no
	}

	planet = { # 2-3 asteroids
		count = { min = 2 max = 3 }
		class = pc_asteroid
		orbit_distance = 15
		orbit_angle = { min = 90 max = 270 }
	}

	planet = { # random_colonizable w/ ruined orbital ring, size 8-14
		count = 1
		class = random_colonizable
		orbit_distance = 20
		orbit_angle = { min = 90 max = 270 }
		size = { min = 8 max = 14 }
		has_ring = no
		flags = { ruined_orbital_ring_planet }
		init_effect = {
			prevent_anomaly = yes
			save_event_target_as = ruined_orbital_ring_planet
		}
	}

	planet = { # 1-2 ice asteroid
		count = { min = 1 max = 2 }
		class = pc_ice_asteroid
		orbit_distance = 20
		orbit_angle = { min = 90 max = 270 }
	}

	init_effect = {
		spawn_megastructure = {
			type = "orbital_ring_ruined"
			planet = event_target:ruined_orbital_ring_planet

			init_effect = {
				create_ambient_object = {
					type = "medium_debris_01_object"
					location = this
				}
				last_created_ambient_object = {
					set_location = {
						target = prev
						distance = 8
						angle = 90
					}
				}
				create_ambient_object = {
					type = "medium_debris_02_object"
					location = this
				}
				last_created_ambient_object = {
					set_location = {
						target = prev
						distance = 3
						angle = 270
					}
				}
			}
		}
	}
}

##########################################
# utopia_initializers.txt
##########################################

# Ruined Dyson Sphere
# 1 standard star, 2-4 rl_unhabitable_planets
scluster_dyson_sphere_init_01 = {
	class = "rl_standard_stars"

	flags = { scluster ruined_dyson_system scluster_prescripted_habitable_planets_disabled }

	max_instances = 1
	# scaled_spawn_chance = 2
	# usage = misc_system_init
	# usage_odds = {
	# 	base = 0
	# 	modifier = {
	# 		host_has_dlc = "Utopia"
	# 		add = 100
	# 	}
	# }

	planet = { # star, 24 debris objects
		class = star
		orbit_distance = 0

		init_effect = {
			create_ambient_object = {
				type = "large_debris_object"
				entity_offset_height = { min = -0 max = -20 }
				location = this
			}
			last_created_ambient_object = {
				set_location = {
					target = prev
					distance = 25
					angle = random
				}
			}
			create_ambient_object = {
				type = "large_debris_object"
				entity_offset_height = { min = -0 max = -20 }
				location = this
			}
			last_created_ambient_object = {
				set_location = {
					target = prev
					distance = 22
					angle = random
				}
			}
			create_ambient_object = {
				type = "large_debris_object"
				entity_offset_height = { min = -0 max = -20 }
				location = this
			}
			last_created_ambient_object = {
				set_location = {
					target = prev
					distance = 31
					angle = random
				}
			}
			create_ambient_object = {
				type = "medium_debris_01_object"
				entity_offset_height = { min = -0 max = -20 }
				location = this
			}
			last_created_ambient_object = {
				set_location = {
					target = prev
					distance = 27
					angle = random
				}
			}
			create_ambient_object = {
				type = "medium_debris_02_object"
				entity_offset_height = { min = -0 max = -20 }
				location = this
			}
			last_created_ambient_object = {
				set_location = {
					target = prev
					distance = 23
					angle = random
				}
			}
			create_ambient_object = {
				type = "medium_debris_01_object"
				entity_offset_height = { min = -0 max = -20 }
				location = this
			}
			last_created_ambient_object = {
				set_location = {
					target = prev
					distance = 26
					angle = random
				}
			}
			create_ambient_object = {
				type = "medium_debris_02_object"
				entity_offset_height = { min = -0 max = -20 }
				location = this
			}
			last_created_ambient_object = {
				set_location = {
					target = prev
					distance = 28
					angle = random
				}
			}
			create_ambient_object = {
				type = "small_debris_object"
				entity_offset_height = { min = -0 max = -20 }
				location = this
			}
			last_created_ambient_object = {
				set_location = {
					target = prev
					distance = 22
					angle = random
				}
			}
			create_ambient_object = {
				type = "large_debris_object"
				location = this
			}
			last_created_ambient_object = {
				set_location = {
					target = prev
					distance = 35
					angle = 70
				}
			}
			create_ambient_object = {
				type = "large_debris_object"
				location = this
			}
			last_created_ambient_object = {
				set_location = {
					target = prev
					distance = 50
					angle = 100
				}
			}
			create_ambient_object = {
				type = "large_debris_object"
				location = this
			}
			last_created_ambient_object = {
				set_location = {
					target = prev
					distance = 65
					angle = 125
				}
			}
			create_ambient_object = {
				type = "medium_debris_01_object"
				location = this
			}
			last_created_ambient_object = {
				set_location = {
					target = prev
					distance = 47
					angle = 100
				}
			}
			create_ambient_object = {
				type = "medium_debris_02_object"
				location = this
			}
			last_created_ambient_object = {
				set_location = {
					target = prev
					distance = 51
					angle = 80
				}
			}
			create_ambient_object = {
				type = "medium_debris_01_object"
				location = this
			}
			last_created_ambient_object = {
				set_location = {
					target = prev
					distance = 40
					angle = 127
				}
			}
			create_ambient_object = {
				type = "medium_debris_02_object"
				location = this
			}
			last_created_ambient_object = {
				set_location = {
					target = prev
					distance = 55
					angle = 76
				}
			}
			create_ambient_object = {
				type = "small_debris_object"
				location = this
			}
			last_created_ambient_object = {
				set_location = {
					target = prev
					distance = 50
					angle = 120
				}
			}
			create_ambient_object = {
				type = "large_debris_object"
				location = this
			}
			last_created_ambient_object = {
				set_location = {
					target = prev
					distance = 35
					angle = 270
				}
			}
			create_ambient_object = {
				type = "large_debris_object"
				location = this
			}
			last_created_ambient_object = {
				set_location = {
					target = prev
					distance = 50
					angle = 300
				}
			}
			create_ambient_object = {
				type = "large_debris_object"
				location = this
			}
			last_created_ambient_object = {
				set_location = {
					target = prev
					distance = 65
					angle = 325
				}
			}
			create_ambient_object = {
				type = "medium_debris_01_object"
				location = this
			}
			last_created_ambient_object = {
				set_location = {
					target = prev
					distance = 47
					angle = 300
				}
			}
			create_ambient_object = {
				type = "medium_debris_02_object"
				location = this
			}
			last_created_ambient_object = {
				set_location = {
					target = prev
					distance = 51
					angle = 280
				}
			}
			create_ambient_object = {
				type = "medium_debris_01_object"
				location = this
			}
			last_created_ambient_object = {
				set_location = {
					target = prev
					distance = 40
					angle = 327
				}
			}
			create_ambient_object = {
				type = "medium_debris_02_object"
				location = this
			}
			last_created_ambient_object = {
				set_location = {
					target = prev
					distance = 55
					angle = 276
				}
			}
			create_ambient_object = {
				type = "small_debris_object"
				location = this
			}
			last_created_ambient_object = {
				set_location = {
					target = prev
					distance = 50
					angle = 320
				}
			}
		}
	}

	change_orbit = 45

	planet = { # 2-4 rl_unhabitable_planets
		class = "rl_unhabitable_planets"
		count = { min = 2 max = 4 }
		orbit_distance = 25
		orbit_angle = { min = 90 max = 270 }
	}

	init_effect = {
		spawn_megastructure = { type = "dyson_sphere_ruined" }

		create_ambient_object = {
			type = "large_debris_object"
			location = solar_system
		}
		create_ambient_object = {
			type = "large_debris_object"
			location = solar_system
		}
		create_ambient_object = {
			type = "large_debris_object"
			location = solar_system
		}
		create_ambient_object = {
			type = "medium_debris_01_object"
			location = solar_system
		}
		create_ambient_object = {
			type = "medium_debris_02_object"
			location = solar_system
		}
		create_ambient_object = {
			type = "medium_debris_01_object"
			location = solar_system
		}
		create_ambient_object = {
			type = "medium_debris_02_object"
			location = solar_system
		}
		create_ambient_object = {
			type = "small_debris_object"
			location = solar_system
		}
	}
}

# Ruined Science Nexus
# 1 black hole, 3 unihabitable planets (1 preventing anomalies)
scluster_science_nexus_init_01 = {
	class = sc_black_hole

	flags = { scluster ruined_nexus_system }

	max_instances = 1
	# scaled_spawn_chance = 4
	# usage = misc_system_init
	# usage_odds = {
	# 	base = 0
	# 	modifier = {
	# 		host_has_dlc = "Utopia"
	# 		add = 100
	# 	}
	# }

	planet = { # star
		class = star
		orbit_distance = 0
	}

	change_orbit = 90

	planet = { # pc_broken, size 10-15, prevent_anomaly
		class = "pc_broken"
		size = { min = 10 max = 15 }

		init_effect = { prevent_anomaly = yes }
	}

	change_orbit = 30

	planet = { # pc_gas_giant, size 40, nexus_planet
		class = "pc_gas_giant"
		orbit_angle = { min = 90 max = 270 }
		size = 40

		init_effect = {
			save_event_target_as = nexus_planet
		}
	}

	change_orbit = 40

	planet = { # pc_barren_cold, size 10-15
		class = "pc_barren_cold"
		orbit_angle = { min = 90 max = 270 }
		size = { min = 10 max = 15 }
	}

	init_effect = {
		spawn_megastructure = {
			type = "think_tank_ruined"
			planet = event_target:nexus_planet

			init_effect = {
				create_ambient_object = {
					type = "large_debris_object"
					location = this
				}
				last_created_ambient_object = {
					set_location = {
						target = prev
						distance = 20
						angle = 20
					}
				}
				create_ambient_object = {
					type = "large_debris_object"
					location = this
				}
				last_created_ambient_object = {
					set_location = {
						target = prev
						distance = 20
						angle = 150
					}
				}
				create_ambient_object = {
					type = "medium_debris_01_object"
					location = this
				}
				last_created_ambient_object = {
					set_location = {
						target = prev
						distance = 35
						angle = 90
					}
				}
				create_ambient_object = {
					type = "medium_debris_02_object"
					location = this
				}
				last_created_ambient_object = {
					set_location = {
						target = prev
						distance = 3
						angle = 270
					}
				}
			}
		}
	}
}

# Ruined Sentry Array
# 1 standard star, 5 uninhabitable planets, 6 uninhabitable moons
# 1 tomb world w/ d_metal_boneyard
scluster_sentry_array_init_01 = {
	class = "rl_standard_stars"

	flags = { scluster ruined_sentry_system }

	max_instances = 1
	# scaled_spawn_chance = 4
	# usage = misc_system_init
	# usage_odds = {
	# 	base = 0
	# 	modifier = {
	# 		host_has_dlc = "Utopia"
	# 		add = 100
	# 	}
	# }

	planet = { # star
		class = star
		orbit_distance = 0
	}

	change_orbit = 45

	planet = { # tomb world w/ d_metal_boneyard
		class = "pc_nuked"
		size = 16

		init_effect = {
			add_deposit = d_metal_boneyard
		}
	}

	change_orbit = 25

	planet = { # barren w/ abandoned starbase & debris, size 10-15
		class = "pc_barren"
		size = { min = 10 max = 15 }

		init_effect = {
			create_ambient_object = {
				type = "abandoned_starbase_01_object"
				location = this
			}
			create_ambient_object = {
				type = "medium_debris_01_object"
				location = this
			}
		}
	}

	change_orbit = 25

	planet = { # gas giant, size 40; barren moon w/ debris, size 6
		class = "pc_gas_giant"
		orbit_angle = { min = 90 max = 270 }
		size = 40

		init_effect = {
			create_ambient_object = {
				type = "abandoned_starbase_01_object"
				location = this
			}
			last_created_ambient_object = {
				set_location = {
					target = prev
					distance = 10
					angle = 270
				}
			}
			create_ambient_object = {
				type = "abandoned_starbase_01_object"
				location = this
			}
			last_created_ambient_object = {
				set_location = {
					target = prev
					distance = 10
					angle = 180
				}
			}
			create_ambient_object = {
				type = "large_debris_object"
				location = this
			}
		}

		moon = {
			class = "pc_barren"
			size = 6
			orbit_distance = 20
			orbit_angle = { min = 90 max = 270 }
			has_ring = no

			init_effect = {
				create_ambient_object = {
					type = "abandoned_starbase_01_object"
					location = this
				}
				create_ambient_object = {
					type = "medium_debris_01_object"
					location = this
				}
			}
		}
	}

	change_orbit = 25

	planet = { # gas giant, size 30; 3 size 6 moons (barren cold, frozen, barren)
		class = "pc_gas_giant"
		orbit_angle = { min = 90 max = 270 }
		size = 30

		init_effect = {
			create_ambient_object = {
				type = "abandoned_starbase_01_object"
				location = this
			}
			last_created_ambient_object = {
				set_location = {
					target = prev
					distance = 7
					angle = 270
				}
			}
			create_ambient_object = {
				type = "abandoned_starbase_01_object"
				location = this
			}
			last_created_ambient_object = {
				set_location = {
					target = prev
					distance = 7
					angle = 180
				}
			}
			create_ambient_object = {
				type = "abandoned_starbase_01_object"
				location = this
			}
			last_created_ambient_object = {
				set_location = {
					target = prev
					distance = 7
					angle = 0
				}
			}
			create_ambient_object = {
				type = "large_debris_object"
				location = this
			}
			last_created_ambient_object = {
				set_location = {
					target = prev
					distance = 15
					angle = 0
				}
			}
			create_ambient_object = {
				type = "large_debris_object"
				location = this
			}
			last_created_ambient_object = {
				set_location = {
					target = prev
					distance = 15
					angle = 180
				}
			}
		}

		moon = {
			class = "pc_barren_cold"
			size = 6
			orbit_distance = 20
			orbit_angle = { min = 90 max = 270 }
			has_ring = no
		}
		moon = {
			class = "pc_frozen"
			size = 6
			orbit_distance = 6
			orbit_angle = { min = 90 max = 270 }
			has_ring = no
		}
		moon = {
			class = "pc_barren"
			size = 6
			orbit_distance = 6
			orbit_angle = { min = 90 max = 270 }
			has_ring = no

			init_effect = {
				save_event_target_as = sentry_planet
			}
		}
	}

	change_orbit = 25

	planet = { # gas giant size 35, 2x frozen moon size 6
		class = "pc_gas_giant"
		orbit_angle = { min = 90 max = 270 }
		size = 35

		init_effect = {
			create_ambient_object = {
				type = "abandoned_starbase_01_object"
				location = this
			}
			last_created_ambient_object = {
				set_location = {
					target = prev
					distance = 10
					angle = 270
				}
			}
			create_ambient_object = {
				type = "abandoned_starbase_01_object"
				location = this
			}
			last_created_ambient_object = {
				set_location = {
					target = prev
					distance = 10
					angle = 180
				}
			}
			create_ambient_object = {
				type = "abandoned_starbase_01_object"
				location = this
			}
			last_created_ambient_object = {
				set_location = {
					target = prev
					distance = 10
					angle = 0
				}
			}
			create_ambient_object = {
				type = "abandoned_starbase_01_object"
				location = this
			}
			last_created_ambient_object = {
				set_location = {
					target = prev
					distance = 10
					angle = 90
				}
			}
			create_ambient_object = {
				type = "large_debris_object"
				location = this
			}
			last_created_ambient_object = {
				set_location = {
					target = prev
					distance = 15
					angle = 180
				}
			}
			create_ambient_object = {
				type = "large_debris_object"
				location = this
			}
			last_created_ambient_object = {
				set_location = {
					target = prev
					distance = 15
					angle = 0
				}
			}
			create_ambient_object = {
				type = "large_debris_object"
				location = this
			}
			last_created_ambient_object = {
				set_location = {
					target = prev
					distance = 15
					angle = 270
				}
			}
		}

		moon = {
			class = "pc_frozen"
			size = 6
			orbit_distance = 20
			orbit_angle = { min = 90 max = 270 }
			has_ring = no
		}
		moon = {
			class = "pc_frozen"
			size = 6
			orbit_distance = 6
			orbit_angle = { min = 90 max = 270 }
			has_ring = no

			init_effect = {
				create_ambient_object = {
					type = "abandoned_starbase_01_object"
					location = this
				}
				create_ambient_object = {
					type = "medium_debris_01_object"
					location = this
				}
			}
		}
	}

	change_orbit = 25

	planet = { # frozen size 10-15
		class = "pc_frozen"
		size = { min = 10 max = 15 }

		init_effect = {
			create_ambient_object = {
				type = "abandoned_starbase_01_object"
				location = this
			}
			create_ambient_object = {
				type = "medium_debris_02_object"
				location = this
			}
		}
	}

	init_effect = {
		spawn_megastructure = {
			type = "spy_orb_ruined"
			planet = event_target:sentry_planet
		}

		create_ambient_object = {
			type = "large_debris_object"
			location = solar_system
		}
		create_ambient_object = {
			type = "large_debris_object"
			location = solar_system
		}
		create_ambient_object = {
			type = "large_debris_object"
			location = solar_system
		}
		create_ambient_object = {
			type = "medium_debris_01_object"
			location = solar_system
		}
		create_ambient_object = {
			type = "medium_debris_02_object"
			location = solar_system
		}
		create_ambient_object = {
			type = "medium_debris_01_object"
			location = solar_system
		}
		create_ambient_object = {
			type = "medium_debris_02_object"
			location = solar_system
		}
		create_ambient_object = {
			type = "small_debris_object"
			location = solar_system
		}
	}
}

# Ruined Ring World
scluster_ring_world_init_01 = {
	class = "rl_standard_stars"

	flags = { scluster ruined_ring_system ring_world_built } # Added ring_world_built

	max_instances = 1
	# scaled_spawn_chance = 3
	# usage = misc_system_init
	# usage_odds = {
	# 	base = 0
	# 	modifier = {
	# 		host_has_dlc = "Utopia"
	# 		add = 100
	# 	}
	# }

	planet = { # star; distar = 50% chance anomaly
		class = star
		orbit_distance = 0

		init_effect = {
			IF = {
				limit = { has_distar = yes }
				reroll_random = yes
				random_list = {
					50 = {
						add_anomaly = {
							category = DISTAR_CLONE_CAT
						}
					}
					50 = {
						#nothing
					}
				}
			}
			create_ambient_object = {
				type = "large_debris_object"
				entity_offset_height = { min = -0 max = -25 }
				location = this
			}
			last_created_ambient_object = {
				set_location = {
					target = prev
					distance = 45
					angle = random
				}
			}
			create_ambient_object = {
				type = "large_debris_object"
				entity_offset_height = { min = -0 max = -25 }
				location = this
			}
			last_created_ambient_object = {
				set_location = {
					target = prev
					distance = 45
					angle = random
				}
			}
			create_ambient_object = {
				type = "large_debris_object"
				entity_offset_height = { min = -0 max = -25 }
				location = this
			}
			last_created_ambient_object = {
				set_location = {
					target = prev
					distance = 45
					angle = random
				}
			}
			create_ambient_object = {
				type = "large_debris_object"
				entity_offset_height = { min = -0 max = -25 }
				location = this
			}
			last_created_ambient_object = {
				set_location = {
					target = prev
					distance = 45
					angle = random
				}
			}
			create_ambient_object = {
				type = "medium_debris_01_object"
				entity_offset_height = { min = -0 max = -25 }
				location = this
			}
			last_created_ambient_object = {
				set_location = {
					target = prev
					distance = 45
					angle = random
				}
			}
			create_ambient_object = {
				type = "medium_debris_02_object"
				entity_offset_height = { min = -0 max = -25 }
				location = this
			}
			last_created_ambient_object = {
				set_location = {
					target = prev
					distance = 45
					angle = random
				}
			}
			create_ambient_object = {
				type = "medium_debris_01_object"
				entity_offset_height = { min = -0 max = -25 }
				location = this
			}
			last_created_ambient_object = {
				set_location = {
					target = prev
					distance = 45
					angle = random
				}
			}
			create_ambient_object = {
				type = "medium_debris_02_object"
				entity_offset_height = { min = -0 max = -25 }
				location = this
			}
			last_created_ambient_object = {
				set_location = {
					target = prev
					distance = 45
					angle = random
				}
			}
			create_ambient_object = {
				type = "small_debris_object"
				entity_offset_height = { min = -0 max = -25 }
				location = this
			}
			last_created_ambient_object = {
				set_location = {
					target = prev
					distance = 45
					angle = random
				}
			}
		}
	}

	change_orbit = 45

	init_effect = {
		spawn_megastructure = {
			type = "ring_world_ruined"
			orbit_angle = 0
			orbit_distance = 45
		}
		spawn_megastructure = {
			type = "ring_world_ruined"
			orbit_angle = 90
			orbit_distance = 45
		}
		spawn_megastructure = {
			type = "ring_world_ruined"
			orbit_angle = 180
			orbit_distance = 45
		}
		spawn_megastructure = {
			type = "ring_world_ruined"
			orbit_angle = 270
			orbit_distance = 45
		}

		create_ambient_object = {
			type = "large_debris_object"
			location = solar_system
		}
		create_ambient_object = {
			type = "large_debris_object"
			location = solar_system
		}
		create_ambient_object = {
			type = "large_debris_object"
			location = solar_system
		}
		create_ambient_object = {
			type = "medium_debris_01_object"
			location = solar_system
		}
		create_ambient_object = {
			type = "medium_debris_02_object"
			location = solar_system
		}
		create_ambient_object = {
			type = "medium_debris_01_object"
			location = solar_system
		}
		create_ambient_object = {
			type = "medium_debris_02_object"
			location = solar_system
		}
		create_ambient_object = {
			type = "small_debris_object"
			location = solar_system
		}
	}
}
