r_shadowgate_shadowforge = {
	activation_duration = 3600
	portrait = "GFX_relic_shadowgate_shadowforge"
	sound = "sfx_relic_activation_shadowgate_shadowforge"

	resources = {
		category = relics
		cost = { influence = 150 }
	}

	ai_weight = {
		weight = 100
		modifier = {
			factor = 1.5
			any_owned_planet = { is_colonized_shadowgate = yes }
		}
	}

	triggered_country_modifier = {
		potential = { always = yes }
		custom_tooltip = shadowgate.shadowforge.passive
	}

	score = 500

	active_effect = {
		custom_tooltip = shadowgate.shadowforge.active
		custom_tooltip = relic_triumph_cooldown
		hidden_effect = {
			change_variable = { which = ShadowgateLodestonesOwned value = 1 }
			add_modifier = {
				modifier = "relic_activation_cooldown"
				days = 3600
			}
		}
	}

	possible = {
		custom_tooltip = {
			fail_text = "requires_relic_no_cooldown"
			NOT = { has_modifier = relic_activation_cooldown }
		}
		custom_tooltip = {
			fail_text = "shadowgate.crw.fail.antiresonant.void"
			NOT = { has_relic = r_shadowgate_crwt_active }
		}
	}
}

r_shadowgate_st = {
	activation_duration = 1800
	portrait = "GFX_relic_shadowgate_st"
	sound = "sfx_relic_activation_shadowgate_st"

	resources = {
		category = relics
		cost = { influence = 75 }
		produces = {
			trigger = { NOT = { exists = event_target:shadowgate_ap_country } }
			unity = 5
		}
	}

	ai_weight = { weight = 100 }

	triggered_country_modifier = {
		potential = { exists = event_target:shadowgate_ap_country }
		custom_tooltip = shadowgate.st.passive
	}

	triggered_country_modifier = {
		potential = { has_modifier = shadowgate_cpc_unspoiled }
		custom_tooltip = shadowgate.st.cpc.digsite.passive
	}

	score = 100

	active_effect = {
		custom_tooltip = shadowgate.st.active
		custom_tooltip = relic_triumph_cooldown_short
		hidden_effect = {
			set_timed_country_flag = { flag = shadowgate_st_active days = 1800 }
			add_modifier = {
				modifier = "relic_activation_cooldown"
				days = 1800
			}
		}
	}

	possible = {
		custom_tooltip = {
			fail_text = "requires_relic_no_cooldown"
			NOT = { has_modifier = relic_activation_cooldown }
		}
		custom_tooltip = {
			fail_text = "shadowgate.crw.fail.antiresonant.void"
			NOT = { has_relic = r_shadowgate_crwt_active }
		}
	}
}

r_shadowgate_crwt = {
	activation_duration = 3600
	portrait = "GFX_relic_shadowgate_crwt"
	sound = "sfx_relic_activation_shadowgate_crwt"

	resources = {
		category = relics
		cost = { influence = 150 }
	}

	ai_weight = {
		weight = 100
		modifier = {
			factor = 0
			any_owned_planet = { is_colonized_shadowgate = yes }
		}
	}

	triggered_country_modifier = {
		potential = { always = yes }
		custom_tooltip = shadowgate.crw.transmitter.passive
	}

	score = 200

	active_effect = {
		custom_tooltip = shadowgate.crw.transmitter.active
		custom_tooltip = relic_triumph_cooldown
		hidden_effect = {
			remove_relic = r_shadowgate_crwt
			add_relic = r_shadowgate_crwt_active
			every_system_within_border = { limit = { OR = { has_star_flag = shadowgate_solar_system has_star_flag = has_shadowrift } }
				if = { limit = { has_star_flag = shadowgate_solar_system NOT = { any_system_planet = { has_modifier = pm_shadowgate_disabled } } }
					save_event_target_as = shadowrift_vd_rift_system
					random_system_planet = { limit = { has_planet_flag = shadowgate_planet } planet_event = { id = shadowgate_galactic.230 } }
				}
				else_if = { limit = { NOT = { has_star_flag = has_shadow_mooring_rift } }
					save_event_target_as = shadowrift_vd_rift_system
					switch = {
						trigger = has_star_flag
						has_shadowrift_a = { event_target:shadowgate_planet_a = { planet_event = { id = shadowgate_galactic.230 } } }
						has_shadowrift_b = { event_target:shadowgate_planet_b = { planet_event = { id = shadowgate_galactic.230 } } }
						has_shadowrift_c = { event_target:shadowgate_planet_c = { planet_event = { id = shadowgate_galactic.230 } } }
						has_shadowrift_d = { event_target:shadowgate_planet_d = { planet_event = { id = shadowgate_galactic.230 } } }
						has_shadowrift_e = { event_target:shadowgate_planet_e = { planet_event = { id = shadowgate_galactic.230 } } }
					}
				}
				else = { remove_system_shadowrift = yes }
			}
			add_modifier = {
				modifier = "relic_activation_cooldown"
				days = 3600
			}
		}
	}

	possible = {
		custom_tooltip = {
			fail_text = "requires_relic_no_cooldown"
			NOT = { has_modifier = relic_activation_cooldown }
		}
	}
}

r_shadowgate_crwt_active = {
	activation_duration = 0
	portrait = "GFX_relic_shadowgate_crwt_active"
	sound = "deactive_builing"

	resources = {
		category = relics
		cost = {
			influence = 25
		}
	}

	ai_weight = {
		weight = 100
		modifier = {
			factor = 10000
			any_owned_planet = { is_colonized_shadowgate = yes }
		}
		modifier = {
			factor = 0
			NOT = { any_owned_planet = { is_colonized_shadowgate = yes } }
		}
	}

	triggered_country_modifier = {
		potential = { always = yes }
		custom_tooltip = shadowgate.crw.transmitter.passive
	}

	score = 200

	active_effect = {
		custom_tooltip = shadowgate.crw.transmitter.active
#		custom_tooltip = relic_triumph_cooldown_veryshort
		hidden_effect = {
			remove_relic = r_shadowgate_crwt_active
			add_relic = r_shadowgate_crwt
#			add_modifier = {
#				modifier = "relic_activation_cooldown"
#				days = 900
#			}
		}
	}

	possible = {
		always = yes
#		custom_tooltip = {
#			fail_text = "requires_relic_no_cooldown"
#			NOT = { has_modifier = relic_activation_cooldown }
#		}
	}
}

r_shadowgate_cpc = {
	activation_duration = 3600
	portrait = "GFX_relic_shadowgate_cpc"
	sound = "shadowgate_interface_open"

	resources = {
		category = relics
		cost = { influence = 150 }
	}

	ai_weight = {
		weight = 100
		modifier = {
			factor = 0
			OR = {
				NOT = { any_owned_planet = { is_colonized_shadowgate = yes } }
				any_owned_planet = { is_colonized_shadowgate = yes check_variable_arithmetic = { which = ShadowgateRP by = ShadowgateRPMin value < 100 mode = subtract } }
			}
		}
		modifier = {
			factor = 2
			any_owned_planet = { is_colonized_shadowgate = yes check_variable_arithmetic = { which = ShadowgateRP by = ShadowgateRPMin value >= 200 mode = subtract } }
		}
	}

	triggered_country_modifier = {
		potential = { always = yes }
		custom_tooltip = shadowgate.cpc.passive
	}

	score = 200

	active_effect = {
		custom_tooltip = shadowgate.cpc.active
		if = { limit = { NOR = { is_variable_set = ShadowgateCPCStored is_variable_set = ShadowgateCPCConverted } } custom_tooltip = shadowgate.cpc.active.static }
		else = { custom_tooltip = shadowgate.cpc.active.values }
		custom_tooltip = relic_triumph_cooldown
		hidden_effect = {
			country_event = { id = shadowgate_galactic.605 }
			add_modifier = {
				modifier = "relic_activation_cooldown"
				days = -1
			}
		}
	}

	possible = {
		custom_tooltip = {
			fail_text = "requires_relic_no_cooldown"
			NOT = { has_modifier = relic_activation_cooldown }
		}
		custom_tooltip = {
			fail_text = "no_allied_shadowgate"
			OR = {
				AND = { exists = event_target:shadowgate_ap_country event_target:shadowgate_ap_country = { has_communications = prev NOT = { is_hostile = prev } } }
				any_owned_planet = { is_colonized_shadowgate = yes check_variable = { which = ShadowgateRP value > ShadowgateRPMin } controller = { is_same_value = prev } }
				if = { limit = { count_federation_ally = { count > 0 } } any_federation_ally = { any_owned_planet = { is_colonized_shadowgate = yes controller = { is_same_value = prev } } } }
			}
		}
		custom_tooltip = {
			fail_text = "shadowgate.crw.fail.antiresonant.void"
			NOT = { has_relic = r_shadowgate_crwt_active }
		}
	}
}

r_shadowgate_ae = {
	activation_duration = 3600
	portrait = "GFX_relic_shadowgate_ae"
	sound = "sfx_relic_activation_shadowgate_ae"

	resources = {
		category = relics
		cost = { influence = 150 }
	}

	ai_weight = { weight = 0 }

	score = 200

	triggered_country_modifier = {
		potential = { always = yes }
		custom_tooltip = shadowgate.ae.passive
	}

	active_effect = {
		custom_tooltip = shadowgate.ae.active
		custom_tooltip = relic_triumph_cooldown
		hidden_effect = {
			set_timed_country_flag = { flag = shadowgate_ae_active days = 3600 }
			add_modifier = {
				modifier = "relic_activation_cooldown"
				days = 3600
			}
		}
	}

	possible = {
		custom_tooltip = {
			fail_text = "requires_relic_no_cooldown"
			NOT = { has_modifier = relic_activation_cooldown }
		}
		custom_tooltip = {
			fail_text = "shadowgate.crw.fail.antiresonant.void"
			NOT = { has_relic = r_shadowgate_crwt_active }
		}
	}
}

r_shadowgate_es = {
	activation_duration = 1800
	portrait = "GFX_relic_shadowgate_es"
	sound = "shadowgate_click"

	resources = {
		category = relics
		cost = { influence = 75 }
	}

	ai_weight = {
		weight = 100
		modifier = {
			factor = 0
			OR = {
				NOT = { is_variable_set = ShadowgateESStored }
				check_variable = { which = ShadowgateESStored value = 0 }
				NOT = { any_owned_planet = { is_colonized_shadowgate = yes check_variable = { which = ShadowgateEther value < 20 } } }
			}
		}
	}

	score = 0

	triggered_country_modifier = {
		potential = { always = yes }
		custom_tooltip = shadowgate.es.passive
	}

	active_effect = {
		custom_tooltip = shadowgate.es.active
		custom_tooltip = relic_triumph_cooldown_short
		hidden_effect = {
			country_event = { id = shadowgate_galactic.610 }
			add_modifier = {
				modifier = "relic_activation_cooldown"
				days = -1
			}
		}
	}

	possible = {
		custom_tooltip = {
			fail_text = "requires_relic_no_cooldown"
			NOT = { has_modifier = relic_activation_cooldown }
		}
		custom_tooltip = {
			fail_text = "no_ether_in_songstone"
			OR = {
				NOT = { is_variable_set = ShadowgateESStored }
				check_variable = { which = ShadowgateESStored value > 0 }
			}
		}
		custom_tooltip = {
			fail_text = "no_nonhostile_shadowgate"
			OR = {
				any_owned_planet = { is_colonized_shadowgate = yes }
				any_relation = { NOR = { is_country_type = shadowgate_ap is_hostile = prev } any_owned_planet = { is_colonized_shadowgate = yes } }
			}
		}
		custom_tooltip = {
			fail_text = "shadowgate.crw.fail.antiresonant.void"
			NOT = { has_relic = r_shadowgate_crwt_active }
		}
	}
}

r_shadowgate_sous = {
	activation_duration = 3600
	portrait = "GFX_relic_shadowgate_sous"
	sound = "shadowgate_click"

	resources = {
		category = relics
		cost = { influence = 150 }
	}

	ai_weight = {
		weight = 100
		modifier = {
			factor = 0
			NOT = { any_owned_planet = { is_colonized_shadowgate = yes } }
		}
	}

	score = 300

	triggered_country_modifier = {
		potential = { always = yes }
		custom_tooltip = shadowgate.sous.passive
	}

	active_effect = {
		custom_tooltip = shadowgate.sous.active
		custom_tooltip = relic_triumph_cooldown
		hidden_effect = {
			country_event = { id = shadowgate_galactic.615 }
			add_modifier = {
				modifier = "relic_activation_cooldown"
				days = -1
			}
		}
	}

	possible = {
		custom_tooltip = {
			fail_text = "requires_relic_no_cooldown"
			NOT = { has_modifier = relic_activation_cooldown }
		}
		custom_tooltip = {
			fail_text = "no_nonhostile_shadowgate"
			OR = {
				any_owned_planet = { is_colonized_shadowgate = yes }
				any_relation = { NOR = { is_country_type = shadowgate_ap is_hostile = prev } any_owned_planet = { is_colonized_shadowgate = yes } }
			}
		}
		custom_tooltip = {
			fail_text = "shadowgate.crw.fail.antiresonant.void"
			NOT = { has_relic = r_shadowgate_crwt_active }
		}
	}
}