
ag_set_fallen_empire_guardian_formation = {
	optimize_memory
	set_fleet_formation = {
		position = { x = 7.5 y = 12.99 }		# 4
		position = { x = 7.5 y = -12.99 }		# 3
		position = { x = -15 y = 0 }			# 2
		position = { x = 0.0 y = 0.0 }			# 1
	}
	set_formation_scale = 0.25
}

ag_set_epsilon_obelisk_code = {
	optimize_memory
	random_list = {
		10 = { set_planet_flag = ag_epsilon_obelisk_$ag_obelisk_seq$_$ag_position$_0 event_target:global_event_country = { set_variable = { which = ag_epsilon_obelisk_$ag_obelisk_seq$_$ag_position$ value = 0 } } }
		10 = { set_planet_flag = ag_epsilon_obelisk_$ag_obelisk_seq$_$ag_position$_1 event_target:global_event_country = { set_variable = { which = ag_epsilon_obelisk_$ag_obelisk_seq$_$ag_position$ value = 1 } } }
		10 = { set_planet_flag = ag_epsilon_obelisk_$ag_obelisk_seq$_$ag_position$_2 event_target:global_event_country = { set_variable = { which = ag_epsilon_obelisk_$ag_obelisk_seq$_$ag_position$ value = 2 } } }
		10 = { set_planet_flag = ag_epsilon_obelisk_$ag_obelisk_seq$_$ag_position$_3 event_target:global_event_country = { set_variable = { which = ag_epsilon_obelisk_$ag_obelisk_seq$_$ag_position$ value = 3 } } }
		10 = { set_planet_flag = ag_epsilon_obelisk_$ag_obelisk_seq$_$ag_position$_4 event_target:global_event_country = { set_variable = { which = ag_epsilon_obelisk_$ag_obelisk_seq$_$ag_position$ value = 4 } } }
		10 = { set_planet_flag = ag_epsilon_obelisk_$ag_obelisk_seq$_$ag_position$_5 event_target:global_event_country = { set_variable = { which = ag_epsilon_obelisk_$ag_obelisk_seq$_$ag_position$ value = 5 } } }
		10 = { set_planet_flag = ag_epsilon_obelisk_$ag_obelisk_seq$_$ag_position$_6 event_target:global_event_country = { set_variable = { which = ag_epsilon_obelisk_$ag_obelisk_seq$_$ag_position$ value = 6 } } }
		10 = { set_planet_flag = ag_epsilon_obelisk_$ag_obelisk_seq$_$ag_position$_7 event_target:global_event_country = { set_variable = { which = ag_epsilon_obelisk_$ag_obelisk_seq$_$ag_position$ value = 7 } } }
		10 = { set_planet_flag = ag_epsilon_obelisk_$ag_obelisk_seq$_$ag_position$_8 event_target:global_event_country = { set_variable = { which = ag_epsilon_obelisk_$ag_obelisk_seq$_$ag_position$ value = 8 } } }
		10 = { set_planet_flag = ag_epsilon_obelisk_$ag_obelisk_seq$_$ag_position$_9 event_target:global_event_country = { set_variable = { which = ag_epsilon_obelisk_$ag_obelisk_seq$_$ag_position$ value = 9 } } }
	}
}

ag_upgrade_epsilon_obelisk = {
	optimize_memory
	if = {
		limit = { exists = owner }
		owner = { save_event_target_as = ag_target_megastructure_owner }
		switch = {
			trigger = has_megastructure_flag
			ag_epsilon_obelisk_1 = { solar_system = {
				spawn_megastructure = {
					type = ag_epsilon_obelisk_$ag_target_level$
					coords_from = prev
					owner = event_target:ag_target_megastructure_owner
					init_effect = { set_megastructure_flag = ag_epsilon_obelisk_1 }
				}
			} }
			ag_epsilon_obelisk_2 = { solar_system = {
				spawn_megastructure = {
					type = ag_epsilon_obelisk_$ag_target_level$
					coords_from = prev
					owner = event_target:ag_target_megastructure_owner
					init_effect = { set_megastructure_flag = ag_epsilon_obelisk_2 }
				}
			} }
			ag_epsilon_obelisk_3 = { solar_system = {
				spawn_megastructure = {
					type = ag_epsilon_obelisk_$ag_target_level$
					coords_from = prev
					owner = event_target:ag_target_megastructure_owner
					init_effect = { set_megastructure_flag = ag_epsilon_obelisk_3 }
				}
			} }
		}
	}
	else = {
		switch = {
			trigger = has_megastructure_flag
			ag_epsilon_obelisk_1 = { solar_system = {
				spawn_megastructure = {
					type = ag_epsilon_obelisk_$ag_target_level$
					coords_from = prev
					init_effect = { set_megastructure_flag = ag_epsilon_obelisk_1 }
				}
			} }
			ag_epsilon_obelisk_2 = { solar_system = {
				spawn_megastructure = {
					type = ag_epsilon_obelisk_$ag_target_level$
					coords_from = prev
					init_effect = { set_megastructure_flag = ag_epsilon_obelisk_2 }
				}
			} }
			ag_epsilon_obelisk_3 = { solar_system = {
				spawn_megastructure = {
					type = ag_epsilon_obelisk_$ag_target_level$
					coords_from = prev
					init_effect = { set_megastructure_flag = ag_epsilon_obelisk_3 }
				}
			} }
		}
	}
	remove_megastructure = this
}
ag_upgrade_epsilon_titan_station = {
	optimize_memory
	if = {
		limit = { exists = owner } owner = { save_event_target_as = ag_target_megastructure_owner }
		solar_system = { spawn_megastructure = {
			type = ag_epsilon_titan_station_actived_$ag_target_level$
			coords_from = prev
			owner = event_target:ag_target_megastructure_owner
		} }
	}
	else = {
		solar_system = { spawn_megastructure = {
			type = ag_epsilon_titan_station_actived_$ag_target_level$
			coords_from = prev
		} }
	}
	remove_megastructure = this
}

ag_create_epsilon_ringworld_project = {
	optimize_memory
	tooltip = { enable_special_project = { name = "ag_epsilon_titan_project_1" owner = root location = this } }
	hidden_effect = {
		random_list = {
			10 = { enable_special_project = { name = "ag_epsilon_titan_project_1" owner = root location = this } }
			10 = { enable_special_project = { name = "ag_epsilon_titan_project_2" owner = root location = this } }
			10 = { enable_special_project = { name = "ag_epsilon_titan_project_3" owner = root location = this } }
			10 = { enable_special_project = { name = "ag_epsilon_titan_project_4" owner = root location = this } }
			10 = { enable_special_project = { name = "ag_epsilon_titan_project_5" owner = root location = this } }
			10 = { enable_special_project = { name = "ag_epsilon_titan_project_6" owner = root location = this } }
			10 = { enable_special_project = { name = "ag_epsilon_titan_project_7" owner = root location = this } }
			10 = { enable_special_project = { name = "ag_epsilon_titan_project_8" owner = root location = this } }
			10 = { enable_special_project = { name = "ag_epsilon_titan_project_9" owner = root location = this } }
			10 = { enable_special_project = { name = "ag_epsilon_titan_project_10" owner = root location = this } }
		}
		reroll_random = yes
	}
}

ag_epsilon_situation_reward = {
	optimize_memory
	random_list = {
		10 = {
			modifier = { factor = 0 has_country_flag = ag_epsilon_151_fired }
			set_country_flag = ag_epsilon_151_fired
			country_event = { id = ag_epsilon.151 days = 5 random = 5 }
		}
		10 = {
			modifier = { factor = 0 has_country_flag = ag_epsilon_152_fired }
			set_country_flag = ag_epsilon_152_fired
			country_event = { id = ag_epsilon.152 days = 5 random = 5 }
		}
		10 = {
			modifier = { factor = 0 has_country_flag = ag_epsilon_153_fired }
			set_country_flag = ag_epsilon_153_fired
			country_event = { id = ag_epsilon.153 days = 5 random = 5 }
		}
		10 = {
			modifier = { factor = 0 has_country_flag = ag_epsilon_92_fired }
			set_country_flag = ag_epsilon_92_fired
			country_event = { id = ag_epsilon.92 days = 5 random = 5 }
		}
	}
	reroll_random = yes
}
