#	AAR海军参数DB
#	AAR海军属性VAR/AAR海军造船VAR
#	AAR海军随机属性
#	AAR海军大建舰队创建/AAR海军大建AI




###_[AAR海军参数DB]
#_ap	<军备竞赛/钢铁巨兽/未来战舰>
#_evt	<fw年检>
##_|军备竞赛|	血50%/甲50%/盾50%/random特殊属性/25%逃逸
##_|钢铁巨兽|	血50%/甲50%/射程15%
##_|未来战舰|	血15%/甲25%/盾50%+固定/random特殊属性/5%逃逸
AAR_eft_cntr_NAVY_var_DB = {
	# vanilla
	export_modifier_to_variable = { modifier = shipsize_corvette_hull_add				 variable = AAR_var_cntr_FLT_hull_DATA_corvette }
	change_variable = { which = AAR_var_cntr_FLT_hull_DATA_corvette		 value = 300 }
	export_modifier_to_variable = { modifier = shipsize_destroyer_hull_add				 variable = AAR_var_cntr_FLT_hull_DATA_destroyer }
	change_variable = { which = AAR_var_cntr_FLT_hull_DATA_destroyer		 value = 800 }
	export_modifier_to_variable = { modifier = shipsize_cruiser_hull_add				 variable = AAR_var_cntr_FLT_hull_DATA_cruiser }
	change_variable = { which = AAR_var_cntr_FLT_hull_DATA_cruiser		 value = 1800 }
	export_modifier_to_variable = { modifier = shipsize_battleship_hull_add				 variable = AAR_var_cntr_FLT_hull_DATA_battleship }
	change_variable = { which = AAR_var_cntr_FLT_hull_DATA_battleship		 value = 3000 }
	export_modifier_to_variable = { modifier = shipsize_titan_hull_add					 variable = AAR_var_cntr_FLT_hull_DATA_titan }
	change_variable = { which = AAR_var_cntr_FLT_hull_DATA_titan		 value = 10000 }
	export_modifier_to_variable = { modifier = shipsize_colossus_hull_add				 variable = AAR_var_cntr_FLT_hull_DATA_colossus }
	change_variable = { which = AAR_var_cntr_FLT_hull_DATA_colossus		 value = 30000 }
	export_modifier_to_variable = { modifier = shipsize_juggernaut_hull_add				 variable = AAR_var_cntr_FLT_hull_DATA_juggernaut }
	change_variable = { which = AAR_var_cntr_FLT_hull_DATA_juggernaut		 value = 100000 }
	
	# fallen
	export_modifier_to_variable = { modifier = shipsize_massive_ship_fallen_empire_hull_add			 variable = AAR_var_cntr_FLT_hull_DATA_massive_ship_fallen_empire }
	change_variable = { which = AAR_var_cntr_FLT_hull_DATA_massive_ship_fallen_empire		 value = 10000 }
	export_modifier_to_variable = { modifier = shipsize_large_ship_fallen_empire_hull_add			 variable = AAR_var_cntr_FLT_hull_DATA_large_ship_fallen_empire }
	change_variable = { which = AAR_var_cntr_FLT_hull_DATA_large_ship_fallen_empire		 value = 3500 }
	export_modifier_to_variable = { modifier = shipsize_small_ship_fallen_empire_hull_add			 variable = AAR_var_cntr_FLT_hull_DATA_small_ship_fallen_empire }
	change_variable = { which = AAR_var_cntr_FLT_hull_DATA_small_ship_fallen_empire		 value = 1500 }
	
	# nemisis
	export_modifier_to_variable = { modifier = shipsize_crisis_corvette_hull_add		 variable = AAR_var_cntr_FLT_hull_DATA_crisis_corvette }
	change_variable = { which = AAR_var_cntr_FLT_hull_DATA_crisis_corvette		 value = 350 }
	export_modifier_to_variable = { modifier = shipsize_crisis_destroyer_hull_add		 variable = AAR_var_cntr_FLT_hull_DATA_crisis_destroyer }
	change_variable = { which = AAR_var_cntr_FLT_hull_DATA_crisis_destroyer		 value = 700 }
	export_modifier_to_variable = { modifier = shipsize_crisis_cruiser_hull_add			 variable = AAR_var_cntr_FLT_hull_DATA_crisis_cruiser }
	change_variable = { which = AAR_var_cntr_FLT_hull_DATA_crisis_cruiser		 value = 2000 }
	export_modifier_to_variable = { modifier = shipsize_star_eater_hull_add				 variable = AAR_var_cntr_FLT_hull_DATA_star_eater }
	change_variable = { which = AAR_var_cntr_FLT_hull_DATA_star_eater		 value = 150000 }
}




###_[AAR海军属性VAR]
#_eft	<AAR海军造船VAR/AAR海军大建AI>
#_evt	<aar海军大建>
##_var导出	|TEMP_var_factor|
#_prmt	SIZE
AAR_prmt_eft_ship_NAVY_build_VAR = {
	set_variable = { which = TEMP_var_factor value = owner.AAR_var_cntr_FLT_hull_DATA_$SIZE$ }
}
###_[AAR海军造船VAR]
#_evt	<aar海军ap改船>
AAR_eft_ship_NAVY_build_VAR = {
	switch = { trigger = is_ship_size
		#	vanilla
		corvette	= { AAR_prmt_eft_ship_NAVY_build_VAR = { SIZE = corvette } }
		destroyer	= { AAR_prmt_eft_ship_NAVY_build_VAR = { SIZE = destroyer } }
		cruiser		= { AAR_prmt_eft_ship_NAVY_build_VAR = { SIZE = cruiser } }
		battleship	= { AAR_prmt_eft_ship_NAVY_build_VAR = { SIZE = battleship } }
		titan		= { AAR_prmt_eft_ship_NAVY_build_VAR = { SIZE = titan } }
		colossus	= { AAR_prmt_eft_ship_NAVY_build_VAR = { SIZE = colossus } }
		juggernaut	= { AAR_prmt_eft_ship_NAVY_build_VAR = { SIZE = juggernaut } }
		#	fallen
		massive_ship_fallen_empire		= { AAR_prmt_eft_ship_NAVY_build_VAR = { SIZE = massive_ship_fallen_empire } }
		large_ship_fallen_empire		= { AAR_prmt_eft_ship_NAVY_build_VAR = { SIZE = large_ship_fallen_empire } }
		small_ship_fallen_empire		= { AAR_prmt_eft_ship_NAVY_build_VAR = { SIZE = small_ship_fallen_empire } }
		#	nemisis
		crisis_corvette		= { AAR_prmt_eft_ship_NAVY_build_VAR = { SIZE = crisis_corvette } }
		crisis_destroyer	= { AAR_prmt_eft_ship_NAVY_build_VAR = { SIZE = crisis_destroyer } }
		crisis_cruiser		= { AAR_prmt_eft_ship_NAVY_build_VAR = { SIZE = crisis_cruiser } }
		star_eater			= { AAR_prmt_eft_ship_NAVY_build_VAR = { SIZE = star_eater } }
		#	其他船只
		default				= { set_variable = { which = TEMP_var_factor value = 0 } }
	}
}




###_[AAR海军随机属性]
#_eft	<AAR海军大建AI>
#_evt	<aar海军大建/aar海军ap改船>
#_prmt	FACTOR
AAR_prmt_eft_ship_NAVY_build_random_mod_DB = {
	random_list = {
		1 = { add_modifier = { modifier = AAR_mod_ship_NAVY_random_mod_ATK			 days = -1 multiplier = $FACTOR|1$ } }
		1 = { add_modifier = { modifier = AAR_mod_ship_NAVY_random_mod_RANGE		 days = -1 multiplier = $FACTOR|1$ } }
		1 = { add_modifier = { modifier = AAR_mod_ship_NAVY_random_mod_EVADE		 days = -1 multiplier = $FACTOR|1$ } }
		1 = { add_modifier = { modifier = AAR_mod_ship_NAVY_random_mod_HULL			 days = -1 multiplier = $FACTOR|1$ } }
		1 = { add_modifier = { modifier = AAR_mod_ship_NAVY_random_mod_ARMOR		 days = -1 multiplier = $FACTOR|1$ } }
		1 = { add_modifier = { modifier = AAR_mod_ship_NAVY_random_mod_SHIELD		 days = -1 multiplier = $FACTOR|1$ } }
		1 = { add_modifier = { modifier = AAR_mod_ship_NAVY_random_mod_AIM			 days = -1 multiplier = $FACTOR|1$ } }
		1 = { add_modifier = { modifier = AAR_mod_ship_NAVY_random_mod_WE			 days = -1 multiplier = $FACTOR|1$ } }
		1 = { add_modifier = { modifier = AAR_mod_ship_NAVY_random_mod_WK			 days = -1 multiplier = $FACTOR|1$ } }
		1 = { add_modifier = { modifier = AAR_mod_ship_NAVY_random_mod_WM			 days = -1 multiplier = $FACTOR|1$ } }
	}
}




###_[AAR海军大建舰队创建]
#_eft	<AAR海军大建AI>
#_evt	<aar海军大建>
#_prmt	REPEAT
AAR_prmt_eft_cntrl_NAVY_force_construction = {
	while = {
		count = $REPEAT$
		create_ship = {
			name = "NAME_AAR_ship"
			random_existing_design = battleship
		}
	}
}
###	AAR海军大建AI	
#_evt	<aar海军大建>
AAR_eft_cntr_NAVY_force_construction_AI = {
	#舰容不够
	if = { limit = { used_naval_capacity_percent > 1.1 }
		add_resource = { alloys = 10000 }
		add_resource = { influence = 100 }
	}
	#舰容足够
	else = {
		create_fleet = {
			name = "NAME_AAR_FLEET"
			effect = {
				set_owner = root
				random_list = {
					2 = { AAR_prmt_eft_cntrl_NAVY_force_construction = { REPEAT = 4 } }	# AAR海军大建舰队创建
					3 = { AAR_prmt_eft_cntrl_NAVY_force_construction = { REPEAT = 5 } }
					2 = { AAR_prmt_eft_cntrl_NAVY_force_construction = { REPEAT = 6 } }
					1 = { AAR_prmt_eft_cntrl_NAVY_force_construction = { REPEAT = 7 } }	
				}
				# 放置在首都
				set_location = {
					target = root.capital_scope.starbase
					distance = 5
					angle = random
				}
				# 添加属性
				every_owned_ship = {
					##	AAR海军属性VAR	=战列舰
					AAR_prmt_eft_ship_NAVY_build_VAR = { SIZE = battleship }
					
					##	factorMOD
					add_modifier = { modifier = AAR_mod_ship_NAVY_build_factor		 days = -1 multiplier = TEMP_var_factor }
					##	固定属性
					add_modifier = { modifier = AAR_mod_ship_NAVY_build_common		 days = -1 }
					##	随机属性
					AAR_prmt_eft_ship_NAVY_build_random_mod_DB = { FACTOR = 2 }		# AAR海军随机属性
					
					##	clear
					clear_variable = TEMP_var_factor
				}
			}
		}
	}
}

