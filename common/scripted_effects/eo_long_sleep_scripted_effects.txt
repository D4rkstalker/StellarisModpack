#################################
# Handle research and unity bonuses
#################################

hibernating_pop_modifiers = {
	set_timed_pop_flag = {
		flag = recently_awoken_from_cryosleep
		years = 5
	}
	if = {
		limit = {
			has_citizenship_type = { type = citizenship_full_machine }
		}
		add_modifier = { modifier = network_reintegration years = 1 }
	}
	else = {
		add_modifier = { modifier = cryoshock years = 1 }
	}
}

hibernating_pop_modifier_and_country_bonus_tooltip = {
	if = {
		limit = {
			prev = {
				has_citizenship_type = { country = root.owner type = citizenship_full_machine }
			}
		}
		custom_tooltip = hibernating_pop_network_reintegration
	}
	else = {
		custom_tooltip = hibernating_pop_cryoshock
	}
	if = {
		limit = {
			prev = {
				has_citizenship_type = { country = root.owner type = citizenship_organic_trophy }
			}
		}
		custom_tooltip = long_sleep_temporary_unity_bonus
	}
	else_if = {
		limit = {
			prev = {
				NOR = {
					has_citizenship_type = { country = root.owner type = citizenship_slavery }
					has_citizenship_type = { country = root.owner type = citizenship_purge }
					has_citizenship_type = { country = root.owner type = citizenship_purge_machine }
				}
			}
		}
		custom_tooltip = long_sleep_temporary_research_bonus
	}
	#No research bonus from slaves
    else_if = {
        limit = {
			prev = {
				has_citizenship_type = { country = root.owner type = citizenship_slavery }
			}
        }
        custom_tooltip = no_research_bonus_enslaved
    }
    else = {
        custom_tooltip = no_research_bonus_purge
    }
}

deactivated_machine_modifiers = {
	set_timed_pop_flag = {
		flag = recently_reactivated_from_storage
		years = 5
	}
	if = {
		limit = {
			has_citizenship_type = { type = citizenship_full_machine }
		}
		add_modifier = { modifier = network_reintegration years = 1 }
	}
}

deactivated_pop_modifier_and_country_bonus_tooltip = {
	if = {
		limit = {
			prev = {
				has_citizenship_type = { country = root.owner type = citizenship_full_machine }
			}
		}
		custom_tooltip = hibernating_pop_network_reintegration
	}
	if = {
        limit = {
			prev = {
           		has_citizenship_type = { country = root.owner type = citizenship_full_machine }
			}
        }
        custom_tooltip = long_sleep_temporary_research_bonus
    }
    else = {
        custom_tooltip = no_research_bonus_purge
    }
}

change_long_sleep_research_and_unity_bonuses = {
	remove_modifier = long_sleep_research_bonus_organic
	remove_modifier = long_sleep_research_bonus_machine
	remove_modifier = long_sleep_unity_bonus
	if = {
		limit = {
			check_variable_arithmetic = {
				which = value:long_sleep_research_bonus_organic
				value > 1
			}
		}
		add_modifier = {
			modifier = long_sleep_research_bonus_organic
			multiplier = value:long_sleep_research_bonus_organic
		}
	}
	if = {
		limit = {
			check_variable_arithmetic = {
				which = value:long_sleep_research_bonus_machine
				value > 1
			}
		}
		add_modifier = {
			modifier = long_sleep_research_bonus_machine
			multiplier = value:long_sleep_research_bonus_machine
		}
	}
	if = {
		limit = {
			check_variable_arithmetic = {
				which = value:long_sleep_unity_bonus
				value > 1
			}
		}
		add_modifier = {
			modifier = long_sleep_unity_bonus
			multiplier = value:long_sleep_unity_bonus
		}
	}
	if = {
		limit = {
			OR = {
				has_modifier = long_sleep_research_bonus_organic
				has_modifier = long_sleep_research_bonus_machine
				has_modifier = long_sleep_unity_bonus
			}
		}
		country_event = { id = eo_long_sleep.1 days = 1825 }
	}
}