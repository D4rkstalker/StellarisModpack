ehof_generate_megastructures = {
	random_list = {
		98 = {}
		2 = {
			modifier = { factor = 85 ehof_is_rare = yes }
			modifier = { factor = 0 ehof_trader_system = yes }
			modifier = { factor = 0 ehof_quest_system = yes }
			modifier = { factor = 0 ehof_compound_cluster = yes }
			random_list = {
				############################################## Dyson_sphere
				5 = {
					modifier = { factor = 0 NOT = { host_has_dlc = "Utopia" } }
					modifier = {
						factor = 0
						OR = {
							ehof_is_binary_star = yes
							ehof_is_trinary_star = yes
							is_star_class = sc_black_hole
							is_star_class = sc_ehof_black_hole
							is_star_class = sc_neutron_star
							is_star_class = sc_pulsar
							star = {
								planet_size > 35
								planet_size < 50
							}
						}
					}
					modifier = {
						factor = 0.1
						event_target:ehof_system_creator = {
							count_owned_megastructure = {
								limit = {
									OR = {
										is_megastructure_type = dyson_sphere_ruined
										is_megastructure_type = dyson_sphere_restored
										is_megastructure_type = dyson_sphere_0
										is_megastructure_type = dyson_sphere_1
										is_megastructure_type = dyson_sphere_2
										is_megastructure_type = dyson_sphere_3
										is_megastructure_type = dyson_sphere_4
										is_megastructure_type = dyson_sphere_5
									}
								}
								count > 0
							}
						}
					}
					set_star_flag = ruined_dyson_system
					ehof_remove_habitable_planets = yes
					ehof_field_system_debris = yes
					spawn_megastructure = { type = "dyson_sphere_ruined" location = star }
				}
				############################################## Mega Shipyard
				5 = {
					modifier = { factor = 0 NOT = { host_has_dlc = "Federations" } }
					modifier = {
						factor = 0.1
						event_target:ehof_system_creator = {
							count_owned_megastructure = {
								limit = {
									OR = {
										is_megastructure_type = mega_shipyard_ruined
										is_megastructure_type = mega_shipyard_restored
										is_megastructure_type = mega_shipyard_0
										is_megastructure_type = mega_shipyard_1
										is_megastructure_type = mega_shipyard_2
										is_megastructure_type = mega_shipyard_3
									}
								}
								count > 0
							}
						}
					}
					set_star_flag = ruined_mega_shipyard_system
					ehof_field_system_debris = yes
					spawn_megastructure = { type = "mega_shipyard_ruined" location = star }
				}
				############################################## Matter Decompressor
				5 = {
					modifier = { factor = 0 NOT = { host_has_dlc = "Megacorp" } }
					modifier = {
						factor = 0
						NOR = {
							is_star_class = sc_ehof_black_hole
							is_star_class = sc_black_hole
						}
					}
					modifier = {
						factor = 0.1
						event_target:ehof_system_creator = {
							count_owned_megastructure = {
								limit = {
									OR = {
										is_megastructure_type = matter_decompressor_ruined
										is_megastructure_type = matter_decompressor_restored
										is_megastructure_type = matter_decompressor_0
										is_megastructure_type = matter_decompressor_1
										is_megastructure_type = matter_decompressor_2
										is_megastructure_type = matter_decompressor_3
										is_megastructure_type = matter_decompressor_4
									}
								}
								count > 0
							}
						}
					}
					set_star_flag = ruined_matter_decompressor_system
					ehof_remove_habitable_planets = yes
					ehof_field_system_debris = yes
					spawn_megastructure = { type = "matter_decompressor_ruined" location = star }
				}
				############################################## Ringworld
				5 = {
					modifier = {
						factor = 0
						OR = {
							ehof_is_trinary_star = yes
							ehof_is_binary_star = yes
							is_star_class = sc_black_hole
							is_star_class = sc_ehof_black_hole
							is_star_class = sc_neutron_star
							is_star_class = sc_pulsar
						}
					}
					modifier = {
						factor = 0.1
						event_target:ehof_system_creator = {
							count_owned_megastructure = {
								limit = {
									OR = {
										is_megastructure_type = ring_world_ruined
										is_megastructure_type = ring_world_restored
										is_megastructure_type = ring_world_1
										is_megastructure_type = ring_world_2
										is_megastructure_type = ring_world_2_intermediate
										is_megastructure_type = ring_world_3_intermediate
									}
								}
								count > 0
							}
						}
					}
					set_star_flag = ruined_ring_system
					ehof_remove_habitable_planets = yes
					every_system_planet = {
						limit = { has_planet_flag = ehof_warm_planet }
						remove_planet = yes
					}
					ehof_field_system_debris = yes

					spawn_megastructure = {
						type = "ring_world_ruined"
						orbit_angle = 0
						orbit_distance = 45
						location = star
					}
					spawn_megastructure = {
						type = "ring_world_ruined"
						orbit_angle = 90
						orbit_distance = 45
						location = star
					}
					spawn_megastructure = {
						type = "ring_world_ruined"
						orbit_angle = 180
						orbit_distance = 45
						location = star
					}
					spawn_megastructure = {
						type = "ring_world_ruined"
						orbit_angle = 270
						orbit_distance = 45
						location = star
					}
				}
				############################################## Science Nexus
				5 = {
					modifier = { factor = 0 NOT = { host_has_dlc = "Utopia" } }
					modifier = {
						factor = 0
						NOT = { any_system_planet = { ehof_is_habitable = no	is_moon = no	is_asteroid = no	is_star = no } }
					}
					modifier = {
						factor = 0.1
						event_target:ehof_system_creator = {
							count_owned_megastructure = {
								limit = {
									OR = {
										is_megastructure_type = think_tank_ruined
										is_megastructure_type = think_tank_restored
										is_megastructure_type = think_tank_0
										is_megastructure_type = think_tank_1
										is_megastructure_type = think_tank_2
										is_megastructure_type = think_tank_3
										is_megastructure_type = think_tank_4
									}
								}
								count > 0
							}
						}
					}
					set_star_flag = ruined_nexus_system
					ehof_field_system_debris = yes
					random_system_planet = { limit = { ehof_is_habitable = no	is_moon = no	is_asteroid = no	is_star = no } save_event_target_as = science_nexus_target ehof_field_debris = yes }
					spawn_megastructure = { type = "think_tank_ruined" location = event_target:science_nexus_target }
				}
				############################################## Sentry Array
				5 = {
					modifier = { factor = 0 NOT = { host_has_dlc = "Utopia" } }
					modifier = {
						factor = 0.1
						event_target:ehof_system_creator = {
							count_owned_megastructure = {
								limit = {
									OR = {
										is_megastructure_type = spy_orb_ruined
										is_megastructure_type = spy_orb_restored
										is_megastructure_type = spy_orb_0
										is_megastructure_type = spy_orb_1
										is_megastructure_type = spy_orb_2
										is_megastructure_type = spy_orb_3
										is_megastructure_type = spy_orb_4
									}
								}
								count > 0
							}
						}
					}
					set_star_flag = ruined_sentry_system
					ehof_field_system_debris = yes
					random_system_planet = { save_event_target_as = sentry_array_target ehof_field_debris = yes }
					spawn_megastructure = { type = "spy_orb_ruined" location = event_target:sentry_array_target }
				}
				############################################## Strategic Coordination Center
				5 = {
					modifier = { factor = 0 NOT = { host_has_dlc = "Megacorp" } }
					modifier = {
						factor = 0.1
						event_target:ehof_system_creator = {
							count_owned_megastructure = {
								limit = {
									OR = {
										is_megastructure_type = strategic_coordination_center_ruined
										is_megastructure_type = strategic_coordination_center_restored
										is_megastructure_type = strategic_coordination_center_0
										is_megastructure_type = strategic_coordination_center_1
										is_megastructure_type = strategic_coordination_center_2
										is_megastructure_type = strategic_coordination_center_3
									}
								}
								count > 0
							}
						}
					}
					set_star_flag = ruined_strategic_coordination_center_system
					ehof_field_system_debris = yes
					random_system_planet = { save_event_target_as = coordination_target ehof_field_debris = yes }
					spawn_megastructure = { type = "strategic_coordination_center_ruined" location = event_target:coordination_target }
				}
				############################################## Mega Art Installation
				5 = {
					modifier = { factor = 0 NOT = { host_has_dlc = "Megacorp" } }
					modifier = {
						factor = 0
						NOT = { any_system_planet = { ehof_is_habitable = yes } }
					}
					modifier = {
						factor = 0.1
						event_target:ehof_system_creator = {
							count_owned_megastructure = {
								limit = {
									OR = {
										is_megastructure_type = mega_art_installation_ruined
										is_megastructure_type = mega_art_installation_restored
										is_megastructure_type = mega_art_installation_restored_2
										is_megastructure_type = mega_art_installation_0
										is_megastructure_type = mega_art_installation_1
										is_megastructure_type = mega_art_installation_2
										is_megastructure_type = mega_art_installation_3
										is_megastructure_type = mega_art_installation_4
									}
								}
								count > 0
							}
						}
					}
					set_star_flag = ruined_mega_art_installation_system
					ehof_field_system_debris = yes
					random_system_planet = { limit = { ehof_is_habitable = yes } save_event_target_as = mega_art_installation_target ehof_field_debris = yes }
					spawn_megastructure = { type = "mega_art_installation_ruined" location = event_target:mega_art_installation_target }
				}
				############################################## Interstellar Assembly
				5 = {
					modifier = { factor = 0 NOT = { host_has_dlc = "Megacorp" } }
					modifier = {
						factor = 0.1
						event_target:ehof_system_creator = {
							count_owned_megastructure = {
								limit = {
									OR = {
										is_megastructure_type = interstellar_assembly_ruined
										is_megastructure_type = interstellar_assembly_restored
										is_megastructure_type = interstellar_assembly_0
										is_megastructure_type = interstellar_assembly_1
										is_megastructure_type = interstellar_assembly_2
										is_megastructure_type = interstellar_assembly_3
										is_megastructure_type = interstellar_assembly_4
									}
								}
								count > 0
							}
						}
					}
					set_star_flag = ruined_interstellar_assembly_system
					ehof_field_system_debris = yes
					spawn_megastructure = { type = "interstellar_assembly_ruined" location = star }
				}
			}
		}
	}
}