
ag_changed_difficulty = {
	optimize_memory
	if = {
		limit = { exists = event_target:ag_zeta_crisis_country }
		event_target:ag_zeta_crisis_country = {
			set_variable = { which = ag_scaled_difficulty_temp value = event_target:global_event_country.ag_scaled_difficulty }
			remove_modifier = "ag_zeta_crisis_army_modifier"
			add_modifier = { modifier = "ag_zeta_crisis_army_modifier" multiplier = ag_scaled_difficulty_temp days = -1 }
			clear_variable = ag_scaled_difficulty_temp
		}
	}
	every_country = {
		set_variable = { which = ag_scaled_difficulty_temp value = event_target:global_event_country.ag_scaled_difficulty }
		if = { limit = { has_modifier = "ag_playerable_ancient_weapon_modifier" } remove_modifier = "ag_playerable_ancient_weapon_modifier" }
		add_modifier = { modifier = "ag_playerable_ancient_weapon_modifier" multiplier = ag_scaled_difficulty_temp days = -1 }
		clear_variable = ag_scaled_difficulty_temp
	}
	if = {
		limit = { ag_zeta_crisis_event_active = yes }
		every_system = {
			limit = { OR = {
				has_star_flag = ag_ancient_zeta_system
				has_star_flag = ag_zeta_crisis_core_system
			} }
			every_fleet_in_system = {
				limit = { has_fleet_flag = ag_zeta_crisis_special_fleet }
				delete_fleet = { target = this kill_leader = yes destroy_template = yes }
			}
			ag_create_zeta_crisis_special_ships = yes
		}
	}
	set_update_modifiers_batch = begin
	every_galaxy_fleet = {
		every_controlled_ship = {
			limit = { ag_is_mod_ship = yes }
			if = { limit = { NOT = { has_ship_flag = ag_ancient_empire_mod_ship } } set_ship_flag = ag_ancient_empire_mod_ship }
			ag_remove_all_difficulty_modifier = yes
			ag_clear_disable_at_health = { ag_disable_type = difficulty }
			if = { limit = { is_ship_size = ag_zeta_crisis_special_ship } ag_clear_disable_at_health = { ag_disable_type = invincible } }
			ag_difficulty_bonus = yes
		}
		if = {
			limit = { has_fleet_flag = ag_eta_titan_hostile_fleet }
			set_variable = { which = ag_max_spawned_hallucinations value = event_target:global_event_country.ag_scaled_difficulty }
			ceiling_variable = ag_max_spawned_hallucinations
		}
	}
	set_update_modifiers_batch = end
}
ag_difficulty_bonus = {
	optimize_memory
	if = {
		limit = {
			check_modifier_value = { modifier = ag_extra_life_add value > 0 }
			NOR = {
				AND = { is_variable_set = ag_disable_extra_life check_variable = { which = ag_set_disable_at_health_lvl value > 0 } }
				AND = { is_variable_set = ag_extra_life_cooldown check_variable = { which = ag_extra_life_cooldown value > 0 } }
			}
		}
		change_variable = { which = ag_set_disable_at_health_lvl value = modifier:ag_extra_life_add }
		set_ship_flag = ag_set_disable_at_health
		set_disable_at_health = 0.05
		set_variable = { which = ag_disable_health_var value = 0.05 }
		set_variable = { which = ag_disable_extra_life value = modifier:ag_extra_life_add }
	}
	if = {
		limit = { OR = {
			is_ship_size = ag_alpha_titan_hostile
			is_ship_size = ag_alpha_titan_0
			is_ship_size = ag_alpha_titan_1
			is_ship_size = ag_gamma_station_hostile
			is_ship_size = ag_gamma_station_0
			is_ship_size = ag_gamma_station_1
			is_ship_size = ag_gamma_station_small_hostile
			is_ship_size = ag_gamma_station_small_moving_hostile
			is_ship_size = ag_gamma_titan_hostile
			is_ship_size = ag_gamma_titan_0
			is_ship_size = ag_gamma_titan_1
			is_ship_size = ag_delta_titan_hostile
			is_ship_size = ag_delta_titan_0
			is_ship_size = ag_delta_titan_1
			is_ship_size = ag_epsilon_titan_hostile
			is_ship_size = ag_epsilon_titan_0
			is_ship_size = ag_epsilon_titan_1
			is_ship_size = ag_eta_titan_hostile
			is_ship_size = ag_eta_titan_0
			is_ship_size = ag_eta_titan_1
			is_ship_size = ag_zeta_titan
			is_ship_size = ag_zeta_titan_psi
			is_ship_size = ag_ancient_wandering_ship_hostile
			is_ship_size = ag_ancient_wandering_ship_0
			is_ship_size = ag_ancient_wandering_ship_1
		} }
		set_ship_flag = has_ag_flagship
	}
	set_variable = { which = ag_scaled_difficulty_temp value = event_target:global_event_country.ag_scaled_difficulty }
	set_variable = { which = ag_scaled_difficulty_2x_temp value = event_target:global_event_country.ag_scaled_difficulty_2x }
	if = {
		limit = { event_target:global_event_country = { check_variable = { which = ag_scaled_difficulty value > 4 } } }
		if = {
			limit = { OR = {
				is_ship_size = ag_zeta_crisis_small_ship
				is_ship_size = ag_zeta_crisis_medium_ship
				is_ship_size = ag_zeta_crisis_large_ship
				is_ship_size = ag_zeta_crisis_support_ship
				is_ship_size = ag_zeta_crisis_defensive_platform
			} }
			if = {
				limit = { NOT = { is_variable_set = ag_disable_difficulty } }
				set_disable_at_health = 0.25
				set_variable = { which = ag_disable_health_var value = 0.25 }
				set_ship_flag = ag_set_disable_at_health
				change_variable = { which = ag_set_disable_at_health_lvl value = 2 }
				set_variable = { which = ag_disable_difficulty value = 2 }
			}
		}
		else_if = {
			limit = { is_ship_size = ag_zeta_crisis_special_ship }
			if = {
				limit = { NOT = { is_variable_set = ag_disable_difficulty } }
				set_disable_at_health = 0.10
				set_variable = { which = ag_disable_health_var value = 0.10 }
				set_ship_flag = ag_set_disable_at_health
				change_variable = { which = ag_set_disable_at_health_lvl value = 3 }
				set_variable = { which = ag_disable_difficulty value = 2 }
				set_variable = { which = ag_disable_invincible value = 1 }
			}
		}
		else_if = {
			limit = { OR = {
				#########################################3########
				# New Ship Size Hostile Add Here.
				##################################################
				is_ship_size = ag_alpha_titan_hostile
				is_ship_size = ag_alpha_titan_1
				
				is_ship_size = ag_beta_station_type1_hostile
				is_ship_size = ag_beta_station_type1_1
				is_ship_size = ag_beta_station_type2_hostile
				is_ship_size = ag_beta_station_type2_1
				
				is_ship_size = ag_gamma_titan_hostile
				is_ship_size = ag_gamma_titan_1
				is_ship_size = ag_gamma_station_hostile
				is_ship_size = ag_gamma_station_1
				is_ship_size = ag_gamma_station_small_hostile
				is_ship_size = ag_gamma_station_small_moving_hostile
				is_ship_size = ag_gamma_battlecruiser_hostile
				is_ship_size = ag_gamma_battlecruiser_1
				is_ship_size = ag_gamma_escort_hostile
				is_ship_size = ag_gamma_escort_1
				
				is_ship_size = ag_delta_platform_hostile
				is_ship_size = ag_delta_platform_1
				is_ship_size = ag_delta_titan_hostile
				is_ship_size = ag_delta_titan_1
				
				is_ship_size = ag_epsilon_titan_station_hostile
				is_ship_size = ag_epsilon_titan_hostile
				is_ship_size = ag_epsilon_titan_1
		
				is_ship_size = ag_eta_gateway_hostile
				is_ship_size = ag_eta_gateway_hostile_alt
				is_ship_size = ag_eta_gateway_1
				is_ship_size = ag_eta_titan_hostile
				is_ship_size = ag_eta_titan_1
				is_ship_size = ag_eta_titan_phantom_hostile
				is_ship_size = ag_eta_titan_phantom_player
				is_ship_size = ag_eta_titan_starbase_hostile
				
				is_ship_size = ag_zeta_titan
				is_ship_size = ag_zeta_battleship
				is_ship_size = ag_zeta_destroyer
				is_ship_size = ag_zeta_military_station_small
				is_ship_size = ag_zeta_military_station_large
				
				is_ship_size = ag_experiment_ship_hostile
				
				is_ship_size = ag_ancient_wandering_ship_hostile
				is_ship_size = ag_ancient_wandering_ship_1
				is_ship_size = ag_ancient_anchor_station_hostile
				
				is_ship_size = ag_lost_ancient_ship_battleship_form
				is_ship_size = ag_lost_ancient_ship_science_ship_form
				is_ship_size = ag_ancient_cruiser_hostile
			} }
			if = {
				limit = { NOT = { is_variable_set = ag_disable_difficulty } }
				random_list = {
					50 = {
						set_disable_at_health = 0.5
						set_variable = { which = ag_disable_health_var value = 0.5 }
						set_ship_flag = ag_set_disable_at_health
						change_variable = { which = ag_set_disable_at_health_lvl value = 1 }
						set_variable = { which = ag_disable_difficulty value = 1 }
					}
					50 = {
						set_disable_at_health = 0.25
						set_variable = { which = ag_disable_health_var value = 0.25 }
						set_ship_flag = ag_set_disable_at_health
						change_variable = { which = ag_set_disable_at_health_lvl value = 2 }
						set_variable = { which = ag_disable_difficulty value = 2 }
					}
				}
				reroll_random = yes
			}
		}
	}
	else_if = {
		limit = { event_target:global_event_country = { check_variable = { which = ag_scaled_difficulty value > 2 } } }
		if = {
			limit = { OR = {
				is_ship_size = ag_zeta_crisis_small_ship
				is_ship_size = ag_zeta_crisis_medium_ship
				is_ship_size = ag_zeta_crisis_large_ship
				is_ship_size = ag_zeta_crisis_support_ship
				is_ship_size = ag_zeta_crisis_special_ship
				is_ship_size = ag_zeta_crisis_defensive_platform
			} }
			if = {
				limit = { NOT = { is_variable_set = ag_disable_difficulty } }
				set_disable_at_health = 0.5
				set_variable = { which = ag_disable_health_var value = 0.5 }
				set_ship_flag = ag_set_disable_at_health
				change_variable = { which = ag_set_disable_at_health_lvl value = 1 }
				set_variable = { which = ag_disable_difficulty value = 1 }
			}
		}
		else_if = {
			limit = { OR = {
				#########################################3########
				# New Ship Size Hostile Add Here.
				##################################################
				is_ship_size = ag_alpha_titan_hostile
				is_ship_size = ag_alpha_titan_1
				
				is_ship_size = ag_beta_station_type1_hostile
				is_ship_size = ag_beta_station_type1_1
				is_ship_size = ag_beta_station_type2_hostile
				is_ship_size = ag_beta_station_type2_1
				
				is_ship_size = ag_gamma_titan_hostile
				is_ship_size = ag_gamma_titan_1
				is_ship_size = ag_gamma_station_hostile
				is_ship_size = ag_gamma_station_1
				is_ship_size = ag_gamma_station_small_hostile
				is_ship_size = ag_gamma_station_small_moving_hostile
				is_ship_size = ag_gamma_battlecruiser_hostile
				is_ship_size = ag_gamma_battlecruiser_1
				is_ship_size = ag_gamma_escort_hostile
				is_ship_size = ag_gamma_escort_1
				
				is_ship_size = ag_delta_platform_hostile
				is_ship_size = ag_delta_platform_1
				is_ship_size = ag_delta_titan_hostile
				is_ship_size = ag_delta_titan_1
				
				is_ship_size = ag_epsilon_titan_station_hostile
				is_ship_size = ag_epsilon_titan_hostile
				is_ship_size = ag_epsilon_titan_1
		
				is_ship_size = ag_eta_gateway_hostile
				is_ship_size = ag_eta_gateway_hostile_alt
				is_ship_size = ag_eta_gateway_1
				is_ship_size = ag_eta_titan_hostile
				is_ship_size = ag_eta_titan_1
				is_ship_size = ag_eta_titan_phantom_hostile
				is_ship_size = ag_eta_titan_phantom_player
				is_ship_size = ag_eta_titan_starbase_hostile
				
				is_ship_size = ag_zeta_titan
				is_ship_size = ag_zeta_battleship
				is_ship_size = ag_zeta_destroyer
				is_ship_size = ag_zeta_military_station_small
				is_ship_size = ag_zeta_military_station_large
				
				is_ship_size = ag_experiment_ship_hostile
				
				is_ship_size = ag_ancient_wandering_ship_hostile
				is_ship_size = ag_ancient_wandering_ship_1
				is_ship_size = ag_ancient_anchor_station_hostile
				
				is_ship_size = ag_lost_ancient_ship_battleship_form
				is_ship_size = ag_lost_ancient_ship_science_ship_form
				is_ship_size = ag_ancient_cruiser_hostile
			} }
			if = {
				limit = { NOT = { is_variable_set = ag_disable_difficulty } }
				random_list = {
					50 = { }
					50 = {
						set_disable_at_health = 0.5
						set_variable = { which = ag_disable_health_var value = 0.5 }
						set_ship_flag = ag_set_disable_at_health
						change_variable = { which = ag_set_disable_at_health_lvl value = 1 }
						set_variable = { which = ag_disable_difficulty value = 1 }
					}
				}
				reroll_random = yes
			}
		}
	}
	if = {
		limit = { check_variable = { which = ag_scaled_difficulty_2x_temp value < 0 } }
		divide_variable = { which = ag_scaled_difficulty_2x_temp value = 2 }
	}
	add_modifier = { modifier = ag_ancient_ship_modifier_common multiplier = ag_scaled_difficulty_temp days = -1 }
	add_modifier = { modifier = ag_ancient_ship_modifier_weapon_range multiplier = value:ag_capped_variable|ag_which|ag_scaled_difficulty_temp|ag_max|10| days = -1 }
	switch = {
		trigger = is_ship_size
		#########################################3########
		# New Ship Size Add Here.
		##################################################
		ag_ancient_monitor_drone_hostile = { set_ship_flag = ag_is_ancient_ship add_modifier = { modifier = ag_ancient_monitor_drone multiplier = ag_scaled_difficulty_2x_temp days = -1 } }
		
		ag_alpha_titan_hostile = { set_ship_flag = ag_is_ancient_ship add_modifier = { modifier = ag_alpha_titan_unlocked multiplier = ag_scaled_difficulty_2x_temp days = -1 } }
		ag_alpha_titan_0 = { set_ship_flag = ag_is_ancient_ship_locked add_modifier = { modifier = ag_alpha_titan_locked multiplier = ag_scaled_difficulty_2x_temp days = -1 } }
		ag_alpha_titan_1 = { set_ship_flag = ag_is_ancient_ship_unlocked add_modifier = { modifier = ag_alpha_titan_unlocked multiplier = ag_scaled_difficulty_2x_temp days = -1 } }
		ag_alpha_psionic_corvette = { add_modifier = { modifier = ag_alpha_psionic_corvette multiplier = ag_scaled_difficulty_2x_temp days = -1 } }
		ag_alpha_psionic_destroyer = { add_modifier = { modifier = ag_alpha_psionic_destroyer multiplier = ag_scaled_difficulty_2x_temp days = -1 } }
		ag_alpha_psionic_cruiser = { add_modifier = { modifier = ag_alpha_psionic_cruiser multiplier = ag_scaled_difficulty_2x_temp days = -1 } }

		ag_psionic_inhibition_station = { add_modifier = { modifier = ag_psionic_inhibition_station multiplier = ag_scaled_difficulty_2x_temp days = -1 } }
		ag_beta_drone_type1_hostile = { set_ship_flag = ag_is_ancient_ship add_modifier = { modifier = ag_beta_drone multiplier = ag_scaled_difficulty_2x_temp days = -1 } }
		ag_beta_drone_type2_hostile = { set_ship_flag = ag_is_ancient_ship add_modifier = { modifier = ag_beta_drone multiplier = ag_scaled_difficulty_2x_temp days = -1 } }
		ag_beta_station_type1_hostile = { set_ship_flag = ag_is_ancient_ship add_modifier = { modifier = ag_beta_station_type1_unlocked multiplier = ag_scaled_difficulty_2x_temp days = -1 } }
		ag_beta_station_type1_0 = { set_ship_flag = ag_is_ancient_ship_locked add_modifier = { modifier = ag_beta_station_type1_locked multiplier = ag_scaled_difficulty_2x_temp days = -1 } }
		ag_beta_station_type1_1 = { set_ship_flag = ag_is_ancient_ship_unlocked add_modifier = { modifier = ag_beta_station_type1_unlocked multiplier = ag_scaled_difficulty_2x_temp days = -1 } }
		ag_beta_station_type2_hostile = { set_ship_flag = ag_is_ancient_ship add_modifier = { modifier = ag_beta_station_type2_unlocked multiplier = ag_scaled_difficulty_2x_temp days = -1 } }
		ag_beta_station_type2_0 = { set_ship_flag = ag_is_ancient_ship_locked add_modifier = { modifier = ag_beta_station_type2_locked multiplier = ag_scaled_difficulty_2x_temp days = -1 } }
		ag_beta_station_type2_1 = { set_ship_flag = ag_is_ancient_ship_unlocked add_modifier = { modifier = ag_beta_station_type2_unlocked multiplier = ag_scaled_difficulty_2x_temp days = -1 } }

		ag_gamma_station_hostile = { set_ship_flag = ag_is_ancient_ship add_modifier = { modifier = ag_gamma_station_unlocked multiplier = ag_scaled_difficulty_2x_temp days = -1 } }
		ag_gamma_station_0 = { set_ship_flag = ag_is_ancient_ship_locked add_modifier = { modifier = ag_gamma_station_locked multiplier = ag_scaled_difficulty_2x_temp days = -1 } }
		ag_gamma_station_1 = { set_ship_flag = ag_is_ancient_ship_unlocked add_modifier = { modifier = ag_gamma_station_unlocked multiplier = ag_scaled_difficulty_2x_temp days = -1 } }
		ag_gamma_station_small_hostile = { set_ship_flag = ag_is_ancient_ship add_modifier = { modifier = ag_gamma_station_small multiplier = ag_scaled_difficulty_2x_temp days = -1 } }
		ag_gamma_station_small_moving_hostile = { set_ship_flag = ag_is_ancient_ship add_modifier = { modifier = ag_gamma_station_small_moving multiplier = ag_scaled_difficulty_2x_temp days = -1 } }
		ag_gamma_titan_hostile = { set_ship_flag = ag_is_ancient_ship add_modifier = { modifier = ag_gamma_titan_unlocked multiplier = ag_scaled_difficulty_2x_temp days = -1 } }
		ag_gamma_titan_0 = { set_ship_flag = ag_is_ancient_ship_locked add_modifier = { modifier = ag_gamma_titan_locked multiplier = ag_scaled_difficulty_2x_temp days = -1 } }
		ag_gamma_titan_1 = { set_ship_flag = ag_is_ancient_ship_unlocked add_modifier = { modifier = ag_gamma_titan_unlocked multiplier = ag_scaled_difficulty_2x_temp days = -1 } }
		ag_gamma_battlecruiser_hostile = { set_ship_flag = ag_is_ancient_ship add_modifier = { modifier = ag_gamma_battlecruiser_unlocked multiplier = ag_scaled_difficulty_2x_temp days = -1 } }
		ag_gamma_battlecruiser_0 = { set_ship_flag = ag_is_ancient_ship_locked add_modifier = { modifier = ag_gamma_battlecruiser_locked multiplier = ag_scaled_difficulty_2x_temp days = -1 } }
		ag_gamma_battlecruiser_1 = { set_ship_flag = ag_is_ancient_ship_unlocked add_modifier = { modifier = ag_gamma_battlecruiser_unlocked multiplier = ag_scaled_difficulty_2x_temp days = -1 } }
		ag_gamma_escort_hostile = { set_ship_flag = ag_is_ancient_ship add_modifier = { modifier = ag_gamma_escort_unlocked multiplier = ag_scaled_difficulty_2x_temp days = -1 } }
		ag_gamma_escort_0 = { set_ship_flag = ag_is_ancient_ship_locked add_modifier = { modifier = ag_gamma_escort_locked multiplier = ag_scaled_difficulty_2x_temp days = -1 } }
		ag_gamma_escort_1 = { set_ship_flag = ag_is_ancient_ship_unlocked add_modifier = { modifier = ag_gamma_escort_unlocked multiplier = ag_scaled_difficulty_2x_temp days = -1 } }
		ag_gamma_station_aux_drone_0 = { set_ship_flag = ag_is_ancient_ship_locked add_modifier = { modifier = ag_gamma_station_aux_drone_locked multiplier = ag_scaled_difficulty_2x_temp days = -1 } }
		ag_gamma_station_aux_drone_1 = { set_ship_flag = ag_is_ancient_ship_unlocked add_modifier = { modifier = ag_gamma_station_aux_drone_unlocked multiplier = ag_scaled_difficulty_2x_temp days = -1 } }

		ag_delta_titan_hostile = { set_ship_flag = ag_is_ancient_ship add_modifier = { modifier = ag_delta_titan_unlocked multiplier = ag_scaled_difficulty_2x_temp days = -1 } }
		ag_delta_titan_0 = { set_ship_flag = ag_is_ancient_ship_locked add_modifier = { modifier = ag_delta_titan_locked multiplier = ag_scaled_difficulty_2x_temp days = -1 } }
		ag_delta_titan_1 = { set_ship_flag = ag_is_ancient_ship_unlocked add_modifier = { modifier = ag_delta_titan_unlocked multiplier = ag_scaled_difficulty_2x_temp days = -1 } }
		ag_delta_drone_hostile = { set_ship_flag = ag_is_ancient_ship add_modifier = { modifier = ag_delta_drone multiplier = ag_scaled_difficulty_2x_temp days = -1 } }
		ag_delta_platform_hostile = { set_ship_flag = ag_is_ancient_ship add_modifier = { modifier = ag_delta_platform_unlocked multiplier = ag_scaled_difficulty_2x_temp days = -1 } }
		ag_delta_platform_0 = { set_ship_flag = ag_is_ancient_ship_locked add_modifier = { modifier = ag_delta_platform_locked multiplier = ag_scaled_difficulty_2x_temp days = -1 } }
		ag_delta_platform_1 = { set_ship_flag = ag_is_ancient_ship_unlocked add_modifier = { modifier = ag_delta_platform_unlocked multiplier = ag_scaled_difficulty_2x_temp days = -1 } }
		ag_delta_platform_00 = { set_ship_flag = ag_is_ancient_ship_locked add_modifier = { modifier = ag_delta_platform_x0_locked multiplier = ag_scaled_difficulty_2x_temp days = -1 } }
		ag_delta_platform_10 = { set_ship_flag = ag_is_ancient_ship_unlocked add_modifier = { modifier = ag_delta_platform_x0_unlocked multiplier = ag_scaled_difficulty_2x_temp days = -1 } }

		ag_psionic_beacon = { add_modifier = { modifier = ag_psionic_beacon multiplier = ag_scaled_difficulty_2x_temp days = -1 } }
		ag_suppression_station = { add_modifier = { modifier = ag_suppression_station multiplier = ag_scaled_difficulty_2x_temp days = -1 } }
		ag_epsilon_titan_station_hostile = { set_ship_flag = ag_is_ancient_ship add_modifier = { modifier = ag_epsilon_titan_station multiplier = ag_scaled_difficulty_2x_temp days = -1 } }
		ag_epsilon_titan_hostile = { set_ship_flag = ag_is_ancient_ship add_modifier = { modifier = ag_epsilon_titan_unlocked multiplier = ag_scaled_difficulty_2x_temp days = -1 } }
		ag_epsilon_titan_0 = { set_ship_flag = ag_is_ancient_ship_locked add_modifier = { modifier = ag_epsilon_titan_locked multiplier = ag_scaled_difficulty_2x_temp days = -1 } }
		ag_epsilon_titan_1 = { set_ship_flag = ag_is_ancient_ship_unlocked add_modifier = { modifier = ag_epsilon_titan_unlocked multiplier = ag_scaled_difficulty_2x_temp days = -1 } }
		ag_epsilon_obelisk_hostile = { set_ship_flag = ag_is_ancient_ship add_modifier = { modifier = ag_epsilon_obelisk_unlocked multiplier = ag_scaled_difficulty_2x_temp days = -1 } }
		ag_epsilon_defensive_station_large_hostile = { add_modifier = { modifier = ag_epsilon_defensive_station_large multiplier = ag_scaled_difficulty_2x_temp days = -1 } }
		ag_epsilon_defensive_station_small_hostile = { add_modifier = { modifier = ag_epsilon_defensive_station_small multiplier = ag_scaled_difficulty_2x_temp days = -1 } }

		ag_eta_gateway_hostile = { set_ship_flag = ag_is_ancient_ship add_modifier = { modifier = ag_eta_gateway_hostile multiplier = ag_scaled_difficulty_2x_temp days = -1 } }
		ag_eta_gateway_hostile_alt = { set_ship_flag = ag_is_ancient_ship add_modifier = { modifier = ag_eta_gateway_hostile multiplier = ag_scaled_difficulty_2x_temp days = -1 } }
		ag_eta_gateway_0 = { set_ship_flag = ag_is_ancient_ship_locked add_modifier = { modifier = ag_eta_gateway_locked multiplier = ag_scaled_difficulty_2x_temp days = -1 } }
		ag_eta_gateway_1 = { set_ship_flag = ag_is_ancient_ship_unlocked add_modifier = { modifier = ag_eta_gateway_unlocked multiplier = ag_scaled_difficulty_2x_temp days = -1 } }
		ag_eta_titan_hostile = { set_ship_flag = ag_is_ancient_ship add_modifier = { modifier = ag_eta_titan_unlocked multiplier = ag_scaled_difficulty_2x_temp days = -1 } }
		ag_eta_titan_0 = { set_ship_flag = ag_is_ancient_ship_locked add_modifier = { modifier = ag_eta_titan_locked multiplier = ag_scaled_difficulty_2x_temp days = -1 } }
		ag_eta_titan_1 = { set_ship_flag = ag_is_ancient_ship_unlocked add_modifier = { modifier = ag_eta_titan_unlocked multiplier = ag_scaled_difficulty_2x_temp days = -1 } }
		ag_eta_titan_phantom_hostile = { set_ship_flag = ag_is_ancient_ship add_modifier = { modifier = ag_eta_titan_phantom multiplier = ag_scaled_difficulty_2x_temp days = -1 } }
		ag_eta_titan_phantom_player = { add_modifier = { modifier = ag_eta_titan_phantom multiplier = ag_scaled_difficulty_2x_temp days = -1 } }
		ag_eta_titan_starbase_hostile = { set_ship_flag = ag_is_ancient_ship add_modifier = { modifier = ag_eta_titan_starbase_hostile multiplier = ag_scaled_difficulty_2x_temp days = -1 } }
		ag_eta_drone_hostile = { set_ship_flag = ag_is_ancient_ship add_modifier = { modifier = ag_eta_drone multiplier = ag_scaled_difficulty_2x_temp days = -1 } }

		ag_zeta_titan = { set_ship_flag = ag_is_ancient_ship_unlocked set_ship_flag = ag_is_ancient_ship add_modifier = { modifier = ag_zeta_titan multiplier = ag_scaled_difficulty_2x_temp days = -1 } }
		ag_zeta_titan_psi = { set_ship_flag = ag_is_ancient_ship_unlocked set_ship_flag = ag_is_ancient_ship add_modifier = { modifier = ag_zeta_titan_psi multiplier = ag_scaled_difficulty_2x_temp days = -1 } }
		ag_zeta_battleship = { set_ship_flag = ag_is_ancient_ship_unlocked set_ship_flag = ag_is_ancient_ship add_modifier = { modifier = ag_zeta_battleship multiplier = ag_scaled_difficulty_2x_temp days = -1 } }
		ag_zeta_battleship_psi = { set_ship_flag = ag_is_ancient_ship_unlocked set_ship_flag = ag_is_ancient_ship add_modifier = { modifier = ag_zeta_battleship_psi multiplier = ag_scaled_difficulty_2x_temp days = -1 } }
		ag_zeta_destroyer = { set_ship_flag = ag_is_ancient_ship_unlocked set_ship_flag = ag_is_ancient_ship add_modifier = { modifier = ag_zeta_destroyer multiplier = ag_scaled_difficulty_2x_temp days = -1 } }
		ag_zeta_destroyer_psi = { set_ship_flag = ag_is_ancient_ship_unlocked set_ship_flag = ag_is_ancient_ship add_modifier = { modifier = ag_zeta_destroyer_psi multiplier = ag_scaled_difficulty_2x_temp days = -1 } }
		ag_zeta_military_station_small = { set_ship_flag = ag_is_ancient_ship_unlocked set_ship_flag = ag_is_ancient_ship add_modifier = { modifier = ag_zeta_military_station_small multiplier = ag_scaled_difficulty_2x_temp days = -1 } }
		ag_zeta_military_station_small_psi = { set_ship_flag = ag_is_ancient_ship_unlocked set_ship_flag = ag_is_ancient_ship add_modifier = { modifier = ag_zeta_military_station_small_psi multiplier = ag_scaled_difficulty_2x_temp days = -1 } }
		ag_zeta_military_station_large = { set_ship_flag = ag_is_ancient_ship_unlocked set_ship_flag = ag_is_ancient_ship add_modifier = { modifier = ag_zeta_military_station_large multiplier = ag_scaled_difficulty_2x_temp days = -1 } }
		ag_zeta_military_station_large_psi = { set_ship_flag = ag_is_ancient_ship_unlocked set_ship_flag = ag_is_ancient_ship add_modifier = { modifier = ag_zeta_military_station_large_psi multiplier = ag_scaled_difficulty_2x_temp days = -1 } }

		ag_zeta_crisis_small_ship = { set_ship_flag = ag_is_zeta_crisis_ship add_modifier = { modifier = ag_zeta_crisis_small_ship multiplier = ag_scaled_difficulty_2x_temp days = -1 } }
		ag_zeta_crisis_medium_ship = { set_ship_flag = ag_is_zeta_crisis_ship add_modifier = { modifier = ag_zeta_crisis_medium_ship multiplier = ag_scaled_difficulty_2x_temp days = -1 } }
		ag_zeta_crisis_large_ship = { set_ship_flag = ag_is_zeta_crisis_ship add_modifier = { modifier = ag_zeta_crisis_large_ship multiplier = ag_scaled_difficulty_2x_temp days = -1 } }
		ag_zeta_crisis_support_ship = { set_ship_flag = ag_is_zeta_crisis_ship add_modifier = { modifier = ag_zeta_crisis_support_ship multiplier = ag_scaled_difficulty_2x_temp days = -1 } }
		ag_zeta_crisis_special_ship = { set_ship_flag = ag_is_zeta_crisis_ship add_modifier = { modifier = ag_zeta_crisis_special_ship multiplier = ag_scaled_difficulty_2x_temp days = -1 } }
		ag_zeta_crisis_construction_ship = { set_ship_flag = ag_is_zeta_crisis_ship add_modifier = { modifier = ag_zeta_crisis_construction_ship multiplier = ag_scaled_difficulty_2x_temp days = -1 } }
		starbase_ag_zeta_crisis = { set_ship_flag = ag_is_zeta_crisis_ship add_modifier = { modifier = starbase_ag_zeta_crisis multiplier = ag_scaled_difficulty_2x_temp days = -1 } }
		ag_zeta_crisis_defensive_platform = { add_modifier = { modifier = ag_zeta_crisis_defensive_platform multiplier = ag_scaled_difficulty_2x_temp days = -1 } }
		ag_zeta_crisis_avatar_t1 = { set_ship_flag = ag_is_zeta_crisis_ship add_modifier = { modifier = ag_zeta_crisis_avatar_t1 multiplier = ag_scaled_difficulty_2x_temp days = -1 } }
		ag_zeta_crisis_avatar_t2 = { set_ship_flag = ag_is_zeta_crisis_ship add_modifier = { modifier = ag_zeta_crisis_avatar_t2 multiplier = ag_scaled_difficulty_2x_temp days = -1 } }
		ag_zeta_crisis_avatar_t3 = { set_ship_flag = ag_is_zeta_crisis_ship add_modifier = { modifier = ag_zeta_crisis_avatar_t3 multiplier = ag_scaled_difficulty_2x_temp days = -1 } }
		ag_zeta_crisis_avatar_t4 = { set_ship_flag = ag_is_zeta_crisis_ship add_modifier = { modifier = ag_zeta_crisis_avatar_t4 multiplier = ag_scaled_difficulty_2x_temp days = -1 } }
		ag_zeta_crisis_avatar_t5 = { set_ship_flag = ag_is_zeta_crisis_ship add_modifier = { modifier = ag_zeta_crisis_avatar_t5 multiplier = ag_scaled_difficulty_2x_temp days = -1 } }
		ag_zeta_crisis_portal = { set_ship_flag = ag_is_zeta_crisis_ship add_modifier = { modifier = ag_zeta_crisis_portal multiplier = ag_scaled_difficulty_2x_temp days = -1 } }
		ag_zeta_crisis_small_portal = { set_ship_flag = ag_is_zeta_crisis_ship add_modifier = { modifier = ag_zeta_crisis_small_portal multiplier = ag_scaled_difficulty_2x_temp days = -1 } }
		ag_ancient_zeta_psionic_container = { set_ship_flag = ag_is_zeta_crisis_ship add_modifier = { modifier = ag_ancient_zeta_psionic_container multiplier = ag_scaled_difficulty_2x_temp days = -1 } }
		ag_ancient_zeta_psionic_container_alt = { set_ship_flag = ag_is_zeta_crisis_ship add_modifier = { modifier = ag_ancient_zeta_psionic_container multiplier = ag_scaled_difficulty_2x_temp days = -1 } }
		ag_corrupted_avatar = { set_ship_flag = ag_is_zeta_crisis_ship add_modifier = { modifier = ag_corrupted_avatar multiplier = ag_scaled_difficulty_2x_temp days = -1 } }

		ag_experiment_ship = { set_ship_flag = ag_is_ancient_ship add_modifier = { modifier = ag_theta_experiment_ship multiplier = ag_scaled_difficulty_2x_temp days = -1 } }
		ag_experiment_ship_hostile = { set_ship_flag = ag_is_ancient_ship add_modifier = { modifier = ag_theta_experiment_ship multiplier = ag_scaled_difficulty_2x_temp days = -1 } }
		
		ag_iota_station_1 = { set_ship_flag = ag_is_ancient_ship_unlocked add_modifier = { modifier = ag_iota_station_1 multiplier = ag_scaled_difficulty_2x_temp days = -1 } }
		
		ag_ancient_wandering_ship_hostile = { set_ship_flag = ag_is_ancient_ship add_modifier = { modifier = ag_ancient_wandering_ship_unlocked multiplier = ag_scaled_difficulty_2x_temp days = -1 } }
		ag_ancient_wandering_ship_0 = { set_ship_flag = ag_is_ancient_ship_locked add_modifier = { modifier = ag_ancient_wandering_ship_locked multiplier = ag_scaled_difficulty_2x_temp days = -1 } }
		ag_ancient_wandering_ship_1 = { set_ship_flag = ag_is_ancient_ship_unlocked add_modifier = { modifier = ag_ancient_wandering_ship_unlocked multiplier = ag_scaled_difficulty_2x_temp days = -1 } }
		ag_ancient_anchor_station_hostile = { set_ship_flag = ag_is_ancient_ship add_modifier = { modifier = ag_ancient_anchor_station_unlocked multiplier = ag_scaled_difficulty_2x_temp days = -1 } }

		ag_lost_ancient_ship_battleship_form = {
			set_ship_flag = ag_is_ancient_ship
			set_ship_flag = ag_is_ancient_ship_unlocked
			add_modifier = { modifier = ag_lost_ancient_ship multiplier = ag_scaled_difficulty_2x_temp days = -1 }
			if = {
				limit = {
					OR = {
						has_modifier = ag_lost_ancient_ship_debuff_1x
						has_modifier = ag_lost_ancient_ship_debuff_2x
					}
				}
				remove_modifier = ag_lost_ancient_ship_debuff_1x
				remove_modifier = ag_lost_ancient_ship_debuff_2x
				if = {
					limit = { check_variable = { which = ag_scaled_difficulty_temp value > 0 } }
					add_modifier = { modifier = ag_lost_ancient_ship_debuff_1x multiplier = ag_scaled_difficulty_temp days = -1 }
					add_modifier = { modifier = ag_lost_ancient_ship_debuff_2x multiplier = ag_scaled_difficulty_2x_temp days = -1 }
				}
			}
		}
		ag_lost_ancient_ship_science_ship_form = {
			set_ship_flag = ag_is_ancient_ship
			set_ship_flag = ag_is_ancient_ship_unlocked
			add_modifier = { modifier = ag_lost_ancient_ship multiplier = ag_scaled_difficulty_2x_temp days = -1 }
			if = {
				limit = {
					OR = {
						has_modifier = ag_lost_ancient_ship_debuff_1x
						has_modifier = ag_lost_ancient_ship_debuff_2x
					}
				}
				remove_modifier = ag_lost_ancient_ship_debuff_1x
				remove_modifier = ag_lost_ancient_ship_debuff_2x
				if = {
					limit = { check_variable = { which = ag_scaled_difficulty_temp value > 0 } }
					add_modifier = { modifier = ag_lost_ancient_ship_debuff_1x multiplier = ag_scaled_difficulty_temp days = -1 }
					add_modifier = { modifier = ag_lost_ancient_ship_debuff_2x multiplier = ag_scaled_difficulty_2x_temp days = -1 }
				}
			}
		}
		ag_ancient_cruiser_hostile = { set_ship_flag = ag_is_ancient_ship add_modifier = { modifier = ag_ancient_cruiser multiplier = ag_scaled_difficulty_2x_temp days = -1 } }
	}
	clear_variable = ag_scaled_difficulty_temp
	clear_variable = ag_scaled_difficulty_2x_temp
}

ag_remove_all_difficulty_modifier = {
	optimize_memory
	remove_modifier = "ag_ancient_ship_modifier_common"
	remove_modifier = "ag_ancient_ship_modifier_weapon_range"
	
	remove_modifier = "ag_ancient_monitor_drone"
	
	remove_modifier = "ag_alpha_titan_locked"
	remove_modifier = "ag_alpha_titan_unlocked"
	remove_modifier = "ag_alpha_psionic_corvette"
	remove_modifier = "ag_alpha_psionic_destroyer"
	remove_modifier = "ag_alpha_psionic_cruiser"
	
	remove_modifier = "ag_psionic_inhibition_station"
	remove_modifier = "ag_beta_drone"
	remove_modifier = "ag_beta_station_type1_locked"
	remove_modifier = "ag_beta_station_type1_unlocked"
	remove_modifier = "ag_beta_station_type2_locked"
	remove_modifier = "ag_beta_station_type2_unlocked"
	
	remove_modifier = "ag_gamma_titan_locked"
	remove_modifier = "ag_gamma_titan_unlocked"
	remove_modifier = "ag_gamma_station_locked"
	remove_modifier = "ag_gamma_station_unlocked"
	remove_modifier = "ag_gamma_station_small"
	remove_modifier = "ag_gamma_station_small_moving"
	remove_modifier = "ag_gamma_battlecruiser_locked"
	remove_modifier = "ag_gamma_battlecruiser_unlocked"
	remove_modifier = "ag_gamma_escort_locked"
	remove_modifier = "ag_gamma_escort_unlocked"
	remove_modifier = "ag_gamma_station_aux_drone_locked"
	remove_modifier = "ag_gamma_station_aux_drone_unlocked"
	
	remove_modifier = "ag_delta_titan_locked"
	remove_modifier = "ag_delta_titan_unlocked"
	remove_modifier = "ag_delta_drone"
	remove_modifier = "ag_delta_platform_locked"
	remove_modifier = "ag_delta_platform_unlocked"
	remove_modifier = "ag_delta_platform_x0_locked"
	remove_modifier = "ag_delta_platform_x0_unlocked"
	
	remove_modifier = "ag_epsilon_titan_station"
	remove_modifier = "ag_epsilon_titan_locked"
	remove_modifier = "ag_epsilon_titan_unlocked"
	remove_modifier = "ag_epsilon_obelisk_unlocked"
	remove_modifier = "ag_epsilon_defensive_station_large"
	remove_modifier = "ag_epsilon_defensive_station_small"
	remove_modifier = "ag_psionic_beacon"
	remove_modifier = "ag_suppression_station"
	
	remove_modifier = "ag_eta_gateway_hostile"
	remove_modifier = "ag_eta_gateway_locked"
	remove_modifier = "ag_eta_gateway_unlocked"
	remove_modifier = "ag_eta_titan_locked"
	remove_modifier = "ag_eta_titan_unlocked"
	remove_modifier = "ag_eta_titan_phantom"
	remove_modifier = "ag_eta_titan_starbase_hostile"
	remove_modifier = "ag_eta_drone"
	
	remove_modifier = "ag_zeta_titan"
	remove_modifier = "ag_zeta_titan_psi"
	remove_modifier = "ag_zeta_battleship"
	remove_modifier = "ag_zeta_battleship_psi"
	remove_modifier = "ag_zeta_destroyer"
	remove_modifier = "ag_zeta_destroyer_psi"
	remove_modifier = "ag_zeta_military_station_small"
	remove_modifier = "ag_zeta_military_station_small_psi"
	remove_modifier = "ag_zeta_military_station_large"
	remove_modifier = "ag_zeta_military_station_large_psi"
	
	remove_modifier = "ag_zeta_crisis_small_ship"
	remove_modifier = "ag_zeta_crisis_medium_ship"
	remove_modifier = "ag_zeta_crisis_large_ship"
	remove_modifier = "ag_zeta_crisis_support_ship"
	remove_modifier = "ag_zeta_crisis_special_ship"
	remove_modifier = "ag_zeta_crisis_construction_ship"
	remove_modifier = "starbase_ag_zeta_crisis"
	remove_modifier = "ag_zeta_crisis_defensive_platform"
	remove_modifier = "ag_zeta_crisis_avatar_t1"
	remove_modifier = "ag_zeta_crisis_avatar_t2"
	remove_modifier = "ag_zeta_crisis_avatar_t3"
	remove_modifier = "ag_zeta_crisis_avatar_t4"
	remove_modifier = "ag_zeta_crisis_avatar_t5"
	remove_modifier = "ag_zeta_crisis_portal"
	remove_modifier = "ag_zeta_crisis_small_portal"
	remove_modifier = "ag_ancient_zeta_psionic_container"
	remove_modifier = "ag_corrupted_avatar"
	
	remove_modifier = "ag_theta_experiment_ship"
	
	remove_modifier = "ag_iota_station_1"
	
	remove_modifier = "ag_ancient_wandering_ship_locked"
	remove_modifier = "ag_ancient_wandering_ship_unlocked"
	remove_modifier = "ag_ancient_anchor_station_unlocked"
	
	remove_modifier = "ag_lost_ancient_ship"
	remove_modifier = "ag_ancient_cruiser"
}

ag_set_difficulty_button = {
	optimize_memory
	set_global_flag = ag_scaled_difficulty_changed
	set_variable = { which = ag_scaled_difficulty value = $ag_value$ }
	set_variable = { which = ag_scaled_difficulty_tooltip value = ag_scaled_difficulty }
	set_variable = { which = ag_scaled_difficulty_2x value = ag_scaled_difficulty }
	change_variable = { which = ag_scaled_difficulty_tooltip value = 1.0 }
	multiply_variable = { which = ag_scaled_difficulty_2x value = 2 }
}
ag_set_difficulty = {
	optimize_memory
	hidden_effect = { event_target:global_event_country = {
		set_variable = { which = ag_scaled_difficulty_tooltip value = $ag_value$ }
		set_variable = { which = ag_scaled_difficulty value = ag_scaled_difficulty_tooltip }
		set_variable = { which = ag_scaled_difficulty_2x value = ag_scaled_difficulty_tooltip }
		subtract_variable = { which = ag_scaled_difficulty value = 1.0 }
		subtract_variable = { which = ag_scaled_difficulty_2x value = 1.0 }
		multiply_variable = { which = ag_scaled_difficulty_2x value = 2 }
		country_event = { id = ag_settings.110 }
	} }
}
