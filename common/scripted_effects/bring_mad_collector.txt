create_thanos_fleet = {

        create_leader = {
            class = admiral
            species = owner_main_species
            name = random
            skill = 50
            event_leader = yes
            leader_age_min = 100
            leader_age_max = 250
            traits = {
                trait = leader_trait_admiral_chosen
            }
        }

		
		
	create_fleet = {
		name = "Relic Raider"
		settings = {
			spawn_debris = yes
			is_boss = yes
		}
		effect = {
			save_global_event_target_as = thanos
			set_owner = event_target:target_collectors
			create_ship = {
				name = random
				design = Mothership
				effect = { 
					
					save_global_event_target_as = thanos_ship
					set_ship_flag = thanos_ship
				}
			}
			set_fleet_flag = thanos_fleet
			set_location = {
			## change for new_location2 to spawn over planet
				target = event_target:spawning_gateway

			}
			assign_leader = last_created_leader
			set_fleet_stance = agressive
			set_aggro_range_measure_from = self
			set_aggro_range = 50
			
			
			#give_collector_missing_runes = yes
	
	
			
			fleet_event = { id = complexwar.5077 days = 5 }
			
			
			
			
			
			
			
			
			
			
		}
	}
}
## empire kills them all
death_wish = {
        every_pop = {
			limit = {
			exists = owner
			owner = { NOT = { is_country = root } }	
				}

                    kill_pop = yes
                
        }
        every_country = {
            every_owned_leader = {
			limit = {
			exists = owner
			owner = { NOT = { is_country = root } }	
				}
				kill_leader = {
                show_notification = yes
                }
                }
            }
            country_event = { id = nyblax_cube.99 }
        }
	
## collector kills them all
thanos_snap = {
        every_pop = {
				limit = {
			exists = owner
			owner = { NOT = { is_country = event_target:target_collectors } }	
				}
                    kill_pop = yes
        }
        every_country = {
            every_owned_leader = {
				limit = {
			exists = owner
			owner = { NOT = { is_country = event_target:target_collectors } }	
				}
                        kill_leader = {
                            show_notification = yes
                        }
            }
            country_event = { id = nyblax_cube.100 }
        }
		

    }

remove_all_collector_stones =  {
			remove_global_flag = r_damage_rune
			remove_global_flag = r_haste_rune
			remove_global_flag = r_illusion_rune
			remove_global_flag = r_arcane_rune
			remove_global_flag = r_invisibility_rune
			remove_global_flag = r_regeneration_rune
			
			}

give_collector_missing_runes = {

## check if anybody has any infinity stones, give thanos the rest
			if = {
				limit = {
				NOT = { any_country = { has_relic = r_damage_rune } }				
				}
				set_global_flag = r_damage_rune
				set_global_flag = r_damage_rune_collected		
			}
			if = {
				limit = {
				NOT = { any_country = { has_relic = r_haste_rune } }				
				}
				set_global_flag = r_haste_rune
				set_global_flag = r_haste_rune_collected		
			}
			if = {
				limit = {
				NOT = { any_country = { has_relic = r_illusion_rune } }				
				}
				set_global_flag = r_illusion_rune	
				set_global_flag = r_illusion_rune_collected				
			}
			if = {
				limit = {
				NOT = { any_country = { has_relic = r_arcane_rune } }				
				}
				set_global_flag = r_arcane_rune		
				set_global_flag = r_arcane_rune_collected	
			}
			if = {
				limit = {
				NOT = { any_country = { has_relic = r_invisibility_rune } }				
				}
				set_global_flag = r_invisibility_rune	
				set_global_flag = r_invisibility_rune_collected			
			}
			if = {
				limit = {
				NOT = { any_country = { has_relic = r_regeneration_rune } }				
				}
				set_global_flag = r_regeneration_rune	
				set_global_flag = r_regeneration_rune_collected		
			}
	
			
				## check if thanos has them all, then snap and send him to his farm
			if = {
			limit = { 
			collector_has_all_runes = yes
			}
			## snap and go to the farm
						thanos_snap = yes
						event_target:thanos_ship = {
									delete_ship = this
							}
				remove_all_collector_stones = yes
			}
}

give_collector_all_runes = {
if = {
			limit = { has_relic = r_damage_rune  }
		
		 hidden_effect = { remove_relic = r_damage_rune }
		 hidden_effect = { country_event = { id = power_runes_war.2 } }
		set_global_flag = r_damage_rune	
		
		}
		
			if = {
			limit = { has_relic = r_haste_rune } 
	
		 hidden_effect = { remove_relic = r_haste_rune }
		 hidden_effect = { country_event = { id = power_runes_war.4 } }
		 set_global_flag = r_haste_rune	
		}
		
			if = {
			limit = {has_relic = r_illusion_rune } 
		
		 hidden_effect = { remove_relic = r_illusion_rune }
		 hidden_effect = { country_event = { id = power_runes_war.6 } }
		 set_global_flag = r_illusion_rune	
		
		}
		
			if = {
			limit = {  has_relic = r_arcane_rune }
		
		 hidden_effect = { remove_relic = r_arcane_rune }
		 hidden_effect = { country_event = { id = power_runes_war.8 } }
		 set_global_flag = r_arcane_rune	
		
		}
		
			if = {
			limit = {has_relic = r_invisibility_rune } 
		
		 hidden_effect = { remove_relic = r_invisibility_rune }
		 hidden_effect = { country_event = { id = power_runes_war.10 } }
		 set_global_flag = r_invisibility_rune	
		
		 
		}
		
			if = {
			limit = { has_relic = r_regeneration_rune } 
		
		 hidden_effect = { remove_relic = r_regeneration_rune }
		 hidden_effect = { country_event = { id = power_runes_war.12 } }
		 set_global_flag = r_regeneration_rune	
		
		}
	
	
	
		## check if thanos has them all, then snap and send him to his farm
		if = {
		limit = { 
		collector_has_all_runes = yes
		}
		## snap and go to the farm
					thanos_snap = yes
					event_target:thanos_ship = {
								delete_ship = this
						}
			remove_all_collector_stones = yes
		}	
		
		}
		
give_away_missing_runes = {

	if = {
	limit = { is_present_regeneration_rune = no }
				random_playable_country = {
                    limit = { is_country_type = default is_subject = no }
					set_global_flag = r_regeneration_rune_collected	
                    country_event = { id = pr_maintenance.68 }
                }

	}
	else_if = {
	limit = { is_present_invisibility_rune = no }
				random_playable_country = {
                    limit = { is_country_type = default is_subject = no }
					set_global_flag = r_invisibility_rune_collected	
                    country_event = { id = pr_maintenance.65 }
                }

	}
	else_if = {
	limit = { is_present_arcane_rune = no }
				random_playable_country = {
                    limit = { is_country_type = default is_subject = no }
					set_global_flag = r_arcane_rune_collected	
                    country_event = { id = pr_maintenance.62 }
                }

	}
	else_if = {
	limit = { is_present_illusion_rune = no }
				random_playable_country = {
                    limit = { is_country_type = default is_subject = no }
					set_global_flag = r_illusion_rune_collected	
                    country_event = { id = pr_maintenance.59 }
                }

	}
	else_if = {
	limit = { is_present_haste_rune = no }
				random_playable_country = {
                    limit = { is_country_type = default is_subject = no }
					set_global_flag = r_haste_rune_collected	
                    country_event = { id = pr_maintenance.56 }
                }

	}
	else_if = {
	limit = { is_present_damage_rune = no }
				random_playable_country = {
                    limit = { is_country_type = default is_subject = no }
					set_global_flag = r_damage_rune_collected	
                    country_event = { id = pr_maintenance.53 }
                }

	}



}

