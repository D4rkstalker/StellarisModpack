xvcv_mdlc_core_modifying_trait_pick_effect = {
	custom_tooltip = xvcv_mdlc_core_modifying_tooltip_add_$CLASS$_$ID$
	hidden_effect = {
		ruler = {
			if = {
				limit = { NOT = { leader_class = $CLASS$ } }
				change_leader_class = $CLASS$
			}
			add_trait_no_notify = $ID$
			#revert the ruler's leader class
			prev = {
				switch = {
					trigger = has_country_flag
					xvcv_mdlc_core_modifying_ruler_leader_class_governor = { prev = { change_leader_class = governor } }
					xvcv_mdlc_core_modifying_ruler_leader_class_scientist = { prev = { change_leader_class = scientist } }
					xvcv_mdlc_core_modifying_ruler_leader_class_admiral = { prev = { change_leader_class = admiral } }
					xvcv_mdlc_core_modifying_ruler_leader_class_general = { prev = { change_leader_class = general } }
				}
			}
		}
	}
}
xvcv_mdlc_core_modifying_set_subclass_effect = {
	custom_tooltip = xvcv_mdlc_core_modifying_tooltip_add_$CLASS$_$ID$
	hidden_effect = {
		ruler = {
			if = {
				limit = { NOT = { leader_class = $CLASS$ } }
				change_leader_class = $CLASS$
			}
			add_trait_no_notify = $ID$
		}
		set_country_flag = xvcv_mdlc_core_modifying_ruler_leader_class_$CLASS$
	}
}
xvcv_mdlc_core_modifying_remove_tier_1_or_2_traits_effect = {
	hidden_effect = {
		ruler = {
			if = {
				limit = { has_trait = $ID$ }
				remove_trait = $ID$
			}
			if = { #don't use 'else_if' here #a ruler can have both tier 1 and tier 2 traits at the same time #it's rare but not impossible
				limit = { has_trait = $ID$_2 }
				remove_trait = $ID$_2
			}
		}
	}
}
xvcv_mdlc_core_modifying_check_leader_class_of_ruler_effect = {
	#clear the previous flag
	switch = {
		trigger = has_country_flag
		xvcv_mdlc_core_modifying_ruler_leader_class_governor = { remove_country_flag = xvcv_mdlc_core_modifying_ruler_leader_class_governor }
		xvcv_mdlc_core_modifying_ruler_leader_class_scientist = { remove_country_flag = xvcv_mdlc_core_modifying_ruler_leader_class_scientist }
		xvcv_mdlc_core_modifying_ruler_leader_class_admiral = { remove_country_flag = xvcv_mdlc_core_modifying_ruler_leader_class_admiral }
		xvcv_mdlc_core_modifying_ruler_leader_class_general = { remove_country_flag = xvcv_mdlc_core_modifying_ruler_leader_class_general }
	}
	#and check the leader class again
	ruler = {
		switch = {
			trigger = leader_class
			#sadly, this won't support modded leader classes
			governor = { prev = { set_country_flag = xvcv_mdlc_core_modifying_ruler_leader_class_governor } }
			scientist = { prev = { set_country_flag = xvcv_mdlc_core_modifying_ruler_leader_class_scientist } }
			admiral = { prev = { set_country_flag = xvcv_mdlc_core_modifying_ruler_leader_class_admiral } }
			general = { prev = { set_country_flag = xvcv_mdlc_core_modifying_ruler_leader_class_general } }
		}
	}
}
xvcv_mdlc_core_modifying_clear_trait_variables_effect = {
	set_variable = { which = xvcv_mdlc_core_modifying_trait_points value = 4 } #max trait points
	set_variable = { which = xvcv_mdlc_core_modifying_max_traits_number value = 3 } #max traits number
	if = {
		limit = { has_technology = xvcv_mdlc_tech_core_modifying_improvement }
		change_variable = { which = xvcv_mdlc_core_modifying_trait_points value = 1 }
		change_variable = { which = xvcv_mdlc_core_modifying_max_traits_number value = 1 }
	}
	if = {
		limit = { has_technology = xvcv_mdlc_tech_core_modifying_improvement_2 } #both techs increase the same amount of trait modification points
		change_variable = { which = xvcv_mdlc_core_modifying_trait_points value = 1 }
		change_variable = { which = xvcv_mdlc_core_modifying_max_traits_number value = 1 }
	}
}
#for common traits
xvcv_mdlc_core_modifying_trait_add_effect = {
	add_resource = { energy = -200 alloys = -200 }
	change_variable = { which = xvcv_mdlc_core_modifying_trait_points value = -1 }
	change_variable = { which = xvcv_mdlc_core_modifying_max_traits_number value = -1 }
}
xvcv_mdlc_core_modifying_trait_remove_effect = {
	xvcv_mdlc_core_modifying_trait_return_cost_effect = yes
	xvcv_mdlc_core_modifying_trait_return_points_effect = yes
}
xvcv_mdlc_core_modifying_trait_return_cost_effect = {
	add_resource = { energy = 100 alloys = 100 }
}
xvcv_mdlc_core_modifying_trait_return_points_effect = {
	if = {
		limit = {
			OR = {
				check_variable = { which = xvcv_mdlc_core_modifying_trait_points value > 6 }
				AND = {
					NOT = { has_technology = xvcv_mdlc_tech_core_modifying_improvement_2 }
					check_variable = { which = xvcv_mdlc_core_modifying_trait_points value > 5 }
				}
				AND = {
					NOT = { has_technology = xvcv_mdlc_tech_core_modifying_improvement }
					check_variable = { which = xvcv_mdlc_core_modifying_trait_points value > 4 }
				}
			}
		}
		xvcv_mdlc_core_modifying_clear_trait_variables_effect = yes
		else = {
			change_variable = { which = xvcv_mdlc_core_modifying_trait_points value = 1 }
			change_variable = { which = xvcv_mdlc_core_modifying_max_traits_number value = 1 }
		}
	}
}
#for veteran traits
xvcv_mdlc_core_modifying_trait_add_alt_effect = {
	add_resource = { energy = -500 alloys = -500 }
	change_variable = { which = xvcv_mdlc_core_modifying_trait_points value = -2 }
	change_variable = { which = xvcv_mdlc_core_modifying_max_traits_number value = -1 }
}
xvcv_mdlc_core_modifying_trait_remove_alt_effect = {
	xvcv_mdlc_core_modifying_trait_return_cost_alt_effect = yes
	xvcv_mdlc_core_modifying_trait_return_points_alt_effect = yes
}
xvcv_mdlc_core_modifying_trait_return_cost_alt_effect = {
	add_resource = { energy = 250 alloys = 250 }
}
xvcv_mdlc_core_modifying_trait_return_points_alt_effect = {
	if = {
		limit = {
			OR = {
				check_variable = { which = xvcv_mdlc_core_modifying_trait_points value > 6 }
				AND = {
					NOT = { has_technology = xvcv_mdlc_tech_core_modifying_improvement_2 }
					check_variable = { which = xvcv_mdlc_core_modifying_trait_points value > 5 }
				}
				AND = {
					NOT = { has_technology = xvcv_mdlc_tech_core_modifying_improvement }
					check_variable = { which = xvcv_mdlc_core_modifying_trait_points value > 4 }
				}
			}
		}
		xvcv_mdlc_core_modifying_clear_trait_variables_effect = yes
		else = {
			change_variable = { which = xvcv_mdlc_core_modifying_trait_points value = 2 }
			change_variable = { which = xvcv_mdlc_core_modifying_max_traits_number value = 1 }
		}
	}
}
#for destiny traits
xvcv_mdlc_core_modifying_trait_add_alt_2_effect = {
	add_resource = { energy = -1000 alloys = -1000 }
	change_variable = { which = xvcv_mdlc_core_modifying_trait_points value = -3 }
	change_variable = { which = xvcv_mdlc_core_modifying_max_traits_number value = -1 }
}
xvcv_mdlc_core_modifying_trait_remove_alt_2_effect = {
	xvcv_mdlc_core_modifying_trait_return_cost_alt_2_effect = yes
	xvcv_mdlc_core_modifying_trait_return_points_alt_2_effect = yes
}
xvcv_mdlc_core_modifying_trait_return_cost_alt_2_effect = {
	add_resource = { energy = 500 alloys = 500 }
}
xvcv_mdlc_core_modifying_trait_return_points_alt_2_effect = {
	if = {
		limit = {
			OR = {
				check_variable = { which = xvcv_mdlc_core_modifying_trait_points value > 6 }
				AND = {
					NOT = { has_technology = xvcv_mdlc_tech_core_modifying_improvement_2 }
					check_variable = { which = xvcv_mdlc_core_modifying_trait_points value > 5 }
				}
				AND = {
					NOT = { has_technology = xvcv_mdlc_tech_core_modifying_improvement }
					check_variable = { which = xvcv_mdlc_core_modifying_trait_points value > 4 }
				}
			}
		}
		xvcv_mdlc_core_modifying_clear_trait_variables_effect = yes
		else = {
			change_variable = { which = xvcv_mdlc_core_modifying_trait_points value = 3 }
			change_variable = { which = xvcv_mdlc_core_modifying_max_traits_number value = 1 }
		}
	}
}
#and that ends here
xvcv_mdlc_core_modifying_reset_traits_effect = {
	ruler = {
		#generic ruler traits (total 3)
		if = { limit = { has_trait = leader_trait_politician_2 } remove_trait = leader_trait_politician_2 prev = { xvcv_mdlc_core_modifying_trait_return_cost_alt_effect = yes } }
		if = { limit = { has_trait = leader_trait_educator } remove_trait = leader_trait_educator prev = { xvcv_mdlc_core_modifying_trait_return_cost_alt_2_effect = yes } }
		if = { limit = { has_trait = leader_trait_master_bureaucrat } remove_trait = leader_trait_master_bureaucrat prev = { xvcv_mdlc_core_modifying_trait_return_cost_alt_2_effect = yes } }
		#governor ruler subclass trait (total 1)
		if = { limit = { has_trait = subclass_governor_visionary } remove_trait = subclass_governor_visionary prev = { xvcv_mdlc_core_modifying_trait_return_cost_effect = yes } }
		#governor ruler traits (total 15)
		if = { limit = { has_trait = trait_ruler_fertility_preacher_2 } remove_trait = trait_ruler_fertility_preacher_2 prev = { xvcv_mdlc_core_modifying_trait_return_cost_effect = yes } }
		if = { limit = { has_trait = leader_trait_principled_2 } remove_trait = leader_trait_principled_2 prev = { xvcv_mdlc_core_modifying_trait_return_cost_effect = yes } }
		if = { limit = { has_trait = trait_ruler_industrialist_2 } remove_trait = trait_ruler_industrialist_2 prev = { xvcv_mdlc_core_modifying_trait_return_cost_effect = yes } }
		if = { limit = { has_trait = trait_ruler_charismatic_2 } remove_trait = trait_ruler_charismatic_2 prev = { xvcv_mdlc_core_modifying_trait_return_cost_effect = yes } }
		if = { limit = { has_trait = trait_ruler_feedback_loop_2 } remove_trait = trait_ruler_feedback_loop_2 prev = { xvcv_mdlc_core_modifying_trait_return_cost_effect = yes } }
		if = { limit = { has_trait = trait_ruler_logistic_understanding_2 } remove_trait = trait_ruler_logistic_understanding_2 prev = { xvcv_mdlc_core_modifying_trait_return_cost_effect = yes } }
		if = { limit = { has_trait = trait_ruler_eye_for_talent_2 } remove_trait = trait_ruler_eye_for_talent_2 prev = { xvcv_mdlc_core_modifying_trait_return_cost_effect = yes } }
		if = { limit = { has_trait = trait_ruler_frontier_spirit } remove_trait = trait_ruler_frontier_spirit prev = { xvcv_mdlc_core_modifying_trait_return_cost_alt_effect = yes } }
		if = { limit = { has_trait = leader_trait_frontier_spirit_3 } remove_trait = leader_trait_frontier_spirit_3 prev = { xvcv_mdlc_core_modifying_trait_return_cost_alt_effect = yes } }
		if = { limit = { has_trait = leader_trait_cultural_focus_3 } remove_trait = leader_trait_cultural_focus_3 prev = { xvcv_mdlc_core_modifying_trait_return_cost_alt_effect = yes } }
		if = { limit = { has_trait = trait_ruler_investor_3 } remove_trait = trait_ruler_investor_3 prev = { xvcv_mdlc_core_modifying_trait_return_cost_alt_effect = yes } }
		if = { limit = { has_trait = trait_ruler_architectural_sense_3 } remove_trait = trait_ruler_architectural_sense_3 prev = { xvcv_mdlc_core_modifying_trait_return_cost_alt_effect = yes } }
		if = { limit = { has_trait = trait_ruler_deep_connections_3 } remove_trait = trait_ruler_deep_connections_3 prev = { xvcv_mdlc_core_modifying_trait_return_cost_alt_effect = yes } }
		if = { limit = { has_trait = leader_trait_reformer_3 } remove_trait = leader_trait_reformer_3 prev = { xvcv_mdlc_core_modifying_trait_return_cost_alt_effect = yes } }
		if = { limit = { has_trait = leader_trait_courtroom_training_3 } remove_trait = leader_trait_courtroom_training_3 prev = { xvcv_mdlc_core_modifying_trait_return_cost_alt_effect = yes } }	
		#scientist ruler subclass trait (total 1)
		if = { limit = { has_trait = subclass_scientist_researcher } remove_trait = subclass_scientist_researcher prev = { xvcv_mdlc_core_modifying_trait_return_cost_effect = yes } }
		#scientist ruler traits (total 25)
		if = { limit = { has_trait = leader_trait_spark_of_genius_2 } remove_trait = leader_trait_spark_of_genius_2 prev = { xvcv_mdlc_core_modifying_trait_return_cost_effect = yes } }
		if = { limit = { has_trait = trait_ruler_home_in_the_sky } remove_trait = trait_ruler_home_in_the_sky prev = { xvcv_mdlc_core_modifying_trait_return_cost_effect = yes } }
		if = { limit = { has_trait = trait_ruler_space_miner } remove_trait = trait_ruler_space_miner prev = { xvcv_mdlc_core_modifying_trait_return_cost_effect = yes } }
		if = { limit = { has_trait = leader_trait_inquisitive_3 } remove_trait = leader_trait_inquisitive_3 prev = { xvcv_mdlc_core_modifying_trait_return_cost_alt_effect = yes } }
		if = { limit = { has_trait = leader_trait_maniacal_3 } remove_trait = leader_trait_maniacal_3 prev = { xvcv_mdlc_core_modifying_trait_return_cost_alt_effect = yes } }
		if = { limit = { has_trait = trait_ruler_explorer_3 } remove_trait = trait_ruler_explorer_3 prev = { xvcv_mdlc_core_modifying_trait_return_cost_alt_effect = yes } }
		if = { limit = { has_trait = trait_ruler_expansionist_3 } remove_trait = trait_ruler_expansionist_3 prev = { xvcv_mdlc_core_modifying_trait_return_cost_alt_effect = yes } }
		if = { limit = { has_trait = trait_ruler_world_shaper_3 } remove_trait = trait_ruler_world_shaper_3 prev = { xvcv_mdlc_core_modifying_trait_return_cost_alt_effect = yes } }
		if = { limit = { has_trait = leader_trait_science_communicator_3 } remove_trait = leader_trait_science_communicator_3 prev = { xvcv_mdlc_core_modifying_trait_return_cost_alt_effect = yes } }
		if = { limit = { has_trait = leader_trait_engineering_focus_3 } remove_trait = leader_trait_engineering_focus_3 prev = { xvcv_mdlc_core_modifying_trait_return_cost_alt_effect = yes } }
		if = { limit = { has_trait = leader_trait_physics_focus_3 } remove_trait = leader_trait_physics_focus_3 prev = { xvcv_mdlc_core_modifying_trait_return_cost_alt_effect = yes } }
		if = { limit = { has_trait = leader_trait_society_focus_3 } remove_trait = leader_trait_society_focus_3 prev = { xvcv_mdlc_core_modifying_trait_return_cost_alt_effect = yes } }
		if = { limit = { has_trait = leader_trait_expertise_materials_3 } remove_trait = leader_trait_expertise_materials_3 prev = { xvcv_mdlc_core_modifying_trait_return_cost_alt_effect = yes } }
		if = { limit = { has_trait = leader_trait_expertise_propulsion_3 } remove_trait = leader_trait_expertise_propulsion_3 prev = { xvcv_mdlc_core_modifying_trait_return_cost_alt_effect = yes } }
		if = { limit = { has_trait = leader_trait_expertise_voidcraft_3 } remove_trait = leader_trait_expertise_voidcraft_3 prev = { xvcv_mdlc_core_modifying_trait_return_cost_alt_effect = yes } }
		if = { limit = { has_trait = leader_trait_expertise_industry_3 } remove_trait = leader_trait_expertise_industry_3 prev = { xvcv_mdlc_core_modifying_trait_return_cost_alt_effect = yes } }
		if = { limit = { has_trait = leader_trait_expertise_field_manipulation_3 } remove_trait = leader_trait_expertise_field_manipulation_3 prev = { xvcv_mdlc_core_modifying_trait_return_cost_alt_effect = yes } }
		if = { limit = { has_trait = leader_trait_expertise_particles_3 } remove_trait = leader_trait_expertise_particles_3 prev = { xvcv_mdlc_core_modifying_trait_return_cost_alt_effect = yes } }
		if = { limit = { has_trait = leader_trait_expertise_computing_3 } remove_trait = leader_trait_expertise_computing_3 prev = { xvcv_mdlc_core_modifying_trait_return_cost_alt_effect = yes } }
		if = { limit = { has_trait = leader_trait_expertise_psionics_3 } remove_trait = leader_trait_expertise_psionics_3 prev = { xvcv_mdlc_core_modifying_trait_return_cost_alt_effect = yes } }
		if = { limit = { has_trait = leader_trait_expertise_new_worlds_3 } remove_trait = leader_trait_expertise_new_worlds_3 prev = { xvcv_mdlc_core_modifying_trait_return_cost_alt_effect = yes } }
		if = { limit = { has_trait = leader_trait_expertise_statecraft_3 } remove_trait = leader_trait_expertise_statecraft_3 prev = { xvcv_mdlc_core_modifying_trait_return_cost_alt_effect = yes } }
		if = { limit = { has_trait = leader_trait_expertise_biology_3 } remove_trait = leader_trait_expertise_biology_3 prev = { xvcv_mdlc_core_modifying_trait_return_cost_alt_effect = yes } }
		if = { limit = { has_trait = leader_trait_expertise_military_theory_3 } remove_trait = leader_trait_expertise_military_theory_3 prev = { xvcv_mdlc_core_modifying_trait_return_cost_alt_effect = yes } }
		if = { limit = { has_trait = leader_trait_expertise_archaeostudies_3 } remove_trait = leader_trait_expertise_archaeostudies_3 prev = { xvcv_mdlc_core_modifying_trait_return_cost_alt_effect = yes } }
		#admiral ruler subclass trait (total 1)
		if = { limit = { has_trait = subclass_admiral_strategist } remove_trait = subclass_admiral_strategist prev = { xvcv_mdlc_core_modifying_trait_return_cost_effect = yes } }
		#admiral ruler traits (total 15)
		if = { limit = { has_trait = leader_trait_fleet_organizer_2 } remove_trait = leader_trait_fleet_organizer_2 prev = { xvcv_mdlc_core_modifying_trait_return_cost_effect = yes } }
		if = { limit = { has_trait = trait_ruler_warlike_2 } remove_trait = trait_ruler_warlike_2 prev = { xvcv_mdlc_core_modifying_trait_return_cost_effect = yes } }
		if = { limit = { has_trait = leader_trait_skirmisher_2 } remove_trait = leader_trait_skirmisher_2 prev = { xvcv_mdlc_core_modifying_trait_return_cost_effect = yes } }
		if = { limit = { has_trait = trait_ruler_corvette_focus } remove_trait = trait_ruler_corvette_focus prev = { xvcv_mdlc_core_modifying_trait_return_cost_effect = yes } }
		if = { limit = { has_trait = trait_ruler_destroyer_focus } remove_trait = trait_ruler_destroyer_focus prev = { xvcv_mdlc_core_modifying_trait_return_cost_effect = yes } }
		if = { limit = { has_trait = trait_ruler_cruiser_focus } remove_trait = trait_ruler_cruiser_focus prev = { xvcv_mdlc_core_modifying_trait_return_cost_effect = yes } }
		if = { limit = { has_trait = trait_ruler_battleship_focus } remove_trait = trait_ruler_battleship_focus prev = { xvcv_mdlc_core_modifying_trait_return_cost_effect = yes } }
		if = { limit = { has_trait = leader_trait_gale_speed_3 } remove_trait = leader_trait_gale_speed_3 prev = { xvcv_mdlc_core_modifying_trait_return_cost_alt_effect = yes } }
		if = { limit = { has_trait = trait_ruler_fortifier_3 } remove_trait = trait_ruler_fortifier_3 prev = { xvcv_mdlc_core_modifying_trait_return_cost_alt_effect = yes } }
		if = { limit = { has_trait = leader_trait_armada_logistician_3 } remove_trait = leader_trait_armada_logistician_3 prev = { xvcv_mdlc_core_modifying_trait_return_cost_alt_effect = yes } }
		if = { limit = { has_trait = trait_ruler_military_pioneer_3 } remove_trait = trait_ruler_military_pioneer_3 prev = { xvcv_mdlc_core_modifying_trait_return_cost_alt_effect = yes } }
		if = { limit = { has_trait = leader_trait_intimidator_3 } remove_trait = leader_trait_intimidator_3 prev = { xvcv_mdlc_core_modifying_trait_return_cost_alt_effect = yes } }
		if = { limit = { has_trait = leader_trait_border_guard_3 } remove_trait = leader_trait_border_guard_3 prev = { xvcv_mdlc_core_modifying_trait_return_cost_alt_effect = yes } }
		if = { limit = { has_trait = leader_trait_crew_trainer_3 } remove_trait = leader_trait_crew_trainer_3 prev = { xvcv_mdlc_core_modifying_trait_return_cost_alt_effect = yes } }
		if = { limit = { has_trait = leader_trait_armorer } remove_trait = leader_trait_armorer prev = { xvcv_mdlc_core_modifying_trait_return_cost_alt_2_effect = yes } }
		#general ruler subclass trait (total 1)
		if = { limit = { has_trait = subclass_general_marshall } remove_trait = subclass_general_marshall prev = { xvcv_mdlc_core_modifying_trait_return_cost_effect = yes } }
		#general ruler traits (total 10)
		if = { limit = { has_trait = leader_trait_defence_engineer_2 } remove_trait = leader_trait_defence_engineer_2 prev = { xvcv_mdlc_core_modifying_trait_return_cost_effect = yes } }
		if = { limit = { has_trait = leader_trait_spycraft_2 } remove_trait = leader_trait_spycraft_2 prev = { xvcv_mdlc_core_modifying_trait_return_cost_effect = yes } }
		if = { limit = { has_trait = leader_trait_overseer_3 } remove_trait = leader_trait_overseer_3 prev = { xvcv_mdlc_core_modifying_trait_return_cost_alt_effect = yes } }
		if = { limit = { has_trait = trait_ruler_from_the_ranks_3 } remove_trait = trait_ruler_from_the_ranks_3 prev = { xvcv_mdlc_core_modifying_trait_return_cost_alt_effect = yes } }
		if = { limit = { has_trait = trait_ruler_recruiter_3 } remove_trait = trait_ruler_recruiter_3 prev = { xvcv_mdlc_core_modifying_trait_return_cost_alt_effect = yes } }
		if = { limit = { has_trait = leader_trait_consul_general_3 } remove_trait = leader_trait_consul_general_3 prev = { xvcv_mdlc_core_modifying_trait_return_cost_alt_effect = yes } }
		if = { limit = { has_trait = leader_trait_shadow_broker_3 } remove_trait = leader_trait_shadow_broker_3 prev = { xvcv_mdlc_core_modifying_trait_return_cost_alt_effect = yes } }
		if = { limit = { has_trait = leader_trait_home_guard_3 } remove_trait = leader_trait_home_guard_3 prev = { xvcv_mdlc_core_modifying_trait_return_cost_alt_effect = yes } }
		if = { limit = { has_trait = leader_trait_spymaster } remove_trait = leader_trait_spymaster prev = { xvcv_mdlc_core_modifying_trait_return_cost_alt_2_effect = yes } }
		if = { limit = { has_trait = leader_trait_bellicose } remove_trait = leader_trait_bellicose prev = { xvcv_mdlc_core_modifying_trait_return_cost_alt_2_effect = yes } }
	}
	xvcv_mdlc_core_modifying_clear_trait_variables_effect = yes
}