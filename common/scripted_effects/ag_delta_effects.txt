
ag_deploy_ancient_turret_preparation = {
	optimize_memory
	add_modifier = { modifier = "ag_delta_platform_deploying" days = $ag_delay$ }
	set_fleet_flag = ag_delta_platform_deploying
	clear_orders = yes
	clear_fleet_actions = this
	fleet_event = { id = ag_delta.70 days = $ag_delay$ }
}
ag_deploy_ancient_turret_effect = {
	optimize_memory
	if = {
		limit = { owner = { NOT = { has_country_flag = ag_delta_ships_unlocked } } }
		create_fleet = {
			name = "NAME_ag_delta_platform_fleet"
			settings = {
				can_upgrade = no
				can_change_composition = no
				can_change_leader = no
				spawn_debris = no
			}
			effect = {
				set_owner = prev.owner
				create_ship = {
					name = "NAME_ag_delta_platform_ship"
					design = "NAME_ag_delta_platform_0"
					prefix = no
					effect = {
						if = {
							limit = { fleet.owner = { has_country_flag = ag_ship_subsystem_enabled_402_15 } }
							add_modifier = { modifier = "ag_delta_platform_range_buff" days = -1 }
						}
						ag_difficulty_bonus = yes
					}
				}
				set_location = { target = prev distance = 0 angle = 0 }
			}
		}
	}
	else = {
		create_fleet = {
			name = "NAME_ag_delta_platform_fleet"
			settings = {
				can_upgrade = no
				can_change_composition = no
				can_change_leader = no
				spawn_debris = no
			}
			effect = {
				set_owner = prev.owner
				create_ship = {
					name = "NAME_ag_delta_platform_ship"
					design = "NAME_ag_delta_platform_1"
					prefix = no
					effect = {
						if = {
							limit = { fleet.owner = { has_country_flag = ag_ship_subsystem_enabled_402_15 } }
							add_modifier = { modifier = "ag_delta_platform_range_buff" days = -1 }
						}
						ag_difficulty_bonus = yes
					}
				}
				set_location = { target = prev distance = 0 angle = 0 }
			}
		}
	}
	delete_fleet = this
}

ag_delta_situation_reward = {
	optimize_memory
	random_list = {
		10 = {
			modifier = {
				factor = 0
				has_country_flag = ag_delta_41_fired
				has_country_flag = ag_delta_42_fired
				has_country_flag = ag_delta_43_fired
			}
			if = {
				limit = { NOT = { has_country_flag = ag_delta_41_fired } }
				set_country_flag = ag_delta_41_fired
				country_event = { id = ag_delta.41 days = 5 random = 5 }
			}
			else = {
				random_list = {
					10 = {
						modifier = { factor = 0 has_country_flag = ag_delta_42_fired }
						set_country_flag = ag_delta_42_fired
						country_event = { id = ag_delta.42 days = 5 random = 5 }
					}
					10 = {
						modifier = { factor = 0 has_country_flag = ag_delta_43_fired }
						set_country_flag = ag_delta_43_fired
						country_event = { id = ag_delta.43 days = 5 random = 5 }
					}
				}
				reroll_random = yes
			}
		}
		10 = {
			modifier = { factor = 0 has_country_flag = ag_delta_44_fired }
			set_country_flag = ag_delta_44_fired
			country_event = { id = ag_delta.44 days = 5 random = 5 }
		}
	}
	reroll_random = yes
}
