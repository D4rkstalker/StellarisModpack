#	Example:
#
#	example_effect = {
#		add_resource = { energy = -100 }
#	}
#
#
#	In a script file:
#
#	effect = {
#		example_effect = yes
#	}
#

@AssetCategoryDownWeight = 0.4 #Factor for however *less* likely you are to receive an Asset which is in the same category as the current Operation
@AssetTypeWeight = 10 #Factor for however more or less likely you are to receive an Asset in the same category as one which is assigned to Acquire Asset

### RESOLUTIONS ###

breach_fix_resolution_rulesofwar_independent_tribunals = {
	if = {
		limit = {
			OR = {
				is_active_resolution = "resolution_rulesofwar_independent_tribunals"
				is_active_resolution = "resolution_rulesofwar_last_resort_doctrine"
				is_active_resolution = "resolution_rulesofwar_demobilization_initiative"
			}
			in_breach_of = resolution_rulesofwar_independent_tribunals
			OR = {
				has_policy_flag = orbital_bombardment_armageddon
				has_policy_flag = orbital_bombardment_indiscriminate
				has_policy_flag = orbital_bombardment_redtoxin
			}
		}
		hidden_effect = {
			set_policy = {
				policy = orbital_bombardment
				option = orbital_bombardment_selective
				cooldown = yes
			}
		}

		custom_tooltip = "federations.10310.comply"
	}
}

breach_fix_resolution_galacticstudies_ethical_guideline_refactoring = {
	if = {
		limit = {
			OR = {
				is_active_resolution = "resolution_galacticstudies_ethical_guideline_refactoring"
				is_active_resolution = "resolution_galacticstudies_extradimensional_experimentation"
			}
			in_breach_of = resolution_galacticstudies_ethical_guideline_refactoring
			has_technology = tech_capacity_boosters
			can_set_policy = {
				policy = leader_enhancement
				option = leader_enhancement_capacity_boosters
			}
		}
		set_policy = {
			policy = leader_enhancement
			option = leader_enhancement_capacity_boosters
			cooldown = yes
		}
		custom_tooltip = "federations.10110.capacity_boosters"
	}
	else_if = {
		limit = {
			OR = {
				is_active_resolution = "resolution_galacticstudies_ethical_guideline_refactoring"
				is_active_resolution = "resolution_galacticstudies_extradimensional_experimentation"
			}
			in_breach_of = resolution_galacticstudies_ethical_guideline_refactoring
			has_technology = tech_selected_lineages
			NOT = { has_technology = tech_capacity_boosters }
			can_set_policy = {
				policy = leader_enhancement
				option = leader_enhancement_selected_lineages
			}
		}
		set_policy = {
			policy = leader_enhancement
			option = leader_enhancement_selected_lineages
			cooldown = yes
		}
		custom_tooltip = "federations.10110.selected_lineages"
	}
	else_if = {
		limit = {
			has_global_flag = expanded_megastructures_installed
			OR = {
				is_active_resolution = "resolution_galacticstudies_ethical_guideline_refactoring"
				is_active_resolution = "resolution_galacticstudies_extradimensional_experimentation"
			}
			in_breach_of = resolution_galacticstudies_ethical_guideline_refactoring
			has_technology = tech_capacity_boosters_machine
			can_set_policy = {
				policy = leader_enhancement_machine
				option = leader_enhancement_capacity_boosters_machine
			}
		}
		set_policy = {
			policy = leader_enhancement_machine
			option = leader_enhancement_capacity_boosters_machine
			cooldown = yes
		}
		custom_tooltip = "federations.10110.capacity_boosters"
	}
	else_if = {
		limit = {
			has_global_flag = expanded_megastructures_installed
			OR = {
				is_active_resolution = "resolution_galacticstudies_ethical_guideline_refactoring"
				is_active_resolution = "resolution_galacticstudies_extradimensional_experimentation"
			}
			in_breach_of = resolution_galacticstudies_ethical_guideline_refactoring
			has_technology = tech_selected_lineages_machine
			NOT = { has_technology = tech_capacity_boosters_machine }
			can_set_policy = {
				policy = leader_enhancement_machine
				option = leader_enhancement_selected_lineages_machine
			}
		}
		set_policy = {
			policy = leader_enhancement_machine
			option = leader_enhancement_selected_lineages_machine
			cooldown = yes
		}
		custom_tooltip = "federations.10110.selected_lineages"
	}
}

### OPERATIONS ###

create_privateer_fleet = {
	event_target:privateer_band = {
		create_leader = {
			class = admiral
			species = owner_main_species
			name = random
			skill = 1
		}
		create_fleet = {
			name = "NAME_Privateers"
			effect = {
				set_owner = event_target:privateer_band
				if = {
					limit = {
						event_target:target_country = {
							fleet_power < 300
						}
					}
					create_privateer_ships_0 = yes
				}
				if = {
					limit = {
						event_target:target_country = {
							fleet_power >= 300
							fleet_power < 600
						}
					}
					create_privateer_ships_1 = yes
				}
				if = {
					limit = {
						event_target:target_country = {
							fleet_power >= 600
							fleet_power < 1000
						}
					}
					create_privateer_ships_2 = yes
				}
				if = {
					limit = {
						event_target:target_country = {
							fleet_power >= 1000
							fleet_power < 2000
						}
					}
					create_privateer_ships_3 = yes
				}
				if = {
					limit = {
						event_target:target_country = {
							fleet_power >= 2000
							fleet_power < 4000
						}
					}
					create_privateer_ships_4 = yes
				}
				if = {
					limit = {
						event_target:target_country = {
							fleet_power >= 4000
							fleet_power < 8000
						}
					}
					create_privateer_ships_5 = yes
				}
				if = {
					limit = {
						event_target:target_country = {
							fleet_power >= 8000
							fleet_power < 12000
						}
					}
					create_privateer_ships_6 = yes
				}
				if = {
					limit = {
						event_target:target_country = {
							fleet_power >= 12000
							fleet_power < 20000
						}
					}
					create_privateer_ships_7 = yes
				}
				if = {
					limit = {
						event_target:target_country = {
							fleet_power >= 20000
							fleet_power < 30000
						}
					}
					create_privateer_ships_8 = yes
				}
				if = {
					limit = {
						event_target:target_country = {
							fleet_power >= 30000
							fleet_power < 50000
						}
					}
					create_privateer_ships_9 = yes
				}
				if = {
					limit = {
						event_target:target_country = {
							fleet_power >= 50000
							fleet_power < 80000
						}
					}
					create_privateer_ships_10 = yes
				}
				if = {
					limit = {
						event_target:target_country = {
							fleet_power >= 80000
							fleet_power < 100000
						}
					}
					create_privateer_ships_11 = yes
				}
				if = {
					limit = {
						event_target:target_country = {
							fleet_power >= 100000
						}
					}
					create_privateer_ships_12 = yes
				}
				assign_leader = last_created_leader
				set_location = event_target:privateer_home
				set_fleet_stance = aggressive
				set_aggro_range_measure_from = self
				set_aggro_range = 800
				queue_actions = {
					find_closest_planet = {
						trigger = {
							id = privateer.x1.trigger.1
							is_star = yes
						}
						found_planet = {
							orbit_planet = this
							wait = {
								duration = 5
								random = 5
							}
						}
					}
					repeat = {
						find_closest_system = {
							trigger = {
								id = privateer.x1.trigger.2
								NOT = { has_star_flag = hostile_system }
								NOT = { has_star_flag = recent_privateer_visit }
								exists = space_owner
								space_owner = {
									is_playable = yes
								}
								exists = starbase
								starbase = {
									has_starbase_size = starbase_starport
								}
							}
							found_system = {
								move_to = this
							}
						}
						find_closest_planet = {
							trigger = {
								id = privateer.x1.trigger.3
								is_star = yes
							}
							found_planet = {
								orbit_planet = this
								wait = {
									duration = 5
									random = 5
								}
								effect = {
									id = create_pirate_fleet_npc.1
									solar_system = {
										set_timed_star_flag = { flag = recent_privateer_visit days = 1080 }
									}
								}
							}
						}
					}
				}
			}
		}
	}
}

# Operation scope (for Acquire Asset and operation random events)
espionage_acquire_asset_regular = {
	random_list = {
		1 = {
			modifier = {
				factor = @AssetCategoryDownWeight
				has_espionage_category = op_cat_subterfuge
				NOT = { has_espionage_type = operation_acquire_asset }
			}
			modifier = {
				factor = @AssetTypeWeight
				has_espionage_type = operation_acquire_asset
				has_espionage_asset_subterfuge = yes
				NOT = { has_espionage_asset = asset_bureaucrat }
			}
			owner = {
				set_country_flag = asset_bureaucrat
			}
		}
		1 = {
			modifier = {
				factor = @AssetCategoryDownWeight
				has_espionage_category = op_cat_subterfuge
				NOT = { has_espionage_type = operation_acquire_asset }
			}
			modifier = {
				factor = @AssetTypeWeight
				has_espionage_type = operation_acquire_asset
				has_espionage_asset_subterfuge = yes
				NOT = { has_espionage_asset = asset_clerk }
			}
			owner = {
				set_country_flag = asset_clerk
			}
		}
		1 = {
			modifier = {
				factor = @AssetCategoryDownWeight
				has_espionage_category = op_cat_subterfuge
				NOT = { has_espionage_type = operation_acquire_asset }
			}
			modifier = {
				factor = @AssetTypeWeight
				has_espionage_type = operation_acquire_asset
				has_espionage_asset_subterfuge = yes
				NOT = { has_espionage_asset = asset_economist }
			}
			owner = {
				set_country_flag = asset_economist
			}
		}
		1 = {
			modifier = {
				factor = @AssetCategoryDownWeight
				has_espionage_category = op_cat_subterfuge
				NOT = { has_espionage_type = operation_acquire_asset }
			}
			modifier = {
				factor = @AssetTypeWeight
				has_espionage_type = operation_acquire_asset
				has_espionage_asset_subterfuge = yes
				NOT = { has_espionage_asset = asset_scientist }
			}
			owner = {
				set_country_flag = asset_scientist
			}
		}
		1 = {
			modifier = {
				factor = @AssetCategoryDownWeight
				has_espionage_category = op_cat_subterfuge
				NOT = { has_espionage_type = operation_acquire_asset }
			}
			modifier = {
				factor = @AssetTypeWeight
				has_espionage_type = operation_acquire_asset
				has_espionage_asset_subterfuge = yes
				NOT = { has_espionage_asset = asset_junior_officer }
			}
			owner = {
				set_country_flag = asset_junior_officer
			}
		}
		1 = {
			modifier = {
				factor = @AssetCategoryDownWeight
				has_espionage_category = op_cat_sabotage
			}
			modifier = {
				factor = @AssetTypeWeight
				has_espionage_type = operation_acquire_asset
				has_espionage_asset_sabotage = yes
				NOT = { has_espionage_asset = asset_criminal_underling }
			}
			owner = {
				set_country_flag = asset_criminal_underling
			}
		}
		1 = {
			modifier = {
				factor = @AssetCategoryDownWeight
				has_espionage_category = op_cat_sabotage
			}
			modifier = {
				factor = @AssetTypeWeight
				has_espionage_type = operation_acquire_asset
				has_espionage_asset_sabotage = yes
				NOT = { has_espionage_asset = asset_attache }
			}
			owner = {
				set_country_flag = asset_attache
			}
		}
		1 = {
			modifier = {
				factor = @AssetCategoryDownWeight
				has_espionage_category = op_cat_sabotage
			}
			modifier = {
				factor = @AssetTypeWeight
				has_espionage_type = operation_acquire_asset
				has_espionage_asset_sabotage = yes
				NOT = { has_espionage_asset = asset_laborer }
			}
			owner = {
				set_country_flag = asset_laborer
			}
		}
		1 = {
			modifier = {
				factor = @AssetCategoryDownWeight
				has_espionage_category = op_cat_sabotage
			}
			modifier = {
				factor = @AssetTypeWeight
				has_espionage_type = operation_acquire_asset
				has_espionage_asset_sabotage = yes
				NOT = { has_espionage_asset = asset_hacker }
			}
			owner = {
				set_country_flag = asset_hacker
			}
		}
		1 = {
			modifier = {
				factor = @AssetCategoryDownWeight
				has_espionage_category = op_cat_sabotage
			}
			modifier = {
				factor = @AssetTypeWeight
				has_espionage_type = operation_acquire_asset
				has_espionage_asset_sabotage = yes
				NOT = { has_espionage_asset = asset_arms_smuggler }
			}
			owner = {
				set_country_flag = asset_arms_smuggler
			}
		}
		1 = {
			modifier = {
				factor = @AssetCategoryDownWeight
				has_espionage_category = op_cat_manipulation
			}
			modifier = {
				factor = @AssetTypeWeight
				has_espionage_type = operation_acquire_asset
				has_espionage_asset_manipulation = yes
				NOT = { has_espionage_asset = asset_agitator }
			}
			owner = {
				set_country_flag = asset_agitator
			}
		}
		1 = {
			modifier = {
				factor = @AssetCategoryDownWeight
				has_espionage_category = op_cat_manipulation
			}
			modifier = {
				factor = @AssetTypeWeight
				has_espionage_type = operation_acquire_asset
				has_espionage_asset_manipulation = yes
				NOT = { has_espionage_asset = asset_newscaster }
			}
			owner = {
				set_country_flag = asset_newscaster
			}
		}
		1 = {
			modifier = {
				factor = @AssetCategoryDownWeight
				has_espionage_category = op_cat_manipulation
			}
			modifier = {
				factor = @AssetTypeWeight
				has_espionage_type = operation_acquire_asset
				has_espionage_asset_manipulation = yes
				NOT = { has_espionage_asset = asset_pop_icon }
			}
			owner = {
				set_country_flag = asset_pop_icon
			}
		}
		1 = {
			modifier = {
				factor = @AssetCategoryDownWeight
				has_espionage_category = op_cat_manipulation
			}
			modifier = {
				factor = @AssetTypeWeight
				has_espionage_type = operation_acquire_asset
				has_espionage_asset_manipulation = yes
				NOT = { has_espionage_asset = asset_academic }
			}
			owner = {
				set_country_flag = asset_academic
			}
		}
		1 = {
			modifier = {
				factor = @AssetCategoryDownWeight
				has_espionage_category = op_cat_manipulation
			}
			modifier = {
				factor = @AssetTypeWeight
				has_espionage_type = operation_acquire_asset
				has_espionage_asset_manipulation = yes
				NOT = { has_espionage_asset = asset_veteran }
			}
			owner = {
				set_country_flag = asset_veteran
			}
		}
	}
}
# Operation scope (for Acquire Asset and operation random events)
espionage_acquire_asset_hive = {
	random_list = {
		1 = {
			modifier = {
				factor = @AssetCategoryDownWeight
				has_espionage_category = op_cat_subterfuge
				NOT = { has_espionage_type = operation_acquire_asset }
			}
			modifier = {
				factor = @AssetTypeWeight
				has_espionage_type = operation_acquire_asset
				has_espionage_asset_subterfuge = yes
				NOT = { has_espionage_asset = asset_synapse_drone }
			}
			owner = {
				set_country_flag = asset_synapse_drone
			}
		}
		1 = {
			modifier = {
				factor = @AssetCategoryDownWeight
				has_espionage_category = op_cat_subterfuge
				NOT = { has_espionage_type = operation_acquire_asset }
			}
			modifier = {
				factor = @AssetTypeWeight
				has_espionage_type = operation_acquire_asset
				has_espionage_asset_subterfuge = yes
				NOT = { has_espionage_asset = asset_ephapse_relay }
			}
			owner = {
				set_country_flag = asset_ephapse_relay
			}
		}
		1 = {
			modifier = {
				factor = @AssetCategoryDownWeight
				has_espionage_category = op_cat_subterfuge
				NOT = { has_espionage_type = operation_acquire_asset }
			}
			modifier = {
				factor = @AssetTypeWeight
				has_espionage_type = operation_acquire_asset
				has_espionage_asset_subterfuge = yes
				NOT = { has_espionage_asset = asset_labor_drone }
			}
			owner = {
				set_country_flag = asset_labor_drone
			}
		}
		1 = {
			modifier = {
				factor = @AssetCategoryDownWeight
				has_espionage_category = op_cat_subterfuge
				NOT = { has_espionage_type = operation_acquire_asset }
			}
			modifier = {
				factor = @AssetTypeWeight
				has_espionage_type = operation_acquire_asset
				has_espionage_asset_subterfuge = yes
				NOT = { has_espionage_asset = asset_research_drone }
			}
			owner = {
				set_country_flag = asset_research_drone
			}
		}
		1 = {
			modifier = {
				factor = @AssetCategoryDownWeight
				has_espionage_category = op_cat_subterfuge
				NOT = { has_espionage_type = operation_acquire_asset }
			}
			modifier = {
				factor = @AssetTypeWeight
				has_espionage_type = operation_acquire_asset
				has_espionage_asset_subterfuge = yes
				NOT = { has_espionage_asset = asset_warrior_drone }
			}
			owner = {
				set_country_flag = asset_warrior_drone
			}
		}
		1 = {
			modifier = {
				factor = @AssetCategoryDownWeight
				has_espionage_category = op_cat_manipulation
			}
			modifier = {
				factor = @AssetTypeWeight
				has_espionage_type = operation_acquire_asset
				has_espionage_asset_manipulation = yes
				NOT = { has_espionage_asset = asset_behavioral_regulator }
			}
			owner = {
				set_country_flag = asset_behavioral_regulator
			}
		}
		1 = {
			modifier = {
				factor = @AssetCategoryDownWeight
				has_espionage_category = op_cat_manipulation
			}
			modifier = {
				factor = @AssetTypeWeight
				has_espionage_type = operation_acquire_asset
				has_espionage_asset_manipulation = yes
				NOT = { has_espionage_asset = asset_pheromone_emitter }
			}
			owner = {
				set_country_flag = asset_pheromone_emitter
			}
		}
		1 = {
			modifier = {
				factor = @AssetCategoryDownWeight
				has_espionage_category = op_cat_manipulation
			}
			modifier = {
				factor = @AssetTypeWeight
				has_espionage_type = operation_acquire_asset
				has_espionage_asset_manipulation = yes
				NOT = { has_espionage_asset = asset_resource_distribution_node }
			}
			owner = {
				set_country_flag = asset_resource_distribution_node
			}
		}
		1 = {
			modifier = {
				factor = @AssetCategoryDownWeight
				has_espionage_category = op_cat_manipulation
			}
			modifier = {
				factor = @AssetTypeWeight
				has_espionage_type = operation_acquire_asset
				has_espionage_asset_manipulation = yes
				NOT = { has_espionage_asset = asset_cortex_node }
			}
			owner = {
				set_country_flag = asset_cortex_node
			}
		}
		1 = {
			modifier = {
				factor = @AssetCategoryDownWeight
				has_espionage_category = op_cat_manipulation
			}
			modifier = {
				factor = @AssetTypeWeight
				has_espionage_type = operation_acquire_asset
				has_espionage_asset_manipulation = yes
				NOT = { has_espionage_asset = asset_subspace_tendril }
			}
			owner = {
				set_country_flag = asset_subspace_tendril
			}
		}
		# Infestation
		1 = {
			modifier = {
				factor = 0
				target = {
					NOR = {
						is_current_or_former_necrophage_empire = yes
						has_valid_civic = civic_living_hosts
					}
				}
			}
			modifier = {
				factor = 0
				target = {
					NOT = {
						any_owned_species = {
							NOR = {
								has_trait = trait_hive_mind
								has_trait = trait_machine_unit
							}
						}
					}
				}
			}
			modifier = {
				factor = @AssetCategoryDownWeight
				has_espionage_category = op_cat_manipulation
			}
			modifier = {
				factor = @AssetTypeWeight
				has_espionage_type = operation_acquire_asset
				has_espionage_asset_manipulation = yes
				NOT = { has_espionage_asset = asset_agitator }
			}
			owner = {
				set_country_flag = asset_agitator_infestation
			}
		}
		1 = {
			modifier = {
				factor = 0
				target = {
					NOR = {
						is_current_or_former_necrophage_empire = yes
						has_valid_civic = civic_living_hosts
					}
				}
			}
			modifier = {
				factor = 0
				target = {
					NOT = {
						any_owned_species = {
							NOR = {
								has_trait = trait_hive_mind
								has_trait = trait_machine_unit
							}
						}
					}
				}
			}
			modifier = {
				factor = @AssetCategoryDownWeight
				has_espionage_category = op_cat_sabotage
			}
			modifier = {
				factor = @AssetTypeWeight
				has_espionage_type = operation_acquire_asset
				has_espionage_asset_sabotage = yes
				NOT = { has_espionage_asset = asset_criminal_underling }
			}
			owner = {
				set_country_flag = asset_criminal_underling_infestation
			}
		}
		1 = {
			modifier = {
				factor = 0
				target = {
					NOR = {
						is_current_or_former_necrophage_empire = yes
						has_valid_civic = civic_living_hosts
					}
				}
			}
			modifier = {
				factor = 0
				target = {
					NOT = {
						any_owned_species = {
							NOR = {
								has_trait = trait_hive_mind
								has_trait = trait_machine_unit
							}
						}
					}
				}
			}
			modifier = {
				factor = @AssetCategoryDownWeight
				has_espionage_category = op_cat_sabotage
			}
			modifier = {
				factor = @AssetTypeWeight
				has_espionage_type = operation_acquire_asset
				has_espionage_asset_sabotage = yes
				NOT = { has_espionage_asset = asset_hacker }
			}
			owner = {
				set_country_flag = asset_hacker_infestation
			}
		}
		1 = {
			modifier = {
				factor = 0
				target = {
					NOR = {
						is_current_or_former_necrophage_empire = yes
						has_valid_civic = civic_living_hosts
					}
				}
			}
			modifier = {
				factor = 0
				target = {
					NOT = {
						any_owned_species = {
							NOR = {
								has_trait = trait_hive_mind
								has_trait = trait_machine_unit
							}
						}
					}
				}
			}
			modifier = {
				factor = @AssetCategoryDownWeight
				has_espionage_category = op_cat_sabotage
			}
			modifier = {
				factor = @AssetTypeWeight
				has_espionage_type = operation_acquire_asset
				has_espionage_asset_sabotage = yes
				NOT = { has_espionage_asset = asset_arms_smuggler }
			}
			owner = {
				set_country_flag = asset_arms_smuggler_infestation
			}
		}
		# Open Gestalt
		1 = {
			modifier = {
				factor = 0
				target = {
					OR = {
						has_valid_civic = civic_hive_devouring_swarm
						has_valid_civic = civic_closed_collective
						is_current_or_former_necrophage_empire = yes
						has_valid_civic = civic_living_hosts
						is_machine_assimilator = yes
						is_servitor_empire = yes
						has_valid_civic = civic_machine_terminator
						has_valid_civic = civic_closed_network
					}
				}
			}
			modifier = {
				factor = 0
				target = {
					NOT = {
						any_owned_species = {
							NOR = {
								has_trait = trait_hive_mind
								has_trait = trait_machine_unit
							}
							has_citizenship_type = { type = citizenship_limited country = prev }
						}
					}
				}
			}
			modifier = {
				factor = @AssetCategoryDownWeight
				has_espionage_category = op_cat_sabotage
			}
			modifier = {
				factor = @AssetTypeWeight
				has_espionage_type = operation_acquire_asset
				has_espionage_asset_sabotage = yes
				NOT = { has_espionage_asset = asset_laborer }
			}
			owner = {
				set_country_flag = asset_laborer_open
			}
		}
		1 = {
			modifier = {
				factor = 0
				target = {
					OR = {
						has_valid_civic = civic_hive_devouring_swarm
						has_valid_civic = civic_closed_collective
						is_current_or_former_necrophage_empire = yes
						has_valid_civic = civic_living_hosts
						is_machine_assimilator = yes
						is_servitor_empire = yes
						has_valid_civic = civic_machine_terminator
						has_valid_civic = civic_closed_network
					}
				}
			}
			modifier = {
				factor = 0
				target = {
					NOT = {
						any_owned_species = {
							NOR = {
								has_trait = trait_hive_mind
								has_trait = trait_machine_unit
							}
							has_citizenship_type = { type = citizenship_limited country = prev }
						}
					}
				}
			}
			modifier = {
				factor = @AssetCategoryDownWeight
				has_espionage_category = op_cat_manipulation
			}
			modifier = {
				factor = @AssetTypeWeight
				has_espionage_type = operation_acquire_asset
				has_espionage_asset_manipulation = yes
				NOT = { has_espionage_asset = asset_agitator }
			}
			owner = {
				set_country_flag = asset_agitator_open
			}
		}
		1 = {
			modifier = {
				factor = 0
				target = {
					OR = {
						has_valid_civic = civic_hive_devouring_swarm
						has_valid_civic = civic_closed_collective
						is_current_or_former_necrophage_empire = yes
						has_valid_civic = civic_living_hosts
						is_machine_assimilator = yes
						is_servitor_empire = yes
						has_valid_civic = civic_machine_terminator
						has_valid_civic = civic_closed_network
					}
				}
			}
			modifier = {
				factor = 0
				target = {
					NOT = {
						any_owned_species = {
							NOR = {
								has_trait = trait_hive_mind
								has_trait = trait_machine_unit
							}
							has_citizenship_type = { type = citizenship_limited country = prev }
						}
					}
				}
			}
			modifier = {
				factor = @AssetCategoryDownWeight
				has_espionage_category = op_cat_sabotage
			}
			modifier = {
				factor = @AssetTypeWeight
				has_espionage_type = operation_acquire_asset
				has_espionage_asset_sabotage = yes
				NOT = { has_espionage_asset = asset_criminal_underling }
			}
			owner = {
				set_country_flag = asset_criminal_underling_open
			}
		}
		1 = {
			modifier = {
				factor = 0
				target = {
					OR = {
						has_valid_civic = civic_hive_devouring_swarm
						has_valid_civic = civic_closed_collective
						is_current_or_former_necrophage_empire = yes
						has_valid_civic = civic_living_hosts
						is_machine_assimilator = yes
						is_servitor_empire = yes
						has_valid_civic = civic_machine_terminator
						has_valid_civic = civic_closed_network
					}
				}
			}
			modifier = {
				factor = 0
				target = {
					NOT = {
						any_owned_species = {
							NOR = {
								has_trait = trait_hive_mind
								has_trait = trait_machine_unit
							}
							has_citizenship_type = { type = citizenship_limited country = prev }
						}
					}
				}
			}
			modifier = {
				factor = @AssetCategoryDownWeight
				has_espionage_category = op_cat_subterfuge
				NOT = { has_espionage_type = operation_acquire_asset }
			}
			modifier = {
				factor = @AssetTypeWeight
				has_espionage_type = operation_acquire_asset
				has_espionage_asset_subterfuge = yes
				NOT = { has_espionage_asset = asset_bureaucrat }
			}
			owner = {
				set_country_flag = asset_bureaucrat_open
			}
		}
		# Harmonious
		1 = {
			modifier = {
				factor = 0
				NOT = { has_global_flag = expanded_pops_active }
			}
			modifier = {
				factor = 0
				target = {
					NOR = {
						has_valid_civic = civic_harm_hive
						has_valid_civic = civic_harm_machine
					}
				}
			}
			modifier = {
				factor = 0
				target = {
					NOT = {
						any_owned_species = {
							NOR = {
								has_trait = trait_hive_mind
								has_trait = trait_machine_unit
							}
							has_citizenship_type = { type = citizenship_limited country = prev }
						}
					}
				}
			}
			modifier = {
				factor = @AssetCategoryDownWeight
				has_espionage_category = op_cat_manipulation
			}
			modifier = {
				factor = @AssetTypeWeight
				has_espionage_type = operation_acquire_asset
				has_espionage_asset_manipulation = yes
				NOT = { has_espionage_asset = asset_academic }
			}
			owner = {
				set_country_flag = asset_academic_open
			}
		}
		1 = {
			modifier = {
				factor = 0
				NOT = { has_global_flag = expanded_pops_active }
			}
			modifier = {
				factor = 0
				target = {
					NOR = {
						has_valid_civic = civic_harm_hive
						has_valid_civic = civic_harm_machine
					}
				}
			}
			modifier = {
				factor = 0
				target = {
					NOT = {
						any_owned_species = {
							NOR = {
								has_trait = trait_hive_mind
								has_trait = trait_machine_unit
							}
							has_citizenship_type = { type = citizenship_limited country = prev }
						}
					}
				}
			}
			modifier = {
				factor = @AssetCategoryDownWeight
				has_espionage_category = op_cat_manipulation
			}
			modifier = {
				factor = @AssetTypeWeight
				has_espionage_type = operation_acquire_asset
				has_espionage_asset_manipulation = yes
				NOT = { has_espionage_asset = asset_pop_icon }
			}
			owner = {
				set_country_flag = asset_pop_icon_open
			}
		}
	}
}
# Operation scope (for Acquire Asset and operation random events)
espionage_acquire_asset_machine = {
	random_list = {
		1 = {
			modifier = {
				factor = @AssetCategoryDownWeight
				has_espionage_category = op_cat_subterfuge
				NOT = { has_espionage_type = operation_acquire_asset }
			}
			modifier = {
				factor = @AssetTypeWeight
				has_espionage_type = operation_acquire_asset
				has_espionage_asset_subterfuge = yes
				NOT = { has_espionage_asset = asset_coordination_system }
			}
			owner = {
				set_country_flag = asset_coordination_system
			}
		}
		1 = {
			modifier = {
				factor = @AssetCategoryDownWeight
				has_espionage_category = op_cat_subterfuge
				NOT = { has_espionage_type = operation_acquire_asset }
			}
			modifier = {
				factor = @AssetTypeWeight
				has_espionage_type = operation_acquire_asset
				has_espionage_asset_subterfuge = yes
				NOT = { has_espionage_asset = asset_engagement_protocol }
			}
			owner = {
				set_country_flag = asset_engagement_protocol
			}
		}
		1 = {
			modifier = {
				factor = @AssetCategoryDownWeight
				has_espionage_category = op_cat_subterfuge
				NOT = { has_espionage_type = operation_acquire_asset }
			}
			modifier = {
				factor = @AssetTypeWeight
				has_espionage_type = operation_acquire_asset
				has_espionage_asset_subterfuge = yes
				NOT = { has_espionage_asset = asset_logistics_system }
			}
			owner = {
				set_country_flag = asset_logistics_system
			}
		}
		1 = {
			modifier = {
				factor = @AssetCategoryDownWeight
				has_espionage_category = op_cat_subterfuge
				NOT = { has_espionage_type = operation_acquire_asset }
			}
			modifier = {
				factor = @AssetTypeWeight
				has_espionage_type = operation_acquire_asset
				has_espionage_asset_subterfuge = yes
				NOT = { has_espionage_asset = asset_research_database }
			}
			owner = {
				set_country_flag = asset_research_database
			}
		}
		1 = {
			modifier = {
				factor = @AssetCategoryDownWeight
				has_espionage_category = op_cat_subterfuge
				NOT = { has_espionage_type = operation_acquire_asset }
			}
			modifier = {
				factor = @AssetTypeWeight
				has_espionage_type = operation_acquire_asset
				has_espionage_asset_subterfuge = yes
				NOT = { has_espionage_asset = asset_war_algorithm }
			}
			owner = {
				set_country_flag = asset_war_algorithm
			}
		}
		1 = {
			modifier = {
				factor = @AssetCategoryDownWeight
				has_espionage_category = op_cat_sabotage
			}
			modifier = {
				factor = @AssetTypeWeight
				has_espionage_type = operation_acquire_asset
				has_espionage_asset_sabotage = yes
				NOT = { has_espionage_asset = asset_command_relay }
			}
			owner = {
				set_country_flag = asset_command_relay
			}
		}
		1 = {
			modifier = {
				factor = @AssetCategoryDownWeight
				has_espionage_category = op_cat_sabotage
			}
			modifier = {
				factor = @AssetTypeWeight
				has_espionage_type = operation_acquire_asset
				has_espionage_asset_sabotage = yes
				NOT = { has_espionage_asset = asset_dispatch_uplink }
			}
			owner = {
				set_country_flag = asset_dispatch_uplink
			}
		}
		1 = {
			modifier = {
				factor = @AssetCategoryDownWeight
				has_espionage_category = op_cat_sabotage
			}
			modifier = {
				factor = @AssetTypeWeight
				has_espionage_type = operation_acquire_asset
				has_espionage_asset_sabotage = yes
				NOT = { has_espionage_asset = asset_resource_pylon }
			}
			owner = {
				set_country_flag = asset_resource_pylon
			}
		}
		1 = {
			modifier = {
				factor = @AssetCategoryDownWeight
				has_espionage_category = op_cat_sabotage
			}
			modifier = {
				factor = @AssetTypeWeight
				has_espionage_type = operation_acquire_asset
				has_espionage_asset_sabotage = yes
				NOT = { has_espionage_asset = asset_memory_cache }
			}
			owner = {
				set_country_flag = asset_memory_cache
			}
		}
		1 = {
			modifier = {
				factor = @AssetCategoryDownWeight
				has_espionage_category = op_cat_sabotage
			}
			modifier = {
				factor = @AssetTypeWeight
				has_espionage_type = operation_acquire_asset
				has_espionage_asset_sabotage = yes
				NOT = { has_espionage_asset = asset_weapons_platform }
			}
			owner = {
				set_country_flag = asset_weapons_platform
			}
		}
		# Bio-Trophy Assets
		1 = {
			modifier = {
				factor = 0
				target = {
					NOT = { is_servitor_empire = yes }
				}
			}
			modifier = {
				factor = 0
				target = {
					NOT = {
						any_owned_species = {
							NOR = {
								has_trait = trait_hive_mind
								has_trait = trait_machine_unit
							}
						}
					}
				}
			}
			modifier = {
				factor = @AssetCategoryDownWeight
				has_espionage_category = op_cat_manipulation
			}
			modifier = {
				factor = @AssetTypeWeight
				has_espionage_type = operation_acquire_asset
				has_espionage_asset_manipulation = yes
				NOT = { has_espionage_asset = asset_pop_icon }
			}
			modifier = {
				factor = 2
				has_espionage_type = operation_acquire_asset
				NOT = { has_espionage_asset = asset_pop_icon }
			}
			owner = {
				set_country_flag = asset_pop_icon_bio_trophy
			}
		}
		1 = {
			modifier = {
				factor = 0
				target = {
					NOT = { is_servitor_empire = yes }
				}
			}
			modifier = {
				factor = 0
				target = {
					NOT = {
						any_owned_species = {
							NOR = {
								has_trait = trait_hive_mind
								has_trait = trait_machine_unit
							}
						}
					}
				}
			}
			modifier = {
				factor = @AssetCategoryDownWeight
				has_espionage_category = op_cat_manipulation
			}
			modifier = {
				factor = @AssetTypeWeight
				has_espionage_type = operation_acquire_asset
				has_espionage_asset_manipulation = yes
				NOT = { has_espionage_asset = asset_agitator }
			}
			modifier = {
				factor = 0.5
				has_espionage_type = operation_acquire_asset
				OR = {
					has_espionage_asset = asset_agitator
					has_espionage_asset = asset_hacker
				}
			}
			owner = {
				set_country_flag = asset_agitator_bio_trophy
			}
		}
		1 = {
			modifier = {
				factor = 0
				target = {
					NOT = { is_servitor_empire = yes }
				}
			}
			modifier = {
				factor = 0
				target = {
					NOT = {
						any_owned_species = {
							NOR = {
								has_trait = trait_hive_mind
								has_trait = trait_machine_unit
							}
						}
					}
				}
			}
			modifier = {
				factor = @AssetCategoryDownWeight
				has_espionage_category = op_cat_sabotage
			}
			modifier = {
				factor = @AssetTypeWeight
				has_espionage_type = operation_acquire_asset
				has_espionage_asset_sabotage = yes
				NOT = { has_espionage_asset = asset_hacker }
			}
			modifier = {
				factor = 0.5
				has_espionage_type = operation_acquire_asset
				OR = {
					has_espionage_asset = asset_agitator
					has_espionage_asset = asset_hacker
				}
			}
			owner = {
				set_country_flag = asset_hacker_bio_trophy
			}
		}
		# Cyborg Assets
		1 = {
			modifier = {
				factor = 0
				target = {
					NOT = { is_machine_assimilator = yes }
				}
			}
			modifier = {
				factor = 0
				target = {
					NOT = {
						any_owned_species = {
							NOR = {
								has_trait = trait_hive_mind
								has_trait = trait_machine_unit
							}
						}
					}
				}
			}
			modifier = {
				factor = @AssetCategoryDownWeight
				has_espionage_category = op_cat_manipulation
			}
			modifier = {
				factor = @AssetTypeWeight
				has_espionage_type = operation_acquire_asset
				has_espionage_asset_manipulation = yes
				NOT = { has_espionage_asset = asset_agitator }
			}
			owner = {
				set_country_flag = asset_agitator_cyborg
			}
		}
		1 = {
			modifier = {
				factor = 0
				target = {
					NOT = { is_machine_assimilator = yes }
				}
			}
			modifier = {
				factor = 0
				target = {
					NOT = {
						any_owned_species = {
							NOR = {
								has_trait = trait_hive_mind
								has_trait = trait_machine_unit
							}
						}
					}
				}
			}
			modifier = {
				factor = @AssetCategoryDownWeight
				has_espionage_category = op_cat_sabotage
			}
			modifier = {
				factor = @AssetTypeWeight
				has_espionage_type = operation_acquire_asset
				has_espionage_asset_sabotage = yes
				NOT = { has_espionage_asset = asset_criminal_underling }
			}
			owner = {
				set_country_flag = asset_criminal_underling_cyborg
			}
		}
		1 = {
			modifier = {
				factor = 0
				target = {
					NOT = { is_machine_assimilator = yes }
				}
			}
			modifier = {
				factor = 0
				target = {
					NOT = {
						any_owned_species = {
							NOR = {
								has_trait = trait_hive_mind
								has_trait = trait_machine_unit
							}
						}
					}
				}
			}
			modifier = {
				factor = @AssetCategoryDownWeight
				has_espionage_category = op_cat_sabotage
			}
			modifier = {
				factor = @AssetTypeWeight
				has_espionage_type = operation_acquire_asset
				has_espionage_asset_sabotage = yes
				NOT = { has_espionage_asset = asset_hacker }
			}
			owner = {
				set_country_flag = asset_hacker_cyborg
			}
		}
		1 = {
			modifier = {
				factor = 0
				target = {
					NOT = { is_machine_assimilator = yes }
				}
			}
			modifier = {
				factor = 0
				target = {
					NOT = {
						any_owned_species = {
							NOR = {
								has_trait = trait_hive_mind
								has_trait = trait_machine_unit
							}
						}
					}
				}
			}
			modifier = {
				factor = @AssetCategoryDownWeight
				has_espionage_category = op_cat_sabotage
			}
			modifier = {
				factor = @AssetTypeWeight
				has_espionage_type = operation_acquire_asset
				has_espionage_asset_sabotage = yes
				NOT = { has_espionage_asset = asset_arms_smuggler }
			}
			owner = {
				set_country_flag = asset_arms_smuggler_cyborg
			}
		}
		# Open Gestalt
		1 = {
			modifier = {
				factor = 0
				target = {
					OR = {
						has_valid_civic = civic_hive_devouring_swarm
						has_valid_civic = civic_closed_collective
						is_current_or_former_necrophage_empire = yes
						has_valid_civic = civic_living_hosts
						is_machine_assimilator = yes
						is_servitor_empire = yes
						has_valid_civic = civic_machine_terminator
						has_valid_civic = civic_closed_network
					}
				}
			}
			modifier = {
				factor = 0
				target = {
					NOT = {
						any_owned_species = {
							NOR = {
								has_trait = trait_hive_mind
								has_trait = trait_machine_unit
							}
							has_citizenship_type = { type = citizenship_limited country = prev }
						}
					}
				}
			}
			modifier = {
				factor = @AssetCategoryDownWeight
				has_espionage_category = op_cat_sabotage
			}
			modifier = {
				factor = @AssetTypeWeight
				has_espionage_type = operation_acquire_asset
				has_espionage_asset_sabotage = yes
				NOT = { has_espionage_asset = asset_laborer }
			}
			owner = {
				set_country_flag = asset_laborer_open
			}
		}
		1 = {
			modifier = {
				factor = 0
				target = {
					OR = {
						has_valid_civic = civic_hive_devouring_swarm
						has_valid_civic = civic_closed_collective
						is_current_or_former_necrophage_empire = yes
						has_valid_civic = civic_living_hosts
						is_machine_assimilator = yes
						is_servitor_empire = yes
						has_valid_civic = civic_machine_terminator
						has_valid_civic = civic_closed_network
					}
				}
			}
			modifier = {
				factor = 0
				target = {
					NOT = {
						any_owned_species = {
							NOR = {
								has_trait = trait_hive_mind
								has_trait = trait_machine_unit
							}
							has_citizenship_type = { type = citizenship_limited country = prev }
						}
					}
				}
			}
			modifier = {
				factor = @AssetCategoryDownWeight
				has_espionage_category = op_cat_manipulation
			}
			modifier = {
				factor = @AssetTypeWeight
				has_espionage_type = operation_acquire_asset
				has_espionage_asset_manipulation = yes
				NOT = { has_espionage_asset = asset_agitator }
			}
			owner = {
				set_country_flag = asset_agitator_open
			}
		}
		1 = {
			modifier = {
				factor = 0
				target = {
					OR = {
						has_valid_civic = civic_hive_devouring_swarm
						has_valid_civic = civic_closed_collective
						is_current_or_former_necrophage_empire = yes
						has_valid_civic = civic_living_hosts
						is_machine_assimilator = yes
						is_servitor_empire = yes
						has_valid_civic = civic_machine_terminator
						has_valid_civic = civic_closed_network
					}
				}
			}
			modifier = {
				factor = 0
				target = {
					NOT = {
						any_owned_species = {
							NOR = {
								has_trait = trait_hive_mind
								has_trait = trait_machine_unit
							}
							has_citizenship_type = { type = citizenship_limited country = prev }
						}
					}
				}
			}
			modifier = {
				factor = @AssetCategoryDownWeight
				has_espionage_category = op_cat_sabotage
			}
			modifier = {
				factor = @AssetTypeWeight
				has_espionage_type = operation_acquire_asset
				has_espionage_asset_sabotage = yes
				NOT = { has_espionage_asset = asset_criminal_underling }
			}
			owner = {
				set_country_flag = asset_criminal_underling_open
			}
		}
		1 = {
			modifier = {
				factor = 0
				target = {
					OR = {
						has_valid_civic = civic_hive_devouring_swarm
						has_valid_civic = civic_closed_collective
						is_current_or_former_necrophage_empire = yes
						has_valid_civic = civic_living_hosts
						is_machine_assimilator = yes
						is_servitor_empire = yes
						has_valid_civic = civic_machine_terminator
						has_valid_civic = civic_closed_network
					}
				}
			}
			modifier = {
				factor = 0
				target = {
					NOT = {
						any_owned_species = {
							NOR = {
								has_trait = trait_hive_mind
								has_trait = trait_machine_unit
							}
							has_citizenship_type = { type = citizenship_limited country = prev }
						}
					}
				}
			}
			modifier = {
				factor = @AssetCategoryDownWeight
				has_espionage_category = op_cat_subterfuge
				NOT = { has_espionage_type = operation_acquire_asset }
			}
			modifier = {
				factor = @AssetTypeWeight
				has_espionage_type = operation_acquire_asset
				has_espionage_asset_subterfuge = yes
				NOT = { has_espionage_asset = asset_bureaucrat }
			}
			owner = {
				set_country_flag = asset_bureaucrat_open
			}
		}
		# Harmonious
		1 = {
			modifier = {
				factor = 0
				NOT = { has_global_flag = expanded_pops_active }
			}
			modifier = {
				factor = 0
				target = {
					NOR = {
						has_valid_civic = civic_harm_hive
						has_valid_civic = civic_harm_machine
					}
				}
			}
			modifier = {
				factor = 0
				target = {
					NOT = {
						any_owned_species = {
							NOR = {
								has_trait = trait_hive_mind
								has_trait = trait_machine_unit
							}
							has_citizenship_type = { type = citizenship_limited country = prev }
						}
					}
				}
			}
			modifier = {
				factor = @AssetCategoryDownWeight
				has_espionage_category = op_cat_manipulation
			}
			modifier = {
				factor = @AssetTypeWeight
				has_espionage_type = operation_acquire_asset
				has_espionage_asset_manipulation = yes
				NOT = { has_espionage_asset = asset_academic }
			}
			owner = {
				set_country_flag = asset_academic_open
			}
		}
		1 = {
			modifier = {
				factor = 0
				NOT = { has_global_flag = expanded_pops_active }
			}
			modifier = {
				factor = 0
				target = {
					NOR = {
						has_valid_civic = civic_harm_hive
						has_valid_civic = civic_harm_machine
					}
				}
			}
			modifier = {
				factor = 0
				target = {
					NOT = {
						any_owned_species = {
							NOR = {
								has_trait = trait_hive_mind
								has_trait = trait_machine_unit
							}
							has_citizenship_type = { type = citizenship_limited country = prev }
						}
					}
				}
			}
			modifier = {
				factor = @AssetCategoryDownWeight
				has_espionage_category = op_cat_manipulation
			}
			modifier = {
				factor = @AssetTypeWeight
				has_espionage_type = operation_acquire_asset
				has_espionage_asset_manipulation = yes
				NOT = { has_espionage_asset = asset_pop_icon }
			}
			owner = {
				set_country_flag = asset_pop_icon_open
			}
		}
	}
}
# Country scope (for Acquire Asset and operation random events, where the above has been performed)
espionage_acquire_asset_create_asset = {
	switch = {
		trigger = has_country_flag
		asset_bureaucrat = {
			from.spynetwork = { create_espionage_asset = { type = asset_bureaucrat } }
			remove_country_flag = asset_bureaucrat
		}
		asset_clerk = {
			from.spynetwork = { create_espionage_asset = { type = asset_clerk } }
			remove_country_flag = asset_clerk
		}
		asset_economist = {
			from.spynetwork = { create_espionage_asset = { type = asset_economist } }
			remove_country_flag = asset_economist
		}
		asset_scientist = {
			from.spynetwork = { create_espionage_asset = { type = asset_scientist } }
			remove_country_flag = asset_scientist
		}
		asset_junior_officer = {
			from.spynetwork = { create_espionage_asset = { type = asset_junior_officer } }
			remove_country_flag = asset_junior_officer
		}
		asset_criminal_underling = {
			from.spynetwork = { create_espionage_asset = { type = asset_criminal_underling } }
			remove_country_flag = asset_criminal_underling
		}
		asset_attache = {
			from.spynetwork = { create_espionage_asset = { type = asset_attache } }
			remove_country_flag = asset_attache
		}
		asset_laborer = {
			from.spynetwork = { create_espionage_asset = { type = asset_laborer } }
			remove_country_flag = asset_laborer
		}
		asset_hacker = {
			from.spynetwork = { create_espionage_asset = { type = asset_hacker } }
			remove_country_flag = asset_hacker
		}
		asset_arms_smuggler = {
			from.spynetwork = { create_espionage_asset = { type = asset_arms_smuggler } }
			remove_country_flag = asset_arms_smuggler
		}
		asset_agitator = {
			from.spynetwork = { create_espionage_asset = { type = asset_agitator } }
			remove_country_flag = asset_agitator
		}
		asset_newscaster = {
			from.spynetwork = { create_espionage_asset = { type = asset_newscaster } }
			remove_country_flag = asset_newscaster
		}
		asset_pop_icon = {
			from.spynetwork = { create_espionage_asset = { type = asset_pop_icon } }
			remove_country_flag = asset_pop_icon
		}
		asset_academic = {
			from.spynetwork = { create_espionage_asset = { type = asset_academic } }
			remove_country_flag = asset_academic
		}
		asset_veteran = {
			from.spynetwork = { create_espionage_asset = { type = asset_veteran } }
			remove_country_flag = asset_veteran
		}
		asset_synapse_drone = {
			from.spynetwork = { create_espionage_asset = { type = asset_synapse_drone } }
			remove_country_flag = asset_synapse_drone
		}
		asset_ephapse_relay = {
			from.spynetwork = { create_espionage_asset = { type = asset_ephapse_relay } }
			remove_country_flag = asset_ephapse_relay
		}
		asset_labor_drone = {
			from.spynetwork = { create_espionage_asset = { type = asset_labor_drone } }
			remove_country_flag = asset_labor_drone
		}
		asset_research_drone = {
			from.spynetwork = { create_espionage_asset = { type = asset_research_drone } }
			remove_country_flag = asset_research_drone
		}
		asset_warrior_drone = {
			from.spynetwork = { create_espionage_asset = { type = asset_warrior_drone } }
			remove_country_flag = asset_warrior_drone
		}
		asset_behavioral_regulator = {
			from.spynetwork = { create_espionage_asset = { type = asset_behavioral_regulator } }
			remove_country_flag = asset_behavioral_regulator
		}
		asset_pheromone_emitter = {
			from.spynetwork = { create_espionage_asset = { type = asset_pheromone_emitter } }
			remove_country_flag = asset_pheromone_emitter
		}
		asset_resource_distribution_node = {
			from.spynetwork = { create_espionage_asset = { type = asset_resource_distribution_node } }
			remove_country_flag = asset_resource_distribution_node
		}
		asset_cortex_node = {
			from.spynetwork = { create_espionage_asset = { type = asset_cortex_node } }
			remove_country_flag = asset_cortex_node
		}
		asset_subspace_tendril = {
			from.spynetwork = { create_espionage_asset = { type = asset_subspace_tendril } }
			remove_country_flag = asset_subspace_tendril
		}
		asset_coordination_system = {
			from.spynetwork = { create_espionage_asset = { type = asset_coordination_system } }
			remove_country_flag = asset_coordination_system
		}
		asset_engagement_protocol = {
			from.spynetwork = { create_espionage_asset = { type = asset_engagement_protocol } }
			remove_country_flag = asset_engagement_protocol
		}
		asset_logistics_system = {
			from.spynetwork = { create_espionage_asset = { type = asset_logistics_system } }
			remove_country_flag = asset_logistics_system
		}
		asset_research_database = {
			from.spynetwork = { create_espionage_asset = { type = asset_research_database } }
			remove_country_flag = asset_research_database
		}
		asset_war_algorithm = {
			from.spynetwork = { create_espionage_asset = { type = asset_war_algorithm } }
			remove_country_flag = asset_war_algorithm
		}
		asset_command_relay = {
			from.spynetwork = { create_espionage_asset = { type = asset_command_relay } }
			remove_country_flag = asset_command_relay
		}
		asset_dispatch_uplink = {
			from.spynetwork = { create_espionage_asset = { type = asset_dispatch_uplink } }
			remove_country_flag = asset_dispatch_uplink
		}
		asset_resource_pylon = {
			from.spynetwork = { create_espionage_asset = { type = asset_resource_pylon } }
			remove_country_flag = asset_resource_pylon
		}
		asset_memory_cache = {
			from.spynetwork = { create_espionage_asset = { type = asset_memory_cache } }
			remove_country_flag = asset_memory_cache
		}
		asset_weapons_platform = {
			from.spynetwork = { create_espionage_asset = { type = asset_weapons_platform } }
			remove_country_flag = asset_weapons_platform
		}
		# Bio-Trophy
		asset_pop_icon_bio_trophy = {
			from.target = { set_country_flag = non_gestalt_asset }
			from.spynetwork = { create_espionage_asset = { type = asset_pop_icon } }
			remove_country_flag = asset_pop_icon_bio_trophy
			from.target = { remove_country_flag = non_gestalt_asset }
		}
		asset_agitator_bio_trophy = {
			from.target = { set_country_flag = non_gestalt_asset }
			from.spynetwork = { create_espionage_asset = { type = asset_agitator } }
			remove_country_flag = asset_agitator_bio_trophy
			from.target = { remove_country_flag = non_gestalt_asset }
		}
		asset_hacker_bio_trophy = {
			from.target = { set_country_flag = non_gestalt_asset }
			from.spynetwork = { create_espionage_asset = { type = asset_hacker } }
			remove_country_flag = asset_hacker_bio_trophy
			from.target = { remove_country_flag = non_gestalt_asset }
		}
		# Cyborg
		asset_agitator_cyborg = {
			from.target = { set_country_flag = non_gestalt_asset }
			from.spynetwork = { create_espionage_asset = { type = asset_agitator } }
			remove_country_flag = asset_agitator_cyborg
			from.target = { remove_country_flag = non_gestalt_asset }
		}
		asset_criminal_underling_cyborg = {
			from.target = { set_country_flag = non_gestalt_asset }
			from.spynetwork = { create_espionage_asset = { type = asset_criminal_underling } }
			remove_country_flag = asset_criminal_underling_cyborg
			from.target = { remove_country_flag = non_gestalt_asset }
		}
		asset_hacker_cyborg = {
			from.target = { set_country_flag = non_gestalt_asset }
			from.spynetwork = { create_espionage_asset = { type = asset_hacker } }
			remove_country_flag = asset_hacker_cyborg
			from.target = { remove_country_flag = non_gestalt_asset }
		}
		asset_arms_smuggler_cyborg = {
			from.target = { set_country_flag = non_gestalt_asset }
			from.spynetwork = { create_espionage_asset = { type = asset_arms_smuggler } }
			remove_country_flag = asset_arms_smuggler_cyborg
			from.target = { remove_country_flag = non_gestalt_asset }
		}
		# Infestation
		asset_agitator_infestation = {
			from.target = { set_country_flag = non_gestalt_asset }
			from.spynetwork = { create_espionage_asset = { type = asset_agitator } }
			remove_country_flag = asset_agitator_infestation
			from.target = { remove_country_flag = non_gestalt_asset }
		}
		asset_criminal_underling_infestation = {
			from.target = { set_country_flag = non_gestalt_asset }
			from.spynetwork = { create_espionage_asset = { type = asset_criminal_underling } }
			remove_country_flag = asset_criminal_underling_infestation
			from.target = { remove_country_flag = non_gestalt_asset }
		}
		asset_hacker_infestation = {
			from.target = { set_country_flag = non_gestalt_asset }
			from.spynetwork = { create_espionage_asset = { type = asset_hacker } }
			remove_country_flag = asset_hacker_infestation
			from.target = { remove_country_flag = non_gestalt_asset }
		}
		asset_arms_smuggler_infestation = {
			from.target = { set_country_flag = non_gestalt_asset }
			from.spynetwork = { create_espionage_asset = { type = asset_arms_smuggler } }
			remove_country_flag = asset_arms_smuggler_infestation
			from.target = { remove_country_flag = non_gestalt_asset }
		}
		# Open Gestalt
		asset_laborer_open = {
			from.target = { set_country_flag = non_gestalt_asset }
			from.spynetwork = { create_espionage_asset = { type = asset_laborer } }
			remove_country_flag = asset_laborer_open
			from.target = { remove_country_flag = non_gestalt_asset }
		}
		asset_agitator_open = {
			from.target = { set_country_flag = non_gestalt_asset }
			from.spynetwork = { create_espionage_asset = { type = asset_agitator } }
			remove_country_flag = asset_agitator_open
			from.target = { remove_country_flag = non_gestalt_asset }
		}
		asset_criminal_underling_open = {
			from.target = { set_country_flag = non_gestalt_asset }
			from.spynetwork = { create_espionage_asset = { type = asset_criminal_underling } }
			remove_country_flag = asset_criminal_underling_open
			from.target = { remove_country_flag = non_gestalt_asset }
		}
		asset_bureaucrat_open = {
			from.target = { set_country_flag = non_gestalt_asset }
			from.spynetwork = { create_espionage_asset = { type = asset_bureaucrat } }
			remove_country_flag = asset_bureaucrat_open
			from.target = { remove_country_flag = non_gestalt_asset }
		}
		# Harmonious
		asset_academic_open = {
			from.target = { set_country_flag = non_gestalt_asset }
			from.spynetwork = { create_espionage_asset = { type = asset_academic } }
			remove_country_flag = asset_academic_open
			from.target = { remove_country_flag = non_gestalt_asset }
		}
		asset_pop_icon_open = {
			from.target = { set_country_flag = non_gestalt_asset }
			from.spynetwork = { create_espionage_asset = { type = asset_pop_icon } }
			remove_country_flag = asset_pop_icon_open
			from.target = { remove_country_flag = non_gestalt_asset }
		}
	}
}

# Each of the following events is weighted down if the empire has already rolled that particular event recently. Timed flags are set in the event itself, using @RandomOperationEventTimer. The modifier factor used below is explicitly not '0' for repeatable events - to prevent the pool from running out of 'fresh' events entirely.

# Regular empire acting upon a regular empire
# country (operation owner) scope | root = operation; from = target
operation_random_events_regular_regular = {
	random_list = {
		2 = { #Contact Lost
			modifier = {
				factor = 0.1
				has_country_flag = recent_op_contact_lost
			}
			country_event = { id = operation.5000 }
		}
		1 = { #Apprehended by Enforcers
			modifier = {
				factor = 0.1
				has_country_flag = recent_op_apprehended_by_drones
			}
			modifier = {
				factor = 0.5
				has_espionage_type = operation_acquire_asset
			}
			country_event = { id = diplospy.8 }
		}
		1 = { #Spooked
			modifier = {
				factor = 0.1
				has_country_flag = recent_op_operative_spooked
			}
			country_event = { id = operation.5005 }
		}
		1 = { #Snuffed Out
			modifier = {
				factor = 0
				root.target = {
					NOR = {
						has_valid_civic = civic_fanatic_purifiers
						is_current_or_former_necrophage_empire = yes
					}
				}
			}
			modifier = {
				factor = 0.1
				has_country_flag = recent_op_snuffed_out
			}
			country_event = { id = operation.5035 }
		}
		1 = { #Drain on Resources
			modifier = {
				factor = 0.3
				has_country_flag = recent_op_drain_resources
				OR = { #Criminal Assets skew the usual time-out
					root = { has_espionage_asset_criminal = yes }
					root.spynetwork = { has_espionage_asset_criminal = yes }
				}
			}
			modifier = {
				factor = 0.1
				has_country_flag = recent_op_drain_resources
				NOR = {
					root = { has_espionage_asset_criminal = yes }
					root.spynetwork = { has_espionage_asset_criminal = yes }
				}
			}
			country_event = { id = operation.5040 }
		}
		1 = { #Operative Defects
			modifier = {
				factor = 0
				root.target = { is_homicidal = yes }
			}
			modifier = {
				factor = 0.1
				has_country_flag = recent_op_operative_defects
			}
			country_event = { id = operation.5045 }
		}
		1 = { #Confidence Wavers
			modifier = {
				factor = 0.1
				has_country_flag = recent_op_confidence_wavers
			}
			country_event = { id = operation.5055 }
		}
		1 = { #Local Assets Captured
			modifier = {
				factor = 0.1
				has_country_flag = recent_op_lost_local_asset
			}
			modifier = {
				factor = 0.5
				relative_encryption_decryption = { target = root.target value > 1.2 }
			}
			modifier = {
				factor = 0
				root = {
					NOR = {
						has_espionage_type = operation_steal_pops
						has_espionage_type = operation_rescue_pops
						has_espionage_type = operation_arm_privateers
					}
				}
			}
			country_event = { id = diplospy.10 }
		}
		1 = { #GALPOL agent
			modifier = {
				factor = 0.1
				has_country_flag = recent_op_galpol
			}
			modifier = {
				factor = 0.5
				is_galactic_custodian = yes
			}
			modifier = {
				factor = 0
				OR = {
					is_galactic_emperor = yes
					root.target = { is_galactic_community_member = no }
					NOR = {
						is_active_resolution = resolution_custodian_galpol
						is_active_resolution = resolution_emperor_isd
					}
				}
			}
			country_event = { id = diplospy.1 }
		}
		1 = { #Military Investigates
			modifier = {
				factor = 0
				root = { NOT = { has_espionage_category = op_cat_military } }
			}
			modifier = {
				factor = 0.1
				has_country_flag = recent_op_military_investigates
			}
			country_event = { id = diplospy.11 }
		}
		2 = { #Incompatible Technology
			modifier = {
				factor = 0.1
				has_country_flag = recent_op_enigmatic
			}
			modifier = {
				factor = 0.5
				root = { NOT = { has_espionage_category = op_cat_technology } }
			}
			modifier = {
				factor = 0
				root.target = { NOT = { has_ascension_perk = ap_enigmatic_engineering } }
			}
			country_event = { id = diplospy.14 }
		}
	}
}

# Regular empire acting upon a gestalt empire
# country (operation owner) scope | root = operation; from = target
operation_random_events_regular_gestalt = {
	random_list = {
		2 = { #Contact Lost
			modifier = {
				factor = 0.1
				has_country_flag = recent_op_contact_lost
			}
			country_event = { id = operation.5000 }
		}
		1 = { #Apprehended by Hunter-Seeker Drones
			modifier = {
				factor = 0.1
				has_country_flag = recent_op_apprehended_by_drones
			}
			country_event = { id = operation.5010 }
		}
		1 = { #Spooked
			modifier = {
				factor = 0.1
				has_country_flag = recent_op_operative_spooked
			}
			country_event = { id = diplospy.9 }
		}
		1 = { #Snuffed Out
			modifier = {
				factor = 0
				root.target = {
					OR = {
						has_valid_civic = civic_hive_empath
						is_servitor_empire = yes
					}
				}
			}
			modifier = {
				factor = 0.1
				has_country_flag = recent_op_snuffed_out
			}
			country_event = { id = operation.5035 }
		}
		1 = { #Operative Defects
			modifier = {
				factor = 0
				root.target = { is_homicidal = yes }
			}
			modifier = {
				factor = 0.1
				has_country_flag = recent_op_operative_defects
			}
			country_event = { id = operation.5045 }
		}
		1 = { #Confidence Wavers
			modifier = {
				factor = 0.1
				has_country_flag = recent_op_confidence_wavers
			}
			country_event = { id = operation.5055 }
		}
		1 = { #Local Assets Captured
			modifier = {
				factor = 0.1
				has_country_flag = recent_op_lost_local_asset
			}
			modifier = {
				factor = 0.5
				relative_encryption_decryption = { target = root.target value > 1.2 }
			}
			modifier = {
				factor = 0
				root = {
					NOR = {
						has_espionage_type = operation_steal_pops
						has_espionage_type = operation_rescue_pops
						has_espionage_type = operation_arm_privateers
					}
				}
			}
			country_event = { id = diplospy.10 }
		}
		1 = { #GALPOL agent
			modifier = {
				factor = 0.1
				has_country_flag = recent_op_galpol
			}
			modifier = {
				factor = 0.5
				is_galactic_custodian = yes
			}
			modifier = {
				factor = 0
				OR = {
					is_galactic_emperor = yes
					root.target = { is_galactic_community_member = no }
					NOR = {
						is_active_resolution = resolution_custodian_galpol
						is_active_resolution = resolution_emperor_isd
					}
				}
			}
			country_event = { id = diplospy.1 }
		}
		1 = { #Mistaken for Food (regular vs. hive)
			modifier = {
				factor = 0
				root.target = { is_machine_empire = yes }
			}
			modifier = {
				factor = 0.1
				has_country_flag = recent_op_drones_hunted
			}
			country_event = { id = diplospy.7 }
		}
		1 = { #Military Investigates
			modifier = {
				factor = 0
				root = { NOT = { has_espionage_category = op_cat_military } }
			}
			modifier = {
				factor = 0.1
				has_country_flag = recent_op_military_investigates
			}
			country_event = { id = diplospy.11 }
		}
		2 = { #Incompatible Technology
			modifier = {
				factor = 0.1
				has_country_flag = recent_op_enigmatic
			}
			modifier = {
				factor = 0.5
				root = { NOT = { has_espionage_category = op_cat_technology } }
			}
			modifier = {
				factor = 0
				root.target = { NOT = { has_ascension_perk = ap_enigmatic_engineering } }
			}
			country_event = { id = diplospy.14 }
		}
	}
}

# Gestalt empire acting upon a regular empire
# country (operation owner) scope | root = operation; from = target
operation_random_events_gestalt_regular = {
	random_list = {
		1 = { #Apprehended by Enforcers
			modifier = {
				factor = 0
				is_machine_empire = yes
			}
			modifier = {
				factor = 0.1
				has_country_flag = recent_op_apprehended_by_drones
			}
			modifier = {
				factor = 0.5
				has_espionage_type = operation_acquire_asset
			}
			country_event = { id = diplospy.8 }
		}
		1 = { #Spooked
			modifier = {
				factor = 0.1
				has_country_flag = recent_op_operative_spooked
			}
			country_event = { id = diplospy.9 }
		}
		1 = { #Multi-Phasic Force Fields
			modifier = {
				factor = 0.1
				has_country_flag = recent_op_multiphasic_interference
			}
			country_event = { id = operation.5015 }
		}
		1 = { #Operative Defects
			modifier = {
				factor = 0
				root.target = { is_homicidal = yes }
			}
			modifier = {
				factor = 0.1
				has_country_flag = recent_op_operative_defects
			}
			country_event = { id = operation.5045 }
		}
		1 = { #Confidence Wavers
			modifier = {
				factor = 0.1
				has_country_flag = recent_op_confidence_wavers
			}
			country_event = { id = operation.5055 }
		}
		1 = { #Excess Noise (machine vs. synthetic)
			modifier = {
				factor = 0
				OR = {
					is_robot_empire = no
					root.target = { is_robot_empire = no }
				}
			}
			modifier = {
				factor = 0.1 has_country_flag = recent_op_excess_noise
			}
			country_event = { id = operation.5030 }
		}
		1 = { #Local Assets Captured
			modifier = {
				factor = 0.1
				has_country_flag = recent_op_lost_local_asset
			}
			modifier = {
				factor = 0.5
				relative_encryption_decryption = { target = root.target value > 1.2 }
			}
			modifier = {
				factor = 0
				root = {
					NOR = {
						has_espionage_type = operation_steal_pops
						has_espionage_type = operation_rescue_pops
						has_espionage_type = operation_arm_privateers
					}
				}
			}
			country_event = { id = diplospy.10 }
		}
		1 = { #GALPOL agent
			modifier = {
				factor = 0.1
				has_country_flag = recent_op_galpol
			}
			modifier = {
				factor = 0.5
				is_galactic_custodian = yes
			}
			modifier = {
				factor = 0
				OR = {
					is_galactic_emperor = yes
					root.target = { is_galactic_community_member = no }
					NOR = {
						is_active_resolution = resolution_custodian_galpol
						is_active_resolution = resolution_emperor_isd
					}
				}
			}
			country_event = { id = diplospy.1 }
		}
		1 = { #Military Investigates
			modifier = {
				factor = 0
				root = { NOT = { has_espionage_category = op_cat_military } }
			}
			modifier = {
				factor = 0.1
				has_country_flag = recent_op_military_investigates
			}
			country_event = { id = diplospy.11 }
		}
		2 = { #Incompatible Technology
			modifier = {
				factor = 0.1
				has_country_flag = recent_op_enigmatic
			}
			modifier = {
				factor = 0.5
				root = { NOT = { has_espionage_category = op_cat_technology } }
			}
			modifier = {
				factor = 0
				root.target = { NOT = { has_ascension_perk = ap_enigmatic_engineering } }
			}
			country_event = { id = diplospy.14 }
		}
	}
}

# Gestalt empire acting upon a gestalt empire
# country (operation owner) scope | root = operation; from = target
operation_random_events_gestalt_gestalt = {
	random_list = {
		1 = { #Apprehended by Hunter-Seeker Drones (regular/hive vs. gestalt)
			modifier = {
				factor = 0
				is_machine_empire = yes
			}
			modifier = {
				factor = 0.1
				has_country_flag = recent_op_apprehended_by_drones
			}
			country_event = { id = operation.5010 }
		}
		1 = { #Spooked
			modifier = {
				factor = 0.1
				has_country_flag = recent_op_operative_spooked
			}
			country_event = { id = diplospy.9 }
		}
		1 = { #Mistaken for Food (gestalt vs. hive)
			modifier = {
				factor = 0
				root.target = { is_machine_empire = yes }
			}
			modifier = {
				factor = 0.1
				has_country_flag = recent_op_drones_hunted
			}
			country_event = { id = operation.5020 }
		}
		1 = { #Toxic Field Work (hive vs. hive)
			modifier = {
				factor = 0
				OR = {
					is_machine_empire = yes
					root.target = { is_machine_empire = yes }
				}
			}
			modifier = {
				factor = 0.1
				has_country_flag = recent_op_toxic_field
			}
			country_event = { id = operation.5025 }
		}
		1 = { #Excess Noise (machine vs. machine)
			modifier = {
				factor = 0
				OR = {
					is_hive_empire = yes
					root.target = { is_hive_empire = yes }
				}
			}
			modifier = {
				factor = 0.1 has_country_flag = recent_op_excess_noise
			}
			country_event = { id = operation.5030 }
		}
		1 = { #Snuffed Out
			modifier = {
				factor = 0.1
				has_country_flag = recent_op_snuffed_out
			}
			country_event = { id = operation.5035 }
		}
		1 = { #Operative Defects
			modifier = {
				factor = 0
				root.target = { is_homicidal = yes }
			}
			modifier = {
				factor = 0.1
				has_country_flag = recent_op_operative_defects
			}
			country_event = { id = operation.5045 }
		}
		1 = { #Confidence Wavers
			modifier = {
				factor = 0.1
				has_country_flag = recent_op_confidence_wavers
			}
			country_event = { id = operation.5055 }
		}
		1 = { #Local Assets Captured
			modifier = {
				factor = 0.1
				has_country_flag = recent_op_lost_local_asset
			}
			modifier = {
				factor = 0.5
				relative_encryption_decryption = { target = root.target value > 1.2 }
			}
			modifier = {
				factor = 0
				root = {
					NOR = {
						has_espionage_type = operation_steal_pops
						has_espionage_type = operation_rescue_pops
						has_espionage_type = operation_arm_privateers
					}
				}
			}
			country_event = { id = diplospy.10 }
		}
		1 = { #GALPOL agent
			modifier = {
				factor = 0.1
				has_country_flag = recent_op_galpol
			}
			modifier = {
				factor = 0.5
				is_galactic_custodian = yes
			}
			modifier = {
				factor = 0
				OR = {
					is_galactic_emperor = yes
					root.target = { is_galactic_community_member = no }
					NOR = {
						is_active_resolution = resolution_custodian_galpol
						is_active_resolution = resolution_emperor_isd
					}
				}
			}
			country_event = { id = diplospy.1 }
		}
		1 = { #Military Investigates
			modifier = {
				factor = 0
				root = { NOT = { has_espionage_category = op_cat_military } }
			}
			modifier = {
				factor = 0.1
				has_country_flag = recent_op_military_investigates
			}
			country_event = { id = diplospy.11 }
		}
		2 = { #Incompatible Technology
			modifier = {
				factor = 0.1
				has_country_flag = recent_op_enigmatic
			}
			modifier = {
				factor = 0.5
				root = { NOT = { has_espionage_category = op_cat_technology } }
			}
			modifier = {
				factor = 0
				root.target = { NOT = { has_ascension_perk = ap_enigmatic_engineering } }
			}
			country_event = { id = diplospy.14 }
		}
	}
}

# OPERATIONS UNDER DEEP COVER
# operation scope | from = target
operation_random_events_deepcover = {
	random_list = {
		1 = { #Snuffed Out
			modifier = {
				factor = 0.1
				owner = { has_country_flag = recent_op_snuffed_out }
			}
			owner = { country_event = { id = operation.5035 } }
		}
		1 = { #Operative Defects
			modifier = {
				factor = 0
				root.target = { is_homicidal = yes }
			}
			modifier = {
				factor = 0.1
				owner = { has_country_flag = recent_op_operative_defects }
			}
			owner = { country_event = { id = operation.5045 } }
		}
		1 = { #Spooked
			modifier = {
				factor = 0.1
				has_country_flag = recent_op_operative_spooked
			}
			owner = { country_event = { id = diplospy.9 } }
		}
		1 = { #Confidence Wavers
			modifier = {
				factor = 0.1
				owner = { has_country_flag = recent_op_confidence_wavers }
			}
			owner = { country_event = { id = operation.5055 } }
		}
		1 = { #Local Assets Captured
			modifier = {
				factor = 0.1
				owner = { has_country_flag = recent_op_lost_local_asset }
			}
			modifier = {
				factor = 0.5
				owner = {
					relative_encryption_decryption = { target = prev.target value > 1.2 }
				}
			}
			modifier = {
				factor = 0
				NOR = {
					has_espionage_type = operation_steal_pops
					has_espionage_type = operation_rescue_pops
					has_espionage_type = operation_arm_privateers
				}
			}
			owner = { country_event = { id = diplospy.10 } }
		}
		1 = { #GALPOL agent
			modifier = {
				factor = 0.1
				owner = { has_country_flag = recent_op_galpol }
			}
			modifier = {
				factor = 0.5
				owner = { is_galactic_custodian = yes }
			}
			modifier = {
				factor = 0
				owner = { 
					OR = {
						is_galactic_emperor = yes
						prev.target = { is_galactic_community_member = no }
						NOR = {
							is_active_resolution = resolution_custodian_galpol
							is_active_resolution = resolution_emperor_isd
						}
					}
				}
			}
			owner = { country_event = { id = diplospy.1 } }
		}
		1 = { #Military Investigates
			modifier = {
				factor = 0
				NOT = { has_espionage_category = op_cat_military }
			}
			modifier = {
				factor = 0.1
				owner = { has_country_flag = recent_op_military_investigates }
			}
			owner = { country_event = { id = diplospy.11 } }
		}
		1 = { #Incompatible Technology
			modifier = {
				factor = 0.1
				has_country_flag = recent_op_enigmatic
			}
			modifier = {
				factor = 0.5
				root = { NOT = { has_espionage_category = op_cat_technology } }
			}
			modifier = {
				factor = 0
				root.target = { NOT = { has_ascension_perk = ap_enigmatic_engineering } }
			}
			owner = { country_event = { id = diplospy.14 } }
		}
	}
}

# SABOTAGE (TARGETED) OPERATIONS
# operation scope | from = target; from.owner = target country
operation_random_events_sabotage_targeted = {
	random_list = {
		1 = { #Grisly Countermeasures
			modifier = {
				factor = 0.1
				owner = { has_country_flag = recent_op_grisly_countermeasures }
			}
			modifier = {
				factor = 0
				NOR = {
					has_espionage_type = operation_sabotage_starbase
				}
			}
			owner = { country_event = { id = operation.5050 } }
		}
		1 = { #Confidence Wavers
			modifier = {
				factor = 0.1
				owner = { has_country_flag = recent_op_confidence_wavers }
			}
			owner = { country_event = { id = operation.5055 } }
		}
		1 = { #Surprise Inspections
			modifier = {
				factor = 0.1
				owner = { has_country_flag = recent_op_galpol }
			}
			modifier = {
				factor = 0
				NOR = {
					has_espionage_type = operation_sabotage_starbase
				}
			}
			owner = { country_event = { id = diplospy.4 } }
		}
		1 = { #Incompatible Technology
			modifier = {
				factor = 0.1
				has_country_flag = recent_op_enigmatic
			}
			modifier = {
				factor = 0.5
				root = { NOT = { has_espionage_category = op_cat_technology } }
			}
			modifier = {
				factor = 0
				root.target.owner = { NOT = { has_ascension_perk = ap_enigmatic_engineering } }
			}
			owner = { country_event = { id = diplospy.15 } }
		}
	}
}

### PRIMITIVES ###
# This is called before the pre-ftl species is created due to interactions between various origins and the pop creation effect.
select_pre_ftl_origin = {
	# Void Dwellers
	if = {
		limit = {
			is_habitat = yes
		}
		set_planet_flag = pre_ftl_void_dwellers
	}
	else_if = {
		limit = {
			is_planet_class = pc_ringworld_habitable
		}
		# Do nothing!
	}
	else_if = {
		limit = { is_planet_class = pc_shattered_ring_habitable }
		set_planet_flag = pre_ftl_shattered_ring
	}
	else_if = {
		limit = { is_planet_class = pc_gaia }
		set_planet_flag = pre_ftl_life_seeded
		create_life_seeded_planet = yes
	}
	else_if = {
		limit = { is_planet_class = pc_nuked }
		set_planet_flag = pre_ftl_post_apocalyptic
		every_deposit = {
			limit = { is_blocker = yes }
			clear_blocker = yes
		}
		add_deposit = d_tomb_world_ruins
		add_deposit = d_tomb_world_wasteland
	}
	else = {
		random_list = {
			# Default pre-ftl origin
			# All other origins require First Contact.
			100 = { set_planet_flag = pre_ftl_default }

			# Mechanists (requires Utopia)
			5 = {
				modifier = {
					factor = 0
					OR = {
						has_first_contact_dlc = no
						has_utopia = no
						has_planet_flag = pre_ftl_hive_mind
						any_galaxy_planet = {
							has_planet_flag = pre_ftl_mechanists
						}
					}
				}
				set_planet_flag = pre_ftl_mechanists
			}

			# Life-Seeded (requires Apocalypse)
			5 = {
				modifier = {
					factor = 0
					has_apocalypse = no
				}
				modifier = {
					factor = 0
					OR = {
						has_first_contact_dlc = no
						any_galaxy_planet = {
							has_planet_flag = pre_ftl_life_seeded
						}
						any_country = {
							has_origin = origin_life_seeded
						}
					}
				}
				set_planet_flag = pre_ftl_life_seeded
				if = {
					limit = { has_planet_flag = pre_ftl_hive_mind }
					change_pc = pc_hive
				}
				else = {
					change_pc = pc_gaia
				}
				create_life_seeded_planet = yes
			}

			# Post Apocalyptic (requires Apocalypse)
			5 = {
				modifier = {
					factor = 0
					has_apocalypse = no
				}
				modifier = {
					factor = 0
					OR = {
						has_first_contact_dlc = no
						has_planet_flag = pre_ftl_hive_mind
						any_galaxy_planet = {
							has_planet_flag = pre_ftl_post_apocalyptic
						}
						any_country = {
							has_origin = origin_post_apocalyptic
						}
					}
				}
				set_planet_flag = pre_ftl_post_apocalyptic
				change_pc = pc_nuked
				every_deposit = {
					limit = { is_blocker = yes }
					clear_blocker = yes
				}
				add_deposit = d_tomb_world_ruins
				add_deposit = d_tomb_world_wasteland
			}

			# Ocean Paradise (Requires Aquatics)
			5 = {
				modifier = {
					factor = 0
					OR = {
						has_aquatics = no
						has_first_contact_dlc = no
					}
				}
				modifier = {
					factor = 0
					OR = {
						any_galaxy_planet = {
							has_planet_flag = pre_ftl_ocean_paradise
						}
						any_country = {
							is_ocean_paradise_empire = yes
						}
					}
				}
				set_planet_flag = pre_ftl_ocean_paradise
				change_pc = pc_ocean
				set_planet_size = 30
				create_ocean_paradise_planet = yes
			}

			# Subterranean (requires Overlord)
			5 = {
				modifier = {
					factor = 0
					OR = {
						has_overlord_dlc = no
						has_first_contact_dlc = no
					}

				}
				modifier = {
					factor = 0
					any_galaxy_planet = {
						has_planet_flag = pre_ftl_subterranean
					}
				}
				set_planet_flag = pre_ftl_subterranean
			}

			# Calamitous Birth (requires Lithoid)
			5 = {
				modifier = {
					factor = 0
					OR = {
						has_lithoids = no
						has_first_contact_dlc = no
					}

				}
				modifier = {
					factor = 0
					any_galaxy_planet = {
						has_planet_flag = pre_ftl_lithoid
					}
				}
				while = {
					count = 4
					add_deposit = d_buried_lithoids
				}
				if = {
					limit = { NOT = { has_deposit = d_lithoid_crater } }
					add_deposit = d_lithoid_crater
				}
				if = {
					limit = { NOT = { has_modifier = lithoid_crater } }
					add_modifier = { modifier = lithoid_crater }
				}
				set_planet_flag = pre_ftl_lithoid
			}

			# Progenitor Hive (requires Overlord)
			5 = {
				modifier = {
					factor = 0
					OR = {
						has_overlord_dlc = no
						has_first_contact_dlc = no
						NOT = {
							has_planet_flag = pre_ftl_hive_mind
						}
					}
				}
				modifier = {
					factor = 0
					OR = {
						any_galaxy_planet = {
							has_planet_flag = pre_ftl_progenitor_hive
						}
						any_country = {
							has_origin = origin_progenitor_hive
						}
					}
				}
				set_planet_flag = pre_ftl_progenitor_hive
				add_deposit = d_progenitor
			}

			# Tree of Life (requires Utopia)
			5 = {
				modifier = {
					factor = 0
					OR = {
						has_utopia = no
						has_first_contact_dlc = no
						NOT = {
							has_planet_flag = pre_ftl_hive_mind
						}
					}
				}
				modifier = {
					factor = 0
					OR = {
						any_galaxy_planet = {
							has_planet_flag = pre_ftl_tree_of_life
						}
						any_country = {
							has_origin = origin_tree_of_life
						}
					}
				}
				set_planet_flag = pre_ftl_tree_of_life
				add_deposit = d_tree_of_life_home
			}
		}
	}
}

# This is called as part of create_FOO_BAR_pre_ftl_empire to set the correct origin on the pre-ftl country.
# These origins are so that the correct origin is shown when the pre-ftl civilization achieves FTL tech.
# Some origins are also checked during their technological progression.
set_pre_ftl_origin = {
	switch = {
		trigger = has_planet_flag
		pre_ftl_default = {
			owner = {
				set_origin = origin_default_pre_ftl
			}
		}
		pre_ftl_mechanists = {
			owner = {
				shift_ethic = "ethic_fanatic_materialist"
				set_origin = origin_mechanists
			}
		}
		pre_ftl_life_seeded = {
			owner = {
				set_origin = origin_life_seeded
			}
		}
		pre_ftl_post_apocalyptic = {
			owner = {
				set_origin = origin_post_apocalyptic
			}
		}
		pre_ftl_ocean_paradise = {
			owner = {
				set_origin = origin_ocean_paradise
			}
		}
		pre_ftl_subterranean = {
			owner = {
				set_origin = origin_subterranean
			}
		}
		pre_ftl_lithoid = {
			owner = {
				set_origin = origin_lithoid
			}
		}
		pre_ftl_progenitor_hive = {
			owner = {
				set_origin = origin_progenitor_hive
			}
		}
		pre_ftl_tree_of_life = {
			owner = {
				set_origin = origin_tree_of_life
			}
		}
		pre_ftl_void_dwellers = {
			owner = {
				set_origin = origin_void_dwellers
			}
		}
		pre_ftl_shattered_ring = {
			owner = {
				set_origin = origin_shattered_ring
			}
		}
	}
}

create_pre_ftl_species = {
	if = {
		limit = {
			has_planet_flag = pre_ftl_ocean_paradise
		}
		create_species = {
			name = random
			class = random_pre_ftl
			portrait = random
			homeworld = THIS
			traits = {
				trait = trait_aquatic
				trait = random_traits
			}
		}
	}
	else_if = {
		limit = {
			has_planet_flag = pre_ftl_subterranean
		}
		create_species = {
			name = random
			class = random_pre_ftl
			portrait = random
			homeworld = THIS
			traits = {
				trait = trait_cave_dweller
				trait = random_traits
			}
		}
	}
	else_if = {
		limit = {
			has_planet_flag = pre_ftl_void_dwellers
		}
		create_species = {
			name = random
			class = random_pre_ftl
			portrait = random
			homeworld = THIS
			traits = {
				trait = trait_void_dweller_1
				trait = random_traits
			}
		}
	}
	else_if = {
		limit = {
			has_planet_flag = pre_ftl_lithoid
		}
		create_species = {
			name = random
			class = LITHOID
			portrait = random
			homeworld = THIS
			traits = {
				trait = trait_lithoid
				trait = random_traits
			}
		}
	}
	else_if = {
		limit = {
			has_planet_flag = pre_ftl_post_apocalyptic
		}
		random_list = {
			1 = {
				create_species = {
					name = random
					class = random_pre_ftl
					portrait = random
					homeworld = THIS
					traits = {
						trait = trait_survivor
						trait = trait_pc_desert_preference
						trait = random_traits
					}
				}
			}
			1 = {
				create_species = {
					name = random
					class = random_pre_ftl
					portrait = random
					homeworld = THIS
					traits = {
						trait = trait_survivor
						trait = trait_pc_arid_preference
						trait = random_traits
					}
				}
			}
			1 = {
				create_species = {
					name = random
					class = random_pre_ftl
					portrait = random
					homeworld = THIS
					traits = {
						trait = trait_survivor
						trait = trait_pc_savannah_preference
						trait = random_traits
					}
				}
			}
			1 = {
				create_species = {
					name = random
					class = random_pre_ftl
					portrait = random
					homeworld = THIS
					traits = {
						trait = trait_survivor
						trait = trait_pc_tropical_preference
						trait = random_traits
					}
				}
			}
			1 = {
				create_species = {
					name = random
					class = random_pre_ftl
					portrait = random
					homeworld = THIS
					traits = {
						trait = trait_survivor
						trait = trait_pc_continental_preference
						trait = random_traits
					}
				}
			}
			1 = {
				create_species = {
					name = random
					class = random_pre_ftl
					portrait = random
					homeworld = THIS
					traits = {
						trait = trait_survivor
						trait = trait_pc_ocean_preference
						trait = random_traits
					}
				}
			}
			1 = {
				create_species = {
					name = random
					class = random_pre_ftl
					portrait = random
					homeworld = THIS
					traits = {
						trait = trait_survivor
						trait = trait_pc_arctic_preference
						trait = random_traits
					}
				}
			}
			1 = {
				create_species = {
					name = random
					class = random_pre_ftl
					portrait = random
					homeworld = THIS
					traits = {
						trait = trait_survivor
						trait = trait_pc_tundra_preference
						trait = random_traits
					}
				}
			}
			1 = {
				create_species = {
					name = random
					class = random_pre_ftl
					portrait = random
					homeworld = THIS
					traits = {
						trait = trait_survivor
						trait = trait_pc_alpine_preference
						trait = random_traits
					}
				}
			}
		}
	}
	else = {
		random_list = {
			99 = {
				create_species = {
					name = random
					class = random_pre_ftl
					portrait = random
					homeworld = THIS
					traits = {
						trait = random_traits
					}
				}
			}
			1 = {
				create_species = {
					name = random
					class = random_pre_ftl
					portrait = random
					homeworld = THIS
					traits = {
						trait = random_traits
						trait = "trait_presapient_forcefully_devolved"
					}
				}
				modifier = {
					factor = 0
					has_global_flag = forcefully_devolved_pre_ftl_rolled
				}
			}
		}
		set_global_flag = forcefully_devolved_pre_ftl_rolled
	}
	if = {
		limit = {
			last_created_species = {
				is_lithoid = yes
			}
			NOT = { has_planet_flag = pre_ftl_lithoid }
		}
		while = {
			count = 4
			add_deposit = d_hibernating_lithoids
		}
	}
}

create_pre_ftl_hive_species = {
	if = {
		limit = {
			has_planet_flag = pre_ftl_ocean_paradise
		}
		create_species = {
			name = random
			class = random_pre_ftl
			portrait = random
			homeworld = THIS
			traits = {
				trait = trait_hive_mind
				trait = trait_aquatic
				trait = random_traits
			}
		}
	}
	else_if = {
		limit = {
			has_planet_flag = pre_ftl_subterranean
		}
		create_species = {
			name = random
			class = random_pre_ftl
			portrait = random
			homeworld = THIS
			traits = {
				trait = trait_hive_mind
				trait = trait_cave_dweller
				trait = random_traits
			}
		}
	}
	else_if = {
		limit = {
			has_planet_flag = pre_ftl_lithoid
		}
		create_species = {
			name = random
			class = LITHOID
			portrait = random
			homeworld = THIS
			traits = {
				trait = trait_hive_mind
				trait = trait_lithoid
				trait = random_traits
			}
		}
	}
	else_if = {
		limit = {
			has_planet_flag = pre_ftl_post_apocalyptic
		}
		random_list = {
			1 = {
				create_species = {
					name = random
					class = random_pre_ftl
					portrait = random
					homeworld = THIS
					traits = {
						trait = trait_hive_mind
						trait = trait_survivor
						trait = trait_pc_desert_preference
						trait = random_traits
					}
				}
			}
			1 = {
				create_species = {
					name = random
					class = random_pre_ftl
					portrait = random
					homeworld = THIS
					traits = {
						trait = trait_hive_mind
						trait = trait_survivor
						trait = trait_pc_arid_preference
						trait = random_traits
					}
				}
			}
			1 = {
				create_species = {
					name = random
					class = random_pre_ftl
					portrait = random
					homeworld = THIS
					traits = {
						trait = trait_hive_mind
						trait = trait_survivor
						trait = trait_pc_savannah_preference
						trait = random_traits
					}
				}
			}
			1 = {
				create_species = {
					name = random
					class = random_pre_ftl
					portrait = random
					homeworld = THIS
					traits = {
						trait = trait_hive_mind
						trait = trait_survivor
						trait = trait_pc_tropical_preference
						trait = random_traits
					}
				}
			}
			1 = {
				create_species = {
					name = random
					class = random_pre_ftl
					portrait = random
					homeworld = THIS
					traits = {
						trait = trait_hive_mind
						trait = trait_survivor
						trait = trait_pc_continental_preference
						trait = random_traits
					}
				}
			}
			1 = {
				create_species = {
					name = random
					class = random_pre_ftl
					portrait = random
					homeworld = THIS
					traits = {
						trait = trait_hive_mind
						trait = trait_survivor
						trait = trait_pc_ocean_preference
						trait = random_traits
					}
				}
			}
			1 = {
				create_species = {
					name = random
					class = random_pre_ftl
					portrait = random
					homeworld = THIS
					traits = {
						trait = trait_hive_mind
						trait = trait_survivor
						trait = trait_pc_arctic_preference
						trait = random_traits
					}
				}
			}
			1 = {
				create_species = {
					name = random
					class = random_pre_ftl
					portrait = random
					homeworld = THIS
					traits = {
						trait = trait_hive_mind
						trait = trait_survivor
						trait = trait_pc_tundra_preference
						trait = random_traits
					}
				}
			}
			1 = {
				create_species = {
					name = random
					class = random_pre_ftl
					portrait = random
					homeworld = THIS
					traits = {
						trait = trait_hive_mind
						trait = trait_survivor
						trait = trait_pc_alpine_preference
						trait = random_traits
					}
				}
			}
		}
	}
	else = {
		create_species = {
			name = random
			class = random_pre_ftl
			portrait = random
			homeworld = THIS
			traits = {
				trait = trait_hive_mind
				trait = random_traits
			}
		}
	}
	if = {
		limit = {
			last_created_species = {
				is_lithoid = yes
			}
			NOT = { has_planet_flag = pre_ftl_lithoid }
		}
		while = {
			count = 4
			add_deposit = d_hibernating_lithoids
		}
	}
}

achieve_ftl_effect = {
	country_event = { id = game_start.8 }
	remove_country_flag = early_space_age
	set_country_flag = primitives_can_into_space
	set_country_type = default
	change_country_flag = random
	set_species_graphical_culture = yes
	if = {
		limit = {
			is_gestalt = no
			has_country_flag = human_primitive
		}
		change_government = {
			authority = auth_democratic
			civics = random
		}
	}
	else = {
		change_government = {
			authority = random
			civics = random
		}
	}
	# Governments Done
	#primitives_death_cult
	#primitives_imperial_cult
	#primitives_fanatic_purifier
	#primitives_slave_revolt
	#primitives_military_unification
	#primitives_agrarian_idyll
	#primitives_corporate_dominion
	#primitives_exalted_priesthood
	#primitives_idealistic_foundation
	#primitives_warrior_culture
	#primitives_feudal_elite
	#primitives_technocracy
	#primitives_shared_burden
	#primitives_slavers_guild
	#primitives_overtuned
	#primitives_catalytic
	#primitives_bloom
	#primitives_biological_engineering
	if = {
		limit = { has_country_flag = primitives_robot_progress }
		give_technology = { tech = tech_powered_exoskeletons }
	}
	if = {
		limit = {
			has_country_flag = primitives_mechanist
			is_gestalt = no
		}
		give_technology = { tech = tech_robotic_workers }
		set_policy = {
			policy = robot_pop_policy
			option = robot_pops_allowed
			cooldown = yes
		}
	}
	if = {
		limit = {
			has_country_flag = primitives_overtuned
			is_gestalt = no
		}
		give_technology = { tech = tech_gene_tailoring }
	}
	if = {
		limit = { is_gestalt = no }
		switch = {
			trigger = has_country_flag
			primitives_fanatic_purifier = {
				if = {
					limit = {
						has_ethic = ethic_fanatic_xenophobe
						OR = {
							has_ethic = ethic_militarist
							has_ethic = ethic_spiritualist
						}
					}
					if = {
						limit = {
							is_megacorp = yes
						}
						change_government = {
							authority = auth_oligarchic
						}
					}
					change_government = {
						civics = {
							civic = civic_fanatic_purifiers
							civic = random
						}
					}
					add_resource = { minerals = 3000 }
					add_resource = { energy = 3000 }
					add_resource = { alloys = 3000 }
					create_fleet = {
						set_take_point = yes
						effect = {
							set_owner = prev
							
							while = {
								count = 9
								create_ship = {
									name = random
									random_existing_design = corvette
								}
							}
							
							set_location = prev.capital_star
						}
					}
				}
			}
			primitives_slave_revolt = {
				if = {
					limit = {
						OR = {
							has_ethic = ethic_xenophile
							has_ethic = ethic_fanatic_xenophile
						}
					}
					change_government = {
						authority = auth_democratic
						civics = {
							civic = civic_beacon_of_liberty
							civic = civic_free_haven
						}
					}
				}
				else_if = {
					limit = {
						OR = {
							has_ethic = ethic_xenophobe
							has_ethic = ethic_fanatic_xenophobe
						}
					}
					change_government = {
						authority = auth_democratic
						civics = {
							civic = civic_idealistic_foundation
							civic = random
						}
					}
				}
				else = {
					change_government = {
						authority = auth_democratic
						civics = {
							civic = civic_beacon_of_liberty
							civic = random
						}
					}
				}
			}
			primitives_military_unification = {
				change_government = {
					authority = auth_dictatorial
					civics = {
						civic = civic_police_state
						civic = random
					}
				}
				if = {
					limit = {
						is_militarist = yes
						has_global_flag = expanded_pops_active
					}
					set_origin = origin_militarist
				}
			}
			primitives_death_cult = {
				if = {
					limit = {
						OR = {
							has_ethic = ethic_spiritualist
							has_ethic = ethic_fanatic_spiritualist
						}
						NOT = { has_ethic = ethic_fanatic_egalitarian }
						OR = {
							NOT = { has_global_flag = expanded_pops_active }
							NOT = { has_authority = auth_cooperative }
						}
					}
					if = {
						limit = {
							is_megacorp = yes
						}
						change_government = {
							civics = {
								civic = civic_death_cult_corporate
								civic = random
							}
						}
					}
					change_government = {
						civics = {
							civic = civic_death_cult
							civic = random
						}
					}
				}
			}
			primitives_imperial_cult = {
				if = {
					limit = {
						OR = {
							has_ethic = ethic_authoritarian
							has_ethic = ethic_fanatic_authoritarian
						}
						OR = {
							has_ethic = ethic_spiritualist
							has_ethic = ethic_fanatic_spiritualist
						}
					}
					random_list = {
						55 = {
							change_government = {
								authority = auth_imperial
								civics = {
									civic = civic_imperial_cult
									civic = random
								}
							}
						}
						25 = {
							change_government = {
								authority = auth_imperial
								civics = {
									civic = civic_imperial_cult
									civic = civic_aristocratic_elite
								}
							}
						}
						20 = {
							change_government = {
								authority = auth_imperial
								civics = {
									civic = civic_imperial_cult
									civic = civic_feudal_realm
								}
							}
						}
					}
				}
			}
			primitives_agrarian_idyll = {
				if = {
					limit = {
						OR = {
							has_ethic = ethic_pacifist
							has_ethic = ethic_fanatic_pacifist
						}
					}
					if = {
						limit = { capital_scope = { is_ocean_world = yes } }
						if = {
							limit = {
								is_megacorp = yes
								has_global_flag = expanded_pops_active
							}
							change_government = {
								civics = {
									civic = civic_agribusiness
									civic = civic_corporate_anglers
								}
							}
						}
						else_if = {
							limit = {
								is_megacorp = yes
								NOT = { has_global_flag = expanded_pops_active }
							}
							change_government = {
								authority = auth_oligarchic
								civics = {
									civic = civic_agrarian_idyll
									civic = civic_anglers
								}
							}
						}
						else = {
							change_government = {
								civics = {
									civic = civic_agrarian_idyll
									civic = civic_anglers
								}
							}
						}
					}
					else = {
						if = {
							limit = {
								is_megacorp = yes
								has_global_flag = expanded_pops_active
							}
							change_government = {
								civics = {
									civic = civic_agribusiness
									civic = random
								}
							}
						}
						else_if = {
							limit = {
								is_megacorp = yes
								NOT = { has_global_flag = expanded_pops_active }
							}
							change_government = {
								authority = auth_oligarchic
								civics = {
									civic = civic_agrarian_idyll
									civic = random
								}
							}
						}
						else = {
							change_government = {
								civics = {
									civic = civic_agrarian_idyll
									civic = random
								}
							}
						}
					}
				}
			}
			primitives_corporate_dominion = {
				if = {
					limit = {
						has_megacorp = yes
						OR = {
							has_ethic = ethic_fanatic_authoritarian
							has_ethic = ethic_fanatic_egalitarian
							has_ethic = ethic_fanatic_xenophobe
						}
					}
					if = {
						limit = {
							has_global_flag = expanded_pops_active
							has_ethic = ethic_fanatic_egalitarian
						}
						change_government = {
							authority = auth_cooperative
							civics = {
								civic = random
								civic = random
							}
						}
					}
					else_if = {
						limit = {
							has_global_flag = expanded_pops_active
							has_ethic = ethic_fanatic_authoritarian
						}
						change_government = {
							authority = auth_private
							civics = {
								civic = random
								civic = random
							}
						}
					}
					else = {
						change_government = {
							civics = {
								civic = civic_merchant_guilds
								civic = random
							}
						}
					}
				}
				else_if = {
					limit = { has_megacorp = no }
					change_government = {
						authority = auth_oligarchic
						civics = {
							civic = civic_corporate_dominion
							civic = random
						}
					}
				}
				else_if = {
					limit = {
						has_megacorp = yes
						has_global_flag = expanded_pops_active
						has_ethic = ethic_egalitarian
					}
					change_government = {
						authority = auth_cooperative
						civics = {
							civic = random
							civic = random
						}
					}
				}
				else_if = {
					limit = {
						has_megacorp = yes
						has_global_flag = expanded_pops_active
						has_ethic = ethic_authoritarian
					}
					change_government = {
						authority = auth_private
						civics = {
							civic = random
							civic = random
						}
					}
				}
				else_if = {
					limit = { has_megacorp = yes }
					change_government = {
						authority = auth_corporate
						civics = {
							civic = random
							civic = random
						}
					}
				}
			}
			primitives_exalted_priesthood = {
				if = {
					limit = {
						OR = {
							has_ethic = ethic_spiritualist
							has_ethic = ethic_fanatic_spiritualist
						}
						NOT = {	has_ethic = ethic_fanatic_egalitarian }
					}
					if = {
						limit = { is_megacorp = yes }
						change_government = {
							authority = auth_corporate
							civics = {
								civic = civic_gospel_of_the_masses
								civic = random
							}
						}
					}
					else = {
						random_list = {
							80 = {
								modifier = {
									factor = 0
									has_ethic = ethic_fanatic_authoritarian
								}
								change_government = {
									authority = auth_oligarchic
									civics = {
										civic = civic_exalted_priesthood
										civic = random
									}
								}
							}
							80 = {
								modifier = {
									factor = 0
									has_ethic = ethic_egalitarian
								}
								change_government = {
									authority = auth_dictatorial
									civics = {
										civic = civic_exalted_priesthood
										civic = random
									}
								}
							}
						}
					}
				}
			}
			primitives_idealistic_foundation = {
				if = {
					limit = {
						is_egalitarian = yes
					}
					change_government = {
						authority = auth_democratic
						civics = {
							civic = civic_idealistic_foundation
							civic = random
						}
					}
				}
				else_if = {
					limit = { is_authoritarian = no }
					change_government = {
						authority = auth_democratic
					}
				}
			}
			primitives_warrior_culture = {
				if = {
					limit = {
						OR = {
							has_ethic = ethic_militarist
							has_ethic = ethic_fanatic_militarist
						}
					}
					if = {
						limit = {
							is_megacorp = yes
						}
						change_government = {
							civics = {
								civic = civic_private_military_companies
								civic = random
							}
						}
					}
					else = {
						change_government = {
							civics = {
								civic = civic_warrior_culture
								civic = random
							}
						}
					}
				}
			}
			primitives_feudal_elite = {
				if = {
					limit = {
						NOR = {
							has_ethic = ethic_egalitarian
							has_ethic = ethic_fanatic_egalitarian
						}
					}
					change_government = {
						authority = auth_imperial
						civics = {
							civic = civic_aristocratic_elite
							civic = civic_feudal_realm
						}
					}
				}
			}
			primitives_technocracy = {
				if = {
					limit = {
						has_ethic = ethic_fanatic_materialist
					}
					if = {
						limit = {
							is_megacorp = yes
							has_global_flag = expanded_pops_active
						}
						change_government = {
							civics = {
								civic = civic_technocracy_corp
								civic = random
							}
						}
					}
					else_if = {
						limit = {
							is_megacorp = yes
							NOT = { has_global_flag = expanded_pops_active }
						}
						change_government = {
							authority = auth_oligarchic
							civics = {
								civic = civic_technocracy
								civic = random
							}
						}
					}
					else = {
						change_government = {
							civics = {
								civic = civic_technocracy
								civic = random
							}
						}
					}
				}
			}
			primitives_shared_burden = {
				if = {
					limit = {
						has_ethic = ethic_fanatic_egalitarian
						is_xenophobe = no
					}
					if = {
						limit = { has_authority = auth_democratic }
						change_government = {
							civics = {
								civic = civic_shared_burden
								civic = random
							}
						}
					}
					else_if = {
						limit = {
							has_global_flag = expanded_pops_active
							has_authority = auth_cooperative
						}
						change_government = {
							civics = {
								civic = civic_worker_coop
								civic = random
							}
						}
					}
				}
			}
			primitives_slavers_guild = {
				if = {
					limit = {
						is_authoritarian = yes
					}
					if = {
						limit = {
							is_megacorp = yes
						}
						change_government = {
							civics = {
								civic = civic_indentured_assets
								civic = random
							}
						}
					}
					else = {
						change_government = {
							civics = {
								civic = civic_slaver_guilds
								civic = random
							}
						}
					}
				}
			}
			primitives_catalytic = {
				if = {
					limit = {
						is_megacorp = yes
					}
					change_government = {
						civics = {
							civic = civic_corporate_catalytic_processing
							civic = random
						}
					}
				}
				else = {
					change_government = {
						civics = {
							civic = civic_catalytic_processing
							civic = random
						}
					}
				}
			}
			primitives_bloom = {
				if = {
					limit = {
						is_megacorp = yes
					}
					if = {
						limit = { is_egalitarian = yes }
						change_government = {
							authority = auth_democratic
							civics = {
								civic = civic_idyllic_bloom
								civic = civic_merchant_guilds
							}
						}
					}
					else_if = {
						limit = { is_authoritarian = yes }
						change_government = {
							authority = auth_dictatorial
							civics = {
								civic = civic_idyllic_bloom
								civic = civic_merchant_guilds
							}
						}
					}
					else = {
						change_government = {
							authority = auth_oligarchic
							civics = {
								civic = civic_idyllic_bloom
								civic = civic_merchant_guilds
							}
						}
					}
				}
				else = {
					change_government = {
						civics = {
							civic = civic_idyllic_bloom
							civic = random
						}
					}
				}
			}
			primitives_biological_engineering = {
				if = {
					limit = {
						is_megacorp = yes
						change_government = {
							civics = {
								civic = civic_private_healthcare_corporate
								civic = random
							}
						}
					}
				}
				else = {
					change_government = {
						civics = {
							civic = civic_biological_engineering
							civic = random
						}
					}
				}
			}
		}
	}
	set_name = random

	if = {
		limit = {
			has_country_flag = was_enlightened
			has_origin = origin_default_pre_ftl
		}
		set_origin = origin_enlightened
	}

	if = {
		limit = {
			has_origin = origin_default_pre_ftl
		}
		set_origin = origin_default
		if = {
			limit = {
				is_gestalt = no
			}
			capital_scope = {
				add_modifier = { modifier = prosp_uni_mod days = 7200 }
			}
		}
		else = {
			capital_scope = {
				add_modifier = { modifier = prosp_uni_mod_gestalt days = 7200 }
			}
		}
		capital_scope = {
			while = {
				count = 4
				create_pop = {
					species = owner
				}
			}
		}
	}

	add_resource = {
		energy = 500
		minerals = 500
		alloys = 125
		influence = 50
		unity = 250
		volatile_motes = 50
		exotic_gases = 50
		rare_crystals = 50
		mult = trigger:years_passed
	}
	if = {
		limit = {
			is_hive_empire = no
		}
		add_resource = {
			consumer_goods = 250
			mult = trigger:years_passed
		}
	}
	if = {
		limit = {
			is_lithoid_empire = no
		}
		add_resource = {
			food = 500
			mult = trigger:years_passed
		}
	}
	else = {
		add_resource = {
			minerals = 500
			mult = trigger:years_passed
		}
	}

	create_fleet = {
		effect = {
			set_owner = prev

			create_ship = {
				name = random
				random_existing_design = science
			}

			set_fleet_stance = evasive
			set_location = prev.capital_scope.star

			owner = {
				create_leader = {
					class = scientist
					sub_type = survey
					name = random
					species = owner_main_species
				}
			}
			set_leader = last_created_leader
		}
	}

	create_fleet = {
		effect = {
			set_owner = prev

			create_ship = {
				name = random
				random_existing_design = constructor
			}

			set_fleet_stance = evasive
			set_location = prev.capital_star
		}
	}

	while = {
		count = 3
		create_leader = {
			class = scientist
			name = random
			species = owner_main_species
		}
	}

	create_leader = {
		class = governor
		name = random
		species = owner_main_species
	}

	capital_scope = {
		clear_blockers = yes
		remove_all_buildings = yes
		if = {
			limit = {
				NOT = {
					is_habitat = yes
				}
			}
			generate_start_buildings_and_districts = yes
		}
		else_if = {
			limit = {
				is_habitat = yes
			}
			owner = {
				give_technology = {
					tech = tech_habitat_1
					message = no
				}
				add_research_option = tech_habitat_2
				if = {
					limit = {
						OR = {
							is_lithoid_empire = no
							is_catalytic_empire = yes
						}
					}
					give_technology = {
						tech = tech_eco_simulation
						message = no
					}
					give_technology = {
						tech = tech_hydroponics
						message = no
					}
				}
				else = {
					give_technology = {
						tech = tech_powered_exoskeletons
						message = no
					}
					give_technology = {
						tech = tech_space_mining_1
						message = no
					}
				}
			}
			add_building = building_hab_major_capital
			# 2 jobs
			if = {
				limit = {
					owner = {
						is_lithoid_empire = no
					}
				}
				add_building = building_hydroponics_farm
			}
			# 2 jobs
			add_district = district_hab_science
			# 3 jobs
			add_district = district_hab_commercial
			# 2 jobs
			if = {
				limit = { owner = { is_spiritualist = no } }
				add_building = building_bureaucratic_1
			}
			# 2 jobs
			if = {
				limit = {
					owner = {
						is_spiritualist = yes
						OR = {
							has_valid_civic = civic_death_cult
							has_valid_civic = civic_death_cult_corporate
						}
					}
				}
				add_building = building_sacrificial_temple_1
			}
			# 2 jobs
			if = {
				limit = {
					owner = {
						is_spiritualist = yes
						NOT = { has_valid_civic = civic_death_cult }
					}
				}
				add_building = building_temple
			}
		}

		while = {
			limit = {
				num_pops < 8
				#free_housing > 0
			}
			create_pop = {
				species = owner
			}
		}
		if = {
			limit = {
				is_planet_class = pc_desert
			}
			set_planet_flag = tasty_desert
		}
		remove_all_armies = yes
		solar_system = {
			save_event_target_as = enlightened_system
			if = {
				limit = {
					exists = owner
				}
				owner = {
					save_event_target_as = previous_system_owner
				}
			}
			if = {
				limit = {
					NOT = { exists = starbase }
				}
				create_starbase = {
					size = starbase_starport
					module = shipyard
					module = shipyard
					owner = root
				}
			}
		}
	}
	random_controlled_ship = {
		limit = { is_ship_size = primitive_space_station }
		fleet = { destroy_fleet = THIS }
	}
	# countries with intel on this system get a notification and establish communications
	every_country = {
		limit = {
			is_country_type_with_subjects = yes
			NOR = {
				AND = {
					exists = event_target:previous_system_owner
					is_same_value = event_target:previous_system_owner
				}
				is_same_value = $OWNER$
			}
			intel_level = {
				level > medium
				system = event_target:enlightened_system
			}
		}
		country_event = { id = preftl.1111 days = 1 scopes = { from = $PRE_FTL$ } }
	}
	if = {
		limit  = {
			exists = event_target:previous_system_owner
		}
		establish_communications_no_message = event_target:previous_system_owner
	}
}

# (Instigating) country scope
pre_ftl_indoctrinate_operation_result = {
	if = { # if your empire is fanatic, always shift the pre-FTLs to your main ethic
		limit = {
			is_fanatic = yes
		}
		switch = {
			trigger = has_ethic
			ethic_fanatic_spiritualist = {
				shift_pre_ftl_pop_ethic = { ETHIC = spiritualist BONUS = $BONUS$ }
			}
			ethic_fanatic_militarist = {
				shift_pre_ftl_pop_ethic = { ETHIC = militarist BONUS = $BONUS$ }
			}
			ethic_fanatic_xenophobe = {
				shift_pre_ftl_pop_ethic = { ETHIC = xenophobe BONUS = $BONUS$ }
			}
			ethic_fanatic_egalitarian = {
				shift_pre_ftl_pop_ethic = { ETHIC = egalitarian BONUS = $BONUS$ }
			}
			ethic_fanatic_materialist = {
				shift_pre_ftl_pop_ethic = { ETHIC = materialist BONUS = $BONUS$ }
			}
			ethic_fanatic_pacifist = {
				shift_pre_ftl_pop_ethic = { ETHIC = pacifist BONUS = $BONUS$ }
			}
			ethic_fanatic_xenophile = {
				shift_pre_ftl_pop_ethic = { ETHIC = xenophile BONUS = $BONUS$ }
			}
			ethic_fanatic_authoritarian = {
				shift_pre_ftl_pop_ethic = { ETHIC = authoritarian BONUS = $BONUS$ }
			}
		}
	}
	else = { # if not fanatic, shift to one of your ethics
		random_list = {
			1 = {
				shift_pre_ftl_pop_ethic = { ETHIC = spiritualist BONUS = $BONUS$ }
				modifier = {
					mult = 0
					can_encourage_spiritualist = no
				}
				modifier = {
					mult = 0.5
					is_spiritualist = no
				}
			}
			1 = {
				shift_pre_ftl_pop_ethic = { ETHIC = militarist BONUS = $BONUS$ }
				modifier = {
					mult = 0
					can_encourage_militarist = no
				}
			}
			1 = {
				shift_pre_ftl_pop_ethic = { ETHIC = xenophobe BONUS = $BONUS$ }
				modifier = {
					mult = 0
					can_encourage_xenophobe = no
				}
			}
			1 = {
				shift_pre_ftl_pop_ethic = { ETHIC = egalitarian BONUS = $BONUS$ }
				modifier = {
					mult = 0
					can_encourage_egalitarian = no
				}
				modifier = {
					mult = 0.5
					is_egalitarian = no
					NOT = { is_servitor_empire = yes }
				}
			}
			1 = {
				shift_pre_ftl_pop_ethic = { ETHIC = materialist BONUS = $BONUS$ }
				modifier = {
					mult = 0
					can_encourage_materialist = no
				}
				modifier = {
					mult = 0.5
					is_materialist = no
					is_machine_empire = no
				}
			}
			1 = {
				shift_pre_ftl_pop_ethic = { ETHIC = pacifist BONUS = $BONUS$ }
				modifier = {
					mult = 0
					can_encourage_pacifist = no
				}
				modifier = {
					mult = 0.5
					is_pacifist = no
					is_open_gestalt = no
				}
			}
			1 = {
				shift_pre_ftl_pop_ethic = { ETHIC = xenophile BONUS = $BONUS$ }
				modifier = {
					mult = 0
					can_encourage_xenophile = no
				}
				modifier = {
					mult = 0.5
					is_xenophile = no
					NOT = { is_servitor_empire = yes }
				}
			}
			1 = {
				shift_pre_ftl_pop_ethic = { ETHIC = authoritarian BONUS = $BONUS$ }
				modifier = {
					mult = 0
					can_encourage_authoritarian = no
				}
				modifier = {
					mult = 0.5
					is_authoritarian = no
					OR = {
						is_hive_empire = no
						is_open_gestalt = no
					}
				}
			}
		}
	}
}

asteroid_impact_pre_ftl_effect = {
	add_deposit = d_impact_crater
	while = {
		count = 8
		if = {
			limit = { num_pops > 2 }
			random_owned_pop = {
				kill_pop = yes
			}
		}
	}
	owner = {
		switch = {
			trigger = has_pre_ftl_age
			stone_age = { }
			bronze_age = {
				set_pre_ftl_age_effect = {
					PRE_FTL_AGE = stone_age
				}
			}
			iron_age = {
				set_pre_ftl_age_effect = {
					PRE_FTL_AGE = stone_age
				}
			}
			late_medieval_age = {
				set_pre_ftl_age_effect = {
					PRE_FTL_AGE = stone_age
				}
			}
			renaissance_age = {
				set_pre_ftl_age_effect = {
					PRE_FTL_AGE = stone_age
				}
			}
			steam_age = {
				set_pre_ftl_age_effect = {
					PRE_FTL_AGE = bronze_age
				}
			}
			industrial_age = {
				set_pre_ftl_age_effect = {
					PRE_FTL_AGE = iron_age
				}
			}
			machine_age = {
				set_pre_ftl_age_effect = {
					PRE_FTL_AGE = late_medieval_age
				}
			}
			atomic_age = {
				set_pre_ftl_age_effect = {
					PRE_FTL_AGE = renaissance_age
				}
			}
			early_space_age = {
				set_pre_ftl_age_effect = {
					PRE_FTL_AGE = renaissance_age
				}
			}
		}
	}
}