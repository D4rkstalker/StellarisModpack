@resolution_weight_hated = 3
@resolution_weight_disliked = 4
@resolution_weight_unpopular = 5
@resolution_weight_normal = 6
@resolution_weight_popular = 6.5
@resolution_weight_loved = 7
@resolution_weight_fever = 10

@resolution_cost_t1 = 100
@resolution_cost_t2 = 150
@resolution_cost_t3 = 200
@resolution_cost_t4 = 250
@resolution_cost_t5 = 300
@resolution_cost_denounce = 25

@resolution_cost_t1_half = 50
@resolution_cost_t2_half = 75
@resolution_cost_t3_half = 100
@resolution_cost_t4_half = 125
@resolution_cost_t5_half = 150
@resolution_cost_denounce_half = 12.5

@resolution_flag_timer = 360

################################### resolution_category_custodian_reforms
resolution_custodian_united_front = {
	icon = "GFX_resolution_united_front"

	resources = {
		category = resolutions
		cost = {
			influence = @resolution_cost_t3
		}
	}
	target = no

	modifier = {
		description = resolution_custodian_united_front_modifier_desc
		damage_vs_country_type_swarm_mult = 0.2
		damage_vs_country_type_extradimensional_mult = 0.2
		damage_vs_country_type_extradimensional_2_mult = 0.2
		damage_vs_country_type_extradimensional_3_mult = 0.2
		damage_vs_country_type_ai_empire_mult = 0.2
		damage_vs_country_type_gray_goo_mult = 0.2
		damage_vs_player_crisis_mult = 0.2
		country_energy_produces_mult = -0.03
	}

	effect = {
	}

	fail_effects = {
	}

	allow = {
		custom_tooltip = {
			fail_text = "resolution_already_active"
			NOT = { is_active_resolution = resolution_custodian_united_front }
		}
	}

	potential = {
		has_nemesis = yes
		is_galactic_custodian = yes
		any_country = { is_crisis_faction = yes }
	}

	ai_weight = {
		base = @resolution_weight_disliked

		modifier = {
			factor = 12
			any_neighbor_country = { is_crisis_faction = yes }
			desc = gal_com_neighboring_crisis_empire
		}
		modifier = {
			factor = 1.6
			is_militarist = yes
			desc = ethic_militarist
		}
		modifier = {
			factor = 4
			has_crisis_stage_1 = yes
			desc = gal_com_crisis_stage_1
		}
		modifier = {
			factor = 6
			has_crisis_stage_2 = yes
			desc = gal_com_crisis_stage_2
		}
		modifier = {
			factor = 8
			has_crisis_stage_3 = yes
			desc = gal_com_crisis_stage_3
		}
		modifier = {
			factor = 20
			has_crisis_stage_4 = yes
			desc = gal_com_crisis_stage_4
		}
		modifier = {
			factor = 20
			any_playable_country = { has_country_flag = crisis_sphere_revealed }
			desc = gal_com_crisis_sphere_revealed
		}
		modifier = {
			factor = 8
			any_playable_country = { has_been_declared_crisis = yes }
			desc = gal_com_someone_declared_crisis
		}
		modifier = {
			factor = 8
			has_global_flag = gray_goo_crisis_active
			desc = gal_com_someone_is_revealed_crisis
		}
		modifier = {
			factor = 8
			has_global_flag = marauder_crisis_ongoing
			desc = gal_com_someone_is_revealed_crisis
		}
		modifier = {
			factor = 0.5
			has_ai_personality = xenophobic_isolationists
			NOT = {
				any_neighbor_country = { is_crisis_faction = yes }
			}
			desc = personality_xenophobic_isolationists
		}
		modifier = {
			factor = 0
			has_ascension_perk = ap_become_the_crisis
			desc = gal_com_we_have_crisis_perk
		}
		modifier = {
			factor = 4
			is_galactic_custodian = yes
			desc = gal_com_is_the_custodian
		}
		modifier = {
			factor = 20
			is_militarist = yes
			is_galactic_custodian = yes
			desc = gal_com_militarist_custodian
		}
		modifier = {
			factor = 0
			is_subject = yes
			overlord = {
				OR = {
					is_country_type = fallen_empire
					is_country_type = awakened_fallen_empire
				}
			}
			desc = gal_com_subject_of_fallen_empire
		}
		modifier = {
			factor = 10
			any_country = { is_country_type = awakened_fallen_empire }
			desc = gal_com_exists_awakened_fallen_empire
		}
		modifier = {
			factor = 20
			has_global_flag = war_in_heaven_ongoing
			desc = gal_com_ongoing_war_in_heaven
		}
	}
}
resolution_custodian_galactic_mobilization = {
	icon = "GFX_resolution_galactic_mobilization"

	resources = {
		category = resolutions
		cost = {
			influence = @resolution_cost_t3
		}
	}
	target = no

	triggered_modifier = {
		potential = {
			NOT = { has_ethic = ethic_gestalt_consciousness }
		}
		modifier = {
			resolution_custodian_galactic_mobilization = 1
		}
	}
	triggered_modifier = {
		potential = {
			has_ethic = ethic_gestalt_consciousness
		}
		modifier = {
			resolution_custodian_galactic_mobilization_gestalt = 1
		}
	}

	allow = {
		custom_tooltip = {
			fail_text = "resolution_already_active"
			NOT = { is_active_resolution = resolution_custodian_galactic_mobilization }
		}
		custom_tooltip = {
			fail_text = "galaxy_must_be_in_danger"
			galaxy_is_peace = no
		}
	}

	effect = {
		hidden_effect = { set_global_flag = galactic_mobilization_activated }
	}

	potential = {
		has_nemesis = yes
		is_galactic_custodian = yes
		NOT = { has_global_flag = galactic_republic_formed }	# Expanded Diplomacy and Espionage mod 
	}

	active = {
		has_galactic_custodian = yes
		galaxy_is_peace = no
		NOT = { has_global_flag = galactic_republic_formed }	# Expanded Diplomacy and Espionage mod 
		#NOT = { is_active_resolution = resolution_emperor_galactic_mobilization }
	}

	ai_weight = {
		base = @resolution_weight_hated

		modifier = {
			factor = 1.6
			is_militarist = yes
			desc = ethic_militarist
		}
		modifier = {
			factor = 0.6
			is_pacifist = yes
			NOT = {
				any_neighbor_country = { is_crisis_faction = yes }
			}
			desc = ethic_pacifist
		}
		modifier = {
			factor = 12
			any_neighbor_country = { is_crisis_faction = yes }
			desc = gal_com_neighboring_crisis_empire
		}
		modifier = {
			factor = 4
			has_crisis_stage_1 = yes
			desc = gal_com_crisis_stage_1
		}
		modifier = {
			factor = 6
			has_crisis_stage_2 = yes
			desc = gal_com_crisis_stage_2
		}
		modifier = {
			factor = 8
			has_crisis_stage_3 = yes
			desc = gal_com_crisis_stage_3
		}
		modifier = {
			factor = 20
			has_crisis_stage_4 = yes
			desc = gal_com_crisis_stage_4
		}
		modifier = {
			factor = 20
			any_playable_country = { has_country_flag = crisis_sphere_revealed }
			desc = gal_com_crisis_sphere_revealed
		}
		modifier = {
			factor = 8
			any_playable_country = { has_been_declared_crisis = yes }
			desc = gal_com_someone_declared_crisis
		}
		modifier = {
			factor = 8
			has_global_flag = gray_goo_crisis_active
			desc = gal_com_someone_is_revealed_crisis
		}
		modifier = {
			factor = 8
			has_global_flag = marauder_crisis_ongoing
			desc = gal_com_someone_is_revealed_crisis
		}
		modifier = {
			factor = 0
			 has_ascension_perk = ap_become_the_crisis
			 desc = gal_com_we_have_crisis_perk
		}
		modifier = {
			factor = 4
			is_galactic_custodian = yes
			desc = gal_com_is_the_custodian
		}
		modifier = {
			factor = 20
			is_militarist = yes
			is_galactic_custodian = yes
			desc = gal_com_militarist_custodian
		}
		modifier = {
			factor = 0
			is_subject = yes
			overlord = {
				OR = {
					is_country_type = fallen_empire
					is_country_type = awakened_fallen_empire
				}
			}
			desc = gal_com_subject_of_fallen_empire
		}
		modifier = {
			factor = 10
			any_country = { is_country_type = awakened_fallen_empire }
			desc = gal_com_exists_awakened_fallen_empire
		}
		modifier = {
			factor = 20
			has_global_flag = war_in_heaven_ongoing
			desc = gal_com_ongoing_war_in_heaven
		}
	}
}

################################### resolution_category_galactic_institutions
resolution_custodian_ina = {
	icon = "GFX_resolution_form_ina"

	resources = {
		category = resolutions
		cost = {
			influence = @resolution_cost_t3
		}
	}
	target = no

	modifier = {
		resolution_custodian_ina = 1
	}

	allow = {
		custom_tooltip = {
			fail_text = "resolution_already_active"
			NOT = { is_active_resolution = resolution_custodian_ina }
		}
	}

	potential = {
		has_nemesis = yes
		is_galactic_custodian = yes
	}

	active = {
		has_galactic_emperor = no
	}

	ai_weight = {
		base = @resolution_weight_normal

		modifier = {
			factor = 0.8
			is_xenophobe = yes
			desc = ethic_xenophobe
		}
		modifier = {
			factor = 0.5
			has_ai_personality = xenophobic_isolationists
			desc = personality_xenophobic_isolationists
		}
		modifier = {
			factor = 1.2
			has_ai_personality = peaceful_traders
			desc = personality_peaceful_traders
		}
		modifier = {
			factor = 1.2
			is_xenophile = yes
			desc = ethic_xenophile
		}
		modifier = {
			factor = 2
			has_ai_personality = erudite_explorers
			desc = personality_erudite_explorers
		}
		modifier = {
			factor = 4
			is_galactic_custodian = yes
			desc = gal_com_is_the_custodian
		}
	}
}

################################### resolution_category_imperial_council
# 以下在建立统一帝国后禁用
resolution_emperor_abolish_council = {
	icon = "GFX_resolution_abolish_imperial_council"

	resources = {
		category = resolutions
		cost = {
			influence = @resolution_cost_t5
		}
	}
	target = no

	modifier = {
	}

	effect = {
		custom_tooltip = resolution_emperor_abolish_council_tooltip
		hidden_effect = {
			set_council_size = 0
			set_timed_country_flag = { flag = galactic_community_resolution_passed_general days = @resolution_flag_timer }
			add_modifier = {
				modifier = resolution_passed_diplomatic_weight
				days = 2200
			}
		}
	}

	fail_effects = {
		hidden_effect = {
			set_timed_country_flag = { flag = galactic_community_resolution_failed_general days = @resolution_flag_timer }
			add_modifier = {
				modifier = resolution_failed_diplomatic_weight
				days = 2200
			}
		}
	}

	potential = {
		has_nemesis = yes
		is_galactic_emperor = yes
		is_galactic_council_established = yes
		NOT = { has_global_flag = imperial_unification_start }
	}

	active = {
		has_galactic_emperor = yes
	}

	ai_weight = {
		base = @resolution_weight_hated

		modifier = {
			factor = 0
			is_part_of_galactic_council = yes
			is_galactic_emperor = no
			desc = gal_com_on_galatic_council
		}
		modifier = {
			factor = 0.5
			is_subject = yes
			overlord = {
				opinion_level = { who = prev level >= neutral }
				is_part_of_galactic_council = yes
				is_galactic_emperor = no
			}
			desc = gal_com_support_overlord_on_galatic_council
		}
	}
}
resolution_emperor_permanent_seat = {
	icon = "GFX_resolution_imperial_council_member_permanent"

	resources = {
		category = resolutions
		cost = {
			influence = @resolution_cost_t5
		}
	}

	target = yes
	harmful = no
	valid_target = {
		is_country_type = default
		is_galactic_community_member = yes
		is_part_of_galactic_council = yes
		is_permanent_councillor = no
		is_galactic_emperor = no
	}

	effect = {
		add_permanent_councillor = yes
	}

	potential = {
		has_nemesis = yes
		is_galactic_emperor = yes
		is_galactic_council_established = yes
		NOR = {
			is_active_resolution = "resolution_emperor_trial_of_advancement"
			is_active_resolution = "resolution_emperor_by_appointment"
		}
		NOT = { has_global_flag = imperial_unification_start }
	}

	active = {
		has_galactic_emperor = yes
	}

	allow = {
		custom_tooltip = {
			fail_text = "resolution_already_active"
			NOT = { is_active_resolution = "resolution_emperor_permanent_seat" }
		}
	}

	ai_weight = {
		base = @resolution_weight_disliked
	}
}
resolution_emperor_revoke_permanent_seat = {
	icon = "GFX_resolution_imperial_council_member_permanent"

	resources = {
		category = resolutions
		cost = {
			influence = @resolution_cost_t5
		}
	}

	target = yes
	harmful = yes
	valid_target = {
		is_country_type = default
		is_galactic_community_member = yes
		is_part_of_galactic_council = yes
		is_permanent_councillor = yes
		is_galactic_emperor = no
	}

	effect = {
		remove_permanent_councillor = yes
	}

	potential = {
		has_nemesis = yes
		is_galactic_emperor = yes
		is_galactic_council_established = yes
		NOR = {
			is_active_resolution = "resolution_emperor_trial_of_advancement"
			is_active_resolution = "resolution_emperor_by_appointment"
		}
		NOT = { has_global_flag = imperial_unification_start }
	}

	active = {
		has_galactic_emperor = yes
	}

	ai_weight = {
		base = @resolution_weight_disliked
	}
}
resolution_emperor_trial_of_advancement = {
	icon = "GFX_resolution_imperial_council_trial"

	resources = {
		category = resolutions
		cost = {
			influence = @resolution_cost_t3
		}
	}
	target = no

	modifier = {
	}

	effect = {
		custom_tooltip = resolution_emperor_trial_of_advancement_tooltip
		hidden_effect = {
			# Suspend Council Elections
			every_playable_country = {
				limit = {
					is_galactic_community_member = yes
					is_part_of_galactic_council = yes
					is_galactic_emperor = no
				}
				add_permanent_councillor = yes
			}
			if = {
				limit = { is_active_resolution = "resolution_emperor_by_appointment" }
				cancel_resolution = "resolution_emperor_by_appointment"
			}
			else_if = {
				limit = { is_active_resolution = "resolution_emperor_by_election" }
				cancel_resolution = "resolution_emperor_by_election"
			}
		}
	}

	fail_effects = {
	}

	potential = {
		has_nemesis = yes
		is_galactic_emperor = yes
		NOT = { has_global_flag = imperial_unification_start }
	}

	active = {
		has_galactic_emperor = yes
	}

	allow = {
		custom_tooltip = {
			fail_text = "resolution_already_active"
			NOT = { is_active_resolution = "resolution_emperor_trial_of_advancement" }
		}
	}

	ai_weight = {
		base = @resolution_weight_disliked

		modifier = {
			weight = 10
			is_part_of_galactic_council = no
			any_playable_country = {
				is_part_of_galactic_council = yes
				is_galactic_emperor = no
				relative_power = {
					who = prev
					category = fleet
					value <= equivalent
				}
			}
			desc = gal_com_stronger_than_council_member
		}
		modifier = {
			weight = 0
			is_pacifist = yes
			desc = ethic_pacifist
		}
		modifier = {
			weight = 1.6
			is_militarist = yes
			desc = ethic_militarist
		}
		modifier = {
			weight = 4
			has_ai_personality = honorbound_warriors
			desc = personality_honorbound_warriors
		}
		modifier = {
			weight = 4
			has_civic = civic_warrior_culture
			desc = civic_warrior_culture
		}
		modifier = {
			weight = 0
			is_part_of_galactic_council = yes
			is_galactic_emperor = no
			any_playable_country = {
				is_part_of_galactic_council = no
				relative_power = {
					who = prev
					category = fleet
					value >= equivalent
				}
			}
			desc = gal_com_weaker_than_non_council_member
		}
	}
}
resolution_emperor_by_election = {
	icon = "GFX_resolution_imperial_council_diplomatic_weight"

	resources = {
		category = resolutions
		cost = {
			influence = @resolution_cost_t3
		}
	}
	target = no

	modifier = {
	}

	effect = {
		custom_tooltip = resolution_emperor_by_election_tooltip
		hidden_effect = {
			# Restore Council Elections
			every_playable_country = {
				limit = {
					is_galactic_community_member = yes
					is_part_of_galactic_council = yes
					is_galactic_emperor = no
					is_permanent_councillor = yes
				}
				remove_permanent_councillor = yes
			}
			if = {
				limit = { is_active_resolution = "resolution_emperor_trial_of_advancement" }
				cancel_resolution = "resolution_emperor_trial_of_advancement"
			}
			else_if = {
				limit = { is_active_resolution = "resolution_emperor_by_appointment" }
				cancel_resolution = "resolution_emperor_by_appointment"
			}
		}
	}

	fail_effects = {
	}

	potential = {
		has_nemesis = yes
		is_galactic_emperor = yes
		NOT = { has_global_flag = imperial_unification_start }
	}

	active = {
		has_galactic_emperor = yes
	}

	allow = {
		custom_tooltip = {
			fail_text = "resolution_already_active"
			NOT = { is_active_resolution = "resolution_emperor_by_election" }
		}
	}

	ai_weight = {
		base = @resolution_weight_disliked

		modifier = {
			factor = 10
			num_council_positions = 1
			galactic_community_rank = 1
			is_part_of_galactic_council = no
			desc = gal_com_empire_council_candidate
		}
		modifier = {
			factor = 10
			num_council_positions = 2
			galactic_community_rank = 2
			is_part_of_galactic_council = no
			desc = gal_com_empire_council_candidate
		}
		modifier = {
			factor = 10
			num_council_positions = 3
			galactic_community_rank = 3
			is_part_of_galactic_council = no
			desc = gal_com_empire_council_candidate
		}
		modifier = {
			factor = 10
			num_council_positions = 4
			galactic_community_rank = 4
			is_part_of_galactic_council = no
			desc = gal_com_empire_council_candidate
		}
		modifier = {
			factor = 10
			num_council_positions = 5
			galactic_community_rank = 5
			is_part_of_galactic_council = no
			desc = gal_com_empire_council_candidate
		}
		modifier = {
			factor = 0
			galactic_community_rank <= 2
			is_part_of_galactic_council = no
			desc = gal_com_top_two_rank
		}
	}
}

################################### resolution_category_emperor_imperial_institutions
#resolution_emperor_ina
resolution_emperor_disband_ina = {
	icon = "GFX_resolution_council_size"

	resources = {
		category = resolutions
		cost = {
			influence = @resolution_cost_t3
		}
	}
	target = no
	fire_and_forget = yes

	effect = {
		cancel_resolution = "resolution_emperor_ina"
		hidden_effect = { cancel_resolution = "resolution_custodian_ina" }
		hidden_effect = { pass_resolution_no_cooldown = resolution_category_imperial_institutions_reset_cooldown }
	}

	potential = {
		has_nemesis = yes
		OR = {
			is_galactic_emperor = yes
			and = {
				has_galactic_emperor = yes
				is_part_of_galactic_council = yes
				is_active_resolution = "resolution_emperor_expand_power_of_council"
			}
			is_country_type = imperial_senator
		}
		is_active_resolution = "resolution_emperor_ina"
	}

	ai_weight = {
		base = @resolution_weight_disliked

		modifier = {
			factor = 1.2
			is_xenophobe = yes
			desc = ethic_xenophobe
		}
		modifier = {
			factor = 2
			has_ai_personality = xenophobic_isolationists
			desc = personality_xenophobic_isolationists
		}
		modifier = {
			factor = 0.8
			is_xenophile = yes
			desc = ethic_xenophile
		}
		modifier = {
			factor = 0.4
			has_ai_personality = erudite_explorers
			desc = personality_erudite_explorers
		}
		modifier = {
			factor = 0
			is_galactic_emperor = yes
			desc = galactic_emperor
		}
		modifier = {
			factor = 0.4
			is_galactic_emperor = no
			is_part_of_galactic_council = yes
			desc = gal_com_on_galatic_council
		}
	}
}
#resolution_emperor_gto
resolution_emperor_disband_gto = {
	icon = "GFX_resolution_council_size"

	resources = {
		category = resolutions
		cost = {
			influence = @resolution_cost_t3
		}
	}
	target = no
	fire_and_forget = yes

	effect = {
		cancel_resolution = "resolution_emperor_gto"
		hidden_effect = { cancel_resolution = "resolution_custodian_gto" }
		hidden_effect = { pass_resolution_no_cooldown = resolution_category_imperial_institutions_reset_cooldown }
	}

	potential = {
		has_nemesis = yes
		OR = {
			is_galactic_emperor = yes
			and = {
				has_galactic_emperor = yes
				is_part_of_galactic_council = yes
				is_active_resolution = "resolution_emperor_expand_power_of_council"
			}
			is_country_type = imperial_senator
		}
		is_active_resolution = "resolution_emperor_gto"
	}

	ai_weight = {
		base = @resolution_weight_disliked

		modifier = {
			factor = 0.6
			has_authority = auth_corporate
			desc = auth_corporate
		}
		modifier = {
			factor = 0.6
			OR = {
				has_ai_personality = peaceful_traders
				has_ai_personality = ruthless_capitalists
			}
			desc = gal_com_trader_ai_personality
		}
		modifier = {
			factor = 1.3
			is_xenophobe = yes
			desc = ethic_xenophobe
		}
		modifier = {
			factor = 1.8
			has_ai_personality = xenophobic_isolationists
			desc = personality_xenophobic_isolationists
		}
		modifier = {
			factor = 2
			is_gestalt = yes
			desc = ethic_gestalt_consciousness
		}
		modifier = {
			factor = 0
			is_galactic_emperor = yes
			desc = galactic_emperor
		}
		modifier = {
			factor = 0.4
			is_galactic_emperor = no
			is_part_of_galactic_council = yes
			desc = gal_com_on_galatic_council
		}
	}
}

################################### resolution_category_imperial_members
resolution_emperor_imperial_charter = {
	icon = "GFX_resolution_imperial_trade_company"

	resources = {
		category = resolutions
		cost = {
			influence = @resolution_cost_t3
		}
	}

	target = yes
	harmful = no

	allow = {
		custom_tooltip = {
			fail_text = "resolution_already_active"
			NOT = { is_active_resolution = "resolution_emperor_imperial_charter" }
		}
	}

	valid_target = {
		is_country_type = default
		is_galactic_community_member = yes
		is_megacorp = yes
		is_criminal_syndicate = no
		is_galactic_emperor = no
	}

	effect = {
		custom_tooltip = resolution_emperor_imperial_charter_tooltip
		custom_tooltip = resolution_emperor_imperial_charter_tooltip_weaken_effect
		hidden_effect = {
			set_global_flag = imperial_charter_granted
			add_modifier = { modifier = imperial_charter }
			random_playable_country = {
				limit = { is_galactic_emperor = yes }
				set_variable = {
					which = imp_concession_ports
					value = 0
				}
			}
			every_playable_country = {
				limit = {
					is_ai = no
					NOT = { is_same_value = prev }
					is_galactic_community_member = yes
					is_galactic_emperor = no
				}
				country_event = { id = emperor.60 }
			}
		}
		hidden_effect = { pass_resolution_no_cooldown = resolution_category_imperial_members_reset_cooldown }
	}

	potential = {
		has_nemesis = yes
		OR = {
			is_galactic_emperor = yes
			and = {
				has_galactic_emperor = yes
				is_part_of_galactic_council = yes
				is_active_resolution = "resolution_emperor_expand_power_of_council"
			}
			is_country_type = imperial_senator
		}
		NOR = {
			any_country = {
				is_galactic_emperor = yes
				OR = {
					has_civic = civic_galactic_sovereign_megacorp # Megacorp Emperors build their own concession ports
					AND = { # Maid Emperors 
						has_global_flag = flag_rogue_maid_mod_activated
						has_ascension_perk = ap_expactriate_service
					}
				}
			}
			has_global_flag = imperial_charter_granted
		}
	}

	active = {
		has_galactic_emperor = yes
	}

	ai_weight = {
		base = @resolution_weight_disliked

		modifier = {
			factor = 3
			is_galactic_emperor = no
			is_part_of_galactic_council = yes
			is_megacorp = no
			desc = gal_com_on_galatic_council
		}
		modifier = {
			factor = 20
			is_galactic_emperor = yes
			has_ascension_perk = ap_expactriate_service
			desc = galactic_emperor
		}
		modifier = {
			factor = 0
			is_galactic_emperor = yes
			has_ascension_perk = ap_expactriate_service
			desc = galactic_emperors_government
		}
		modifier = {
			factor = 20
			is_same_value = from
			desc = gal_com_target_is_me
		}
	}
}
resolution_emperor_revoke_imperial_charter = {
	icon = "GFX_resolution_imperial_trade_company"

	resources = {
		category = resolutions
		cost = {
			influence = @resolution_cost_t3
		}
	}

	target = yes
	harmful = yes
	fire_and_forget = yes

	valid_target = {
		is_country_type = default
		is_galactic_community_member = yes
		is_megacorp = yes
		is_galactic_emperor = no
		has_modifier = imperial_charter
	}

	effect = {
		hidden_effect = {
			remove_global_flag = imperial_charter_granted
			remove_modifier = imperial_charter
			every_galaxy_planet = {
				limit = { has_planet_flag = imp_concession_port }
				remove_holding = { holding = building_imperial_concession_port owner = planet.branch_office_owner }
				remove_planet_flag = imp_concession_port
			}
			random_playable_country = {
				limit = { is_galactic_emperor = yes }
				set_variable = {
					which = "imp_concession_ports"
					value = 0
				}
				add_imp_concession_ports_0 = yes
			}
		}
		hidden_effect = { pass_resolution_no_cooldown = resolution_category_imperial_members_reset_cooldown }
	}

	potential = {
		has_nemesis = yes
		OR = {
			is_galactic_emperor = yes
			and = {
				has_galactic_emperor = yes
				is_part_of_galactic_council = yes
				is_active_resolution = "resolution_emperor_expand_power_of_council"
			}
			is_country_type = imperial_senator
		}
		has_global_flag = imperial_charter_granted
	}

	ai_weight = {
		weight = @resolution_weight_disliked

		modifier = {
			factor = 3
			OR = {
				is_megacorp = yes
				has_ascension_perk = ap_expactriate_service
			}
			NOT = { is_same_value = ROOT }
			desc = gal_com_targets_competitor
		}
		modifier = {
			factor = 0
			is_same_value = ROOT
			desc = gal_com_target_is_me
		}
		modifier = {
			factor = 20
			is_galactic_emperor = yes
			OR = {
				is_hostile_to = FROM
				is_domineering_to = FROM
				is_unfriendly_to = FROM
			}
			desc = gal_com_emperor_unfriendly_to_proposer
		}
	}
}

################################### resolution_category_galactic_focus
resolution_galactic_focus_crisis_prethoryn = {
	icon = "GFX_resolution_emergency_measure"

	resources = {
		category = resolutions
		cost = {
			influence = @resolution_cost_t1
		}
	}
	target = no

	effect = {
		custom_tooltip = resolution_galactic_focus_crisis_prethoryn_effect_success

		hidden_effect = {
			repeal_all_galactic_focus_resolutions = yes
			set_global_flag = galactic_focus_crisis_prethoryn
			set_global_flag = galactic_community_crisis_fighting

			set_global_flag = galactic_community_resolution_passed

			set_timed_country_flag = { flag = galactic_community_resolution_passed_general days = @resolution_flag_timer }
			add_modifier = {
				modifier = resolution_passed_diplomatic_weight
				days = 2200
			}
		}
	}

	fail_effects = {
		hidden_effect = {
			set_timed_country_flag = { flag = galactic_community_resolution_failed_general days = @resolution_flag_timer }
			add_modifier = {
				modifier = resolution_failed_diplomatic_weight
				days = 2200
			}
		}
	}

	potential = {
		has_global_flag = ongoing_prethoryn_invasion
		NOT = { has_global_flag = galactic_focus_crisis_prethoryn }
		NOT = { has_global_flag = flag_imperial_crusade_ongoing }
	}

	active = { # Resolution only in effect while this trigger is met
		has_global_flag = ongoing_prethoryn_invasion
	}

	ai_weight = {
		base = @resolution_weight_normal

		modifier = {
			factor = 2

			any_neighbor_country = {
				is_country_type = swarm
			}
			desc = gal_com_is_neighboring_swarm
		}

		modifier = {
			factor = 0.75

			NOT = {
				any_neighbor_country = {
					is_country_type = swarm
				}
			}
			desc = gal_com_is_not_neighboring_swarm
		}

		modifier = {
			factor = 0.75

			has_crisis_stage_1 = yes
			desc = gal_com_crisis_stage_1
		}

		modifier = {
			factor = 1.25

			has_crisis_stage_3 = yes
			desc = gal_com_crisis_stage_3
		}

		modifier = {
			factor = 10

			has_crisis_stage_4 = yes
			desc = gal_com_crisis_stage_4
		}

		modifier = {
			factor = 10

			has_ascension_perk = ap_defender_of_the_galaxy
			desc = ap_defender_of_the_galaxy
		}

		modifier = {
			factor = 1.2
			is_militarist = yes
			desc = ethic_militarist
		}

		modifier = {
			factor = 1.1
			is_xenophile = yes
			desc = ethic_xenophile
		}

		modifier = {
			factor = 0.5
			is_xenophobe = yes

			NOT = {
				any_neighbor_country = {
					is_country_type = swarm
				}
			}
			desc = ethic_xenophobe
		}
	}
}
resolution_galactic_focus_crisis_unbidden = {
	icon = "GFX_resolution_emergency_measure"

	resources = {
		category = resolutions
		cost = {
			influence = @resolution_cost_t1
		}
	}
	target = no

	effect = {
		custom_tooltip = resolution_galactic_focus_crisis_unbidden_effect_success

		hidden_effect = {
			repeal_all_galactic_focus_resolutions = yes
			set_global_flag = galactic_focus_crisis_unbidden
			set_global_flag = galactic_community_crisis_fighting

			set_global_flag = galactic_community_resolution_passed

			set_timed_country_flag = { flag = galactic_community_resolution_passed_general days = @resolution_flag_timer }
			add_modifier = {
				modifier = resolution_passed_diplomatic_weight
				days = 2200
			}
		}
	}

	fail_effects = {
		hidden_effect = {
			set_timed_country_flag = { flag = galactic_community_resolution_failed_general days = @resolution_flag_timer }
			add_modifier = {
				modifier = resolution_failed_diplomatic_weight
				days = 2200
			}
		}
	}

	potential = {
		has_global_flag = extradimensional_invasion_happened
		NOR = {
			has_global_flag = extradimensional_invasion_defeated
			has_global_flag = galactic_focus_crisis_unbidden
		}
		NOT = { has_global_flag = flag_imperial_crusade_ongoing }
	}

	active = { # Resolution only in effect while this trigger is met
		NOT = { has_global_flag = extradimensional_invasion_defeated }
	}

	ai_weight = {
		base = @resolution_weight_normal

		modifier = {
			factor = 2

			any_neighbor_country = {
				OR = {
					is_country_type = extradimensional
					is_country_type = extradimensional_2
					is_country_type = extradimensional_3
				}
			}
			desc = gal_com_neighboring_extradimensional
		}

		modifier = {
			factor = 0.75

			NOT = {
				any_neighbor_country = {
					OR = {
						is_country_type = extradimensional
						is_country_type = extradimensional_2
						is_country_type = extradimensional_3
					}
				}
			}
			desc = gal_com_not_neighboring_extradimensional
		}

		modifier = {
			factor = 0.75

			has_crisis_stage_1 = yes
			desc = gal_com_crisis_stage_1
		}

		modifier = {
			factor = 1.25

			has_crisis_stage_3 = yes
			desc = gal_com_crisis_stage_3
		}

		modifier = {
			factor = 10

			has_crisis_stage_4 = yes
			desc = gal_com_crisis_stage_4
		}

		modifier = {
			factor = 10

			has_ascension_perk = ap_defender_of_the_galaxy
			desc = ap_defender_of_the_galaxy
		}

		modifier = {
			factor = 1.2
			is_militarist = yes
			desc = ethic_militarist
		}

		modifier = {
			factor = 1.1
			is_xenophile = yes
			desc = ethic_xenophile
		}

		modifier = {
			factor = 1.1
			is_spiritualist = yes
			desc = ethic_spiritualist
		}

		modifier = {
			factor = 0.5
			is_xenophobe = yes

			NOT = {
				any_neighbor_country = {
					OR = {
						is_country_type = extradimensional
						is_country_type = extradimensional_2
						is_country_type = extradimensional_3
					}
				}
			}
			desc = ethic_xenophobe
		}
	}
}
resolution_galactic_focus_crisis_contingency = {
	icon = "GFX_resolution_emergency_measure"

	resources = {
		category = resolutions
		cost = {
			influence = @resolution_cost_t1
		}
	}
	target = no

	effect = {
		custom_tooltip = resolution_galactic_focus_crisis_contingency_effect_success

		hidden_effect = {
			repeal_all_galactic_focus_resolutions = yes
			set_global_flag = galactic_focus_crisis_contingency
			set_global_flag = galactic_community_crisis_fighting

			set_global_flag = galactic_community_resolution_passed

			set_timed_country_flag = { flag = galactic_community_resolution_passed_general days = @resolution_flag_timer }
			add_modifier = {
				modifier = resolution_passed_diplomatic_weight
				days = 2200
			}
		}
	}

	fail_effects = {
		hidden_effect = {
			set_timed_country_flag = { flag = galactic_community_resolution_failed_general days = @resolution_flag_timer }
			add_modifier = {
				modifier = resolution_failed_diplomatic_weight
				days = 2200
			}
		}
	}

	potential = {
		has_global_flag = ai_invasion_ongoing
		NOT = { has_global_flag = galactic_focus_crisis_contingency }
		NOT = { has_global_flag = flag_imperial_crusade_ongoing }
	}

	active = { # Resolution only in effect while this trigger is met
		has_global_flag = ai_invasion_ongoing
	}

	ai_weight = {
		base = @resolution_weight_normal

		modifier = {
			factor = 2

			any_neighbor_country = {
				is_country_type = ai_empire
			}
			desc = gal_com_neighboring_ai_empire
		}

		modifier = {
			factor = 0.75

			NOT = {
				any_neighbor_country = {
					is_country_type = ai_empire
				}
			}
			desc = gal_com_not_neighboring_ai_empire
		}

		modifier = {
			factor = 0.75

			has_crisis_stage_1 = yes
			desc = gal_com_crisis_stage_1
		}

		modifier = {
			factor = 1.25

			has_crisis_stage_3 = yes
			desc = gal_com_crisis_stage_3
		}

		modifier = {
			factor = 10

			has_crisis_stage_4 = yes
			desc = gal_com_crisis_stage_4
		}

		modifier = {
			factor = 10

			has_ascension_perk = ap_defender_of_the_galaxy
			desc = ap_defender_of_the_galaxy
		}

		modifier = {
			factor = 1.2
			is_militarist = yes
			desc = ethic_militarist
		}

		modifier = {
			factor = 1.1
			is_xenophile = yes
			desc = ethic_xenophile
		}

		modifier = {
			factor = 1.2
			OR = {
				is_materialist = yes
				is_synthetic_empire = yes
			}
			desc = gal_com_is_materialist_or_synthetic
		}

		modifier = {
			factor = 0.5
			is_xenophobe = yes

			NOT = {
				any_neighbor_country = {
					is_country_type = ai_empire
				}
			}
			desc = ethic_xenophobe
		}
	}
}
resolution_galactic_focus_crisis_greatkhan = {
	icon = "GFX_resolution_emergency_measure"

	resources = {
		category = resolutions
		cost = {
			influence = @resolution_cost_t1
		}
	}
	target = no

	effect = {
		custom_tooltip = resolution_galactic_focus_crisis_greatkhan_effect_success

		hidden_effect = {
			repeal_all_galactic_focus_resolutions = yes
			set_global_flag = galactic_focus_crisis_greatkhan
			set_global_flag = galactic_community_crisis_fighting

			set_global_flag = galactic_community_resolution_passed

			set_timed_country_flag = { flag = galactic_community_resolution_passed_general days = @resolution_flag_timer }
			add_modifier = {
				modifier = resolution_passed_diplomatic_weight
				days = 2200
			}
		}
	}

	fail_effects = {
		hidden_effect = {
			set_timed_country_flag = { flag = galactic_community_resolution_failed_general days = @resolution_flag_timer }
			add_modifier = {
				modifier = resolution_failed_diplomatic_weight
				days = 2200
			}
		}
	}

	potential = {
		has_global_flag = great_khan_announcement
		NOT = { has_global_flag = great_khan_dead }
		NOT = { has_global_flag = galactic_focus_crisis_greatkhan }
		NOT = { has_global_flag = flag_imperial_crusade_ongoing }
	}

	active = { # Resolution only in effect while this trigger is met
		NOT = { has_global_flag = great_khan_dead }
	}

	ai_weight = {
		base = @resolution_weight_normal

		modifier = {
			factor = 0

			any_agreement = { agreement_preset = preset_satrapy }
			NOT = { has_country_flag = rebelling_satrapy }
			desc = gal_com_satrapy
		}

		modifier = {
			factor = 10

			any_agreement = { agreement_preset = preset_satrapy }
			has_country_flag = rebelling_satrapy
			desc = gal_com_rebelling_satrapy
		}

		modifier = {
			factor = 2

			any_neighbor_country = {
				is_country_type = awakened_marauders
			}

			desc = gal_com_neighboring_awakened_marauders
		}

		modifier = {
			factor = 1.1

			any_neighbor_country = {
				any_agreement = { agreement_preset = preset_satrapy }
				NOT = { has_country_flag = rebelling_satrapy }
			}
			desc = gal_com_neighboring_satrapy
		}

		modifier = {
			factor = 1.2
			is_militarist = yes
			desc = ethic_militarist
		}

		modifier = {
			factor = 1.2
			is_pacifist = yes
			desc = ethic_pacifist
		}

		modifier = {
			factor = 0.5
			is_xenophobe = yes

			NOT = {
				any_neighbor_country = {
					OR = {
						is_country_type = awakened_marauders
						any_agreement = { agreement_preset = preset_satrapy }
					}
				}
			}
			desc = ethic_xenophobe
		}
	}
}
resolution_galactic_focus_crisis_nanites = {
	icon = "GFX_resolution_emergency_measure"

	resources = {
		category = resolutions
		cost = {
			influence = @resolution_cost_t1
		}
	}
	target = no

	effect = {
		custom_tooltip = resolution_galactic_focus_crisis_nanites_effect_success

		hidden_effect = {
			repeal_all_galactic_focus_resolutions = yes
			set_global_flag = galactic_focus_crisis_nanites
			set_global_flag = galactic_community_crisis_fighting

			set_global_flag = galactic_community_resolution_passed

			set_timed_country_flag = { flag = galactic_community_resolution_passed_general days = @resolution_flag_timer }
			add_modifier = {
				modifier = resolution_passed_diplomatic_weight
				days = 2200
			}
		}
	}

	fail_effects = {
		hidden_effect = {
			set_timed_country_flag = { flag = galactic_community_resolution_failed_general days = @resolution_flag_timer }
			add_modifier = {
				modifier = resolution_failed_diplomatic_weight
				days = 2200
			}
		}
	}

	potential = {
		has_global_flag = gray_goo_crisis_active
		NOT = { has_global_flag = galactic_focus_crisis_nanites }
		NOT = { has_global_flag = flag_imperial_crusade_ongoing }
	}

	active = { # Resolution only in effect while this trigger is met
		has_global_flag = gray_goo_crisis_active
	}

	ai_weight = {
		base = @resolution_weight_normal

		modifier = {
			factor = 2

			any_neighbor_country = {
				is_country_type = gray_goo
			}
			desc = gal_com_neighboring_gray_goo
		}

		modifier = {
			factor = 0.75

			NOT = {
				any_country = {
					is_country_type = gray_goo
					galaxy_percentage > 0.10
				}
			}
			desc = gal_com_gray_goo_size_smallest
		}

		modifier = {
			factor = 1.1

			any_country = {
				is_country_type = gray_goo
				galaxy_percentage > 0.10
				galaxy_percentage <= 0.20
			}
			desc = gal_com_gray_goo_size_small
		}

		modifier = {
			factor = 1.5

			any_country = {
				is_country_type = gray_goo
				galaxy_percentage > 0.20
				galaxy_percentage <= 0.30
			}
			desc = gal_com_gray_goo_size_medium
		}

		modifier = {
			factor = 2

			any_country = {
				is_country_type = gray_goo
				galaxy_percentage > 0.30
				galaxy_percentage <= 0.40
			}
			desc = gal_com_gray_goo_size_large
		}

		modifier = {
			factor = 3

			any_country = {
				is_country_type = gray_goo
				galaxy_percentage > 0.40
				galaxy_percentage <= 0.50
			}
			desc = gal_com_gray_goo_size_very_large
		}

		modifier = {
			factor = 10

			any_country = {
				is_country_type = gray_goo
				galaxy_percentage > 0.50
			}
			desc = gal_com_gray_goo_size_huge
		}

		modifier = {
			factor = 10

			has_ascension_perk = ap_defender_of_the_galaxy
			desc = ap_defender_of_the_galaxy
		}

		modifier = {
			factor = 1.2
			is_militarist = yes
			desc = ethic_militarist
		}

		modifier = {
			factor = 1.2
			is_materialist = yes
			desc = ethic_materialist
		}

		modifier = {
			factor = 0.5
			is_xenophobe = yes

			NOT = {
				any_neighbor_country = {
					is_country_type = gray_goo
				}
			}
			desc = ethic_xenophobe
		}
	}
}
resolution_galactic_focus_war_in_heaven_support_side_1 = {
	icon = "GFX_resolution_emergency_measure"

	resources = {
		category = resolutions
		cost = {
			influence = @resolution_cost_t1
		}
	}
	target = no

	effect = {
		custom_tooltip = resolution_galactic_focus_war_in_heaven_support_side_1_success

		hidden_effect = {
			repeal_all_galactic_focus_resolutions = yes
			set_global_flag = galactic_focus_war_in_heaven
			set_global_flag = galactic_community_resolution_passed
			set_timed_country_flag = { flag = galactic_community_resolution_passed_general days = @resolution_flag_timer }
			add_modifier = {
				modifier = resolution_passed_diplomatic_weight
				days = 2200
			}
		}
	}

	fail_effects = {
		hidden_effect = {
			set_timed_country_flag = { flag = galactic_community_resolution_failed_general days = @resolution_flag_timer }
			add_modifier = {
				modifier = resolution_failed_diplomatic_weight
				days = 2200
			}
		}
	}

	potential = {
		has_global_flag = war_in_heaven_ongoing
		has_galactic_emperor = no # Empire always at war with WiH sides
		NOT = { has_global_flag = galactic_focus_war_in_heaven }
		exists = event_target:SecondSleeper
		NOT = { any_federation = { has_federation_perk = galactic_confederation_passive } }
	}

	active = { # Resolution only in effect while this trigger is met
		has_global_flag = war_in_heaven_ongoing
		exists = event_target:FirstSleeper
		exists = event_target:SecondSleeper
	}

	breach = {
		NAND = {
			exists = overlord
			has_overlord = event_target:FirstSleeper
		}
		NOT = { has_country_flag = constitutional_immunity }
	}

	ai_weight = {
		base = @resolution_weight_normal

		modifier = {
			factor = 2
			exists = overlord
			has_overlord = event_target:FirstSleeper
			desc = gal_com_supporting_their_overlord
		}

		modifier = {
			factor = 0
			exists = overlord
			has_overlord = event_target:SecondSleeper
			desc = gal_com_supporting_their_overlord
		}
	}
}
resolution_galactic_focus_war_in_heaven_support_side_2 = {
	icon = "GFX_resolution_emergency_measure"

	resources = {
		category = resolutions
		cost = {
			influence = @resolution_cost_t1
		}
	}
	target = no

	effect = {
		custom_tooltip = resolution_galactic_focus_war_in_heaven_support_side_2_success

		hidden_effect = {
			repeal_all_galactic_focus_resolutions = yes
			set_global_flag = galactic_focus_war_in_heaven
			set_global_flag = galactic_community_resolution_passed
			set_timed_country_flag = { flag = galactic_community_resolution_passed_general days = @resolution_flag_timer }
			add_modifier = {
				modifier = resolution_passed_diplomatic_weight
				days = 2200
			}
		}
	}

	fail_effects = {
		hidden_effect = {
			set_timed_country_flag = { flag = galactic_community_resolution_failed_general days = @resolution_flag_timer }
			add_modifier = {
				modifier = resolution_failed_diplomatic_weight
				days = 2200
			}
		}
	}

	potential = {
		has_global_flag = war_in_heaven_ongoing
		has_galactic_emperor = no # Empire always at war with WiH sides
		NOT = { has_global_flag = galactic_focus_war_in_heaven }
		exists = event_target:FirstSleeper
		NOT = { any_federation = { has_federation_perk = galactic_confederation_passive } }
	}

	active = { # Resolution only in effect while this trigger is met
		has_global_flag = war_in_heaven_ongoing
		exists = event_target:FirstSleeper
		exists = event_target:SecondSleeper
	}

	breach = {
		NAND = {
			exists = overlord
			has_overlord = event_target:SecondSleeper
		}
		NOT = { has_country_flag = constitutional_immunity }
	}

	ai_weight = {
		base = @resolution_weight_normal

		modifier = {
			factor = 0
			exists = overlord
			has_overlord = event_target:FirstSleeper
			desc = gal_com_supporting_their_overlord
		}

		modifier = {
			factor = 2
			exists = overlord
			has_overlord = event_target:SecondSleeper
			desc = gal_com_supporting_their_overlord
		}
	}
}