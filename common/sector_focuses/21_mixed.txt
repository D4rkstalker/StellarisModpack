# Sector focus: mixed
mixed = {

	ai_weight = {
		weight = 0
	}

	clear_blockers = yes

	# district: district_city
	district = {
		key = district_city

		weight = {
			weight = 1.0

			# Pre-build when approaching threshold and there are free jobs
			modifier = {
				factor = 10.0

				AND = {
					free_housing < 1
					free_jobs > 1
				}

			}

			# Increase priority when out of housing
			modifier = {
				factor = 30.0
				free_housing < 0
			}

			# Disallow when not needed
			modifier = {
				factor = 0.0

				OR = {
					free_housing > 0

					AND = {
						owner = {
							AND = {
								ipa_ignore_upkeep_necessities = no
							}
						}
						controller = {
							AND = {
								has_monthly_income = { resource = energy value <= 2 }
							}
						}
					}

				}

			}

		}

	}

	# district: district_hab_housing
	district = {
		key = district_hab_housing

		weight = {
			weight = 1.0

			# Pre-build when approaching threshold and there are free jobs
			modifier = {
				factor = 10.0

				AND = {
					free_housing < 1
					free_jobs > 1
				}

			}

			# Increase priority when out of housing
			modifier = {
				factor = 30.0
				free_housing < 0
			}

			# Disallow when not needed
			modifier = {
				factor = 0.0

				OR = {
					free_housing > 0

					AND = {
						owner = {
							AND = {
								ipa_ignore_upkeep_necessities = no
							}
						}
						controller = {
							AND = {
								has_monthly_income = { resource = energy value <= 2 }
							}
						}
					}

				}

			}

		}

	}

	# district: district_hive
	district = {
		key = district_hive

		weight = {
			weight = 1.0

			# Pre-build when approaching threshold and there are free jobs
			modifier = {
				factor = 10.0

				AND = {
					free_housing < 1
					free_jobs > 1
				}

			}

			# Increase priority when out of housing
			modifier = {
				factor = 30.0
				free_housing < 0
			}

			# Disallow when not needed
			modifier = {
				factor = 0.0

				OR = {
					free_housing > 0

					AND = {
						owner = {
							AND = {
								ipa_ignore_upkeep_necessities = no
							}
						}
						controller = {
							AND = {
								has_monthly_income = { resource = energy value <= 2 }
							}
						}
					}

				}

			}

		}

	}

	# district: district_nexus
	district = {
		key = district_nexus

		weight = {
			weight = 1.0

			# Pre-build when approaching threshold and there are free jobs
			modifier = {
				factor = 10.0

				AND = {
					free_housing < 1
					free_jobs > 1
				}

			}

			# Increase priority when out of housing
			modifier = {
				factor = 30.0
				free_housing < 0
			}

			# Disallow when not needed
			modifier = {
				factor = 0.0

				OR = {
					free_housing > 0

					AND = {
						owner = {
							AND = {
								ipa_ignore_upkeep_necessities = no
							}
						}
						controller = {
							AND = {
								has_monthly_income = { resource = energy value <= 2 }
							}
						}
					}

				}

			}

		}

	}

	# district: district_rw_city
	district = {
		key = district_rw_city

		weight = {
			weight = 1.0

			# Pre-build when approaching threshold and there are free jobs
			modifier = {
				factor = 10.0

				AND = {
					free_housing < 1
					free_jobs > 1
				}

			}

			# Increase priority when out of housing
			modifier = {
				factor = 30.0
				free_housing < 0
			}

			# Disallow when not needed
			modifier = {
				factor = 0.0

				OR = {
					free_housing > 0

					AND = {
						owner = {
							AND = {
								ipa_ignore_upkeep_necessities = no
							}
						}
						controller = {
							AND = {
								has_monthly_income = { resource = energy value <= 2 }
							}
						}
					}

				}

			}

		}

	}

	# district: district_rw_hive
	district = {
		key = district_rw_hive

		weight = {
			weight = 1.0

			# Pre-build when approaching threshold and there are free jobs
			modifier = {
				factor = 10.0

				AND = {
					free_housing < 1
					free_jobs > 1
				}

			}

			# Increase priority when out of housing
			modifier = {
				factor = 30.0
				free_housing < 0
			}

			# Disallow when not needed
			modifier = {
				factor = 0.0

				OR = {
					free_housing > 0

					AND = {
						owner = {
							AND = {
								ipa_ignore_upkeep_necessities = no
							}
						}
						controller = {
							AND = {
								has_monthly_income = { resource = energy value <= 2 }
							}
						}
					}

				}

			}

		}

	}

	# district: district_rw_nexus
	district = {
		key = district_rw_nexus

		weight = {
			weight = 1.0

			# Pre-build when approaching threshold and there are free jobs
			modifier = {
				factor = 10.0

				AND = {
					free_housing < 1
					free_jobs > 1
				}

			}

			# Increase priority when out of housing
			modifier = {
				factor = 30.0
				free_housing < 0
			}

			# Disallow when not needed
			modifier = {
				factor = 0.0

				OR = {
					free_housing > 0

					AND = {
						owner = {
							AND = {
								ipa_ignore_upkeep_necessities = no
							}
						}
						controller = {
							AND = {
								has_monthly_income = { resource = energy value <= 2 }
							}
						}
					}

				}

			}

		}

	}

	# building: building_luxury_residence
	building = {
		key = building_luxury_residence

		weight = {
			weight = 1.0

			# Pre-build when approaching threshold and there are free jobs
			modifier = {
				factor = 10.0

				AND = {
					free_housing < 1
					free_jobs > 1
				}

			}

			# Increase priority when out of housing
			modifier = {
				factor = 30.0
				free_housing < 0
			}

			# Disallow when not needed
			modifier = {
				factor = 0.0

				OR = {
					free_district_slots > 0
					free_housing > 0

					AND = {
						owner = {
							AND = {
								ipa_ignore_upkeep_necessities = no
							}
						}
						controller = {
							AND = {
								has_monthly_income = { resource = energy value <= 2 }
							}
						}
					}

				}

			}

		}

	}

	# building: building_hive_warren
	building = {
		key = building_hive_warren

		weight = {
			weight = 1.0

			# Pre-build when approaching threshold and there are free jobs
			modifier = {
				factor = 10.0

				AND = {
					free_housing < 1
					free_jobs > 1
				}

			}

			# Increase priority when out of housing
			modifier = {
				factor = 30.0
				free_housing < 0
			}

			# Disallow when not needed
			modifier = {
				factor = 0.0

				OR = {
					free_district_slots > 0
					free_housing > 0

					AND = {
						owner = {
							AND = {
								ipa_ignore_upkeep_necessities = no
							}
						}
						controller = {
							AND = {
								has_monthly_income = { resource = energy value <= 2 }
							}
						}
					}

				}

			}

		}

	}

	# building: building_drone_storage
	building = {
		key = building_drone_storage

		weight = {
			weight = 1.0

			# Pre-build when approaching threshold and there are free jobs
			modifier = {
				factor = 10.0

				AND = {
					free_housing < 1
					free_jobs > 1
				}

			}

			# Increase priority when out of housing
			modifier = {
				factor = 30.0
				free_housing < 0
			}

			# Disallow when not needed
			modifier = {
				factor = 0.0

				OR = {
					free_district_slots > 0
					free_housing > 0

					AND = {
						owner = {
							AND = {
								ipa_ignore_upkeep_necessities = no
							}
						}
						controller = {
							AND = {
								has_monthly_income = { resource = energy value <= 2 }
							}
						}
					}

				}

			}

		}

	}

	# building: building_holo_theatres
	building = {
		key = building_holo_theatres

		weight = {
			weight = 1.0

			# Pre-build when approaching threshold and not to many free jobs
			modifier = {
				factor = 10.0

				AND = {
					free_amenities < 1
					free_jobs < 5
				}

			}

			# Increase priority when out of amenities
			modifier = {
				factor = 30.0
				free_amenities < 0
			}

			# Increase to crisis status if this gets out of hand
			modifier = {
				factor = 2.0
				free_amenities < -10
			}

			# Disallow when no workers or available or free amenities are present
			modifier = {
				factor = 0.0

				OR = {
					free_jobs > 2
					free_amenities > 0

					AND = {
						owner = {
							AND = {
								ipa_ignore_upkeep_necessities = no
							}
						}
						controller = {
							AND = {
								has_monthly_income = { resource = energy value <= 2 }
							}
						}
					}

				}

			}

		}

	}

	# building: building_maintenance_depot
	building = {
		key = building_maintenance_depot

		weight = {
			weight = 1.0

			# Pre-build when approaching threshold and not to many free jobs
			modifier = {
				factor = 10.0

				AND = {
					free_amenities < 1
					free_jobs < 5
				}

			}

			# Increase priority when out of amenities
			modifier = {
				factor = 30.0
				free_amenities < 0
			}

			# Increase to crisis status if this gets out of hand
			modifier = {
				factor = 2.0
				free_amenities < -10
			}

			# Disallow when no workers or available or free amenities are present
			modifier = {
				factor = 0.0

				OR = {
					free_jobs > 2
					free_amenities > 0

					AND = {
						owner = {
							AND = {
								ipa_ignore_upkeep_necessities = no
							}
						}
						controller = {
							AND = {
								has_monthly_income = { resource = energy value <= 2 }
							}
						}
					}

				}

			}

		}

	}

	# building: building_hyper_entertainment_forum
	building = {
		key = building_hyper_entertainment_forum

		weight = {
			weight = 1.0

			# Pre-build when approaching threshold and not to many free jobs
			modifier = {
				factor = 11.0

				AND = {
					free_amenities < 1
					free_jobs < 5
				}

			}

			# Increase priority when out of amenities
			modifier = {
				factor = 30.0
				free_amenities < 0
			}

			# Increase to crisis status if this gets out of hand
			modifier = {
				factor = 2.0
				free_amenities < -10
			}

			# Disallow when no workers or available
			modifier = {
				factor = 0.0

				OR = {
					free_jobs > 2
					free_amenities > 0

					AND = {
						owner = {
							AND = {
								ipa_ignore_upkeep_necessities = no
							}
						}
						controller = {
							AND = {
								has_monthly_income = { resource = energy value <= 2 }
							}
						}
					}

				}

			}

		}

	}

	# building: building_precinct_house
	building = {
		key = building_precinct_house

		weight = {
			weight = 1.1

			# Pre-build when approaching threshold
			modifier = {
				factor = 10.0
				planet_crime >= 8
			}

			# Increase priority when approaching threshold
			modifier = {
				factor = 30.0

				AND = {
					planet_crime > 8
					planet_crime < 15
				}

			}

			# Increase to crisis status if this gets out of hand
			modifier = {
				factor = 2.0
				planet_crime >= 15
			}

			# Disallow when no workers are available or no crime exists
			modifier = {
				factor = 0.0

				OR = {
					planet_crime < 8
					free_jobs > 3
				}

			}

		}

	}

	# building: building_sentinel_posts
	building = {
		key = building_sentinel_posts

		weight = {
			weight = 1.1

			# Pre-build when approaching threshold
			modifier = {
				factor = 10.0
				planet_crime >= 8
			}

			# Increase priority when approaching threshold
			modifier = {
				factor = 30.0

				AND = {
					planet_crime > 8
					planet_crime < 15
				}

			}

			# Increase to crisis status if this gets out of hand
			modifier = {
				factor = 2.0
				planet_crime >= 15
			}

			# Disallow when no workers are available or no crime exists
			modifier = {
				factor = 0.0

				OR = {
					planet_crime < 8
					free_jobs > 3
				}

			}

		}

	}

	# building: building_colony_shelter
	building = {
		key = building_colony_shelter

		weight = {
			weight = 300.0
		}

	}

	# building: building_capital
	building = {
		key = building_capital

		weight = {
			weight = 300.0
		}

	}

	# building: building_major_capital
	building = {
		key = building_major_capital

		weight = {
			weight = 300.0
		}

	}

	# building: building_system_capital
	building = {
		key = building_system_capital

		weight = {
			weight = 300.0
		}

	}

	# building: building_deployment_post
	building = {
		key = building_deployment_post

		weight = {
			weight = 300.0
		}

	}

	# building: building_machine_capital
	building = {
		key = building_machine_capital

		weight = {
			weight = 300.0
		}

	}

	# building: building_machine_major_capital
	building = {
		key = building_machine_major_capital

		weight = {
			weight = 300.0
		}

	}

	# building: building_machine_system_capital
	building = {
		key = building_machine_system_capital

		weight = {
			weight = 300.0
		}

	}

	# building: building_hive_capital
	building = {
		key = building_hive_capital

		weight = {
			weight = 300.0
		}

	}

	# building: building_hive_major_capital
	building = {
		key = building_hive_major_capital

		weight = {
			weight = 300.0
		}

	}

	# building: building_hab_capital
	building = {
		key = building_hab_capital

		weight = {
			weight = 300.0
		}

	}

	# building: building_hab_major_capital
	building = {
		key = building_hab_major_capital

		weight = {
			weight = 300.0
		}

	}

	# building: building_resort_capital
	building = {
		key = building_resort_capital

		weight = {
			weight = 300.0
		}

	}

	# building: building_slave_capital
	building = {
		key = building_slave_capital

		weight = {
			weight = 300.0
		}

	}

	# building: building_slave_major_capital
	building = {
		key = building_slave_major_capital

		weight = {
			weight = 300.0
		}

	}

	# building: building_hive_node
	building = {
		key = building_hive_node

		weight = {
			weight = 100.0

			modifier = {
				factor = 0.0

				OR = {
					controller = {
						OR = {
							has_monthly_income = { resource = energy value < 1 }
							ipa_missing_income_energy = yes
							AND = {
								is_lithoid_empire = no

								OR = {
									has_monthly_income = { resource = food value < 4 }
									ipa_missing_income_food = yes
								}

							}

							AND = {
								is_lithoid_empire = yes

								OR = {
									has_monthly_income = { resource = minerals value < 4 }
									ipa_missing_income_minerals = yes
								}

							}

						}
					}
				}

			}

		}

	}

	# building: building_hive_cluster
	building = {
		key = building_hive_cluster

		weight = {
			weight = 100.0

			modifier = {
				factor = 0.0

				OR = {
					controller = {
						OR = {
							has_monthly_income = { resource = energy value < 1 }
							ipa_missing_income_energy = yes
							AND = {
								is_lithoid_empire = no

								OR = {
									has_monthly_income = { resource = food value < 4 }
									ipa_missing_income_food = yes
								}

							}

							AND = {
								is_lithoid_empire = yes

								OR = {
									has_monthly_income = { resource = minerals value < 4 }
									ipa_missing_income_minerals = yes
								}

							}

						}
					}
				}

			}

		}

	}

	# building: building_hive_confluence
	building = {
		key = building_hive_confluence

		weight = {
			weight = 100.0

			modifier = {
				factor = 0.0

				OR = {
					controller = {
						OR = {
							has_monthly_income = { resource = energy value < 1 }
							has_monthly_income = { resource = rare_crystals value < 1 }
							ipa_missing_income_energy = yes
							ipa_missing_income_rare_crystals = yes
							AND = {
								is_lithoid_empire = no

								OR = {
									has_monthly_income = { resource = food value < 6 }
									ipa_missing_income_food = yes
								}

							}

							AND = {
								is_lithoid_empire = yes

								OR = {
									has_monthly_income = { resource = minerals value < 6 }
									ipa_missing_income_minerals = yes
								}

							}

						}
					}
				}

			}

		}

	}

	# building: building_autochthon_monument
	building = {
		key = building_autochthon_monument

		weight = {
			weight = 100.0

			modifier = {
				factor = 0.0

				OR = {
					controller = {
						OR = {
							has_monthly_income = { resource = energy value < 1 }
							has_monthly_income = { resource = consumer_goods value < 1 }
							ipa_missing_income_energy = yes
							ipa_missing_income_consumer_goods = yes
						}
					}
				}

			}

		}

	}

	# building: building_heritage_site
	building = {
		key = building_heritage_site

		weight = {
			weight = 100.0

			modifier = {
				factor = 0.0

				OR = {
					controller = {
						OR = {
							has_monthly_income = { resource = energy value < 1 }
							has_monthly_income = { resource = consumer_goods value < 2 }
							ipa_missing_income_energy = yes
							ipa_missing_income_consumer_goods = yes
						}
					}
				}

			}

		}

	}

	# building: building_hypercomms_forum
	building = {
		key = building_hypercomms_forum

		weight = {
			weight = 100.0

			modifier = {
				factor = 0.0

				OR = {
					controller = {
						OR = {
							has_monthly_income = { resource = energy value < 1 }
							has_monthly_income = { resource = consumer_goods value < 4 }
							has_monthly_income = { resource = rare_crystals value < 1 }
							ipa_missing_income_energy = yes
							ipa_missing_income_consumer_goods = yes
							ipa_missing_income_rare_crystals = yes
						}
					}
				}

			}

		}

	}

	# building: building_autocurating_vault
	building = {
		key = building_autocurating_vault

		weight = {
			weight = 100.0

			modifier = {
				factor = 0.0

				OR = {
					controller = {
						OR = {
							has_monthly_income = { resource = energy value < 1 }
							has_monthly_income = { resource = consumer_goods value < 4 }
							has_monthly_income = { resource = rare_crystals value < 1 }
							ipa_missing_income_energy = yes
							ipa_missing_income_consumer_goods = yes
							ipa_missing_income_rare_crystals = yes
						}
					}
				}

			}

		}

	}

	# building: building_uplink_node
	building = {
		key = building_uplink_node

		weight = {
			weight = 100.0

			modifier = {
				factor = 0.0

				OR = {
					controller = {
						OR = {
							has_monthly_income = { resource = energy value < 7 }
							ipa_missing_income_energy = yes
						}
					}
				}

			}

		}

	}

	# building: building_network_junction
	building = {
		key = building_network_junction

		weight = {
			weight = 100.0

			modifier = {
				factor = 0.0

				OR = {
					controller = {
						OR = {
							has_monthly_income = { resource = energy value < 7 }
							ipa_missing_income_energy = yes
						}
					}
				}

			}

		}

	}

	# building: building_system_conflux
	building = {
		key = building_system_conflux

		weight = {
			weight = 100.0

			modifier = {
				factor = 0.0

				OR = {
					controller = {
						OR = {
							has_monthly_income = { resource = energy value < 10 }
							has_monthly_income = { resource = rare_crystals value < 1 }
							ipa_missing_income_energy = yes
							ipa_missing_income_rare_crystals = yes
						}
					}
				}

			}

		}

	}

	# building: building_alpha_hub
	building = {
		key = building_alpha_hub

		weight = {
			weight = 100.0

			modifier = {
				factor = 0.0

				OR = {
					controller = {
						OR = {
							has_monthly_income = { resource = energy value < 10 }
							has_monthly_income = { resource = rare_crystals value < 1 }
							ipa_missing_income_energy = yes
							ipa_missing_income_rare_crystals = yes
						}
					}
				}

			}

		}

	}

	# building: building_temple
	building = {
		key = building_temple

		weight = {
			weight = 100.0

			modifier = {
				factor = 0.0

				OR = {
					controller = {
						OR = {
							has_monthly_income = { resource = energy value < 1 }
							ipa_missing_income_energy = yes
						}
					}
				}

			}

		}

	}

	# building: building_holotemple
	building = {
		key = building_holotemple

		weight = {
			weight = 100.0

			modifier = {
				factor = 0.0

				OR = {
					controller = {
						OR = {
							has_monthly_income = { resource = energy value < 1 }
							ipa_missing_income_energy = yes
						}
					}
				}

			}

		}

	}

	# building: building_sacred_nexus
	building = {
		key = building_sacred_nexus

		weight = {
			weight = 100.0

			modifier = {
				factor = 0.0

				OR = {
					controller = {
						OR = {
							has_monthly_income = { resource = energy value < 1 }
							has_monthly_income = { resource = rare_crystals value < 1 }
							ipa_missing_income_energy = yes
							ipa_missing_income_rare_crystals = yes
						}
					}
				}

			}

		}

	}

	# building: building_citadel_of_faith
	building = {
		key = building_citadel_of_faith

		weight = {
			weight = 100.0

			modifier = {
				factor = 0.0

				OR = {
					controller = {
						OR = {
							has_monthly_income = { resource = energy value < 1 }
							has_monthly_income = { resource = rare_crystals value < 1 }
							ipa_missing_income_energy = yes
							ipa_missing_income_rare_crystals = yes
						}
					}
				}

			}

		}

	}

	# building: building_spawning_pool
	building = {
		key = building_spawning_pool

		weight = {
			weight = 190.0

			modifier = {
				factor = 0.0

				OR = {
					has_modifier = planet_population_control_gestalt
					owner = {
						OR = {
							ipa_allow_growth_buildings_organic = no
						}
					}
					controller = {
						OR = {
							has_monthly_income = { resource = energy value < 1 }
							ipa_missing_income_energy = yes
							AND = {
								is_lithoid_empire = no

								OR = {
									has_monthly_income = { resource = food value < 6 }
									ipa_missing_income_food = yes
								}

							}

							AND = {
								is_lithoid_empire = yes

								OR = {
									has_monthly_income = { resource = minerals value < 6 }
									ipa_missing_income_minerals = yes
								}

							}

						}
					}
				}

			}

		}

	}

	# building: building_robot_assembly_plant
	building = {
		key = building_robot_assembly_plant

		weight = {
			weight = 190.0

			modifier = {
				factor = 0.0

				OR = {
					has_modifier = planet_robot_assembly_control
					has_modifier = planet_population_control_gestalt
					owner = {
						OR = {
							ipa_allow_growth_buildings_robotic = no
						}
					}
					controller = {
						OR = {
							has_monthly_income = { resource = energy value < 1 }
							has_monthly_income = { resource = minerals value < 10 }
							ipa_missing_income_energy = yes
							ipa_missing_income_minerals = yes
						}
					}
				}

			}

		}

	}

	# building: building_machine_assembly_plant
	building = {
		key = building_machine_assembly_plant

		weight = {
			weight = 190.0

			modifier = {
				factor = 0.0

				OR = {
					has_modifier = planet_robot_assembly_control
					has_modifier = planet_population_control_gestalt
					owner = {
						OR = {
							ipa_allow_growth_buildings_robotic = no
						}
					}
					controller = {
						OR = {
							has_monthly_income = { resource = energy value < 1 }
							has_monthly_income = { resource = minerals value < 10 }
							ipa_missing_income_energy = yes
							ipa_missing_income_minerals = yes
						}
					}
				}

			}

		}

	}

	# building: building_clinic
	building = {
		key = building_clinic

		weight = {
			weight = 190.0

			modifier = {
				factor = 0.0

				OR = {
					has_modifier = planet_population_control
					has_modifier = planet_population_control_gestalt
					owner = {
						OR = {
							ipa_allow_growth_buildings_organic = no
						}
					}
					controller = {
						OR = {
							has_monthly_income = { resource = energy value < 2 }
							has_monthly_income = { resource = consumer_goods value < 2 }
							ipa_missing_income_energy = yes
						}
					}
				}

			}

		}

	}

	# building: building_hospital
	building = {
		key = building_hospital

		weight = {
			weight = 190.0

			modifier = {
				factor = 0.0

				OR = {
					has_modifier = planet_population_control
					owner = {
						OR = {
							ipa_allow_growth_buildings_organic = no
						}
					}
					controller = {
						OR = {
							has_monthly_income = { resource = energy value < 2 }
							has_monthly_income = { resource = exotic_gases value < 1 }
							has_monthly_income = { resource = consumer_goods value < 3 }
							ipa_missing_income_energy = yes
							ipa_missing_income_exotic_gases = yes
						}
					}
				}

			}

		}

	}

	# building: building_clone_vats
	building = {
		key = building_clone_vats

		weight = {
			weight = 190.0

			modifier = {
				factor = 0.0

				OR = {
					has_modifier = planet_population_control
					owner = {
						OR = {
							ipa_allow_growth_buildings_organic = no
						}
					}
					controller = {
						OR = {
							has_monthly_income = { resource = energy value < 2 }
							ipa_missing_income_energy = yes
						}
					}
				}

			}

		}

	}

	# building: building_supercomputer
	building = {
		key = building_supercomputer

		weight = {
			weight = 200.0

			# Disallow when not research designation or to many free jobs
			modifier = {
				factor = 0.0

				OR = {
					free_jobs > 0
					controller = {
						OR = {
							has_monthly_income = { resource = energy value <= 5 }
							ipa_missing_income_energy = yes
						}
					}

					# exclude specific production worlds
					OR = {
						ipa_has_designation_factory = yes
						ipa_has_designation_refinery = yes
						ipa_has_designation_forge = yes
					}

					# disallow if no research buildings
					AND = {
						num_buildings = { type = building_research_lab_1 value = 0 }
						num_buildings = { type = building_research_lab_2 value = 0 }
						num_buildings = { type = building_research_lab_3 value = 0 }
					}

					# non-gestalt empires require consumer goods for research
					AND = {
						owner = {
							AND = {
								is_gestalt = no
							}
						}

						OR = {
							controller = {
								OR = {
									has_monthly_income = { resource = consumer_goods value <= 4 }
									ipa_missing_income_consumer_goods = yes
								}
							}
						}

					}

					# gestalt empires require consumer goods for research
					AND = {
						owner = {
							AND = {
								is_gestalt = yes
							}
						}

						OR = {
							controller = {
								OR = {
									has_monthly_income = { resource = minerals value <= 6 }
									ipa_missing_income_minerals = yes
								}
							}
						}

					}

				}

			}

		}

	}

	# building: building_institute
	building = {
		key = building_institute

		weight = {
			weight = 200.0

			# Disallow when not research designation or to many free jobs
			modifier = {
				factor = 0.0

				OR = {
					free_jobs > 0
					controller = {
						OR = {
							has_monthly_income = { resource = energy value <= 5 }
							ipa_missing_income_energy = yes
						}
					}

					# exclude specific production worlds
					OR = {
						ipa_has_designation_factory = yes
						ipa_has_designation_refinery = yes
						ipa_has_designation_forge = yes
					}

					# disallow if no research buildings
					AND = {
						num_buildings = { type = building_research_lab_1 value = 0 }
						num_buildings = { type = building_research_lab_2 value = 0 }
						num_buildings = { type = building_research_lab_3 value = 0 }
					}

					# non-gestalt empires require consumer goods for research
					AND = {
						owner = {
							AND = {
								is_gestalt = no
							}
						}

						OR = {
							controller = {
								OR = {
									has_monthly_income = { resource = consumer_goods value <= 4 }
									ipa_missing_income_consumer_goods = yes
								}
							}
						}

					}

					# gestalt empires require consumer goods for research
					AND = {
						owner = {
							AND = {
								is_gestalt = yes
							}
						}

						OR = {
							controller = {
								OR = {
									has_monthly_income = { resource = minerals value <= 6 }
									ipa_missing_income_minerals = yes
								}
							}
						}

					}

				}

			}

		}

	}

	# building: building_research_lab_1
	building = {
		key = building_research_lab_1

		weight = {
			weight = 100.0

			# Disallow when: not research designation, to many free jobs or not enough income
			modifier = {
				factor = 0.0

				OR = {
					free_jobs > 0
					controller = {
						OR = {
							has_monthly_income = { resource = energy value <= 4 }
							ipa_missing_income_energy = yes
						}
					}

					# exclude specific production worlds
					OR = {
						ipa_has_designation_factory = yes
						ipa_has_designation_refinery = yes
						ipa_has_designation_forge = yes
					}

					# non-gestalt empires require consumer goods for research
					AND = {
						owner = {
							AND = {
								is_gestalt = no
							}
						}

						OR = {
							controller = {
								OR = {
									has_monthly_income = { resource = consumer_goods value <= 4 }
									ipa_missing_income_consumer_goods = yes
								}
							}
						}

					}

					# gestalt empires require consumer goods for research
					AND = {
						owner = {
							AND = {
								is_gestalt = yes
							}
						}

						OR = {
							controller = {
								OR = {
									has_monthly_income = { resource = minerals value <= 12 }
									ipa_missing_income_minerals = yes
								}
							}
						}

					}

				}

			}

		}

	}

	# building: building_research_lab_2
	building = {
		key = building_research_lab_2

		weight = {
			weight = 101.0

			# Disallow when: not research designation, to many free jobs or not enough income
			modifier = {
				factor = 0.0

				OR = {
					free_jobs > 0
					controller = {
						OR = {
							has_monthly_income = { resource = energy value <= 1 }
							has_monthly_income = { resource = exotic_gases value <= 1 }
							ipa_missing_income_energy = yes
							ipa_missing_income_exotic_gases = yes
						}
					}

					# exclude specific production worlds
					OR = {
						ipa_has_designation_factory = yes
						ipa_has_designation_refinery = yes
						ipa_has_designation_forge = yes
					}

					# non-gestalt empires require consumer goods for research
					AND = {
						owner = {
							AND = {
								is_gestalt = no
							}
						}

						OR = {
							controller = {
								OR = {
									has_monthly_income = { resource = consumer_goods value <= 6 }
									ipa_missing_income_consumer_goods = yes
								}
							}
						}

					}

					# gestalt empires require consumer goods for research
					AND = {
						owner = {
							AND = {
								is_gestalt = yes
							}
						}

						OR = {
							controller = {
								OR = {
									has_monthly_income = { resource = minerals value <= 18 }
									ipa_missing_income_minerals = yes
								}
							}
						}

					}

				}

			}

		}

	}

	# building: building_research_lab_3
	building = {
		key = building_research_lab_3

		weight = {
			weight = 102.0

			# Disallow when: not research designation, to many free jobs or not enough income
			modifier = {
				factor = 0.0

				OR = {
					free_jobs > 0
					controller = {
						OR = {
							has_monthly_income = { resource = energy value <= 1 }
							has_monthly_income = { resource = exotic_gases value <= 1 }
							ipa_missing_income_energy = yes
							ipa_missing_income_exotic_gases = yes
						}
					}

					# exclude specific production worlds
					OR = {
						ipa_has_designation_factory = yes
						ipa_has_designation_refinery = yes
						ipa_has_designation_forge = yes
					}

					# non-gestalt empires require consumer goods for research
					AND = {
						owner = {
							AND = {
								is_gestalt = no
							}
						}

						OR = {
							controller = {
								OR = {
									has_monthly_income = { resource = consumer_goods value <= 6 }
									ipa_missing_income_consumer_goods = yes
								}
							}
						}

					}

					# gestalt empires require consumer goods for research
					AND = {
						owner = {
							AND = {
								is_gestalt = yes
							}
						}

						OR = {
							controller = {
								OR = {
									has_monthly_income = { resource = minerals value <= 18 }
									ipa_missing_income_minerals = yes
								}
							}
						}

					}

				}

			}

		}

	}

	# district: district_generator
	district = {
		key = district_generator

		weight = {
			weight = 99.0

			# increase priority slightly if below desired resource income
			modifier = {
				factor = 1.02
				controller = {
					OR = {
						ipa_missing_income_energy = yes
					}
				}
			}

			# increase priority for planets with matching focus, slightly stronger than missing income to ensure districts are build by designations first
			modifier = {
				factor = 1.1
				ipa_has_designation_generator = yes
			}

			# Disallow for various conditions
			modifier = {
				factor = 0.0

				OR = {
					free_jobs > 0
				}

			}

		}

	}

	# district: district_rw_generator
	district = {
		key = district_rw_generator

		weight = {
			weight = 99.0

			# increase priority slightly if below desired resource income
			modifier = {
				factor = 1.02
				controller = {
					OR = {
						ipa_missing_income_energy = yes
					}
				}
			}

			# increase priority for planets with matching focus, slightly stronger than missing income to ensure districts are build by designations first
			modifier = {
				factor = 1.1
				ipa_has_designation_generator = yes
			}

			# Disallow for various conditions
			modifier = {
				factor = 0.0

				OR = {
					free_jobs > 0
				}

			}

		}

	}

	# district: district_hab_energy
	district = {
		key = district_hab_energy

		weight = {
			weight = 99.0

			# increase priority slightly if below desired resource income
			modifier = {
				factor = 1.02
				controller = {
					OR = {
						ipa_missing_income_energy = yes
					}
				}
			}

			# increase priority for planets with matching focus, slightly stronger than missing income to ensure districts are build by designations first
			modifier = {
				factor = 1.1
				ipa_has_designation_generator = yes
			}

			# Disallow for various conditions
			modifier = {
				factor = 0.0

				OR = {
					free_jobs > 0
				}

			}

		}

	}

	# district: district_generator_uncapped
	district = {
		key = district_generator_uncapped

		weight = {
			weight = 99.0

			# increase priority slightly if below desired resource income
			modifier = {
				factor = 1.02
				controller = {
					OR = {
						ipa_missing_income_energy = yes
					}
				}
			}

			# increase priority for planets with matching focus, slightly stronger than missing income to ensure districts are build by designations first
			modifier = {
				factor = 1.1
				ipa_has_designation_generator = yes
			}

			# Disallow for various conditions
			modifier = {
				factor = 0.0

				OR = {
					free_jobs > 0
				}

			}

		}

	}

	# district: district_farming
	district = {
		key = district_farming

		weight = {
			weight = 99.0

			# increase priority slightly if below desired resource income
			modifier = {
				factor = 1.02
				controller = {
					OR = {
						ipa_missing_income_food = yes
					}
				}
			}

			# increase priority for planets with matching focus, slightly stronger than missing income to ensure districts are build by designations first
			modifier = {
				factor = 1.1
				ipa_has_designation_farming = yes
			}

			# Disallow for various conditions
			modifier = {
				factor = 0.0

				OR = {
					free_jobs > 0
					owner = {
						OR = {
							ipa_country_uses_food = no
						}
					}
					controller = {
						OR = {
							ipa_missing_desired_income_food = no
						}
					}
				}

			}

		}

	}

	# district: district_rw_farming
	district = {
		key = district_rw_farming

		weight = {
			weight = 99.0

			# increase priority slightly if below desired resource income
			modifier = {
				factor = 1.02
				controller = {
					OR = {
						ipa_missing_income_food = yes
					}
				}
			}

			# increase priority for planets with matching focus, slightly stronger than missing income to ensure districts are build by designations first
			modifier = {
				factor = 1.1
				ipa_has_designation_farming = yes
			}

			# Disallow for various conditions
			modifier = {
				factor = 0.0

				OR = {
					free_jobs > 0
					owner = {
						OR = {
							ipa_country_uses_food = no
						}
					}
					controller = {
						OR = {
							ipa_missing_desired_income_food = no
						}
					}
				}

			}

		}

	}

	# district: district_farming_uncapped
	district = {
		key = district_farming_uncapped

		weight = {
			weight = 99.0

			# increase priority slightly if below desired resource income
			modifier = {
				factor = 1.02
				controller = {
					OR = {
						ipa_missing_income_food = yes
					}
				}
			}

			# increase priority for planets with matching focus, slightly stronger than missing income to ensure districts are build by designations first
			modifier = {
				factor = 1.1
				ipa_has_designation_farming = yes
			}

			# Disallow for various conditions
			modifier = {
				factor = 0.0

				OR = {
					free_jobs > 0
					owner = {
						OR = {
							ipa_country_uses_food = no
						}
					}
					controller = {
						OR = {
							ipa_missing_desired_income_food = no
						}
					}
				}

			}

		}

	}

	# district: district_mining
	district = {
		key = district_mining

		weight = {
			weight = 99.0

			# increase priority slightly if below desired resource income
			modifier = {
				factor = 1.02
				controller = {
					OR = {
						ipa_missing_income_minerals = yes
					}
				}
			}

			# increase priority for planets with matching focus, slightly stronger than missing income to ensure districts are build by designations first
			modifier = {
				factor = 1.1
				ipa_has_designation_mining = yes
			}

			# Disallow for various conditions
			modifier = {
				factor = 0.0

				OR = {
					free_jobs > 0
				}

			}

		}

	}

	# district: district_hab_mining
	district = {
		key = district_hab_mining

		weight = {
			weight = 99.0

			# increase priority slightly if below desired resource income
			modifier = {
				factor = 1.02
				controller = {
					OR = {
						ipa_missing_income_minerals = yes
					}
				}
			}

			# increase priority for planets with matching focus, slightly stronger than missing income to ensure districts are build by designations first
			modifier = {
				factor = 1.1
				ipa_has_designation_mining = yes
			}

			# Disallow for various conditions
			modifier = {
				factor = 0.0

				OR = {
					free_jobs > 0
				}

			}

		}

	}

	# district: district_mining_uncapped
	district = {
		key = district_mining_uncapped

		weight = {
			weight = 99.0

			# increase priority slightly if below desired resource income
			modifier = {
				factor = 1.02
				controller = {
					OR = {
						ipa_missing_income_minerals = yes
					}
				}
			}

			# increase priority for planets with matching focus, slightly stronger than missing income to ensure districts are build by designations first
			modifier = {
				factor = 1.1
				ipa_has_designation_mining = yes
			}

			# Disallow for various conditions
			modifier = {
				factor = 0.0

				OR = {
					free_jobs > 0
				}

			}

		}

	}

	# district: district_rw_science
	district = {
		key = district_rw_science

		weight = {
			weight = 99.0

			# increase priority for planets with matching focus
			modifier = {
				factor = 1.1
				ipa_has_designation_research = yes
			}

			# Disallow for various conditions
			modifier = {
				factor = 0.0

				OR = {
					free_jobs > 0
					controller = {
						OR = {
							ipa_missing_income_energy = yes
							ipa_missing_income_minerals = yes
						}
					}
				}

			}

		}

	}

	# district: district_hab_science
	district = {
		key = district_hab_science

		weight = {
			weight = 99.0

			# increase priority for planets with matching focus
			modifier = {
				factor = 1.1
				ipa_has_designation_research = yes
			}

			# Disallow for various conditions
			modifier = {
				factor = 0.0

				OR = {
					free_jobs > 0
					controller = {
						OR = {
							ipa_missing_income_energy = yes
							ipa_missing_income_minerals = yes
						}
					}
				}

			}

		}

	}

	# district: district_hab_cultural
	district = {
		key = district_hab_cultural

		weight = {
			weight = 99.0

			# increase priority for planets with matching focus
			modifier = {
				factor = 1.1
				ipa_has_designation_leisure = yes
			}

			# Disallow for various conditions
			modifier = {
				factor = 0.0

				OR = {
					free_jobs > 0
					ipa_has_designation_leisure = no
					controller = {
						OR = {
							ipa_missing_income_energy = yes
							ipa_missing_income_consumer_goods = yes
						}
					}
				}

			}

		}

	}

	# district: district_arcology_leisure
	district = {
		key = district_arcology_leisure

		weight = {
			weight = 99.0

			# increase priority for planets with matching focus
			modifier = {
				factor = 1.1
				ipa_has_designation_leisure = yes
			}

			# Disallow for various conditions
			modifier = {
				factor = 0.0

				OR = {
					free_jobs > 0
					ipa_has_designation_leisure = no
					controller = {
						OR = {
							ipa_missing_income_energy = yes
							ipa_missing_income_consumer_goods = yes
						}
					}
				}

			}

		}

	}

	# building: building_foundry_1
	building = {
		key = building_foundry_1

		weight = {
			weight = 100.0

			# increase priority slightly if below desired resource income
			modifier = {
				factor = 1.01
				controller = {
					OR = {
						ipa_missing_income_alloys = yes
					}
				}
			}

			# Disallow for various conditions
			modifier = {
				factor = 0.0

				OR = {
					ipa_has_designation_research = yes
					ipa_has_designation_refinery = yes
					ipa_has_designation_factory = yes
					ipa_has_designation_leisure = yes
					free_jobs > 0
					controller = {
						OR = {
							has_monthly_income = { resource = energy value <= 4 }
							has_monthly_income = { resource = minerals value <= 12 }
							ipa_missing_income_energy = yes
							ipa_missing_income_minerals = yes
							ipa_missing_desired_income_alloys = no
						}
					}
				}

			}

		}

	}

	# building: building_foundry_2
	building = {
		key = building_foundry_2

		weight = {
			weight = 101.0

			# increase priority slightly if below desired resource income
			modifier = {
				factor = 1.01
				controller = {
					OR = {
						ipa_missing_income_alloys = yes
					}
				}
			}

			# Disallow for various conditions
			modifier = {
				factor = 0.0

				OR = {
					ipa_has_designation_research = yes
					ipa_has_designation_refinery = yes
					ipa_has_designation_factory = yes
					ipa_has_designation_leisure = yes
					free_jobs > 0
					controller = {
						OR = {
							has_monthly_income = { resource = energy value <= 1 }
							has_monthly_income = { resource = minerals value <= 18 }
							has_monthly_income = { resource = volatile_motes value <= 1 }
							ipa_missing_income_energy = yes
							ipa_missing_income_minerals = yes
							ipa_missing_income_volatile_motes = yes
							ipa_missing_desired_income_alloys = no
						}
					}
				}

			}

		}

	}

	# building: building_foundry_3
	building = {
		key = building_foundry_3

		weight = {
			weight = 101.0

			# increase priority slightly if below desired resource income
			modifier = {
				factor = 1.01
				controller = {
					OR = {
						ipa_missing_income_alloys = yes
					}
				}
			}

			# Disallow for various conditions
			modifier = {
				factor = 0.0

				OR = {
					ipa_has_designation_research = yes
					ipa_has_designation_refinery = yes
					ipa_has_designation_factory = yes
					ipa_has_designation_leisure = yes
					free_jobs > 0
					controller = {
						OR = {
							has_monthly_income = { resource = energy value <= 1 }
							has_monthly_income = { resource = minerals value <= 18 }
							has_monthly_income = { resource = volatile_motes value <= 1 }
							ipa_missing_income_energy = yes
							ipa_missing_income_minerals = yes
							ipa_missing_income_volatile_motes = yes
							ipa_missing_desired_income_alloys = no
						}
					}
				}

			}

		}

	}

	# building: building_factory_1
	building = {
		key = building_factory_1

		weight = {
			weight = 100.0

			# increase priority slightly if below desired resource income
			modifier = {
				factor = 1.01
				controller = {
					OR = {
						ipa_missing_income_consumer_goods = yes
					}
				}
			}

			# Disallow for various conditions
			modifier = {
				factor = 0.0

				OR = {
					ipa_has_designation_research = yes
					ipa_has_designation_refinery = yes
					ipa_has_designation_forge = yes
					free_jobs > 0
					owner = {
						OR = {
							ipa_country_uses_consumer_goods = no
						}
					}
					controller = {
						OR = {
							has_monthly_income = { resource = energy value <= 4 }
							has_monthly_income = { resource = minerals value <= 12 }
							ipa_missing_income_energy = yes
							ipa_missing_income_minerals = yes
							ipa_missing_desired_income_consumer_goods = no
						}
					}
				}

			}

		}

	}

	# building: building_factory_2
	building = {
		key = building_factory_2

		weight = {
			weight = 101.0

			# increase priority slightly if below desired resource income
			modifier = {
				factor = 1.01
				controller = {
					OR = {
						ipa_missing_income_consumer_goods = yes
					}
				}
			}

			# Disallow for various conditions
			modifier = {
				factor = 0.0

				OR = {
					ipa_has_designation_research = yes
					ipa_has_designation_refinery = yes
					ipa_has_designation_forge = yes
					free_jobs > 0
					owner = {
						OR = {
							ipa_country_uses_consumer_goods = no
						}
					}
					controller = {
						OR = {
							has_monthly_income = { resource = energy value <= 1 }
							has_monthly_income = { resource = minerals value <= 18 }
							has_monthly_income = { resource = rare_crystals value <= 1 }
							ipa_missing_income_energy = yes
							ipa_missing_income_minerals = yes
							ipa_missing_income_rare_crystals = yes
							ipa_missing_desired_income_consumer_goods = no
						}
					}
				}

			}

		}

	}

	# building: building_factory_3
	building = {
		key = building_factory_3

		weight = {
			weight = 102.0

			# increase priority slightly if below desired resource income
			modifier = {
				factor = 1.01
				controller = {
					OR = {
						ipa_missing_income_consumer_goods = yes
					}
				}
			}

			# Disallow for various conditions
			modifier = {
				factor = 0.0

				OR = {
					ipa_has_designation_research = yes
					ipa_has_designation_refinery = yes
					ipa_has_designation_forge = yes
					free_jobs > 0
					owner = {
						OR = {
							ipa_country_uses_consumer_goods = no
						}
					}
					controller = {
						OR = {
							has_monthly_income = { resource = energy value <= 1 }
							has_monthly_income = { resource = minerals value <= 18 }
							has_monthly_income = { resource = rare_crystals value <= 1 }
							ipa_missing_income_energy = yes
							ipa_missing_income_minerals = yes
							ipa_missing_income_rare_crystals = yes
							ipa_missing_desired_income_consumer_goods = no
						}
					}
				}

			}

		}

	}

	# building: building_hydroponics_farm
	building = {
		key = building_hydroponics_farm

		weight = {
			weight = 99.0

			modifier = {
				factor = 0.0

				OR = {
					ipa_has_designation_farming = no
					free_jobs > 0
					owner = {
						OR = {
							check_variable = { which = ipa_options_allow_agri_farm_buildings value = 0 }
						}
					}
					controller = {
						OR = {
							has_monthly_income = { resource = energy value <= 2 }
							ipa_missing_income_energy = yes
						}
					}
				}

			}

		}

	}

	# building: building_chemical_plant
	building = {
		key = building_chemical_plant

		weight = {
			weight = 100.0

			# increase priority slightly if below desired resource income
			modifier = {
				factor = 1.01
				controller = {
					OR = {
						ipa_missing_income_volatile_motes = yes
					}
				}
			}

			# Disallow if to many free jobs or above desired income
			modifier = {
				factor = 0.0

				OR = {
					free_jobs > 0
					ipa_has_designation_research = yes
					controller = {
						OR = {
							ipa_missing_desired_income_volatile_motes = no
						}
					}
				}

			}

		}

	}

	# building: building_refinery
	building = {
		key = building_refinery

		weight = {
			weight = 100.0

			# increase priority slightly if below desired resource income
			modifier = {
				factor = 1.01
				controller = {
					OR = {
						ipa_missing_income_exotic_gases = yes
					}
				}
			}

			# Disallow for various conditions
			modifier = {
				factor = 0.0

				OR = {
					free_jobs > 0
					ipa_has_designation_research = yes
					controller = {
						OR = {
							ipa_missing_desired_income_exotic_gases = no
						}
					}
				}

			}

		}

	}

	# building: building_crystal_plant
	building = {
		key = building_crystal_plant

		weight = {
			weight = 100.0

			# increase priority slightly if below desired resource income
			modifier = {
				factor = 1.01
				controller = {
					OR = {
						ipa_missing_income_rare_crystals = yes
					}
				}
			}

			# Disallow for various conditions
			modifier = {
				factor = 0.0

				OR = {
					free_jobs > 0
					ipa_has_designation_research = yes
					controller = {
						OR = {
							ipa_missing_desired_income_rare_crystals = no
						}
					}
				}

			}

		}

	}

	# building: building_mote_harvesters
	building = {
		key = building_mote_harvesters

		weight = {
			weight = 100.0

			# increase priority slightly if below desired resource income
			modifier = {
				factor = 1.01
				controller = {
					OR = {
						ipa_missing_income_volatile_motes = yes
					}
				}
			}

			# Disallow if to many free jobs
			modifier = {
				factor = 0.0
				free_jobs > 0
			}

		}

	}

	# building: building_gas_extractors
	building = {
		key = building_gas_extractors

		weight = {
			weight = 100.0

			# increase priority slightly if below desired resource income
			modifier = {
				factor = 1.01
				controller = {
					OR = {
						ipa_missing_income_exotic_gases = yes
					}
				}
			}

			# Disallow if to many free jobs
			modifier = {
				factor = 0.0
				free_jobs > 0
			}

		}

	}

	# building: building_crystal_mines
	building = {
		key = building_crystal_mines

		weight = {
			weight = 100.0

			# increase priority slightly if below desired resource income
			modifier = {
				factor = 1.01
				controller = {
					OR = {
						ipa_missing_income_rare_crystals = yes
					}
				}
			}

			# Disallow if to many free jobs
			modifier = {
				factor = 0.0
				free_jobs > 0
			}

		}

	}

	# building: building_mineral_purification_plant
	building = {
		key = building_mineral_purification_plant

		weight = {
			weight = 200.0

			modifier = {
				factor = 0.0

				OR = {
					free_jobs > 0

					# Disallow if not enough districts build
					NOR = {
						num_districts = { type = district_mining value >= 1 }
						num_districts = { type = district_hab_mining value >= 1 }
						num_districts = { type = district_mining_uncapped value >= 1 }
					}

				}

			}

		}

	}

	# building: building_mineral_purification_hub
	building = {
		key = building_mineral_purification_hub

		weight = {
			weight = 201.0

			modifier = {
				factor = 0.0

				OR = {
					controller = {
						OR = {
							has_monthly_income = { resource = energy value <= 1 }
							has_monthly_income = { resource = volatile_motes value <= 1 }
							ipa_missing_income_volatile_motes = yes
						}
					}
				}

			}

		}

	}

	# building: building_energy_grid
	building = {
		key = building_energy_grid

		weight = {
			weight = 200.0

			modifier = {
				factor = 0.0

				OR = {
					free_jobs > 0

					# Disallow if not enough districts build
					NOR = {
						num_districts = { type = district_generator value >= 1 }
						num_districts = { type = district_rw_generator value >= 1 }
						num_districts = { type = district_hab_energy value >= 1 }
						num_districts = { type = district_generator_uncapped value >= 1 }
					}

				}

			}

		}

	}

	# building: building_energy_nexus
	building = {
		key = building_energy_nexus

		weight = {
			weight = 201.0

			modifier = {
				factor = 0.0

				OR = {
					controller = {
						OR = {
							has_monthly_income = { resource = energy value <= 1 }
							has_monthly_income = { resource = exotic_gases value <= 1 }
							ipa_missing_income_exotic_gases = yes
						}
					}
				}

			}

		}

	}

	# building: building_food_processing_facility
	building = {
		key = building_food_processing_facility

		weight = {
			weight = 200.0

			modifier = {
				factor = 0.0

				OR = {
					free_jobs > 0
					owner = {
						OR = {
							ipa_country_uses_food = no
						}
					}

					# Disallow if not enough districts build
					NOR = {
						num_districts = { type = district_farming value >= 1 }
						num_districts = { type = district_rw_farming value >= 1 }
						num_districts = { type = district_farming_uncapped value >= 1 }
					}

				}

			}

		}

	}

	# building: building_food_processing_center
	building = {
		key = building_food_processing_center

		weight = {
			weight = 201.0

			modifier = {
				factor = 0.0

				OR = {
					owner = {
						OR = {
							ipa_country_uses_food = no
						}
					}
					controller = {
						OR = {
							has_monthly_income = { resource = energy value <= 1 }
							has_monthly_income = { resource = volatile_motes value <= 1 }
							ipa_missing_income_volatile_motes = yes
						}
					}
				}

			}

		}

	}

	# building: building_fortress
	building = {
		key = building_fortress

		weight = {
			weight = 99.0

			modifier = {
				factor = 0.0

				OR = {
					owner = {
						OR = {
							check_variable = { which = ipa_options_allow_upgrade_strongholds value = 0 }
						}
					}
					controller = {
						OR = {
							has_monthly_income = { resource = energy value <= 1 }
							has_monthly_income = { resource = volatile_motes value <= 1 }
							ipa_missing_income_volatile_motes = yes
						}
					}
				}

			}

		}

	}

}

