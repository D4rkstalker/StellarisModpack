# Throng Queen Synapse - Relic Effect
decision_deploy_throng_relic = {
	owned_planets_only = yes
	sound = event_laboratory_sound
	icon = descision_progenitor_empty

	enactment_time = 10

	potential = {
		exists = owner
		owner = {
			has_country_flag = not_used_throng_relic	# Decision not enacted yet
			has_country_flag = throng_relic_activated	# Relic activated
		}
	}

	allow = { }

	effect = {
		custom_tooltip = decision_deploy_throng_relic_effects
		hidden_effect = {
			if = {
				limit = { owner = { is_gestalt = no }}
				throng_relic_effect = yes
			}
			else_if = {
				limit = { owner = { is_gestalt = yes }}
				throng_relic_effect_gestalt = yes
			}
			else = {
				throng_relic_effect = yes
			}
		}
	}

	on_queued = {
		owner = { remove_country_flag = not_used_throng_relic }
	}

	on_unqueued = {
		owner = { set_country_flag = not_used_throng_relic }
	}

	ai_weight = {
		weight = 100
	}
}

# Enact Lockdown
decision_projcrim_lockdown = {
	owned_planets_only = yes
	sound = event_default
	icon = decision_penal_colony

	resources = {
		category = decisions
		cost = {
			unity = 50
		}
	}
	enactment_time = 3

	potential = {
		exists = owner
		owner = {
			has_event_chain = projcrim_main_chain
			NOT = { has_country_flag = projcrim_plague_cured }
		}
		NOT = { has_planet_flag = projcrim_lockdown_active }
	}

	effect = {
		add_modifier = {
			modifier = projcrim_lockdown
		}
		hidden_effect = {
			set_planet_flag = projcrim_lockdown_active
		}
	}
}

# Disable Lockdown
decision_projcrim_lockdown_undo = {
	owned_planets_only = yes
	sound = event_default
	icon = decision_alien_propaganda

	potential = {
		exists = owner
		owner = {
			has_event_chain = projcrim_main_chain
			NOT = { has_country_flag = projcrim_plague_cured }
		}
		has_planet_flag = projcrim_lockdown_active
	}

	effect = {
		remove_modifier = projcrim_lockdown
		hidden_effect = {
			remove_planet_flag = projcrim_lockdown_active
		}
	}
}

# Hunt Down the Infected
decision_projcrim_hunt = {
	owned_planets_only = yes
	sound = event_default
	icon = decision_martial_law_hive

	enactment_time = 60
	resources = {
		category = decisions
		cost = {
			energy = 1000
		}
	}

	potential = {
		exists = owner
		owner = {
			has_event_chain = projcrim_main_chain
			NOT = { has_country_flag = projcrim_plague_cured }
		}
		NOT = { has_planet_flag = projcrim_recent_hunt }
	}

	allow = {
		custom_tooltip = decision_projcrim_hunt_req
		any_owned_pop = {
			pop_has_trait = trait_crimson_infected
			NOT = { has_pop_flag = projcrim_contained_flag }
		}
	}

	effect = {
		custom_tooltip = decision_projcrim_hunt_effects
		hidden_effect = {
			set_timed_planet_flag = {
				flag = projcrim_recent_hunt
				days = 360
			}
			planet_event = {
				id = projcrim_unrest.50
			}
		}
	}
}

# Purify World
decision_projcrim_purify = {
	owned_planets_only = yes
	sound = event_laboratory_sound
	icon = decision_consecrated_worlds

	resources = {
		category = decisions
		cost = {
			energy = 2000
		}
	}
	enactment_time = 180

	potential = {
		exists = owner
		owner = {
			NOT = { is_country_type = throng_country }
			root.controller = { is_same_value = prev }
		}
		is_planet_class = pc_projcrim_afflicted
	}

	allow = {
		custom_tooltip = projcrim_plague_cured
		owner = {
			has_country_flag = projcrim_plague_cured
		}
	}

	effect = {
		custom_tooltip = pc_restored
		hidden_effect = {
			restore_pc = yes
			# Mark as no longer afflicted
			remove_planet_flag = throng_occupied_world
			remove_planet_flag = throng_afflicted_world
			# Updates tracked variables
			random_country = {
				limit = {
					is_country_type = global_event
				}
				subtract_variable = {
					which = projcrim_throng_worlds
					value = 1
				}
			}
			every_playable_country = {
				limit = { has_event_chain = "projcrim_main_chain" }
				add_event_chain_counter = {
					event_chain = projcrim_main_chain
					counter = afflicted_worlds
					amount = -1
				}
			}
		}
	}

	ai_weight = {
		weight = 99999
	}
}