#PATCHED: Job priority
biomass_processor_drone = {
	category = simple_drone
	condition_string = DRONE_JOB_TRIGGER
	building_icon = building_biomass_furnace

	possible = {
		drone_job_check_trigger = yes
	}

	resources = {
		category = planet_labourers
		produces = {
			minerals = 1
			energy = 2
			sr_biomass = 1
		}
	}

	weight = {
		modifier = { 
			factor = 50 
			has_trait = trait_priority_minerals
			}
		modifier = { 
			factor = 0.1 
			has_trait = trait_negative_priority_minerals
			}
		modifier = { 
			factor = 50 
			has_trait = trait_priority_energy
			}
		modifier = { 
			factor = 0.1 
			has_trait = trait_negative_priority_energy
			}

		weight = @simple_drone_job_weight
		modifier = {
			factor = 1.1
			exists = owner
			owner = {
				has_monthly_income = {
					resource = sr_biomass
					value < 0
				}
			}
		}
		modifier = {
			factor = 0.2
			exists = owner
			owner = {
				has_monthly_income = {
					resource = sr_biomass
					value > 10
				}
			}
		}
		modifier = {
			factor = 2
			has_job = biomass_processor_drone
		}
		modifier = {
			factor = 1.1
			exists = owner
			years_passed < 1
			owner = { has_valid_civic = civic_machine_assimilator }
			has_trait = trait_cybernetic
		}
	}
}

fuel_processor_drone = {
	category = simple_drone
	condition_string = DRONE_JOB_TRIGGER
	building_icon = building_fuel_sourcer

	possible = {
		drone_job_check_trigger = yes
	}

	resources = {
		category = planet_labourers
		produces = {
			minerals = 3
			sr_natural_fuels = 1
		}
	}

	weight = {
		modifier = { 
			factor = 50 
			has_trait = trait_priority_minerals
			}
		modifier = { 
			factor = 0.1 
			has_trait = trait_negative_priority_minerals
			}

		weight = @simple_drone_job_weight
		modifier = {
			factor = 1.8
			OR = {
				has_trait = trait_industrious
				has_trait = trait_robot_power_drills
			}
		}
		modifier = {
			factor = 1.1
			exists = owner
			owner = {
				has_monthly_income = {
					resource = sr_natural_fuels
					value < 0
				}
			}
		}
		modifier = {
			factor = 0.2
			exists = owner
			owner = {
				has_monthly_income = {
					resource = sr_natural_fuels
					value > 100
				}
			}
		}
		modifier = {
			factor = 2
			has_job = fuel_processor_drone
		}
		modifier = {
			factor = 1.1
			exists = owner
			years_passed < 1
			owner = { has_valid_civic = civic_machine_assimilator }
			has_trait = trait_cybernetic
		}
	}
}

water_processor_drone = {
	category = simple_drone
	condition_string = DRONE_JOB_TRIGGER
	building_icon = building_desalinator

	possible = {
		drone_job_check_trigger = yes
	}

	resources = {
		category = planet_labourers
		produces = {
			sr_ice = 1
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { is_hive_empire = yes }
		}
		modifier = {
			planet_amenities_no_happiness_add = 2
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { is_hive_empire = yes }
			has_trait = trait_charismatic
		}
		modifier = {
			planet_amenities_no_happiness_add = 0.4
		}
	}
	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { is_hive_empire = yes }
			has_trait = trait_repugnant
		}
		modifier = {
			planet_amenities_no_happiness_add = -0.4
		}
	}

	weight = {
		modifier = { 
			factor = 50 
			has_trait = trait_priority_amenities
			}
		modifier = { 
			factor = 0.1 
			has_trait = trait_negative_priority_amenities
			}

		weight = @simple_drone_job_weight
		modifier = {
			factor = 1.1
			exists = owner
			owner = {
				has_monthly_income = {
					resource = sr_ice
					value < 0
				}
			}
		}
		modifier = {
			factor = 0.2
			exists = owner
			owner = {
				has_monthly_income = {
					resource = sr_ice
					value > 10
				}
			}
		}
		modifier = {
			factor = 2
			has_job = water_processor_drone
		}
		modifier = {
			factor = 1.1
			exists = owner
			years_passed < 1
			owner = { has_valid_civic = civic_machine_assimilator }
			has_trait = trait_cybernetic
		}
	}
}

actinides_utiliser_drone = {
	category = complex_drone
	condition_string = DRONE_JOB_TRIGGER
	building_icon = building_nuclear_plant

	possible = {
		drone_job_check_trigger = yes
	}

	resources = {
		category = planet_technician
		produces = {
			energy = 6
			physics_research = 3
		}
	}

	weight = {
		modifier = { 
			factor = 50 
			has_trait = trait_priority_energy
			}
		modifier = { 
			factor = 0.1 
			has_trait = trait_negative_priority_energy
			}
		modifier = { 
			factor = 50 
			has_trait = trait_priority_physics_research
			}
		modifier = { 
			factor = 0.1 
			has_trait = trait_negative_priority_physics_research
			}

		weight = @complex_drone_job_weight
		modifier = {
			factor = 3
			has_job = actinides_utiliser_drone
		}
	}
}

biomass_architect_drone = {
	category = complex_drone
	condition_string = DRONE_JOB_TRIGGER
	building_icon = building_processedgoods_producer

	possible = {
		drone_job_check_trigger = yes
	}

	resources = {
		category = planet_artisans
		produces = {
			minerals = 1
			sr_plastics = 1
		}
		produces = {
			trigger = {
				exists = owner
				owner = {
					resource_stockpile_compare = {
						resource = sr_biomass
						value >= 3
					}
				}
			}
			minerals = 1
			sr_plastics = 1
		}
		upkeep = {
			sr_biomass = 3
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				resource_stockpile_compare = {
					resource = sr_biomass
					value >= 3
				}
			}
		}
		modifier = {
			planet_building_build_speed_mult = 0.2
		}
	}

	weight = {
		modifier = { 
			factor = 50 
			has_trait = trait_priority_minerals
			}
		modifier = { 
			factor = 0.1 
			has_trait = trait_negative_priority_minerals
			}

		weight = @complex_drone_job_weight
		modifier = {
			factor = 3
			has_job = biomass_architect_drone
		}
	}
}

altalloys_drone = {
	category = complex_drone
	condition_string = DRONE_JOB_TRIGGER
	building_icon = building_foundry_1

	possible = {
		drone_job_check_trigger = yes
	}

	resources = {
		category = planet_metallurgists
		produces = {
			alloys = 2
		}
		produces = {
			trigger = {
				exists = owner
				owner = {
					resource_stockpile_compare = {
						resource = sr_plastics
						value >= 10
					}
					resource_stockpile_compare = {
						resource = rare_crystals
						value >= 1
					}
				}
			}
			alloys = 3
		}
	}

	weight = {
		modifier = { 
			factor = 50 
			has_trait = trait_priority_alloys
			}
		modifier = { 
			factor = 0.1 
			has_trait = trait_negative_priority_alloys
			}

		weight = @complex_drone_job_weight
		modifier = {
           factor = 2
           has_trait = trait_robot_efficient_processors
        }
		modifier = {
			factor = 2
			has_job = altalloys_drone
		}
		modifier = {
			factor = 0.8
			exists = owner
			owner = {
				has_monthly_income = {
					resource = sr_plastics
					value < 20
				}
			}
		}
		modifier = {
			factor = 0.8
			exists = owner
			owner = {
				has_monthly_income = {
					resource = rare_crystals
					value < 2
				}
			}
		}
		modifier = {
			factor = 1.5
			exists = owner
			owner = {
				has_monthly_income = {
					resource = alloys
					value < 15
				}
			}
		}
		modifier = {
			factor = 1.2
			exists = owner
			owner = {
				has_monthly_income = {
					resource = alloys
					value < 40
				}
			}
		}
	}
}

electronics_manufacturer_drone = {
	category = complex_drone
	condition_string = DRONE_JOB_TRIGGER
	building_icon = building_foundry_1

	possible = {
		drone_job_check_trigger = yes
	}

	resources = {
		category = planet_artisans
		produces = {
			sr_electronics = 2
		}
		upkeep = {
			trigger = {
				owner = {
					resource_stockpile_compare = {
						resource = alloys
						value >= 1
					}
				}
			}
			alloys = 1
		}
		upkeep = {
			trigger = {
				owner = {
					resource_stockpile_compare = {
						resource = alloys
						value < 1
					}
				}
			}
			minerals = 5
		}
	}

	weight = {

		weight = @complex_drone_job_weight
		modifier = {
           factor = 2
           has_trait = trait_robot_efficient_processors
        }
		modifier = {
			factor = 2
			has_job = electronics_manufacturer_drone
		}
	}
}

