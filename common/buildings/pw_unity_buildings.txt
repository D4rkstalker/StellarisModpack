pw_building_pavilion_of_wonders = {
	base_buildtime = @pw_building_buildtime
	position_priority = 120
	category = unity
	base_cap_amount = 1
	can_be_ruined = no

	prerequisites = {
		pw_tech_great_art_exhibition
	}

	potential = {
		exists = owner
		owner = { is_gestalt = no }
		NOT = { has_modifier = slave_colony }
		OR = {
			NOT = { is_planet_class = pc_habitat }
			owner = { has_ascension_perk = ap_voidborn }
		}
	}

	allow = {
		has_major_upgraded_capital = yes
		free_district_slots > 0 # Needs a free district to occupy
		pw_can_build_planetary_wonder = yes #Check if there is space for the Wonder
	}

	resources = {
		category = planet_buildings
		cost = {
			minerals = @pw_building_cost
			exotic_gases = @pw_building_cost_rare
		}
		cost = {
			trigger = {
				planet = {
					pw_has_any_planetary_wonder = yes
				}
			}
			minerals = @pw_building_cost_extra
		}
		cost = {
			trigger = {
				planet = {
					OR = {
						has_designation = col_resort
						has_designation = col_habitat_leisure
					}
				}
			}
			minerals = @pw_building_cost_discount
		}
		upkeep = {
			energy = @pw_building_upkeep
			exotic_gases = @pw_building_upkeep_rare_1
		}
		upkeep = {
			trigger = {
				planet = {
					pw_has_any_additional_planetary_wonder = yes
				}
			}
			energy = @pw_building_upkeep_extra
		}
		upkeep = {
			trigger = {
				exists = owner
				owner = {
					has_edict = pw_ambition_wonders_beyond_ambition
				}
			}
			energy = @pw_building_upkeep_ambition
		}
		upkeep = {
			trigger = {
				planet = {
					OR = {
						has_designation = col_resort
						has_designation = col_habitat_leisure
					}
				}
			}
			energy = @pw_building_upkeep_discount
		}
	}

	destroy_trigger = {
		OR = {
			has_modifier = slave_colony
			AND = {
				exists = owner
				owner = { is_gestalt = yes }
			}
		}
	}

	convert_to = {
		building_heritage_site
		building_holotemple
		building_simulation_2
		building_hive_cluster
		building_corporate_site
		building_galactic_memorial_2
	}

	upgrades = {
		pw_building_fair_of_worlds
		pw_building_museum_of_the_grotesque
	}

	planet_modifier = {
		planet_max_districts_add = -1
	}

	#Reminder: Cannot be Gestalt!

	#Administrator
	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { is_megacorp = no }
		}
		modifier = {
			job_administrator_add = 1
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { is_megacorp = yes }
		}
		modifier = {
			job_merchant_add = 1
		}
	}

	#Culture Workers
	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { is_megacorp = no }
		}
		modifier = {
			job_culture_worker_per_pop = @pw_job_per_25_pop
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { is_megacorp = yes }
		}
		modifier = {
			job_manager_per_pop = @pw_job_per_25_pop
		}
	}

	#Death Chroniclers
	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_valid_civic = civic_memorialist }
		}
		modifier = {
			job_death_chronicler_add = 1
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { is_megacorp = no }
			NOT = { owner = { has_valid_civic = civic_memorialist }}
		}
		modifier = {
			job_culture_worker_add = 1
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { is_megacorp = yes }
			NOT = { owner = { has_valid_civic = civic_memorialist }}
		}
		modifier = {
			job_manager_add = 1
		}
	}

	#Tourists
	# triggered_planet_modifier = {
	# 	potential = {
	# 		has_modifier = resort_colony
	# 	}
	# 	modifier = {
	# 		job_pw_tourist_per_pop = @pw_job_per_25_pop
	# 	}
	# }

	#Entertainers
	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				NOT = { has_valid_civic = civic_warrior_culture }
			}
		}
		modifier = {
			job_entertainer_add = 2
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				has_valid_civic = civic_warrior_culture
			}
		}
		modifier = {
			job_duelist_add = 2
		}
	}

	#Stability
	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_edict = pw_ambition_monumentality }
		}
		modifier = {
			planet_stability_add = @pw_stability_production
		}
	}

	#Ambition Bonus
	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { is_megacorp = no }
			owner = { has_edict = pw_ambition_wonders_beyond_ambition }
		}
		modifier = {
			planet_jobs_unity_produces_mult = 0.10
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { is_megacorp = yes }
			owner = { has_edict = pw_ambition_wonders_beyond_ambition }
		}
		modifier = {
			trade_value_mult = 0.10
		}
	}

	triggered_desc = {
		text = pw_planet_wonder_lb
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = { is_megacorp = no }
		}
		text = job_administrator_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = { is_megacorp = yes }
		}
		text = job_merchant_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = { is_megacorp = no }
		}
		text = job_culture_worker_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = { is_megacorp = yes }
		}
		text = job_manager_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = { has_valid_civic = civic_memorialist }
		}
		text = job_death_chronicler_effect_desc
	}

	# triggered_desc = {
	# 	trigger = {
	# 		has_modifier = resort_colony
	# 	}
	# 	text = job_pw_tourist_effect_desc
	# }

	triggered_desc = {
		trigger = {
			exists = owner
			owner = {
				NOT = { has_valid_civic = civic_warrior_culture }
			}
		}
		text = job_entertainer_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = {
				has_valid_civic = civic_warrior_culture
			}
		}
		text = job_duelist_effect_desc
	}

	on_built = {
		planet_event = { id = pw_wonder.1400 }
	}

	ai_weight = {
		weight = 25
		modifier = {
			factor = 0
			buildings_has_exotic_gases = no
			building_relaxed_basic_income_check = no
			owner = {
				OR = {
					AND = {
						country_uses_consumer_goods = yes
						has_monthly_income = {
							resource = consumer_goods
							value < 5
						}
					}
					AND = {
						country_uses_consumer_goods = no
						has_monthly_income = {
							resource = minerals
							value < 75
						}
					}
				}
			}
		}
		modifier = {
			factor = 0.25
			free_building_slots < 1
			free_district_slots < 1
		}
		modifier = {
			factor = 0.25
			pw_has_any_planetary_wonder = yes
			exists = owner
			NOT = { owner = { has_ascension_perk = pw_ap_planetary_wonders }}
			NOT = { has_active_building = pw_building_pavilion_of_wonders }
			NOT = { has_building_construction = pw_building_pavilion_of_wonders }
		}
		modifier = {
			factor = 2
			has_designation = col_resort
		}
		modifier = {
			factor = 2
			is_capital = yes
		}
		modifier = {
			factor = 2
			exists = owner
			owner = {
				OR = {
					is_xenophile = yes
					is_xenophobe = yes
				}
			}
		}
		modifier = {
			factor = 2
			exists = owner
			owner = {
				OR = {
					has_ethic = ethic_fanatic_xenophile
					has_ethic = ethic_fanatic_xenophobe
				}
			}
		}
		modifier = {
			factor = 5
			exists = owner
			owner = {
				any_owned_planet = {
					NOT = { is_planet = root }
					OR = {
						has_active_building = pw_building_pavilion_of_wonders
						has_active_building = pw_building_fair_of_worlds
						has_active_building = pw_building_museum_of_the_grotesque
					}
				}
			}
		}
		modifier = {
			factor = 2
			exists = owner
			owner = {
				OR = {
					has_megastructure = mega_art_installation_2
					has_megastructure = mega_art_installation_3
					has_megastructure = mega_art_installation_4
					has_megastructure = mega_art_installation_restored
					has_megastructure = mega_art_installation_restored_2
				}
			}
		}
	}
}

pw_building_fair_of_worlds = {
	base_buildtime = @pw_building_buildtime
	position_priority = 110
	category = unity
	can_be_ruined = no
	can_build = no #Only upgrades

	prerequisites = {
		pw_tech_xeno_art_integration
	}

	potential = {
		exists = owner
		owner = { is_gestalt = no }
		NOT = { has_modifier = slave_colony }
		OR = {
			NOT = { is_planet_class = pc_habitat }
			owner = { has_ascension_perk = ap_voidborn }
		}
	}

	allow = {
		#Upgrade Wonders don't check for districts or availability
		owner = { is_xenophile = yes }
		has_major_upgraded_capital = yes

		# Empire Unique:
		pw_is_wonder_empire_unique = { WONDER = pw_building_fair_of_worlds }
	}

	resources = {
		category = planet_buildings
		cost = {
			minerals = @pw_building_cost
			rare_crystals = @pw_building_cost_rare
		}
		cost = {
			trigger = {
				planet = {
					pw_has_any_additional_planetary_wonder = yes
				}
			}
			minerals = @pw_building_cost_extra
		}
		cost = {
			trigger = {
				planet = {
					OR = {
						has_designation = col_resort
						has_designation = col_habitat_leisure
					}
				}
			}
			minerals = @pw_building_cost_discount
		}
		upkeep = {
			energy = @pw_building_upkeep_expensive
			rare_crystals = @pw_building_upkeep_rare_1
		}
		upkeep = {
			trigger = {
				planet = {
					pw_has_any_additional_planetary_wonder = yes
				}
			}
			energy = @pw_building_upkeep_extra
		}
		upkeep = {
			trigger = {
				exists = owner
				owner = {
					has_edict = pw_ambition_wonders_beyond_ambition
				}
			}
			energy = @pw_building_upkeep_ambition
		}
		upkeep = {
			trigger = {
				planet = {
					OR = {
						has_designation = col_resort
						has_designation = col_habitat_leisure
					}
				}
			}
			energy = @pw_building_upkeep_discount
		}
	}

	destroy_trigger = {
		OR = {
			has_modifier = slave_colony
			AND = {
				exists = owner
				owner = { is_gestalt = yes }
			}
			AND = {
				exists = owner
				owner = { is_xenophile = no }
			}
		}
	}

	convert_to = {
		pw_building_pavilion_of_wonders
		pw_building_museum_of_the_grotesque
		building_heritage_site
		building_holotemple
		building_simulation_2
		building_hive_cluster
		building_corporate_site
		building_galactic_memorial_2
	}

	planet_modifier = {
		planet_max_districts_add = -1
	}

	#Reminder: Cannot be Gestalt and must be xenophile!

	#Administrator
	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { is_megacorp = no }
		}
		modifier = {
			job_administrator_add = 1
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { is_megacorp = yes }
		}
		modifier = {
			job_merchant_add = 1
		}
	}

	#Culture Workers
	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { is_megacorp = no }
		}
		modifier = {
			job_culture_worker_per_pop = @pw_job_per_25_pop
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { is_megacorp = yes }
		}
		modifier = {
			job_manager_per_pop = @pw_job_per_25_pop
		}
	}

	#Death Chroniclers
	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_valid_civic = civic_memorialist }
		}
		modifier = {
			job_death_chronicler_add = 2
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { is_megacorp = no }
			NOT = { owner = { has_valid_civic = civic_memorialist }}
		}
		modifier = {
			job_culture_worker_add = 2
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { is_megacorp = yes }
			NOT = { owner = { has_valid_civic = civic_memorialist }}
		}
		modifier = {
			job_manager_add = 2
		}
	}

	#Tourists
	# triggered_planet_modifier = {
	# 	potential = {
	# 		has_modifier = resort_colony
	# 	}
	# 	modifier = {
	# 		job_pw_tourist_per_pop = @pw_job_per_20_pop
	# 	}
	# }

	#Entertainers
	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				NOT = { has_valid_civic = civic_warrior_culture }
			}
		}
		modifier = {
			job_entertainer_add = 3
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				has_valid_civic = civic_warrior_culture
			}
		}
		modifier = {
			job_duelist_add = 3
		}
	}

	#Curators of Diversity (Envoys, max 5)
	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				count_envoy = {
					count > 0
					limit = {
						has_envoy_task = { task = improve_relations }
					}
				}
			}
		}
		modifier = {
			job_pw_diversity_curator_add = 1
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				count_envoy = {
					count > 1
					limit = {
						has_envoy_task = { task = improve_relations }
					}
				}
			}
		}
		modifier = {
			job_pw_diversity_curator_add = 1
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				count_envoy = {
					count > 2
					limit = {
						has_envoy_task = { task = improve_relations }
					}
				}
			}
		}
		modifier = {
			job_pw_diversity_curator_add = 1
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				count_envoy = {
					count > 3
					limit = {
						has_envoy_task = { task = improve_relations }
					}
				}
			}
		}
		modifier = {
			job_pw_diversity_curator_add = 1
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				count_envoy = {
					count > 4
					limit = {
						has_envoy_task = { task = improve_relations }
					}
				}
			}
		}
		modifier = {
			job_pw_diversity_curator_add = 1
		}
	}

	#Curators of Diversity (Federation, max 5)
	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_federation = yes }
			owner = {
				count_federation_ally = { count > 0 }
			}
		}
		modifier = {
			job_pw_diversity_curator_add = 1
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_federation = yes }
			owner = {
				count_federation_ally = { count > 1 }
			}
		}
		modifier = {
			job_pw_diversity_curator_add = 1
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_federation = yes }
			owner = {
				count_federation_ally = { count > 2 }
			}
		}
		modifier = {
			job_pw_diversity_curator_add = 1
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_federation = yes }
			owner = {
				count_federation_ally = { count > 3 }
			}
		}
		modifier = {
			job_pw_diversity_curator_add = 1
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_federation = yes }
			owner = {
				count_federation_ally = { count > 4 }
			}
		}
		modifier = {
			job_pw_diversity_curator_add = 1
		}
	}

	#Stability from ambition
	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_edict = pw_ambition_monumentality }
		}
		modifier = {
			planet_stability_add = @pw_stability_production
		}
	}

	#Ambition Bonus
	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { is_megacorp = no }
			owner = { has_edict = pw_ambition_wonders_beyond_ambition }
		}
		modifier = {
			planet_jobs_unity_produces_mult = 0.20
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { is_megacorp = yes }
			owner = { has_edict = pw_ambition_wonders_beyond_ambition }
		}
		modifier = {
			trade_value_mult = 0.20
		}
	}

	triggered_desc = {
		text = pw_planet_wonder_lb
	}

	triggered_desc = {
		text = pw_empire_unique_lb
	}

	triggered_desc = {
		text = pw_building_fair_of_worlds_tooltip
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = { is_megacorp = no }
		}
		text = job_administrator_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = { is_megacorp = yes }
		}
		text = job_merchant_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = { is_megacorp = no }
		}
		text = job_culture_worker_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = { is_megacorp = yes }
		}
		text = job_manager_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = { has_valid_civic = civic_memorialist }
		}
		text = job_death_chronicler_effect_desc
	}

	# triggered_desc = {
	# 	trigger = {
	# 		has_modifier = resort_colony
	# 	}
	# 	text = job_pw_tourist_effect_desc
	# }

	triggered_desc = {
		trigger = {
			exists = owner
			owner = {
				NOT = { has_valid_civic = civic_warrior_culture }
			}
		}
		text = job_entertainer_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = {
				has_valid_civic = civic_warrior_culture
			}
		}
		text = job_duelist_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = {
				OR = {
					has_federation = yes
					any_envoy = {
						has_envoy_task = { task = improve_relations }
					}
				}
			}
		}
		text = job_pw_diversity_curator_effect_desc
	}

	on_built = {
		#This is an upgrade, so on_building_upgraded triggers for this.
		#planet_event = { id = pw_wonder.1430 }
	}

	ai_weight = {
		weight = 40
		modifier = {
			factor = 0
			buildings_has_crystals = no
			building_relaxed_basic_income_check = no
			owner = {
				OR = {
					AND = {
						country_uses_consumer_goods = yes
						has_monthly_income = {
							resource = consumer_goods
							value < 5
						}
					}
					AND = {
						country_uses_consumer_goods = no
						has_monthly_income = {
							resource = minerals
							value < 75
						}
					}
				}
			}
		}
		modifier = {
			factor = 0.25
			free_building_slots < 1
			free_district_slots < 1
		}
		modifier = {
			factor = 0.25
			pw_has_any_planetary_wonder = yes
			exists = owner
			NOT = { owner = { has_ascension_perk = pw_ap_planetary_wonders }}
			NOT = { has_active_building = pw_building_fair_of_worlds }
			NOT = { has_building_construction = pw_building_fair_of_worlds }
		}
		modifier = {
			factor = 2
			has_designation = col_resort
		}
		modifier = {
			factor = 2
			is_capital = yes
		}
		modifier = {
			factor = 2
			exists = owner
			owner = { has_ethic = ethic_fanatic_xenophile }
		}
		modifier = {
			factor = 5
			exists = owner
			owner = {
				any_owned_planet = {
					NOT = { is_planet = root }
					OR = {
						has_active_building = pw_building_pavilion_of_wonders
						has_active_building = pw_building_fair_of_worlds
						has_active_building = pw_building_museum_of_the_grotesque
					}
				}
			}
		}
		modifier = {
			factor = 2
			exists = owner
			owner = {
				OR = {
					has_megastructure = mega_art_installation_2
					has_megastructure = mega_art_installation_3
					has_megastructure = mega_art_installation_4
					has_megastructure = mega_art_installation_restored
					has_megastructure = mega_art_installation_restored_2
				}
			}
		}
	}
}

pw_building_museum_of_the_grotesque = {
	base_buildtime = @pw_building_buildtime
	position_priority = 110
	category = unity
	can_be_ruined = no
	can_build = no #Only upgrades

	prerequisites = {
		pw_tech_xeno_art_alienation
	}

	potential = {
		exists = owner
		owner = { is_gestalt = no }
		NOT = { has_modifier = slave_colony }
		OR = {
			NOT = { is_planet_class = pc_habitat }
			owner = { has_ascension_perk = ap_voidborn }
		}
	}

	allow = {
		#Upgrade Wonders don't check for districts or availability
		owner = { is_xenophobe = yes }
		has_major_upgraded_capital = yes

		# Empire Unique:
		pw_is_wonder_empire_unique = { WONDER = pw_building_museum_of_the_grotesque }
	}

	resources = {
		category = planet_buildings
		cost = {
			minerals = @pw_building_cost
			volatile_motes = @pw_building_cost_rare
		}
		cost = {
			trigger = {
				planet = {
					pw_has_any_additional_planetary_wonder = yes
				}
			}
			minerals = @pw_building_cost_extra
		}
		cost = {
			trigger = {
				planet = {
					OR = {
						has_designation = col_resort
						has_designation = col_habitat_leisure
					}
				}
			}
			minerals = @pw_building_cost_discount
		}
		upkeep = {
			energy = @pw_building_upkeep_expensive
			volatile_motes = @pw_building_upkeep_rare_1
		}
		upkeep = {
			trigger = {
				planet = {
					pw_has_any_additional_planetary_wonder = yes
				}
			}
			energy = @pw_building_upkeep_extra
		}
		upkeep = {
			trigger = {
				exists = owner
				owner = {
					has_edict = pw_ambition_wonders_beyond_ambition
				}
			}
			energy = @pw_building_upkeep_ambition
		}
		upkeep = {
			trigger = {
				planet = {
					OR = {
						has_designation = col_resort
						has_designation = col_habitat_leisure
					}
				}
			}
			energy = @pw_building_upkeep_discount
		}
	}

	destroy_trigger = {
		OR = {
			has_modifier = slave_colony
			AND = {
				exists = owner
				owner = { is_gestalt = yes }
			}
			AND = {
				exists = owner
				owner = { is_xenophobe = no }
			}
		}
	}

	convert_to = {
		pw_building_pavilion_of_wonders
		pw_building_fair_of_worlds
		building_heritage_site
		building_holotemple
		building_simulation_2
		building_hive_cluster
		building_corporate_site
		building_galactic_memorial_2
	}

	planet_modifier = {
		planet_max_districts_add = -1
	}

	#Reminder: Cannot be Gestalt and must be xenophobe!

	#Administrator
	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { is_megacorp = no }
		}
		modifier = {
			job_administrator_add = 1
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { is_megacorp = yes }
		}
		modifier = {
			job_merchant_add = 1
		}
	}

	#Culture Workers
	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { is_megacorp = no }
		}
		modifier = {
			job_culture_worker_per_pop = @pw_job_per_25_pop
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { is_megacorp = yes }
		}
		modifier = {
			job_manager_per_pop = @pw_job_per_25_pop
		}
	}

	#Death Chroniclers
	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_valid_civic = civic_memorialist }
		}
		modifier = {
			job_death_chronicler_add = 2
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { is_megacorp = no }
			NOT = { owner = { has_valid_civic = civic_memorialist }}
		}
		modifier = {
			job_culture_worker_add = 2
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { is_megacorp = yes }
			NOT = { owner = { has_valid_civic = civic_memorialist }}
		}
		modifier = {
			job_manager_add = 2
		}
	}

	#Tourists
	# triggered_planet_modifier = {
	# 	potential = {
	# 		has_modifier = resort_colony
	# 	}
	# 	modifier = {
	# 		job_pw_tourist_per_pop = @pw_job_per_20_pop
	# 	}
	# }

	#Entertainers
	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				NOT = { has_valid_civic = civic_warrior_culture }
			}
		}
		modifier = {
			job_entertainer_add = 3
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				has_valid_civic = civic_warrior_culture
			}
		}
		modifier = {
			job_duelist_add = 3
		}
	}

	#Curators of Degeneracy (Envoys, max 5)
	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				count_envoy = {
					count > 0
					limit = {
						has_envoy_task = { task = harm_relations }
					}
				}
			}
		}
		modifier = {
			job_pw_degeneracy_curator_add = 1
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				count_envoy = {
					count > 1
					limit = {
						has_envoy_task = { task = harm_relations }
					}
				}
			}
		}
		modifier = {
			job_pw_degeneracy_curator_add = 1
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				count_envoy = {
					count > 2
					limit = {
						has_envoy_task = { task = harm_relations }
					}
				}
			}
		}
		modifier = {
			job_pw_degeneracy_curator_add = 1
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				count_envoy = {
					count > 3
					limit = {
						has_envoy_task = { task = harm_relations }
					}
				}
			}
		}
		modifier = {
			job_pw_degeneracy_curator_add = 1
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				count_envoy = {
					count > 4
					limit = {
						has_envoy_task = { task = harm_relations }
					}
				}
			}
		}
		modifier = {
			job_pw_degeneracy_curator_add = 1
		}
	}

	#Curators of Degeneracy (Federation, max 5 -> max 3 in vanilla)
	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				count_rival_country = {
					count > 0
				}
			}
		}
		modifier = {
			job_pw_degeneracy_curator_add = 1
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				count_rival_country = {
					count > 1
				}
			}
		}
		modifier = {
			job_pw_degeneracy_curator_add = 1
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				count_rival_country = {
					count > 2
				}
			}
		}
		modifier = {
			job_pw_degeneracy_curator_add = 1
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				count_rival_country = {
					count > 3
				}
			}
		}
		modifier = {
			job_pw_degeneracy_curator_add = 1
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				count_rival_country = {
					count > 4
				}
			}
		}
		modifier = {
			job_pw_degeneracy_curator_add = 1
		}
	}

	#Curators of Degeneracy (war)
	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				is_at_war = yes
			}
		}
		modifier = {
			job_pw_degeneracy_curator_add = 2
		}
	}

	#Curators of Degeneracy (no diplomacy)
	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				OR = {
					has_valid_civic = civic_fanatic_purifiers
					has_valid_civic = civic_inwards_perfection
				}
			}
		}
		modifier = {
			job_pw_degeneracy_curator_add = 3
		}
	}

	#Stability from ambition
	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_edict = pw_ambition_monumentality }
		}
		modifier = {
			planet_stability_add = @pw_stability_production
		}
	}

	#Ambition Bonus
	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { is_megacorp = no }
			owner = { has_edict = pw_ambition_wonders_beyond_ambition }
		}
		modifier = {
			planet_jobs_unity_produces_mult = 0.20
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { is_megacorp = yes }
			owner = { has_edict = pw_ambition_wonders_beyond_ambition }
		}
		modifier = {
			trade_value_mult = 0.20
		}
	}

	triggered_desc = {
		text = pw_planet_wonder_lb
	}

	triggered_desc = {
		text = pw_empire_unique_lb
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = {
				NOR = {
					has_valid_civic = civic_fanatic_purifiers
					has_valid_civic = civic_inwards_perfection
				}
			}
		}
		text = pw_building_museum_of_the_grotesque_tooltip
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = {
				OR = {
					has_valid_civic = civic_fanatic_purifiers
					has_valid_civic = civic_inwards_perfection
				}
			}
		}
		text = pw_building_museum_of_the_grotesque_tooltip_no_diplomacy
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = { is_megacorp = no }
		}
		text = job_administrator_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = { is_megacorp = yes }
		}
		text = job_merchant_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = { is_megacorp = no }
		}
		text = job_culture_worker_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = { is_megacorp = yes }
		}
		text = job_manager_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = { has_valid_civic = civic_memorialist }
		}
		text = job_death_chronicler_effect_desc
	}

	# triggered_desc = {
	# 	trigger = {
	# 		has_modifier = resort_colony
	# 	}
	# 	text = job_pw_tourist_effect_desc
	# }

	triggered_desc = {
		trigger = {
			exists = owner
			owner = {
				NOT = { has_valid_civic = civic_warrior_culture }
			}
		}
		text = job_entertainer_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = {
				has_valid_civic = civic_warrior_culture
			}
		}
		text = job_duelist_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = {
				OR = {
					is_at_war = yes
					has_valid_civic = civic_fanatic_purifiers
					has_valid_civic = civic_inwards_perfection
					count_rival_country = { count > 0 }
					any_envoy = {
						has_envoy_task = { task = harm_relations }
					}
				}
			}
		}
		text = job_pw_degeneracy_curator_effect_desc
	}

	on_built = {
		#This is an upgrade, so on_building_upgraded triggers for this.
		#planet_event = { id = pw_wonder.1460 }
	}

	ai_weight = {
		weight = 40
		modifier = {
			factor = 0
			buildings_has_motes = no
			building_relaxed_basic_income_check = no
			owner = {
				OR = {
					AND = {
						country_uses_consumer_goods = yes
						has_monthly_income = {
							resource = consumer_goods
							value < 5
						}
					}
					AND = {
						country_uses_consumer_goods = no
						has_monthly_income = {
							resource = minerals
							value < 75
						}
					}
				}
			}
		}
		modifier = {
			factor = 0.25
			free_building_slots < 1
			free_district_slots < 1
		}
		modifier = {
			factor = 0.25
			pw_has_any_planetary_wonder = yes
			exists = owner
			NOT = { owner = { has_ascension_perk = pw_ap_planetary_wonders }}
			NOT = { has_active_building = pw_building_museum_of_the_grotesque }
			NOT = { has_building_construction = pw_building_museum_of_the_grotesque }
		}
		modifier = {
			factor = 2
			has_designation = col_resort
		}
		modifier = {
			factor = 2
			is_capital = yes
		}
		modifier = {
			factor = 2
			exists = owner
			owner = { has_ethic = ethic_fanatic_xenophobe }
		}
		modifier = {
			factor = 5
			exists = owner
			owner = {
				any_owned_planet = {
					NOT = { is_planet = root }
					OR = {
						has_active_building = pw_building_pavilion_of_wonders
						has_active_building = pw_building_fair_of_worlds
						has_active_building = pw_building_museum_of_the_grotesque
					}
				}
			}
		}
		modifier = {
			factor = 2
			exists = owner
			owner = {
				OR = {
					has_megastructure = mega_art_installation_2
					has_megastructure = mega_art_installation_3
					has_megastructure = mega_art_installation_4
					has_megastructure = mega_art_installation_restored
					has_megastructure = mega_art_installation_restored_2
				}
			}
		}
	}
}

pw_building_holy_reliquary = {
	base_buildtime = @pw_building_buildtime
	position_priority = 95
	category = unity
	base_cap_amount = 1
	can_be_ruined = no

	prerequisites = {
		pw_tech_spiritual_artifacts_studies
	}

	potential = {
		exists = owner
		owner = { is_gestalt = no }
		NOT = { has_modifier = slave_colony }
		NOT = { has_modifier = resort_colony }
		OR = {
			NOT = { is_planet_class = pc_habitat }
			owner = { has_ascension_perk = ap_voidborn }
		}
	}

	allow = {
		owner = { is_spiritualist = yes }
		has_major_upgraded_capital = yes
		free_district_slots > 0 # Needs a free district to occupy
		pw_can_build_planetary_wonder = yes #Check if there is space for the Wonder

		# Empire Unique:
		pw_is_wonder_empire_unique = { WONDER = pw_building_holy_reliquary }
	}

	resources = {
		category = planet_buildings
		cost = {
			minerals = @pw_building_cost
			rare_crystals = @pw_building_cost_rare
		}
		cost = {
			trigger = {
				planet = {
					pw_has_any_planetary_wonder = yes
				}
			}
			minerals = @pw_building_cost_extra
		}
		upkeep = {
			energy = @pw_building_upkeep_expensive
			rare_crystals = @pw_building_upkeep_rare_1
		}
		upkeep = {
			trigger = {
				planet = {
					pw_has_any_additional_planetary_wonder = yes
				}
			}
			energy = @pw_building_upkeep_extra
		}
		upkeep = {
			trigger = {
				exists = owner
				owner = {
					has_edict = pw_ambition_wonders_beyond_ambition
				}
			}
			energy = @pw_building_upkeep_ambition
		}
	}

	destroy_trigger = {
		OR = {
			has_modifier = slave_colony
			has_modifier = resort_colony
			AND = {
				exists = owner
				owner = { is_gestalt = yes }
			}
			AND = {
				exists = owner
				owner = { is_spiritualist =  no }
			}
		}
	}

	convert_to = {
		building_sacred_nexus
		building_heritage_site
		building_holotemple
		building_simulation_2
		building_hive_cluster
		building_corporate_site
	}

	planet_modifier = {
		planet_max_districts_add = -1
	}

	#Reminder: Cannot be Gestalt and must be spiritualist!

	#Relic Keeper
	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { is_spiritualist = yes }
			owner = {
				has_country_flag = pw_holy_reliquary_relic_keeper_appointed
			}
		}
		modifier = {
			job_pw_relic_keeper_add = 1
		}
	}

	#Priests
	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { is_spiritualist = yes }
		}
		modifier = {
			job_high_priest_add = 1
			job_priest_add = 4
		}
	}

	#Death priests
	triggered_planet_modifier = {
		potential = {
			exists = owner
			OR = {
				owner = { has_valid_civic = civic_death_cult }
				owner = { has_valid_civic = civic_death_cult_corporate }
			}
		}
		modifier = {
			job_death_priest_add = 2
			job_mortal_initiate_add = 2
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			NOR = {
				owner = { has_valid_civic = civic_death_cult }
				owner = { has_valid_civic = civic_death_cult_corporate }
			}
		}
		modifier = {
			job_priest_add = 2
		}
	}

	#Death Chroniclers
	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_valid_civic = civic_memorialist }
		}
		modifier = {
			job_death_chronicler_add = 2
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			NOT = { owner = { has_valid_civic = civic_memorialist }}
		}
		modifier = {
			job_priest_add = 2
		}
	}

	#Prosperity preacher
	triggered_planet_modifier = {
		potential = {
			exists = owner
			has_active_building = building_temple_of_prosperity
		}
		modifier = {
			job_preacher_add = 2
		}
	}

	#Stability from ambition
	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_edict = pw_ambition_monumentality }
		}
		modifier = {
			planet_stability_add = @pw_stability_production
		}
	}

	#Ambition Bonus
	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_edict = pw_ambition_wonders_beyond_ambition }
		}
		modifier = {
			planet_priests_produces_mult = 0.25
		}
	}

	triggered_desc = {
		text = pw_planet_wonder_lb
	}

	triggered_desc = {
		text = pw_empire_unique_lb
	}

	triggered_desc = {
		text = pw_building_holy_reliquary_tooltip
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = { has_country_flag = pw_holy_reliquary_relic_keeper_appointed }
		}
		text = job_pw_relic_keeper_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = { is_spiritualist = yes }
		}
		text = job_high_priest_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = { is_spiritualist = yes }
		}
		text = job_priest_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			OR = {
				owner = { has_valid_civic = civic_death_cult }
				owner = { has_valid_civic = civic_death_cult_corporate }
			}
		}
		text = job_death_priest_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			OR = {
				owner = { has_valid_civic = civic_death_cult }
				owner = { has_valid_civic = civic_death_cult_corporate }
			}
		}
		text = job_mortal_initiate_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = { has_valid_civic = civic_memorialist }
		}
		text = job_death_chronicler_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			has_active_building = building_temple_of_prosperity
		}
		text = job_preacher_effect_desc
	}

	on_built = {
		planet_event = { id = pw_wonder.1500 }
	}

	ai_weight = {
		weight = 50
		modifier = {
			factor = 0
			buildings_has_crystals = no
			building_relaxed_basic_income_check = no
			owner = {
				OR = {
					AND = {
						country_uses_consumer_goods = yes
						has_monthly_income = {
							resource = consumer_goods
							value < 5
						}
					}
					AND = {
						country_uses_consumer_goods = no
						has_monthly_income = {
							resource = minerals
							value < 75
						}
					}
				}
			}
		}
		modifier = {
			factor = 0.25
			free_building_slots < 1
			free_district_slots < 1
		}
		modifier = {
			factor = 0.25
			pw_has_any_planetary_wonder = yes
			exists = owner
			NOT = { owner = { has_ascension_perk = pw_ap_planetary_wonders }}
			NOT = { has_active_building = pw_building_holy_reliquary }
			NOT = { has_building_construction = pw_building_holy_reliquary }
		}
		modifier = {
			factor = 2.5
			is_capital = yes
		}
		modifier = {
			factor = 3
			exists = owner
			owner = { has_ethic = ethic_fanatic_spiritualist }
		}
	}
}
