building_traditional_farm = {
	base_buildtime = 180

	category = resource
	
	potential = {
		exists = owner
		owner = { is_machine_empire = no }
		not_hostile_planet = yes
		NOT = { is_planet_class = pc_machine }
		NOT = { is_planet_class = pc_habitat }
	}
	
	destroy_trigger = {
		exists = owner
		or = {
			and = {
				free_building_slots = 0
				free_jobs > 1
				owner = {
					is_machine_empire = no
					is_ai = yes
					has_monthly_income = { resource = food value > 100 }
				}
			}
			owner = { is_machine_empire = yes }
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { is_regular_empire = yes }
		}
		modifier = {
			job_farmer_add = 1
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { is_hive_empire = yes }
		}
		modifier = {
			job_agri_drone_add = 1
		}
	}
	
	resources = {
		category = planet_buildings
		cost = {
			minerals = 300
		}
		upkeep = {
			energy = 2
		}
		produces = {
			food = 1
			sr_biomass = 1
			unity = 1
		}
		produces = {
			trigger = { 
				planet = {
					exists = owner
					owner = {
						has_policy_flag = alp_renewable_power_focus
					}
				}
			}
			unity = 1
		}
		produces = {
			trigger = { 
				planet = { 
					has_ice_left = yes
					not = { has_planet_flag = preserving_ice }
				}
			}
			food = 1
		}
		upkeep = {
			trigger = { 
				planet = { 
					has_ice_left = yes
					not = { has_planet_flag = preserving_ice }
				}
			}
			sr_ice = 1
		}
	}	
	
	triggered_desc = {
		trigger = {
			exists = owner
			owner = { is_hive_empire = yes }
		}
		text = job_agri_drone_effect_desc
	}
	triggered_desc = {
		trigger = {
			exists = owner
			owner = { is_regular_empire = yes }
		}
		text = job_farmer_effect_desc
	}
	
	ai_weight = {
		weight = 1
		modifier = {
			factor = 0
			has_building = building_hydroponics_farm
		}
		modifier = {
			factor = 10
			free_jobs < 2
			owner = {
				country_uses_food = yes
				has_monthly_income = { resource = food value < 10 }
			}
		}
		modifier = {
			factor = 0
			or = {
				owner = { country_uses_food = no }
				num_free_districts = { type = district_farming value > 0 }
				owner = { has_monthly_income = { resource = food value > 25 }}
			}
		}
	}

	ai_resource_production = {
		food = 1
		trigger = {
			always = yes
		}
	}
}

building_moisture_farm = {
	base_buildtime = 180
	base_cap_amount = 2

	category = resource
	
	potential = {
		or = {
			is_planet_class = pc_desert
			is_planet_class = pc_arid
			is_planet_class = pc_savannah
		}
	}
	
	planet_modifier = { planet_amenities_add = 2 }

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { is_regular_empire = yes }
		}
		modifier = {
			job_water_processor_add = 1
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { is_gestalt = yes }
		}
		modifier = {
			job_water_processor_drone_add = 1
		}
	}
	
	resources = {
		category = planet_buildings
		cost = { minerals = 100 }
		upkeep = { energy = 1 }
		produces = { sr_ice = 1 }
	}
	
	upgrades = {
		"building_moisture_farm_2"
	}
	
	ai_weight = {
		weight = 1
		modifier = {
			factor = 0
			has_ice_income_less_3 = no
		}
	}
}

building_moisture_farm_2 = {
	base_buildtime = 180
	can_build = no

	category = resource
	
	potential = {
		has_building = building_moisture_farm
	}
	
	planet_modifier = { planet_amenities_add = 4 }

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { is_regular_empire = yes }
		}
		modifier = {
			job_water_processor_add = 2
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { is_gestalt = yes }
		}
		modifier = {
			job_water_processor_drone_add = 2
		}
	}
	
	resources = {
		category = planet_buildings
		cost = { minerals = 200 }
		upkeep = { energy = 2 }
		produces = { sr_ice = 2 }
	}
	
	prerequisites = {
		"tech_hydroponics"
	}
	
	ai_weight = {
		weight = 10
		modifier = {
			factor = 0
			has_ice_income_less_3 = no
		}
	}
}

building_ice_importer = {
	base_buildtime = 360

	category = resource
	
	allow = {
		or = {
			has_building = building_moisture_farm
			has_building = building_moisture_farm_2
			has_building = building_desalinator
			has_building = building_reservoir
			has_building = building_water_excavator
			has_building = building_hydro_plant
			is_planet_class = pc_ocean
			is_planet_class = pc_arctic
			is_planet_class = pc_frozen_habitable
			is_planet_class = pc_ice_asteroid_habitable
		}
	}
	
	planet_modifier = { planet_amenities_add = 2 }

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { is_regular_empire = yes }
		}
		modifier = {
			job_water_processor_add = 2
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { is_gestalt = yes }
		}
		modifier = {
			job_water_processor_drone_add = 2
		}
	}
	
	resources = {
		category = planet_buildings
		cost = {
			minerals = 100
		}
		produces = {
			trigger = { 
				planet = { 
					not = { has_planet_flag = pf_ice_to_crystals }
				}
			}
			sr_ice = 1
		}
		produces = {
			trigger = { 
				planet = { 
					has_planet_flag = pf_ice_to_crystals
				}
			}
			rare_crystals = 1
		}
		upkeep = {
			trigger = { 
				planet = { 
					has_planet_flag = pf_ice_to_crystals
				}
			}
			minerals = 2
			sr_ice = 4
		}
	}
	
	ai_weight = {
		weight = 0
		modifier = {
			weight = 1
			has_ice_income_less_3 = yes
		}
		modifier = {
			factor = 0.1
			has_ice_left = yes
		}
	}
}

building_nuclear_plant = {
	base_buildtime = 360
	category = resource
	
	potential = { NOT = { has_modifier = resort_colony }}
	
	allow = {
		exists = owner
		has_actinides_income = yes
		owner = { 
			not = { has_policy_flag = alp_renewable_power_focus }
		}
	}
	
	resources = {
		category = planet_buildings
		cost = {
			minerals = 200
			sr_actinides = 10
		}
		upkeep = { sr_actinides = 1 }
		produces = {
			trigger = { planet = { has_actinides_left = yes }}
			energy = 5
		}
		produces = {
			sr_waste = 5
		}
	}
	
	upgrades = {
		"building_nuclear_plant_2"
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { is_regular_empire = yes }
		}
		modifier = {
			job_actinides_utiliser_add = 1
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { is_gestalt = yes }
		}
		modifier = {
			job_actinides_utiliser_drone_add = 1
		}
	}
	
	ai_weight = {
		weight = 0
		modifier = {
			weight = 5
			free_jobs < 4
			num_free_districts = { type = district_generator value < 1 }
			exists = owner
			owner = { 
				has_monthly_income = { resource = energy value <= 50 }
				has_monthly_income = { resource = sr_actinides value >= 2 }	 
			}		
		}
		modifier = {
			factor = 2
			exists = owner
			owner = { is_machine_empire = yes }
		}
		modifier = {
			factor = 2
			has_modifier = rich_actinides
		}
		modifier = {
			weight = 0
			exists = owner
			owner = { has_monthly_income = { resource = sr_actinides value <= 1 }}
		}
		modifier = {
			factor = 2
			has_designation = col_generator
		}
	}
}

building_nuclear_plant_2 = {
	base_buildtime = 360
	can_build = no

	category = resource
	
	potential = { NOT = { has_modifier = resort_colony }}
	
	resources = {
		category = planet_buildings
		cost = {
			minerals = 200
			sr_actinides = 10
		}
		upkeep = {
			sr_actinides = 2
		}
		produces = {
			trigger = { planet = { has_actinides_left = yes }}
			energy = 10
		}
		produces = {
			sr_waste = 4
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { is_regular_empire = yes }
		}
		modifier = {
			job_actinides_utiliser_add = 2
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { is_gestalt = yes }
		}
		modifier = {
			job_actinides_utiliser_drone_add = 2
		}
	}
	
	upgrades = {
		"building_nuclear_plant_3"
	}
	
	prerequisites = {
		"tech_fusion_power"
	}
	
	ai_weight = {
		weight = 5
		modifier = {
			factor = 0
			owner = { has_monthly_income = { resource = sr_actinides value <= 2 }}
		}
	}
}

building_nuclear_plant_3 = {
	base_buildtime = 360
	can_build = no

	category = resource
	
	potential = { NOT = { has_modifier = resort_colony }}
	
	resources = {
		category = planet_buildings
		cost = {
			minerals = 200
			sr_actinides = 10
		}
		upkeep = {
			sr_actinides = 3
		}
		produces = {
			trigger = { planet = { has_actinides_left = yes }}
			energy = 15
		}
		produces = {
			sr_waste = 3
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { is_regular_empire = yes }
		}
		modifier = {
			job_actinides_utiliser_add = 3
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { is_gestalt = yes }
		}
		modifier = {
			job_actinides_utiliser_drone_add = 3
		}
	}
	
	prerequisites = {
		"tech_cold_fusion_power"
	}
	
	ai_weight = {
		weight = 5
		modifier = {
			factor = 0
			owner = { has_monthly_income = { resource = sr_actinides value <= 3 }}
		}
	}
}

building_biomass_furnace = {
	base_buildtime = 360
	base_cap_amount = 1

	category = resource
	
	potential = {
		NOT = { has_modifier = resort_colony }
		owner = {
			nor = {
				has_ethic = ethic_pacifist
				has_ethic = ethic_fanatic_pacifist
				# has_ethic = ethic_xenophile
				has_ethic = ethic_fanatic_xenophile
			}
		}
	}
	
	allow = {
		exists = owner
		owner = { 
			has_monthly_income = { resource = sr_biomass value >= 1 }
			not = { has_policy_flag = alp_renewable_power_focus }
			not = { has_policy_flag = alp_ecology_max_protection }
			not = { has_policy_flag = alp_ecology_heavyregulations }
		}
	}
	
	resources = {
		category = planet_buildings
		cost = {
			minerals = 200
			sr_biomass = 100
		}
		upkeep = {
			trigger = { planet = { has_biomass_left = yes }}
			sr_biomass = 10
		}
		upkeep = {
			trigger = { planet = { has_biomass_left = no }}
			food = 5
		}
		produces = {
			trigger = { planet = { has_biomass_left = yes }}
			energy = 5
		}
		produces = {
			trigger = { planet = { has_biomass_left = no }}
			energy = 1
		}
		upkeep = {
			sr_waste = 10
		}
		upkeep = {
			trigger = { planet = { has_lots_biomass_left = yes }}
			sr_biomass = 10
		}
		produces = {
			trigger = { planet = { has_lots_biomass_left = yes }}
			energy = 5
		}
		upkeep = {
			trigger = { planet = { has_loads_biomass_left = yes }}
			sr_biomass = 10
		}
		produces = {
			trigger = { planet = { has_loads_biomass_left = yes }}
			energy = 5
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { is_regular_empire = yes }
		}
		modifier = {
			job_technician_add = 1
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { is_gestalt = yes }
		}
		modifier = {
			job_technician_drone_add = 1
		}
	}
	
	ai_weight = {
		weight = 0
		modifier = {
			weight = 1
			owner = { has_monthly_income = { resource = energy value <= 25 }}		
		}
		modifier = {
			factor = 0.01
			has_building = building_biomass_furnace
		}
		modifier = {
			factor = 0
			owner = { has_monthly_income = { resource = sr_biomass value <= 20 }}
		}
		modifier = {
			factor = 0
			free_jobs > 2
		}
		modifier = {
			factor = 2
			has_designation = col_generator
		}
	}
}

building_fuels_power_plant = {
	base_buildtime = 360
	base_cap_amount = 3

	category = resource
	
	potential = { NOT = { has_modifier = resort_colony }}	
	allow = { 
		exists = owner
		has_natural_fuels_income = yes 
		owner = { not = { has_policy_flag = alp_renewable_power_focus }}
	}
	
	resources = {
		category = planet_buildings
		cost = {
			minerals = 200
			sr_natural_fuels = 50
		}
		upkeep = {
			trigger = { 
				planet = { 
					has_natural_fuels_left = yes
					has_planet_flag = pf_fuels_to_gases
				}
			}
			sr_natural_fuels = 2
		}
		produces = {
			trigger = { 
				planet = { 
					has_natural_fuels_left = yes
					has_planet_flag = pf_fuels_to_gases
				}
			}
			exotic_gases = 1
		}
		upkeep = {
			trigger = { planet = { has_natural_fuels_left = yes }}
			sr_natural_fuels = 5
		}
		upkeep = {
			trigger = { planet = { has_natural_fuels_left = no }}
			minerals = 1
		}
		produces = {
			trigger = { planet = { has_natural_fuels_left = yes }}
			energy = 5
		}
		produces = {
			trigger = { planet = { has_natural_fuels_left = no }}
			energy = 1
		}
		produces = {
			sr_waste = 3
		}
	}
	
	triggered_desc = {
		trigger = { planet = { has_natural_fuels_left = no }}
		text = option_fuel_depleted_desc
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { is_regular_empire = yes }
		}
		modifier = {
			job_technician_add = 1
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { is_gestalt = yes }
		}
		modifier = {
			job_technician_drone_add = 1
		}
	}
	
	ai_weight = {
		weight = 0
		modifier = {
			weight = 6
			free_jobs < 4
			num_free_districts = { type = district_generator value < 1 }
			exists = owner
			owner = { 
				has_monthly_income = { resource = energy value <= 50 }
				has_monthly_income = { resource = sr_natural_fuels value >= 3 }	 
			}		
		}
		modifier = {
			factor = 2
			has_modifier = rich_natural_fuels
		}
		modifier = {
			weight = 0
			has_fuels_income_less_10 = yes
		}
		modifier = {
			factor = 2
			has_designation = col_generator
		}
	}
}

building_vertical_farms = {
	base_buildtime = 720
	can_build = no

	category = resource
	
	potential = {
		NOT = { is_planet_class = pc_machine }
		NOT = { has_modifier = resort_colony }
	}
	
	resources = {
		category = planet_buildings
		cost = { minerals = 600 }
		upkeep = { energy = 5 }
		produces = {
			trigger = { 
				planet = { 
					has_ice_left = yes
					not = { has_planet_flag = preserving_ice }
				}
			}
			food = 4
		}
		upkeep = {
			trigger = { 
				planet = { 
					has_ice_left = yes
					not = { has_planet_flag = preserving_ice }
				}
			}
			sr_ice = 1
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { is_regular_empire = yes }
		}
		modifier = {
			job_farmer_add = 4
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { is_gestalt = yes }
		}
		modifier = {
			job_agri_drone_add = 4
		}
	}	
	
	triggered_desc = {
		trigger = {
			exists = owner
			owner = { is_gestalt = yes }
		}
		text = job_agri_drone_effect_desc
	}
	triggered_desc = {
		trigger = {
			exists = owner
			owner = { is_regular_empire = yes }
		}
		text = job_farmer_effect_desc
	}
	
	ai_weight = { weight = 0 }

	ai_resource_production = {
		food = 2
		trigger = { always = yes }
	}
}