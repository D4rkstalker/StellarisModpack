building_ehof_sm_forge_1 = {
	base_buildtime = @b3_time
	category = manufacturing
	upgrades = { building_ehof_sm_forge_2 }
	prerequisites = { tech_ehof_sentient_tier_1 }

	potential = {
		NOT = { has_modifier = resort_colony }
		NOT = { has_modifier = slave_colony }
		building_relaxed_basic_income_check = yes
	}

	allow = {
		has_upgraded_capital = yes
		buildings_upgrade_allow = yes
	}

	destroy_trigger = { OR = { has_modifier = resort_colony has_modifier = slave_colony } }

	triggered_planet_modifier = { potential = { exists = owner owner = { is_hive_empire = yes } }		modifier = { job_ehof_cultivation_drone_add = @b1_jobs } }
	triggered_planet_modifier = { potential = { exists = owner owner = { is_machine_empire = yes } }	modifier = { job_ehof_cultivation_drone_add = @b1_jobs } }
	triggered_planet_modifier = { potential = { exists = owner owner = { is_regular_empire = yes } }	modifier = { job_ehof_cultivator_add = @b1_jobs } }

	triggered_desc = { trigger = { exists = owner owner = { is_hive_empire = yes } }	text = job_ehof_cultivation_drone_effect_desc }
	triggered_desc = { trigger = { exists = owner owner = { is_machine_empire = yes } }	text = job_ehof_cultivation_drone_effect_desc }
	triggered_desc = { trigger = { exists = owner owner = { is_regular_empire = yes } }	text = job_ehof_cultivator_effect_desc }

	resources = {
		category = planet_buildings
		cost = { minerals = @b3_minerals }
		upkeep = { energy = @b3_upkeep }
	}

	ai_weight = {
		weight = 10
		modifier = {
			factor = 50
			NOR = {
				has_building = building_ehof_sm_forge_1
				has_building = building_ehof_sm_forge_2
			}
		}
		modifier = {
			factor = 50
			owner = { has_monthly_income = { resource = ehof_sr_sentient_metal value < 50 } }
		}
		modifier = {
			factor = 50
			owner = { has_monthly_income = { resource = ehof_sr_sentient_metal value < 1 } }
		}
		modifier = {
			factor = 50
			has_building = building_ehof_sm_forge_1
			free_building_slots = 0
		}
	}

	ai_resource_production = {
		ehof_sr_sentient_metal = 1
		trigger = { always = yes }
	}
}

building_ehof_sm_forge_2 = {
	base_buildtime = @b4_time
	can_build = no
	category = manufacturing
	prerequisites = { tech_ehof_sentient_tier_3 }

	allow = {
		has_major_upgraded_capital = yes
		buildings_upgrade_allow = yes
	}

	destroy_trigger = { OR = { has_modifier = resort_colony has_modifier = slave_colony } }

	triggered_planet_modifier = { potential = { exists = owner owner = { is_hive_empire = yes } }		modifier = { job_ehof_cultivation_drone_add = @b2_jobs } }
	triggered_planet_modifier = { potential = { exists = owner owner = { is_machine_empire = yes } }	modifier = { job_ehof_cultivation_drone_add = @b2_jobs } }
	triggered_planet_modifier = { potential = { exists = owner owner = { is_regular_empire = yes } }	modifier = { job_ehof_cultivator_add = @b2_jobs } }

	triggered_desc = { trigger = { exists = owner owner = { is_hive_empire = yes } }	text = job_ehof_cultivation_drone_effect_desc }
	triggered_desc = { trigger = { exists = owner owner = { is_machine_empire = yes } }	text = job_ehof_cultivation_drone_effect_desc }
	triggered_desc = { trigger = { exists = owner owner = { is_regular_empire = yes } }	text = job_ehof_cultivator_effect_desc }

	resources = {
		category = planet_buildings
		cost = { minerals = @b4_minerals }
		upkeep = { energy = @b4_upkeep }
	}

	ai_weight = { weight = 1000 }

	ai_resource_production = {
		ehof_sr_sentient_metal = 1
		trigger = { always = yes }
	}
}


# OVERWRITTEN
building_ministry_production = {
	base_buildtime = @b2_time
	base_cap_amount = 1
	icon = building_production_center

	category = manufacturing

	potential = {
		exists = owner
		owner = { is_regular_empire = yes }
		NOR = {
			has_modifier = resort_colony
			has_modifier = slave_colony
		}
	}

	destroy_trigger = {
		exists = owner
		OR = {
			owner = { is_regular_empire = no }
			has_modifier = resort_colony
			has_modifier = slave_colony
			buildings_no_motes = yes
		}
	}

	allow = {
		has_major_upgraded_capital = yes
	}

	planet_modifier = {
		job_administrator_add = 1
		planet_metallurgists_produces_mult = 0.15
		planet_artisans_produces_mult = 0.15
		planet_cultivators_produces_mult = 0.15
	}

	resources = {
		category = planet_buildings
		cost = {
			minerals = @b2_minerals
			volatile_motes = @b2_rare_cost
		}
		upkeep = {
			energy = @b2_upkeep
			volatile_motes = @b2_rare_upkeep
		}
	}

	prerequisites = {
		"tech_global_production_strategy"
	}

	triggered_desc = {
		text = job_administrator_effect_desc
	}

	show_tech_unlock_if = {
		is_regular_empire = yes
	}

	ai_weight = {
		weight = 0
		modifier = {
			weight = 10
			OR = {
				has_building = building_foundry_1
				has_building = building_foundry_2
				has_building = building_foundry_3

				has_building = building_factory_1
				has_building = building_factory_2
				has_building = building_factory_3
			}
		}#No reason to build before the factory and foundry are built
		modifier = {
			weight = 1
			free_building_slots = 0
		}#Repairs
	}
}

building_production_center = {
	base_buildtime = @b2_time
	base_cap_amount = 1

	category = manufacturing

	potential = {
		exists = owner
		owner = { is_gestalt = yes }
	}

	destroy_trigger = {
		exists = owner
		OR = {
			owner = { is_gestalt = no }
			buildings_no_motes = yes
		}
	}

	allow = {
		has_major_upgraded_capital = yes
	}

	planet_modifier = {
		planet_metallurgists_produces_mult = 0.15
		planet_artisans_produces_mult = 0.15
		planet_cultivation_drones_produces_mult = 0.15
	}

	resources = {
		category = planet_buildings
		cost = {
			minerals = @b2_minerals
			volatile_motes = @b2_rare_cost
		}
		upkeep = {
			energy = @b2_upkeep
			volatile_motes = @b2_rare_upkeep
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { is_hive_empire = yes }
		}
		job_alloy_drone_add = 2
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { is_machine_empire = yes }
		}
		job_fabricator_add = 1
	}

	prerequisites = {
		"tech_global_production_strategy"
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = { is_hive_empire = yes }
		}
		text = job_alloy_drone_effect_desc
	}

	triggered_desc = {
		trigger = {
			exists = owner
			owner = { is_machine_empire = yes }
		}
		text = job_fabricator_effect_desc
	}

	show_tech_unlock_if = {
		is_gestalt = yes
	}

	ai_weight = {
		weight = 0
		modifier = {
			weight = 10
			OR = {
				has_building = building_foundry_1
				has_building = building_foundry_2
				has_building = building_foundry_3

				has_building = building_factory_1
				has_building = building_factory_2
				has_building = building_factory_3
			}
		}#No reason to build before the factory and foundry are built
		modifier = {
			weight = 1
			free_building_slots = 0
		}#Repairs
	}
}