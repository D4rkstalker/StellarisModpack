
ag_ancient_shield_situation = {
	picture = GFX_evt_shielded_planet
	complete_icon_frame = GFX_situation_outcome_frame_blue
	complete_icon = GFX_situation_outcome_unknown
	on_progress_complete = {
		custom_tooltip = "ag_situation_unknown_result"
		hidden_effect = { owner = {
			random_list = {
				75 = { country_event = { id = ag_theta.171 } }
				25 = {
					modifier = { add = 50 prev = { current_situation_approach = ag_ancient_shield_situation_spproach_positive } }
					country_event = { id = ag_theta.172 }
				}
			}
			reroll_random = yes
		} }
	}
	stages = {
		stage_1 = {
			icon = GFX_situation_stage_1
			icon_background = GFX_situation_stage_frame_blue
			end = 100
		}
	}
	approach = {
		name = "ag_ancient_shield_situation_spproach_positive"
		icon = GFX_situation_approach_research
		icon_background = GFX_situation_approach_bg_green
		default = no
		on_select = {
			custom_tooltip = "ag_ancient_shield_situation_spproach_positive_effect"
		}
		resources = {
			category = situations
			produces = {
				physics_research = 25
				society_research = 25
				engineering_research = 25
			}
			upkeep = {
				trigger = { owner = { is_gestalt = no } }
				energy = 25
				consumer_goods = 10
				sr_dark_matter = 2
				multiplier = owner.value:edict_size_effect
			}
			upkeep = {
				trigger = { owner = { is_hive_empire = yes } }
				energy = 25
				minerals = 30
				sr_dark_matter = 2
				multiplier = owner.value:edict_size_effect
			}
			upkeep = {
				trigger = { owner = { is_machine_empire = yes } }
				energy = 45
				sr_dark_matter = 2
				multiplier = owner.value:edict_size_effect
			}
		}
	}
	approach = {
		name = "ag_ancient_shield_situation_spproach_neutral"
		icon = GFX_situation_approach_research
		icon_background = GFX_situation_approach_bg_green
		default = yes
		on_select = {
			custom_tooltip = "ag_ancient_shield_situation_spproach_neutral_effect"
		}
		resources = {
			category = situations
			produces = {
				physics_research = 10
				society_research = 10
				engineering_research = 10
			}
			upkeep = {
				trigger = { owner = { is_gestalt = no } }
				energy = 10
				consumer_goods = 5
				multiplier = owner.value:edict_size_effect
			}
			upkeep = {
				trigger = { owner = { is_hive_empire = yes } }
				energy = 10
				minerals = 15
				multiplier = owner.value:edict_size_effect
			}
			upkeep = {
				trigger = { owner = { is_machine_empire = yes } }
				energy = 20
				multiplier = owner.value:edict_size_effect
			}
		}
	}
	approach = {
		name = "ag_ancient_shield_situation_spproach_pause"
		icon = GFX_situation_approach_research
		icon_background = GFX_situation_approach_bg_yellow
		default = no
		on_select = {
			custom_tooltip = "ag_ancient_shield_situation_spproach_pause_effect"
		}
	}
	on_monthly = { events = { ag_situation.1 } }
	monthly_progress = {
		base = 1
		modifier = {
			add = 1
			desc = "ag_ancient_shield_situation_spproach_positive"
			hidden_trigger = { current_situation_approach = "ag_ancient_shield_situation_spproach_positive" }
		}
		modifier = {
			add = ag_situation_random_progress
			desc = "ag_situation_random_progress"
		}
		modifier = {
			factor = 0
			desc = "ag_ancient_shield_situation_tooltip"
			hidden_trigger = { has_situation_flag = ag_situation_progress_locked }
		}
		modifier = {
			factor = 0
			desc = "ag_situation_spproach_paused"
			current_situation_approach = "ag_ancient_shield_situation_spproach_pause"
		}
	}
	abort_trigger = { always = no }
}

#######################################################################
### 				 Zeta Crisis Init Countdown
#######################################################################
# Stage 1: no relation with progress, 4 ~ 5 years, ~12 random events.
# Stage 2: ends at progress 925, ~6 years.
# Stage 3: ~8 years.
ag_zeta_crisis_init_situation = {
	picture = GFX_evt_surreal_visions
	fail_icon_frame = GFX_ag_situation_outcome_frame_violet
	fail_icon = GFX_ag_situation_outcome_icon_unknown_violet
	start_value = 999.999			# Paradox delete it when situation is considered as "finished".
	on_fail = {
		custom_tooltip = "ag_zeta_crisis_init_situation_completed"
		# Go to Shroud Invader Crisis Stage 3, crisis happens.
		hidden_effect = { owner = { if = { limit = { is_country_type = global_event } country_event = { id = ag_zeta_crisis.21 days = 1 } } } }
	}
	on_progress_complete = { }
	stages = {
		stage_1 = {
			icon = GFX_situation_stage_1
			icon_background = GFX_ag_situation_frame_violet
			end = 1000
		}
	}
	approach = {
		name = "ag_zeta_crisis_init_situation_approach"
		icon = GFX_situation_approach_unity
		icon_background = GFX_situation_approach_bg_yellow
		default = yes
		on_select = { custom_tooltip = "ag_zeta_crisis_init_situation_approach_tooltip" }
	}
	on_monthly = { events = { ag_situation.2 } }
	monthly_progress = {
		base = 0
		modifier = {
			add = owner.ag_zeta_crisis_init_situation_progress
			desc = "ag_zeta_crisis_init_situation_progress_desc"
			hidden_trigger = { owner = { OR = {
				is_country_type = global_event
				AND = {
					exists = event_target:ag_ancient_zeta_star
					event_target:ag_ancient_zeta_star.solar_system = { exists = space_owner }
					is_same_value = event_target:ag_ancient_zeta_star.solar_system.space_owner
				}
			} } }
		}
	}
	abort_trigger = { hidden_trigger = { owner = { NOR = {
		is_country_type = global_event
		AND = {
			exists = event_target:ag_ancient_zeta_star
			event_target:ag_ancient_zeta_star.solar_system = { exists = space_owner }
			is_same_value = event_target:ag_ancient_zeta_star.solar_system.space_owner
		}
	} } } }
}

# Unstable psionic conduit
ag_psionic_conduit_unstable_situation = {
	picture = GFX_evt_glitchy_matrix
	category = negative
	fail_icon = GFX_situation_outcome_positive
	fail_icon_frame = GFX_situation_outcome_frame_green
	complete_icon = GFX_ag_situation_outcome_icon_unknown_violet
	complete_icon_frame = GFX_ag_situation_outcome_frame_violet
	on_progress_complete = {
		custom_tooltip = "ag_psionic_conduit_unstable_situation_completed"
		hidden_effect = { owner = { country_event = { id = ag_alpha.126 } } }
	}
	on_fail = {
		custom_tooltip = "ag_psionic_conduit_unstable_situation_failed"
		hidden_effect = { owner = { country_event = { id = ag_alpha.125 } } }
	}
	start_value = 25
	stages = {
		stage_1 = {
			icon = GFX_situation_stage_1
			icon_background = GFX_ag_situation_frame_violet
			end = 100
		}
	}
	approach = {
		name = "ag_psionic_conduit_unstable_situation_approach"
		icon = GFX_situation_approach_unity
		icon_background = GFX_situation_approach_bg_yellow
		default = yes
		on_select = { custom_tooltip = "ag_psionic_conduit_unstable_situation_approach_tooltip" }
	}
	on_monthly = { events = { ag_situation.3 } }
	monthly_progress = {
		base = 0
		modifier = {
			add = event_target:ag_psionic_conduit_megastructure.ag_psionic_conduit_unstable_situation_progress
			desc = "ag_psionic_conduit_unstable_situation_progress_desc"
			hidden_trigger = { exists = event_target:ag_psionic_conduit_megastructure }
		}
	}
	abort_trigger = { OR = {
		NOT = { exists = event_target:ag_psionic_conduit_megastructure }
		event_target:ag_psionic_conduit_megastructure = { NOT = { exists = owner } }
		event_target:ag_psionic_conduit_megastructure.owner = { NOT = { is_same_value = root.owner } }
	} }
	on_abort = { event_target:ag_psionic_conduit_megastructure = {
		solar_system = {
			spawn_megastructure = {
				type = ag_ancient_alpha_megastructure_closed
				coords_from = prev
				init_effect = {
					if = { limit = { solar_system = { exists = space_owner } } set_owner = solar_system.space_owner }
					copy_flags_and_variables_from = event_target:ag_psionic_conduit_megastructure
					clear_global_event_target = ag_psionic_conduit_megastructure
					save_global_event_target_as = ag_psionic_conduit_megastructure
				}
			}
			if = { limit = { exists = space_owner } space_owner = { country_event = { id = ag_alpha.129 } } }
		}
		remove_megastructure = this
	} }
}
